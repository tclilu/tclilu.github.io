{"pages":[{"title":"","text":"","link":"/link/index.html"},{"title":"å…³äº","text":"Javaå¼€å‘å·¥ç¨‹å¸ˆé‚®ç®±ï¼šadmin@lilu.org.cn","link":"/about/index.html"},{"title":"è°·æ­Œå¹¿å‘Šiframe","text":"è°·æ­Œå¹¿å‘Šiframe (adsbygoogle=window.adsbygoogle || []).push({})","link":"/adsense/index.html"},{"title":"","text":"ğŸˆğŸˆå¾®ç¬‘å¢™ğŸˆğŸˆ å½­å°è‹’ å”è‰ºæ˜• æä¸€æ¡ gakki å›¾ç‰‡æœé›†äºäº’è”ç½‘ï¼Œä¾µæƒè¯·ç•™è¨€ï¼Œé©¬ä¸Šå¤„ç†ğŸ˜Šã€‚","link":"/album/index.html"},{"title":"åˆ†ç±»","text":"","link":"/categories/index.html"},{"title":"","text":"ç”³è¯·å‹é“¾é¡»çŸ¥ åŸåˆ™ä¸Šåªå’ŒæŠ€æœ¯ç±»åšå®¢äº¤æ¢ï¼Œä½†ä¸åŒ…æ‹¬å«æœ‰å’Œè‰²æƒ…ã€æš´åŠ›ã€æ”¿æ²»æ•æ„Ÿçš„ç½‘ç«™ã€‚ ä¸å’Œå‰½çªƒã€ä¾µæƒã€æ— è¯šä¿¡çš„ç½‘ç«™äº¤æ¢ï¼Œä¼˜å…ˆå’Œå…·æœ‰åŸåˆ›ä½œå“çš„ç½‘ç«™äº¤æ¢ã€‚ ç”³è¯·è¯·æä¾›ï¼šç«™ç‚¹åç§°ã€ç«™ç‚¹é“¾æ¥ã€ç«™ç‚¹æè¿°ã€logoæˆ–å¤´åƒï¼ˆä¸è¦è®¾ç½®é˜²ç›—é“¾ï¼‰ã€‚ æ’åä¸åˆ†å…ˆåï¼Œåˆ·æ–°åé‡æ’ï¼Œæ›´æ–°ä¿¡æ¯åè¯·ç•™è¨€å‘ŠçŸ¥ã€‚ ä¼šå®šæœŸæ¸…ç†å¾ˆä¹…å¾ˆä¹…ä¸æ›´æ–°çš„ã€ä¸ç¬¦åˆè¦æ±‚çš„å‹é“¾ï¼Œä¸å†å¦è¡Œé€šçŸ¥ã€‚ æœ¬ç«™ä¸å­˜å‚¨å‹é“¾å›¾ç‰‡ï¼Œå¦‚æœå‹é“¾å›¾ç‰‡æ¢äº†æ— æ³•æ›´æ–°ã€‚å›¾ç‰‡è£‚äº†çš„ä¼šæ›¿æ¢æˆé»˜è®¤å›¾ï¼Œéœ€è¦æ›´æ¢çš„è¯·ç•™è¨€å‘ŠçŸ¥ã€‚ æœ¬ç«™å‹é“¾ä¿¡æ¯å¦‚ä¸‹ï¼Œç”³è¯·å‹é“¾å‰è¯·å…ˆæ·»åŠ æœ¬ç«™ä¿¡æ¯ï¼š ç½‘ç«™å›¾æ ‡ï¼šhttps://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/hexo-theme-sunchaser/avatar.png ç½‘ç«™åç§°ï¼šæ‰“å·¥è¿™ä»¶å°äº‹ ç½‘ç«™åœ°å€ï¼šhttps://lilu.org.cn ç½‘ç«™ç®€ä»‹ï¼šæœˆäº®çš„ä¿¡å°é‡Œï¼Œä¼šä¸ä¼šæœ‰æ˜Ÿæ˜Ÿçš„æ¥ä¿¡ åŠ è½½ä¸­ï¼Œç¨ç­‰å‡ ç§’...","link":"/friend/index.html"},{"title":"","text":"æ¥è€Œä¸å¾€éç¤¼ä¹Ÿ","link":"/message/index.html"},{"title":"æ ‡ç­¾","text":"","link":"/tags/index.html"},{"title":"GitHubå¹´åº¦æŠ¥å‘Š","text":"GitHubå¹´åº¦æ€»ç»“ #github-annual-summary[src=\"\"],#github-annual-summary:not([src]){ opacity:0; width: auto; height: auto; max-width: 100%; max-height: 100%; } æŸ¥æ”¶ä½ çš„2020å¼€æºæŠ¥å‘Š æŸ¥çœ‹æŠ¥å‘Š å›åˆ°é¦–é¡µ (adsbygoogle=window.adsbygoogle || []).push({}) Â©2020 - 2021 By SunChaser (adsbygoogle=window.adsbygoogle || []).push({}) layui.use('layer', function(){ var layer = layui.layer; }); function get_github() { var github_id = $(\"#github-id\").val(); var img = $(\"#github-annual-summary\"); if (github_id === null || github_id === undefined || github_id === '') { img.css(\"width\",\"0\"); img.css(\"height\",\"0\"); img.attr('src',''); layer.msg('è¯·è¾“å…¥GitHubç”¨æˆ·å'); return; } var loadIndex = layer.load(1, { shade: [0.1,'#000'] }); $.ajax({ type: \"GET\", timeout: 30000, url: \"//47.92.27.29:520/github?github_id=\" + github_id, dataType: \"JSON\", success: function(result) { const str = '//47.92.27.29:520' + result.img_path.substring(1); layer.close(loadIndex); img.css(\"width\",\"100%\"); img.css(\"height\",\"100%\"); img.attr('src',str); }, complete : function(XMLHttpRequest,status){ //è¯·æ±‚å®Œæˆåæœ€ç»ˆæ‰§è¡Œå‚æ•° if(status=='timeout'){//è¶…æ—¶,statusè¿˜æœ‰success,errorç­‰å€¼çš„æƒ…å†µ ajaxTimeoutTest.abort(); layer.msg('ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼'); } } }); }","link":"/github/annual/summary/index.html"}],"posts":[{"title":"JavaBucket","text":"JavaæŠ€èƒ½æ ‘ JavaSEJDKæºç è§£æç³»åˆ— JDKæºç è§£æä¹‹Serializable JDKæºç è§£æä¹‹RandomAccess JDKæºç è§£æä¹‹Cloneable JDKæºç è§£æä¹‹List JDKæºç è§£æä¹‹Collection JDKæºç è§£æä¹‹AbstractCollection JDKæºç è§£æä¹‹AbstractList JDKæºç è§£æä¹‹Queue JDKæºç è§£æä¹‹Deque JDKæºç è§£æä¹‹LinkedList JDKæºç è§£æä¹‹AbstractSequentialList JDKæºç è§£æä¹‹ArrayList é¢è¯•å¿…é—®HashMap åŸºç¡€ æ·±å…¥ç†è§£æ·±æµ…æ‹·è´ æ–¹æ³•é‡è½½Overload åŸºæœ¬æ•°æ®ç±»å‹charä¸ºä»€ä¹ˆä¸ä¼šè¢«éšå¼è½¬æ¢æˆbyteæˆ–shortç±»å‹ï¼Ÿ å…³äºJavaï¼Œä½ ä¸å¾—ä¸å­¦çš„java.lang.Stringç±» JVM ä½•ä¸ºå¼•ç”¨ Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•è¿è¡Œå­—èŠ‚ç çš„ å¯¹è±¡æ˜¯â€œç”Ÿâ€æ˜¯â€œæ­»â€ å›æ”¶å‰çš„è‡ªæ•‘ åƒåœ¾æ”¶é›†å™¨ åƒåœ¾æ”¶é›†ç®—æ³• æ•°æ®ç»“æ„-ç®—æ³•æ•°æ®ç»“æ„ æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯† æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-ä½¿ç”¨éé€’å½’æ³•å®ç°å•é“¾è¡¨çš„åè½¬ æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-å¥‡æ•°ä¸ªå…ƒç´ çš„é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹ LeetCodeé¢˜è§£ ï¼ˆç®€å•ï¼‰ä¸¤æ•°ä¹‹å’Œ ï¼ˆç®€å•ï¼‰æ•´æ•°åè½¬ ï¼ˆç®€å•ï¼‰æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯ é“¾è¡¨æ ‡ç­¾ï¼šé¢è¯•é¢˜ï¼šé“¾è¡¨ç›¸äº¤ LeetCodeé“¾è¡¨æ ‡ç­¾ç®€å•é¢˜ è¿”å›å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹ åˆ é™¤ä¸­é—´èŠ‚ç‚¹ åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ å›æ–‡é“¾è¡¨ åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹ é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹ ç§»é™¤é“¾è¡¨å…ƒç´  ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹ åè½¬é“¾è¡¨ äºŒè¿›åˆ¶é“¾è¡¨è½¬æ•´æ•° é“¾è¡¨ç›¸äº¤ ç›¸äº¤é“¾è¡¨ å›æ–‡é“¾è¡¨ åè½¬é“¾è¡¨ åˆ é™¤é“¾è¡¨Mä¸ªèŠ‚ç‚¹åçš„Nä¸ªèŠ‚ç‚¹ åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  ç¯å½¢é“¾è¡¨ ç§»é™¤é‡å¤èŠ‚ç‚¹ ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨ å‹‡é—¯ç®—æ³• å‹‡é—¯ç®—æ³•-é€’å½’æ³•æ‹¿ä¸‹åè½¬é“¾è¡¨çš„ä¸‰æ€ å‹‡é—¯ç®—æ³•-åœ¨è¡Œåˆ—éƒ½æ’å¥½åºçš„çŸ©é˜µä¸­æ‰¾æŒ‡å®šçš„æ•° JavaEE Apache Mavenå¿…çŸ¥å¿…ä¼š æ•°æ®åº“Redis Stringå­—ç¬¦ä¸² Liståˆ—è¡¨ Hashå“ˆå¸Œ Seté›†åˆ ZSeté›†åˆ Redisé›†ç¾¤é…ç½® é€šç”¨Rediså‘½ä»¤ Redisæ‰©å±•çŸ¥è¯† å…¶å®ƒRedisæœåŠ¡å™¨å‘½ä»¤ MySQL äº‹åŠ¡çš„ç‰¹æ€§å’Œéš”ç¦»çº§åˆ« MySQLä¸ºä»€ä¹ˆé€‰æ‹©å¯é‡å¤è¯»ä½œä¸ºé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Ÿ ä¸­é—´ä»¶ Apache ShardingSphere åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶ä¹‹ShardingSphere-å…¥é—¨æ¡ˆä¾‹ xxl-job ä¿®ç‚¼xxl-jobä¹‹æ­å»ºæœ¬åœ°è°ƒåº¦å¹³å° ä¿®ç‚¼xxl-jobä¹‹ç¤ºä¾‹æ‰§è¡Œå™¨XxlJobConfigé…ç½®ç±»æºç è§£æ ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æµç¨‹è§£æ ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–å›½é™…åŒ–ç»„ä»¶ ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³ç»­çº¦â€æœåŠ¡ ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–å¤±è´¥ä»»åŠ¡ç®¡ç†ä¸­å¿ƒ åˆ†å¸ƒå¼å¾…å®Œå–„â€¦ å¾®æœåŠ¡å¾…å®Œå–„â€¦ é¡¹ç›®ç®¡ç†-æŒç»­é›†æˆLinux Linuxå‘½ä»¤ Docker Dockerå¸¸ç”¨å‘½ä»¤ åˆ›å»ºMySQL5.7çš„Dockerå®¹å™¨ å¸¸ç”¨è½¯ä»¶å®‰è£…ç³»åˆ— é‡è£…Windows10ç³»ç»Ÿ Windows 10ä¸‹Node.jså®‰è£…ä¸é…ç½® Windows 10ä¸‹Mavenå®‰è£…åŠé…ç½® Windows 10ä¸‹JDKå®‰è£…åŠç¯å¢ƒå˜é‡é…ç½® Windows 10ä¸‹IntelliJ IDEA 2019.3.2å®‰è£…å’Œå¸¸ç”¨é…ç½® Windows 10ä¸‹Gitå®‰è£…åŠSSHå…¬ç§é’¥é…ç½® Gitå¾…å®Œå–„â€¦ Jenkinså¾…å®Œå–„â€¦ ä¼˜ç§€ä¹¦ç± Java 8å®æˆ˜ ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€çŸ¥è¯† ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬äºŒéƒ¨åˆ†ï¼šå‡½æ•°å¼æ•°æ®å¤„ç† ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆä¸€ï¼‰ï¼šæ¥å£é‡æ„å’Œæ–°ç‰¹æ€§ ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆäºŒï¼‰ï¼šä¼˜é›…çš„è§£å†³NPEé—®é¢˜ ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆä¸‰ï¼‰ï¼šä»ä¸€ä¸ªç”Ÿäº§ç¯å¢ƒçš„äº‹æ•…åˆ°å¼‚æ­¥ç¼–ç¨‹æ€æƒ³ ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆå››ï¼‰ï¼šä½¿ç”¨æ–°çš„æ—¥æœŸæ—¶é—´API å¾…å®Œå–„â€¦ ã€Šå‰‘æŒ‡Offerã€‹ å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼ æ•°ç»„ä¸­é‡å¤çš„æ•°ï¼ˆé¢˜ç›®ä¸€ï¼‰ æ•°ç»„ä¸­é‡å¤çš„æ•°ï¼ˆé¢˜ç›®äºŒï¼‰ äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ æ›¿æ¢ç©ºæ ¼ é¢è¯•é¢˜5ï¼ˆç›¸å…³é¢˜ç›®ï¼‰ ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨ é‡å»ºäºŒå‰æ ‘ äºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ— ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ æ–æ³¢é‚£æ¥”æ•°åˆ— é’è›™è·³å°é˜¶é—®é¢˜ é’è›™è·³å°é˜¶é—®é¢˜æ‰©å±•ï¼ˆå˜æ€è·³å°é˜¶ï¼‰ çŸ©å½¢è¦†ç›– å‡ ä¸‡ä¸ªå‘˜å·¥å¹´é¾„æ’åº æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­— çŸ©é˜µä¸­çš„è·¯å¾„ æœºå™¨äººçš„è¿åŠ¨èŒƒå›´ å‰ªç»³å­ äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•° æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹ æ‰“å°ä»1åˆ°æœ€å¤§çš„nä½æ•° åœ¨O(1)æ—¶é—´å†…åˆ é™¤é“¾è¡¨èŠ‚ç‚¹ åˆ é™¤é“¾è¡¨ä¸­é‡å¤çš„èŠ‚ç‚¹ æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸² é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹ é“¾è¡¨ä¸­ç¯çš„å…¥å£èŠ‚ç‚¹ åè½¬é“¾è¡¨ åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨ å¾…å®Œå–„â€¦ ã€Šç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—-ITåä¼ç®—æ³•å’Œæ•°æ®ç»“æ„é¢˜ç›®æœ€ä¼˜è§£ã€‹ å¾…å®Œå–„â€¦","link":"/2019/12/13/java-bucket/"},{"title":"LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šå›æ–‡é“¾è¡¨","text":"é¢˜ç›®ï¼šè¯·åˆ¤æ–­ä¸€ä¸ªå•å‘é“¾è¡¨æ˜¯å¦ä¸ºå›æ–‡é“¾è¡¨ã€‚ Leetcodeåœ¨çº¿OJç³»ç»Ÿï¼šä¼ é€é—¨ ç¤ºä¾‹1ï¼š graph LR A[1]-->B[2] 1è¾“å‡ºï¼šfalse ç¤ºä¾‹2: graph LR A[1]-->B[2] B[2]-->C[2] C[2]-->D[1] 1è¾“å‡ºï¼štrue æ€è·¯ï¼š é¦–å…ˆéœ€è¦çŸ¥é“ä»€ä¹ˆæ˜¯â€œå›æ–‡â€ï¼šå›æ–‡æŒ‡çš„æ˜¯æ— è®ºæ­£å‘è¿˜æ˜¯åå‘è¯»ï¼Œå¾—åˆ°çš„ç»“æœä¸€è‡´ã€‚ç”±äºå•å‘é“¾è¡¨çš„ç‰¹ç‚¹ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥è¯»åŸé“¾è¡¨ï¼Œåˆ™åªèƒ½æ­£å‘è¯»å–ï¼Œæ— æ³•è¿›è¡Œåˆ¤æ–­ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€å®šçš„è½¬åŒ–ã€‚ è½¬æ¢æ–¹å¼ä¸€ï¼šå°†æ•´ä¸ªå•å‘é“¾è¡¨æ˜ å°„åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç„¶åä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä»æ•°ç»„ä¸¤ç«¯å¼€å§‹éå†ï¼Œå½“é‡åˆ°æ•°å€¼ä¸ç›¸ç­‰çš„èŠ‚ç‚¹æ—¶ï¼Œå¯æ–­å®šä¸ºéå›æ–‡é“¾è¡¨ï¼Œå¦‚æœéå†åˆ°ä¸¤ä¸ªèŠ‚ç‚¹ç›¸é‡æ—¶éƒ½æœªå‘ç°æ•°å€¼ä¸ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™ä¸ºå›æ–‡é“¾è¡¨ã€‚ å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼šæ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯† Javaè¯­è¨€å®ç°å¦‚ä¸‹ï¼š 12345678910111213public static boolean isPalindrome(SinglyLinkedListNode head) { List&lt;SinglyLinkedListNode&gt; list = new ArrayList&lt;&gt;(); while (head != null) { list.add(head); head = head.next; } for (int i = 0,size = list.size();i &lt; size / 2;i++) { if (!list.get(i).val.equals(list.get(size - i - 1).val)) { return false; } } return true;} è¿™ç§æ–¹å¼çš„ç©ºé—´å¤æ‚åº¦ä¸ºO(n)ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n + n/2) = O(n)ã€‚ è½¬æ¢æ–¹å¼äºŒï¼šä¸ä½¿ç”¨é¢å¤–ç©ºé—´ï¼Œæˆ‘ä»¬åœ¨åŸé“¾è¡¨ä¸Šåšæ–‡ç« ï¼Œå¦‚æœä¸€ä¸ªå•å‘é“¾è¡¨ä¸ºå›æ–‡é“¾è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†å‰åŠæ®µé“¾è¡¨è¿›è¡Œåè½¬ï¼Œç„¶åå†ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆp1å’Œp2ï¼Œp1ä»å¤´éƒ¨å¼€å§‹ï¼Œp2ä»ä¸­é—´å¼€å§‹ï¼Œéå†é“¾è¡¨ï¼Œå½“é‡åˆ°æ•°å€¼ä¸ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œå¯æ–­å®šä¸ºéå›æ–‡é“¾è¡¨ï¼›å¦‚æœp2éå†åˆ°å°¾éƒ¨éƒ½è¿˜æœªé‡åˆ°æ•°å€¼ä¸ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™ä¸ºå›æ–‡é“¾è¡¨ã€‚ å¦‚ä½•å°†å‰åŠæ®µé“¾è¡¨è¿›è¡Œåè½¬ï¼Ÿå¯åˆ©ç”¨ä¸€å¿«ä¸€æ…¢ä¸¤ä¸ªæŒ‡é’ˆå…ˆæ‰¾åˆ°ä¸­é—´èŠ‚ç‚¹ï¼Œç„¶åå°†ä»å¤´èŠ‚ç‚¹å¼€å§‹åˆ°ä¸­é—´èŠ‚ç‚¹çš„è¿™ä¸€éƒ¨åˆ†è¿›è¡Œåè½¬ã€‚ Javaè¯­è¨€å®ç°å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637public static boolean isPalindromeUseReverse(SinglyLinkedListNode head) { if (head == null || head.next == null) { return true; } // å¿«æ…¢æŒ‡é’ˆ SinglyLinkedListNode fast = head; SinglyLinkedListNode slow = head; // å¿«æŒ‡é’ˆèµ°åˆ°æœ«å°¾æ—¶ï¼Œæ…¢æŒ‡é’ˆæŒ‡å‘ä¸­é—´èŠ‚ç‚¹ while (fast != null &amp;&amp; fast.next != null) { fast = fast.next.next; slow = slow.next; } // åè½¬ä»å¤´èŠ‚ç‚¹åˆ°ä¸­é—´èŠ‚ç‚¹ä¹‹é—´çš„éƒ¨åˆ† SinglyLinkedListNode p1 = head; SinglyLinkedListNode p2 = slow; SinglyLinkedListNode pre = slow; SinglyLinkedListNode next; while (p1 != p2) { next = p1.next; p1.next = pre; pre = p1; p1 = next; } // å¦‚æœåŸé“¾æ¥èŠ‚ç‚¹ä¸ªæ•°ä¸ºå¥‡æ•°ï¼Œåˆ™ä¸­é—´èŠ‚ç‚¹p2ï¼ˆslowï¼‰éœ€è¦å³ç§»ä¸€ä½æ‰èƒ½è¿›è¡Œå›æ–‡æ¯”è¾ƒ // ä¾‹å¦‚ï¼š1-&gt;2-&gt;3-&gt;2-&gt;1ï¼›åè½¬å‰åŠéƒ¨åˆ†åä¸ºï¼š2-&gt;1-&gt;3-&gt;2-&gt;1 // p2æŒ‡å‘ä¸­é—´èŠ‚ç‚¹3ï¼Œéœ€è¦å³ç§»ä¸€ä½æŒ‡å‘2ï¼Œæ‰èƒ½è¿›è¡Œå›æ–‡æ¯”è¾ƒ if (fast != null) p2 = p2.next; // æ­¤æ—¶preæŒ‡å‘æ–°é“¾è¡¨çš„å¤´èŠ‚ç‚¹ while (p2 != null) { if (!pre.val.equals(p2.val) { return false; } pre = pre.next; p2 = p2.next; } return true;} æ­¤æ–¹å¼çš„æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n + n/2 + n/2) = O(n)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚ ç¼ºç‚¹æ˜¯æ”¹å˜äº†åŸé“¾è¡¨çš„ç»“æ„ï¼Œä½†å¯åœ¨åˆ¤æ–­å‡ºæ˜¯å¦ä¸ºå›æ–‡é“¾è¡¨åå†æ¬¡åè½¬å‰åŠéƒ¨åˆ†èŠ‚ç‚¹ï¼Œä»è€Œæ¢å¤åŸé“¾è¡¨çš„ç»“æ„ã€‚ æ–¹å¼äºŒçš„ä¼˜åŒ–ç‰ˆæœ¬ï¼šä½¿ç”¨å¿«æ…¢æŒ‡é’ˆå¯»æ‰¾ä¸­é—´èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­æ…¢æŒ‡é’ˆå·²ç»éå†äº†å‰åŠéƒ¨åˆ†é“¾è¡¨ï¼Œå¯å°±åœ¨è¿™ä¸€æ¬¡çš„éå†ä¸­è¿›è¡Œåè½¬ã€‚ ä¼˜åŒ–åçš„ä»£ç å®ç°å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324public static boolean isPalindromeUseReverseOptimization(SinglyLinkedListNode head) { if (head == null || head.next == null) { return true; } SinglyLinkedListNode fast = head; SinglyLinkedListNode slow = head; SinglyLinkedListNode pre = null; SinglyLinkedListNode next; // æ…¢æŒ‡é’ˆç§»åŠ¨çš„åŒæ—¶è¿›è¡Œåè½¬ while (fast != null &amp; fast.next != null) { fast = fast.next.next; next = slow.next; slow.next = pre; pre = slow; slow = next; } if (fast != null) slow = slow.next; while (slow != null) { if (!pre.val.equals(slow.val)) return false; pre = pre.next; slow = slow.next; } return true;} ä¼˜åŒ–åçš„æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n/2 + n/2) = O(n)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚ä½†ä»ç„¶ç ´åäº†åŸé“¾è¡¨çš„ç»“æ„ï¼ŒåŒæ ·åœ°ï¼Œå¯å†æ¬¡åè½¬é“¾è¡¨å‰åŠéƒ¨åˆ†è¿›è¡Œæ¢å¤ã€‚","link":"/2021/01/03/algorithm/leetcode/tag/linkedlist/palindrome-linked-list/"},{"title":"äº‘è®¾è®¡æ¨¡å¼ä¹‹ç¼“å­˜å¤‡ç”¨æ¨¡å¼ï¼ˆCache-Aside Patternï¼‰","text":"åŸºæœ¬æ¦‚å¿µä½œç”¨ï¼šå°†æ•°æ®æŒ‰éœ€ä»æ•°æ®åº“åŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚ æ­¤æ¨¡å¼å¯ä»¥æé«˜æ€§èƒ½ï¼Œå¹¶èƒ½ä¿æŒç¼“å­˜å’Œæ•°æ®åº“ä¸­æ•°æ®çš„ä¸€è‡´æ€§ã€‚ é—®é¢˜èƒŒæ™¯åº”ç”¨ç¨‹åºä½¿ç”¨ç¼“å­˜æ¥ä¼˜åŒ–å¯¹æ•°æ®åº“ä¸­å­˜å‚¨ä¿¡æ¯çš„é‡å¤è®¿é—®ã€‚ä½†æ˜¯ï¼ŒæœŸæœ›ç¼“å­˜å’Œæ•°æ®åº“ä¸­çš„æ•°æ®å®Œå…¨ä¸€è‡´æ˜¯ä¸åˆ‡å®é™…çš„ã€‚ åº”ç”¨ç¨‹åºåº”è¯¥å®ç°ä¸€ç§æœ‰åŠ©äºç¡®ä¿ç¼“å­˜ä¸­çš„æ•°æ®å°½é‡ä¿æŒæœ€æ–°ï¼ŒåŒæ—¶å½“ç¼“å­˜ä¸­çš„æ•°æ®è¿‡æœŸæ—¶å¯ä»¥æ£€æµ‹å’Œå¤„ç†çš„ç­–ç•¥ã€‚ è§£å†³æ–¹æ¡ˆå¾ˆå¤šå•†ä¸šç¼“å­˜ç³»ç»Ÿæä¾›read-throughå’Œwrite-through/write-behindæ“ä½œã€‚åœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡å¼•ç”¨ç¼“å­˜æ¥æ£€ç´¢æ•°æ®ã€‚å¦‚æœæ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ï¼Œåˆ™ä»æ•°æ®åº“ä¸­é€æ˜åœ°æŸ¥è¯¢æ•°æ®å¹¶å°†å…¶æ·»åŠ è‡³ç¼“å­˜ä¸­ï¼›å¯¹ç¼“å­˜ä¸­ä¿å­˜çš„æ•°æ®çš„ä»»ä½•ä¿®æ”¹ä¹Ÿä¼šè‡ªåŠ¨å†™å›åˆ°æ•°æ®åº“ä¸­ã€‚ å¯¹äºä¸æä¾›æ­¤åŠŸèƒ½çš„ç¼“å­˜ï¼Œç”±ä½¿ç”¨ç¼“å­˜æ¥ç»´æŠ¤æ•°æ®çš„åº”ç”¨ç¨‹åºè´Ÿè´£ã€‚ åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å®ç°ç¼“å­˜å¤‡ç”¨æ¨¡å¼æ¥æ¨¡æ‹Ÿread-throughç¼“å­˜çš„åŠŸèƒ½ã€‚è¯¥æ¨¡å¼å¯æ ¹æ®éœ€è¦å°†æ•°æ®é«˜æ•ˆåœ°åŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚ä¸‹å›¾æ€»ç»“äº†æ­¤è¿‡ç¨‹ä¸­çš„æ­¥éª¤ã€‚ é€šä¿—çš„è®²ï¼Œåˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š å…ˆæŸ¥è¯¢ç¼“å­˜ï¼Œåˆ¤æ–­ç¼“å­˜æ˜¯å¦å­˜åœ¨ã€‚ å¦‚æœç¼“å­˜ä¸å­˜åœ¨ï¼Œåˆ™ä»æ•°æ®åº“ä¸­æŸ¥è¯¢ã€‚ ç„¶åå°†æ•°æ®ä¸­æŸ¥å‡ºæ¥çš„æ•°æ®è®¾ç½®åˆ°ç¼“å­˜ä¸­ã€‚ å¦‚æœåº”ç”¨ç¨‹åºéœ€è¦ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹write-throughç­–ç•¥ï¼š ä¿®æ”¹æ•°æ®åº“ã€‚ è®©ç¼“å­˜å¤±æ•ˆã€‚ å½“ä¸‹ä¸€æ¬¡è¯·æ±‚åˆ°æ¥æ—¶ï¼Œç”±äºä½¿ç”¨äº†ç¼“å­˜å¤‡ç”¨æ¨¡å¼ï¼Œå°†ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæœ€æ–°çš„æ•°æ®å¹¶å°†å…¶è®¾ç½®å›ç¼“å­˜ä¸­ã€‚ é—®é¢˜ä¸æ€è€ƒåœ¨å†³å®šå¦‚ä½•å®ç°æ­¤æ¨¡å¼æ—¶ï¼Œåº”è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š ç¼“å­˜æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸï¼šå¾ˆå¤šç¼“å­˜å®ç°äº†è¿‡æœŸç­–ç•¥ï¼Œå¦‚æœåœ¨æŒ‡å®šçš„æ—¶é—´å†…æœªè®¿é—®ç¼“å­˜æ•°æ®ï¼Œç¼“å­˜ä¼šè‡ªåŠ¨å¤±æ•ˆå¹¶è¿›è¡Œåˆ é™¤ã€‚ä¸ºäº†ä½¿ç¼“å­˜å¤‡ç”¨æ¨¡å¼é«˜æ•ˆï¼Œè¯·ç¡®ä¿è¿‡æœŸç­–ç•¥ä¸ä½¿ç”¨è¯¥ç¼“å­˜çš„åº”ç”¨ç¨‹åºçš„è®¿é—®æ¨¡å¼ç›¸åŒ¹é…ã€‚ä¸è¦å°†è¿‡æœŸæ—¶é—´è®¾ç½®çš„å¤ªçŸ­ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºä¸æ–­ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®å¹¶å°†å…¶æ·»åŠ è‡³ç¼“å­˜ä¸­ï¼›åŒæ ·ä¸è¦è®¾ç½®çš„å¤ªé•¿ï¼Œä»¥å…ç¼“å­˜çš„æ•°æ®ä¸æ˜¯æœ€æ–°çš„ã€‚è¯·è®°ä½ï¼Œå¯¹äºç›¸å¯¹é™æ€çš„æ•°æ®æˆ–ç»å¸¸è¯»å–çš„æ•°æ®ï¼Œä½¿ç”¨ç¼“å­˜æœ€æœ‰æ•ˆã€‚ æ·˜æ±°æ•°æ®ï¼šå³å†…å­˜æ·˜æ±°ç­–ç•¥ã€‚ä¸æ•°æ®åº“ç›¸æ¯”ï¼Œå¤§å¤šæ•°é«˜é€Ÿç¼“å­˜åªæœ‰æœ‰é™çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œåœ¨å¿…è¦çš„æ—¶å€™ä¼šè¿›è¡Œå†…å­˜æ·˜æ±°ã€‚å¤§å¤šæ•°ç¼“å­˜éƒ½ä½¿ç”¨LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç®—æ³•æ¥å®ç°ï¼Œä½†è¿™å¯ä»¥è¿›è¡Œè‡ªå®šä¹‰ï¼Œå¯é…ç½®ç¼“å­˜çš„å…¨å±€è¿‡æœŸå±æ€§ä»¥åŠæ¯ä¸ªç¼“å­˜keyçš„è¿‡æœŸå±æ€§ï¼Œä»¥å¸®åŠ©ç¼“å­˜å…·æœ‰æˆæœ¬æ•ˆç›Šã€‚å°†å†…å­˜æ·˜æ±°ç­–ç•¥åº”ç”¨äºæ‰€æœ‰ç¼“å­˜keyå¹¶ä¸æ€»æ˜¯åˆé€‚çš„ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä»æ•°æ®ä¸­æŸ¥è¯¢å¹¶æ·»åŠ è‡³ç¼“å­˜ä¸­çš„ä»£ä»·éå¸¸æ˜‚è´µï¼Œé‚£ä¹ˆå°†å…¶ä¿ç•™åœ¨ç¼“å­˜ä¸­å¯èƒ½æ˜¯æœ‰ç›Šçš„ã€‚ å¯åŠ¨ç¼“å­˜ï¼šå³ç¼“å­˜é¢„çƒ­ã€‚è®¸å¤šè§£å†³æ–¹æ¡ˆä¼šåœ¨åº”ç”¨ç¨‹åºå¯åŠ¨è¿‡ç¨‹ä¸­é¢„å…ˆåŠ è½½å¯èƒ½éœ€è¦çš„æ•°æ®è‡³ç¼“å­˜ä¸­ã€‚å¦‚æœè¿™éƒ¨åˆ†ç¼“å­˜è¿‡æœŸæˆ–è¢«æ·˜æ±°ï¼Œç¼“å­˜å¤‡ç”¨æ¨¡å¼ä»ç„¶æœ‰æ•ˆã€‚ ä¸€è‡´æ€§ï¼šå®ç°ç¼“å­˜å¤‡ç”¨æ¨¡å¼å¹¶ä¸èƒ½ä¿è¯æ•°æ®åº“å’Œç¼“å­˜ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ã€‚æ•°æ®åº“ä¸­çš„æ•°æ®å¯èƒ½åœ¨ä»»æ„æ—¶åˆ»è¢«å¤–éƒ¨ä¿®æ”¹ï¼Œå¹¶ä¸”åœ¨ä¸‹æ¬¡è¯¥æ•°æ®è¢«åŠ è½½åˆ°ç¼“å­˜ä¸­ä¹‹å‰ï¼Œæ­¤ä¿®æ”¹å¯èƒ½ä¸ä¼šåæ˜ åœ¨ç¼“å­˜ä¸­ã€‚åœ¨è·¨æ•°æ®å­˜å‚¨å¤åˆ¶æ•°æ®çš„ç³»ç»Ÿä¸­ï¼Œå¦‚æœéå¸¸é¢‘ç¹çš„å‘ç”ŸåŒæ­¥ï¼Œåˆ™æ­¤é—®é¢˜å¯èƒ½ä¼šå˜å¾—ç‰¹åˆ«ä¸¥é‡ã€‚ æœ¬åœ°ç¼“å­˜ï¼šç¼“å­˜å¯ä»¥å­˜åœ¨äºåº”ç”¨ç¨‹åºå®ä¾‹çš„æœ¬åœ°å†…å­˜ä¸­ï¼Œå¦‚æœåº”ç”¨ç¨‹åºé‡å¤è®¿é—®ç›¸åŒçš„æ•°æ®ï¼Œç¼“å­˜å¤‡ç”¨æ¨¡å¼ä¼šéå¸¸æœ‰ç”¨ã€‚ä½†æ˜¯æœ¬åœ°ç¼“å­˜æ˜¯æ¯ä¸ªåº”ç”¨ç¨‹åºå®ä¾‹ç§æœ‰çš„ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ¬åœ°ç¼“å­˜ä¹‹é—´çš„æ•°æ®å¯èƒ½å¾ˆå¿«å˜å¾—ä¸ä¸€è‡´ï¼Œæˆ‘ä»¬éœ€è¦éå¸¸é¢‘ç¹çš„åˆ·æ–°æœ¬åœ°ç¼“å­˜å¹¶ä¸”è®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥è€ƒè™‘ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜ã€‚ ä»€ä¹ˆåœºæ™¯ä½¿ç”¨è¯¥æ¨¡å¼ï¼Ÿé€‚ç”¨åœºæ™¯ï¼š ç¼“å­˜ç³»ç»Ÿä¸æä¾›read-throughå’Œwrite-throughæ“ä½œã€‚ èµ„æºéœ€æ±‚æ— æ³•è¿›è¡Œé¢„æµ‹ã€‚æ­¤æ¨¡å¼å¯ä½¿åº”ç”¨ç¨‹åºæŒ‰éœ€åŠ è½½æ•°æ®è‡³ç¼“å­˜ï¼Œå®ƒä¸ä¼šé¢„å…ˆå‡è®¾åº”ç”¨ç¨‹åºéœ€è¦å“ªäº›æ•°æ®ã€‚ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯ï¼š å½“ç¼“å­˜çš„æ•°æ®ä¸ºé™æ€çš„æ—¶å€™ï¼Œå¦‚æœç¼“å­˜ç©ºé—´è¶³å¤Ÿå­˜å‚¨æ•°æ®ï¼Œè¯·åœ¨å¯åŠ¨æ—¶è¿›è¡Œç¼“å­˜é¢„çƒ­ï¼Œå¹¶è®©å…¶æ°¸ä¸è¿‡æœŸã€‚ åœ¨Webåº”ç”¨ç¨‹åºä¸­ç¼“å­˜ä¼šè¯çŠ¶æ€ä¿¡æ¯ã€‚æ­¤åœºæ™¯ä¸‹åº”é¿å…å¼•å…¥åŸºäºå®¢æˆ·ç«¯-æœåŠ¡ç«¯ç›¸ä¼¼æ€§çš„ä¾èµ–å…³ç³»ã€‚ ä½¿ç”¨ç¤ºä¾‹åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä½¿ç”¨Redisä½œä¸ºå¤šä¸ªåº”ç”¨ç¨‹åºå®ä¾‹ä¹‹é—´å…±äº«çš„åˆ†å¸ƒå¼ç¼“å­˜ã€‚ä»¥ä¸‹ä»£ç ä¸­çš„selectCacheOrDbæ–¹æ³•å±•ç¤ºäº†åŸºäºRedisçš„ç¼“å­˜å¤‡ç”¨æ¨¡å¼çš„æ¨¡æ¿æ–¹æ³•å®ç°ã€‚è¯¥æ–¹æ³•ä½¿ç”¨read-throughä»ç¼“å­˜ä¸­è¯»å–æ•°æ®ã€‚ é¦–å…ˆä»ç¼“å­˜ä¸­è¯»å–æ•°æ®ï¼› å¦‚æœç¼“å­˜æ•°æ®ä¸å­˜åœ¨ï¼Œåˆ™ä»æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ï¼› å¦‚æœæ•°æ®åº“ä¸­çš„æ•°æ®å­˜åœ¨ï¼Œåˆ™å°†å…¶è®¾ç½®åˆ°ç¼“å­˜ä¸­ï¼Œè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œç„¶åè¿”å›ï¼› å¦‚æœç¼“å­˜æ•°æ®å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›ç¼“å­˜ä¸­çš„æ•°æ®ï¼› æ•´ä¸ªè¿‡ç¨‹å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œè¿”å›é»˜è®¤å€¼è¿›è¡Œé™çº§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455package com.sunchaser.sparrow.designpatterns.cloud;import com.alibaba.fastjson.JSONObject;import com.alibaba.fastjson.TypeReference;import com.sunchaser.sparrow.designpatterns.common.model.request.CacheAsideRequest;import lombok.RequiredArgsConstructor;import lombok.extern.slf4j.Slf4j;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.data.redis.core.RedisTemplate;import org.springframework.stereotype.Component;import org.springframework.util.StringUtils;import java.util.Objects;import java.util.concurrent.TimeUnit;/** * @author sunchaser admin@lilu.org.cn * @since JDK8 2021/1/3 */@Component@Slf4j@RequiredArgsConstructor(onConstructor = @__(@Autowired))public class CacheAsidePattern { private final RedisTemplate&lt;String,String&gt; redisTemplate; public &lt;T&gt; T selectCacheOrDb(CacheAsideRequest&lt;T&gt; cacheAsideRequest) { try { String cacheKey = cacheAsideRequest.getCacheKey(); // random é˜²æ­¢é›ªå´© int expiredTime = cacheAsideRequest.getExpiredTime() + ThreadLocalRandom.current().nextInt(60); TimeUnit timeUnit = cacheAsideRequest.getTimeUnit(); String cacheValueString = redisTemplate.opsForValue().get(cacheKey); if (StringUtils.isEmpty(cacheValueString)) { T dbValue = cacheAsideRequest.getDbSelector().get(); log.info(&quot;cache miss, query db and the db value is: {}&quot;,dbValue); if (Objects.nonNull(dbValue)) { redisTemplate.opsForValue().set( cacheKey, JSONObject.toJSONString(dbValue), expiredTime, timeUnit ); } return dbValue; } else { T t = JSONObject.parseObject(cacheValueString, new TypeReference&lt;T&gt;() {}); log.info(&quot;hit cache, the cache value is: {}&quot;,cacheValueString); return t; } } catch (Exception e) { log.info(&quot;query cache or db error!&quot;); return cacheAsideRequest.getDefaultValue(); } }} å…¶ä¸­æ–¹æ³•å…¥å‚CacheAsideRequestçš„å…·ä½“å­—æ®µå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940package com.sunchaser.sparrow.designpatterns.common.model.request;import lombok.Data;import java.util.concurrent.TimeUnit;import java.util.function.Supplier;/** * ç¼“å­˜å¤‡ç”¨æ¨¡å¼è¯·æ±‚å…¥å‚ * @author sunchaser admin@lilu.org.cn * @since JDK8 2021/1/3 */@Datapublic class CacheAsideRequest&lt;T&gt; { /** * ç¼“å­˜key */ private String cacheKey; /** * ç¼“å­˜è¿‡æœŸæ—¶é—´ */ private Integer expiredTime; /** * è¿‡æœŸæ—¶é—´çš„å•ä½ */ private TimeUnit timeUnit; /** * DBæŸ¥è¯¢å™¨ */ private Supplier&lt;T&gt; dbSelector; /** * å‘ç”Ÿå¼‚å¸¸è¿›è¡Œé™çº§çš„é»˜è®¤å€¼ */ private T defaultValue;} æˆ‘ä»¬ä½¿ç”¨HashMapæ¨¡æ‹Ÿä¸€ä¸ªæ•°æ®åº“ï¼Œå½“éœ€è¦æŸ¥è¯¢æ—¶ï¼Œä»¥ä¸‹ä»£ç ä¸­çš„testSelectCacheOrDbæ–¹æ³•å±•ç¤ºäº†æˆ‘ä»¬çš„ä½¿ç”¨æ–¹å¼ï¼ŒtestUpdateæ–¹æ³•æ¨¡æ‹Ÿäº†æ•°æ®åº“çš„æ›´æ–°ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556package com.sunchaser.sparrow.designpatterns.cloud;import com.google.common.collect.Maps;import com.sunchaser.sparrow.designpatterns.common.model.request.CacheAsideRequest;import org.junit.Before;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.boot.test.context.SpringBootTest;import org.springframework.data.redis.core.RedisTemplate;import org.springframework.test.context.junit4.SpringRunner;import java.util.Map;import java.util.concurrent.TimeUnit;/** * @author sunchaser admin@lilu.org.cn * @since JDK8 2021/1/3 */@SpringBootTest@RunWith(SpringRunner.class)public class CacheAsidePatternTest { @Autowired private CacheAsidePattern cacheAsidePattern; @Autowired private RedisTemplate&lt;String,String&gt; redisTemplate; private static final Map&lt;String,String&gt; db = Maps.newHashMap(); @Before public void setUp() throws Exception { db.put(&quot;defaultUser&quot;,&quot;defaultValue&quot;); db.put(&quot;user1&quot;,&quot;value1&quot;); db.put(&quot;user2&quot;,&quot;value2&quot;); db.put(&quot;user3&quot;,&quot;value3&quot;); db.put(&quot;user4&quot;,&quot;value4&quot;); } @Test public void testSelectCacheOrDb() { CacheAsideRequest&lt;String&gt; cacheAsideRequest = new CacheAsideRequest&lt;&gt;(); cacheAsideRequest.setCacheKey(&quot;test-key&quot;); cacheAsideRequest.setExpiredTime(100); cacheAsideRequest.setTimeUnit(TimeUnit.SECONDS); cacheAsideRequest.setDbSelector(() -&gt; db.get(&quot;user1&quot;)); cacheAsideRequest.setDefaultValue(db.get(&quot;defaultUser&quot;)); String s = cacheAsidePattern.selectCacheOrDb(cacheAsideRequest); System.out.println(s); } @Test public void testUpdate() { db.put(&quot;user1&quot;,&quot;updateValue1&quot;); redisTemplate.delete(&quot;test-key&quot;); }} è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨æ›´æ–°æ•°æ®æ—¶ï¼Œåº”è¯¥å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†è®©ç¼“å­˜å¤±æ•ˆã€‚è¿™æ ·å¸¦æ¥çš„æ•°æ®å»¶è¿Ÿåªæœ‰ä¸€ä¸ªredisæ“ä½œçš„æ—¶é—´ã€‚ å¦‚æœå…ˆè®©ç¼“å­˜å¤±æ•ˆï¼Œåæ›´æ–°æ•°æ®åº“ã€‚åœ¨è¿™ä¸¤æ­¥æ“ä½œçš„çª—å£æœŸé—´ï¼Œæœ‰å¾ˆå°çš„å¯èƒ½å®¢æˆ·ç«¯ä¼šå…ˆè¯»å–åˆ°æ•°æ®åº“ä¸­æ—§çš„æ•°æ®å¹¶å°†å…¶é‡æ–°è®¾ç½®åˆ°ç¼“å­˜ä¸­ï¼Œç„¶åå¯¹æ•°æ®åº“çš„æ›´æ–°æ‰æ­£å¼æäº¤ã€‚è¿™ä¼šå¯¼è‡´ç¼“å­˜ä¸­çš„æ•°æ®ä¸æ˜¯æœ€æ–°ã€‚ æ‰©å±•éƒ¨åˆ†æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å¯¹ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºçš„æ•°æ®è¿›è¡Œä¸€å®šçš„æ ¡éªŒåæ‰å†³å®šæ˜¯å¦å­˜å…¥ç¼“å­˜ã€‚ä¾‹å¦‚æŸ¥è¯¢å‡ºçš„æ•°æ®åŒ…å«çš„å­—æ®µå…¨éƒ¨ä¸ä¸ºé›¶å€¼æ‰è¿›è¡Œç¼“å­˜ï¼Œæˆ–è€…æŸ¥è¯¢å‡ºçš„æ•°æ®åŒ…å«çš„å­—æ®µåªè¦æœ‰ä¸€ä¸ªä¸ºé›¶å€¼å°±è¿›è¡Œç¼“å­˜ã€‚å¦å¤–ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¯èƒ½æ˜¯ä¸€ä¸ªæ•°æ®è¡¨å®ä½“å¯¹è±¡ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªåŒ…å«æ•°æ®è¡¨å®ä½“å¯¹è±¡çš„ArrayListé›†åˆï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œåˆ†ç±»è®¨è®ºã€‚å¯¹å¤–æˆ‘ä»¬æä¾›ä¸€ä¸ªå¯é€‰çš„ç­–ç•¥ï¼Œå¯¹å†…æˆ‘ä»¬å…¼å®¹å•ä¸ªå®ä½“ç±»å’Œé›†åˆä¸¤ç§æƒ…å†µã€‚æ ¹æ®æ•°æ®åº“æŸ¥è¯¢è¿”å›çš„æ•°æ®ç±»å‹æ‰§è¡Œä¸åŒçš„è§£ææ–¹å¼ï¼Œæˆ‘ä»¬åˆ©ç”¨åå°„æ¥è§£æå•ä¸ªå¯¹è±¡æˆ–é›†åˆä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡çš„å­—æ®µæ˜¯å¦ä¸ºé›¶å€¼ã€‚ é›¶å€¼ï¼šä¾‹å¦‚Integerçš„é›¶å€¼ä¸º0ï¼›Longçš„é›¶å€¼ä¸º0Lï¼›Doubleçš„é›¶å€¼ä¸º0.00ç­‰ç­‰ï¼Œè¿˜å¯æ ¹æ®å…·ä½“çš„ä¸šåŠ¡åœºæ™¯è¿›è¡Œè‡ªå®šä¹‰ã€‚ ä¸‹é¢ç»™å‡ºæˆ‘ä»¬çš„ç­–ç•¥æšä¸¾ç±»CacheStrategyEnumå®ç°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150package com.sunchaser.sparrow.designpatterns.common.enums;import com.google.common.collect.Lists;import com.google.common.collect.Maps;import lombok.Getter;import java.lang.reflect.Field;import java.util.List;import java.util.Map;/** * ç¼“å­˜ç­–ç•¥æšä¸¾åŠç­–ç•¥å¯¹åº”çš„å®ç° * @author sunchaser admin@lilu.org.cn * @since JDK8 2021/1/3 */@Getterpublic enum CacheStrategyEnum { ALL_NO_ZERO(&quot;ALL_NO_ZERO&quot;,&quot;å…¨éƒ¨å­—æ®µä¸ä¸ºé›¶åˆ™è¿›è¡Œç¼“å­˜&quot;) { @Override public boolean analysisList(List&lt;?&gt; list) throws IllegalAccessException { for (Object el : list) { // è·å–åŒ…å«çˆ¶ç±»superçš„æ‰€æœ‰å­—æ®µ Field[] allFields = getAllFields(el); for (Field field : allFields) { field.setAccessible(true); // åªè¦æœ‰ä¸€ä¸ªå­—æ®µä¸ºé›¶ï¼Œè¿”å›false if (analysisZero(field.get(el))) return false; } } return true; } @Override public boolean analysisCustomObject(Object object) throws IllegalAccessException { Field[] allFields = getAllFields(object); for (Field field : allFields) { field.setAccessible(true); // åªè¦æœ‰ä¸€ä¸ªå­—æ®µä¸ºé›¶ï¼Œè¿”å›false if (analysisZero(field.get(object))) return false; } return true; } }, ANY_NO_ZERO(&quot;ANY_NO_ZERO&quot;,&quot;ä»»æ„ä¸€ä¸ªå­—æ®µä¸ä¸ºé›¶åˆ™è¿›è¡Œç¼“å­˜&quot;) { @Override public boolean analysisList(List&lt;?&gt; list) throws IllegalAccessException { for (Object el : list) { // è·å–åŒ…å«çˆ¶ç±»superçš„æ‰€æœ‰å­—æ®µ Field[] allFields = getAllFields(el); for (Field field : allFields) { field.setAccessible(true); // ä»»æ„ä¸€ä¸ªå­—æ®µä¸ä¸ºé›¶ï¼Œè¿”å›true if (!analysisZero(field.get(el))) return true; } } return false; } @Override public boolean analysisCustomObject(Object object) throws IllegalAccessException { Field[] allFields = getAllFields(object); for (Field field : allFields) { field.setAccessible(true); // ä»»æ„ä¸€ä¸ªå­—æ®µä¸ä¸ºé›¶ï¼Œè¿”å›true if (!analysisZero(field.get(object))) return true; } return false; } }; /** * ç¼“å­˜ç­–ç•¥ */ private final String strategy; /** * æè¿° */ private final String desc; /** * flyweight */ private static final Map&lt;String,CacheStrategyEnum&gt; enumMap = Maps.newHashMap(); static { for (CacheStrategyEnum cacheStrategyEnum : CacheStrategyEnum.values()) enumMap.put(cacheStrategyEnum.strategy,cacheStrategyEnum); } public CacheStrategyEnum getEnumByStrategy(String strategy) { return enumMap.get(strategy); } CacheStrategyEnum(String strategy, String desc) { this.strategy = strategy; this.desc = desc; } /** * æŠ½è±¡æ–¹æ³•ï¼šè§£æListä¸­çš„è‡ªå®šä¹‰å¯¹è±¡ * @param list listå¯¹è±¡ * @return falseï¼šä¸è¿›è¡Œç¼“å­˜ï¼›trueï¼šè¿›è¡Œç¼“å­˜ * @throws IllegalAccessException ä¸Šå±‚è¿›è¡Œå¼‚å¸¸å¤„ç† */ public abstract boolean analysisList(List&lt;?&gt; list) throws IllegalAccessException ; /** * æŠ½è±¡æ–¹æ³•ï¼šè§£æè‡ªå®šä¹‰å¯¹è±¡ * @param object å¾…è§£æçš„è‡ªå®šä¹‰å¯¹è±¡ * @return falseï¼šä¸è¿›è¡Œç¼“å­˜ï¼›trueï¼šè¿›è¡Œç¼“å­˜ * @throws IllegalAccessException ä¸Šå±‚è¿›è¡Œå¼‚å¸¸å¤„ç† */ public abstract boolean analysisCustomObject(Object object) throws IllegalAccessException ; /** * è§£æå­—æ®µæ˜¯å¦ä¸ºé›¶å€¼ * @param o å¾…è§£æå­—æ®µ * @return trueï¼šä¸ºé›¶å€¼ï¼›falseï¼šä¸ä¸ºé›¶ã€‚ */ private static boolean analysisZero(Object o) { if (o instanceof Long) { return (Long) o == 0L; } else if (o instanceof Integer) { return (Integer) o == 0; } else if (o instanceof Double) { return (Double) o == 0.00; } else { // do other biz zero } return false; } /** * è·å–åŒ…å«superçˆ¶ç±»çš„æ‰€æœ‰å­—æ®µ * @param object éœ€è¦è·å–å­—æ®µçš„å¯¹è±¡ * @return å¯¹è±¡çš„æ‰€æœ‰å­—æ®µ */ private static Field[] getAllFields(Object object) { Class&lt;?&gt; clazz = object.getClass(); List&lt;Field&gt; fieldList = Lists.newArrayList(); while (clazz != null) { fieldList.addAll(Lists.newArrayList(clazz.getDeclaredFields())); clazz = clazz.getSuperclass(); } Field[] fields = new Field[fieldList.size()]; fieldList.toArray(fields); return fields; }} æ­¤æ—¶æˆ‘ä»¬éœ€è¦åœ¨æ¨¡æ¿æ–¹æ³•çš„å…¥å‚CacheAsideRequestä¸­æ·»åŠ è¯¥æšä¸¾å­—æ®µã€‚åŒæ—¶æ¨¡æ¿æ–¹æ³•selectCacheOrDbçš„å®ç°ä¹Ÿè¦åšå¯¹åº”ä¿®æ”¹ï¼Œå…·ä½“å¯çœ‹ä»¥ä¸‹ä»£ç ã€‚ 123456789101112131415161718192021222324252627282930313233343536public &lt;T&gt; T selectCacheOrDb(CacheAsideRequest&lt;T&gt; cacheAsideRequest) { try { String cacheKey = cacheAsideRequest.getCacheKey(); // random é˜²æ­¢é›ªå´© int expiredTime = cacheAsideRequest.getExpiredTime() + ThreadLocalRandom.current().nextInt(60); TimeUnit timeUnit = cacheAsideRequest.getTimeUnit(); CacheStrategyEnum cacheStrategyEnum = cacheAsideRequest.getCacheStrategyEnum(); String cacheValueString = redisTemplate.opsForValue().get(cacheKey); if (StringUtils.isEmpty(cacheValueString)) { T dbValue = cacheAsideRequest.getDbSelector().get(); log.info(&quot;cache miss, query db and the db value is: {}&quot;,dbValue); if (Objects.nonNull(dbValue)) { // flagçš„å«ä¹‰ï¼šfalseï¼šä¸è¿›è¡Œç¼“å­˜ï¼›trueï¼šè¿›è¡Œç¼“å­˜ã€‚ boolean flag; // è§£æListä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡çš„é›¶å€¼ if (dbValue instanceof List) flag = cacheStrategyEnum.analysisList((List&lt;?&gt;) dbValue); // è§£æå•ä¸ªå¯¹è±¡çš„é›¶å€¼ else flag = cacheStrategyEnum.analysisCustomObject(dbValue); if (flag) redisTemplate.opsForValue().set( cacheKey, JSONObject.toJSONString(dbValue), expiredTime, timeUnit ); } return dbValue; } else { T t = JSONObject.parseObject(cacheValueString, new TypeReference&lt;T&gt;() {}); log.info(&quot;hit cache, the cache value is: {}&quot;,cacheValueString); return t; } } catch (Exception e) { log.info(&quot;query cache or db error!&quot;); return cacheAsideRequest.getDefaultValue(); }} æ€»ç»“æœ¬æ–‡ä»‹ç»äº†äº‘è®¾è®¡æ¨¡å¼ä¹‹ç¼“å­˜å¤‡ç”¨æ¨¡å¼çš„åŸºæœ¬æ¦‚å¿µå’ŒåŸç†ï¼Œç„¶åä½¿ç”¨äº†ä¸€ä¸ªè¾ƒä¸ºé€šç”¨çš„æ¨¡æ¿æ–¹æ³•å®ç°äº†ç¼“å­˜å¤‡ç”¨æ¨¡å¼ï¼Œæœ€åæˆ‘ä»¬è¿˜å¯¹æ¨¡æ¿æ–¹æ³•ä¸­ä¸€äº›å¯èƒ½å‡ºç°çš„ä¸šåŠ¡ç»†èŠ‚è¿›è¡Œäº†æ‰©å±•ï¼Œè¿™å¯¹ç°æœ‰çš„ä¸šåŠ¡ç³»ç»Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®ç°å‚è€ƒã€‚ å‚è€ƒhttps://docs.microsoft.com/en-us/previous-versions/msp-n-p/dn589799(v=pandp.10)","link":"/2021/01/03/design-patterns/cloud/cache-aside-pattern/"},{"title":"Nginxå®‰è£…ä¸å¸è½½","text":"Nginxå®‰è£…çš„ä¸¤ç§æ–¹å¼æ–¹å¼ä¸€ï¼šyumæºå®‰è£…æˆ‘ä»¬ä½¿ç”¨Nginxå®˜æ–¹çš„yumæºã€‚å¯å» http://nginx.org/en/linux_packages.html æŸ¥çœ‹ä¸»çº¿ç‰ˆå’Œç¨³å®šç‰ˆçš„yumæºï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šä½¿ç”¨ç¨³å®šç‰ˆæœ¬ã€‚ é¦–å…ˆéœ€è¦æ·»åŠ nginxå®˜æ–¹çš„yumæºæ–‡ä»¶ï¼š 1touch /etc/yum.repos.d/nginx.repo ç„¶åvimç¼–è¾‘è¯¥repoæ–‡ä»¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 12345[nginx]name=nginx repobaseurl=http://nginx.org/packages/centos/$releasever/$basearch/gpgcheck=0enabled=1 ä¿å­˜åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š 1yum install -y nginx å®‰è£…å®Œæˆåä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ï¼š 1/bin/systemctl start nginx.service æ–¹å¼äºŒï¼šæºç ç¼–è¯‘å®‰è£…å®‰è£…gccåº“nginxä½¿ç”¨cè¯­è¨€ç¼–å†™ï¼Œæºç ç¼–è¯‘æ–¹å¼éœ€è¦å®‰è£…gccç¼–è¯‘å™¨ã€‚ä¸€èˆ¬é˜¿é‡Œäº‘ç­‰äº‘æœåŠ¡å™¨å•†éƒ½ä¼šè‡ªå¸¦gccï¼Œå¦‚æœç”¨çš„æ˜¯è™šæ‹Ÿæœºï¼Œå¯ä»¥å…ˆæ£€æŸ¥æ˜¯å¦å·²å®‰è£…ã€‚ ä½¿ç”¨å‘½ä»¤gcc -vå¯æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚æœæç¤ºå‘½ä»¤æ‰¾ä¸åˆ°ï¼Œåˆ™éœ€è¦æ‰§è¡Œyum -y install gccå®‰è£…gccã€‚ pcreã€pcre-develå®‰è£…1yum install -y pcre pcre-devel pcreæ˜¯ä¸€ä¸ªperlåº“ï¼ŒåŒ…æ‹¬perlå…¼å®¹çš„æ­£åˆ™è¡¨è¾¾å¼åº“ï¼Œnginxçš„httpæ¨¡å—ä½¿ç”¨pcreæ¥è§£ææ­£åˆ™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œå®‰è£…ã€‚ zlibå®‰è£…1yum install -y zlib zlib-devel zlibåº“æä¾›äº†å¤šç§å‹ç¼©å’Œè§£å‹ç¼©çš„æ–¹å¼ï¼Œnginxä½¿ç”¨zlibå¯¹httpåŒ…çš„å†…å®¹è¿›è¡Œgzipå‹ç¼©ï¼Œæ‰€ä»¥éœ€è¦å®‰è£…ã€‚ opensslå®‰è£…1yum install -y openssl openssl-devel å¯ç”¨æ¥åŠ å¯†httpsåè®®ã€‚ ä¸‹è½½Nginxæºç åŒ…1wget http://nginx.org/download/nginx-1.18.0.tar.gz å¯ä»¥å»http://nginx.org/download/é¡µé¢æŸ¥çœ‹æ›´å¤šç‰ˆæœ¬ä¿¡æ¯ï¼Œé€‰æ‹©ç¨³å®šç‰ˆæœ¬ä¸‹è½½å³å¯ã€‚ è§£å‹å¹¶ç¼–è¯‘å®‰è£…è§£å‹è‡³å½“å‰ç›®å½•å³å¯ï¼š 1tar zxvf nginx-1.18.0.tar.gz è§£å‹å®Œæˆåè¿›å…¥nginxç›®å½•ï¼šcd nginx-1.18.0 è®¾ç½®nginxçš„å®‰è£…è·¯å¾„ï¼š 1./configure --prefix=/opt/nginx --prefixè¡¨ç¤ºå°†nginxå®‰è£…è‡³/opt/nginxç›®å½•ä¸‹ã€‚ æœ€åä¸€æ­¥ï¼Œè¿›è¡Œç¼–è¯‘å’Œå®‰è£…ï¼š 1make &amp; make install å¯åŠ¨nginxæœåŠ¡ï¼š 1/opt/nginx/sbin/nginx ./nginx è®¿é—®nginxé¦–é¡µç›´æ¥è®¿é—®äº‘æœåŠ¡å™¨çš„å…¬ç½‘ipå³å¯ã€‚ å¦‚æœæ˜¯é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œéœ€è¦å»é˜¿é‡Œäº‘æ§åˆ¶å°æ·»åŠ 80ç«¯å£è‡³è¯¥ä¸»æœºçš„å®‰å…¨ç»„å…¥ç½‘æ–¹å‘ã€‚ å¸è½½å·²å®‰è£…çš„Nginxé¦–å…ˆéœ€è¦åœæ­¢NginxæœåŠ¡ï¼š/bin/systemctl stop nginx.service å¦‚æœæ˜¯ä½¿ç”¨yumæºå®‰è£…çš„ï¼Œå¯ä½¿ç”¨å‘½ä»¤find / -name nginx*æŸ¥çœ‹nginxç›¸å…³æ–‡ä»¶ï¼Œå…ˆæ‰‹åŠ¨åˆ é™¤ä¸€äº›æºæ–‡ä»¶ï¼š 12rm -rf /usr/sbin/nginxrm -rf /etc/nginx å†ä½¿ç”¨yum remove nginxæ¸…ç†ã€‚ å¦‚æœæ˜¯æºç åŒ…ç¼–è¯‘å®‰è£…çš„ï¼Œå…ˆåœæ­¢æœåŠ¡ï¼Œç„¶ååˆ é™¤æ•´ä¸ªå®‰è£…ç›®å½•å³å¯ã€‚","link":"/2021/01/01/ops/nginx/install-nginx/"},{"title":"LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šåˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨","text":"é¢˜ç›®ï¼šå°†ä¸¤ä¸ªå‡åºé“¾è¡¨åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„å‡åºé“¾è¡¨å¹¶è¿”å›ã€‚æ–°é“¾è¡¨æ˜¯é€šè¿‡æ‹¼æ¥ç»™å®šçš„ä¸¤ä¸ªé“¾è¡¨çš„æ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼š graph LR A[1]-->B[2] B[2]-->C[4] graph LR A[1]-->B[3] B[3]-->C[4] è¾“å‡ºï¼š graph LR A[1]-->B[1] B[1]-->C[2] C[2]-->D[3] D[3]-->E[4] E[4]-->F[4] æ€è·¯ï¼š å·²çŸ¥æ¡ä»¶ï¼šä¸¤ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹l1å’Œl2ã€‚ å¯¹äºä¸¤ä¸ªå‡åºé“¾è¡¨ï¼Œå®ƒä»¬çš„é•¿åº¦ä¸ä¸€å®šç›¸ç­‰ï¼Œå½“æˆ‘ä»¬æŠŠè¾ƒçŸ­çš„é“¾è¡¨åˆå¹¶å®Œæˆåï¼Œç›´æ¥è¿æ¥è¾ƒé•¿é“¾è¡¨çš„å‰©ä½™éƒ¨åˆ†å³å¯ã€‚ æˆ‘ä»¬å¹¶ä¸çŸ¥é“å“ªä¸€ä¸ªçš„å¤´èŠ‚ç‚¹å€¼æ›´å°ï¼Œæ‰€ä»¥éœ€è¦åˆ†ç±»è®¨è®ºã€‚ é€’å½’æ³•ï¼š æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹çš„å…¬å¼å®šä¹‰æˆ‘ä»¬çš„é€’å½’mergeæ“ä½œï¼š åˆ¤æ–­l1å’Œl2å“ªä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹å€¼è¾ƒå°ï¼Œå°†è¾ƒå°çš„é‚£ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸å¦ä¸€ä¸ªé“¾è¡¨è¿›è¡Œé€’å½’mergeã€‚ é€’å½’çš„å‡ºå£ï¼šå¦‚æœé€’å½’åˆ°l1[0]æˆ–l2[0]ä¸ºnullæ—¶ï¼Œç›´æ¥è¿”å›å¦å¤–ä¸€ä¸ªé“¾è¡¨ã€‚å¦å¤–ä¸€ä¸ªé“¾è¡¨å¯èƒ½ä¹Ÿä¸ºnullï¼ˆå¦‚æœåŸé“¾è¡¨é•¿åº¦ç›¸ç­‰ï¼‰ï¼Œæˆ–è€…énullï¼ˆåŸé“¾è¡¨é•¿åº¦ä¸ç­‰ï¼‰ã€‚ å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼šæ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯† Javaè¯­è¨€å®ç°å¦‚ä¸‹ï¼š 123456789101112public static SinglyLinkedListNode mergeTwoSortedLinkedListRecursionImpl(SinglyLinkedListNode l1, SinglyLinkedListNode l2) { if (l1 == null) return l2; if (l2 == null) return l1; if (l1.val &lt; l2.val) { l1.next = mergeTwoSortedLinkedListRecursionImpl(l1.next, l2); return l1; } else { l2.next = mergeTwoSortedLinkedListRecursionImpl(l1,l2.next); return l2; }} è¿­ä»£æ³•ï¼š æ­£æ‰€è°“æ‰€æœ‰çš„é€’å½’éƒ½å¯ä»¥è½¬åŒ–æˆè¿­ä»£ã€‚ ç”±äºå¾…åˆå¹¶çš„ä¸¤ä¸ªé“¾è¡¨éƒ½æœ‰åºï¼Œåˆå¹¶åçš„å¤´èŠ‚ç‚¹è¦ä¹ˆæ˜¯l1è¦ä¹ˆæ˜¯l2ã€‚å¦‚æœæˆ‘ä»¬ä¸å¸Œæœ›ä¿®æ”¹åŸæ¥çš„é“¾è¡¨ï¼Œå°±éœ€è¦æ„é€ å‡ºä¸€ä¸ªæ–°é“¾è¡¨ï¼Œé¡ºåºè¿æ¥ä¸¤ä¸ªåŸé“¾è¡¨çš„å„ä¸ªèŠ‚ç‚¹ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå“¨å…µèŠ‚ç‚¹hairï¼Œç„¶åç»´æŠ¤ä¸€ä¸ªcuræŒ‡é’ˆï¼Œæ¯æ¬¡ä½¿ç”¨curæŒ‡é’ˆå»è¿æ¥å„ä¸ªèŠ‚ç‚¹ã€‚æˆ‘ä»¬ä¾æ¬¡æ¯”è¾ƒl1å’Œl2èŠ‚ç‚¹çš„å€¼ï¼Œå¦‚æœl1çš„å€¼å°äºl2ï¼Œåˆ™ç”¨curè¿æ¥l1ï¼Œç„¶ål1å³ç§»ï¼›å¦åˆ™ï¼Œç”¨curè¿æ¥l2ï¼Œç„¶ål2å³ç§»ã€‚ç›´åˆ°l1æˆ–è€…l2ä¸ºnullï¼Œå°†å¦ä¸€ä¸ªèŠ‚ç‚¹çš„å‰©ä½™èŠ‚ç‚¹è¿æ¥è‡³curï¼Œç„¶åå†è¿”å›hair.nextï¼Œå³ä¸ºåˆå¹¶åé“¾è¡¨çš„æ–°å¤´èŠ‚ç‚¹ã€‚ å“¨å…µèŠ‚ç‚¹hairï¼šæŒ‡é’ˆåŸŸnextæŒ‡å‘çš„èŠ‚ç‚¹å³ä¸ºåˆå¹¶åçš„é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚ Javaè¯­è¨€å®ç°å¦‚ä¸‹ï¼š 1234567891011121314151617181920public static SinglyLinkedListNode mergeTwoSortedLinkedList(SinglyLinkedListNode l1, SinglyLinkedListNode l2) { if (l1 == null) return l2; if (l2 == null) return l1; SinglyLinkedListNode hair = new SinglyLinkedListNode(); SinglyLinkedListNode cur = hair; while (l1 != null &amp;&amp; l2 != null) { if (l1.val &lt; l2.val) { cur.next = l1; l1 = l1.next; } else { cur.next = l2; l2 = l2.next; } cur = cur.next; } if (l1 == null) cur.next = l2; if (l2 == null) cur.next = l1; return hair.next;}","link":"/2020/12/29/algorithm/leetcode/tag/linkedlist/merge-two-sorted-lists/"},{"title":"LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šåˆ é™¤ä¸­é—´èŠ‚ç‚¹","text":"é¢˜ç›®ï¼šå®ç°ä¸€ç§ç®—æ³•ï¼Œåˆ é™¤å•å‘é“¾è¡¨ä¸­é—´çš„æŸä¸ªèŠ‚ç‚¹ï¼ˆå³ä¸æ˜¯ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œå‡å®šä½ åªèƒ½è®¿é—®è¯¥èŠ‚ç‚¹ã€‚ ç¤ºä¾‹ï¼š graph LR A[a]-->B[b] B[b]-->C[c] C[c]-->D[d] D[d]-->E[e] 12è¾“å…¥ï¼šèŠ‚ç‚¹cç»“æœï¼šä¸è¿”å›ä»»ä½•æ•°æ®ï¼Œå°†èŠ‚ç‚¹cä»åŸé“¾è¡¨ä¸­åˆ é™¤ã€‚ æ€è·¯ï¼šè¿™é¢˜çš„æ€è·¯æœ‰ç‚¹æ„æ€ã€‚é¦–å…ˆæˆ‘ä»¬åªèƒ½è®¿é—®åˆ°èŠ‚ç‚¹cï¼ŒæŒ‰ç…§å¸¸è§„æ€è·¯ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ é™¤èŠ‚ç‚¹cï¼Œå°±è¦å°†cçš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹bæŒ‡å‘cçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹dï¼Œä½†æˆ‘ä»¬åªèƒ½è®¿é—®èŠ‚ç‚¹cå’Œdï¼Œç”±äºå•å‘é“¾è¡¨çš„ç‰¹æ€§ï¼ŒèŠ‚ç‚¹bæˆ‘ä»¬æ˜¯æ— æ³•è®¿é—®çš„ã€‚é‚£æˆ‘ä»¬è¯¥å¦‚ä½•â€œç¥ä¸çŸ¥é¬¼ä¸è§‰â€çš„åˆ é™¤èŠ‚ç‚¹cå‘¢ï¼Ÿ â€œå·å¤©æ¢æ—¥â€ï¼šæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®©bæŒ‡å‘dï¼Œä½†æˆ‘ä»¬æ— æ³•ç›´æ¥æ“ä½œbï¼Œè€Œbåˆä¸€ç›´æŒ‡å‘cï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠcæ›¿æ¢ä¸ºdï¼Œç„¶åå†æŠŠdåˆ é™¤å³å¯ã€‚ åˆ ä¸æ‰æˆ‘è‡ªå·±(c)ï¼Œæˆ‘å°±å˜æˆä½ (d)ï¼Œå†åˆ æ‰ä½ (d)ï¼Œå°±ç­‰äºåˆ æ‰æˆ‘è‡ªå·±(c)ã€‚ Javaè¯­è¨€å®ç°å¦‚ä¸‹ï¼š å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼šæ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯† 123456public void deleteNode(SinglyLinkedListNode node) { SinglyLinkedListNode next = node.next; node.val = next.val; node.next = next.next; next = null;}","link":"/2020/12/27/algorithm/leetcode/tag/linkedlist/delete-middle-node-lcci/"},{"title":"LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šè¿”å›å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹","text":"é¢˜ç›®ï¼šå®ç°ä¸€ç§ç®—æ³•ï¼Œæ‰¾å‡ºå•å‘é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹ã€‚è¿”å›è¯¥èŠ‚ç‚¹çš„å€¼ã€‚ Leetcodeåœ¨çº¿OJç³»ç»Ÿï¼šä¼ é€é—¨ ç¤ºä¾‹ï¼š graph LR A[1]-->B[2] B[2]-->C[3] C[3]-->D[4] D[4]-->E[5] 12è¾“å…¥ï¼šk = 2è¾“å‡ºï¼š4 è¯´æ˜ï¼šç»™å®šçš„ k ä¿è¯æ˜¯æœ‰æ•ˆçš„ã€‚ æ€è·¯ï¼šåŒæŒ‡é’ˆæ³•ã€‚å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆfirstå’Œsecondï¼ŒfirstæŒ‡é’ˆå…ˆèµ°k - 1æ­¥ï¼Œç„¶åsecondæŒ‡é’ˆå’ŒfirstæŒ‡é’ˆåŒæ—¶èµ°ï¼Œæ¯æ¬¡èµ°ä¸€æ­¥ï¼Œå½“firstæŒ‡é’ˆåˆ°è¾¾é“¾è¡¨æœ«å°¾æ—¶ï¼ŒsecondæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹å³ä¸ºå€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹ã€‚ Javaè¯­è¨€å®ç°å¦‚ä¸‹ï¼š å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼šæ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯† 12345678910111213141516171819public static int kthToLast(SinglyLinkedListNode head, int k) { if (head == null || k &lt;= 0) { return 0; } SinglyLinkedListNode first = head; SinglyLinkedListNode second = head; while (k-- &gt; 1) { // é•¿åº¦ä¸è¶³k if (first.next == null) { return 0; } first = first.next; } while (first.next != null) { first = first.next; second = second.next; } return second.val}","link":"/2020/12/23/algorithm/leetcode/tag/linkedlist/kth-node-from-end-of-list-lcci/"},{"title":"æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯","text":"é¢˜ç›®ï¼šåˆ¤æ–­ç»™å®šçš„é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚å¦‚æœæœ‰ç¯åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚ä½ èƒ½ç»™å‡ºç©ºé—´å¤æ‚åº¦O(1)çš„è§£æ³•ä¹ˆï¼Ÿ Leetcodeåœ¨çº¿OJç³»ç»Ÿï¼šä¼ é€é—¨ ç¤ºä¾‹1ï¼š graph LR A[3]-->B[2] B[2]-->C[0] C[0]-->D[-4] D[-4]-->B[2] 12è¾“å‡ºï¼štrueè§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œç”± -4 æŒ‡å‘ 2 ç¤ºä¾‹2: graph LR A[1]-->B[2] B[2]-->A[1] 12è¾“å‡ºï¼š`true`è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œç”± 2 æŒ‡å‘ 1 ç¤ºä¾‹3ï¼š graph LR A[1] 12è¾“å‡ºï¼š`false`è§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯ æ€è·¯ï¼šå°†é“¾è¡¨æƒ³è±¡æˆæ ¡å›­é‡Œçš„æ“åœºï¼Œä¸¤ä½åŒå­¦ä»åŒä¸€èµ·ç‚¹å¼€å§‹æ¯”èµ›è·‘æ­¥ï¼Œå‡ºå‘åï¼Œå¦‚æœä¸¤ä½åŒå­¦çš„è·‘æ­¥é€Ÿåº¦ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆè·‘è¿‡è‹¥å¹²åœˆåï¼Œä»–ä»¬ä¸€å®šä¼šåœ¨è·‘é“çš„æŸå¤„ç›¸é‡ï¼Œä¸”è·‘çš„å¿«çš„åŒå­¦æ°å¥½æ¯”è·‘çš„æ…¢çš„åŒå­¦å¤šè·‘ä¸€åœˆã€‚è¿™æ˜¯ç‰©ç†è¿åŠ¨å­¦ä¸Šçš„ç»å…¸è¿½å‡»é—®é¢˜ã€‚ å¯¹äºé“¾è¡¨æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€å¿«ä¸€æ…¢ä¸¤ä¸ªæŒ‡é’ˆï¼Œè®©å®ƒä»¬åŒæ—¶ä»å¤´èŠ‚ç‚¹åŒæ—¶å‡ºå‘ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡èµ°ä¸€æ­¥ï¼Œå¦‚æœå®ƒä»¬æœ€ç»ˆèƒ½åœ¨æŸå¤„â€œç›¸é‡â€ï¼Œè¯´æ˜é“¾è¡¨æœ‰ç¯ï¼Œå¦‚æœå¿«æŒ‡é’ˆèµ°åˆ°é“¾è¡¨æœ«å°¾éƒ½æ²¡æœ‰è¿½ä¸Šèµ°çš„æ…¢çš„æŒ‡é’ˆï¼Œè¯´æ˜é“¾è¡¨æ— ç¯ã€‚ ä»¥ä¸Šçš„æ€è·¯ä¿—ç§°ï¼šâ€œå¿«æ…¢æŒ‡é’ˆæ³•â€ï¼›å­¦åï¼šFloydåˆ¤åœˆç®—æ³•ã€‚ Floydåˆ¤åœˆç®—æ³•ï¼ˆFloyd Cycle Detection Algorithmï¼‰ï¼Œåˆç§°é¾Ÿå…”èµ›è·‘ç®—æ³•(Tortoise and Hare Algorithm),æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨æœ‰é™çŠ¶æ€æœºã€è¿­ä»£å‡½æ•°æˆ–è€…é“¾è¡¨ä¸Šåˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¯ï¼Œä»¥åŠåˆ¤æ–­ç¯çš„èµ·ç‚¹ä¸é•¿åº¦çš„ç®—æ³•ã€‚ Javaè¯­è¨€å®ç°å¦‚ä¸‹ï¼š å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼šæ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯† 123456789101112131415public static boolean hasCycle(SinglyLinkedListNode head) { if (head == null || head.next == null) { return false; } SinglyLinkedListNode fast = head; SinglyLinkedListNode slow = head; while (fast != null &amp;&amp; fast.next != null) { fast = fast.next.next; slow = slow.next; if (fast == slow) { return true; } } return false;}","link":"/2020/12/22/algorithm/base/datastructure/link-has-cycle/"},{"title":"åŠ¨æ‰‹å®ç°Lombok","text":"Javacç¼–è¯‘å™¨æåˆ°ç¼–è¯‘å™¨ï¼Œå¯èƒ½å¾ˆå¤šåç«¯ç ”å‘å·¥ç¨‹å¸ˆåªæ˜¯åœ¨è„‘æµ·ä¸­æœ‰ä¸€ä¸ªæ¨¡ç³Šçš„æ¦‚å¿µï¼Œæˆ‘ä¹Ÿæ˜¯è¿™æ ·ï¼Œå› ä¸ºä¸šåŠ¡å¼€å‘ä¸­å‡ ä¹ä½¿ç”¨ä¸åˆ°ã€‚æˆ‘ä»¬éƒ½å·¥ä½œåœ¨ç¼–è¯‘å™¨çš„ä¸Šå±‚ã€‚ å¯¹äºJavaè¯­è¨€æ¥è¯´ï¼Œå®ƒçš„æ•´ä¸ªç¼–è¯‘æœŸæ˜¯ä¸ç¡®å®šçš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å†™çš„.javaç±»æ–‡ä»¶éœ€è¦è¢«ç¼–è¯‘æˆ.classå­—èŠ‚ç æ–‡ä»¶ç„¶ååŠ è½½è‡³è™šæ‹Ÿæœºä¸­ï¼Œ.classå­—èŠ‚ç æ–‡ä»¶éœ€è¦è¢«ç¼–è¯‘æˆæœºå™¨ç è¿›è¡Œæ‰§è¡Œï¼Œå½“ç„¶ä¹Ÿæœ‰ç›´æ¥å°†.javaç±»æ–‡ä»¶ç¼–è¯‘æˆæœºå™¨ç çš„ç¼–è¯‘å™¨ã€‚ Javacç¼–è¯‘å™¨æ˜¯ä¸€ä¸ªå°†.javaæ–‡ä»¶ç¼–è¯‘æˆ.classå­—èŠ‚ç çš„ç¼–è¯‘å™¨ï¼Œå®ƒå¯ä»¥åœ¨ä¸æ”¹å˜åº•å±‚è™šæ‹Ÿæœºçš„æƒ…å†µä¸‹å¯¹ç¨‹åºç¼–ç è¿›è¡Œç¼–è¯‘æœŸçš„ä¼˜åŒ–ï¼Œå³ï¼šè¯­æ³•ç³–ã€‚ ä»sunå…¬å¸æä¾›çš„Javacç¼–è¯‘å™¨ä»£ç ï¼ˆæºç åœ¨JDKçš„tool.jaråŒ…ä¸­ï¼‰å®ç°æ¥çœ‹ï¼Œç¼–è¯‘çš„è¿‡ç¨‹å¯åˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š Parse and Enterï¼šè§£æä¸å¡«å……ç¬¦å·è¡¨ï¼Œç¼–è¯‘å™¨ä¼šå°†Javaæ–‡ä»¶è§£ææˆAbstract Syntax Treeï¼ˆASTï¼‰æŠ½è±¡è¯­æ³•æ ‘ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šæ ¡éªŒè¯­æ³•çš„æ­£ç¡®æ€§ç­‰ã€‚ Annotation Processingï¼šæ’å…¥å¼æ³¨è§£å¤„ç†å™¨çš„æ³¨è§£å¤„ç†ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥å¯¹è¯­æ³•æ ‘è¿›è¡Œç›¸å…³æ“ä½œã€‚ Analyse and Generateï¼šåˆ†æè¯­æ³•æ ‘ä¸å­—èŠ‚ç ç”Ÿæˆã€‚ åœ¨JDK5åï¼ŒJavaè¯­è¨€å¼•å…¥äº†æ³¨è§£ï¼Œè¿™äº›æ³¨è§£ä¸æ™®é€šçš„Javaç±»ä¸€æ ·ï¼Œæ˜¯åœ¨è¿è¡ŒæœŸé—´å‘æŒ¥ä½œç”¨çš„ã€‚JDK6å®ç°äº†JSR-269è§„èŒƒï¼Œæä¾›å‡ºä¸€ç»„æ’å…¥å¼æ³¨è§£å¤„ç†å™¨çš„æ ‡å‡†APIåœ¨ç¼–è¯‘æœŸé—´å¯¹æ³¨è§£è¿›è¡Œå¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ç»„ç¼–è¯‘å™¨çš„æ’ä»¶ï¼Œæˆ–è€…ç§°ä¸ºé’©å­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›APIå¯¹ç¬¬ä¸€é˜¶æ®µäº§ç”Ÿçš„è¯­æ³•æ ‘è¿›è¡Œä¿®æ”¹ï¼Œä¸€æ—¦è¯­æ³•æ ‘è¢«ä¿®æ”¹ï¼Œç¼–è¯‘å™¨å°†ä¼šå›åˆ°ç¬¬ä¸€é˜¶æ®µé‡æ–°è§£æä¸å¡«å……ç¬¦å·è¡¨ï¼Œç›´åˆ°æ‰€æœ‰çš„æ’å…¥å¼æ³¨è§£å¤„ç†å™¨éƒ½æ²¡æœ‰å†å¯¹è¯­æ³•æ ‘è¿›è¡Œä¿®æ”¹ä¸ºæ­¢ï¼Œæ¯ä¸€æ¬¡å›åˆ°ç¬¬ä¸€é˜¶æ®µç§°ä¸ºä¸€æ¬¡Roundã€‚ Javacç¼–è¯‘å™¨çš„æºç æ˜¯com.sun.tools.javac.main.JavaCompilerç±»ï¼Œç¼–è¯‘çš„æ–¹æ³•æ˜¯com.sun.tools.javac.main.JavaCompiler#compileï¼Œå…¶ä¸­æ’å…¥æ³¨è§£å¤„ç†å™¨çš„åˆå§‹åŒ–è¿‡ç¨‹æ˜¯åœ¨this.initProcessAnnotations(var3);æ–¹æ³•ä¸­å®Œæˆçš„ï¼›æ‰§è¡Œè¿‡ç¨‹æ˜¯åœ¨com.sun.tools.javac.main.JavaCompiler#processAnnotationsæ–¹æ³•ä¸­å®Œæˆçš„ï¼Œè¯¥æ–¹æ³•ä¸­åˆ¤æ–­æ˜¯å¦è¿˜æœ‰æ–°çš„æ³¨è§£å¤„ç†å™¨éœ€è¦æ‰§è¡Œï¼Œå¦‚æœæœ‰çš„è¯ï¼Œé€šè¿‡com.sun.tools.javac.processing.JavacProcessingEnvironment#doProcessingæ–¹æ³•å¾—åˆ°ä¸€ä¸ªæ–°çš„JavaCompilerç±»å¯¹è±¡ç»§ç»­åç»­çš„å¤„ç†ã€‚ Lombokçš„åŸç†Lombokæ­£æ˜¯åˆ©ç”¨Javacç¼–è¯‘å™¨çš„ç¬¬äºŒé˜¶æ®µè¿›è¡Œå®ç°çš„ï¼Œä½¿ç”¨çš„ä¹Ÿæ­£æ˜¯JDK6æä¾›çš„JSR-269å®ç°ã€‚åœ¨ç¼–è¯‘æœŸæ“ä½œè¯­æ³•æ ‘ï¼Œå®ç°å­—èŠ‚ç çš„åŠ¨æ€ç”Ÿæˆã€‚ é€ è½®å­æˆ‘ä»¬è¦å®ç°çš„æ˜¯ä¸€ä¸ªç®€æ˜“çš„Lombokï¼Œä¸€ä¸ªæ³¨è§£åœ¨ç¼–è¯‘æœŸåŒæ—¶ç”Ÿæˆgetterå’Œsetteræ–¹æ³•ã€‚ è‡ªå®šä¹‰æ³¨è§£é¦–å…ˆè¦å®šä¹‰ä¸€ä¸ªæ³¨è§£@GetterAndSetterï¼š 1234567891011import java.lang.annotation.*;/** * @author sunchaser admin@lilu.org.cn * @since JDK8 2020/12/15 */@Target(ElementType.TYPE)@Retention(RetentionPolicy.SOURCE)@Documentedpublic @interface GetterAndSetter {} è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨ç„¶åå®šä¹‰ä¸€ä¸ªå¤„ç†@GetterAndSetteræ³¨è§£çš„å¤„ç†å™¨GetterAndSetterProcessorï¼Œæ‰€æœ‰çš„å¤„ç†å™¨éƒ½å»ºè®®å»ç»§æ‰¿javax.annotation.processing.AbstractProcessoræŠ½è±¡ç±»ï¼Œå®ƒæä¾›äº†ä¸€äº›åŸºæœ¬å®ç°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108import com.google.auto.service.AutoService;import com.sun.source.util.Trees;import com.sun.tools.javac.processing.JavacProcessingEnvironment;import com.sun.tools.javac.tree.JCTree;import com.sun.tools.javac.tree.TreeMaker;import com.sun.tools.javac.util.Context;import com.sun.tools.javac.util.Names;import org.sunchaser.lombok.impl.annotation.GetterAndSetter;import javax.annotation.processing.*;import javax.lang.model.SourceVersion;import javax.lang.model.element.Element;import javax.lang.model.element.TypeElement;import javax.tools.Diagnostic;import java.util.Set;/** * è‡ªå®šä¹‰@GetterAndSetteræ³¨è§£çš„æ’å…¥å¤„ç†å™¨ * @author sunchaser admin@lilu.org.cn * @since JDK8 2020/12/15 */@SupportedAnnotationTypes({&quot;org.sunchaser.lombok.impl.annotation.GetterAndSetter&quot;})@SupportedSourceVersion(SourceVersion.RELEASE_8)@AutoService(Processor.class)public class GetterAndSetterProcessor extends AbstractProcessor { /** * å¯å°†Elementè½¬æ¢æˆJCTreeï¼Œç»„æˆASTè¯­æ³•æ ‘ã€‚ä½¿ç”¨Trees.instance(processingEnv);è¿›è¡Œåˆå§‹åŒ–ã€‚ */ private Trees trees; /** * æ„é€ JCTreeçš„å·¥å…·ç±»ã€‚ä½¿ç”¨TreeMaker.instance(((JavacProcessingEnvironment) processingEnv).getContext());åˆå§‹åŒ–ã€‚ */ private TreeMaker treeMaker; /** * åå­—å¤„ç†å·¥å…·ç±»ã€‚ä½¿ç”¨Names.instance(context);è¿›è¡Œåˆå§‹åŒ–ã€‚ */ private Names names; /** * ç¼–è¯‘æœŸçš„æ—¥å¿—æ‰“å°å·¥å…·ç±»ã€‚ä½¿ç”¨processingEnv.getMessager();è¿›è¡Œåˆå§‹åŒ– */ private Messager messager; /** * init åˆå§‹åŒ– * @param processingEnv ç¯å¢ƒï¼šæä¾›ä¸€äº›Javacçš„æ‰§è¡Œå·¥å…· */ @Override public synchronized void init(ProcessingEnvironment processingEnv) { super.init(processingEnv); this.messager = processingEnv.getMessager(); this.trees = Trees.instance(processingEnv); Context context = ((JavacProcessingEnvironment) processingEnv).getContext(); this.treeMaker = TreeMaker.instance(context); this.names = Names.instance(context); } /** * å…·ä½“çš„æ‰§è¡Œ * @param annotations æ³¨è§£é›†åˆ * @param roundEnv æ‰§è¡Œroundç¯å¢ƒ * @return æ‰§è¡Œç»“æœ */ @Override public boolean process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv) { messager.printMessage(Diagnostic.Kind.NOTE,&quot;roundEnv ---&gt;&quot; + roundEnv); if (!roundEnv.processingOver()) { // æ‰€æœ‰@GetterAndSetteræ³¨è§£æ ‡æ³¨çš„ç±» Set&lt;? extends Element&gt; annotated = roundEnv.getElementsAnnotatedWith(GetterAndSetter.class); annotated.forEach(element -&gt; { // è·å¾—å½“å‰éå†ç±»çš„è¯­æ³•æ ‘ JCTree tree = (JCTree) trees.getTree(element); // ä½¿ç”¨GetterAndSetterTreeTranslatorå¤„ç† tree.accept(new GetterAndSetterTreeTranslator(treeMaker, names, messager)); }); } // è¿”å›trueï¼šJavacç¼–è¯‘å™¨ä¼šä»ç¼–è¯‘æœŸçš„ç¬¬äºŒé˜¶æ®µå›åˆ°ç¬¬ä¸€é˜¶æ®µ return true; } /** * è·å–å½“å‰å¤„ç†å™¨æ”¯æŒçš„æ³¨è§£ç±»å‹é›†åˆ * * JDK7åå¯ç”¨æ³¨è§£@SupportedAnnotationTypesä»£æ›¿è¯¥æ–¹æ³• * * @return æ³¨è§£ç±»å…¨é™å®šç±»åå­—ç¬¦ä¸²çš„é›†åˆ */ @Override public Set&lt;String&gt; getSupportedAnnotationTypes() { return super.getSupportedAnnotationTypes(); } /** * è·å–æ”¯æŒçš„JDKç‰ˆæœ¬ * * JDK7åå¯ç”¨æ³¨è§£@SupportedSourceVersionä»£æ›¿è¯¥æ–¹æ³• * * @return JDKç‰ˆæœ¬ */ @Override public SourceVersion getSupportedSourceVersion() { return SourceVersion.latestSupported(); }} æ³¨è§£å¤„ç†å™¨çš„å®ç°ç»†èŠ‚ä¸»è¦æ–¹æ³•æˆ‘ä»¬æ¥çœ‹ä¸‹å­ç±»ä¸­å®ç°çš„ä¸»è¦æ–¹æ³•ï¼š init(ProcessingEnvironment processingEnv)åˆå§‹åŒ–æ–¹æ³•ï¼Œåœ¨çˆ¶æŠ½è±¡ç±»ä¸­å¯¹å…¥å‚ProcessingEnvironmentå¯¹è±¡è¿›è¡Œäº†åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡å¾—åˆ°å¾ˆå¤šå·¥å…·ç±»ï¼Œä¾‹å¦‚Treesã€TreeMakerå’ŒNamesç­‰ç­‰ã€‚ processçˆ¶ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œå­ç±»è¿›è¡Œå…·ä½“çš„å¤„ç†å®ç°ã€‚è¾“å…¥å‚æ•°RoundEnvironmentä»£è¡¨æ¯ä¸€æ¬¡Roundçš„ç¯å¢ƒã€‚ getSupportedAnnotationTypesæŒ‡å®šå½“å‰å¤„ç†å™¨æ˜¯ç”¨æ¥å¤„ç†å“ªä¸ªæ³¨è§£çš„ï¼Œè¿”å›å€¼æ˜¯éœ€è¦å¤„ç†çš„æ³¨è§£çš„å…¨é™å®šç±»åå­—ç¬¦ä¸²çš„é›†åˆã€‚åœ¨JDK7åï¼Œçˆ¶æŠ½è±¡ç±»åŸºäº@SupportedAnnotationTypesæ³¨è§£è¿›è¡Œäº†å®ç°ï¼Œå­ç±»ä¸­å¯ä¸é‡å†™è¯¥æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨æ³¨è§£ï¼š@SupportedAnnotationTypes({&quot;org.sunchaser.lombok.impl.annotation.GetterAndSetter&quot;})å³å¯ã€‚ getSupportedSourceVersionæŒ‡å®šæ”¯æŒçš„JDKç‰ˆæœ¬ï¼Œè¿™é‡Œé€šå¸¸è¿”å›SourceVersion.latestSupported()æœ€æ–°ç‰ˆæœ¬ã€‚åœ¨JDK7åï¼Œçˆ¶æŠ½è±¡ç±»åŸºäº@SupportedSourceVersionæ³¨è§£è¿›è¡Œäº†å®ç°ï¼Œå­ç±»ä¸­å¯ä¸é‡æ–°è¿›è¡Œå®ç°ï¼Œç›´æ¥ä½¿ç”¨æ³¨è§£ï¼š@SupportedSourceVersion(SourceVersion.RELEASE_8)å³å¯ã€‚ å·¥å…·ç±»ä»‹ç»ä¸‹é¢ä»‹ç»ä¸€ä¸‹initæ–¹æ³•ä¸­åˆå§‹åŒ–çš„ä¸€äº›å·¥å…·ç±»ï¼š javax.annotation.processing.Messagerç¼–è¯‘æœŸçš„æ—¥å¿—æ‰“å°å·¥å…·ç±»ã€‚ä½¿ç”¨processingEnv.getMessager();è¿›è¡Œåˆå§‹åŒ–ã€‚ javax.lang.model.element.Elementå¯¹ä¸€ä¸ª.javaæ–‡ä»¶ç»“æ„çš„å»ºæ¨¡ã€‚ä¸€ä¸ªJavaç±»è¢«åˆ’åˆ†ä¸ºå„ä¸ªElementï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰å¯¹åº”çš„å­ç±»å®ç°ã€‚ ä¾‹å¦‚ï¼š 123456789101112package com.sunchaser; /** PackageElement **/public class Foo { /** TypeElement **/ private String str; /** VariableElement **/ private Foo foo; /** VariableElement **/ public Foo() {} /** ExecuteableElement **/ public void setStr( String str /** TypeElement **/ ) { this.str = str; /** ExecuteableElement **/ }} com.sun.source.util.Treeså¯å°†Elementè½¬æ¢æˆJCTreeï¼Œç»„æˆASTè¯­æ³•æ ‘ã€‚ä½¿ç”¨Trees.instance(processingEnv);è¿›è¡Œåˆå§‹åŒ–ã€‚ com.sun.tools.javac.tree.TreeMakeræ„é€ JCTreeçš„å·¥å…·ç±»ã€‚ä½¿ç”¨TreeMaker.instance(((JavacProcessingEnvironment) processingEnv).getContext());è¿›è¡Œåˆå§‹åŒ–ã€‚ com.sun.tools.javac.util.Namesåå­—å¤„ç†å·¥å…·ç±»ã€‚ä½¿ç”¨Names.instance(context);è¿›è¡Œåˆå§‹åŒ–ã€‚æ— è®ºæ˜¯ç±»ã€æ–¹æ³•ã€å˜é‡æˆ–è€…å‚æ•°çš„åç§°éƒ½éœ€è¦æ­¤ç±»æ¥åˆ›å»ºï¼Œå¸¸ç”¨å½¢å¼ä¸ºnames.fromString(&quot;setNameXXX&quot;)ã€‚ com.sun.tools.javac.util.List1234567891011121314151617181920212223242526272829303132333435363738394041public class List&lt;A&gt; extends AbstractCollection&lt;A&gt; implements java.util.List&lt;A&gt; { public A head; public List&lt;A&gt; tail; /** nil()æ–¹æ³•è¿”å›çš„ç©ºé›†åˆ **/ private static final List&lt;?&gt; EMPTY_LIST = new List&lt;Object&gt;((Object)null, (List)null) { public List&lt;Object&gt; setTail(List&lt;Object&gt; var1) { throw new UnsupportedOperationException(); } public boolean isEmpty() { return true; } }; /** * è¿”å›ç©ºé›†åˆ */ public static &lt;A&gt; List&lt;A&gt; nil() { return EMPTY_LIST; } /** ä»¥ä¸‹æ˜¯ä¸€ç³»åˆ—é‡è½½çš„ofæ–¹æ³•ï¼Œç”¨æ¥åˆ›å»ºList **/ public static &lt;A&gt; List&lt;A&gt; of(A var0) { return new List(var0, nil()); } public static &lt;A&gt; List&lt;A&gt; of(A var0, A var1) { return new List(var0, of(var1)); } public static &lt;A&gt; List&lt;A&gt; of(A var0, A var1, A var2) { return new List(var0, of(var1, var2)); } public static &lt;A&gt; List&lt;A&gt; of(A var0, A var1, A var2, A... var3) { return new List(var0, new List(var1, new List(var2, from(var3)))); } ....} åœ¨è¿™å¥—æŠ½è±¡è¯­æ³•æ ‘çš„å®ç°ä¸­ï¼Œæ‰€æœ‰çš„Listéƒ½ä½¿ç”¨çš„æ˜¯com.sun.tools.javac.util.Listï¼Œè€Œä¸æ˜¯java.util.ArrayListã€‚è¿™æ˜¯ä¸€ä¸ªé“¾å¼Listï¼Œå°¾èŠ‚ç‚¹ä¸ºé›†åˆã€‚å¸¸ç”¨çš„æ–¹æ³•æœ‰List.nil()å’ŒList.of()ã€‚ JCTreeä»‹ç»JCTreeæ˜¯è¯­æ³•æ ‘å…ƒç´ çš„åŸºç±»ï¼ŒåŒ…å«ä¸€ä¸ªé‡è¦çš„å­—æ®µposï¼Œè¯¥å­—æ®µç”¨æ¥æŒ‡æ˜å½“å‰è¯­æ³•æ ‘èŠ‚ç‚¹JCTreeåœ¨è¯­æ³•æ ‘ä¸­çš„ä½ç½®ã€‚com.sun.tools.javac.tree.JCTreeæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸”å­ç±»çš„æ„é€ å‡½æ•°éƒ½æ˜¯protectedçš„ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ä½¿ç”¨newå…³é”®å­—åˆ›å»ºè¯­æ³•æ ‘å…ƒç´ èŠ‚ç‚¹ï¼Œè€Œæ˜¯ä½¿ç”¨è®¿é—®è€…è®¾è®¡æ¨¡å¼è¿›è¡Œåˆ›å»ºã€‚ ä¸‹é¢ä»‹ç»å‡ ä¸ªé‡è¦çš„å­ç±»ï¼š com.sun.tools.javac.tree.JCTree.JCStatementï¼šå£°æ˜è¯­æ³•æ ‘èŠ‚ç‚¹ï¼Œä»ç„¶æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸‹é¢æ˜¯å¸¸ç”¨å­ç±»ï¼š com.sun.tools.javac.tree.JCTree.JCBlockï¼šè¯­å¥å—è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚ com.sun.tools.javac.tree.JCTree.JCReturnï¼šreturnè¯­å¥è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚ com.sun.tools.javac.tree.JCTree.JCClassDeclï¼šç±»å®šä¹‰è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚ com.sun.tools.javac.tree.JCTree.JCVariableDeclï¼šå­—æ®µ/å˜é‡å®šä¹‰è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚ com.sun.tools.javac.tree.JCTree.JCMethodDeclï¼šæ–¹æ³•å®šä¹‰è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚ com.sun.tools.javac.tree.JCTree.JCModifiersï¼šè®¿é—®æ ‡å¿—è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚ com.sun.tools.javac.tree.JCTree.JCExpressionï¼šè¡¨è¾¾å¼è¯­æ³•æ ‘èŠ‚ç‚¹ï¼Œä»ç„¶æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸‹é¢æ˜¯å¸¸ç”¨å­ç±»ï¼š com.sun.tools.javac.tree.JCTree.JCAssignï¼šèµ‹å€¼è¯­å¥è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚ com.sun.tools.javac.tree.JCTree.JCIdentï¼šæ ‡å¿—ç¬¦è¯­æ³•æ ‘èŠ‚ç‚¹ï¼Œå¯ä»¥æ˜¯å˜é‡ã€ç±»å‹å’Œå…³é”®å­—ç­‰ç­‰ã€‚ TreeMakerä»‹ç»TreeMakerç”¨äºåˆ›å»ºä¸€ç³»åˆ—çš„è¯­æ³•æ ‘èŠ‚ç‚¹ï¼Œä¸Šé¢è¯´åˆ°åˆ›å»ºJCTreeè¯­æ³•æ ‘èŠ‚ç‚¹ä¸èƒ½ç›´æ¥ä½¿ç”¨newå…³é”®å­—åˆ›å»ºï¼Œæ‰€ä»¥æ‰æœ‰äº†TreeMakerå·¥å…·ç±»ï¼Œå®ƒä¼šåœ¨åˆ›å»ºæ—¶ä¸ºJCTreeå¯¹è±¡è®¾ç½®poså­—æ®µï¼Œå¿…é¡»ä½¿ç”¨ä¸Šä¸‹æ–‡ç›¸å…³çš„TreeMakerå¯¹è±¡æ¥åˆ›å»ºè¯­æ³•æ ‘èŠ‚ç‚¹ã€‚ ä¸‹é¢ä»‹ç»å‡ ä¸ªå¸¸ç”¨æ–¹æ³•ï¼š TreeMaker.Modifiersç”¨äºåˆ›å»ºè®¿é—®æ ‡å¿—çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCModifiersï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 123456789101112131415public JCModifiers Modifiers(long flags) { return this.Modifiers(flags, List.nil());}/** * ç”¨äºåˆ›å»ºè®¿é—®æ ‡å¿—çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param flags è®¿é—®æ ‡å¿— * @param annotations æ³¨è§£åˆ—è¡¨ */public JCModifiers Modifiers(long flags, List&lt;JCAnnotation&gt; annotations) { JCModifiers tree = new JCModifiers(flags, annotations); boolean noFlags = (flags &amp; 8796093033983L) == 0L; tree.pos = noFlags &amp;&amp; annotations.isEmpty() ? -1 : this.pos; return tree;} å…¶ä¸­flagså¯ä»¥ä½¿ç”¨æšä¸¾ç±»com.sun.tools.javac.code.Flagsï¼Œä¾‹å¦‚treeMaker.Modifiers(Flags.PUBLIC + Flags.STATIC + Flags.FINAL)åˆ›å»ºçš„è¯­æ³•æ ‘èŠ‚ç‚¹ä¸ºï¼špublic static finalã€‚ TreeMaker.ClassDefç”¨äºåˆ›å»ºç±»å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCClassDeclï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 12345678910111213141516171819/** * ç”¨äºåˆ›å»ºç±»å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param modifiers è®¿é—®æ ‡è¯†ï¼Œå¯é€šè¿‡treeMaker.Modifiersåˆ›å»º * @param name ç±»å * @param typeParameter æ³›å‹å‚æ•°åˆ—è¡¨ * @param extending çˆ¶ç±» * @param implementing å®ç°çš„æ¥å£é›†åˆ * @param defs ç±»å®šä¹‰çš„è¯¦ç»†è¯­å¥ï¼ŒåŒ…æ‹¬å­—æ®µã€æ–¹æ³•çš„å®šä¹‰ç­‰ç­‰ */public JCClassDecl ClassDef(JCModifiers modifiers, Name name, List&lt;JCTypeParameter&gt; typeParameter, JCExpression extending, List&lt;JCExpression&gt; implementing, List&lt;JCTree&gt; defs) { JCClassDecl tree = new JCClassDecl(modifiers, name, typeParameter, extending, implementing, defs, (ClassSymbol)null); tree.pos = this.pos; return tree;} TreeMaker.VarDefç”¨äºåˆ›å»ºå­—æ®µ/å˜é‡å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCVariableDeclï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 123456789101112131415/** * ç”¨äºåˆ›å»ºå­—æ®µ/å˜é‡å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param modifiers è®¿é—®æ ‡å¿—ï¼Œå¯é€šè¿‡treeMaker.Modifiersåˆ›å»º * @param name å­—æ®µ/å˜é‡åç§° * @param varType å­—æ®µ/å˜é‡ç±»å‹ * @param init å­—æ®µ/å˜é‡åˆå§‹åŒ–è¯­å¥ */public JCVariableDecl VarDef(JCModifiers modifiers, Name name, JCExpression varType, JCExpression init) { JCVariableDecl tree = new JCVariableDecl(modifiers, name, varType, init, (VarSymbol)null); tree.pos = this.pos; return tree;} TreeMaker.Identç”¨äºåˆ›å»ºæ ‡è¯†ç¬¦çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCIdentï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 123456789/** * ç”¨äºåˆ›å»ºæ ‡è¯†ç¬¦çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param name æ ‡è¯†ç¬¦åç§° */public JCIdent Ident(Name name) { JCIdent tree = new JCIdent(name, (Symbol)null); tree.pos = this.pos; return tree;} TreeMaker.Returnç”¨äºåˆ›å»ºreturnè¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCReturnï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 12345678/** * ç”¨äºåˆ›å»º`return`è¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹ */public JCReturn Return(JCExpression ex) { JCReturn tree = new JCReturn(ex); tree.pos = this.pos; return tree;} TreeMaker.Applyç”¨äºåˆ›å»ºæ–¹æ³•è°ƒç”¨çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCMethodInvocationï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011/** * ç”¨äºåˆ›å»ºæ–¹æ³•è°ƒç”¨çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param argsTypes å‚æ•°ç±»å‹åˆ—è¡¨ * @param fn æ–¹æ³•è°ƒç”¨è¯­å¥ * @param args æ–¹æ³•å‚æ•°åˆ—è¡¨ */public JCMethodInvocation Apply(List&lt;JCExpression&gt; argsTypes, JCExpression fn, List&lt;JCExpression&gt; args) { JCMethodInvocation tree = new JCMethodInvocation(argsTypes, fn, args); tree.pos = this.pos; return tree;} TreeMaker.Selectç”¨äºåˆ›å»ºåŸŸè®¿é—®/æ–¹æ³•è®¿é—®çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCFieldAccessï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 12345678910/** * ç”¨äºåˆ›å»ºåŸŸè®¿é—®/æ–¹æ³•è®¿é—®çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param selected . è¿ç®—ç¬¦å·¦è¾¹çš„è¡¨è¾¾å¼ * @param selector . è¿ç®—ç¬¦å³è¾¹çš„è¡¨è¾¾å¼ */public JCFieldAccess Select(JCExpression selected, Name selector) { JCFieldAccess tree = new JCFieldAccess(selected, selector, (Symbol)null); tree.pos = this.pos; return tree;} TreeMaker.Assignç”¨äºåˆ›å»ºèµ‹å€¼è¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCAssignï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 12345678910/** * ç”¨äºåˆ›å»ºèµ‹å€¼è¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param leftEx èµ‹å€¼è¯­å¥å·¦è¾¹çš„è¡¨è¾¾å¼ * @param rightEx èµ‹å€¼è¯­å¥å³è¾¹çš„è¡¨è¾¾å¼ */public JCAssign Assign(JCExpression leftEx, JCExpression rightEx) { JCAssign tree = new JCAssign(leftEx, rightEx); tree.pos = this.pos; return tree;} TreeMaker.Execç”¨äºåˆ›å»ºå¯æ‰§è¡Œè¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCExpressionStatementï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 12345678/** * ç”¨äºåˆ›å»ºå¯æ‰§è¡Œè¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹ */public JCExpressionStatement Exec(JCExpression ex) { JCExpressionStatement tree = new JCExpressionStatement(ex); tree.pos = this.pos; return tree;} TreeMaker.Applyå’ŒTreeMaker.Assignéœ€è¦åœ¨å¤–é¢åŒ…ä¸€å±‚TreeMaker.Execæ¥è·å–ä¸€ä¸ªå¯æ‰§è¡Œè¯­å¥JCExpressionStatementã€‚ TreeMaker.Blockç”¨äºåˆ›å»ºç»„åˆè¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCExpressionStatementï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 12345678910/** * ç”¨äºåˆ›å»ºç»„åˆè¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param flags è®¿é—®æ ‡å¿— * @param statements è¯­å¥åˆ—è¡¨ */public JCBlock Block(long flags, List&lt;JCStatement&gt; statements) { JCBlock tree = new JCBlock(flags, statements); tree.pos = this.pos; return tree;} TreeMaker.MethodDefç”¨äºåˆ›å»ºæ–¹æ³•å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹JCMethodDeclï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435/** * ç”¨äºåˆ›å»ºæ–¹æ³•å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param modifiers è®¿é—®æ ‡å¿—ï¼Œå¯é€šè¿‡treeMaker.Modifiersåˆ›å»º * @param name æ–¹æ³•å * @param returnType è¿”å›ç±»å‹ * @param typeParameters æ³›å‹å‚æ•°åˆ—è¡¨ * @param params å‚æ•°åˆ—è¡¨ * @param throwns å¼‚å¸¸å£°æ˜åˆ—è¡¨ * @param methodBody æ–¹æ³•ä½“ * @param defaultValue é»˜è®¤æ–¹æ³• */public JCMethodDecl MethodDef(JCModifiers modifiers, Name name, JCExpression returnType, List&lt;JCTypeParameter&gt; typeParameters, List&lt;JCVariableDecl&gt; params, List&lt;JCExpression&gt; throwns, JCBlock methodBody, JCExpression defaultValue) { return this.MethodDef(modifiers, name, returnType, typeParameters, (JCVariableDecl)null, params, throwns, methodBody, defaultValue);}public JCMethodDecl MethodDef(JCModifiers modifiers, Name name, JCExpression returnType, List&lt;JCTypeParameter&gt; typeParameters, JCVariableDecl variable, List&lt;JCVariableDecl&gt; params, List&lt;JCExpression&gt; throwns, JCBlock methodBody, JCExpression defaultValue) { JCMethodDecl tree = new JCMethodDecl(modifiers, name, returnType, typeParameters, variable, params, throwns, methodBody, defaultValue, (MethodSymbol)null); tree.pos = this.pos; return tree;} processæ‰§è¡Œä¸‹é¢è¯¦ç»†ä»‹ç»processæ–¹æ³•ä¸­çš„å…·ä½“å¤„ç†é€»è¾‘ï¼š é¦–å…ˆè¦çŸ¥é“processæ–¹æ³•å¦‚æœè¿”å›äº†trueï¼Œé‚£ä¹ˆJavacç¼–è¯‘å™¨ä¼šä»ç¼–è¯‘æœŸçš„ç¬¬äºŒé˜¶æ®µå›åˆ°ç¬¬ä¸€é˜¶æ®µï¼šå³é‡æ–°å›åˆ°è§£æä¸å¡«å……ç¬¦å·è¡¨é˜¶æ®µã€‚ å¤„ç†é€»è¾‘ï¼šå¦‚æœ!roundEnv.processingOver()è¿˜æœªprocesså®Œæˆï¼Œåˆ™æ‰¾åˆ°æ‰€æœ‰@GetterAndSetteræ³¨è§£æ ‡æ³¨çš„ç±»ï¼Œä¾æ¬¡éå†è·å¾—æ¯ä¸ªç±»çš„è¯­æ³•æ ‘ï¼Œç„¶åäº¤ç»™è‡ªå®šä¹‰çš„org.sunchaser.lombok.impl.process.GetterAndSetterTreeTranslatorç±»è¿›è¡Œå¤„ç†ï¼Œå…¨éƒ¨å¤„ç†å®Œæˆåè¿”å›trueä»¥ä¾¿å›åˆ°ç¼–è¯‘çš„ç¬¬ä¸€é˜¶æ®µã€‚ ä¸‹é¢æ˜¯GetterAndSetterTreeTranslatorç±»ä¸­å…·ä½“æ“ä½œè¯­æ³•æ ‘æ’å…¥getterå’Œsetteræ–¹æ³•çš„é€»è¾‘ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128import static com.sun.tools.javac.tree.JCTree.*;/** * ASTæ ‘è®¿é—®å¤„ç†å™¨ * @author sunchaserlilu@didiglobal.com * @since JDK8 2020/12/17 */public class GetterAndSetterTreeTranslator extends TreeTranslator { /** * æ„é€ JCTreeçš„å·¥å…·ç±» */ private final TreeMaker treeMaker; /** * åå­—å¤„ç†å·¥å…·ç±» */ private final Names names; /** * ç¼–è¯‘æœŸçš„æ—¥å¿—æ‰“å°å·¥å…·ç±» */ private final Messager messager; public GetterAndSetterTreeTranslator(TreeMaker treeMaker, Names names, Messager messager) { this.treeMaker = treeMaker; this.names = names; this.messager = messager; } /** * è®¿é—®åˆ°ç±»å®šä¹‰æ—¶çš„å¤„ç† * @param jcClassDecl ç±»å®šä¹‰çš„æŠ½è±¡è¯­æ³•æ ‘èŠ‚ç‚¹ */ @Override public void visitClassDef(JCClassDecl jcClassDecl) { super.visitClassDef(jcClassDecl); jcClassDecl.defs.forEach(def -&gt; { if (def.getKind().equals(Kind.VARIABLE)) { messager.printMessage(Diagnostic.Kind.NOTE,def + &quot;----processed&quot;); // æ’å…¥getteræ–¹æ³• jcClassDecl.defs = jcClassDecl.defs.prepend(createGetterMethod((JCVariableDecl) def)); // æ’å…¥setteræ–¹æ³• jcClassDecl.defs = jcClassDecl.defs.prepend(createSetterMethod((JCVariableDecl) def)); } }); } /** * åˆ›å»ºgetteræ–¹æ³•çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param def å˜é‡èŠ‚ç‚¹ * @return getteræ–¹æ³•çš„è¯­æ³•æ ‘èŠ‚ç‚¹ */ private JCTree createGetterMethod(JCVariableDecl def) { return treeMaker.MethodDef( // è®¿é—®ä¿®é¥°ç¬¦ treeMaker.Modifiers(Flags.PUBLIC), // æ–¹æ³•å names.fromString(&quot;get&quot; + this.toFirstUpperCase(def.getName().toString())), // æ–¹æ³•è¿”å›ç±»å‹ (JCExpression) def.getType(), // æ³›å‹å‚æ•° List.nil(), // æ–¹æ³•å‚æ•°åˆ—è¡¨ List.nil(), // throwè¡¨è¾¾å¼ List.nil(), // æ–¹æ³•ä½“ treeMaker.Block(0L,List.of( treeMaker.Return( treeMaker.Select( treeMaker.Ident(names.fromString(&quot;this&quot;)), names.fromString(def.getName().toString()) ) ) )), null ); } /** * åˆ›å»ºsetteræ–¹æ³•çš„è¯­æ³•æ ‘èŠ‚ç‚¹ * @param def å˜é‡èŠ‚ç‚¹ * @return setteræ–¹æ³•çš„è¯­æ³•æ ‘èŠ‚ç‚¹ */ private JCTree createSetterMethod(JCVariableDecl def) { // æ„é€ æ–¹æ³•å…¥å‚ JCVariableDecl param = treeMaker.VarDef(treeMaker.Modifiers(Flags.PARAMETER), def.getName(), def.vartype, null); // æ„é€  this.def = def JCFieldAccess thisX = treeMaker.Select(treeMaker.Ident(names.fromString(&quot;this&quot;)), def.getName()); JCAssign assign = treeMaker.Assign(thisX, treeMaker.Ident(def.getName())); // æ„é€ æ–¹æ³•ä½“ JCBlock methodBody = treeMaker.Block(0L, List.of(treeMaker.Exec(assign))); // æ„é€ æ–¹æ³•è¿”å›ç±»å‹ JCExpression returnType = treeMaker.Type(new Type.JCVoidType()); // æ„é€ setteræ–¹æ³• return treeMaker.MethodDef( // è®¿é—®ä¿®é¥°ç¬¦ treeMaker.Modifiers(Flags.PUBLIC), // æ–¹æ³•å names.fromString(&quot;set&quot; + this.toFirstUpperCase(def.getName().toString())), // æ–¹æ³•è¿”å›ç±»å‹ returnType, // æ³›å‹å‚æ•° List.nil(), // æ–¹æ³•å‚æ•°åˆ—è¡¨ List.of(param), // throwè¡¨è¾¾å¼ List.nil(), // æ–¹æ³•ä½“ methodBody, // é»˜è®¤å€¼ null ); } /** * å·¥å…·æ–¹æ³•ï¼šå°†å­—ç¬¦ä¸²é¦–ä½è½¬ä¸ºå¤§å†™ * @param str æºå­—ç¬¦ä¸² * @return é¦–ä½å¤§å†™çš„å­—ç¬¦ä¸² */ private String toFirstUpperCase(String str) { char[] charArray = str.toCharArray(); charArray[0] -= 32; return String.valueOf(charArray); }} è‡³æ­¤ï¼Œä¸€ä¸ªç®€æ˜“Lombokçš„åŠŸèƒ½å°±å®ç°äº†ï¼Œä½†æ˜¯è¿˜æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„æ’å…¥æ³¨è§£å¤„ç†å™¨ç±»GetterAndSetterProcessorä½¿ç”¨SPIçš„å½¢å¼æä¾›ç»™å¤–éƒ¨ä½¿ç”¨ã€‚ SPIå®ç°å®ç°æ–¹å¼ä¸€ï¼š æ‰‹åŠ¨åœ¨resourcesç›®å½•ä¸‹åˆ›å»ºMETA-INF/servicesç›®å½•ï¼Œç„¶ååœ¨servicesç›®å½•ä¸‹åˆ›å»ºjavax.annotation.processing.Processoræ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºæ’å…¥æ³¨è§£å¤„ç†å™¨ç±»GetterAndSetterProcessorçš„å…¨é™å®šç±»åã€‚ å®ç°æ–¹å¼äºŒï¼š ä½¿ç”¨googleæä¾›çš„auto-serviceæ¡†æ¶ï¼Œè¯¥æ¡†æ¶ä¹Ÿæ˜¯åŸºäºæ’å…¥æ³¨è§£å¤„ç†å™¨å®ç°çš„ã€‚å…¶mavenåæ ‡ä¸ºï¼š 12345&lt;dependency&gt; &lt;groupId&gt;com.google.auto.service&lt;/groupId&gt; &lt;artifactId&gt;auto-service&lt;/artifactId&gt; &lt;version&gt;1.0-rc7&lt;/version&gt;&lt;/dependency&gt; ç„¶ååœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ’å…¥æ³¨è§£å¤„ç†å™¨ç±»GetterAndSetterProcessorä¸Šæ‰“ä¸Šauto-serviceæ¡†æ¶æä¾›çš„@AutoService(Processor.class)æ³¨è§£ï¼Œåœ¨ç¼–è¯‘åå³è‡ªåŠ¨ç”Ÿæˆtarget/classes/META-INF/services/javax.annotation.processing.Processoræ–‡ä»¶ã€‚ æµ‹è¯•æˆ‘ä»¬æ— æ³•åœ¨æ’å…¥æ³¨è§£å¤„ç†å™¨ç±»GetterAndSetterProcessoræ‰€åœ¨çš„mavenæ¨¡å—è¿›è¡Œæµ‹è¯•ï¼Œå› ä¸ºè¯¥å¤„ç†å™¨æ˜¯ä½¿ç”¨SPIå¯¹å¤–æä¾›æœåŠ¡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ªmavenå­æ¨¡å—ï¼Œç„¶åå¼•å…¥æ’å…¥æ³¨è§£å¤„ç†å™¨GetterAndSetterProcessorç±»æ‰€åœ¨çš„mavenæ¨¡å—çš„åæ ‡ï¼Œç„¶åæ‰å¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨è§£ï¼Œç®€å•æµ‹è¯•ä¸€ä¸‹ï¼š 1234567891011121314import org.sunchaser.lombok.impl.annotation.GetterAndSetter;/** * æ³¨æ„æ­¤ç±»è·ŸGetterAndSetterProcessorä¸åœ¨åŒä¸€ä¸ªmavenæ¨¡å—ä¸­ * @author sunchaser admin@lilu.org.cn * @since JDK8 2020/12/18 */@GetterAndSetterpublic class ChainSetterTest { private String name; public static void main(String[] args) { }} è¿è¡Œmainæ–¹æ³•å³å¯ã€‚ å¯çœ‹åˆ°Build Outputä¸­æœ‰å¦‚ä¸‹è¾“å‡ºï¼š 123java: roundEnv ---&gt;[errorRaised=false, rootElements=[com.sunchaser.lomboktest.ChainSetterTest], processingOver=false]java: private String name----processedjava: roundEnv ---&gt;[errorRaised=false, rootElements=[], processingOver=true] æ‰“å¼€target/classes/com/sunchaser/lomboktest/ChainSetterTest.classå­—èŠ‚ç æ–‡ä»¶ï¼Œå¯çœ‹åˆ°å·²ç”Ÿæˆå­—æ®µnameçš„getNameå’ŒsetNameæ–¹æ³•ã€‚ 123456789101112131415161718192021222324//// Source code recreated from a .class file by IntelliJ IDEA// (powered by FernFlower decompiler)//package com.sunchaser.lomboktest;public class ChainSetterTest { private String name; public void setName(String name) { this.name = name; } public String getName() { return this.name; } public ChainSetterTest() { } public static void main(String[] args) { }} æ€»ç»“è‡³æ­¤ï¼Œæˆ‘ä»¬å°±åŸºæœ¬å®ç°äº†ä¸€ä¸ªç®€æ˜“çš„Lombokã€‚ ä½†æ˜¯æˆ‘ç•™ä¸‹äº†ä¸€ä¸ªç–‘é—®ï¼Œsetteræ–¹æ³•å¦‚ä½•ç”Ÿæˆé“¾å¼çš„ï¼Œè²Œä¼¼æˆ‘æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„APIï¼ŒLombokæ˜¯é€šè¿‡å¦ä¸€ä¸ªæ³¨è§£@Accessors(chain = true)æ¥å®ç°é“¾å¼setteræ–¹æ³•çš„ï¼Œä¸ºä»€ä¹ˆå®ƒä¸ç›´æ¥åœ¨@Setteræ³¨è§£ä¸­è®¾ç½®ä¸€ä¸ªå±æ€§ç”¨æ¥æ§åˆ¶ç”Ÿæˆçš„setteræ–¹æ³•æ˜¯å¦ä¸ºé“¾å¼çš„ï¼Ÿçœ‹Lombokçš„æºç å¹¶æœªçœ‹æ‡‚è¿™éƒ¨åˆ†çš„å®ç°ï¼Œç½‘ä¸Šä¹Ÿæ²¡æœ‰æ‰¾åˆ°å¯¹åº”èµ„æ–™ï¼Œå¦‚æœæœ‰åŒè¡Œç ”ç©¶è¿‡è¿™ä¸ªé—®é¢˜å¯ç•™è¨€è¿›è¡Œäº¤æµï¼Œååˆ†æ„Ÿè°¢ï¼","link":"/2020/12/19/javaee/lombok/impl-simple-lombok/"},{"title":"ä¸€ä¸ªå†·é—¨Lombokæ³¨è§£ä¸Springçš„ç»“åˆ","text":"åºè¯´åˆ°Lombokï¼Œå¤§éƒ¨åˆ†äººå¯èƒ½éƒ½åœç•™åœ¨@Dataæ³¨è§£å¯ä»¥åŒæ—¶ç”Ÿæˆgetter/setterã€toStringã€equalså’ŒhashCodeç­‰æ–¹æ³•ï¼›@NoArgsConstructor/@AllArgsConstructorå¯ä»¥ç”Ÿæˆæ— å‚å’Œå…¨å‚æ„é€ å™¨ã€‚ç¡®å®Lombokçš„è®¾è®¡åˆè¡·ä¹Ÿæ˜¯ä¸ºäº†ç”Ÿæˆä»£ç ã€‚ æœ‰äº›äººå› ä¸ºéœ€è¦å®‰è£…æ’ä»¶è€Œæ‹’ç»äº†Lombokï¼Œè§‰å¾—è¿™æ ·ä¼šè¦æ±‚å›¢é˜Ÿå†…æ‰€æœ‰æˆå‘˜éƒ½å®‰è£…æ’ä»¶ã€‚è¯šç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªè¿˜è¯´å¾—è¿‡å»çš„ç†ç”±ã€‚ä½†æ˜¯è¿™å¹¶ä¸è¶³ä»¥è®©æˆ‘ä»¬æ‹’ç»Lombokã€‚Lombokæ‰€åšçš„äº‹æƒ…æ˜¯åœ¨æ”¹å˜Javaï¼Œæœ‰äº›äººè§‰å¾—å®ƒæ”¹å˜äº†Javaè¯­æ³•æ˜¯ç ´åäº†Javaï¼Œé‚£æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œä¹Ÿè®¸Javaä¸€ç›´ä»¥æ¥çš„è®¾è®¡å°±æ˜¯ä¸å¥½çš„å­˜åœ¨å‘¢ï¼Ÿä¸šåŠ¡ç³»ç»Ÿä¸­å‡ºç°çš„æ— æ•°getter/setteræ–¹æ³•ï¼ŒåŠ¨è¾„å‡ ç™¾è¡Œçš„å®ä½“ç±»ï¼Œé˜…è¯»ä½“éªŒçœŸçš„å¥½å—ï¼ŸLombokæ˜¯åœ¨æ”¹å˜Javaï¼Œæˆ‘ä»¬åªä¸è¿‡æ˜¯åœ¨æ‹¥æŠ±å˜åŒ–ã€‚Spring Bootå·²ç»æŠŠLombokåŠ å…¥é¢„å®šä¹‰ä¾èµ–ä¸­äº†ï¼›Apache ShardingSphereçš„å¼€å‘è§„èŒƒä¸­æ˜ç¡®è¦æ±‚ä¼˜å…ˆä½¿ç”¨Lombokä»£æ›¿æ„é€ å™¨ã€getter/setteræ–¹æ³•å’Œlogå˜é‡ï¼›å°±è¿Java14ä¹Ÿå€Ÿé‰´äº†Lombokæ€æƒ³æå‡ºäº†recordè¯­æ³•ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜è¦å»æ‹’ç»Lombokå‘¢ï¼Ÿ æ‰€ä»¥ï¼Œä»ä»Šå¤©èµ·ï¼Œå¼€å§‹æ‹¥æŠ±Lombokå§ï¼ ä¸€ä¸ªå†·é—¨æ³¨è§£ï¼š@RequiredArgsConstructorå¾ˆå¤šäººéƒ½çŸ¥é“@RequiredArgsConstructorè¿™ä¸ªæ³¨è§£ï¼Œä½†æ˜¯å´ä»æœªä½¿ç”¨è¿‡ã€‚å¦‚æœä½ ä¹Ÿä¸€æ ·ï¼Œé‚£å°±å¾—å¥½å¥½çœ‹çœ‹æˆ‘è¿™ç¯‡æ–‡ç« äº†ï¼Œçœ‹å®Œä¹‹åä¹Ÿè®¸ä½ å°±ä¼šå‘ç°æ–°çš„å¤§é™†ï¼ Springçš„ä¾èµ–æ³¨å…¥æ•…äº‹è¿˜å¾—ä»Springçš„ä¾èµ–æ³¨å…¥å¼€å§‹è¯´èµ·â€¦ ä¾èµ–æ³¨å…¥çš„ä¸¤å¤§å˜ä½“ï¼š æ„é€ å‡½æ•°æ³¨å…¥ setteræ–¹æ³•æ³¨å…¥ ä½†æ˜¯ç°åœ¨ä¸šåŠ¡å¼€å‘ä¸­å´å¾ˆå°‘ä½¿ç”¨è¿™ä¸¤ç§ä¾èµ–æ³¨å…¥æ–¹å¼ï¼Œè€Œæ˜¯ä½¿ç”¨@Autowiredæ³¨è§£è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚ä¸ç®¡æ˜¯ä¸šåŠ¡å±‚Serviceè¿˜æ˜¯ä»“å‚¨å±‚MyBatisæ¡†æ¶çš„Mapperæˆ–è€…å…¶å®ƒç­‰ç­‰ï¼Œä¸šåŠ¡ä»£ç å†™èµ·æ¥å¤§æ¦‚æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­çš„ï¼š 1234567891011121314151617@Servicepublic class AutowiredService { @Autowired private IAService iaService; @Autowired private IBService ibService; @Autowired private ICService icService; @Autowired private AMapper aMapper; @Autowired private BMapper bMapper; ... // do business} è¿™æ ·çš„@Autowiredå­—æ®µå°‘åˆ™ä¸‰äº”ä¸ªï¼Œå¤šåˆ™ä¸€äºŒåä¸ªã€‚è€Œä¸”åœ¨IDEAä¸­ï¼ŒXXXServiceä¸Šé¢çš„@Autowiredæ³¨è§£ä¼šæœ‰ä¸€æ¡é»„è‰²çš„ä¸‹åˆ’çº¿ï¼šField injection is not recommended ï¼›å¯¹äºXXXMapperç±»æ¥è¯´ï¼Œå˜é‡åè¿˜ä¼šæœ‰ä¸€æ¡çº¢è‰²çš„ä¸‹åˆ’çº¿ï¼šCould not autowire. No beans of 'XXXMapper' type found.ï¼Œè™½ç„¶è¿è¡Œèµ·æ¥ä¸ä¼šæŠ¥é”™ï¼Œä½†è¿™æ ·çš„è­¦å‘Šå’ŒæŠ¥é”™ç€å®è®©äººçœ‹èµ·æ¥å¾ˆä¸èˆ’æœã€‚ æœ‰äººè¯´å¯ä»¥ç”¨@Resourceæ³¨è§£æ¥ä»£æ›¿@Autowiredï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°è­¦å‘Šå’ŒæŠ¥é”™äº†ã€‚è¯šç„¶ï¼Œè¿™æ ·åšå¯ä»¥è§£å†³é—®é¢˜ï¼Œ@Resourceé»˜è®¤ä¼˜å…ˆæŒ‰beanNameè‡ªåŠ¨æ³¨å…¥ï¼Œ@Autowiredé»˜è®¤ä¼˜å…ˆæŒ‰beanTypeè‡ªåŠ¨æ³¨å…¥ã€‚è¿™æ˜¯è§£å†³é—®é¢˜çš„ä¸€ç§æ–¹å¼ã€‚ @Resourceæ³¨è§£æ˜¯JSR-250è§„èŒƒæä¾›çš„æ³¨è§£ï¼Œè€Œ@Autowiredæ³¨è§£æ˜¯Springæä¾›çš„ã€‚è¿™ç‚¹ä¸è¶³ä»¥ç§°ä¸ºæš‡ç–µã€‚ Lombokçš„ä¼˜é›…å¦‚ä½•ä½¿ç”¨Lombokæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ æˆ‘ä»¬å…³æ³¨ä¸€ä¸‹æ„é€ å‡½æ•°æ³¨å…¥çš„å†™æ³•ï¼š 1234567891011121314151617@Servicepublic class ConstructorService { private final IAService iaService; private final IBService ibService; private final ICService icService; private final AMapper aMapper; private final BMapper bMapper; @Autowired public ConstructorService(IAService iaService, IBService ibService, ICService icService, AMapper aMapper, BMapper bMapper) { this.iaService = iaService; this.ibService = ibService; this.icService = icService; this.aMapper = aMapper; this.bMapper = bMapper; }} å®ƒè¦æ±‚æˆå‘˜å˜é‡æ˜¯finalç±»å‹ï¼ŒåŒæ—¶æ„é€ å‡½æ•°ä¸Šçš„@Autowiredæ˜¯å¯é€‰çš„ã€‚ è€Œ@RequiredArgsConstructoråˆšå¥½æ˜¯ä¸ºè¢«å£°æ˜ä¸ºfinalçš„å­—æ®µç”Ÿæˆæ„é€ å™¨çš„æ³¨è§£ã€‚ äºæ˜¯æˆ‘ä»¬çš„å†™æ³•å°±å˜å¾—ä¼˜ï¼ˆzhuangï¼‰é›…ï¼ˆbiï¼‰èµ·æ¥ï¼š 1234567891011@Service@RequiredArgsConstructorpublic class LombokService { private final IAService iaService; private final IBService ibService; private final ICService icService; private final AMapper aMapper; private final BMapper bMapper; // do business} è¿™æ ·ç¼–è¯‘åçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š 12345678910111213141516@Servicepublic class LombokService { private final IAService iaService; private final IBService ibService; private final ICService icService; private final AMapper aMapper; private final BMapper bMapper; public LombokService(IAService iaService, IBService ibService, ICService icService, AMapper aMapper, BMapper bMapper) { this.iaService = iaService; this.ibService = ibService; this.icService = icService; this.aMapper = aMapper; this.bMapper = bMapper; }} è¿™ä¸å°±æ˜¯æ ‡å‡†çš„Springæ„é€ å‡½æ•°æ³¨å…¥æ–¹å¼å—ï¼Ÿç”šè‡³æˆ‘ä»¬è¿˜å¯ä»¥æŠŠ@Autowiredæ³¨è§£ç»™åŠ ä¸Šï¼š 1234567891011@Service@RequiredArgsConstructor(onConstructor = @_(@Autowired))public class LombokService { private final IAService iaService; private final IBService ibService; private final ICService icService; private final AMapper aMapper; private final BMapper bMapper; // do business} è¿™æ ·ç¼–è¯‘åçš„æ„é€ å‡½æ•°ä¸Šå°±ä¼šåŠ ä¸Š@Autowiredæ³¨è§£ã€‚ onConstructor = @_(@Autowired)ä¸­é—´çš„@_è¿˜å¯ä»¥ç»§ç»­åŠ ä¸‹åˆ’çº¿_ï¼š 1@RequiredArgsConstructor(onConstructor = @______________________________(@Autowired)) å³ä½¿ä½ åƒä¸Šé¢è¿™æ ·å†™ï¼Œä»£ç ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œèƒ½æ­£å¸¸è¿è¡Œã€‚ è¿™æ ·æˆ‘ä»¬å°±åªç”¨å†™ä¸€ä¸ªæ³¨è§£å°±å¯ä»¥å®Œæˆä»»æ„å¤šä¸ªå±æ€§çš„æ³¨å…¥ï¼ŒLombokå°±æ˜¯è¿™ä¹ˆä¼˜ï¼ˆzhuangï¼‰é›…ï¼ˆbiï¼‰ï¼æ‰€ä»¥è¯·å°½æƒ…åœ°æ‹¥æŠ±Lombokå§ï¼","link":"/2020/12/14/javaee/lombok/lombok-combine-spring-di/"},{"title":"Lombokå¿…çŸ¥å¿…ä¼š","text":"ç®€ä»‹ ProjectLombokå®˜ç½‘ ä»‹ç»ï¼šProject Lombok is a java library that automatically plugs into your editor and build tools, spicing up your java. Never write another getter or equals method again, with one annotation your class has a fully featured builder, Automate your logging variables, and much more. æ°¸è¿œä¸è¦å†å†™å¦ä¸€ä¸ªgetteræˆ–è€…equalsæ–¹æ³•ï¼Œä¸€ä¸ªæ³¨è§£å°±å¯ä»¥è®©ä½ çš„ç±»æœ‰ä¸€ä¸ªåŠŸèƒ½å…¨é¢çš„ç”Ÿæˆå™¨ï¼Œè‡ªåŠ¨åŒ–ä½ çš„æ—¥å¿—å˜é‡ç­‰ç­‰ã€‚ åœ¨ä¸šåŠ¡å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸å¯é¿å…çš„éœ€è¦å»å®šä¹‰æ•°æ®åº“è¡¨çš„å®ä½“Entityç±»ã€ä¸­é—´æ•°æ®ä¼ è¾“å¯¹è±¡DTOç±»ã€å‰ç«¯è§†å›¾å¯¹è±¡VOç±»ç­‰ï¼Œè¿™äº›ç±»æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹å°±æ˜¯éƒ½ä¼šæœ‰å¾ˆå¤šå¾ˆå¤šçš„ä¸šåŠ¡å­—æ®µï¼Œæ‰¿è½½ç€ç³»ç»Ÿçš„ä¸šåŠ¡æ•°æ®ã€‚åŸºäºé¢å‘å¯¹è±¡çš„å°è£…æ€§ï¼Œç±»ä¸­çš„å­—æ®µä¼šè¢«å®šä¹‰æˆprivateï¼Œç„¶åæä¾›å‡ºpublicçš„getterå’Œsetteræ–¹æ³•æš´éœ²ç»™å¤–éƒ¨æ“ä½œã€‚äºæ˜¯ä»£ç ä¸­å°±å‡ºç°äº†ä¸€å¤§ç‰‡ä¸€å¤§ç‰‡çš„ä½¿ç”¨IDEç”Ÿæˆçš„getterå’Œsetteræ–¹æ³•ã€‚ Lombokè¦è§£å†³çš„é—®é¢˜å°±æ˜¯å»æ¶ˆé™¤è¿™äº›æ¨¡ç‰ˆå¼çš„getterå’Œsetteræ–¹æ³•ã€‚å½“ç„¶è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„æ¨¡ç‰ˆå¼çš„ä»£ç ä¹Ÿå¯ä»¥ä½¿ç”¨Lombokæ¥æ¶ˆé™¤ã€‚ åŸºæœ¬ä½¿ç”¨å¼•å…¥ä¾èµ–å¼•å…¥Mavenä¾èµ–ï¼š 123456&lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;version&gt;1.18.10&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt;&lt;/dependency&gt; å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨Lombokï¼Œè¿˜éœ€è¦åœ¨IDEä¸Šå®‰è£…Lombokçš„æ’ä»¶ã€‚ï¼ˆæ’ä»¶çš„å®‰è£…æ–¹å¼è¯·è‡ªè¡Œè°·æ­Œï¼‰ å¦‚æœæ˜¯Spring Booté¡¹ç›®ï¼ŒSpring Boot 2.1.xç‰ˆæœ¬çš„parentä¸­é»˜è®¤å·²ç»é¢„å®šä¹‰äº†Lombokçš„ä¾èµ–ï¼Œç›´æ¥å¼•å…¥Mavenåæ ‡å³å¯ã€‚ @Getterå’Œ@Setterè¿™ä¸¤ä¸ªæ³¨è§£å¯ä»¥å•ç‹¬å†™åœ¨æŸäº›å­—æ®µä¸Šï¼Œä¹Ÿå¯ä»¥å†™åœ¨ç±»ä¸Šã€‚ç¼–è¯‘åä¼šåœ¨å­—èŠ‚ç æ–‡ä»¶ä¸­åŠ å…¥ç›¸åº”å­—æ®µçš„getterå’Œsetteræ–¹æ³•ã€‚ å•ç‹¬å†™åœ¨ç±»ä¸Šçš„ä½¿ç”¨ç¤ºä¾‹ï¼š 12345678910111213141516public class GetterAndSetterTest { @Getter private String getField; @Setter private String setField; @Getter @Setter(AccessLevel.PROTECTED) private String otherField; @Getter @Setter private final String fs = null;} @Getteræ³¨è§£ä¼šç”Ÿæˆå¯¹åº”å­—æ®µçš„getteræ–¹æ³•ï¼Œ@Setteræ³¨è§£ä¼šç”Ÿæˆå¯¹åº”å­—æ®µçš„setteræ–¹æ³•ï¼Œå¯åŒæ—¶ä½œç”¨äºåŒä¸€ä¸ªå­—æ®µï¼Œè¿˜å¯ä»¥å®šä¹‰ç”Ÿæˆçš„æ–¹æ³•çš„è®¿é—®ä¿®é¥°ç¬¦ï¼Œä¾‹å¦‚@Setter(AccessLevel.PROTECTED)ç”Ÿæˆçš„setteræ–¹æ³•å°±æ˜¯protectedçº§åˆ«çš„ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå­—æ®µè¢«å£°æ˜æˆfinalç±»å‹ï¼Œ@Setteræ³¨è§£ä¸ä¼šä¸ºå…¶ç”Ÿæˆå¯¹åº”çš„setteræ–¹æ³•ã€‚ ç¼–è¯‘åçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728public class GetterAndSetterTest { private String getField; private String setField; private String otherField; public GetterAndSetterTest() { } public String getGetField() { return this.getField; } public void setSetField(String setField) { this.setField = setField; } public String getOtherField() { return this.otherField; } protected void setOtherField(String otherField) { this.otherField = otherField; } public String getFs() { return this.fs; }} å¦‚æœä¸æƒ³ç»†ç²’åº¦çš„æ§åˆ¶åˆ°æ¯ä¸ªå­—æ®µï¼Œå¯ä»¥ç›´æ¥åœ¨ç±»ä¸Šæ·»åŠ @Getterå’ŒSetteræ³¨è§£ï¼Œä¼šä¸ºæ‰€æœ‰çš„å­—æ®µç”Ÿæˆgetterå’Œsetteræ–¹æ³•ã€‚ @ToStringæˆ‘ä»¬ç»å¸¸ä¼šå»é‡å†™Object#toString()æ–¹æ³•ä»¥ä¾¿åœ¨æ§åˆ¶å°è¾“å‡ºæ—¶æ‰“å°çš„æ˜¯ç±»çš„åŸºæœ¬ä¿¡æ¯è€Œä¸æ˜¯åå…­è¿›åˆ¶çš„åœ°å€å€¼ã€‚ ä½¿ç”¨ç¤ºä¾‹ï¼š 123456789101112131415161718@ToString(exclude = {&quot;id&quot;})public class ToStringTest { private Long id; private String address; private UserInfo userInfo; @ToString public static class BaseInfo { private String username; private String password; } @ToString(callSuper = true,includeFieldNames = false) public static class UserInfo extends BaseInfo { private Integer age; private Integer gender; }} @ToStringæ³¨è§£ä¼šç”Ÿæˆä¸€ä¸ªtoString()æ–¹æ³•ï¼Œé»˜è®¤è¾“å‡ºç±»åï¼Œæ‰€æœ‰å­—æ®µçš„åç§°å’Œå€¼ã€‚å¯ä»¥ä½¿ç”¨æ³¨è§£çš„excludeå±æ€§æ¥æ’é™¤æŸäº›å­—æ®µï¼›è¿˜å¯ä»¥è®¾ç½®includeFieldNames = falseå±è”½æ‰€æœ‰å­—æ®µåç§°çš„è¾“å‡ºï¼›å¦‚æœå­—æ®µå­˜åœ¨åŸºç±»ï¼Œå¯ä»¥è®¾ç½®callSuper = trueæ¥è¾“å‡ºåŸºç±»ä¸­çš„å­—æ®µã€‚ ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536public class ToStringTest { private Long id; private String address; private ToStringTest.UserInfo userInfo; public ToStringTest() { } public String toString() { return &quot;ToStringTest(address=&quot; + this.address + &quot;, userInfo=&quot; + this.userInfo + &quot;)&quot;; } public static class UserInfo extends ToStringTest.BaseInfo { private Integer age; private Integer gender; public UserInfo() { } public String toString() { return &quot;ToStringTest.UserInfo(super=&quot; + super.toString() + &quot;, &quot; + this.age + &quot;, &quot; + this.gender + &quot;)&quot;; } } public static class BaseInfo { private String username; private String password; public BaseInfo() { } public String toString() { return &quot;ToStringTest.BaseInfo(username=&quot; + this.username + &quot;, password=&quot; + this.password + &quot;)&quot;; } }} @EqualsAndHashCodeè‡ªå®šä¹‰ç±»å¯¹è±¡è¿›è¡Œç›¸ç­‰æ¯”è¾ƒæ—¶ä¸€èˆ¬éœ€è¦é‡å†™equals()æ–¹æ³•ï¼ŒåŒæ—¶æœ€å¥½ä¹Ÿé‡å†™hashCode()æ–¹æ³•ã€‚ ä½¿ç”¨ç¤ºä¾‹ï¼š 1234567@EqualsAndHashCode(exclude = {&quot;ex&quot;})public class EqualsAndHashCodeTest { private String equal; private String hc; transient String tr; private String ex;} é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨æ‰€æœ‰éé™æ€non-staticå’Œéç¬æ€non-transientçš„å­—æ®µæ¥ç”Ÿæˆequals()å’ŒhashCode()æ–¹æ³•ã€‚ç±»ä¼¼åœ°ï¼Œå¯ä»¥ä½¿ç”¨excludeå±æ€§æ¥æ’é™¤æŸäº›å­—æ®µï¼›å¦‚æœå­˜åœ¨åŸºç±»ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨callSuper = trueæ¥å›Šæ‹¬åŸºç±»ä¸­çš„å­—æ®µã€‚ ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758public class EqualsAndHashCodeTest { private String equal; private String hc; transient String tr; private String ex; public EqualsAndHashCodeTest() { } public boolean equals(Object o) { if (o == this) { return true; } else if (!(o instanceof EqualsAndHashCodeTest)) { return false; } else { EqualsAndHashCodeTest other = (EqualsAndHashCodeTest)o; if (!other.canEqual(this)) { return false; } else { Object this$equal = this.equal; Object other$equal = other.equal; if (this$equal == null) { if (other$equal != null) { return false; } } else if (!this$equal.equals(other$equal)) { return false; } Object this$hc = this.hc; Object other$hc = other.hc; if (this$hc == null) { if (other$hc != null) { return false; } } else if (!this$hc.equals(other$hc)) { return false; } return true; } } } protected boolean canEqual(Object other) { return other instanceof EqualsAndHashCodeTest; } public int hashCode() { int PRIME = true; int result = 1; Object $equal = this.equal; int result = result * 59 + ($equal == null ? 43 : $equal.hashCode()); Object $hc = this.hc; result = result * 59 + ($hc == null ? 43 : $hc.hashCode()); return result; }} å¯ä»¥çœ‹åˆ°è¿˜åŠ å…¥äº†ä¸€ä¸ªcanEqualæ–¹æ³•ç”¨æ¥é¢„å…ˆåˆ¤æ–­æ˜¯å¦èƒ½å’Œå½“å‰ç±»å¯¹è±¡è¿›è¡Œequalsæ¯”è¾ƒã€‚ @DataåŸºæœ¬ä¸Šæ¯ä¸€ä¸ªå®ä½“ç±»éƒ½ä¼šä½¿ç”¨åˆ°ä¸Šé¢å››ä¸ªæ³¨è§£ï¼š@Getterã€@Setterã€@ToStringå’Œ@EqualsAndHashCodeï¼Œä½†æ˜¯å¦‚æœåœ¨æ¯ä¸€ä¸ªç±»ä¸Šéƒ½é‡å¤çš„å†™ä¸Šè¿™å››ä¸ªæ³¨è§£ï¼Œå°±åˆæ˜¾å¾—ç´¯èµ˜äº†ã€‚äºæ˜¯Lombokæä¾›äº†@Dataæ³¨è§£ï¼Œå®ƒç­‰ä»·äºè¿™å››ä¸ªæ³¨è§£çš„ç»„åˆï¼Œä¼šåŒæ—¶ç”Ÿæˆgetterã€setterã€toStringã€equalsã€canEqualå’ŒhashCodeè¿™å…­ä¸ªæ–¹æ³•ã€‚åŒæ—¶è¿˜æä¾›äº†ä¸€ä¸ªå±æ€§staticConstructorï¼Œä¾‹å¦‚ï¼šstaticConstructor=&quot;of&quot;ï¼Œè¿™æ ·ä½¿ç”¨åï¼Œä¼šå°†æ— å‚æ„é€ å‡½æ•°ç§æœ‰åŒ–ï¼ŒåŒæ—¶ä¼šæä¾›ä¸€ä¸ªé™æ€æˆå‘˜æ–¹æ³•of()ç”¨æ¥åˆ›å»ºå½“å‰ç±»å¯¹è±¡ï¼Œåœ¨ç±»å¤–éƒ¨æ— æ³•ä½¿ç”¨newå…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡ã€‚ ä½¿ç”¨ç¤ºä¾‹ï¼š 12345@Data(staticConstructor = &quot;of&quot;)public class DataTest { private String s; private String c;} ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980public class DataTest { private String s; private String c; private DataTest() { } public static DataTest of() { return new DataTest(); } public String getS() { return this.s; } public String getC() { return this.c; } public void setS(String s) { this.s = s; } public void setC(String c) { this.c = c; } public boolean equals(Object o) { if (o == this) { return true; } else if (!(o instanceof DataTest)) { return false; } else { DataTest other = (DataTest)o; if (!other.canEqual(this)) { return false; } else { Object this$s = this.getS(); Object other$s = other.getS(); if (this$s == null) { if (other$s != null) { return false; } } else if (!this$s.equals(other$s)) { return false; } Object this$c = this.getC(); Object other$c = other.getC(); if (this$c == null) { if (other$c != null) { return false; } } else if (!this$c.equals(other$c)) { return false; } return true; } } } protected boolean canEqual(Object other) { return other instanceof DataTest; } public int hashCode() { int PRIME = true; int result = 1; Object $s = this.getS(); int result = result * 59 + ($s == null ? 43 : $s.hashCode()); Object $c = this.getC(); result = result * 59 + ($c == null ? 43 : $c.hashCode()); return result; } public String toString() { return &quot;DataTest(s=&quot; + this.getS() + &quot;, c=&quot; + this.getC() + &quot;)&quot;; }} @NoArgsConstructorã€@AllArgsConstructorå’ŒRequiredArgsConstructor @NoArgsConstructorï¼šæ— å‚æ„é€ å™¨ï¼› @AllArgsConstructorï¼šå…¨å‚æ„é€ å™¨ï¼› @RequiredArgsConstructorï¼šéƒ¨åˆ†å‚æ•°æ„é€ å™¨ï¼Œé’ˆå¯¹è¢«å£°æ˜ä¸ºfinalçš„å­—æ®µç”Ÿæˆæ„é€ å™¨ã€‚ Javaç±»çš„æ„é€ å™¨æœºåˆ¶æ˜¯ï¼šå¦‚æœç±»ä¸­æœªå£°æ˜ä»»ä½•ä¸€ä¸ªæ„é€ å™¨ï¼Œåˆ™ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æœŸè‡ªåŠ¨åŠ ä¸Šä¸€ä¸ªæ— å‚æ„é€ å™¨ï¼›å¦‚æœå£°æ˜äº†ä»»æ„ä¸€ä¸ªæ„é€ å™¨ï¼Œåˆ™ä¸ä¼šè‡ªåŠ¨åŠ ä¸Šæ— å‚æ„é€ å™¨ã€‚ æ‰€ä»¥ä¸€èˆ¬ä¼šå°†æ— å‚å’Œå…¨å‚æ„é€ å™¨è¿›è¡Œæ­é…ä½¿ç”¨ï¼š 12345@NoArgsConstructor@AllArgsConstructorpublic class ArgsConstructor { private String ac;} ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š 12345678910public class ArgsConstructor { private String ac; public ArgsConstructor() { } public ArgsConstructor(String ac) { this.ac = ac; }} è€Œ@RequiredArgsConstructoræ³¨è§£è·Ÿå‰ä¸¤ä¸ªæ˜¯äº’æ–¥çš„ï¼Œè¯¥æ³¨è§£æ˜¯é’ˆå¯¹finalå­—æ®µæ¥ç”Ÿæˆæ„é€ å™¨ï¼Œå¯ä¸Springçš„DIä¾èµ–æ³¨å…¥æ­é…ä½¿ç”¨ã€‚ @Slf4jä½œä¸ºç ”å‘æˆ‘ä»¬é¿å…ä¸äº†æ—¥å¿—æ‰“å°ï¼Œä½†æˆ‘ä»¬å´è¦åœ¨æ¯ä¸€ä¸ªéœ€è¦æ‰“å°æ—¥å¿—çš„ç±»ä¸­å®šä¹‰è¿™æ ·ä¸€ä¸ªé™æ€æ—¥å¿—å¸¸é‡ï¼šprivate static final Logger log = LoggerFactory.getLogger(XXXService.class);ï¼Œå…¶ä¸­XXXServiceçš„åç§°è¿˜éƒ½ä¸ç›¸åŒï¼Œè¿™å¤ªå½±å“åƒæˆ‘è¿™æ ·çš„CVå·¥ç¨‹å¸ˆçš„æ•ˆç‡äº†ã€‚Lombokæä¾›äº†@Slf4jæ³¨è§£æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ ä½¿ç”¨å‰æï¼šå¼•å…¥æ—¥å¿—æ¡†æ¶slf4jçš„Mavenä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;&lt;/dependency&gt; ä½¿ç”¨ç¤ºä¾‹ï¼š 123@Slf4jpublic class LogTest {} ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š 123456789import org.slf4j.Logger;import org.slf4j.LoggerFactory;public class LogTest { private static final Logger log = LoggerFactory.getLogger(LogTest.class); public LogTest() { }} åªç”¨ä¸€ä¸ªç›¸åŒçš„æ³¨è§£@Slf4jå°±å¯ä»¥ä¸ºæ¯ä¸ªç±»åˆ†åˆ«ç”Ÿæˆå¯¹åº”çš„æ—¥å¿—å¸¸é‡logå¯¹è±¡ã€‚CVå·¥ç¨‹å¸ˆçš„æ•ˆç‡åˆæé«˜äº†ï¼ åŸç†åˆ†æLombokçš„ä½¿ç”¨å¾ˆç®€å•ï¼Œåªéœ€æ·»åŠ å¯¹åº”æ³¨è§£ï¼Œå°±å¯ä»¥åœ¨å­—èŠ‚ç ä¸­ç”Ÿæˆå¯¹åº”çš„ä»£ç ã€‚ä»æºæ–‡ä»¶åˆ°å­—èŠ‚ç ä¹‹é—´åªç»è¿‡äº†ç¼–è¯‘é˜¶æ®µï¼Œæ‰€ä»¥Lombokä¸€å®šæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå¯¹æ³¨è§£è¿›è¡Œè§£æç„¶åæ³¨å…¥å¯¹åº”çš„å­—èŠ‚ç ã€‚ è€Œç¼–è¯‘é˜¶æ®µå¯¹æ³¨è§£çš„è§£ææœ‰ä¸¤ç§æœºåˆ¶ï¼š Annotation Processing Toolï¼šç®€ç§°apt aptéšç€JDK5å¼•å…¥æ³¨è§£æ—¶äº§ç”Ÿï¼Œåœ¨JDK7ä¸­è¢«æ ‡è®°ä¸ºè¿‡æœŸï¼Œä¸æ¨èä½¿ç”¨ï¼ŒJDK8å·²å½»åº•å°†å…¶åˆ é™¤ã€‚ ä»JDK6å¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨Pluggable Annotation Processing APIæ¥æ›¿æ¢å®ƒï¼Œaptè¢«æ›¿æ¢çš„ä¸»è¦åŸå› æ˜¯ï¼š apiéƒ½åœ¨com.sun.mirroréæ ‡å‡†åŒ…ä¸‹ï¼› æ²¡æœ‰é›†æˆåˆ°javacä¸­ï¼Œéœ€è¦é¢å¤–è¿è¡Œã€‚ Pluggable Annotation Processing API è¿™å…¶å®æ˜¯JSR 269è§„èŒƒï¼Œåœ¨JDK6ä¸­è¢«å¼•å…¥ä½œä¸ºaptçš„æ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒè§£å†³äº†aptçš„é‚£ä¸¤ä¸ªé—®é¢˜ï¼Œåœ¨javacæ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šè°ƒç”¨å®ç°äº†è¯¥è§„èŒƒçš„ç¨‹åºï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¯¹javacç¼–è¯‘å™¨åšä¸€äº›å¢å¼ºã€‚ JSRæ˜¯Java Specification Requestsçš„ç¼©å†™ï¼Œæ„æ€æ˜¯Javaè§„èŒƒææ¡ˆã€‚ Lombokå°±æ˜¯ä¸€ä¸ªå®ç°äº†JSR 269è§„èŒƒçš„ç¨‹åºï¼Œåœ¨javacç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šè°ƒç”¨Lombokï¼Œä»è€Œå®ç°ä»£ç çš„è‡ªåŠ¨åŠ å…¥ã€‚ æ•´ä¸ªç¼–è¯‘çš„è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š javacå¯¹æºä»£ç è¿›è¡Œåˆ†æï¼Œç”Ÿæˆä¸€é¢—æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼› è°ƒç”¨JSR 269çš„å®ç°ï¼šLombokï¼› Lombokå¯¹æŠ½è±¡è¯­æ³•æ ‘è¿›è¡Œè§£æï¼Œæ‰¾åˆ°Lombokå®šä¹‰çš„æ³¨è§£æ‰€åœ¨çš„è¯­æ³•æ ‘ï¼Œç„¶åè¿›è¡Œä¿®æ”¹ï¼Œæ·»åŠ getterå’Œsetterç­‰æ–¹æ³•å®šä¹‰çš„æ ‘èŠ‚ç‚¹ï¼› ä½¿ç”¨ä¿®æ”¹åçš„è¯­æ³•æ ‘ç”Ÿæˆå­—èŠ‚ç classæ–‡ä»¶ã€‚ ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š ä»£ç ç®€æ´ä¼˜é›…ï¼Œé€šè¿‡æ³¨è§£çš„å½¢å¼è‡ªåŠ¨ç”Ÿæˆä¸€äº›æ¨¡ç‰ˆå¼çš„ä»£ç ã€‚ å½“ç±»å­—æ®µå‘ç”Ÿä¿®æ”¹æ—¶ï¼Œä¸ç”¨å»ä¿®æ”¹å¯¹åº”çš„getterå’Œsetterç­‰æ–¹æ³•ã€‚ ç¼ºç‚¹ï¼š IDEä¸­éœ€è¦å®‰è£…æ’ä»¶ï¼Œå¦åˆ™é¡¹ç›®æŠ¥é”™ã€‚ ä¸æ”¯æŒä»»æ„ä¸ªå‚æ•°çš„æ„é€ å™¨é‡è½½ã€‚ æ€»ç»“å…³äºLombokï¼Œç½‘ä¸Šä¸€éƒ¨åˆ†äººæ”¯æŒï¼Œä¸€éƒ¨åˆ†äººåå¯¹ã€‚åå¯¹çš„ç†ç”±è¿˜å¾ˆå¤šï¼šå¼ºä¾èµ–æ’ä»¶ï¼›ç»„å†…æœ‰ä¸€äººç”¨åˆ™æ‰€æœ‰äººç”¨ï¼›æ“ä½œè¯­æ³•æ ‘ç­‰äºæ”¹å˜Javaè¯­æ³•ç­‰ç­‰ã€‚æš‚ä¸”è®¤ä¸ºè¿™äº›éƒ½æœ‰é“ç†ï¼Œä½†æœ‰å¥è¯æ€ä¹ˆè¯´æ¥ç€ï¼šæ‹¥æŠ±å˜åŒ–ï¼Javaè¯­è¨€èµ°è¿‡è¿™ä¹ˆå¤šå¹´ä¹Ÿç»è¿‡äº†å¾ˆå¤šå˜åŒ–ï¼Œæ¯ä¸ªå¤§ç‰ˆæœ¬ä¹Ÿæˆ–å¤šæˆ–å°‘ä¼šå‡ºç°ä¸€äº›æ–°è¯­æ³•ã€‚Lombokçš„å‡ºç°ä¹Ÿé¢„ç¤ºç€Javaéœ€è¦å‘ç”Ÿå˜åŒ–ï¼Œè€Œä¸æ˜¯å±€é™äºå½“ä¸‹çš„å®‰ç¨³ã€‚æ‰€ä»¥ï¼Œæˆ‘è®¤ä¸ºLombokæ˜¯å€¼å¾—å»æ‹¥æŠ±çš„ï¼ ä»å¦ä¸€ä¸ªè§’åº¦è¯´ï¼Œé‚£äº›åå¯¹Lombokçš„äººå¯èƒ½æ˜¯æ²¡å†™è¿‡ä¸šåŠ¡ç³»ç»Ÿï¼Œä¸šåŠ¡ä»£ç ä¸­ç»å¸¸å‡ºç°ä¸€ä¸ªç±»æœ‰äºŒä¸‰åä¸ªå­—æ®µï¼Œç”šè‡³æ›´å¤šï¼Œè¿™æ—¶å¦‚æœæ‰‹åŠ¨å»ç»´æŠ¤å„ä¸ªç±»çš„getterå’Œsetteræ–¹æ³•ï¼Œæ•ˆç‡å¯æƒ³è€ŒçŸ¥ï¼Œè€Œä¸”ä¹Ÿæ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡ã€‚æ‰“å·¥äººè®²ç©¶çš„æ˜¯å¦‚ä½•é«˜æ•ˆæ‰“å·¥ï¼","link":"/2020/12/13/javaee/lombok/lombok-base/"},{"title":"æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†","text":"å®šä¹‰é“¾è¡¨ï¼šå„ä¸ªå…ƒç´ ç‰©ç†å†…å­˜ç©ºé—´ä¸è¿ç»­ï¼Œé€šè¿‡â€œæŒ‡é’ˆâ€å°†ä¸€ç»„é›¶æ•£çš„å†…å­˜ç©ºé—´ä¸²è”èµ·æ¥ã€‚æŒ‡é’ˆçš„é“¾æ¥é¡ºåºä¸ºé“¾è¡¨ä¸­å…ƒç´ çš„é€»è¾‘é¡ºåºã€‚ åŸºæœ¬ç‰¹ç‚¹é“¾è¡¨ç”±ä¸€ç»„èŠ‚ç‚¹ç»„æˆï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ªæ˜¯å­˜å‚¨å…ƒç´ çš„æ•°æ®åŸŸï¼Œå¦ä¸€ä¸ªæ˜¯å­˜å‚¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹åœ°å€çš„æŒ‡é’ˆåŸŸã€‚å¤©ç„¶æ”¯æŒåŠ¨æ€æ‰©å®¹ã€‚ é“¾è¡¨åˆ†ç±» å•é“¾è¡¨ï¼šç¬¬ä¸€ä¸ªèŠ‚ç‚¹ç§°ä¸ºå¤´èŠ‚ç‚¹ï¼Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ç§°ä¸ºå°¾èŠ‚ç‚¹ã€‚å¤´èŠ‚ç‚¹ç”¨æ¥è®°å½•é“¾è¡¨çš„åŸºåœ°å€ï¼Œå¯ä»¥é€šè¿‡å¤´èŠ‚ç‚¹éå†æ•´ä¸ªé“¾è¡¨ã€‚å°¾èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘nullã€‚ å¾ªç¯é“¾è¡¨ï¼šç‰¹æ®Šçš„å•é“¾è¡¨ï¼Œä¸å•é“¾è¡¨å”¯ä¸€ä¸åŒçš„æ˜¯ï¼šå°¾èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘äº†å¤´èŠ‚ç‚¹ã€‚ åŒå‘é“¾è¡¨ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸ä»…å­˜å‚¨æ•°æ®åŸŸå’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸï¼Œå®ƒè¿˜ä¼šæœ‰ä¸€ä¸ªæŒ‡é’ˆåŸŸæŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚é€šå¸¸ç§°ä¸ºå‰é©±èŠ‚ç‚¹å’Œåç»§èŠ‚ç‚¹ã€‚ åŒå‘å¾ªç¯é“¾è¡¨ï¼šç»¼åˆäº†å¾ªç¯é“¾è¡¨å’ŒåŒå‘é“¾è¡¨ã€‚å¤´èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘å°¾èŠ‚ç‚¹ï¼Œå°¾èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘å¤´èŠ‚ç‚¹ã€‚ JDKçš„java.util.LinkedListå°±æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚ å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªå•é“¾è¡¨çš„èŠ‚ç‚¹ç±»SinglyLinkedListNodeï¼š 123456789101112131415161718192021222324252627282930package com.sunchaser.sparrow.algorithm.base.linkedlist;import lombok.AllArgsConstructor;import lombok.Data;import lombok.NoArgsConstructor;/** * å•å‘é“¾è¡¨èŠ‚ç‚¹ç±» * @author sunchaser admin@lilu.org.cn * @since JDK8 2020/6/3 */@Data@NoArgsConstructor@AllArgsConstructorpublic class SinglyLinkedListNode { /** * å€¼åŸŸ */ public Integer val; /** * æŒ‡é’ˆåŸŸ */ public SinglyLinkedListNode next; public SinglyLinkedListNode(Integer val) { this.val = val; }} æ„é€ å•é“¾è¡¨åŠå…¶æ‰“å°æ„é€ ä¸€ä¸ªå•é“¾è¡¨ï¼Œå¹¶æŒ‰é¡ºåºæ‰“å°åœ¨æ§åˆ¶å°ã€‚æˆ‘ä»¬æä¾›ä¸€ä¸ªå·¥å…·ç±»LinkedListUtilsæ¥å®ç°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142package com.sunchaser.sparrow.algorithm.base.util;import com.sunchaser.sparrow.algorithm.base.linkedlist.SinglyLinkedListNode;/** * é“¾è¡¨å·¥å…·ç±» * @author sunchaser admin@lilu.org.cn * @since JDK8 2020/12/11 */public class LinkedListUtils { private LinkedListUtils() { } /** * æ„é€ ä¸€ä¸ªå•é“¾è¡¨ * @return å•é“¾è¡¨å¤´èŠ‚ç‚¹ */ public static SinglyLinkedListNode generateSinglyLinkedList() { SinglyLinkedListNode node4 = new SinglyLinkedListNode(5,null); SinglyLinkedListNode node3 = new SinglyLinkedListNode(4,node4); SinglyLinkedListNode node2 = new SinglyLinkedListNode(3,node3); SinglyLinkedListNode node1 = new SinglyLinkedListNode(2,node2); return new SinglyLinkedListNode(1,node1); } /** * æŒ‰é¡ºåºæ‰“å°å•é“¾è¡¨ * @param head è¦æ‰“å°çš„å•é“¾è¡¨å¤´èŠ‚ç‚¹ */ public static void printLink(SinglyLinkedListNode head) { if (head == null) { System.out.print(&quot;&quot;); return; } if (head.next == null) { System.out.println(&quot;-&gt;&quot; + head.val + &quot;-&gt;null&quot;); return; } System.out.print(&quot;-&gt;&quot; + head.val); printLink(head.next); }} æ’å…¥å’Œåˆ é™¤æ“ä½œå•é“¾è¡¨çš„æ’å…¥æ“ä½œï¼šä¾‹å¦‚ï¼š1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; nullã€‚ ç°åœ¨è¦å°†å…ƒç´ 0æ’å…¥åˆ°3å’Œ4ä¹‹é—´ã€‚åšæ³•å¾ˆç®€å•ï¼Œåªéœ€è¦å…ˆå°†0æŒ‡å‘4ï¼Œå†å°†3æŒ‡å‘0å³å¯ã€‚æ³¨æ„å…ˆåé¡ºåºï¼Œè¦å…ˆå°†0æŒ‡å‘4ï¼Œåå°†3æŒ‡å‘0ã€‚å› ä¸ºå¦‚æœé¡ºåºå¯¹è°ƒï¼Œå°†3å…ˆæŒ‡å‘0ä¹‹åå°±æ‰¾ä¸åˆ°èŠ‚ç‚¹4äº†ã€‚ ç°åœ¨è¦å°†0ä»é“¾è¡¨ä¸­åˆ é™¤ã€‚éœ€è¦å°†èŠ‚ç‚¹0å‰é¢çš„èŠ‚ç‚¹3æŒ‡å‘èŠ‚ç‚¹0åé¢çš„4ï¼Œç„¶åå°†èŠ‚ç‚¹0çš„æŒ‡é’ˆåŸŸç½®ä¸ºç©ºã€‚æ³¨æ„ï¼šå°†èŠ‚ç‚¹3æŒ‡å‘èŠ‚ç‚¹4åï¼Œä¸­é—´çš„èŠ‚ç‚¹0å°±ä¼šæ‰¾ä¸åˆ°äº†ï¼Œæ‰€ä»¥éœ€è¦ç”¨ä¸€ä¸ªä¸­é—´å˜é‡æ¥ä¿å­˜èŠ‚ç‚¹0ï¼Œå¾…æŒ‡å‘å®Œæˆåå†å°†èŠ‚ç‚¹0çš„æŒ‡é’ˆåŸŸæŒ‡å‘nullã€‚ 123456789101112131415161718192021222324252627public static void main(String[] args) { // generate singly linked list SinglyLinkedListNode head = LinkedListUtils.generateSinglyLinkedList(); LinkedListUtils.printLink(head); // -&gt;1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;null // ä»3å’Œ4ä¹‹é—´æ’å…¥0 SinglyLinkedListNode c = new SinglyLinkedListNode(0); SinglyLinkedListNode cHead = head; while (cHead.next != null) { if (cHead.val == 3) { c.next = cHead.next; cHead.next = c; } cHead = cHead.next; } LinkedListUtils.printLink(head); // -&gt;1-&gt;2-&gt;3-&gt;0-&gt;4-&gt;5-&gt;null // å°†0ä»3å’Œ4ä¹‹é—´åˆ é™¤ SinglyLinkedListNode dHead = head; while (dHead.next != null) { if (dHead.val == 3) { SinglyLinkedListNode temp = dHead.next; dHead.next = dHead.next.next; temp.next = null; // help gc } dHead = dHead.next; } LinkedListUtils.printLink(head); // -&gt;1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;null}","link":"/2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/"},{"title":"æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-å¥‡æ•°ä¸ªå…ƒç´ çš„é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªå¥‡æ•°ä¸ªå…ƒç´ çš„é“¾è¡¨ï¼ŒæŸ¥æ‰¾å‡ºè¿™ä¸ªé“¾è¡¨ä¸­é—´ä½ç½®çš„èŠ‚ç‚¹çš„æ•°å€¼ã€‚ ç¤ºä¾‹ï¼šå•é“¾è¡¨ï¼š1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; nullï¼Œä¸­é—´ä½ç½®çš„èŠ‚ç‚¹çš„æ•°å€¼ä¸º3ã€‚ æ€è·¯ï¼šç”±äºå•é“¾è¡¨ç‰¹æ€§ï¼Œæˆ‘ä»¬åªèƒ½å…ˆéå†ä¸€æ¬¡æ‰èƒ½å¾—åˆ°å…¶é•¿åº¦ï¼Œå¾—åˆ°æ€»é•¿åº¦ä¹‹åæˆ‘ä»¬å°±çŸ¥é“å…¶ä¸­é—´ä½ç½®æ˜¯ç¬¬å‡ ä¸ªï¼Œå†æ¬¡è¿›è¡Œéå†å³å¯å¾—åˆ°ã€‚è¿™ç§æš´åŠ›è§£æ³•æ—¶é—´å¤æ‚åº¦æ˜¯ï¼šO(n) + O(2/n)ã€‚ ä¸‹é¢ä»‹ç»ä¸€ç§æ—¶é—´å¤æ‚åº¦æ›´ä½çš„è§£æ³•ï¼šå¿«æ…¢æŒ‡é’ˆæ³•ã€‚ å®šä¹‰ä¸€å¿«ä¸€æ…¢ä¸¤ä¸ªæŒ‡é’ˆï¼šfastå’Œslowï¼Œä¸¤ä¸ªæŒ‡é’ˆåŒæ—¶èµ°ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡èµ°ä¸€æ­¥ï¼Œå½“å¿«æŒ‡é’ˆèµ°åˆ°é“¾è¡¨æœ«å°¾çš„æ—¶å€™ï¼Œæ…¢æŒ‡é’ˆå°±æ°å¥½åœ¨é“¾è¡¨ä¸­é—´ä½ç½®ï¼Œå³æˆ‘ä»¬éœ€è¦çš„ä¸­é—´èŠ‚ç‚¹ã€‚ æˆ‘ä»¬æ¥çœ‹å¿«æ…¢æŒ‡é’ˆçš„Javaè¯­è¨€å®ç°ï¼š å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼šæ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯† 123456789public static SinglyLinkedListNode middleNode(SinglyLinkedListNode head) { SinglyLinkedListNode fast = head; SinglyLinkedListNode slow = head; while (fast.next != null) { fast = fast.next.next; slow = slow.next; } return slow;}","link":"/2020/12/12/algorithm/base/datastructure/middle-linknode/"},{"title":"æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-ä½¿ç”¨éé€’å½’æ³•å®ç°å•é“¾è¡¨çš„åè½¬","text":"é¢˜ç›®ï¼šä½¿ç”¨éé€’å½’æ³•å®ç°å•é“¾è¡¨çš„åè½¬ ç¤ºä¾‹ï¼šå•é“¾è¡¨ï¼š1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; nullï¼Œåè½¬ä¹‹åçš„ç»“æœä¸ºï¼š5 -&gt; 4 -&gt; 3 -&gt; 2 -&gt; 1 -&gt; nullã€‚ ä¹‹å‰å·²ç»å†™è¿‡ä¸€ç¯‡æ–‡ç« ä½¿ç”¨é€’å½’æ³•æ¥å®ç°ï¼Œå¯æŸ¥çœ‹ï¼šå‹‡é—¯ç®—æ³•-é€’å½’æ³•æ‹¿ä¸‹åè½¬é“¾è¡¨çš„ä¸‰æ€ ç°åœ¨æˆ‘ä»¬ä½¿ç”¨éé€’å½’æ³•æ¥è¿›è¡Œå®ç°ã€‚ æ€è·¯ï¼šç”±äºå•é“¾è¡¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬åªèƒ½ä»å‰å¾€åä¾æ¬¡éå†å„ä¸ªé“¾è¡¨èŠ‚ç‚¹ï¼Œå¯¹äºç¤ºä¾‹ä¸­çš„å•é“¾è¡¨ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥å°†1å’Œ2è¿›è¡Œåè½¬ï¼Œå°†2æŒ‡å‘1ï¼Œæˆ‘ä»¬ä¼šå‘ç°2åé¢çš„èŠ‚ç‚¹å·²ç»æ— æ³•è®¿é—®åˆ°äº†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æå‰å°†2åé¢çš„3è®°å½•ä¸‹æ¥ï¼Œç„¶åå†å°†2æŒ‡å‘1ï¼Œç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬æå‰å°†3åé¢çš„4è®°å½•ä¸‹æ¥ï¼Œå†å°†3æŒ‡å‘2â€¦ç›´è‡³åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚ å®šä¹‰ä¸‰ä¸ªæŒ‡é’ˆå˜é‡ï¼špreã€currentã€nextã€‚ åˆå§‹çŠ¶æ€ï¼špre = null,current = 1,next = nullã€‚ åè½¬è¿‡ç¨‹ï¼š 12next = current.next;current.next = pre; æŒ‡é’ˆå³ç§»ï¼š 12pre = current;current = next; ç»ˆæ­¢æ¡ä»¶ï¼šcurrent.next == nullã€‚ Javaè¯­è¨€å®Œæ•´å®ç°ï¼š å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼šæ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯† 1234567891011121314151617181920public static SinglyLinkedListNode reverse(SinglyLinkedListNode head) { if (head == null || head.next == null) { return head; } // å®šä¹‰ä¸‰ä¸ªæŒ‡é’ˆï¼špreã€currentã€next SinglyLinkedListNode pre = null; SinglyLinkedListNode current = head; SinglyLinkedListNode next = null; while (current.next != null) { // è®°å½•currentçš„next next = current.next; // currentåè½¬ current.next = pre; // preå³ç§» pre = current; // currentå³ç§» current = next; } return current;}","link":"/2020/12/12/algorithm/base/datastructure/non-recursive-reverse-link/"},{"title":"Apache Mavenå¿…çŸ¥å¿…ä¼š","text":"å‰è¨€åœ¨æ²¡æœ‰ä½¿ç”¨Mavenä¹‹å‰ï¼Œæˆ‘ä»¬å¼€å‘ä¸€ä¸ªJavaWebé¡¹ç›®ï¼Œå¦‚æœä½¿ç”¨åˆ°éJDKæä¾›çš„ç±»åº“ï¼Œéœ€è¦å»ç½‘ä¸Šä¸‹è½½å¯¹åº”çš„jaråŒ…ï¼Œç„¶åå°†jaråŒ…å¤åˆ¶ç²˜è´´æ”¾åˆ°é¡¹ç›®çš„libç›®å½•ä¸‹æ‰èƒ½å¤Ÿä½¿ç”¨ã€‚è¿™æ ·çš„åšæ³•æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œæ¯å¼€å‘ä¸€ä¸ªJavaWebé¡¹ç›®éƒ½éœ€è¦å»å°†jaråŒ…æ–‡ä»¶æ”¾ç½®åœ¨libç›®å½•ä¸‹ï¼Œä¸”åªèƒ½ä»¥æ–‡ä»¶çš„å½¢å¼è¿›è¡Œç®¡ç†ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Mavençš„ä¾èµ–ç®¡ç†åŠŸèƒ½æ¥å‡å°‘å¤åˆ¶jaråŒ…è¿™æ ·é‡å¤çš„å·¥ä½œã€‚ ä»€ä¹ˆæ˜¯Mavenï¼ŸMavenæ˜¯ä¸€ä¸ªé¡¹ç›®ç®¡ç†å·¥å…·ï¼Œå¯ä»¥å¯¹é¡¹ç›®ï¼ˆä¸ä»…é™äºJavaè¯­è¨€ï¼‰è¿›è¡Œæ„å»ºå’Œä¾èµ–ç®¡ç†ã€‚ç®€å•æ¥è¯´ï¼šä½¿ç”¨äº†Mavenä¹‹åæˆ‘ä»¬å°±ä¸éœ€è¦å†å»ä¸‹è½½å¤åˆ¶ç²˜è´´jaråŒ…äº†ã€‚ Mavenå®‰è£…Windows 10ä¸‹Mavençš„å®‰è£…åŠé…ç½® Mavençš„çº¦å®šé…ç½®Mavenæä¾›çº¦å®šä¼˜äºé…ç½®çš„åŸåˆ™ï¼Œå¯¹äºä¸€ä¸ªä½¿ç”¨Mavenæ„å»ºå’Œä¾èµ–ç®¡ç†çš„é¡¹ç›®ï¼Œåº”è¯¥éµå¾ªä»¥ä¸‹çš„ç›®å½•ç»“æ„ï¼š ç›®å½• ç›®å½•å­˜æ”¾å†…å®¹ ${basedir} Mavené¡¹ç›®æ ¹è·¯å¾„ï¼Œå­˜æ”¾pom.xmlå’Œæ‰€æœ‰çš„å­ç›®å½• ${basedir}/src/main/java é¡¹ç›®çš„javaç±»æ–‡ä»¶ ${basedir}/src/main/resources é¡¹ç›®çš„èµ„æºæ–‡ä»¶ï¼Œä¾‹å¦‚propertiesé…ç½®æ–‡ä»¶ï¼Œå‰ç«¯é™æ€èµ„æºæ–‡ä»¶ç­‰ ${basedir}/src/test/java é¡¹ç›®çš„å•å…ƒæµ‹è¯•ç±»æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸ºJunitçš„å•å…ƒæµ‹è¯•ç±» ${basedir}/src/test/resources æä¾›ç»™æµ‹è¯•ç±»ä½¿ç”¨çš„èµ„æºæ–‡ä»¶ ${basedir}/src/main/webapp/WEB-INF JavaWebé¡¹ç›®çš„webåº”ç”¨æ–‡ä»¶ç›®å½•ï¼Œå­˜æ”¾web.xmlã€.jspå’Œå‰ç«¯é™æ€èµ„æºç­‰æ–‡ä»¶ã€‚ ${basedir}/target æ‰“åŒ…è¾“å‡ºç›®å½• ${basedir}/target/classes ç¼–è¯‘è¾“å‡ºç›®å½•ï¼Œjavaç±»ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ç›®å½• ${basedir}/target/test-classes æµ‹è¯•ç±»ç¼–è¯‘è¾“å‡ºç›®å½• XXXTest.java Mavenåªä¼šè‡ªåŠ¨è¿è¡Œç±»åä»¥Testç»“å°¾çš„æµ‹è¯•ç±» ~/.m2/repository Mavençš„é»˜è®¤æœ¬åœ°ä»“åº“è·¯å¾„ pom.xmlå¸¸ç”¨æ ‡ç­¾ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹Spring Booté¡¹ç›®çš„pom.xmlæ–‡ä»¶å†…å®¹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;!-- å£°æ˜é¡¹ç›®æè¿°ç¬¦éµå¾ªå“ªä¸€ä¸ªPOMæ¨¡å‹ç‰ˆæœ¬ã€‚æ¨¡å‹æœ¬èº«çš„ç‰ˆæœ¬å¾ˆå°‘æ”¹å˜ï¼Œè™½ç„¶å¦‚æ­¤ï¼Œä½†å®ƒä»ç„¶æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œè¿™æ˜¯ä¸ºäº†å½“Mavenå¼•å…¥äº†æ–°çš„ç‰¹æ€§æˆ–è€…å…¶ä»–æ¨¡å‹å˜æ›´çš„æ—¶å€™ï¼Œç¡®ä¿ç¨³å®šæ€§ã€‚ --&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;!-- çˆ¶é¡¹ç›®çš„åæ ‡ã€‚å¦‚æœé¡¹ç›®ä¸­æ²¡æœ‰è§„å®šæŸä¸ªå…ƒç´ çš„å€¼ï¼Œé‚£ä¹ˆçˆ¶é¡¹ç›®ä¸­çš„å¯¹åº”å€¼å³ä¸ºé¡¹ç›®çš„é»˜è®¤å€¼ï¼ˆç»§æ‰¿ï¼‰ã€‚ åæ ‡åŒ…æ‹¬group IDï¼Œartifact IDå’Œversionã€‚--&gt; &lt;parent&gt; &lt;!-- çˆ¶é¡¹ç›®çš„å”¯ä¸€ç»„ç»‡å --&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;!-- çˆ¶é¡¹ç›®çš„å”¯ä¸€æ„å»ºæ ‡è¯†ç¬¦ --&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;!-- çˆ¶é¡¹ç›®çš„ç‰ˆæœ¬å· --&gt; &lt;version&gt;2.4.0&lt;/version&gt; &lt;!-- çˆ¶é¡¹ç›®çš„pom.xmlæ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚ç›¸å¯¹è·¯å¾„å…è®¸ä½ é€‰æ‹©ä¸€ä¸ªä¸åŒçš„è·¯å¾„ã€‚é»˜è®¤å€¼æ˜¯../pom.xmlã€‚Mavené¦–å…ˆåœ¨æ„å»ºå½“å‰é¡¹ç›®çš„åœ°æ–¹å¯»æ‰¾çˆ¶é¡¹ç›®çš„pomï¼Œå…¶æ¬¡åœ¨æ–‡ä»¶ç³»ç»Ÿçš„è¿™ä¸ªä½ç½®ï¼ˆrelativePathä½ç½®ï¼‰ï¼Œç„¶ååœ¨æœ¬åœ°ä»“åº“ï¼Œæœ€ååœ¨è¿œç¨‹ä»“åº“å¯»æ‰¾çˆ¶é¡¹ç›®çš„pomã€‚ --&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;!-- å½“å‰é¡¹ç›®çš„å”¯ä¸€ç»„ç»‡å --&gt; &lt;groupId&gt;com.sunchaser.demo&lt;/groupId&gt; &lt;!-- å½“å‰é¡¹ç›®çš„å”¯ä¸€æ„å»ºæ ‡è¯†ç¬¦ --&gt; &lt;artifactId&gt;springboot&lt;/artifactId&gt; &lt;!-- å½“å‰é¡¹ç›®çš„ç‰ˆæœ¬å·ï¼Œæ ¼å¼ä¸º:ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.å¢é‡ç‰ˆæœ¬-é™å®šç‰ˆæœ¬å· --&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;!-- å½“å‰é¡¹ç›®çš„åç§° --&gt; &lt;name&gt;springboot&lt;/name&gt; &lt;!-- å½“å‰é¡¹ç›®çš„æè¿°ç®€ä»‹ --&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;!-- ä»¥å€¼ï¼ˆvalueï¼‰ä»£æ›¿åç§°ï¼ˆnameï¼‰ï¼Œå¯åœ¨æ•´ä¸ªpom.xmlä¸­ä½¿ç”¨ï¼Œæ ¼å¼ï¼š&lt;name&gt;value&lt;name/&gt; --&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;/properties&gt; &lt;!-- å‘ç°ä¾èµ–å’Œæ‰©å±•çš„è¿œç¨‹ä»“åº“åˆ—è¡¨ã€‚ --&gt; &lt;repositories&gt; &lt;!-- åŒ…å«éœ€è¦è¿æ¥åˆ°è¿œç¨‹ä»“åº“çš„ä¿¡æ¯ --&gt; &lt;repository&gt; &lt;!-- å¦‚ä½•å¤„ç†è¿œç¨‹ä»“åº“é‡Œå‘å¸ƒç‰ˆæœ¬çš„ä¸‹è½½ --&gt; &lt;releases&gt; &lt;!-- trueæˆ–è€…falseè¡¨ç¤ºè¯¥ä»“åº“æ˜¯å¦ä¸ºä¸‹è½½æŸç§ç±»å‹æ„ä»¶ï¼ˆå‘å¸ƒç‰ˆï¼Œå¿«ç…§ç‰ˆï¼‰å¼€å¯ã€‚ --&gt; &lt;enabled /&gt; &lt;!-- è¯¥å…ƒç´ æŒ‡å®šæ›´æ–°å‘ç”Ÿçš„é¢‘ç‡ã€‚Mavenä¼šæ¯”è¾ƒæœ¬åœ°POMå’Œè¿œç¨‹POMçš„æ—¶é—´æˆ³ã€‚è¿™é‡Œçš„é€‰é¡¹æ˜¯ï¼šalwaysï¼ˆä¸€ç›´ï¼‰ï¼Œdailyï¼ˆé»˜è®¤ï¼Œæ¯æ—¥ï¼‰ï¼Œintervalï¼šXï¼ˆè¿™é‡ŒXæ˜¯ä»¥åˆ†é’Ÿä¸ºå•ä½çš„æ—¶é—´é—´éš”ï¼‰ï¼Œæˆ–è€…neverï¼ˆä»ä¸ï¼‰ã€‚ --&gt; &lt;updatePolicy /&gt; &lt;!-- å½“MavenéªŒè¯æ„ä»¶æ ¡éªŒæ–‡ä»¶å¤±è´¥æ—¶è¯¥æ€ä¹ˆåšï¼šignoreï¼ˆå¿½ç•¥ï¼‰ï¼Œfailï¼ˆå¤±è´¥ï¼‰ï¼Œæˆ–è€…warnï¼ˆè­¦å‘Šï¼‰ã€‚ --&gt; &lt;checksumPolicy /&gt; &lt;/releases&gt; &lt;!-- å¦‚ä½•å¤„ç†è¿œç¨‹ä»“åº“é‡Œå¿«ç…§ç‰ˆæœ¬çš„ä¸‹è½½ã€‚æœ‰äº†releaseså’Œsnapshotsè¿™ä¸¤ç»„é…ç½®ï¼ŒPOMå°±å¯ä»¥åœ¨æ¯ä¸ªå•ç‹¬çš„ä»“åº“ä¸­ï¼Œä¸ºæ¯ç§ç±»å‹çš„æ„ä»¶é‡‡å–ä¸åŒçš„ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œå¯èƒ½æœ‰äººä¼šå†³å®šåªä¸ºå¼€å‘ç›®çš„å¼€å¯å¯¹å¿«ç…§ç‰ˆæœ¬ä¸‹è½½çš„æ”¯æŒã€‚å‚è§repositories/repository/releaseså…ƒç´  --&gt; &lt;snapshots&gt; &lt;enabled /&gt; &lt;updatePolicy /&gt; &lt;checksumPolicy /&gt; &lt;/snapshots&gt; &lt;!--è¿œç¨‹ä»“åº“å”¯ä¸€æ ‡è¯†ç¬¦ã€‚å¯ä»¥ç”¨æ¥åŒ¹é…åœ¨settings.xmlæ–‡ä»¶é‡Œé…ç½®çš„è¿œç¨‹ä»“åº“ --&gt; &lt;id&gt;aliyun&lt;/id&gt; &lt;!--è¿œç¨‹ä»“åº“åç§° --&gt; &lt;name&gt;aliyun maven&lt;/name&gt; &lt;!--è¿œç¨‹ä»“åº“URLï¼ŒæŒ‰protocol://hostname/pathå½¢å¼ --&gt; &lt;url&gt;http://maven.aliyun.com/nexus/content/repositories/central/&lt;/url&gt; &lt;!-- ç”¨äºå®šä½å’Œæ’åºæ„ä»¶çš„ä»“åº“å¸ƒå±€ç±»å‹-å¯ä»¥æ˜¯defaultï¼ˆé»˜è®¤ï¼‰æˆ–è€…legacyï¼ˆé—ç•™ï¼‰ã€‚Maven2ä¸ºå…¶ä»“åº“æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„å¸ƒå±€ï¼›ç„¶è€Œï¼ŒMaven 1.xæœ‰ä¸€ç§ä¸åŒçš„å¸ƒå±€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥å…ƒç´ æŒ‡å®šå¸ƒå±€æ˜¯defaultï¼ˆé»˜è®¤ï¼‰è¿˜æ˜¯legacyï¼ˆé—ç•™ï¼‰ã€‚ --&gt; &lt;layout&gt;default&lt;/layout&gt; &lt;/repository&gt; &lt;/repositories&gt; &lt;!-- è¯¥å…ƒç´ æè¿°äº†é¡¹ç›®ç›¸å…³çš„æ‰€æœ‰ä¾èµ–ã€‚è¿™äº›ä¾èµ–ç»„æˆäº†é¡¹ç›®æ„å»ºè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªä¸ªç¯èŠ‚ã€‚å®ƒä»¬è‡ªåŠ¨ä»é¡¹ç›®å®šä¹‰çš„ä»“åº“ä¸­ä¸‹è½½ã€‚è¦è·å–æ›´å¤šä¿¡æ¯ï¼Œè¯·çœ‹é¡¹ç›®ä¾èµ–æœºåˆ¶ã€‚ --&gt; &lt;dependencies&gt; &lt;!-- ç”±äºparentçš„å­˜åœ¨ï¼Œä»¥ä¸‹ä¾èµ–ç»§æ‰¿äº†parentä¸­ç”³æ˜çš„ç‰ˆæœ¬å· --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;!-- å¯é€‰ä¾èµ–ï¼Œå¦‚æœä½ åœ¨é¡¹ç›®Bä¸­æŠŠCä¾èµ–å£°æ˜ä¸ºå¯é€‰ï¼Œä½ å°±éœ€è¦åœ¨ä¾èµ–äºBçš„é¡¹ç›®ï¼ˆä¾‹å¦‚é¡¹ç›®Aï¼‰ä¸­æ˜¾å¼çš„å¼•ç”¨å¯¹Cçš„ä¾èµ–ã€‚å¯é€‰ä¾èµ–é˜»æ–­ä¾èµ–çš„ä¼ é€’æ€§ã€‚ --&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;!-- ä¾èµ–èŒƒå›´ã€‚åœ¨é¡¹ç›®å‘å¸ƒè¿‡ç¨‹ä¸­ï¼Œå¸®åŠ©å†³å®šå“ªäº›æ„ä»¶è¢«åŒ…æ‹¬è¿›æ¥ã€‚æ¬²çŸ¥è¯¦æƒ…è¯·å‚è€ƒä¾èµ–æœºåˆ¶ã€‚ - compile ï¼šé»˜è®¤èŒƒå›´ï¼Œç”¨äºç¼–è¯‘ - providedï¼šç±»ä¼¼äºç¼–è¯‘ï¼Œä½†æ”¯æŒä½ æœŸå¾…jdkæˆ–è€…å®¹å™¨æä¾›ï¼Œç±»ä¼¼äºclasspath - runtime: åœ¨æ‰§è¡Œæ—¶éœ€è¦ä½¿ç”¨ - test: ç”¨äºtestä»»åŠ¡æ—¶ä½¿ç”¨ - system: éœ€è¦å¤–åœ¨æä¾›ç›¸åº”çš„å…ƒç´ ã€‚é€šè¿‡systemPathæ¥å–å¾— - systemPath: ä»…ç”¨äºèŒƒå›´ä¸ºsystemã€‚æä¾›ç›¸åº”çš„è·¯å¾„ - optional: å½“é¡¹ç›®è‡ªèº«è¢«ä¾èµ–æ—¶ï¼Œæ ‡æ³¨ä¾èµ–æ˜¯å¦ä¼ é€’ã€‚ç”¨äºè¿ç»­ä¾èµ–æ—¶ä½¿ç”¨ --&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;!-- æ„å»ºé¡¹ç›®éœ€è¦çš„ä¿¡æ¯ --&gt; &lt;build&gt; &lt;!-- ä½¿ç”¨çš„æ’ä»¶åˆ—è¡¨ --&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; ä»¥ä¸Šæ˜¯å°†Spring Bootä½œä¸ºparentçš„pom.xmlï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯parentå¯ä»¥èšåˆä¾èµ–çš„ç‰ˆæœ¬ç­‰ä¸€äº›ä¿¡æ¯ï¼Œåœ¨åé¢æ·»åŠ ä¾èµ–æ—¶åªéœ€è¦å¡«å†™groupIdå’ŒartifactIdåæ ‡ï¼Œç‰ˆæœ¬å·é»˜è®¤ç»§æ‰¿parentä¸­å®šä¹‰çš„ç‰ˆæœ¬å·ã€‚ä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„é¡¹ç›®æ˜¯Mavenå¤šæ¨¡å—é¡¹ç›®ï¼Œæˆ–è€…ç”±äºä¸€äº›å…¶å®ƒåŸå› å¯¼è‡´æˆ‘ä»¬æ— æ³•ä½¿ç”¨Spring Bootä½œä¸ºparentï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°dependencyManagementæ ‡ç­¾æ¥è¿›è¡Œä¾èµ–é¢„å®šä¹‰äº†ï¼ŒSpring Bootæä¾›äº†BOMç”¨æ¥è¿›è¡Œé¢„å®šä¹‰ä¾èµ–çš„å¼•å…¥ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.sunchaser.demo&lt;/groupId&gt; &lt;artifactId&gt;springboot&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;springboot&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;/properties&gt; &lt;!-- é¢„å®šä¹‰ä¾èµ–å¼•å…¥ --&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;2.4.0&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; Mavençš„ç”Ÿå‘½å‘¨æœŸMavenæœ‰ä¸‰ä¸ªæ ‡å‡†çš„ç”Ÿå‘½å‘¨æœŸï¼š cleanï¼šé¡¹ç›®æ¸…ç†çš„å¤„ç†ã€‚ default(build)ï¼šé¡¹ç›®éƒ¨ç½²çš„å¤„ç†ã€‚ siteï¼šé¡¹ç›®ç«™ç‚¹æ–‡æ¡£åˆ›å»ºçš„å¤„ç†ã€‚ Cleanç”Ÿå‘½å‘¨æœŸåŒ…å«ä»¥ä¸‹é˜¶æ®µï¼š pre-cleanï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨cleanä¹‹å‰å®Œæˆçš„å·¥ä½œã€‚ cleanï¼šç§»é™¤æ‰€æœ‰ä¸Šä¸€æ¬¡æ„å»ºç”Ÿæˆçš„æ–‡ä»¶ã€‚ post-cleanï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨cleanä¹‹åç«‹å³å®Œæˆçš„å·¥ä½œã€‚ æˆ‘ä»¬æ‰€ç”¨çš„mvn cleanå‘½ä»¤å°±æ˜¯ä¸Šé¢çš„cleané˜¶æ®µã€‚åœ¨ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œè¿è¡ŒæŸä¸ªé˜¶æ®µçš„æ—¶å€™ï¼Œåœ¨å®ƒä¹‹å‰çš„æ‰€æœ‰é˜¶æ®µéƒ½ä¼šè¢«è¿è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ‰§è¡Œmaven cleanå‘½ä»¤å°†è¿è¡Œpre-cleanå’Œcleanè¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸé˜¶æ®µã€‚ Default(build)ç”Ÿå‘½å‘¨æœŸåŒ…å«ä»¥ä¸‹23ä¸ªé˜¶æ®µï¼š validateæ ¡éªŒï¼šæ ¡éªŒé¡¹ç›®æ˜¯å¦æ­£ç¡®å¹¶ä¸”æ‰€æœ‰å¿…è¦çš„ä¿¡æ¯å¯ä»¥å®Œæˆé¡¹ç›®çš„æ„å»ºè¿‡ç¨‹ã€‚ initializeåˆå§‹åŒ–ï¼šåˆå§‹åŒ–æ„å»ºé˜¶æ®µï¼Œæ¯”å¦‚è®¾ç½®å±æ€§å€¼ã€‚ generate-sourcesç”Ÿæˆæºä»£ç ï¼šç”ŸæˆåŒ…å«åœ¨ç¼–è¯‘é˜¶æ®µä¸­çš„ä»»ä½•æºä»£ç ã€‚ process-sourceså¤„ç†æºä»£ç ï¼šå¤„ç†æºä»£ç ï¼Œæ¯”å¦‚è¿‡æ»¤ä»»æ„å€¼ã€‚ generate-resourcesç”Ÿæˆèµ„æºæ–‡ä»¶ï¼šç”Ÿæˆå°†ä¼šåŒ…å«åœ¨é¡¹ç›®åŒ…ä¸­çš„èµ„æºæ–‡ä»¶ã€‚ process-resourceså¤„ç†èµ„æºæ–‡ä»¶ï¼šå¤åˆ¶å’Œå¤„ç†èµ„æºåˆ°ç›®æ ‡ç›®å½•ï¼Œä¸ºæ‰“åŒ…é˜¶æ®µåšå¥½å‡†å¤‡ã€‚ compileç¼–è¯‘ï¼šç¼–è¯‘é¡¹ç›®çš„æºä»£ç ã€‚ process-classeså¤„ç†ç±»æ–‡ä»¶ï¼šå¤„ç†ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ¯”å¦‚è¯´å¯¹Java classæ–‡ä»¶åšå­—èŠ‚ç æ”¹å–„ä¼˜åŒ–ã€‚ generate-test-sourcesç”Ÿæˆæµ‹è¯•æºä»£ç ï¼šç”ŸæˆåŒ…å«åœ¨ç¼–è¯‘é˜¶æ®µä¸­çš„ä»»ä½•æµ‹è¯•æºä»£ç ã€‚ process-test-sourceså¤„ç†æµ‹è¯•æºä»£ç ï¼šå¤„ç†æµ‹è¯•æºä»£ç ï¼Œæ¯”å¦‚è¯´ï¼Œè¿‡æ»¤ä»»æ„å€¼ã€‚ generate-test-resourcesç”Ÿæˆæµ‹è¯•èµ„æºæ–‡ä»¶ï¼šä¸ºæµ‹è¯•åˆ›å»ºèµ„æºæ–‡ä»¶ã€‚ process-test-resourceså¤„ç†æµ‹è¯•èµ„æºæ–‡ä»¶ï¼šå¤åˆ¶å’Œå¤„ç†æµ‹è¯•èµ„æºåˆ°ç›®æ ‡ç›®å½•ã€‚ test-compileç¼–è¯‘æµ‹è¯•æºç ï¼šç¼–è¯‘æµ‹è¯•æºä»£ç åˆ°æµ‹è¯•ç›®æ ‡ç›®å½•ã€‚ process-test-classå¤„ç†æµ‹è¯•ç±»æ–‡ä»¶ï¼šå¤„ç†æµ‹è¯•æºç ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ã€‚ testæµ‹è¯•ï¼šä½¿ç”¨åˆé€‚çš„å•å…ƒæµ‹è¯•æ¡†æ¶è¿è¡Œæµ‹è¯•ï¼ˆJunitæ˜¯å…¶ä¸­ä¹‹ä¸€ï¼‰ã€‚ prepare-packageå‡†å¤‡æ‰“åŒ…ï¼šåœ¨å®é™…æ‰“åŒ…ä¹‹å‰ï¼Œæ‰§è¡Œä»»ä½•çš„å¿…è¦çš„æ“ä½œä¸ºæ‰“åŒ…åšå‡†å¤‡ã€‚ packageæ‰“åŒ…ï¼šå°†ç¼–è¯‘åçš„ä»£ç æ‰“åŒ…æˆå¯åˆ†å‘æ ¼å¼çš„æ–‡ä»¶ï¼Œæ¯”å¦‚JARã€WARæˆ–è€…EARæ–‡ä»¶ã€‚ pre-integration-testé›†æˆæµ‹è¯•å‰ï¼šåœ¨æ‰§è¡Œé›†æˆæµ‹è¯•å‰è¿›è¡Œå¿…è¦çš„åŠ¨ä½œã€‚æ¯”å¦‚è¯´ï¼Œæ­å»ºéœ€è¦çš„ç¯å¢ƒã€‚ integration-testé›†æˆæµ‹è¯•ï¼šå¤„ç†å’Œéƒ¨ç½²é¡¹ç›®åˆ°å¯ä»¥è¿è¡Œé›†æˆæµ‹è¯•ç¯å¢ƒä¸­ã€‚ post-integration-testé›†æˆæµ‹è¯•åï¼šåœ¨æ‰§è¡Œé›†æˆæµ‹è¯•å®Œæˆåè¿›è¡Œå¿…è¦çš„åŠ¨ä½œã€‚æ¯”å¦‚è¯´ï¼Œæ¸…ç†é›†æˆæµ‹è¯•ç¯å¢ƒã€‚ verifyéªŒè¯ï¼šè¿è¡Œä»»æ„çš„æ£€æŸ¥æ¥éªŒè¯é¡¹ç›®åŒ…æœ‰æ•ˆä¸”è¾¾åˆ°è´¨é‡æ ‡å‡†ã€‚ installå®‰è£…ï¼šå®‰è£…é¡¹ç›®åŒ…åˆ°æœ¬åœ°ä»“åº“ï¼Œè¿™æ ·é¡¹ç›®åŒ…å¯ä»¥ç”¨ä½œå…¶ä»–æœ¬åœ°é¡¹ç›®çš„ä¾èµ–ã€‚ deployéƒ¨ç½²ï¼šå°†æœ€ç»ˆçš„é¡¹ç›®åŒ…å‘å¸ƒåˆ°è¿œç¨‹ä»“åº“ä¸­ä¸å…¶ä»–å¼€å‘è€…å’Œé¡¹ç›®å…±äº«ã€‚ æˆ‘ä»¬å¸¸ç”¨çš„mvn installå‘½ä»¤ï¼Œåœ¨æ‰§è¡Œinstallä¹‹å‰ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œäº†ä¹‹å‰çš„21ä¸ªé˜¶æ®µã€‚å¦‚æœç”¨äºå¤šæ¨¡å—é¡¹ç›®ï¼Œæ¯ä¸€ä¸ªå­é¡¹ç›®éƒ½ä¼šæ‰§è¡Œmvn installå‘½ä»¤ã€‚ è¿˜å¯ä»¥ä¸€æ¬¡æŒ‡å®šä¸¤ä¸ªé˜¶æ®µï¼Œä¾‹å¦‚mvn clean deployï¼Œè¿™å¯ä»¥ç”¨æ¥çº¯å‡€çš„æ„å»ºå’Œéƒ¨ç½²é¡¹ç›®åˆ°è¿œç¨‹ä»“åº“ä¸­ã€‚Mavenä¼šå…ˆæ‰§è¡Œcleanå‘½ä»¤ï¼Œå†æ‰§è¡Œdeployå‘½ä»¤ï¼Œå¯¹å¤šæ¨¡å—é¡¹ç›®ä¹Ÿé€‚ç”¨ã€‚ Siteç”Ÿå‘½å‘¨æœŸMaven Siteæ’ä»¶ä¸€èˆ¬ç”¨æ¥åˆ›å»ºæ–°çš„æŠ¥å‘Šæ–‡æ¡£å’Œéƒ¨ç½²ç«™ç‚¹ç­‰ã€‚è¿™ä¸ªåœ¨æˆ‘ä»¬çš„å¼€å‘å·¥ä½œä¸­ä¸€èˆ¬ä¸ä¼šç”¨åˆ°ï¼Œäº†è§£å³å¯ã€‚ åŒ…å«ä»¥ä¸‹4ä¸ªé˜¶æ®µï¼š pre-siteï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨ç”Ÿæˆç«™ç‚¹æ–‡æ¡£ä¹‹å‰å®Œæˆçš„å·¥ä½œã€‚ siteï¼šç”Ÿæˆé¡¹ç›®çš„ç«™ç‚¹æ–‡æ¡£ã€‚ post-siteï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨ç”Ÿæˆç«™ç‚¹æ–‡æ¡£ä¹‹åå®Œæˆçš„å·¥ä½œï¼Œå¹¶ä¸”ä¸ºéƒ¨ç½²åšå‡†å¤‡ã€‚ site-deployï¼šå°†ç”Ÿæˆçš„ç«™ç‚¹æ–‡æ¡£éƒ¨ç½²åˆ°ç‰¹å®šçš„æœåŠ¡å™¨ä¸Šã€‚ Mavenä»“åº“Mavenä»“åº“ç®€å•çš„ç†è§£å°±æ˜¯å­˜å‚¨JARåŒ…çš„åœ°æ–¹ã€‚æœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹ï¼š æœ¬åœ°ä»“åº“ï¼ˆlocalï¼‰ ä¸­å¤®ä»“åº“ï¼ˆcentralï¼‰ è¿œç¨‹ä»“åº“ï¼ˆremoteï¼‰ æœ¬åœ°ä»“åº“ï¼ˆlocalï¼‰è¿è¡ŒMavené¡¹ç›®æ—¶ï¼Œä»»ä½•ä¾èµ–çš„æ„å»ºæˆ–ç¬¬ä¸‰æ–¹JARåŒ…éƒ½æ˜¯ç›´æ¥ä»æœ¬åœ°ä»“åº“è·å–çš„ã€‚å¦‚æœæœ¬åœ°ä»“åº“æ²¡æœ‰ï¼Œå®ƒä¼šé¦–å…ˆå°è¯•ä»è¿œç¨‹ä»“åº“ä¸‹è½½æ„å»ºè‡³æœ¬åœ°ä»“åº“ï¼Œç„¶åå†ä½¿ç”¨æœ¬åœ°ä»“åº“çš„æ„å»ºã€‚ é»˜è®¤çš„æœ¬åœ°ä»“åº“è·¯å¾„ä¸º~/.m2/repositoryï¼Œè¦ä¿®æ”¹è¯¥é»˜è®¤ä½ç½®ï¼Œå¯åœ¨Mavençš„setting.xmlæ–‡ä»¶ä¸­æŒ‡å®šæœ¬åœ°ä»“åº“è·¯å¾„ï¼š 123456&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;settings xmlns=&quot;http://maven.apache.org/SETTINGS/1.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;&gt; &lt;localRepository&gt;/Library/maven/repository&lt;/localRepository&gt;&lt;/settings&gt; ä¸­å¤®ä»“åº“ï¼ˆcentralï¼‰ä¸­å¤®ä»“åº“æ˜¯ç”±Mavenç¤¾åŒºæä¾›çš„ä»“åº“ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œè¿›è¡Œè®¿é—®ã€‚å›½å†…å¸¸ç”¨çš„æ˜¯é˜¿é‡Œäº‘ä¸­å¤®ä»“åº“ã€‚å¯åœ¨Mavençš„setting.xmlæ–‡ä»¶ä¸­é…ç½®é˜¿é‡Œäº‘çš„ä¸­å¤®ä»“åº“æºï¼š 1234567891011121314&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;settings xmlns=&quot;http://maven.apache.org/SETTINGS/1.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;&gt; &lt;localRepository&gt;/Library/maven/repository&lt;/localRepository&gt; &lt;mirrors&gt; &lt;mirror&gt; &lt;id&gt;alimaven&lt;/id&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;name&gt;aliyun maven&lt;/name&gt; &lt;url&gt;http://maven.aliyun.com/nexus/content/repositories/central/&lt;/url&gt; &lt;/mirror&gt; &lt;/mirrors&gt;&lt;/settings&gt; Mavenç¤¾åŒºæä¾›äº†ä¸€ä¸ªç½‘ç«™ï¼šhttps://search.maven.orgï¼Œå¯æœç´¢åˆ°æ‰€æœ‰å¯ä»¥è·å–çš„æ„å»ºåº“å’ŒJARåŒ…ã€‚ è¿œç¨‹ä»“åº“ï¼ˆremoteï¼‰å¦‚æœMavenåœ¨ä¸­å¤®ä»“åº“ä¹Ÿæ‰¾ä¸åˆ°ä¾èµ–çš„æ„å»ºï¼Œå®ƒä¼šåœæ­¢æ„å»ºè¿‡ç¨‹å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒMavenæä¾›äº†è¿œç¨‹ä»“åº“çš„æ¦‚å¿µï¼Œå®ƒæ˜¯å¼€å‘äººå‘˜è‡ªå·±å®šåˆ¶çš„ä»“åº“ï¼ŒåŒ…å«äº†æ‰€éœ€è¦çš„ä»£ç åº“æˆ–è€…å…¶å®ƒå·¥ç¨‹ä¸­ç”¨åˆ°çš„JARæ–‡ä»¶ã€‚ Mavenä¾èµ–æœç´¢é¡ºåºé¦–å…ˆä»æœ¬åœ°ä»“åº“ï¼ˆlocalï¼‰ä¸­æœç´¢ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™å»ä¸­å¤®ä»“åº“ï¼ˆcentralï¼‰ä¸­æœç´¢ï¼› å¦‚æœåœ¨ä¸­å¤®ä»“åº“ï¼ˆcentralï¼‰ä¸­æ‰¾ä¸åˆ°ï¼Œåˆ™æŸ¥çœ‹æ˜¯å¦è®¾ç½®äº†è¿œç¨‹ä»“åº“ï¼ˆremoteï¼‰ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™åœæ­¢æœç´¢å¹¶æŠ›å‡ºé”™è¯¯ï¼ˆæ— æ³•æ‰¾åˆ°ä¾èµ–ï¼‰ã€‚ å¦‚æœåœ¨è¿œç¨‹ä»“åº“ï¼ˆremoteï¼‰ä¸­æ‰¾ä¸åˆ°ï¼Œåˆ™åœæ­¢æœç´¢å¹¶æŠ›å‡ºé”™è¯¯ï¼ˆæ— æ³•æ‰¾åˆ°ä¾èµ–ï¼‰ï¼›å¦‚æœåœ¨è¿œç¨‹ä»“åº“ï¼ˆremoteï¼‰ä¸­æ‰¾åˆ°äº†ï¼Œåˆ™ä¸‹è½½è‡³æœ¬åœ°ä»“åº“å¹¶å¼•ç”¨ã€‚ Mavenæ’ä»¶Mavençš„ä¸‰ä¸ªæ ‡å‡†ç”Ÿå‘½å‘¨æœŸä¸­éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é˜¶æ®µï¼Œæ¯ä¸€ä¸ªé˜¶æ®µçš„å…·ä½“å®ç°éƒ½æ˜¯ç”±Mavençš„æ’ä»¶å®Œæˆã€‚ ä¾‹å¦‚æˆ‘ä»¬ä½¿ç”¨çš„mvn cleanå‘½ä»¤ï¼Œcleanå¯¹åº”ç€Cleanç”Ÿå‘½å‘¨æœŸä¸­çš„cleané˜¶æ®µï¼Œcleançš„å…·ä½“æ“ä½œæ˜¯ç”±maven-clean-pluginå®Œæˆçš„ã€‚ æ’ä»¶ç±»å‹Mavenæä¾›äº†ä»¥ä¸‹ä¸¤ç§ç±»å‹çš„æ’ä»¶ï¼š Build Pluginsï¼šåœ¨æ„å»ºæ—¶æ‰§è¡Œï¼Œå¹¶åœ¨pom.xmlçš„å…ƒç´ ä¸­é…ç½®ã€‚ Reporting Pluginsï¼šåœ¨ç½‘ç«™ç”Ÿæˆè¿‡ç¨‹ä¸­æ‰§è¡Œï¼Œå¹¶åœ¨pom.xmlçš„å…ƒç´ ä¸­é…ç½®ã€‚ å¸¸ç”¨æ’ä»¶ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„æ’ä»¶ï¼š cleanï¼šæ„å»ºä¹‹åæ¸…ç†ç›®æ ‡æ–‡ä»¶ã€‚åˆ é™¤ç›®æ ‡ç›®å½•ã€‚ compilerï¼šç¼–è¯‘Javaæºæ–‡ä»¶ã€‚ surefileï¼šè¿è¡ŒJunitå•å…ƒæµ‹è¯•ã€‚åˆ›å»ºæµ‹è¯•æŠ¥å‘Šã€‚ jarï¼šä»å½“å‰å·¥ç¨‹ä¸­æ„å»ºjaræ–‡ä»¶ã€‚ warï¼šä»å½“å‰å·¥ç¨‹ä¸­æ„å»ºwaræ–‡ä»¶ã€‚ javadocï¼šä¸ºå·¥ç¨‹ç”Ÿæˆjavadocã€‚ antrunï¼šä»æ„å»ºè¿‡ç¨‹çš„ä»»æ„ä¸€ä¸ªé˜¶æ®µä¸­è¿è¡Œä¸€ä¸ªantä»»åŠ¡çš„é›†åˆã€‚ å¼•å…¥å¤–éƒ¨ä¾èµ–æœ‰äº›æ—¶å€™æˆ‘ä»¬éœ€è¦å»å¯¹æ¥ä¸€äº›ç¬¬ä¸‰æ–¹çš„SDKåŒ…ï¼Œä¸€èˆ¬ç¬¬ä¸‰æ–¹ä¼šæä¾›SDKçš„ä¸‹è½½åœ°å€ï¼Œä½†æ˜¯å¾ˆå¯èƒ½æœªå‘å¸ƒè‡³ä¸­å¤®ä»“åº“ï¼Œå°±å¯¼è‡´æ— æ³•é€šè¿‡Mavenåæ ‡ç›´æ¥å¼•å…¥ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å°†SDKåŒ…ä¸‹è½½å¹¶å¤åˆ¶ç²˜è´´åˆ°é¡¹ç›®ä¸­ï¼Œå¯åœ¨${basedir}/src/main/resourcesç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªlibç›®å½•ï¼Œä¸“é—¨ç”¨æ¥å­˜æ”¾æœªå‘å¸ƒè‡³ä¸­å¤®ä»“åº“çš„JARåŒ…ã€‚å¼•å…¥æ–¹å¼å¦‚ä¸‹ï¼š 123456789101112131415&lt;dependencies&gt; &lt;!-- åœ¨è¿™é‡Œæ·»åŠ ä½ çš„ä¾èµ– --&gt; &lt;dependency&gt; &lt;!-- åº“åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ --&gt; &lt;groupId&gt;xxx-sdk-1.0&lt;/groupId&gt; &lt;!-- åº“åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ --&gt; &lt;artifactId&gt;xxx&lt;/artifactId&gt; &lt;!-- ç‰ˆæœ¬å· --&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;!-- ä½œç”¨åŸŸ --&gt; &lt;scope&gt;system&lt;/scope&gt; &lt;!-- resourceç›®å½•ä¸‹çš„libæ–‡ä»¶å¤¹ä¸‹ï¼Œæ–‡ä»¶åä¸ºï¼šxxx-sdk.jar --&gt; &lt;systemPath&gt;${basedir}\\src\\main\\resources\\lib\\xxx-sdk.jar&lt;/systemPath&gt; &lt;/dependency&gt; &lt;/dependencies&gt; å¿«ç…§ï¼ˆSNAPSHOTï¼‰åœ¨Apache Dubboå¾®æœåŠ¡é¡¹ç›®å¼€å‘ä¸­ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹éœ€è¦å»å¼•å…¥æœåŠ¡æä¾›æ–¹å¯¹å¤–æš´éœ²çš„APIæ¥å£jaråŒ…ã€‚æœåŠ¡æä¾›æ–¹å¾ˆæœ‰å¯èƒ½åœ¨çŸ­æœŸå†…å¤šæ¬¡ä¿®æ”¹å¯¹å¤–æš´éœ²çš„æ¥å£ï¼Œå¦‚æœæŒ‰ç…§æ­£å¸¸çš„ç‰ˆæœ¬å·ï¼šproducer-service.jar:1.0.0ï¼Œé‚£æ¯ä¿®æ”¹ä¸€æ¬¡æ¥å£éƒ½éœ€è¦å‡çº§ä¸€ä¸ªå°ç‰ˆæœ¬ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹ä¸å¾—ä¸å»æ›´æ–°pom.xmlæ¥å¼•ç”¨æœ€æ–°çš„jaråŒ…ã€‚å¦‚æœä¿®æ”¹æ¥å£è€Œä¸å‡çº§ç‰ˆæœ¬å·å°±å‘å¸ƒè‡³ä»“åº“ä¸­ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹åœ¨å¼•ç”¨æ—¶ä¸ä¼šå»ä»“åº“ä¸‹è½½ç›¸åŒç‰ˆæœ¬å·çš„æœ€æ–°jaråŒ…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹åªä¼šä¸‹è½½ä¸€æ¬¡æŒ‡å®šç‰ˆæœ¬å·çš„jaråŒ…ã€‚ä¸ºäº†é¿å…è¿™ç§ç¹ççš„æ›´æ–°ï¼ŒMavenæä¾›äº†å¿«ç…§ç‰ˆæœ¬ã€‚ å¿«ç…§ç‰ˆæœ¬æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç‰ˆæœ¬ï¼ŒæŒ‡å®šäº†å½“å‰çš„å¼€å‘è¿›åº¦çš„å‰¯æœ¬ã€‚ä¸åŒäºå¸¸è§„çš„ç‰ˆæœ¬ï¼ŒMavenæ¯æ¬¡æ„å»ºéƒ½ä¼šåœ¨è¿œç¨‹ä»“åº“ä¸­æ£€æŸ¥æ–°çš„å¿«ç…§ï¼ŒæœåŠ¡æä¾›æ–¹åªéœ€å‘å¸ƒåŒ…å«æœ€æ–°ä»£ç çš„å¿«ç…§ç‰ˆæœ¬ï¼ˆproducer-service.jar:1.0.0-SNAPSHOTï¼‰è‡³ä»“åº“ä¸­ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹æ¯æ¬¡éƒ½ä¼šè‡ªåŠ¨å»è·å–åŒ…å«æœ€æ–°ä»£ç çš„å¿«ç…§ï¼ˆproducer-service.jar:1.0.0-SNAPSHOTï¼‰ã€‚ ä¾èµ–ç®¡ç†Mavenè§£æjaråŒ…çš„æ–¹å¼æ˜¯ä¾èµ–ä¼ é€’ã€‚ä¾‹å¦‚æˆ‘ä»¬å¼•å…¥spring-boot-starter-webï¼Œå½“Mavenè§£æè¯¥ä¾èµ–æ—¶ï¼Œä¸ä»…ä»…ä¼šå¼•å…¥å…¶å†…éƒ¨ä¾èµ–çš„spring-webã€spring-webmvcå’Œspring-boot-starter-tomcatç­‰ï¼Œè¿˜ä¼šå¼•å…¥è¿™äº›å†…éƒ¨ä¾èµ–æ‰€ä¾èµ–çš„jaråŒ…ï¼Œä¾‹å¦‚spring-webä¾èµ–çš„spring-beanç­‰ï¼Œä¾èµ–å…³ç³»ä¸æ–­å‘ä¸‹ä¼ é€’ï¼Œç›´è‡³æ²¡æœ‰ä¾èµ–ï¼Œæœ€ç»ˆå½¢æˆäº†ä¸€é¢—ä¾èµ–æ ‘ã€‚ ä¾èµ–å†²çªçš„é—®é¢˜ä¸¾ä¸ªæ —å­ï¼šå‡è®¾æœ‰ä¾èµ–Aï¼Œå®ƒå†…éƒ¨çš„ä¾èµ–ä¼ é€’å…³ç³»ä¸ºï¼šA-&gt;B-&gt;C-&gt;D-&gt;E1ï¼›æœ‰å¦ä¸€ä¸ªä¾èµ–Fï¼Œå®ƒå†…éƒ¨çš„ä¾èµ–ä¼ é€’å…³ç³»ä¸ºï¼šF-&gt;G-&gt;E2ã€‚E1å’ŒE2ä¸ºEçš„ä¸åŒç‰ˆæœ¬ã€‚ å¦‚æœpom.xmlåŒæ—¶å¼•å…¥Aå’ŒFä¾èµ–ï¼ŒæŒ‰ç…§Mavenä¾èµ–ä¼ é€’åŸåˆ™ï¼Œå®é™…å¼•å…¥çš„ä¾èµ–å°†åŒ…æ‹¬ï¼šAã€Bã€Cã€Dã€E1ã€Fã€Gå’ŒE2ï¼Œå› æ­¤E1å’ŒE2å°†ä¼šäº§ç”ŸåŒ…å†²çªã€‚ è§£å†³ä¾èµ–å†²çªMavenè§£æpom.xmlæ—¶ï¼ŒåŒä¸€ä¸ªgroupIdå’ŒartifactIdçš„ä¾èµ–åªä¼šä¿ç•™ä¸€ä¸ªï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆé¿å…å› å¼•å…¥ä¸åŒç‰ˆæœ¬çš„ä¾èµ–æ‰€å¸¦æ¥çš„é—®é¢˜ã€‚ Mavené»˜è®¤å¤„ç†ç­–ç•¥ï¼š æœ€çŸ­è·¯å¾„ä¼˜å…ˆåŸåˆ™ï¼šå› ä¸ºä»Fåˆ°E2çš„è·¯å¾„æ¯”ä»Aåˆ°E1çš„è·¯å¾„çŸ­ï¼Œæ‰€ä»¥Mavenåœ¨é¢å¯¹E1å’ŒE2æ—¶ä¼šé€‰æ‹©E2ã€‚ æœ€å…ˆå£°æ˜ä¼˜å…ˆåŸåˆ™ï¼šä¸¾ä¸ªæ —å­ï¼šA-&gt;B-&gt;C1ï¼›D-&gt;E-&gt;C2ã€‚è¿™ä¸¤ä¸ªä¾èµ–ä¼ é€’çš„è·¯å¾„é•¿åº¦æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è°åœ¨pom.xmlå…ˆè¢«å£°æ˜å°±å¼•å…¥è°ã€‚ æ’é™¤ä¾èµ–ï¼šé»˜è®¤å¤„ç†ç­–ç•¥å·²ç»èƒ½è§£å†³åŒ…çš„ä¾èµ–é—®é¢˜ï¼Œä½†è¿˜æ˜¯ä¼šæ˜¾ç¤ºä¾èµ–å†²çªï¼Œç°è±¡å°±æ˜¯IDEAä¸­ä¼šæŠ¥çº¢ï¼›åŒæ—¶é»˜è®¤å¤„ç†å¼•å…¥çš„ä¾èµ–ç‰ˆæœ¬å·å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¼•å…¥æŒ‡å®šç‰ˆæœ¬å·çš„ä¾èµ–ï¼Œå¯ä»¥ä½¿ç”¨&lt;exclusions /&gt;å’Œ&lt;exclusion&gt;æ ‡ç­¾å…ˆæ’é™¤å†²çªçš„ä¾èµ–ï¼Œå†å¦å¤–å•ç‹¬åœ¨pom.xmlä¸­å¼•å…¥æŒ‡å®šç‰ˆæœ¬å·çš„ä¾èµ–ã€‚ æ£€æµ‹åŒ…å†²çªçš„Mavenå‘½ä»¤å¦‚ä¸‹ï¼š mvn dependency:help mvn dependency:analyze mvn dependency:tree mvn dependency:tree -Dverbose æœ€ä½³å®è·µå½“å¼€å‘å¤šæ¨¡å—é¡¹ç›®æ—¶ï¼Œåœ¨æœ€å¤–å±‚çš„çˆ¶pom.xmlä¸­ä½¿ç”¨dependencyManagementæ ‡ç­¾è¿›è¡Œä¾èµ–åŠç‰ˆæœ¬å·çš„é¢„å®šä¹‰ï¼Œä¾¿äºç»Ÿä¸€ç®¡ç†é¡¹ç›®ä¾èµ–åŠç‰ˆæœ¬å·ã€‚åœ¨å­æ¨¡å—å¼•å…¥ä¾èµ–æ—¶ï¼Œåªéœ€æŒ‡å®šgroupIdå’ŒartifactIdå³å¯å¼•å…¥å¯¹åº”ä¾èµ–ã€‚ å‚è€ƒ èœé¸Ÿæ•™ç¨‹ - Mavenæ•™ç¨‹","link":"/2020/12/11/javaee/maven/maven-must-know-and-know/"},{"title":"LeetCodeé¢˜è§£-ç¬¬7é¢˜ï¼šæ•´æ•°åè½¬","text":"é¢˜ç›®ï¼šç»™å‡ºä¸€ä¸ª 32 ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œä½ éœ€è¦å°†è¿™ä¸ªæ•´æ•°ä¸­æ¯ä½ä¸Šçš„æ•°å­—è¿›è¡Œåè½¬ã€‚ ç¤ºä¾‹ 1:è¾“å…¥: 123è¾“å‡º: 321 ç¤ºä¾‹ 2:è¾“å…¥: -123è¾“å‡º: -321 ç¤ºä¾‹ 3:è¾“å…¥: 120è¾“å‡º: 21 æ³¨æ„:å‡è®¾æˆ‘ä»¬çš„ç¯å¢ƒåªèƒ½å­˜å‚¨å¾—ä¸‹ 32 ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œåˆ™å…¶æ•°å€¼èŒƒå›´ä¸º [âˆ’2^31,2^31 âˆ’ 1]ã€‚è¯·æ ¹æ®è¿™ä¸ªå‡è®¾ï¼Œå¦‚æœåè½¬åæ•´æ•°æº¢å‡ºé‚£ä¹ˆå°±è¿”å› 0ã€‚ æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/reverse-integerè‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ æ€è·¯ï¼š é¦–å…ˆæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ™®é€šçš„æ­£æ•´æ•°å¦‚ä½•è¿›è¡Œåè½¬ã€‚ ä¾‹å¦‚ 1234ã€‚ æœ€ç›´æ¥æš´åŠ›çš„ï¼šå­—ç¬¦ä¸²å¼‚å¸¸æ³•ã€‚å…ˆå°†å…¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åå¯¹å­—ç¬¦ä¸²éå†ï¼Œåˆ©ç”¨æ ˆç»“æ„è¿›è¡Œåè½¬ï¼Œåè½¬ä¹‹åçš„å­—ç¬¦ä¸²ç±»å‹å¼ºåˆ¶è½¬æ¢æˆæ•´æ•°ï¼ŒæŠ›å‡ºå¼‚å¸¸åˆ™æº¢å‡ºã€‚è¿™æ ·å¯ä»¥å¤„ç†1234è¿™æ ·çš„æ­£æ•´æ•°ã€‚ä½†æ˜¯é‡åˆ°è´Ÿæ•°å°±è¡Œä¸é€šäº†ã€‚ æˆ‘ä»¬å¾—è€ƒè™‘å¦‚ä½•å¯¹è´Ÿæ•°è¿›è¡Œåè½¬ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å…ˆåˆ¤æ–­è¾“å…¥æ•°çš„æ­£è´Ÿæ€§ï¼Œç„¶åè®°ä¸€ä¸ªæ ‡è®°ï¼ŒåŒæ ·çš„æ–¹å¼åè½¬å®Œæˆåï¼Œå¦‚æœæ˜¯è´Ÿæ•°ï¼Œåˆ™æ‹¼æ¥ä¸Šè´Ÿå·-å†è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³äº†ã€‚ æ¥çœ‹ä¸‹è¿™ç§â€œæš´åŠ›å­—ç¬¦ä¸²å¼‚å¸¸æ³•â€çš„ä»£ç å®ç°ï¼š 123456789101112131415161718192021222324252627282930public static int convertStringToReverse(int x) { // æ˜¯å¦å°äº0 boolean flag = x &lt; 0; // å–ç»å¯¹å€¼è½¬å­—ç¬¦ä¸² String s = String.valueOf(Math.abs(x)); // è½¬æ¢æˆcharæ•°ç»„è¿›è¡Œéå† char[] chars = s.toCharArray(); // å£°æ˜æ ˆ Deque&lt;Character&gt; stack = new LinkedList&lt;&gt;(); // å…¥æ ˆ for (char aChar : chars) { stack.push(aChar); } StringBuilder res = new StringBuilder(); if (flag) { // xå€¼å°äº0ï¼Œå‰é¢æ‹¼æ¥ä¸Šè´Ÿå· res.append(&quot;-&quot;); } // å‡ºæ ˆ while (!stack.isEmpty()) { res.append(stack.pop()); } try { // å¼ºåˆ¶ç±»å‹è½¬æ¢ return Integer.parseInt(res.toString()); } catch (Exception e) { // å¼‚å¸¸è¡¨ç¤ºæº¢å‡º return 0; }} è¿™ç§åšæ³•ï¼Œå…¥æ ˆéå†çš„æ—¶é—´å¤æ‚åº¦O(n)ï¼Œæ ˆç»“æ„çš„ç©ºé—´å¤æ‚åº¦O(n)ï¼Œå‡ºæ ˆéå†çš„æ—¶é—´å¤æ‚åº¦O(n)ã€‚æ•´ä½“çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œç©ºé—´å¤æ‚åº¦O(n)ã€‚ æ˜¾ç„¶ï¼Œè¿™ç§è§£æ³•å¹¶ä¸æ˜¯æœ€ä¼˜è§£ã€‚ ä¸åšç±»å‹è½¬æ¢ï¼Œåªæ“ä½œæ•´æ•°è¿›è¡Œåè½¬ã€‚å¦‚ä½•æ“ä½œï¼Ÿå…¶å®å¯ä»¥å¥—ç”¨ç”Ÿäº§è€…æ¶ˆè´¹è€…çš„æ€æƒ³ã€‚ å¯¹äºè¾“å…¥æ•´æ•°xï¼š ç”Ÿäº§è€…é€»è¾‘ï¼š è·å–æ•´æ•°çš„ä¸ªä½æ•°å­—ï¼šn = x % 10ã€‚ æ¶ˆè´¹è€…é€»è¾‘ï¼š æ•´ä¸ªè¿‡ç¨‹å¼€å§‹ä¹‹å‰ï¼Œåè½¬ç»“æœresçš„åˆå§‹å€¼ç­‰äº0ã€‚ å°†ç”Ÿäº§è€…äº§å‡ºçš„ä¸ªä½æ•°åŠ åˆ°resåé¢ï¼šres = res * 10 + nã€‚ å°†è¾“å…¥æ•´æ•°çš„ä¸ªä½æ•°å»é™¤ï¼šx /= 10ã€‚ å½“æ¶ˆè´¹åˆ°x = 0æ—¶ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸï¼Œæœ€ç»ˆçš„reså³ä¸ºåè½¬ç»“æœã€‚ çœ‹ä¼¼å®Œç¾ï¼Œä½†é¢˜æ„ä¸­è¯´åˆ°äº†æ•´æ•°æº¢å‡ºã€‚åè½¬ä¹‹åçš„èŒƒå›´ä¸ºï¼š[-2^31,2^31 - 1]ï¼Œæˆ‘ä»¬éœ€è¦å»è€ƒè™‘æº¢å‡ºçš„è¾¹ç•Œã€‚ åè½¬ç»“æœresæ¯æ¬¡æ¶ˆè´¹éƒ½ä¼šå¢å¤§ä¸€ä¸ªæ•°é‡çº§ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é™åˆ¶çš„æ•°å€¼èŒƒå›´ï¼š[-2147483648,2147483647] å¯¹äºåè½¬ç»“æœresï¼š é¦–å…ˆåˆ†ææ­£æ•°åŒºé—´ï¼Œè€ƒè™‘å€’æ•°ç¬¬äºŒä½ï¼Œå¦‚æœæœ¬æ¬¡æ¶ˆè´¹å‰res &gt; 214748364ï¼ˆå³å»æ‰æ­£åŒºé—´æœ€å¤§å€¼çš„æœ€åä¸€ä½ï¼‰ï¼Œæ— è®ºæ­¤æ¬¡æ¶ˆè´¹åˆ°çš„ä¸ªä½æ•°nä¸ºå¤šå°‘éƒ½æº¢å‡ºäº†ï¼›å¦ä¸€ç§æƒ…å†µï¼Œè€ƒè™‘æœ€åä¸€ä½ï¼Œå¦‚æœæœ¬æ¬¡æ¶ˆè´¹å‰res = 214748364ï¼Œé‚£æœ¬æ¬¡æ¶ˆè´¹æ—¶nå€¼åªè¦å¤§äº7ï¼Œå°±æº¢å‡ºäº†ã€‚ å†æ¥çœ‹è´Ÿæ•°åŒºé—´ï¼ŒåŒæ ·è€ƒè™‘å€’æ•°ç¬¬äºŒä½ï¼Œå¦‚æœæœ¬æ¬¡æ¶ˆè´¹å‰res &lt; -214748364æˆç«‹ï¼Œæ— è®ºæ­¤æ¬¡æ¶ˆè´¹åˆ°çš„ä¸ªä½æ•°nä¸ºå¤šå°‘éƒ½æº¢å‡ºäº†ï¼›å¦ä¸€ç§æƒ…å†µï¼Œè€ƒè™‘æœ€åä¸€ä½ï¼Œå¦‚æœæœ¬æ¬¡æ¶ˆè´¹å‰res = -214748364ï¼Œé‚£æœ¬æ¬¡æ¶ˆè´¹æ—¶nå€¼åªè¦å°äº-8ï¼Œå°±æº¢å‡ºäº†ã€‚ ä»£ç å®ç°å¦‚ä¸‹ï¼š 1234567891011121314151617public static int reverse(int n) { // åè½¬ç»“æœåˆå§‹å€¼ int res = 0; while (n != 0) { // ç”Ÿäº§ï¼šè·å–ä¸ªä½æ•° int x = n % 10; // æº¢å‡ºè¾¹ç•Œ if ((res &gt; Integer.MAX_VALUE / 10 || (res == Integer.MAX_VALUE / 10 &amp;&amp; x &gt; Integer.MAX_VALUE % 10)) || (res &lt; Integer.MIN_VALUE / 10 || (res == Integer.MIN_VALUE / 10 &amp;&amp; x &lt; Integer.MIN_VALUE % 10))) { return 0; } // æ¶ˆè´¹ï¼šåŠ åˆ°åè½¬ç»“æœåé¢ res = res * 10 + x; n /= 10; } return res;}","link":"/2020/12/04/algorithm/leetcode/easy/7/"},{"title":"é¢è¯•å¿…é—®HashMap","text":"æ— è®ºæ˜¯å°å‚è¿˜æ˜¯å¤§å‚é¢è¯•ï¼ŒHashMapçš„å‡ºåœºç‡ä¸€ç›´å±…é«˜ä¸ä¸‹ã€‚ä½œä¸ºJavaè¯­è¨€ä¸­Mapæ•°æ®ç»“æ„çš„ç»å…¸å®ç°ï¼Œå¯¹å…¶å†…éƒ¨åŸç†çš„æŒæ¡å’Œç†è§£ç¨‹åº¦åœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½åæ˜ å‡ºä¸€ä¸ªå¼€å‘äººå‘˜çš„æ°´å¹³ä¸å®åŠ›ã€‚ ä¸‹é¢æˆ‘ä»¬æä¾›å‡ºä¸€äº›å¸¸è§é¢è¯•é—®æ³•ä»¥åŠå¯¹åº”çš„å®˜æ–¹å›ç­”ï¼ˆå»ºè®®ç†Ÿè¯»å¹¶èƒŒè¯µï¼‰ï¼š HashMapåº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸJDK7å’ŒJDK8çš„å®ç°æœ‰ä½•åŒºåˆ«ï¼Ÿ ç­”ï¼šHashMapåº•å±‚å­˜å‚¨å…ƒç´ çš„æ•°æ®ç»“æ„æ˜¯æ•°ç»„ã€‚åœ¨å­˜å‚¨å…ƒç´ æ—¶å¦‚æœå‘ç”Ÿäº†å“ˆå¸Œå†²çªï¼ŒJDK7ä½¿ç”¨â€œé“¾åœ°å€æ³•â€ï¼ˆä¿—ç§°â€œæ‹‰é“¾æ³•â€ï¼‰æ¥è§£å†³ï¼Œé‡‡ç”¨â€œå¤´æ’æ³•â€è¿›è¡Œå…ƒç´ æ’å…¥ã€‚åœ¨JDK8ä¸­ï¼Œå½“å“ˆå¸Œå†²çªä¸æ˜¯å¾ˆä¸¥é‡æ—¶ï¼Œä»ç„¶ä½¿ç”¨â€œé“¾åœ°å€æ³•â€è§£å†³ï¼Œä½†é‡‡ç”¨çš„æ˜¯â€œå°¾æ’æ³•â€ï¼›è€Œå½“å“ˆå¸Œå†²çªç‰¹åˆ«ä¸¥é‡ï¼Œå³é“¾è¡¨çš„é•¿åº¦å¤§äº8å¹¶ä¸”æ•°ç»„çš„å®¹é‡å¤§äº64æ—¶ï¼Œä¼šå°†é“¾è¡¨ç»“æ„è½¬åŒ–æˆçº¢é»‘æ ‘ç»“æ„ç”¨ä»¥è§£å†³é“¾è¡¨è¿‡é•¿å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚ åŠ è½½å› å­loadFactorä¸ºä»€ä¹ˆæ˜¯0.75ï¼Ÿ ç­”ï¼šè¿™æ˜¯ä¸€ä¸ªåŸºäºå®¹é‡å’Œæ€§èƒ½è€ƒè™‘çš„æŠ˜è¡·å€¼ã€‚å¦‚æœåŠ è½½å› å­è®¾ç½®è¿‡å¤§ï¼Œå¸¦æ¥çš„å¥½å¤„æ˜¯æ‰©å®¹çš„é—¨æ§›æé«˜ï¼ŒèŠ‚çº¦äº†å†…å­˜ç©ºé—´ï¼Œä½†å‡ºç°å“ˆå¸Œå†²çªçš„å‡ ç‡ä¼šå˜å¤§ï¼Œä»è€Œå¯¼è‡´å¯¹å…ƒç´ çš„æ“ä½œæ€§èƒ½ä¸‹é™ï¼›å¦‚æœåŠ è½½å› å­è®¾ç½®è¿‡å°ï¼Œå¸¦æ¥çš„å¥½å¤„æ˜¯æ‰©å®¹é—¨æ§›é™ä½ï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„å…ƒç´ ä¼šæ¯”è¾ƒç¨€ç–ï¼Œä¸æ˜“å‡ºç°å“ˆå¸Œå†²çªï¼Œå¯¹å…ƒç´ çš„æ“ä½œæ€§èƒ½è¾ƒé«˜ã€‚ä½†ä¼šå­˜åœ¨ä¸€å®šçš„ç©ºé—´æµªè´¹ã€‚äºæ˜¯æŠ˜è¡·è€ƒè™‘é€‰æ‹©äº†0.75ã€‚ ä»€ä¹ˆæ—¶æœºä¼šè§¦å‘æ‰©å®¹ï¼ŸJDK8åœ¨æ‰©å®¹æ—¶åšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿ ç­”ï¼šå½“å­˜å‚¨å…ƒç´ æ•°é‡å¤§äºç­‰äºé˜ˆå€¼æ—¶è§¦å‘æ‰©å®¹ã€‚JDK7åœ¨æ‰©å®¹æ—¶ä¼šå¯¹æ‰€æœ‰å…ƒç´ è¿›è¡Œrehashé‡æ–°å“ˆå¸Œè®¡ç®—æ•°ç»„ä¸‹æ ‡ï¼›è€ŒJDK8åœ¨æ‰©å®¹æ—¶é€šè¿‡é«˜ä½è¿ç®—ï¼ˆå“ˆå¸Œç  &amp; æ—§å®¹é‡ï¼‰æ¥åˆ¤æ–­å…ƒç´ æ˜¯å¦éœ€è¦ç§»åŠ¨ï¼Œå¦‚æœé«˜ä½è¿ç®—ç»“æœé«˜ä¸€ä½ä¸º0ï¼Œé‚£ä¹ˆæ‰©å®¹åè¯¥å…ƒç´ çš„ä½ç½®ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœé«˜ä½è¿ç®—ç»“æœé«˜ä¸€ä½ä¸º1ï¼Œé‚£ä¹ˆæ‰©å®¹åè¯¥å…ƒç´ çš„ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼Œæ–°çš„æ•°ç»„ä¸‹æ ‡ä½ç½®ä¸ºåŸä¸‹æ ‡ä½ç½®åŠ ä¸ŠåŸæ•°ç»„é•¿åº¦ã€‚ æè¿°æ’å…¥ä¸€ä¸ªå…ƒç´ çš„å®Œæ•´è¿‡ç¨‹ã€‚ ç­”ï¼šé¦–å…ˆåˆ¤æ–­å“ˆå¸Œè¡¨æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºåˆ™è¡¨ç¤ºç¬¬ä¸€æ¬¡æ’å…¥ï¼Œè¿›è¡Œæ‰©å®¹ï¼›å¦åˆ™æ ¹æ®é”®è®¡ç®—å‡ºæ•°ç»„ä¸‹æ ‡ï¼Œç„¶ååˆ¤æ–­è¯¥ä¸‹æ ‡ä½ç½®çš„å…ƒç´ æ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼›å¦åˆ™åˆ¤æ–­é”®æ˜¯å¦ç›¸ç­‰ï¼ˆå…ˆæ¯”è¾ƒhashCodeï¼Œå“ˆå¸Œç ä¸ç›¸ç­‰å†è¿›è¡Œequalsæ¯”è¾ƒï¼‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™ç›´æ¥è¦†ç›–å€¼ï¼›å¦åˆ™åˆ¤æ–­æ˜¯çº¢é»‘æ ‘è¿˜æ˜¯é“¾è¡¨ï¼Œåˆ†åˆ«æ‰§è¡Œå¯¹åº”æ•°æ®ç»“æ„çš„æ’å…¥é€»è¾‘ã€‚å…¶ä¸­é“¾è¡¨æ•°æ®ç»“æ„åœ¨JDK7ä¸­ä½¿ç”¨å¤´æ’æ³•è¿›è¡Œæ’å…¥ï¼Œåœ¨JDK8ä¸­ä½¿ç”¨å°¾æ’æ³•ã€‚è€Œçº¢é»‘æ ‘åœ¨JDK8æ‰å¼•å…¥ï¼Œå¦‚æœå·²ç»æ˜¯çº¢é»‘æ ‘äº†ï¼Œåˆ™æ‰§è¡Œçº¢é»‘æ ‘çš„æ’å…¥é€»è¾‘ï¼Œå¦‚æœæ˜¯é“¾è¡¨ï¼Œåœ¨ä½¿ç”¨å°¾æ’æ³•éå†èŠ‚ç‚¹æ—¶å¦‚æœå‘ç°é“¾è¡¨é•¿åº¦å¤§äº8äº†ä¸”æ•°ç»„å®¹é‡å°äº64æ—¶ï¼Œå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘ååœ¨æ‰§è¡Œæ’å…¥ï¼Œå¦åˆ™æ‰§è¡Œé“¾è¡¨çš„å°¾éƒ¨æ’å…¥ã€‚å…ƒç´ æ’å…¥å®Œæˆåï¼Œåˆ¤æ–­å“ˆå¸Œè¡¨å®¹é‡æ˜¯å¦è¶…è¿‡é˜ˆå€¼ï¼Œè¶…è¿‡åˆ™è¿›è¡Œæ‰©å®¹ã€‚ HashMapçš„çº¿ç¨‹ä¸å®‰å…¨ä½“ç°åœ¨å“ªï¼Ÿå¦‚ä½•å»åº”å¯¹ï¼Ÿ ç­”ï¼šåœ¨å¤šçº¿ç¨‹æ¡ä»¶ä¸‹ï¼ŒJDK7çš„HashMapåœ¨æ‰©å®¹æ—¶ä¼šå‡ºç°æ­»å¾ªç¯çš„é—®é¢˜ï¼ŒJDK8çš„HashMapåœ¨æ’å…¥æ—¶ä¼šå‡ºç°å€¼è¢«è¦†ç›–çš„é—®é¢˜ã€‚åº”å¯¹è¿™ç§çº¿ç¨‹ä¸å®‰å…¨ï¼Œå¯ä»¥ä½¿ç”¨åŒæ­¥å®¹å™¨HashTableæˆ–å¹¶å‘å®¹å™¨ConcurrentHashMapã€‚æ¨èä½¿ç”¨ConcurrentHashMapã€‚ ä»¥ä¸Šé¢è¯•é¢˜åŠç­”æ¡ˆåŸºæœ¬å¯ä»¥åº”å¯¹é‚£äº›æ™®é€šå…¬å¸çš„ä¸€é—®ä¸€ç­”å¼çš„é¢è¯•äº†ï¼ŒèƒŒè¯µå°±å®Œäº‹äº†ã€‚ ä½†æœ‰äº›é¢è¯•å®˜å¯èƒ½ä¼šè¿½ç€å…¶ä¸­æŸä¸ªç‚¹ä¸€ç›´å¾€ä¸‹ç»†é—®ï¼Œè¿™ä¸ªæ—¶å€™å…‰é ä¸Šé¢èƒŒè¯µçš„è¿™ç‚¹ä¸œè¥¿å°±æœ‰ç‚¹åŠ›ä¸ä»å¿ƒäº†ï¼Œä½ å¿…é¡»å¯¹æ•´ä¸ªHashMapçš„åŸç†çœŸæ­£çš„æœ‰ä¸€å®šäº†è§£æ‰èƒ½å¤Ÿä»å®¹å»åº”å¯¹ã€‚ ä¸‹é¢æˆ‘ä»¬é’ˆå¯¹ä¸Šé¢çš„é¢è¯•é¢˜ï¼Œé˜…è¯»JDK8çš„HashMapæºç ï¼ŒçœŸæ­£çš„å»ææ‡‚åŸç†ã€‚ å¦‚ä½•å­˜å‚¨å…ƒç´ ï¼Ÿ1transient Node&lt;K,V&gt;[] table; å…ƒç´ éƒ½å­˜å‚¨åœ¨è¿™ä¸ªNodeæ•°ç»„é‡Œé¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹Nodeç±»ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748/** * Basic hash bin node, used for most entries. (See below for * TreeNode subclass, and in LinkedHashMap for its Entry subclass.) */static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; { // hashå€¼ final int hash; // é”® final K key; // å€¼ V value; // ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ Node&lt;K,V&gt; next; Node(int hash, K key, V value, Node&lt;K,V&gt; next) { this.hash = hash; this.key = key; this.value = value; this.next = next; } // getter/setter/toString/equals/hashCode public final K getKey() { return key; } public final V getValue() { return value; } public final String toString() { return key + &quot;=&quot; + value; } public final int hashCode() { return Objects.hashCode(key) ^ Objects.hashCode(value); } public final V setValue(V newValue) { V oldValue = value; value = newValue; return oldValue; } public final boolean equals(Object o) { if (o == this) return true; if (o instanceof Map.Entry) { Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o; if (Objects.equals(key, e.getKey()) &amp;&amp; Objects.equals(value, e.getValue())) return true; } return false; }} å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªå•é“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå°±æ˜¯è¯´tableæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„NodeèŠ‚ç‚¹ï¼Œè€Œè¿™æ¯ä¸€ä¸ªNodeèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œå½“æ²¡æœ‰å‘ç”Ÿå“ˆå¸Œå†²çªæ—¶ï¼Œé“¾è¡¨é•¿åº¦ä¸º1ã€‚ é™æ€å˜é‡ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€äº›ä¸»è¦çš„é™æ€å˜é‡ï¼š 1234567891011121314151617// é»˜è®¤çš„åˆå§‹å®¹é‡-å¿…é¡»ä¸º2çš„æ•´æ•°å¹‚static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16// æœ€å¤§å®¹é‡static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;// é»˜è®¤åŠ è½½å› å­static final float DEFAULT_LOAD_FACTOR = 0.75f;// ä»é“¾è¡¨è½¬åŒ–æˆçº¢é»‘æ ‘çš„é˜€å€¼static final int TREEIFY_THRESHOLD = 8;// ä»çº¢é»‘æ ‘é€€åŒ–æˆé“¾è¡¨çš„é˜€å€¼static final int UNTREEIFY_THRESHOLD = 6;// è¦æ‰§è¡Œçº¢é»‘æ ‘åŒ–çš„æœ€å°æ•°ç»„å®¹é‡static final int MIN_TREEIFY_CAPACITY = 64; æœ‰å…³åŠ è½½å› å­loadFactorä¸ºä»€ä¹ˆæ˜¯0.75ï¼Ÿè¿˜è®°å¾—æ–‡ç« å¼€å¤´çš„è§£ç­”å—ï¼Ÿè¿™æ˜¯ä¸€ä¸ªåŸºäºå®¹é‡å’Œæ€§èƒ½è€ƒè™‘çš„æŠ˜è¡·å€¼ã€‚å¦‚æœåŠ è½½å› å­è®¾ç½®è¿‡å¤§ï¼Œå¸¦æ¥çš„å¥½å¤„æ˜¯æ‰©å®¹çš„é—¨æ§›æé«˜ï¼ŒèŠ‚çº¦äº†å†…å­˜ç©ºé—´ï¼Œä½†å‡ºç°å“ˆå¸Œå†²çªçš„å‡ ç‡ä¼šå˜å¤§ï¼Œä»è€Œå¯¼è‡´å¯¹å…ƒç´ çš„æ“ä½œæ€§èƒ½ä¸‹é™ï¼›å¦‚æœåŠ è½½å› å­è®¾ç½®è¿‡å°ï¼Œå¸¦æ¥çš„å¥½å¤„æ˜¯æ‰©å®¹é—¨æ§›é™ä½ï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„å…ƒç´ ä¼šæ¯”è¾ƒç¨€ç–ï¼Œä¸æ˜“å‡ºç°å“ˆå¸Œå†²çªï¼Œå¯¹å…ƒç´ çš„æ“ä½œæ€§èƒ½è¾ƒé«˜ã€‚ä½†ä¼šå­˜åœ¨ä¸€å®šçš„ç©ºé—´æµªè´¹ã€‚äºæ˜¯æŠ˜è¡·è€ƒè™‘é€‰æ‹©äº†0.75ã€‚ å…¶å®è¿™ä¸ªç­”æ¡ˆå·²ç»å¾ˆèƒ½è¯´æ˜åŸå› äº†ï¼Œä½†æœ‰äº›é¢è¯•å®˜å°±æ˜¯çº ç»“è¿™ä¸ªæ•°å€¼ä¸ºä»€ä¹ˆæ˜¯0.75ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯0.74æˆ–è€…0.76ç­‰ã€‚ä¸‹é¢æˆ‘ä»¬å°è¯•ç”¨ä¸€ç§å…«è‚¡æ–‡æ¥å¯¹æŠ—é¢è¯•å®˜ï¼š ä¸ºä»€ä¹ˆåŠ è½½å› å­æ˜¯0.75å‘¢ï¼Ÿ ç†è®ºï¼šé€šè¿‡é¢„æµ‹å­˜å‚¨æ¡¶æ˜¯å¦ä¸ºç©ºï¼Œå¯ä»¥é¿å…é“¾æ¥å¹¶åˆ©ç”¨åˆ†æ”¯é¢„æµ‹ã€‚å¦‚æœå­˜å‚¨æ¡¶ä¸ºç©ºçš„å¯èƒ½æ€§è¶…è¿‡0.5ï¼Œåˆ™è¯¥å­˜å‚¨æ¡¶å¯èƒ½ä¸ºç©ºã€‚ è¯æ˜ï¼šsä»£è¡¨å¤§å°ï¼Œnä»£è¡¨å¢åŠ çš„é”®æ•°ã€‚æ ¹æ®ç‰›é¡¿äºŒé¡¹å¼å®šç†ï¼Œå­˜å‚¨æ¡¶ä¸ºç©ºçš„æ¦‚ç‡ä¸ºï¼š P(0) = C(n, 0) * (1/s)^0 * (1 - 1/s)^(n - 0) å› æ­¤ï¼Œå¦‚æœå°‘äºlog(2)/log(s/(s - 1))ä¸ªé”®ï¼Œå½“sè¾¾åˆ°æ— ç©·å¤§æ—¶å¹¶ä¸”å¦‚æœæ·»åŠ çš„é”®æ•°ä½¿å¾—P(0) = 0.5æ—¶ï¼Œåˆ™n/sè¿…é€Ÿæ¥è¿‘log(2)ã€‚ log(2)çº¦ç­‰äº0.693ã€‚ ç»“è®ºï¼šlog(2)ä¸æ˜¯çº¦ç­‰äº0.693å—ï¼Ÿä¸ºä»€ä¹ˆä¼šé€‰æ‹©0.75å‘¢ï¼Ÿå› ä¸ºé˜€å€¼éœ€è¦ä¸€ä¸ªæ•´æ•°ï¼Œé»˜è®¤åˆå§‹å®¹é‡æ˜¯16ï¼Œå½“åŠ è½½å› å­ç­‰äº0.75æ—¶ä¹˜ç§¯æ‰ä¸ºæ•´æ•°ã€‚0.70/0.71/0.72/0.73/0.74...ç­‰ç­‰ï¼Œåªæœ‰0.75çš„ä¹˜ç§¯æ‰æ˜¯æ•´æ•°ã€‚ ä»¥ä¸Šç†è®ºåŠè¯æ˜è¿‡ç¨‹æ¥è‡ª stackoverflow.com æ‰€ä»¥é—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆé»˜è®¤åˆå§‹å®¹é‡æ˜¯16å‘¢ï¼Ÿè¿™â€¦ï¼Œå»ºè®®å‡†å¤‡é¢ä¸‹ä¸€å®¶å…¬å¸äº†â€¦ æˆå‘˜å˜é‡é™¤äº†å­˜å‚¨å…ƒç´ çš„tableæ•°ç»„ï¼Œè¿˜æœ‰ä»¥ä¸‹å…¶å®ƒæˆå‘˜å˜é‡ï¼š 1234567891011121314// Setç¼“å­˜ï¼Œå¯ç”¨äºè¿­ä»£å™¨transient Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;// mapå…ƒç´ ä¸ªæ•°transient int size;// mapä¿®æ”¹æ¬¡æ•°ï¼Œç”¨æ¥å®ç°fail-fastæœºåˆ¶transient int modCount;// é˜€å€¼ï¼Œå½“size&gt;thresholdæ—¶ä¼šè§¦å‘æ‰©å®¹int threshold;// åŠ è½½å› å­final float loadFactor; å¦‚ä½•æ„é€ HashMapå¯¹è±¡ï¼Ÿä¸€å…±æœ‰å››ä¸ªæ„é€ å™¨ï¼Œä½†æˆ‘ä»¬å¸¸ç”¨çš„åªæœ‰ä¸¤ä¸ªï¼šæ— å‚æ„é€ å™¨å’ŒæŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å™¨ã€‚ 1234567891011121314/** * æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å™¨ï¼Œå†…éƒ¨è°ƒç”¨å¸¦ä¸¤ä¸ªå‚æ•°çš„æ„é€ å™¨ï¼Œä¼ å…¥é»˜è®¤åŠ è½½å› å­DEFAULT_LOAD_FACTOR=0.75f */public HashMap(int initialCapacity) { this(initialCapacity, DEFAULT_LOAD_FACTOR);}/** * æ— å‚æ„é€ å™¨ï¼Œä½¿ç”¨é»˜è®¤çš„åˆå§‹å®¹é‡ï¼š16ï¼Œé»˜è®¤çš„åŠ è½½å› å­ï¼š0.75f */public HashMap() { this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted} ä¸€èˆ¬åœ¨å¼€å‘æ—¶ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æå‰é¢„ä¼°å‡ºæ•°æ®é‡ï¼Œå»ºè®®è°ƒç”¨æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å™¨æ¥åˆ›å»ºä¸€ä¸ªåˆé€‚å®¹é‡çš„HashMapï¼›å¦‚æœæ— æ³•é¢„ä¼°ï¼Œæœ€å¥½ä½¿ç”¨æ— å‚æ„é€ å™¨ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹æŒ‡å®šåˆå§‹å®¹é‡å’ŒæŒ‡å®šåŠ è½½å› å­çš„æ„é€ å™¨ï¼š 1234567891011121314151617public HashMap(int initialCapacity, float loadFactor) { // å®¹é‡è´Ÿå€¼æ ¡éªŒ if (initialCapacity &lt; 0) throw new IllegalArgumentException(&quot;Illegal initial capacity: &quot; + initialCapacity); // å®¹é‡æœ€å¤§å€¼æ ¡éªŒ if (initialCapacity &gt; MAXIMUM_CAPACITY) initialCapacity = MAXIMUM_CAPACITY; // åŠ è½½å› å­åˆæ³•æ€§æ ¡éªŒ if (loadFactor &lt;= 0 || Float.isNaN(loadFactor)) throw new IllegalArgumentException(&quot;Illegal load factor: &quot; + loadFactor); // èµ‹å€¼ this.loadFactor = loadFactor; // åˆå§‹åŒ–é˜€å€¼ä¸ºåˆè¯†å®¹é‡ï¼ˆæ­¤å¤„åªæ˜¯è¿›è¡Œé¢„åˆå§‹åŒ–ï¼Œåç»­è°ƒç”¨resizeæ–¹æ³•æ—¶ä¼šè¿›è¡Œå‡†ç¡®èµ‹å€¼ï¼‰ this.threshold = tableSizeFor(initialCapacity);} åˆå§‹åŒ–èµ‹å€¼çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šå°†é˜€å€¼thresholdè®¾ç½®ä¸ºinitialCapacity * loadFactorï¼Œè€Œæ˜¯é¢„åˆå§‹åŒ–æˆåˆå§‹å®¹é‡ï¼Œæ­¤å¤„ä¼šè°ƒç”¨tableSizeForæ–¹æ³•å¾—åˆ°ä¸€ä¸ªå¤§äºç­‰äºinitialCapacityä¸”æœ€è¿‘çš„2çš„æ•´æ•°æ¬¡å¹‚çš„æ•°ï¼Œç„¶åèµ‹å€¼ç»™thresholdï¼Œåç»­ç¬¬ä¸€æ¬¡è°ƒç”¨putæ–¹æ³•è¿›è¡Œæ’å…¥æ—¶ä¼šè¿›è¡Œé¦–æ¬¡æ‰©å®¹ï¼Œè°ƒç”¨resizeæ–¹æ³•å¯¹thresholdè¿›è¡Œå‡†ç¡®èµ‹å€¼ã€‚ tableSizeForæ–¹æ³•åŸç†tableSizeForæ–¹æ³•æ˜¯å¾—åˆ°ä¸€ä¸ªå¤§äºç­‰äºinitialCapacityä¸”æœ€è¿‘çš„2çš„æ•´æ•°æ¬¡å¹‚çš„æ•°ã€‚æˆ‘ä»¬æ¥çœ‹JDK8æ˜¯å¦‚ä½•è¿›è¡Œå·§å¦™å®ç°çš„ï¼š 123456789static final int tableSizeFor(int cap) { int n = cap - 1; n |= n &gt;&gt;&gt; 1; n |= n &gt;&gt;&gt; 2; n |= n &gt;&gt;&gt; 4; n |= n &gt;&gt;&gt; 8; n |= n &gt;&gt;&gt; 16; return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;} é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ä½è¿ç®—ç¬¦å·&gt;&gt;&gt;è¡¨ç¤ºæ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥0è¡¥é½ã€‚ å‡è®¾cap = 10ï¼Œé‚£ä¹ˆn = 9ã€‚ æ‰§è¡Œn != n &gt;&gt;&gt; 1å³n = 9 | (9 &gt;&gt;&gt; 1)çš„æ­¥éª¤æ˜¯ï¼š 9çš„äºŒè¿›åˆ¶æ˜¯1001ï¼› 9 &gt;&gt;&gt; 1å³ï¼š1001 &gt;&gt;&gt; 1 = 0100ï¼› 9 | (9 &gt;&gt;&gt; 1) = 1001 | 0100 = 1101ã€‚ æ¥ä¸‹æ¥ä¾æ¬¡æ‰§è¡Œï¼š 1234n |= n &gt;&gt;&gt; 2;n |= n &gt;&gt;&gt; 4;n |= n &gt;&gt;&gt; 8;n |= n &gt;&gt;&gt; 16; è¿‡ç¨‹åˆ†åˆ«ä¸ºï¼š n |= n &gt;&gt;&gt; 2;ï¼Œæ­¤æ—¶n = 1101ï¼Œå³ï¼šn = 1101 | (1101 &gt;&gt;&gt; 2) = 1101 | 0011 = 1111ï¼› n |= n &gt;&gt;&gt; 4;ï¼Œæ­¤æ—¶n = 1111ï¼Œå³ï¼šn = 1111 | (1111 &gt;&gt;&gt; 4) = 1111 | 0000 = 1111ï¼› n |= n &gt;&gt;&gt; 8;ï¼Œæ­¤æ—¶n = 1111ï¼Œå³ï¼šn = 1111 | (1111 &gt;&gt;&gt; 8) = 1111 | 0000 = 1111ï¼› n |= n &gt;&gt;&gt; 16;ï¼Œæ­¤æ—¶n = 1111ï¼Œå³ï¼šn = 1111 | (1111 &gt;&gt;&gt; 16) = 1111 | 0000 = 1111ï¼› æœ€åçš„ç»“æœä¸ºï¼šn = 1111ï¼Œè½¬æ¢æˆåè¿›åˆ¶ç­‰äº15ï¼Œreturnè¯­å¥ä¸­è¿›è¡Œä¸‰ç›®åˆ¤æ–­ï¼Œæœ€åè¿”å›çš„å€¼ä¸ºï¼šn + 1 = 16ã€‚ å¦‚ä½•æ’å…¥å…ƒç´ ï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥çœ‹putæ–¹æ³•çš„å®ç°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172public V put(K key, V value) { // è®¡ç®—hashå€¼ï¼Œè°ƒç”¨putValæ–¹æ³• return putVal(hash(key), key, value, false, true);}final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { // å±€éƒ¨å˜é‡tabç”¨äºæ¥æ”¶æˆå‘˜å˜é‡table Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; if ((tab = table) == null || (n = tab.length) == 0) // å¦‚æœtableæ•°ç»„ä¸­æ— å…ƒç´ ï¼Œåˆ™è°ƒç”¨resize()æ‰©å®¹å¾—åˆ°ä¸€ä¸ªæ–°çš„Node&lt;K,V&gt;[]æ•°ç»„å¹¶èµ‹å€¼ç»™tabï¼Œç„¶åå¾—åˆ°æ–°æ•°ç»„çš„é•¿åº¦ä¸ºnã€‚ n = (tab = resize()).length; // æ ¹æ®hashå€¼è®¡ç®—å¾…æ’å…¥å…ƒç´ çš„æ•°ç»„ä¸‹æ ‡ç´¢å¼•iï¼ˆå¯¹2å–æ¨¡å¯è½¬åŒ–æˆä½è¿ç®—ï¼‰ if ((p = tab[i = (n - 1) &amp; hash]) == null) // å¦‚æœiä½ç½®æ— å…ƒç´ ï¼Œåˆ™ç›´æ¥åˆ›å»ºNodeèŠ‚ç‚¹è¿›è¡Œèµ‹å€¼æ’å…¥ tab[i] = newNode(hash, key, value, null); else { // iä½ç½®æœ‰å…ƒç´ ï¼Œè¯´æ˜å‡ºç°äº†å“ˆå¸Œå†²çª Node&lt;K,V&gt; e; K k; if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) // é”®keyç›¸ç­‰åˆ™ç›´æ¥è¿›è¡Œå€¼è¦†ç›– e = p; // å¾…æ’å…¥çš„é”®ä¸ç­‰äºä¸‹æ ‡iå¤„å­˜å‚¨çš„å¤´èŠ‚ç‚¹çš„é”® else if (p instanceof TreeNode) // åˆ¤æ–­ä¸ºçº¢é»‘æ ‘èŠ‚ç‚¹ï¼Œåˆ™æ‰§è¡Œçº¢é»‘æ ‘çš„æ’å…¥é€»è¾‘ e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); else { // å¦åˆ™ä¸ºé“¾è¡¨ç»“æ„ï¼Œè¿›è¡Œéå†ï¼ŒbinCountç”¨æ¥ç»Ÿè®¡é“¾è¡¨é•¿åº¦ for (int binCount = 0; ; ++binCount) { // å¯¹eè¿›è¡Œèµ‹å€¼ if ((e = p.next) == null) { // éå†åˆ°å°¾èŠ‚ç‚¹äº†ï¼Œe = null // å°¾æ’æ³•æ’å…¥æ–°å…ƒç´  p.next = newNode(hash, key, value, null); // åˆ¤æ–­é“¾è¡¨é•¿åº¦binCount &gt;= 7 if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st // æ­¤æ¬¡å¾ªç¯æ˜¯ç¬¬8æ¬¡ï¼ŒbinCount=7ï¼Œå°¾æ’æ³•æ’å…¥æ–°å…ƒç´ åé“¾è¡¨é•¿åº¦ä¸º8ï¼Œè°ƒç”¨treeifyBinå°è¯•è½¬æ¢æˆçº¢é»‘æ ‘ // åœ¨treeifyBinæ–¹æ³•ä¸­ï¼Œä¼šé¦–å…ˆåˆ¤æ–­tabæ•°ç»„çš„é•¿åº¦æ˜¯å¦å°äºMIN_TREEIFY_CAPACITY=64ï¼Œå¦‚æœå°äºï¼Œåˆ™è¿›è¡Œresizeæ‰©å®¹ç»“æŸï¼›å¦åˆ™æ‰§è¡Œæ ‘åŒ–é€»è¾‘ã€‚ treeifyBin(tab, hash); break; } if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) // æ‰¾åˆ°äº†é”®keyç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œç»“æŸå¾ªç¯ã€‚e = p.next break; // æœªæ‰¾åˆ°keyç›¸ç­‰çš„èŠ‚ç‚¹æˆ–æœªéå†åˆ°å°¾éƒ¨ï¼Œæ­¤æ—¶e = p.nextï¼Œæ¨åŠ¨é“¾è¡¨çš„éå†ã€‚ p = e; } } // ä¸Šé¢çš„åˆ¤æ–­ä¸­eçš„å€¼ä¸ä¸ºnullçš„æƒ…å†µï¼šå³é“¾è¡¨ä¸­æ‰¾åˆ°äº†keyç›¸ç­‰çš„èŠ‚ç‚¹ if (e != null) { // existing mapping for key // è¿›è¡Œå€¼valueçš„è¦†ç›– V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; // å›è°ƒé’©å­ï¼Œå­ç±»LinkedHashMapè¿›è¡Œäº†é‡å†™ afterNodeAccess(e); // è¿”å›æ—§å€¼ return oldValue; } } // ä¿®æ”¹æ¬¡æ•°åŠ ä¸€ ++modCount; if (++size &gt; threshold) // å®¹é‡è¾¾åˆ°é˜€å€¼è¿›è¡Œæ‰©å®¹ resize(); // å›è°ƒé’©å­ afterNodeInsertion(evict); return null;} æ•´ä¸ªputæ–¹æ³•çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¦‚ä½•ä¼˜é›…åœ°è¿›è¡Œæ‰©å®¹ï¼Ÿå‡ºç°æ‰©å®¹çš„æƒ…å†µæœ‰ä¸‰ç§ï¼š å“ˆå¸Œè¡¨ä¸ºç©ºä¸”ç¬¬ä¸€æ¬¡æ‰§è¡Œputæ–¹æ³•æ—¶ï¼Œä¼šå…ˆè¿›è¡Œæ‰©å®¹å†å­˜å‚¨å…ƒç´ ã€‚ å½“å‡ºç°å“ˆå¸Œå†²çªï¼Œæ‰§è¡Œå°¾æ’æ³•æ’å…¥å…ƒç´ åï¼Œå¦‚æœé“¾è¡¨é•¿åº¦å¤§äº8ï¼Œä¸”æ•°ç»„é•¿åº¦å°äºMIN_TREEIFY_CAPACITY=64ï¼Œæ‰§è¡Œæ‰©å®¹é€»è¾‘ã€‚ æ–°æ’å…¥ä¸€ä¸ªé”®åï¼ˆå…ƒç´ ç›´æ¥æ’å…¥ã€å“ˆå¸Œå†²çªé“¾è¡¨å°¾æ’ã€çº¢é»‘æ ‘æ’å…¥ï¼‰ï¼Œ++size &gt; thresholdå®¹é‡è¾¾åˆ°é˜€å€¼ï¼Œæ‰§è¡Œæ‰©å®¹é€»è¾‘ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹æ‰©å®¹resizeçš„é€»è¾‘ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127final Node&lt;K,V&gt;[] resize() { // ä½¿ç”¨oldTabæ¥æ”¶æ—§çš„æ•°ç»„table Node&lt;K,V&gt;[] oldTab = table; // å¦‚æœoldTabä¸ºnullå¼•ç”¨ï¼Œè¯´æ˜æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨putæ–¹æ³•æ—¶è¿›è¡Œçš„æ‰©å®¹ï¼Œåˆ™oldCapæ—§å®¹é‡ä¸º0ï¼›å¦åˆ™ä¸ºæ—§æ•°ç»„é•¿åº¦ã€‚ int oldCap = (oldTab == null) ? 0 : oldTab.length; // æ—§é˜€å€¼ int oldThr = threshold; // å®šä¹‰æ–°å®¹é‡å’Œæ–°é˜€å€¼ï¼ˆæ‰©å®¹ä¹‹åçš„ï¼‰ int newCap, newThr = 0; if (oldCap &gt; 0) { // æ—§å®¹é‡å¤§äº0ï¼Œåˆ™åŸæ•°ç»„æœ‰å…ƒç´ ï¼Œä¸æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨put if (oldCap &gt;= MAXIMUM_CAPACITY) { // æ—§å®¹é‡è¶…è¿‡æœ€å¤§å®¹é‡ï¼Œå·²æ— æ³•è¿›è¡Œæ‰©å®¹ // è®¾ç½®é˜€å€¼ä¸ºæœ€å¤§æ•´å‹æ•°å€¼ threshold = Integer.MAX_VALUE; // è¿”å›æ—§æ•°ç»„ return oldTab; } // è®¡ç®—æ–°å®¹é‡ï¼šoldCapçš„ä¸¤å€ else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY) // æ–°å®¹é‡å°äºæœ€å¤§å®¹é‡ï¼Œä¸”æ—§å®¹é‡å¤§äºç­‰äºé»˜è®¤åˆå§‹å®¹é‡ï¼Œåˆ™é˜€å€¼ä¹Ÿä¸ºåŸæ¥çš„ä¸¤å€ newThr = oldThr &lt;&lt; 1; // double threshold } // æ—§é˜€å€¼å¤§äº0ï¼Œè¯´æ˜æ˜¯è°ƒç”¨å¸¦å‚æ„é€ å™¨åˆ›å»ºçš„HashMapï¼Œä¸”æ­¤æ—¶æ—§é˜€å€¼ç­‰äºå¸¦å‚æ„é€ å™¨ä¸­æŒ‡å®šçš„åˆå§‹å®¹é‡ else if (oldThr &gt; 0) // initial capacity was placed in threshold // ç¬¬ä¸€æ¬¡è°ƒç”¨putæ‰ä¼šèµ°åˆ°è¿™ä¸ªifåˆ†æ”¯ // æ–°å®¹é‡ç­‰äºå¸¦å‚æ„é€ å™¨ä¸­æŒ‡å®šçš„å®¹é‡ newCap = oldThr; else { // zero initial threshold signifies using defaults // å…¶å®ƒæƒ…å†µï¼šè°ƒç”¨æ— å‚æ„é€ å™¨åˆ›å»ºçš„HashMap // æ–°å®¹é‡ä¸ºï¼šé»˜è®¤åˆå§‹å®¹é‡ newCap = DEFAULT_INITIAL_CAPACITY; // æ–°é˜€å€¼ä¸ºï¼šé»˜è®¤åŠ è½½å› å­ * é»˜è®¤åˆå§‹å®¹é‡ newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); } // ç¬¬ä¸€æ¬¡è°ƒç”¨putæ—¶ï¼Œèµ°çš„ä¸Šé¢çš„else if (oldThr &gt; 0)åˆ†æ”¯ï¼Œæ–°é˜€å€¼æœªè¿›è¡Œèµ‹å€¼ï¼Œæ‰€ä»¥ç­‰äº0 if (newThr == 0) { // è®¡ç®—æ–°é˜€å€¼ï¼šæ–°å®¹é‡ * åŠ è½½å› å­ float ft = (float)newCap * loadFactor; // èŒƒå›´æ§åˆ¶ï¼Œè½¬æ¢æˆint newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); } // è®¾ç½®é˜€å€¼ threshold = newThr; // å¼€è¾Ÿæ–°å®¹é‡é•¿åº¦çš„æ•°ç»„ç©ºé—´ @SuppressWarnings({&quot;rawtypes&quot;,&quot;unchecked&quot;}) Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap]; // tableå¼•ç”¨æŒ‡å‘æ–°æ•°ç»„ table = newTab; // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨putæ—¶æ‰§è¡Œï¼ŒoldTabä¸ºnullã€‚ if (oldTab != null) { // éé¦–æ¬¡putæ–¹æ³•ï¼ŒåŸtableæ•°ç»„ä¸­å­˜åœ¨å…ƒç´ ï¼Œæ‰§è¡Œrehash for (int j = 0; j &lt; oldCap; ++j) { // éå†æ—§tableæ•°ç»„ Node&lt;K,V&gt; e; if ((e = oldTab[j]) != null) { // é‡Šæ”¾æ—§tableçš„å¼•ç”¨ help gc oldTab[j] = null; // æ— å“ˆå¸Œå†²çª if (e.next == null) // æ–°æ•°ç»„newTabèµ‹å€¼ // newCapä¸º2çš„æ•´æ•°å¹‚ï¼Œhash &amp; 2^n - 1 å³å¯¹2å–æ¨¡ï¼Œæ±‚å‡ºæ•°ç»„ä¸‹æ ‡ã€‚ newTab[e.hash &amp; (newCap - 1)] = e; else if (e instanceof TreeNode) // çº¢é»‘æ ‘é€»è¾‘ ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap); else { // preserve order // å“ˆå¸Œå†²çªï¼Œæœ‰é“¾è¡¨ï¼Œå°†æ•´ä¸ªé“¾è¡¨åˆ†éš”æˆä¸¤ä¸ªéƒ¨åˆ† // loHead/loTailé“¾æ¥å‡ºä¸€ä¸ªä¸éœ€è¦ç§»åŠ¨ä½ç½®çš„é“¾è¡¨ Node&lt;K,V&gt; loHead = null, loTail = null; // hiHead/hiTailé“¾æ¥å‡ºä¸€ä¸ªéœ€è¦ç§»åŠ¨ä½ç½®çš„é“¾è¡¨ Node&lt;K,V&gt; hiHead = null, hiTail = null; Node&lt;K,V&gt; next; do { next = e.next; // å“ˆå¸Œç  &amp; æ—§å®¹é‡ // ç»“æœä¸º0ï¼Œè¡¨ç¤ºè¯¥å…ƒç´ çš„ä¸‹æ ‡ç´¢å¼•å€¼åœ¨æ‰©å®¹åä¸ä¼šå‘ç”Ÿå˜åŒ– if ((e.hash &amp; oldCap) == 0) { // é“¾æ¥åŸé“¾è¡¨æ¯ä¸€ä¸ªå…ƒç´ è‡³loHeadå¤´èŠ‚ç‚¹ // ç¬¬ä¸€æ¬¡æ‰§è¡Œdo-whileå¾ªç¯ if (loTail == null) // èµ‹å€¼loHeadå¤´èŠ‚ç‚¹ loHead = e; else // éç¬¬ä¸€æ¬¡æ‰§è¡Œdo-while // é“¾æ¥è‡³loTail loTail.next = e; // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æ‰§è¡Œdo-whileï¼Œåˆ™loTail=loHeadæŒ‡å‘å¤´èŠ‚ç‚¹ // å¦åˆ™è¡¨ç¤ºloTailå³ç§»ä¸€ä½ loTail = e; } // å¦åˆ™ï¼Œç»“æœä¸ä¸º0ï¼Œåˆ™è¯¥å…ƒç´ çš„ä¸‹æ ‡ç´¢å¼•å€¼åœ¨æ‰©å®¹åä¼šæ”¹å˜ else { // åŒæ ·åœ°é“¾æ¥é€»è¾‘ // ç¬¬ä¸€æ¬¡æ‰§è¡Œdo-whileå¾ªç¯ if (hiTail == null) // èµ‹å€¼hiHeadå¤´èŠ‚ç‚¹ hiHead = e; else // éç¬¬ä¸€æ¬¡æ‰§è¡Œdo-while // é“¾æ¥è‡³hiTail hiTail.next = e; // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æ‰§è¡Œdo-whileï¼Œåˆ™hiTail=hiHeadæŒ‡å‘å¤´èŠ‚ç‚¹ // å¦åˆ™è¡¨ç¤ºhiTailå³ç§»ä¸€ä½ hiTail = e; } } while ((e = next) != null); // æ‰§è¡Œå®Œdo-whileå¾ªç¯åï¼ŒloTailå’ŒhiTailéƒ½æŒ‡å‘å‡ºç°å“ˆå¸Œå†²çªçš„åŸé“¾è¡¨çš„å°¾éƒ¨ if (loTail != null) { loTail.next = null; // ä¸‹æ ‡ç´¢å¼•ä¸éœ€è¦ç§»åŠ¨ï¼Œé“¾è¡¨loHeadæ•´ä½“ç§»åŠ¨ newTab[j] = loHead; } if (hiTail != null) { hiTail.next = null; // ä¸‹æ ‡ç´¢å¼•éœ€è¦ç§»åŠ¨åˆ°j + oldCapä½ç½®ï¼Œé“¾è¡¨hiHeadæ•´ä½“ç§»åŠ¨ newTab[j + oldCap] = hiHead; } } } } } // è¿”å›æ‰©å®¹åçš„æ–°tableæ•°ç»„ return newTab;} å¯ä»¥çœ‹åˆ°åœ¨æœ‰å“ˆå¸Œå†²çªæ—¶ï¼Œå¯¹é“¾è¡¨ä¸­çš„å…ƒç´ å¹¶æ²¡æœ‰è¿›è¡Œrehashæ“ä½œï¼Œè€Œæ˜¯å°†å†²çªçš„é“¾è¡¨åˆ†éš”ä¸ºä¸¤ä¸ªé“¾è¡¨ï¼Œé€šè¿‡è®¡ç®—e.hash &amp; oldCapï¼Œå¦‚æœç»“æœçš„é«˜ä¸€ä½ä¸º0ï¼Œåˆ™è¡¨ç¤ºè¯¥é“¾è¡¨èŠ‚ç‚¹ä¸éœ€è¦ç§»åŠ¨ä½ç½®ï¼Œé“¾æ¥è‡³loHeadèŠ‚ç‚¹ï¼›å¦‚æœç»“æœçš„é«˜ä¸€ä½ä¸º1ï¼Œåˆ™è¡¨ç¤ºè¯¥é“¾è¡¨èŠ‚ç‚¹éœ€è¦ç§»åŠ¨ä½ç½®ï¼Œé“¾æ¥è‡³hiHeadèŠ‚ç‚¹ã€‚do-whileå¾ªç¯ç»“æŸåï¼Œä»¥loHeadèŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹çš„é“¾è¡¨ä¸éœ€è¦ç§»åŠ¨æ•°ç»„ä¸‹æ ‡ï¼›è€Œä»¥hiHeadèŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹çš„é“¾è¡¨éœ€è¦å‘å³ç§»åŠ¨æ—§å®¹é‡oldCapä¸ªä½ç½®ã€‚åŸé“¾è¡¨å„èŠ‚ç‚¹ä¹‹é—´çš„ç›¸å¯¹ä½ç½®æœªå‘ç”Ÿæ”¹å˜ã€‚ å¦‚ä½•è·å–å…ƒç´ ï¼Ÿç›¸æ¯”äºputæ’å…¥ï¼Œgetè·å–å…ƒç´ çš„é€»è¾‘å°±ç›¸å¯¹ç®€å•äº†ã€‚æ­£å¸¸ä»HashMapä¸­è·å–å…ƒç´ çš„æœ€å¥½æ—¶é—´å¤æ‚åº¦æ˜¯å¸¸æ•°O(1)ã€‚åœ¨å“ˆå¸Œå†²çªçš„æƒ…å†µä¸‹ï¼šæœ€åæ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œæœ€å¥½æ—¶é—´å¤æ‚åº¦æ˜¯O(log n)ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹getæ–¹æ³•çš„é€»è¾‘ï¼š 1234567891011121314151617181920212223242526272829303132public V get(Object key) { Node&lt;K,V&gt; e; return (e = getNode(hash(key), key)) == null ? null : e.value;}final Node&lt;K,V&gt; getNode(int hash, Object key) { Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k; // tableæ•°ç»„å·²ç»åˆå§‹åŒ–ï¼Œä¸”æ•°ç»„ä¸­æœ‰å…ƒç´ ï¼Œä¸”keyæ‰€åœ¨ä¸‹æ ‡ç´¢å¼•ä½ç½®æœ‰å…ƒç´  if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (first = tab[(n - 1) &amp; hash]) != null) { if (first.hash == hash &amp;&amp; // always check first node ((k = first.key) == key || (key != null &amp;&amp; key.equals(k)))) // ç¬¬ä¸€ä¸ªkeyç›¸ç­‰ï¼Œç›´æ¥è¿”å›è¯¥èŠ‚ç‚¹ return first; // keyåœ¨åé¢çš„é“¾è¡¨ï¼ˆçº¢é»‘æ ‘ï¼‰èŠ‚ç‚¹ä¸­ if ((e = first.next) != null) { if (first instanceof TreeNode) // æ‰§è¡Œçº¢é»‘æ ‘çš„æŸ¥è¯¢é€»è¾‘ï¼Œæ—¶é—´å¤æ‚åº¦O(log n) return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key); do { if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) // éå†é“¾è¡¨æ‰¾åˆ°ç›¸ç­‰çš„keyï¼Œè¿”å›å¯¹åº”èŠ‚ç‚¹ã€‚ return e; } while ((e = e.next) != null); } } return null;} ç”±äºåœ¨putæ’å…¥çš„æ—¶å€™è®¡ç®—ä¸‹æ ‡çš„æ–¹å¼ä¸º(n - 1) &amp; hashï¼Œæ‰€ä»¥getæŸ¥è¯¢çš„æ—¶å€™ä»¥åŒæ ·æ–¹å¼è®¡ç®—ä¸‹æ ‡ï¼Œå¦‚æœè¯¥ä¸‹æ ‡ä½ç½®æ— å…ƒç´ ï¼Œé‚£ä¹ˆå¾…æŸ¥è¯¢çš„keyä¸€å®šä¸åœ¨HashMapä¸­ï¼Œç›´æ¥è¿”å›nullï¼›åä¹‹ï¼Œå¦‚æœè¯¥ä¸‹æ ‡ä½ç½®æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆåˆ™å¯»æ‰¾ä¸å¾…æŸ¥è¯¢çš„keyç›¸ç­‰çš„é”®ã€‚ å¦‚ä½•åˆ¤æ–­keyç›¸ç­‰ï¼Ÿ åœ¨HashMapä¸­ï¼Œæ‰€æœ‰åˆ¤æ–­keyæ˜¯å¦ç›¸ç­‰çš„é€»è¾‘éƒ½æ˜¯ï¼šå…ˆæ¯”è¾ƒhashCodeæ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒequalsæ˜¯å¦ç›¸ç­‰ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå»ºè®®åœ¨é‡å†™equalsæ–¹æ³•çš„åŒæ—¶æœ€å¥½å»é‡å†™hashCodeæ–¹æ³•çš„ä¸€ä¸ªåŸå› ã€‚ ä¸¤ä¸ªkeyå¦‚æœhashCodeç›¸ç­‰ï¼Œequalsä¸ä¸€å®šä¸ç­‰ã€‚ çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿå¯¹äºJDK7ï¼Œåœ¨å¤šçº¿ç¨‹è¿›è¡Œæ‰©å®¹æ—¶ä¼šäº§ç”Ÿæ­»å¾ªç¯é—®é¢˜ï¼Œç”±äºJDK7å·²æˆä¸ºå†å²ï¼Œæœ¬æ–‡ä¸å†èµ˜è¿°ï¼Œå¯ä»¥å‚è€ƒç½‘ä¸Šçš„ä¸€äº›è§£é‡Šã€‚ è€Œå¯¹äºJDK8ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¸Šæ–‡ä¸­åˆ†æçš„putæ’å…¥æ–¹æ³•ï¼Œé’ˆå¯¹ç¬¬äºŒä¸ªifæ¡ä»¶åˆ†æ”¯ï¼Œå¦‚æœæœªå‘ç”Ÿå“ˆå¸Œå†²çªï¼Œåˆ™åˆ›å»ºæ–°èŠ‚ç‚¹ç›´æ¥è¿›è¡Œèµ‹å€¼æ’å…¥ã€‚ 12if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); ä»¥ä¸Šä»£ç åœ¨JDK8#HashMap.javaæºç ä¸­åˆ†åˆ«æ˜¯ç¬¬630è¡Œå’Œç¬¬631è¡Œã€‚ æ­¤å¤„å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹åŒä¸€ä¸ªHashMapæ‰§è¡Œputæ–¹æ³•ï¼Œæ ¹æ®hashè®¡ç®—å‡ºçš„ä¸‹æ ‡iç›¸åŒä¸”iä¸‹æ ‡å¤„æ°å¥½ä¸ºnullæ²¡æœ‰å…ƒç´ ï¼ŒåŒæ—¶å¤šä¸ªçº¿ç¨‹æ°å¥½åˆšæ‰§è¡Œå®Œç¬¬630è¡Œçš„ifæ¡ä»¶åˆ¤æ–­ä½†è¿˜æœªæ‰§è¡Œç¬¬631è¡Œçš„èµ‹å€¼æ’å…¥ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹æŒ‰å…ˆåé¡ºåºå¾€ä¸‹æ‰§è¡Œï¼Œé‚£ä¹ˆåæ‰§è¡Œçš„çº¿ç¨‹å°±ä¼šè¦†ç›–å…ˆæ‰§è¡Œçš„çº¿ç¨‹åœ¨iä¸‹æ ‡å¤„æ’å…¥çš„å€¼ã€‚ å½“ç„¶åœ¨æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼ŒåŸºæœ¬ä¸Šä¸ä¼šä½¿ç”¨åˆ°HashMapä½œä¸ºæˆå‘˜å˜é‡ï¼Œæ›´å¤šçš„æ˜¯ç”¨ä½œå±€éƒ¨å˜é‡è¿›è¡Œä¼ å‚ï¼Œè€Œä¸”ç°åœ¨å·²ç»ä¸æ¨èä½¿ç”¨HashMapè¿›è¡Œä¼ å‚äº†ï¼Œé™¤äº†ä¸€äº›æ—©æœŸé¡¹ç›®ï¼Œæˆ–è€…ä½¿ç”¨äº†MyBatisçš„æ—©æœŸç‰ˆæœ¬ibatisçš„é¡¹ç›®ï¼ŒåŸºæœ¬ä¸Šå¾ˆå°‘ä¼šç”¨åˆ°HashMapã€‚ æ€»ç»“æœ‰å…³HashMapï¼Œå…¶å®åˆ°è¿™é‡Œå°±å·²ç»è¶³å¤Ÿäº†ï¼Œå†å¾€ä¸‹æ·±å…¥ï¼Œå°±æ˜¯çº¢é»‘æ ‘çš„æŸ¥è¯¢å’Œæ’å…¥é€»è¾‘äº†ï¼Œæ¶‰åŠåˆ°çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„å’Œç®—æ³•ï¼Œæ¯”è¾ƒå¤æ‚ã€‚é¢è¯•å¦‚æœé‡åˆ°é—®çº¢é»‘æ ‘çš„å®ç°ç»†èŠ‚çš„ï¼Œå¤§å¯ä»¥å»åé—®é¢è¯•å®˜ä¼šä¸ä¼šã€‚ åé¢æœ‰ç©ºä¼šä¸“é—¨å†™ä¸€ç¯‡æ–‡ç« è®²è®²çº¢é»‘æ ‘ã€‚","link":"/2020/11/17/javase/base/hashmap/"},{"title":"åƒåœ¾æ”¶é›†ç®—æ³•","text":"ç°ä»£è™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†å™¨å¤§å¤šåŸºäºåˆ†ä»£æ”¶é›†ç†è®ºï¼ŒåŸºäºè¯¥ç†è®ºï¼Œå †å†…å­˜è¢«åˆ’åˆ†å‡ºå„ç§ä¸åŒçš„åŒºåŸŸï¼Œä¸åŒçš„åŒºåŸŸæœ‰ç€ä¸åŒçš„åƒåœ¾æ”¶é›†ç®—æ³•ã€‚ åˆ†ä»£æ”¶é›†ç†è®ºåˆ†ä»£æ”¶é›†ç†è®ºå»ºç«‹åœ¨ä¸¤ä¸ªåˆ†ä»£å‡è¯´ä¹‹ä¸Šï¼š å¼±åˆ†ä»£å‡è¯´ï¼šç»å¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•ç­çš„ã€‚ å¼ºåˆ†ä»£å‡è¯´ï¼šç†¬è¿‡è¶Šå¤šæ¬¡åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„å¯¹è±¡å°±è¶Šéš¾ä»¥æ¶ˆäº¡ã€‚ è¿™ä¸¤ä¸ªåˆ†ä»£å‡è¯´å…±åŒå¥ å®šäº†å¤šæ¬¾å¸¸ç”¨çš„åƒåœ¾æ”¶é›†å™¨çš„ä¸€è‡´çš„è®¾è®¡åŸåˆ™ï¼šæ”¶é›†å™¨åº”è¯¥å°†å †å†…å­˜åˆ’åˆ†å‡ºä¸åŒçš„åŒºåŸŸï¼Œç„¶åå°†å›æ”¶å¯¹è±¡ä¾æ®å…¶å¹´é¾„ï¼ˆä¸€æ¬¡åƒåœ¾å›æ”¶ï¼Œå¦‚æœå¯¹è±¡æœªè¢«å›æ”¶ï¼Œåˆ™å…¶å¹´é¾„åŠ ä¸€ï¼‰åˆ†é…åˆ°ä¸åŒçš„åŒºåŸŸè¿›è¡Œå­˜å‚¨ã€‚ æ˜¾ç„¶ï¼Œåº”è¯¥å°†å¤§å¤šæ•°æœç”Ÿå¤•æ­»çš„å¯¹è±¡é›†ä¸­åœ¨ä¸€èµ·ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶åªéœ€å…³æ³¨å¦‚ä½•ä¿ç•™å°‘é‡å­˜æ´»çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å»æ ‡è®°é‚£äº›å¤§é‡å°†è¢«å›æ”¶çš„å¯¹è±¡ï¼›å°†é‚£äº›éš¾ä»¥æ¶ˆäº¡çš„å¯¹è±¡ä¹Ÿé›†ä¸­åœ¨ä¸€èµ·ï¼Œå‡å°‘å¯¹å®ƒä»¬å›æ”¶çš„é¢‘ç‡ã€‚è¿™æ ·å°±æœ‰æ•ˆçš„åœ¨æ—¶é—´å’Œç©ºé—´å¼€é”€ä¸Šåšäº†æƒè¡¡ã€‚ åœ¨å †å†…å­˜åˆ’åˆ†å‡ºä¸åŒçš„åŒºåŸŸä¹‹åï¼Œåƒåœ¾æ”¶é›†å™¨æ‰å¯ä»¥æ¯æ¬¡åªå›æ”¶å…¶ä¸­æŸä¸ªåŒºåŸŸçš„å†…å­˜â€”â€”å› è€Œæ‰æœ‰äº†Minor GCã€Major GCå’ŒFull GCå›æ”¶ç±»å‹çš„åŒºåˆ†ï¼›é’ˆå¯¹ä¸åŒåŒºåŸŸä¹Ÿé‡‡ç”¨äº†é€‚å½“çš„åƒåœ¾æ”¶é›†ç®—æ³•ã€‚ ä¸€åˆ‡çœ‹ä¼¼ç¾å¥½ï¼Œä½†åŒºåŸŸåˆ’åˆ†åä¼šå­˜åœ¨ä¸€ä¸ªæ˜æ˜¾çš„é—®é¢˜ï¼šå¯¹è±¡éƒ½ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œå¾ˆå¯èƒ½å­˜åœ¨è·¨ä»£å¼•ç”¨ã€‚ ç°ä»£è™šæ‹Ÿæœºä¸€èˆ¬éƒ½ä¼šå°†å †å†…å­˜åˆ’åˆ†å‡ºæ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰å’Œè€å¹´ä»£ï¼ˆOld Generationï¼‰ä¸¤ä¸ªåŸºæœ¬åŒºåŸŸï¼Œå¯¹äºæ–°ç”Ÿä»£çš„å›æ”¶ç§°ä¸ºMinor GCï¼Œä½†æ–°ç”Ÿä»£çš„å¯¹è±¡å®Œå…¨æœ‰å¯èƒ½è¢«è€å¹´ä»£æ‰€å¼•ç”¨ï¼ŒåŒæ ·ï¼Œè€å¹´ä»£çš„å¯¹è±¡ä¹Ÿå®Œå…¨æœ‰å¯èƒ½è¢«æ–°ç”Ÿä»£æ‰€å¼•ç”¨ï¼Œä¸ºäº†æ‰¾å‡ºå¯¹åº”åŒºåŸŸä¸­çš„å­˜æ´»å¯¹è±¡ï¼Œä¸å¾—ä¸åœ¨å›ºå®šçš„GC Rootsä¹‹å¤–ï¼Œé¢å¤–éå†è€å¹´ä»£æˆ–æ–°ç”Ÿä»£æ¥ç¡®ä¿å¯è¾¾æ€§åˆ†æçš„æ­£ç¡®æ€§ã€‚éå†æ•´ä¸ªè€å¹´ä»£æ‰€æœ‰å¯¹è±¡çš„æ–¹æ¡ˆè™½ç„¶ç†è®ºä¸Šå¯è¡Œï¼Œä½†æ— ç–‘ä¼šå¯¹å†…å­˜å›æ”¶å¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½è´Ÿæ‹…ã€‚äºæ˜¯æœ‰äº†ç¬¬ä¸‰ä¸ªåˆ†ä»£å‡è¯´ï¼š è·¨ä»£å¼•ç”¨å‡è¯´ï¼šè·¨ä»£å¼•ç”¨ç›¸å¯¹äºåŒä»£å¼•ç”¨æ¥è¯´ä»…å æå°‘æ•°ã€‚ è¿™ä¸ªå‡è¯´å¯ä»¥è®¤ä¸ºæ˜¯å‰ä¸¤ä¸ªåˆ†ä»£å‡è¯´çš„æ¨è®ºï¼šå­˜åœ¨äº’ç›¸å¼•ç”¨å…³ç³»çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œå€¾å‘äºåŒæ—¶ç”Ÿå­˜æˆ–åŒæ—¶æ­»äº¡çš„ã€‚å¦‚æœæŸä¸ªæ–°ç”Ÿä»£å¯¹è±¡å­˜åœ¨è·¨ä»£å¼•ç”¨ï¼Œç”±äºè€å¹´ä»£å¯¹è±¡æ˜¯éš¾ä»¥æ¶ˆäº¡çš„ï¼Œè¯¥å¼•ç”¨ä¼šä½¿æ–°ç”Ÿä»£å¯¹è±¡åœ¨è¢«å›æ”¶æ—¶å­˜æ´»ä¸‹æ¥ï¼Œéšåæ…¢æ…¢æ™‹å‡è‡³è€å¹´ä»£ï¼Œè¿™æ—¶è·¨ä»£å¼•ç”¨å°±ä¸å­˜åœ¨äº†ã€‚ ä¾æ®è¿™æ¡å‡è¯´ï¼Œæˆ‘ä»¬å°±ä¸åº”è¯¥å†ä¸ºäº†å°‘é‡çš„è·¨ä»£å¼•ç”¨å»æ‰«ææ•´ä¸ªè€å¹´ä»£ï¼Œä¹Ÿä¸å¿…æµªè´¹ç©ºé—´å»è®°å½•æ¯ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜åœ¨ä»¥åŠå­˜åœ¨å“ªäº›è·¨ä»£å¼•ç”¨ï¼Œåªéœ€åœ¨æ–°ç”Ÿä»£ä¸Šå»ºç«‹ä¸€ä¸ªå…¨å±€çš„ç§°ä¸ºè®°å¿†é›†ï¼ˆReference Setï¼‰çš„æ•°æ®ç»“æ„ï¼Œè¿™ä¸ªç»“æ„æŠŠè€å¹´ä»£åˆ’åˆ†ä¸ºè‹¥å¹²å°å—ï¼Œæ­¤åå½“å‘ç”ŸMinor GCæ—¶ï¼Œåªæœ‰åŒ…å«äº†è·¨ä»£å¼•ç”¨çš„å°å—å†…å­˜é‡Œçš„å¯¹è±¡æ‰ä¼šè¢«åŠ å…¥åˆ°GC Rootsè¿›è¡Œæ‰«æã€‚è™½ç„¶è¿™ç§æ–¹æ³•éœ€è¦åœ¨å¯¹è±¡æ”¹å˜å¼•ç”¨å…³ç³»æ—¶ç»´æŠ¤è®°å½•æ•°æ®çš„æ­£ç¡®æ€§ï¼Œå¢åŠ äº†ä¸€å®šçš„è¿è¡Œæ—¶å¼€é”€ï¼Œä½†è·Ÿåœ¨æ”¶é›†æ—¶æ‰«ææ•´ä¸ªè€å¹´ä»£ç›¸æ¯”æ˜¯åˆ’ç®—çš„ã€‚ GCåˆ†ç±» æ–°ç”Ÿä»£æ”¶é›†ï¼ˆMinor GC/Young GCï¼‰ï¼šå¯¹æ–°ç”Ÿä»£æ”¶é›†ã€‚ è€å¹´ä»£æ”¶é›†ï¼ˆMajor GC/Old GCï¼‰ï¼šå¯¹è€å¹´ä»£æ”¶é›†ã€‚ç›®å‰åªæœ‰CMSæ”¶é›†å™¨ä¼šæœ‰å•ç‹¬æ”¶é›†è€å¹´ä»£çš„è¡Œä¸ºã€‚ æ··åˆæ”¶é›†ï¼ˆMixed GCï¼‰ï¼šå¯¹æ•´ä¸ªæ–°ç”Ÿä»£ä»¥åŠéƒ¨åˆ†è€å¹´ä»£æ”¶é›†ã€‚ç›®å‰åªæœ‰G1æ”¶é›†å™¨ä¼šæœ‰è¿™ç§è¡Œä¸ºã€‚ æ•´å †æ”¶é›†ï¼ˆFull GCï¼‰ï¼šå¯¹æ•´ä¸ªå †å†…å­˜å’Œæ–¹æ³•åŒºæ”¶é›†ã€‚ åƒåœ¾æ”¶é›†ç®—æ³• æ ‡è®°-æ¸…é™¤ç®—æ³• è¯¥ç®—æ³•åˆ†ä¸ºâ€œæ ‡è®°â€å’Œâ€œæ¸…é™¤â€ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆä½¿ç”¨å¯è¾¾æ€§åˆ†æç®—æ³•æ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œæ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ï¼›ä¹Ÿå¯ä»¥åè¿‡æ¥ï¼Œæ ‡è®°æ‰€æœ‰å­˜æ´»å¯¹è±¡ï¼Œç»Ÿä¸€å›æ”¶æœªè¢«æ ‡è®°çš„å¯¹è±¡ã€‚ ç¼ºç‚¹ï¼šæ‰§è¡Œæ•ˆç‡ä¸ç¨³å®šï¼Œå¦‚æœå †ä¸­å­˜åœ¨å¤§é‡å¯¹è±¡éœ€è¦è¿›è¡Œå›æ”¶ï¼Œåˆ™éœ€è¦è¿›è¡Œå¤§é‡æ ‡è®°å’Œæ¸…é™¤çš„åŠ¨ä½œï¼Œæ‰§è¡Œæ•ˆç‡éšå¯¹è±¡æ•°é‡å¢é•¿è€Œé™ä½ï¼›ç¬¬äºŒä¸ªæ˜¯å†…å­˜ç©ºé—´çš„ç¢ç‰‡åŒ–é—®é¢˜ï¼Œæ ‡è®°æ¸…é™¤åä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ã€‚å†…å­˜ç¢ç‰‡å¤ªå¤šä¼šå¯¼è‡´å½“éœ€è¦åˆ†é…å¤§å¯¹è±¡æ—¶æ— æ³•æ‰¾åˆ°è¿ç»­çš„å†…å­˜ç©ºé—´è€Œä¸å¾—ä¸æå‰è§¦å‘å†ä¸€æ¬¡çš„åƒåœ¾å›æ”¶ã€‚ æ ‡è®°-å¤åˆ¶ç®—æ³• ä¸ºäº†è§£å†³æ ‡è®°-æ¸…é™¤ç®—æ³•åœ¨é¢å¯¹å¤§é‡å¯å›æ”¶å¯¹è±¡æ—¶æ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ï¼Œæœ‰â€œå¤§ä½¬â€æå‡ºäº†ä¸€ç§ç§°ä¸ºâ€œåŠåŒºå¤åˆ¶â€çš„åƒåœ¾æ”¶é›†ç®—æ³•ï¼šå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ï¼Œå½“è¿™ä¸€å—å†…å­˜ç”¨å®Œçš„æ—¶å€™æ‰å°†å…¶å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—å†…å­˜ä¸Šï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ä¸€æ¬¡æ€§æ¸…é™¤ã€‚å¦‚æœç¬¬ä¸€åŠå†…å­˜ä¸­å¤šæ•°å¯¹è±¡æ˜¯å­˜æ´»çš„ï¼Œé‚£è¿™ç§ç®—æ³•å°†ä¼šäº§ç”Ÿå¤§é‡çš„å†…å­˜é—´å¤åˆ¶çš„å¼€é”€ï¼Œä½†å¯¹äºå¤šæ•°å¯¹è±¡æ˜¯å¯å›æ”¶çŠ¶æ€æ—¶ï¼Œç®—æ³•å°±åªéœ€å¤åˆ¶å°‘é‡çš„å­˜æ´»å¯¹è±¡ï¼Œè€Œä¸”æ¯æ¬¡éƒ½æ˜¯é’ˆå¯¹ä¸€åŠå†…å­˜è¿›è¡Œå›æ”¶ï¼Œå†…å­˜ç¢ç‰‡é—®é¢˜å‡ ä¹ä¸ä¼šå‡ºç°ã€‚è¿™ç§ç®—æ³•å®ç°å®¹æ˜“ï¼Œæ‰§è¡Œæ•ˆç‡ä¹Ÿéå¸¸é«˜ï¼Œä½†å…¶ä»£ä»·æ˜¯å¯ç”¨å†…å­˜ç¼©å°ä¸ºäº†åŸæ¥çš„ä¸€åŠã€‚ç©ºé—´åˆ©ç”¨ç‡å¤ªä½ã€‚ ç°ä»£è™šæ‹Ÿæœºå¤§å¤šé‡‡ç”¨äº†è¯¥ç®—æ³•å»å›æ”¶æ–°ç”Ÿä»£ï¼Œæœ‰ç ”ç©¶è¡¨æ˜ï¼šæ–°ç”Ÿä»£ä¸­æœç”Ÿå¤•æ­»çš„å¯¹è±¡æœ‰98%éƒ½ç†¬ä¸è¿‡ç¬¬ä¸€è½®åƒåœ¾æ”¶é›†ã€‚å› æ­¤å¹¶ä¸éœ€è¦å°†æ–°ç”Ÿä»£åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ›´å¥½çš„åšæ³•æ˜¯å°†æ–°ç”Ÿä»£åˆ’åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„EdenåŒºåŸŸå’Œä¸¤å—è¾ƒå°çš„Survivorç©ºé—´ï¼Œæ¯æ¬¡å†…å­˜åˆ†é…æ—¶åªä½¿ç”¨EdenåŒºåŸŸå’Œå…¶ä¸­ä¸€å—SurvivoråŒºåŸŸã€‚å½“å‘ç”Ÿåƒåœ¾å›æ”¶æ—¶ï¼Œå°†EdenåŒºå’ŒSurvivoråŒºå­˜æ´»çš„å¯¹è±¡ä¸€æ¬¡æ€§å¤åˆ¶åˆ°å¦ä¸€å—SurvivoråŒºåŸŸä¸Šï¼Œç„¶åç›´æ¥å›æ”¶æ‰EdenåŒºå’Œé‚£å—ä½¿ç”¨è¿‡çš„SurvivoråŒºã€‚HotSpotè™šæ‹Ÿæœºé»˜è®¤Edenå’ŒSurvivoråŒºåŸŸçš„å¤§å°æ¯”ä¾‹æ˜¯8 : 1ï¼Œä¹Ÿå°±æ˜¯è¯´æ–°ç”Ÿä»£ä¸­å¯ç”¨çš„å†…å­˜ç©ºé—´ä¸ºæ•´ä¸ªæ–°ç”Ÿä»£çš„90%ï¼Œè¿™æ ·ç©ºé—´åˆ©ç”¨ç‡å°±è¾¾åˆ°äº†90%ï¼Œè™½ç„¶è¿˜æœ‰10%çš„å¦ä¸€å—SurvivoråŒºåŸŸè¢«æµªè´¹ï¼Œä½†å·²ç»æ¯”è¾ƒç†æƒ³äº†ã€‚å½“ç„¶ï¼Œä»»ä½•äººéƒ½ä¸èƒ½ä¿è¯ç ”ç©¶åœ¨å®é™…æƒ…å†µä¸­çš„æ­£ç¡®æ€§ï¼Œæ— æ³•ä¿è¯æ¯æ¬¡å¯¹æ–°ç”Ÿä»£çš„å›æ”¶éƒ½åªæœ‰ä¸å¤šäº10%çš„å¯¹è±¡å­˜æ´»ï¼Œäºæ˜¯å­˜åœ¨ä¸€ä¸ªå…œåº•çš„å®‰å…¨è®¾è®¡ï¼šå½“å¦ä¸€å—SurvivoråŒºåŸŸç©ºé—´ä¸è¶³ä»¥å®¹çº³ä¸€æ¬¡Young GCä¹‹åå­˜æ´»çš„å¯¹è±¡æ—¶ï¼Œå°±éœ€è¦å…¶å®ƒå†…å­˜åŒºåŸŸï¼ˆå¤§å¤šæŒ‡è€å¹´ä»£ï¼‰è¿›è¡Œå†…å­˜åˆ†é…æ‹…ä¿ï¼Œå°†å¤šä½™çš„å­˜æ´»å¯¹è±¡ç›´æ¥å¤åˆ¶åˆ°è€å¹´ä»£ã€‚ æ ‡è®°æ•´ç† æ ‡è®°-å¤åˆ¶ç®—æ³•åœ¨å¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜æ—¶å°±ä¼šäº§ç”Ÿå¤§é‡çš„å†…å­˜é—´å¤åˆ¶å¼€é”€ï¼Œä¼˜åŒ–è¿‡åçš„ç®—æ³•ä¹Ÿéœ€è¦æµªè´¹10%çš„ç©ºé—´ï¼Œä¸”éœ€è¦å…¶å®ƒç©ºé—´è¿›è¡Œå†…å­˜åˆ†é…æ‹…ä¿ã€‚å¯¹äºè€å¹´ä»£æ¥è¯´ï¼Œå¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ˜¯éš¾ä»¥æ¶ˆäº¡çš„ï¼Œæ‰€ä»¥è¯¥ç®—æ³•å¹¶ä¸é€‚ç”¨äºè€å¹´ä»£ã€‚ é’ˆå¯¹è€å¹´ä»£å¯¹è±¡éš¾ä»¥æ¶ˆäº¡çš„ç‰¹å¾ï¼Œæœ‰äººæå‡ºäº†å¦ä¸€ç§æœ‰é’ˆå¯¹æ€§çš„â€œæ ‡è®°-æ•´ç†â€ç®—æ³•ï¼Œæ ‡è®°è¿‡ç¨‹ä»ç„¶é‡‡ç”¨çš„æ˜¯å¯è¾¾æ€§åˆ†æç®—æ³•ï¼Œä½†æ ‡è®°å®Œæˆåå¹¶ä¸æ˜¯ç«‹åˆ»è¿›è¡Œå›æ”¶ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»å¯¹è±¡éƒ½å‘å†…å­˜ç©ºé—´ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åå»æ¸…ç†è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚ æ ‡è®°æ•´ç†ç®—æ³•å’Œæ ‡è®°æ¸…é™¤ç®—æ³•çš„æœ¬è´¨å·®å¼‚åœ¨äºæ˜¯å¦ç§»åŠ¨å­˜æ´»çš„å¯¹è±¡ï¼Œæ ‡è®°æ¸…é™¤ç®—æ³•æ˜¯ä¸ç§»åŠ¨çš„ï¼Œè€Œæ ‡è®°æ•´ç†ç®—æ³•æ˜¯ç§»åŠ¨çš„ã€‚ æ˜¯å¦ç§»åŠ¨å­˜æ´»å¯¹è±¡æ˜¯ä¸€ä¸ªä¼˜ç¼ºç‚¹å¹¶å­˜çš„é£é™©å†³ç­–ã€‚å¦‚æœç§»åŠ¨å¯¹è±¡ï¼Œå°¤å…¶æ˜¯åœ¨è€å¹´ä»£è¿™ç§æ¯æ¬¡å›æ”¶éƒ½æœ‰å¤§é‡å¯¹è±¡å­˜æ´»çš„åŒºåŸŸï¼Œç§»åŠ¨å­˜æ´»å¯¹è±¡å¹¶æ›´æ–°æ‰€æœ‰å¼•ç”¨æ˜¯ä¸€ä¸ªæä¸ºè´Ÿé‡çš„æ“ä½œï¼Œè€Œä¸”è¿™ç§ç§»åŠ¨å¯¹è±¡æ“ä½œå¿…é¡»å…¨ç¨‹æš‚åœç”¨æˆ·çº¿ç¨‹æ‰èƒ½æ‰§è¡Œï¼Œè¿™ä¸ªæš‚åœè¢«ç§°ä¸ºStop The Worldã€‚å¦‚æœä¸ç§»åŠ¨å¯¹è±¡ï¼Œé‚£å¿…ç„¶ä¼šé€ æˆå†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œè€Œè¦è§£å†³å†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œå°±éœ€è¦ä¾èµ–æ›´ä¸ºå¤æ‚çš„å†…å­˜åˆ†é…å™¨å’Œå†…å­˜è®¿é—®å™¨æ¥è§£å†³ï¼Œæ— ç–‘åŠ é‡äº†å†…å­˜è®¿é—®çš„è´Ÿæ‹…ï¼Œä½¿ç¨‹åºçš„ååé‡é™ä½ã€‚æ‰€ä»¥ï¼Œæ— è®ºæ˜¯å¦ç§»åŠ¨å¯¹è±¡éƒ½å­˜åœ¨å¼Šç«¯ï¼Œç§»åŠ¨åˆ™å‡ºç°Stop The Worldï¼›ä¸ç§»åŠ¨åˆ™å¯ä»¥å¿½ç•¥Stop The Worldçš„æ—¶é—´ï¼Œä½†ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œä¸”ç¨‹åºååé‡é™ä½ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬3ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜","link":"/2020/07/23/javase/jvm/gc-algorithm/"},{"title":"åƒåœ¾æ”¶é›†å™¨","text":"å¦‚æœè¯´åƒåœ¾æ”¶é›†ç®—æ³•æ˜¯å†…å­˜å›æ”¶çš„æ–¹æ³•è®ºï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±æ˜¯å†…å­˜å›æ”¶çš„å®è·µè€…ã€‚æ ¹æ®åˆ†ä»£æ”¶é›†ç†è®ºï¼ŒHotSpotè™šæ‹Ÿæœºæä¾›äº†å¤šç§ä½œç”¨äºä¸åŒåˆ†ä»£çš„åƒåœ¾æ”¶é›†å™¨ï¼Œå®ƒä»¬æ˜¯ä¸åŒæ—¶ä»£çš„æ€æƒ³æ±‡èšã€‚ Serialæ–°ç”Ÿä»£æ”¶é›†å™¨æœ€åŸºç¡€ä¸”å†å²æœ€æ‚ ä¹…çš„æ”¶é›†å™¨ï¼Œæ›¾æ˜¯HotSpotè™šæ‹Ÿæœºæ–°ç”Ÿä»£åŒºåŸŸçš„å”¯ä¸€é€‰æ‹©ã€‚å®ƒé€‰ç”¨çš„æ˜¯æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œå•çº¿ç¨‹æ”¶é›†ï¼Œå½“å®ƒå¼€å§‹å·¥ä½œæ—¶ï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹å¿…é¡»æŒ‚èµ·ï¼Œç›´åˆ°å®ƒå›æ”¶å†…å­˜å®Œæ¯•ã€‚Stop The Worldæ— æ³•é¿å…ã€‚ä½†å¥½å¤„æ˜¯å•çº¿ç¨‹å·¥ä½œï¼Œå¯¹äºæ ¸æ•°è¾ƒå°‘çš„å¤„ç†å™¨æ¥è¯´ï¼Œæ²¡æœ‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼Œæ”¶é›†æ•ˆç‡é«˜ï¼Œé€‚ç”¨äºå®¢æˆ·ç«¯æ¨¡å¼çš„è™šæ‹Ÿæœºã€‚ Serial Oldè€å¹´ä»£æ”¶é›†å™¨ä¸Serialæ–°ç”Ÿä»£æ”¶é›†å™¨é…åˆä½¿ç”¨ï¼Œå›æ”¶è€å¹´ä»£ï¼ŒåŒæ ·ä½¿ç”¨å•çº¿ç¨‹æ”¶é›†ï¼Œé€‰ç”¨çš„æ˜¯æ ‡è®°-æ•´ç†ç®—æ³•ï¼Œé€‚ç”¨äºå®¢æˆ·ç«¯æ¨¡å¼çš„è™šæ‹Ÿæœºã€‚ ParNewæ–°ç”Ÿä»£æ”¶é›†å™¨ParNewæ–°ç”Ÿä»£æ”¶é›†å™¨å®è´¨æ˜¯Serialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹å¹¶è¡Œç‰ˆæœ¬ï¼Œåœ¨å¤šæ ¸å¤„ç†å™¨çš„è™šæ‹Ÿæœºä¸Šæ•ˆç‡ä¼šå¤§å¹…æé«˜ã€‚é€‰ç”¨çš„åŒæ ·æ˜¯æ ‡è®°-å¤åˆ¶ç®—æ³•ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šé™¤äº†Serialæ”¶é›†å™¨å¤–ï¼Œç›®å‰åªæœ‰å®ƒèƒ½ä¸CMSæ”¶é›†å™¨é…åˆå·¥ä½œã€‚å¤§éƒ¨åˆ†æœåŠ¡ç«¯æ¨¡å¼çš„è™šæ‹Ÿæœºé€‰ç”¨è¯¥æ”¶é›†å™¨å›æ”¶æ–°ç”Ÿä»£ã€‚ CMSè€å¹´ä»£æ”¶é›†å™¨CMS (Concurrent Mark Sweepï¼šå¹¶å‘æ ‡è®°-æ¸…é™¤)æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ï¼ˆStop The Worldï¼‰ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚å®ƒçš„å›æ”¶è¿‡ç¨‹åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š åˆå§‹æ ‡è®°ï¼ˆCMS initial markï¼‰ å¹¶å‘æ ‡è®°ï¼ˆCMS concurrent markï¼‰ é‡æ–°æ ‡è®°ï¼ˆCMS remarkï¼‰ å¹¶å‘æ¸…é™¤ï¼ˆCMS concurrent sweepï¼‰ åˆå§‹æ ‡è®°ï¼šæ ‡è®°GC Rootsèƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œä½†å­˜åœ¨Stop The Worldåœé¡¿ã€‚ å¹¶å‘æ ‡è®°ï¼šä»GC Rootsçš„ç›´æ¥å…³è”å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾ï¼Œè€—æ—¶è¾ƒé•¿ï¼Œä½†éå†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹å¯å¹¶å‘æ‰§è¡Œã€‚æ— Stop The Worldåœé¡¿ã€‚ é‡æ–°æ ‡è®°ï¼šä¿®æ­£å¹¶å‘æ ‡è®°é˜¶æ®µï¼Œç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œæ—¶å¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼ˆå¢é‡æ›´æ–°ï¼‰ï¼Œå­˜åœ¨Stop The Worldåœé¡¿ï¼Œä¸”ä¸€èˆ¬æ¯”åˆå§‹æ ‡è®°é˜¶æ®µåœé¡¿æ—¶é—´é•¿ã€‚ å¹¶å‘æ¸…é™¤ï¼šæ¸…ç†åˆ é™¤æ‰æ ‡è®°é˜¶æ®µåˆ¤æ–­ä¸ºä¸å¯è¾¾çš„å¯¹è±¡ï¼Œæ¸…ç†çº¿ç¨‹å¯ä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œã€‚ ç”±äºå­˜åœ¨å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤é˜¶æ®µï¼Œç”¨æˆ·çº¿ç¨‹åœ¨å¹¶å‘æ‰§è¡ŒæœŸé—´å®Œå…¨æœ‰å¯èƒ½äº§ç”Ÿæ–°çš„åƒåœ¾å¯¹è±¡ï¼Œä½†è¿™éƒ¨åˆ†å¯¹è±¡å‡ºç°åœ¨æ ‡è®°è¿‡ç¨‹ç»“æŸä¹‹åï¼Œæœ¬æ¬¡å›æ”¶æ— æ³•è¿›è¡Œå¤„ç†ï¼Œåªèƒ½ç­‰åˆ°ä¸‹ä¸€æ¬¡è€å¹´ä»£å†…å­˜å›æ”¶æ—¶æ‰èƒ½è¢«æ¸…ç†æ‰ï¼Œè¿™éƒ¨åˆ†åƒåœ¾è¢«ç§°ä¸ºâ€œæµ®åŠ¨åƒåœ¾â€ã€‚ åœ¨ç”¨æˆ·çº¿ç¨‹å’Œæ”¶é›†å™¨çº¿ç¨‹å¹¶å‘æ‰§è¡ŒæœŸé—´ï¼Œæ˜¯å¯èƒ½ä¼šæœ‰å¯¹è±¡éœ€è¦è¿›å…¥è€å¹´ä»£çš„ï¼Œè¿™æ—¶å°±éœ€è¦è€å¹´ä»£é¢„ç•™ä¸€å®šçš„å†…å­˜ç©ºé—´ã€‚åœ¨Java5çš„è™šæ‹Ÿæœºä¸­ï¼Œé»˜è®¤è®¾ç½®æ˜¯è€å¹´ä»£å†…å­˜ä½¿ç”¨äº†68%åå°±ä¼šè§¦å‘CMSæ”¶é›†å™¨å›æ”¶è€å¹´ä»£ã€‚è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¿å®ˆçš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨å‚æ•°-XX: CMSInitiatingOccu-pancyFractionæ¥è°ƒæ•´è¿™ä¸ªé»˜è®¤å€¼ã€‚åˆ°äº†Java6æ—¶ï¼Œé»˜è®¤è®¾ç½®æé«˜åˆ°äº†92%ï¼Œä½†è¿™åˆä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœCMSæ”¶é›†å™¨åœ¨å¹¶å‘æœŸé—´ï¼Œé¢„ç•™çš„å†…å­˜æ— æ³•æ»¡è¶³ç”¨æˆ·çº¿ç¨‹çš„éœ€è¦ï¼Œå°±ä¼šå‡ºç°ä¸€æ¬¡â€œå¹¶å‘å¤±è´¥â€ï¼Œè¿™æ—¶ï¼Œè™šæ‹Ÿæœºé‡‡ç”¨é™çº§ä¿æŠ¤æ–¹æ¡ˆï¼ŒæŒ‚èµ·ç”¨æˆ·çº¿ç¨‹ï¼ˆStop The Worldï¼‰ï¼Œä¸´æ—¶å¯ç”¨Serial Oldè€å¹´ä»£æ”¶é›†å™¨é‡æ–°è¿›è¡Œè€å¹´ä»£çš„å›æ”¶ã€‚æ€»çš„æ¥è¯´ï¼Œ-XX: CMSInitiatingOccu-pancyFractionè¿™ä¸ªå‚æ•°è®¾ç½®çš„å¤ªé«˜ä¼šå®¹æ˜“å‡ºç°â€œå¹¶å‘å¤±è´¥â€é—®é¢˜ï¼Œæ€§èƒ½ä¸å¢åé™ï¼›å¤ªä½åˆä¼šå¯¼è‡´å†…å­˜åˆ©ç”¨ç‡ä¸é«˜ï¼Œä¸”å›æ”¶é¢‘ç‡ä¼šä¸Šå‡ã€‚æ‰€ä»¥ï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒæ—¶åº”è°¨æ…è°ƒæ•´ã€‚ æ ‡è®°-æ¸…é™¤ç®—æ³•ä¸å¯é¿å…çš„é—®é¢˜å°±æ˜¯å†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œå½“è€å¹´ä»£å†…å­˜ç¢ç‰‡è¿‡å¤šæ—¶ï¼Œæ²¡æœ‰è¿ç»­ç©ºé—´æ¥å®¹çº³å¤§å¯¹è±¡ï¼Œå³ä½¿è¿˜æœ‰å¾ˆå¤šå†…å­˜æ²¡æœ‰ä½¿ç”¨ï¼Œè¿˜æ˜¯ä¼šè§¦å‘Full GCã€‚CMSæ”¶é›†å™¨æä¾›äº†ä¸€ä¸ª-XX: +UseCMS-CompactAtFullCollectionå¼€å…³å‚æ•°ï¼ˆé»˜è®¤å¼€å¯ï¼ŒJava9åºŸå¼ƒï¼‰ç”¨äºåœ¨CMSæ”¶é›†å™¨ä¸å¾—ä¸è¿›è¡ŒFull GCæ—¶å¼€å¯å†…å­˜ç¢ç‰‡çš„æ•´ç†è¿‡ç¨‹ï¼Œæ­¤è¿‡ç¨‹éœ€è¦ç§»åŠ¨å¯¹è±¡ï¼Œæ— æ³•è¿›è¡Œå¹¶å‘ï¼Œå‡ºç°Stop The Worldåœé¡¿ã€‚åŒæ—¶CMSæ”¶é›†å™¨è¿˜æä¾›äº†-XX: CMSFullGCsBefore-Compactionå‚æ•°ï¼ˆé»˜è®¤å€¼ä¸º0ï¼šæ¯æ¬¡Full GCéƒ½è¿›è¡Œç¢ç‰‡æ•´ç†ï¼‰è¦æ±‚æ”¶é›†å™¨åœ¨æ‰§è¡Œè¿‡æŒ‡å®šæ¬¡æ•°ä¸æ•´ç†ç¢ç‰‡çš„Full GCåï¼Œä¸‹ä¸€æ¬¡è¿›å…¥Full GCå‰å…ˆè¿›è¡Œç¢ç‰‡æ•´ç†ã€‚ Parallel Scavengeæ–°ç”Ÿä»£æ”¶é›†å™¨ååé‡ä¼˜å…ˆæ”¶é›†å™¨ã€‚é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ã€‚æä¾›å¼€å…³å‚æ•°-XX: +UseAdaptiveSizePolicyè®©è™šæ‹Ÿæœºæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒæ•´æ–°ç”Ÿä»£å¤§å°ã€Edenå’ŒSurvivoråŒºåŸŸæ¯”ä¾‹ç­‰å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–æœ€å¤§ååé‡ã€‚ Parallel Oldè€å¹´ä»£æ”¶é›†å™¨ååé‡ä¼˜å…ˆæ”¶é›†å™¨ã€‚é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ï¼Œå¤šçº¿ç¨‹å¹¶å‘æ”¶é›†ã€‚ä¸Parallel Scavengeæ–°ç”Ÿä»£æ”¶é›†å™¨æ­é…ä½¿ç”¨ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬3ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜","link":"/2020/07/23/javase/jvm/gcer/"},{"title":"å›æ”¶å‰çš„è‡ªæ•‘","text":"å³ä½¿åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­è¢«åˆ¤å®šä¸ºä¸å¯è¾¾çš„å¯¹è±¡ï¼Œä¹Ÿä¸æ˜¯â€œéæ­»ä¸å¯â€çš„ï¼Œè¿˜æœ‰ä¸€ç§è‡ªæ•‘çš„æ–¹æ³•ã€‚ è¦å®£å‘Šä¸€ä¸ªå¯¹è±¡å·²æ­»ï¼Œè‡³å°‘è¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ï¼šåœ¨è¢«å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤å®šä¸ºä¸å¯è¾¾åä¼šè¢«æ ‡è®°ä¸€æ¬¡ï¼›éšåä¼šå¯¹ä¸å¯è¾¾å¯¹è±¡è¿›è¡Œç­›é€‰ï¼Œç­›é€‰æ¡ä»¶æ˜¯è¯¥å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ï¼Œå¦‚æœå¯¹è±¡æ²¡æœ‰é‡å†™finalize()æ–¹æ³•ï¼Œæˆ–è€…finalize()åœ¨ä¸Šä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶è¢«è°ƒç”¨è¿‡ï¼Œåˆ™è¯¥å¯¹è±¡æ²¡æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ï¼Œä¼šè¢«ç¬¬äºŒæ¬¡æ ‡è®°ã€‚å¯¹è±¡å³è¢«åˆ¤å®šä¸ºäº†â€œæ­»äº¡â€ã€‚ å¦‚æœå¯¹è±¡è¢«åˆ¤å®šä¸ºæœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ï¼Œè™šæ‹Ÿæœºä¼šå°†è¯¥å¯¹è±¡æ”¾ç½®åœ¨ä¸€ä¸ªåä¸ºF-Queueçš„é˜Ÿåˆ—ä¹‹ä¸­ï¼Œå¹¶åœ¨ç¨åç”±ä¸€ä¸ªç”±è™šæ‹Ÿæœºè‡ªåŠ¨åˆ›å»ºçš„ã€ä½è°ƒåº¦ä¼˜å…ˆçº§çš„Finalizerçº¿ç¨‹å»æ‰§è¡Œå®ƒä»¬çš„finalize()æ–¹æ³•ã€‚è¿™é‡Œçš„æ‰§è¡Œæ˜¯è™šæ‹Ÿæœºä¼šè§¦å‘è¯¥æ–¹æ³•çš„å¼€å§‹æ‰§è¡Œï¼Œä½†ä¸ä¼šç­‰å¾…å®ƒä»¬æ‰§è¡Œç»“æŸã€‚åŸå› æ˜¯è¯¥æ–¹æ³•çš„æ–¹æ³•ä½“æ˜¯ç»è¿‡é‡å†™çš„ï¼Œæ— æ³•ä¿è¯ç«‹åˆ»æ‰§è¡Œç»“æŸï¼ˆç­‰å¾…æˆ–æ­»å¾ªç¯çš„æƒ…å†µï¼‰ï¼Œå¾ˆå¯èƒ½é€ æˆF-Queueé˜Ÿåˆ—ä¸­çš„å…¶å®ƒå¯¹è±¡æ°¸è¿œå¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¯¼è‡´æ•´ä¸ªåƒåœ¾å›æ”¶ç³»ç»Ÿå´©æºƒã€‚ finalize()æ–¹æ³•æ˜¯å¯¹è±¡é€ƒç¦»æ­»äº¡çš„æœ€åä¸€æ¬¡æœºä¼šï¼Œè§¦å‘æ‰§è¡Œåï¼Œåƒåœ¾æ”¶é›†å™¨å°†å¯¹F-Queueé˜Ÿåˆ—ä¸­çš„å¯¹è±¡è¿›è¡Œç¬¬äºŒæ¬¡å°è§„æ¨¡æ ‡è®°ï¼Œå¦‚æœå¯¹è±¡è¦åœ¨finalize()æ–¹æ³•ä¸­æ‹¯æ•‘è‡ªå·±â€”â€”åªéœ€é‡æ–°ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”å³å¯ï¼Œä¾‹å¦‚å°†è‡ªèº«ï¼ˆthisï¼‰èµ‹å€¼ç»™æŸä¸ªç±»å˜é‡æˆ–è€…æŸä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œé‚£åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶è¯¥å¯¹è±¡å°†è¢«ç§»å‡ºâ€œå³å°†å›æ”¶â€çš„é›†åˆï¼›å¦‚æœè¯¥å¯¹è±¡æ­¤æ—¶è¿˜æœªé€ƒè„±ï¼Œé‚£åŸºæœ¬å¯ä»¥è¯´å®ƒå·²ç»â€œæ­»äº†â€ã€‚ å¯¹è±¡è‡ªæ•‘ä»£ç æ¼”ç¤ºï¼š 12345678910111213141516171819202122232425262728293031323334353637383940public class FinalizeEscapeGc { public static FinalizeEscapeGc SAVE_HOOK = null; public void isAlive() { System.out.println(&quot;alive&quot;); } @Override protected void finalize() throws Throwable { super.finalize(); System.out.println(&quot;finalize&quot;); // å°†thisèµ‹å€¼ç»™å½“å‰ç±»çš„é™æ€å˜é‡è¿›è¡Œè‡ªæ•‘ FinalizeEscapeGc.SAVE_HOOK = this; } public static void main(String[] args) throws InterruptedException { SAVE_HOOK = new FinalizeEscapeGc(); // ç¬¬ä¸€æ¬¡ä¼šè¿›è¡Œè‡ªæ•‘ SAVE_HOOK = null; System.gc(); // Finalizerçº¿ç¨‹ä¼˜å…ˆçº§è¾ƒä½ï¼Œæš‚åœ0.5ç§’ä»¥ç­‰å¾…å®ƒ Thread.sleep(500); if (SAVE_HOOK != null) { SAVE_HOOK.isAlive(); } else { System.out.println(&quot;dead&quot;); } // ç¬¬äºŒæ¬¡è¢«åˆ¤å®šä¸ºâ€œæ­»äº¡â€ SAVE_HOOK = null; System.gc(); // Finalizerçº¿ç¨‹ä¼˜å…ˆçº§è¾ƒä½ï¼Œæš‚åœ0.5ç§’ä»¥ç­‰å¾…å®ƒ Thread.sleep(500); if (SAVE_HOOK != null) { SAVE_HOOK.isAlive(); } else { System.out.println(&quot;dead&quot;); } }} è¾“å‡ºç»“æœï¼š 123finalizealivedead å¯çœ‹åˆ°finalize()æ–¹æ³•è¢«æ‰§è¡Œäº†ï¼Œä¸”ç¬¬ä¸€æ¬¡â€œè‡ªæ•‘æˆåŠŸâ€ï¼Œç¬¬äºŒæ¬¡åˆ™å½»åº•â€œæ­»äº¡â€ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬3ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜","link":"/2020/07/20/javase/jvm/finalize-before-gc/"},{"title":"å¯¹è±¡æ˜¯â€œç”Ÿâ€æ˜¯â€œæ­»â€","text":"ç®€ä»‹åƒåœ¾æ”¶é›†å™¨å¯¹å †å†…å­˜è¿›è¡Œå›æ”¶æ—¶ï¼Œé¦–å…ˆè¦åˆ¤æ–­å †ä¸­çš„å¯¹è±¡æ˜¯å¦è¿˜å­˜æ´»ã€‚ å¯¹è±¡æ˜¯â€œç”Ÿå­˜â€è¿˜æ˜¯â€œæ­»äº¡â€ï¼Ÿè¿™æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ç»å…¸çš„åˆ¤æ–­ç®—æ³•æ˜¯å¼•ç”¨è®¡æ•°æ³•ï¼Œä½†å­˜åœ¨ä¸€å®šç¼ºé™·ã€‚ç°ä»£è™šæ‹Ÿæœºæ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»ã€‚ å¼•ç”¨è®¡æ•°ç®—æ³•å¼•ç”¨è®¡æ•°æ³•æ˜¯ä¸€ä¸ªå¾ˆå¥½ç†è§£çš„ç®—æ³•ã€‚åœ¨å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡æ—¶ï¼Œå°±å°†è®¡æ•°å™¨å€¼åŠ ä¸€ï¼›å½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨å€¼å‡ä¸€ã€‚ä»»ä½•æ—¶åˆ»è®¡æ•°å™¨å€¼ä¸ºé›¶çš„å¯¹è±¡å¯è®¤ä¸ºæ˜¯â€œæ­»äº¡â€çš„ã€‚ ä¸€åˆ‡éƒ½çœ‹ä¼¼å¾ˆæ­£å¸¸ï¼Œä½†å®é™…ä¸Šå­˜åœ¨å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚è¯·çœ‹ä»¥ä¸‹ä»£ç ï¼š 1234567891011121314151617public class ReferenceCountingGc { public Object instance; private byte[] bigSize = new byte[2 * 1024 * 1024]; public static void testGc() { ReferenceCountingGc objA = new ReferenceCountingGc(); ReferenceCountingGc objB = new ReferenceCountingGc(); objA.instance = objB; objB.instance = objA; objA = null; objB = null; System.gc(); } public static void main(String[] args) { testGc(); }} åˆ†æï¼štestGc()æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼ŒJVMåŒæ­¥åˆ›å»ºä¸€ä¸ªæ ˆå¸§å‹å…¥å½“å‰æ‰§è¡Œçº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆä¸­ï¼Œéšåï¼Œè™šæ‹Ÿæœºæ ˆä¸­å­˜åœ¨ä¸¤ä¸ªå¼•ç”¨objAå’ŒobjBåˆ†åˆ«æŒ‡å‘å †å†…çš„ä¸¤ä¸ªnew ReferenceCountingGc()å¯¹è±¡ï¼Œç„¶åï¼Œå †å†…ä¸¤ä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡instanceäº’ç›¸æŒ‡å‘å¯¹æ–¹ï¼Œå†ç„¶åï¼Œå°†è™šæ‹Ÿæœºæ ˆå†…çš„å¼•ç”¨æŒ‡å‘nullï¼Œæœ€åè§¦å‘gcã€‚æ­¤æ—¶ï¼Œå †å†…çš„è¿™ä¸¤ä¸ªå¯¹è±¡äº’ç›¸å¼•ç”¨ç€å¯¹æ–¹ï¼Œå¼•ç”¨è®¡æ•°å™¨çš„å€¼ä¸ä¸ºé›¶ï¼Œä½†å®ƒä»¬å·²ç»æ— æ³•å†ç”±ç¨‹åºè¿›è¡Œè®¿é—®äº†ï¼Œæ‰€ä»¥å¦‚æœé‡‡ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡å°†æ— æ³•è¢«å›æ”¶ï¼Œå³ä¼šå‡ºç°å†…å­˜æ³„éœ²é—®é¢˜ã€‚ å¯è¾¾æ€§åˆ†æç®—æ³•ç°ä»£æ ‡å‡†è™šæ‹Ÿæœºéƒ½æ˜¯é‡‡ç”¨å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»ã€‚åŸºæœ¬æ€è·¯æ˜¯é€šè¿‡ä¸€ç³»åˆ—ç§°ä¸ºGC Rootsçš„æ ¹å¯¹è±¡ä½œä¸ºèµ·å§‹èŠ‚ç‚¹é›†ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹ï¼Œæ ¹æ®å¼•ç”¨å…³ç³»å‘ä¸‹æœç´¢ï¼Œæœç´¢è¿‡ç¨‹æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºâ€œå¼•ç”¨é“¾â€ï¼Œå¦‚æœæŸä¸ªå¯¹è±¡åˆ°GC Rootsé—´æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼Œåˆ™ç§°è¯¥å¯¹è±¡æ˜¯ä¸å¯è¾¾çš„ï¼Œå³éœ€è¦è¢«å›æ”¶ã€‚ åœ¨JavaæŠ€æœ¯ä½“ç³»é‡Œï¼Œå›ºå®šå¯ä½œä¸ºGC Rootsçš„å¯¹è±¡åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š åœ¨è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ï¼Œä¾‹å¦‚å„ä¸ªçº¿ç¨‹è¢«è°ƒç”¨çš„æ–¹æ³•å †æ ˆä¸­ä½¿ç”¨åˆ°çš„å‚æ•°ã€å±€éƒ¨å˜é‡ã€ä¸´æ—¶å˜é‡ç­‰ã€‚ åœ¨æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ï¼Œå³ä¸€ä¸ªJavaç±»çš„å¼•ç”¨ç±»å‹é™æ€å˜é‡ã€‚ åœ¨æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å¼•ç”¨ã€‚ åœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­æœ¬åœ°Nativeæ–¹æ³•å¼•ç”¨çš„å¯¹è±¡ã€‚ è™šæ‹Ÿæœºå†…éƒ¨çš„å¼•ç”¨ï¼Œä¾‹å¦‚åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„Classå¯¹è±¡ï¼›ä¸€äº›å¸¸é©»çš„å¼‚å¸¸ç±»å¯¹è±¡ï¼Œä¾‹å¦‚NullPointExceptionå’ŒOutOfMemoryErrorç­‰ï¼Œå¦å¤–è¿˜æœ‰ç³»ç»Ÿç±»åŠ è½½å™¨ç±»å¯¹è±¡ã€‚ æ‰€æœ‰è¢«åŒæ­¥é”ï¼ˆsynchronizedï¼‰æŒæœ‰çš„å¯¹è±¡ã€‚ ååº”è™šæ‹Ÿæœºå†…éƒ¨æƒ…å†µçš„JMXBeanã€JVMTIä¸­æ³¨å†Œçš„å›è°ƒå’Œæœ¬åœ°ä»£ç ç¼“å­˜ç­‰ã€‚ ä»¥ä¸Šæ˜¯å›ºå®šä½œä¸ºGC RootsèŠ‚ç‚¹é›†çš„å¯¹è±¡ï¼Œä½†è™šæ‹Ÿæœºè¿˜ä¼šæ ¹æ®æ‰€é€‰åƒåœ¾æ”¶é›†å™¨å’Œå½“å‰è¿›è¡Œåƒåœ¾å›æ”¶çš„å†…å­˜åŒºåŸŸï¼Œå¯ä»¥å°†ä¸€äº›å…¶å®ƒå¯¹è±¡â€œä¸´æ—¶æ€§â€åœ°åŠ å…¥èŠ‚ç‚¹é›†ï¼Œå…±åŒç»„æˆå®Œæ•´çš„GC Rootsé›†åˆï¼Œç¡®ä¿å¯è¾¾æ€§åˆ†æçš„æ­£ç¡®æ€§ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬3ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜","link":"/2020/07/20/javase/jvm/object-is-alive-or-dead/"},{"title":"Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•è¿è¡Œå­—èŠ‚ç çš„","text":"ä¸ºä»€ä¹ˆJavaç¨‹åºè¦åœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼ŸJavaç¨‹åºçš„è¿è¡Œç¦»ä¸å¼€Javaè¿è¡Œæ—¶ç¯å¢ƒï¼Œåˆç§°ä¸ºJREï¼Œå®ƒæ˜¯Javaç¨‹åºçš„æœ€å°å¯è¿è¡Œç¯å¢ƒï¼ŒåŒ…å«Javaè™šæ‹Ÿæœºå’ŒJavaçš„æ ¸å¿ƒç±»åº“ã€‚æˆ‘ä»¬æ¯å¤©éƒ½åœ¨æ¥è§¦çš„JDKå®é™…ä¸Šå°±åŒ…å«äº†JREï¼ŒåŒæ—¶åœ¨/binç›®å½•ä¸‹è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„å°å·¥å…·ç­‰ã€‚ å®ƒä»¬çš„èŒƒå›´å¤§å°æ¯”è¾ƒå…³ç³»æ˜¯ï¼šJDK &gt; JRE &gt; JVMã€‚ å¯¹äºè™šæ‹Ÿæœºæ¥è¯´ï¼Œå®ƒæ‰€èƒ½è¿è¡Œçš„æ˜¯ä»¥.classç»“å°¾çš„å­—èŠ‚ç æ–‡ä»¶ï¼Œæˆ‘ä»¬å¹³æ—¶å†™çš„.javaæºæ–‡ä»¶éƒ½éœ€è¦ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘æˆå­—èŠ‚ç ã€‚ é€šä¿—ä¸€ç‚¹è¯´ï¼Œè™šæ‹Ÿæœºåªè®¤å­—èŠ‚ç ï¼Œä¸ç®¡ä½ æ˜¯ä¸æ˜¯Javaè¯­è¨€ï¼Œåªè¦ä½ èƒ½ç¼–è¯‘æˆå­—èŠ‚ç å°±èƒ½åœ¨æˆ‘çš„è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼Œä¾‹å¦‚Scalaè¯­è¨€ï¼Œå®ƒå¯ä»¥è¢«ç¼–è¯‘æˆå­—èŠ‚ç è¿è¡Œåœ¨Javaè™šæ‹Ÿæœºä¸Šï¼Œä¸”å¯ä»¥è°ƒç”¨Javaçš„æ‰€æœ‰ç±»åº“ã€‚ å­—èŠ‚ç çš„æ„ä¹‰åœ¨äºä»€ä¹ˆå‘¢ï¼Ÿåœ¨äºåªè¦æœ‰äº†å­—èŠ‚ç ï¼Œå°±å¯ä»¥åœ¨ä¸åŒå¹³å°çš„è™šæ‹Ÿæœºå®ç°ä¸Šè¿è¡Œï¼Œå³ï¼šâ€œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚ è™šæ‹Ÿæœºçš„å¦ä¸€ä¸ªç‰¹ç‚¹æ˜¯å®ƒèƒ½å¤Ÿè¿›è¡Œè‡ªåŠ¨å†…å­˜ç®¡ç†å’Œåƒåœ¾å›æ”¶ï¼Œä¸åƒC++è¯­è¨€é‚£æ ·éœ€è¦å¼€å‘è€…æ‰‹åŠ¨è¿›è¡Œå†…å­˜çš„åˆ†é…ä¸å›æ”¶ï¼Œè¿™ä¸€ç‚¹æœ‰åˆ©ä¹Ÿæœ‰å¼Šï¼Œâ€œåˆ©â€æ˜¯æ–¹ä¾¿äº†å¼€å‘è€…ï¼Œæ— éœ€è¿‡å¤šå…³æ³¨å†…å­˜ï¼Œå°†ç²¾åŠ›æ”¾åœ¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘ä¸Šï¼›â€œå¼Šâ€æ˜¯å¯èƒ½ä¼šç”±äºå¼€å‘è€…çš„å°å¤±è¯¯ï¼Œå¯¼è‡´å†…å­˜æº¢å‡ºï¼Œä»è€Œä½¿ç¨‹åºå´©æºƒã€‚äºæ˜¯å†…å­˜ç®¡ç†å’Œåƒåœ¾å›æ”¶å‡ºç°äº†ä¸€äº›å¯ä»¥è°ƒä¼˜çš„åœ°æ–¹ã€‚ è™šæ‹Ÿæœºæ˜¯å¦‚ä½•è¿è¡Œå­—èŠ‚ç çš„ï¼Ÿä»è™šæ‹Ÿæœºè§†è§’çœ‹ï¼Œæ‰§è¡ŒJavaä»£ç é¦–å…ˆéœ€è¦å°†å®ƒè¢«ç¼–è¯‘è€Œæˆçš„.classå­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°Javaè™šæ‹Ÿæœºä¸­ï¼ŒåŠ è½½åçš„Javaç±»ä¼šè¢«å­˜æ”¾è‡³æ–¹æ³•åŒºä¸­ï¼Œå®é™…è¿è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºä¼šæ‰§è¡Œæ–¹æ³•åŒºå†…çš„ä»£ç ã€‚ å¯¹äºè™šæ‹Ÿæœºæ¥è¯´ï¼Œåœ¨å®é™…è¿è¡Œæ—¶ä¼šæŠŠå®ƒæ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚è¿™äº›åŒºåŸŸæœ‰å„è‡ªçš„ç”¨é€”ï¼Œä»¥åŠåˆ›å»ºå’Œé”€æ¯çš„æ—¶é—´ï¼Œæœ‰äº›åŒºåŸŸçš„ç”Ÿå‘½å‘¨æœŸå’Œè™šæ‹Ÿæœºè¿›ç¨‹ä¸€è‡´ï¼Œè€Œæœ‰äº›åŒºåŸŸçš„ç”Ÿå‘½å‘¨æœŸå’Œç”¨æˆ·çº¿ç¨‹ä¿æŒä¸€è‡´ã€‚ è¿è¡Œæ—¶æ•°æ®åŒºåŸŸæ ¹æ®ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹çš„è§„å®šï¼Œè¿è¡Œæ—¶æœŸè™šæ‹Ÿæœºå†…éƒ¨åŒºåŸŸåˆ’åˆ†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸è¯´çš„JVMå†…å­˜æ¨¡å‹ã€‚ä¸‹é¢æˆ‘ä»¬å¯¹æ¯ä¸ªåŒºåŸŸè¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚ ç¨‹åºè®¡æ•°å™¨ è¿™æ˜¯ä¸€å—æ¯”è¾ƒå°çš„å†…å­˜åŒºåŸŸï¼Œç®€å•çš„ç†è§£å°±æ˜¯è®°å½•äº†å½“å‰çº¿ç¨‹æ­£åœ¨è¿è¡Œçš„å­—èŠ‚ç çš„è¡Œæ•°ã€‚å¯¹äºå•æ ¸CPUæ¥è¯´ï¼Œå®ç°å¤šçº¿ç¨‹çš„æ–¹å¼æ˜¯è¿›è¡Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œçº¿ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­è¢«æŒ‚èµ·ï¼Œå½“å†æ¬¡åˆ‡æ¢å›æ¥æ—¶éœ€è¦å›åˆ°ä¹‹å‰è¿è¡Œçš„ä½ç½®ï¼Œç¨‹åºè®¡æ•°å™¨å°±æ˜¯æ¥è®°å½•è¯¥ä½ç½®çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œæ¯ä¸ªçº¿ç¨‹å„è‡ªè®°å½•å„è‡ªçš„ï¼Œä¸ä¼šå‡ºç°OutOfMemoryErroré”™è¯¯ï¼Œå®ƒæ˜¯çº¿ç¨‹éš”ç¦»çš„æ•°æ®åŒºã€‚ è™šæ‹Ÿæœºæ ˆ è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„çº¿ç¨‹å†…å­˜æ¨¡å‹ï¼Œåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¯å½“è°ƒç”¨ä¸€ä¸ªJavaæ–¹æ³•ï¼Œè™šæ‹Ÿæœºä¼šåœ¨å½“å‰çº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆä¸­åŒæ­¥åˆ›å»ºä¸€ä¸ªæ ˆå¸§ç”¨æ¥å­˜å‚¨è¯¥æ–¹æ³•çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€è¿æ¥å’Œæ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚å½“é€€å‡ºå½“å‰è°ƒç”¨çš„æ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºæ ˆä¼šå¼¹å‡ºè¯¥æ ˆå¸§ï¼Œæ— è®ºæ˜¯æ­£å¸¸è¿”å›è¿˜æ˜¯å¼‚å¸¸é€€å‡ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€ä¸ªJavaæ–¹æ³•çš„è°ƒç”¨åˆ°ç»“æŸéƒ½å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨å½“å‰çº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ã€‚ å±€éƒ¨å˜é‡è¡¨å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„JavaåŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å¼•ç”¨å’ŒreturnAddressç±»å‹ï¼ˆæŒ‡å‘æ–¹æ³•returnè¿”å›åå°†è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼‰ã€‚å…¶ä¸­åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆboolean/byte/char/short/int/float/long/doubleï¼‰åœ¨å±€éƒ¨å˜é‡è¡¨ä¸­ä»¥å±€éƒ¨å˜é‡æ§½çš„å½¢å¼è¡¨ç¤ºï¼Œé•¿åº¦ä¸º64çš„doubleå’Œlongç±»å‹ä¼šå ç”¨ä¸¤ä¸ªå˜é‡æ§½ï¼Œå…¶ä½™çš„éƒ½åªä¼šå ç”¨ä¸€ä¸ªå˜é‡æ§½ã€‚å½“ä¸€ä¸ªæ–¹æ³•å¼€å§‹æ‰§è¡Œæ—¶ï¼Œæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨å†…å­˜å¤§å°å°±å·²ç»ç¡®å®šäº†ï¼Œä¸ä¼šåœ¨è¿è¡ŒæœŸé—´åŠ¨æ€æ”¹å˜ã€‚ å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ ˆæ‰€å…è®¸çš„æ·±åº¦ï¼ˆé€’å½’è°ƒç”¨ï¼‰ï¼Œå°†æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ï¼›å¦‚æœçº¿ç¨‹ç”³è¯·æ ˆç©ºé—´æ—¶ç©ºé—´ä¸è¶³ï¼Œåˆ™ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ æœ¬åœ°æ–¹æ³•æ ˆ æœ¬åœ°æ–¹æ³•æ ˆæè¿°çš„æ˜¯æœ¬åœ°Nativeæ–¹æ³•æ‰§è¡Œçš„çº¿ç¨‹æ¨¡å‹ï¼Œå…¶ä½œç”¨ä¸è™šæ‹Ÿæœºæ ˆä¸€è‡´ã€‚ å † å †å†…å­˜æ˜¯è™šæ‹Ÿæœºç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸå’Œè™šæ‹Ÿæœºè¿›ç¨‹ä¿æŒä¸€è‡´ã€‚æœ‰ä¸€å¥è¯æ˜¯è¿™æ ·è¯´çš„ï¼šâ€œnewå‡ºæ¥çš„å¯¹è±¡éƒ½åœ¨å †ä¸Šâ€ã€‚å †å†…å­˜æ˜¯åƒåœ¾æ”¶é›†å™¨æ‰€ç®¡ç†çš„å†…å­˜åŒºåŸŸï¼Œç°ä»£åƒåœ¾æ”¶é›†å™¨å¤§éƒ¨åˆ†æ˜¯åŸºäºåˆ†ä»£æ”¶é›†ç†è®ºè®¾è®¡çš„ï¼Œæ‰€ä»¥å †å†…å­˜åˆè¢«ç»†åˆ†ä¸ºâ€œæ–°ç”Ÿä»£â€ã€â€œè€å¹´ä»£â€ã€â€œæ°¸ä¹…ä»£â€ã€â€œEdenåŒºâ€ã€â€œFrom SurvivoråŒºâ€å’Œâ€œTo SurvivoråŒºâ€ã€‚å†æ¬¡ç»†åˆ’å‡ºè¿™äº›åŒºåŸŸçš„åŸå› åªæ˜¯ä¸ºäº†æ›´å¥½çš„çš„åˆ†é…å’Œå›æ”¶å†…å­˜ã€‚ å †å†…å­˜æ˜¯æ”¯æŒæ‰©å±•çš„ï¼Œå¯é€šè¿‡å‚æ•°-Xmxï¼ˆæœ€å¤§å †å†…å­˜ï¼‰å’Œ-Xmsï¼ˆæœ€å°å †å†…å­˜ï¼‰è®¾ç½®ã€‚ä¸ºäº†é¿å…GCåå †å†…å­˜é‡æ–°åˆ†é…ï¼Œé€šå¸¸å°†ä¸¤è€…çš„å€¼è®¾ä¸ºä¸€æ ·ã€‚ æ–¹æ³•åŒº æ–¹æ³•åŒºæ˜¯å­˜æ”¾å­—èŠ‚ç çš„å†…å­˜åŒºåŸŸï¼Œå½“ä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶è¢«åŠ è½½åï¼Œä¼šå°†å…¶å¯¹åº”ç±»å‹ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡å’Œå³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç¼“å­˜ç­‰æ•°æ®ä¿å­˜è‡³æ–¹æ³•åŒºã€‚ è¯´åˆ°æ–¹æ³•åŒºï¼Œä¸å¾—ä¸è¯´åˆ°æ°¸ä¹…ä»£çš„æ¦‚å¿µï¼Œåœ¨è™šæ‹Ÿæœºçš„æ—©æœŸå®ç°ä¸­ï¼Œæ ‡å‡†HotSpotè™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†å™¨æ‰€ç®¡ç†çš„å†…å­˜åŒºåŸŸåŒ…å«äº†æ–¹æ³•åŒºï¼Œæ‰€ä»¥æ–¹æ³•åŒºåˆè¢«ç§°ä¸ºæ°¸ä¹…ä»£ï¼Œä½†å®é™…ä¸ŠHotSpotè™šæ‹Ÿæœºåªæ˜¯ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºï¼Œä¸ºäº†çœå»ä¸“é—¨ä¸ºæ–¹æ³•åŒºæä¾›å†…å­˜ç®¡ç†çš„å·¥ä½œã€‚åœ¨Java6æ—¶ä»£ï¼Œæ°¸ä¹…ä»£å°±è¢«æ”¾å¼ƒäº†ï¼Œæ”¹ä¸ºä½¿ç”¨æœ¬åœ°å†…å­˜æ¥å®ç°æ–¹æ³•åŒºã€‚åˆ°Java7æ—¶ï¼ŒåŸæœ¬å­˜æ”¾åœ¨æ°¸ä¹…ä»£çš„å­—ç¬¦ä¸²å¸¸é‡æ± å’Œé™æ€å˜é‡è¢«ç§»åŠ¨åˆ°å †å†…å­˜ä¸­ã€‚è€Œåˆ°äº†Java8æ—¶ï¼Œæ°¸ä¹…ä»£å®Œå…¨è¢«æŠ›å¼ƒï¼Œå–è€Œä»£ä¹‹çš„æ˜¯æœ¬åœ°å†…å­˜ä¸­çš„å…ƒç©ºé—´ï¼ŒåŸæœ¬å­˜åœ¨äºæ°¸ä¹…ä»£ä¸­çš„ç±»å‹ä¿¡æ¯å’Œä»£ç ç¼“å­˜ç­‰æ•°æ®è¢«ç§»åˆ°äº†å…ƒç©ºé—´ä¸­ã€‚ è¿è¡Œæ—¶å¸¸é‡æ±  è¿è¡Œæ—¶å¸¸é‡æ± å±äºæ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå­˜æ”¾çš„æ˜¯å¸¸é‡æ± è¡¨ï¼ŒåŒ…å«å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚è¯¥å†…å­˜åŒºåŸŸå¯ä»¥åœ¨è¿è¡ŒæœŸåŠ¨æ€æ”¹å˜ï¼Œå¸¸ç”¨çš„æ˜¯Stringç±»çš„intern()æ–¹æ³•ï¼Œå—æ–¹æ³•åŒºå†…å­˜å¤§å°é™åˆ¶ï¼Œè¯¥åŒºåŸŸä¹Ÿä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ å­—èŠ‚ç å¦‚ä½•è¢«æ‰§è¡Œï¼Ÿå¯¹äºHotSpotè™šæ‹Ÿæœºæ¥è¯´ï¼Œå®ƒæ‰€åšçš„å·¥ä½œæ˜¯å°†å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç ã€‚è€Œç¿»è¯‘æœ‰ä¸¤ç§å½¢å¼ï¼šç¬¬ä¸€ç§æ˜¯è§£é‡Šæ‰§è¡Œï¼Œé€æ¡å°†å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç å¹¶æ‰§è¡Œï¼›ç¬¬äºŒç§æ˜¯å³æ—¶ç¼–è¯‘ï¼Œå°†ä¸€ä¸ªæ–¹æ³•æ‰€åŒ…å«çš„æ‰€æœ‰å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç åå†æ‰§è¡Œã€‚ å‰è€…çš„ä¼˜ç‚¹æ˜¯æ— éœ€ç­‰å¾…ç¼–è¯‘ï¼Œè€Œåè€…çš„ä¼˜ç‚¹æ˜¯å®é™…è¿è¡Œé€Ÿåº¦æ›´å¿«ã€‚HotSpotè™šæ‹Ÿæœºé‡‡ç”¨äº†æ··åˆæ¨¡å¼ï¼Œç»¼åˆä¸¤ç§å½¢å¼ï¼Œå…ˆè§£é‡Šæ‰§è¡Œå­—èŠ‚ç ï¼Œé€šè¿‡çƒ­ç‚¹ä»£ç æ¢æµ‹æŠ€æœ¯å‘ç°çƒ­ç‚¹ä»£ç åï¼Œä»¥æ–¹æ³•ä¸ºå•ä½è¿›è¡Œå³æ—¶ç¼–è¯‘ã€‚ HotSpotè™šæ‹ŸæœºåŒ…å«å¤šä¸ªå³æ—¶ç¼–è¯‘å™¨ï¼šC1å’ŒC2ç­‰ã€‚ C1åˆå«åšClientç¼–è¯‘å™¨ï¼Œé¢å‘çš„æ˜¯å¯¹å¯åŠ¨æ€§èƒ½æœ‰è¦æ±‚çš„å®¢æˆ·ç«¯GUIç¨‹åºï¼Œé‡‡ç”¨çš„ä¼˜åŒ–æ‰‹æ®µç›¸å¯¹ç®€å•ï¼Œå› æ­¤ç¼–è¯‘æ—¶é—´è¾ƒçŸ­ã€‚ C2åˆå«åšServerç¼–è¯‘å™¨ï¼Œé¢å‘çš„æ˜¯å¯¹å³°å€¼æ€§èƒ½æœ‰è¦æ±‚çš„æœåŠ¡ç«¯ç¨‹åºï¼Œé‡‡ç”¨çš„ä¼˜åŒ–æ‰‹æ®µç›¸å¯¹å¤æ‚ï¼Œå› æ­¤ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œä½†ç”Ÿæˆçš„æœºå™¨ç çš„æ‰§è¡Œæ•ˆç‡æ›´é«˜ã€‚ ä»Java7å¼€å§‹ï¼ŒHotSpoté‡‡ç”¨åˆ†å±‚ç¼–è¯‘ï¼šçƒ­ç‚¹æ–¹æ³•é¦–å…ˆä¼šè¢«C1ç¼–è¯‘ï¼Œç„¶åçƒ­ç‚¹æ–¹æ³•ä¸­çš„çƒ­ç‚¹ä¼šè¿›ä¸€æ­¥è¢«C2ç¼–è¯‘ã€‚ä¸ºäº†ä¸å½±å“ç¨‹åºçš„æ­£å¸¸è¿è¡Œï¼Œçƒ­ç‚¹æ–¹æ³•çš„ç¼–è¯‘æ˜¯æ”¾åœ¨å­çº¿ç¨‹ä¸­è¿›è¡Œçš„ã€‚HotSpotä¼šæ ¹æ®CPUçš„æ ¸æ•°è®¾ç½®å³æ—¶ç¼–è¯‘çš„çº¿ç¨‹æ•°ï¼Œå¹¶æŒ‰ç…§1:2çš„æ¯”ä¾‹åˆ†é…ç»™C1å’ŒC2ç¼–è¯‘å™¨ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬3ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜ ã€Šæ·±å…¥æ‹†è§£Javaè™šæ‹Ÿæœºã€‹ - æå®¢æ—¶é—´","link":"/2020/07/20/javase/jvm/run-class/"},{"title":"ä½•ä¸ºå¼•ç”¨","text":"æ— è®ºæ˜¯é€šè¿‡å¼•ç”¨è®¡æ•°ç®—æ³•è¿˜æ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»éƒ½ç¦»ä¸å¼€â€œå¼•ç”¨â€è¿™ä¸ªæ¦‚å¿µï¼Œé‚£åˆ°åº•ä»€ä¹ˆæ˜¯â€œå¼•ç”¨â€å‘¢ï¼Ÿ Javaè¯­è¨€ä¸­ç‹­éš˜çš„â€œå¼•ç”¨â€å®šä¹‰æ˜¯ï¼šå¦‚æœReferenceç±»å‹çš„æ•°æ®ä¸­å­˜å‚¨çš„æ•°å€¼ä»£è¡¨çš„æ˜¯å¦ä¸€å—å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€ï¼Œå°±ç§°è¯¥Referenceæ•°æ®æ˜¯ä»£è¡¨æŸå—å†…å­˜ï¼ˆæŸä¸ªå¯¹è±¡ï¼‰çš„å¼•ç”¨ã€‚åœ¨è¿™ç§å®šä¹‰ä¸‹ï¼Œä¸€ä¸ªå¯¹è±¡åªå­˜åœ¨ä¸¤ç§çŠ¶æ€ï¼šâ€œè¢«å¼•ç”¨â€/â€œæœªè¢«å¼•ç”¨â€ã€‚è¿™æ ·çš„å®šä¹‰å¾ˆä¸¥è°¨ï¼Œä½†å´ç¼ºå°‘äº†ä¸€ç‚¹çµæ´»çš„ç©ºé—´ï¼Œå°±åƒè¿™ä¸ªç¤¾ä¼šä¸€æ ·ï¼Œä¸æ˜¯æ‰€æœ‰äººéƒ½å€¼å¾—æ´»ç€ï¼Œé‚£äº›äººæ°‘å­å¼Ÿå…µå€¼å¾—æ°¸è¿œå­˜åœ¨ï¼Œä½†é‚£äº›çŠ¯ç½ªçš„æ¶å¾’å¤šæ´»ä¸€ç§’éƒ½æ˜¯å¯¹ç¤¾ä¼šçš„æ±¡æŸ“ã€‚åœ¨Javaä¸­ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå †ä¸Šçš„å¯¹è±¡ä¸æ˜¯æ‰€æœ‰çš„éƒ½æ˜¯å¿…é¡»çš„ï¼Œå½“å†…å­˜ç©ºé—´å‡ºç°ç´§å¼ æ—¶ï¼Œä¸€äº›å¯¹è±¡å°†ä¼šè¢«æŠ›å¼ƒã€‚ åœ¨JDK 1.2ç‰ˆæœ¬åï¼ŒJavaä¸­çš„å¼•ç”¨åˆ†ä¸ºå››ç§ç±»å‹ï¼šå¼ºå¼•ç”¨ï¼ˆStrongly Referenceï¼‰ã€è½¯å¼•ç”¨ï¼ˆSoft Referenceï¼‰ã€å¼±å¼•ç”¨ï¼ˆWeak Referenceï¼‰å’Œè™šå¼•ç”¨ï¼ˆPhantom Referenceï¼‰ï¼Œè¿™å››ç§å¼•ç”¨å¼ºåº¦ä¾æ¬¡å‡å¼±ã€‚ å¼ºå¼•ç”¨ï¼ˆStrongly Referenceï¼‰ å¼ºå¼•ç”¨æ˜¯ç‹­éš˜çš„å¼•ç”¨å®šä¹‰ï¼Œè¢«å¼•ç”¨çš„å¯¹è±¡åªä¼šå‡ºç°ä¸¤ç§çŠ¶æ€ï¼šâ€œè¢«å¼•ç”¨â€å’Œâ€œæœªè¢«å¼•ç”¨â€ã€‚è¿™ç§å¼•ç”¨å…³ç³»å¾ˆå¸¸è§ï¼Œå³ç±»ä¼¼äºObject obj = new Object()è¿™ç§ç›´æ¥èµ‹å€¼çš„ï¼Œåªè¦å¼ºå¼•ç”¨å…³ç³»è¿˜åœ¨ï¼Œå †å†…çš„å¯¹è±¡å°±æ°¸è¿œä¸ä¼šè¢«å›æ”¶ã€‚ è½¯å¼•ç”¨ï¼ˆSoft Referenceï¼‰ è½¯å¼•ç”¨æè¿°çš„æ˜¯è¿˜æœ‰ç”¨ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„ä¸€ç±»å¯¹è±¡ã€‚åªè¢«è½¯å¼•ç”¨å…³è”ç€çš„å¯¹è±¡åœ¨è™šæ‹Ÿæœºå°†è¦å‘ç”Ÿå†…å­˜æº¢å‡ºå‰ï¼Œä¼šå°†è¿™ç±»å¯¹è±¡åˆ—è¿›å›æ”¶èŒƒå›´ä¹‹ä¸­è¿›è¡ŒäºŒæ¬¡å›æ”¶ï¼Œå¦‚æœå°†å®ƒä»¬å›æ”¶å®Œæˆåå†…å­˜è¿˜æ˜¯ä¸è¶³ï¼Œæ‰ä¼šæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚Javaä¸­æä¾›SoftReferenceç±»å®ç°è½¯å¼•ç”¨ã€‚ å¼±å¼•ç”¨ï¼ˆWeak Referenceï¼‰ å¼±å¼•ç”¨æè¿°çš„ä¹Ÿæ˜¯é‚£äº›éå¿…é¡»å¯¹è±¡ï¼Œä½†å®ƒçš„å¼ºåº¦æ¯”è½¯å¼•ç”¨è¦å¼±ä¸€ç‚¹ï¼Œè¢«å¼±å¼•ç”¨å…³è”ç€çš„å¯¹è±¡åªèƒ½æ´»åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶å‘ç”Ÿçš„æ—¶åˆ»ã€‚å½“åƒåœ¾å›æ”¶å¼€å§‹å·¥ä½œæ—¶ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶æ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚Javaä¸­æä¾›äº†WeakReferenceç±»å®ç°å¼±å¼•ç”¨ã€‚ è™šå¼•ç”¨ï¼ˆPhantom Referenceï¼‰ è™šå¼•ç”¨æ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨çš„å­˜åœ¨ï¼Œå®Œå…¨ä¸ä¼šå½±å“è¯¥å¯¹è±¡çš„ç”Ÿå­˜å‘¨æœŸï¼Œä¹Ÿæ— æ³•é€šè¿‡è™šå¼•ç”¨å¾—åˆ°ä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„åªæ˜¯ä¸ºäº†èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚Javaä¸­æä¾›äº†PhantomReferenceç±»å®ç°è™šå¼•ç”¨ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬3ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜","link":"/2020/07/20/javase/jvm/what-is-quote/"},{"title":"å‹‡é—¯ç®—æ³•-åœ¨è¡Œåˆ—éƒ½æ’å¥½åºçš„çŸ©é˜µä¸­æ‰¾æŒ‡å®šçš„æ•°","text":"é¢˜ç›®æ¥æºï¼šã€Šç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—-ITåä¼ç®—æ³•ä¸æ•°æ®ç»“æ„æœ€ä¼˜è§£ã€‹-å·¦ç¨‹äº‘è‘— ç‰›å®¢ç½‘åœ¨çº¿OJç³»ç»Ÿåœ°å€ï¼šä¼ é€é—¨ é¢˜ç›®æè¿°ç»™å®šä¸€ä¸ªN Ã— Mçš„æ•´å‹çŸ©é˜µmatrixå’Œä¸€ä¸ªæ•´æ•°Kï¼Œmatrixçš„æ¯ä¸€è¡Œæ¯ä¸€åˆ—éƒ½æ˜¯æ’å¥½åºçš„ã€‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­Kæ˜¯å¦åœ¨matrixä¸­ã€‚ è¦æ±‚ï¼š æ—¶é—´å¤æ‚åº¦ä¸ºO(N + M)ï¼Œé¢å¤–ç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚ å¤‡æ³¨ï¼š 1 â©½ N, M â©½1000 0 â©½ K, çŸ©é˜µä¸­çš„æ•° â©½ 10^9^ è¾“å…¥æè¿°ç¬¬ä¸€è¡Œæœ‰ä¸‰ä¸ªæ•´æ•°Nï¼ŒMï¼ŒKï¼› æ¥ä¸‹æ¥Nè¡Œï¼Œæ¯è¡ŒMä¸ªæ•´æ•°ä¸ºè¾“å…¥çš„çŸ©é˜µã€‚ è¾“å‡ºæè¿°è‹¥Kå­˜åœ¨äºçŸ©é˜µä¸­è¾“å‡º&quot;Yes&quot;ï¼Œå¦åˆ™è¾“å‡º&quot;No&quot;ã€‚ ç¤ºä¾‹ç¤ºä¾‹ä¸€è¾“å…¥ï¼š 1232 4 51 2 3 42 4 5 6 è¾“å‡ºï¼š 1Yes ç¤ºä¾‹äºŒè¾“å…¥ï¼š 1232 4 2331 2 3 42 4 5 6 è¾“å‡ºï¼š 1No æ€è€ƒç”±äºçŸ©é˜µä¸­çš„è¡Œå’Œåˆ—éƒ½æ˜¯æ’å¥½åºçš„ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æœ€åä¸€åˆ—æ˜¯æ¯ä¸€è¡Œçš„æœ€å¤§å€¼ï¼Œæœ€åä¸€è¡Œæ˜¯æ¯ä¸€åˆ—çš„æœ€å¤§å€¼ã€‚æ•´ä¸ªçŸ©é˜µçš„æœ€å¤§å€¼åœ¨å³ä¸‹è§’ã€‚ è¦æƒ³å‡å°‘æ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬å¿…é¡»èƒ½å¤Ÿå¿«é€Ÿæ’é™¤æŸäº›è¡Œæˆ–åˆ—ï¼ŒåŸºäºæœ€åä¸€åˆ—æˆ–è¡Œæ˜¯æ¯ä¸€è¡Œæˆ–åˆ—çš„æœ€å¤§å€¼çš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä»çŸ©é˜µå³ä¸Šè§’æˆ–å·¦ä¸‹è§’å¼€å§‹æŸ¥æ‰¾ï¼Œå¦‚æœä¸æ˜¯æŒ‡å®šçš„æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ’é™¤æ‰ä¸€è¡Œæˆ–ä¸€åˆ—äº†ã€‚ ç®—æ³•æ€è·¯æ€è·¯ä¸€ï¼šä»çŸ©é˜µå³ä¸Šè§’å¼€å§‹æŸ¥æ‰¾ ä»çŸ©é˜µæœ€å³ä¸Šè§’çš„æ•°å¼€å§‹æŸ¥æ‰¾ï¼ˆrow=0,col=M-1ï¼šç¬¬0è¡Œï¼Œç¬¬M-1åˆ—ï¼‰ã€‚ æ¯”è¾ƒå½“å‰æ•°matrix[row][col]ä¸Kçš„å…³ç³»ï¼š å¦‚æœç­‰äºKï¼Œåˆ™æ‰¾åˆ°äº†ï¼Œè¿”å›&quot;Yes&quot;ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚ å¦‚æœå¤§äºKï¼Œåˆ™è¯¥åˆ—è¢«æ’é™¤ï¼Œä»¤col=col-1ï¼Œé‡å¤æ­¥éª¤2ã€‚ å¦‚æœå°äºKï¼Œåˆ™è¯¥è¡Œè¢«æ’é™¤ï¼Œä»¤row=row+1ï¼Œé‡å¤æ­¥éª¤2ã€‚ å¦‚æœæ‰¾åˆ°è¶Šç•Œéƒ½æ²¡æœ‰æ‰¾åˆ°ä¸Kç›¸ç­‰çš„æ•°ï¼Œåˆ™è¿”å›&quot;No&quot;ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚ æ€è·¯äºŒï¼šä»çŸ©é˜µå·¦ä¸‹è§’å¼€å§‹æŸ¥æ‰¾ ä»çŸ©é˜µæœ€å·¦ä¸Šè§’çš„æ•°å¼€å§‹æŸ¥æ‰¾ï¼ˆrow=N-1,col=0ï¼šç¬¬N-1è¡Œï¼Œç¬¬0åˆ—ï¼‰ã€‚ æ¯”è¾ƒå½“å‰æ•°matrix[row][col]ä¸Kçš„å…³ç³»ï¼š å¦‚æœç­‰äºKï¼Œåˆ™æ‰¾åˆ°äº†ï¼Œè¿”å›&quot;Yes&quot;ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚ å¦‚æœå¤§äºKï¼Œåˆ™è¯¥è¡Œè¢«æ’é™¤ï¼Œä»¤row=row-1ï¼Œé‡å¤æ­¥éª¤2ã€‚ å¦‚æœå°äºKï¼Œåˆ™è¯¥åˆ—è¢«æ’é™¤ï¼Œä»¤col=col+1ï¼Œé‡å¤æ­¥éª¤2ã€‚ å¦‚æœæ‰¾åˆ°è¶Šç•Œéƒ½æ²¡æœ‰æ‰¾åˆ°ä¸Kç›¸ç­‰çš„æ•°ï¼Œåˆ™è¿”å›&quot;No&quot;ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚ ä»£ç å®ç°ï¼ˆJavaï¼‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576import java.util.Scanner;public class Main { public static void main(String[] args) { // receive input params Scanner scanner = new Scanner(System.in); int n = scanner.nextInt(); int m = scanner.nextInt(); int k = scanner.nextInt(); // build matrix int[][] matrix = new int[n][m]; for (int i = 0; i &lt; n; i++) { for (int j = 0; j &lt; m; j++) { matrix[i][j] = scanner.nextInt(); } } // do check boolean containsOne = isContainsOne(matrix, k); System.out.println(containsOne ? &quot;Yes&quot; : &quot;No&quot;); // boolean containsTwo = isContainsTwo(matrix, k); // System.out.println(containsTwo ? &quot;Yes&quot; : &quot;No&quot;); } /** * åˆ¤æ–­æ–¹å¼ä¸€ï¼šåŒé‡forå¾ªç¯ * å¤–å±‚å¾ªç¯çŸ©é˜µæ¯ä¸€è¡Œ * å†…å±‚å¾ªç¯çŸ©é˜µæ¯ä¸€åˆ— * ç›¸ç­‰ç›´æ¥è¿”å›trueï¼› * è‹¥å°äºkï¼Œåˆ™æ’é™¤å½“å‰è¡Œï¼Œç»“æŸå†…å±‚å¾ªç¯ï¼Œéå†ä¸‹ä¸€è¡Œã€‚ * è‹¥å¤§äºkï¼Œåˆ™æ’é™¤å½“å‰åˆ—ï¼Œj--ï¼Œå†…å­˜å¾ªç¯è¿›å…¥ä¸‹ä¸€æ¬¡ã€‚ * è‹¥åŒé‡å¾ªç¯å®Œæˆéƒ½æœªæ‰¾åˆ°kï¼Œåˆ™è¿”å›falseã€‚ * @param matrix * @param k * @return */ private static boolean isContainsOne(int[][] matrix,int k) { int col = matrix[0].length; for (int[] ints : matrix) { for (int j = col - 1; j &gt;= 0; j--) { int value = ints[j]; if (value == k) { return true; } else if (value &lt; k) { break; } } } return false; } /** * åˆ¤æ–­æ–¹å¼äºŒï¼šwhileå¾ªç¯ * è¶Šç•Œæ¡ä»¶ï¼šè¡Œéå†å®Œæˆ–åˆ—éå†å®Œ * @param matrix * @param k * @return */ private static boolean isContainsTwo(int[][] matrix,int k) { int row = matrix.length; int col = matrix[0].length; int i = 0; int j = col - 1; while (i &lt; row &amp;&amp; j &gt;= 0) { int value = matrix[i][j]; if (value == k) { return true; } else if (value &lt; k) { i++; } else { j--; } } return false; }}","link":"/2020/07/14/algorithm/coding-interview-guide/arraysandmatrices/solution01/"},{"title":"LeetCodeé¢˜è§£-ç¬¬242é¢˜ï¼šæœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯","text":"ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²så’Œt ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥åˆ¤æ–­tæ˜¯å¦æ˜¯sçš„å­—æ¯å¼‚ä½è¯ã€‚ ç¤ºä¾‹1: è¾“å…¥: s = &quot;anagram&quot;, t = &quot;nagaram&quot;è¾“å‡º: true ç¤ºä¾‹2: è¾“å…¥: s = &quot;rat&quot;, t = &quot;car&quot;è¾“å‡º: false è¯´æ˜: ä½ å¯ä»¥å‡è®¾å­—ç¬¦ä¸²åªåŒ…å«å°å†™å­—æ¯ã€‚ è¿›é˜¶: å¦‚æœè¾“å…¥å­—ç¬¦ä¸²åŒ…å«Unicodeå­—ç¬¦æ€ä¹ˆåŠï¼Ÿä½ èƒ½å¦è°ƒæ•´ä½ çš„è§£æ³•æ¥åº”å¯¹è¿™ç§æƒ…å†µï¼Ÿ æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/valid-anagramè‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ æ€è·¯ï¼šé¦–å…ˆè€ƒè™‘ç‰¹æ®Šæƒ…å†µï¼Œå¦‚æœå­—ç¬¦ä¸²så’Œtéƒ½ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ™å¯è®¤ä¸ºå®ƒä»¬äº’ä¸ºå­—æ¯å¼‚ä½è¯ï¼›å¦‚æœå­—ç¬¦ä¸²så’Œtè¿é•¿åº¦éƒ½ä¸ç›¸ç­‰ï¼Œåˆ™ä¸€å®šä¸ä¸ºå­—æ¯å¼‚ä½è¯ã€‚ç„¶åå†è€ƒè™‘å¦‚ä½•è¿›è¡Œåˆ¤æ–­ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­éƒ½åªåŒ…å«26ä¸ªå°å†™çš„è‹±æ–‡å­—æ¯ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å­—æ¯å¼‚ä½è¯ï¼Œé‚£ä¹ˆä¸€å®šæ»¡è¶³ï¼šæ¯ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯åœ¨å­—ç¬¦ä¸²sä¸­å‡ºç°çš„æ¬¡æ•°ç­‰äºåœ¨å­—ç¬¦ä¸²tä¸­å‡ºç°çš„æ¬¡æ•°ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬åªéœ€åˆ†åˆ«å¯¹æ¯ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯åœ¨ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­å‡ºç°çš„æ¬¡æ•°è¿›è¡Œè®¡æ•°ï¼Œç„¶åæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰å³å¯ã€‚ å…·ä½“åˆ°ä»£ç å®ç°å±‚é¢ï¼Œç”±äºä¸¤ä¸ªå­—ç¬¦ä¸²äº’ä¸ºå­—æ¯å¼‚ä½è¯çš„å‰ææ¡ä»¶æ˜¯å…¶é•¿åº¦ç›¸ç­‰ï¼Œæ‰€ä»¥åœ¨è®¡æ•°æ—¶æˆ‘ä»¬å¯ä»¥åŒæ—¶å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œéå†ï¼›å¦ä¸€æ–¹é¢ï¼Œåˆ†åˆ«è®¡æ•°å¯ä»¥è½¬æ¢æˆå¯¹ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²sè¿›è¡Œè®¡æ•°ç´¯åŠ ï¼Œè€Œå¯¹å¦ä¸€ä¸ªå­—ç¬¦ä¸²tè¿›è¡Œè®¡æ•°é€’å‡ï¼Œæœ€ç»ˆå¦‚æœæ¯ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯çš„ç´¯è®¡ç»“æœä¸º0ï¼Œåˆ™å¯æ˜ç¡®è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²äº’ä¸ºå­—æ¯å¼‚ä½è¯ï¼Œåªè¦å‡ºç°ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯çš„ç´¯è®¡ç»“æœä¸ä¸º0ï¼Œåˆ™ä¸æ»¡è¶³æ¡ä»¶ã€‚ å¦‚ä½•å¯¹æ¯ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯è¿›è¡Œè®¡æ•°ï¼Ÿå¯å®šä¹‰ä¸€ä¸ªé•¿åº¦ä¸º26çš„intæ•°ç»„ï¼Œå­—æ¯aåˆ°zä¾æ¬¡å¯¹åº”ä¸‹æ ‡ç´¢å¼•0åˆ°25ã€‚åœ¨éå†å­—ç¬¦ä¸²sæ—¶ï¼Œæ¯æ¬¡é‡åˆ°aåˆ™å°†ç´¢å¼•0ä½ç½®çš„å€¼åŠ ä¸€ï¼Œä»¥æ­¤ç±»æ¨ï¼›è€Œå½“éå†å­—ç¬¦ä¸²tæ—¶ï¼Œæ¯æ¬¡é‡åˆ°aåˆ™å°†ç´¢å¼•0ä½ç½®çš„å€¼å‡ä¸€ã€‚ç›´åˆ°éå†å®Œæˆï¼Œåˆ¤æ–­æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½ä¸º0ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™så’Œtäº’ä¸ºå­—æ¯å¼‚ä½è¯ï¼Œå¦åˆ™ä¸æ˜¯ã€‚ ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728public boolean isAnagram(String s, String t) { // 1. ç©ºå­—ç¬¦ä¸²æƒ…å†µ if (s.length() == 0 &amp;&amp; t.length() == 0) { return true; } // 2. é•¿åº¦ä¸ç›¸ç­‰æƒ…å†µ if (s.length() != t.length()) { return false; } // å­—ç¬¦ä¸²è½¬å­—ç¬¦æ•°ç»„ char[] sc = s.toCharArray(); char[] tc = t.toCharArray(); // å®šä¹‰å­—æ¯è®¡æ•°å™¨ int[] counter = new int[26]; // åŒæ—¶éå†ä¸¤ä¸ªå­—ç¬¦æ•°ç»„ for (int i = 0,length = sc.length;i &lt; length;i++) { // å­—æ¯å¯¹åº”ä¸‹æ ‡ä½ç½®çš„å€¼åŠ ä¸€ counter[sc[i] - 'a']++; // å­—æ¯å¯¹åº”ä¸‹æ ‡ä½ç½®çš„å€¼å‡ä¸€ counter[tc[i] - 'a']--; } // éå†è®¡æ•°å™¨ for (int c : counter) { // å­˜åœ¨ä¸€ä¸ªè®¡æ•°ä¸ä¸º0çš„åˆ™å¯ç¡®å®šä¸æ˜¯å­—æ¯å¼‚ä½è¯ if (c != 0) return false; } return true;} è¿›é˜¶é—®é¢˜ï¼š å¦‚æœè¾“å…¥å­—ç¬¦ä¸²åŒ…å«Unicodeå­—ç¬¦æ€ä¹ˆåŠï¼Ÿ æ€è·¯ï¼šUnicodeå­—ç¬¦å¯å®šä¹‰100ä¸‡ä¸ªä»¥ä¸Šçš„å”¯ä¸€å­—ç¬¦ï¼Œå¦‚æœè¿˜é€‰æ‹©ä½¿ç”¨æ•°ç»„æ¥è®¡æ•°ï¼Œé‚£ä¹ˆéœ€è¦å¼€è¾Ÿå‡ºä¸€å—éå¸¸å¤§çš„å†…å­˜ç©ºé—´ï¼Œè€Œä¸”æœ€åéå†æ•°ç»„ä¹Ÿæ˜¯éå¸¸è€—æ—¶çš„ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨å“ˆå¸Œè¡¨æ¥è®¡æ•°ï¼Œå¯ä»¥é€‚åº”ä»»æ„çš„å­—ç¬¦èŒƒå›´ï¼Œå¦å¤–æœ€åéå†å“ˆå¸Œè¡¨åˆ¤æ–­è®¡æ•°ç»“æœæ—¶ï¼Œå¯å°†å“ˆå¸Œè¡¨ä¸­çš„æ•°æ®å»é‡ï¼Œå³è½¬æ¢æˆä¸€ä¸ªæ— åºä¸é‡å¤çš„Seté›†åˆï¼Œåˆ©ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œå¦‚æœè¯¥é›†åˆä¸­åªå­˜åœ¨ä¸€ä¸ªå…ƒç´ ä¸”å€¼ä¸º0ï¼Œåˆ™å­—ç¬¦ä¸²så’Œtäº’ä¸ºå­—æ¯å¼‚ä½è¯ï¼Œå¦åˆ™ä¸æ˜¯ã€‚ ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public boolean isAnagram(String s, String t) { // 1. ç©ºå­—ç¬¦ä¸²æƒ…å†µ if (s.length() == 0 &amp;&amp; t.length() == 0) { return true; } // 2. å­—ç¬¦ä¸²é•¿åº¦ä¸ç›¸ç­‰ if (s.length() != t.length()) { return false; } // å­—ç¬¦ä¸²è½¬å­—ç¬¦æ•°ç»„ char[] sc = s.toCharArray(); char[] tc = t.toCharArray(); // å“ˆå¸Œè¡¨è®¡æ•°å™¨ Map&lt;Character,Integer&gt; counter = new HashMap&lt;&gt;(); // éå†ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²s for (int i = 0,sLength = s.length();i &lt; sLength;i++) { Integer val = counter.get(sc[i]); if (val != null) { // å¦‚æœå½“å‰å­—ç¬¦å·²å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œåˆ™è®¡æ•°åŠ ä¸€ val += 1; counter.put(sc[i],val); } else { // å½“å‰å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œåˆ™è®¡æ•°ä¸º1 counter.put(sc[i],1); } } // éå†ç¬¬äºŒä¸ªå­—ç¬¦ä¸²t for (int j = 0,tLength = t.length();j &lt; tLength;j++) { Integer val = counter.get(tc[j]); if (val != null) { // å¦‚æœå½“å‰å­—ç¬¦å·²å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œåˆ™è®¡æ•°å‡ä¸€ val -= 1; counter.put(tc[j],val); } else { // å½“å‰å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œå·²ç»å¯ä»¥æ–­å®šä¸æ˜¯å­—æ¯å¼‚ä½è¯ return false; } } // æ–¹æ¡ˆä¸€ï¼šéå†å“ˆå¸Œè¡¨è®¡æ•°å™¨ /** Iterator&lt;Map.Entry&lt;Character,Integer&gt;&gt; iterator = counter.entrySet().iterator(); while (iterator.hasNext()) { Map.Entry&lt;Character,Integer&gt; entry = iterator.next(); // å¦‚æœè®¡æ•°ç»“æœä¸ç­‰äº0ï¼Œåˆ™ä¸æ˜¯å­—æ¯å¼‚ä½è¯ if (entry.getValue() != 0) { return false; } } **/ // æ–¹æ¡ˆäºŒï¼šå°†å“ˆå¸Œè¡¨è½¬æˆæ— åºä¸é‡å¤çš„Seté›†åˆ Set&lt;Integer&gt; set = new HashSet&lt;&gt;(counter.values()); // å¦‚æœSeté›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°ä¸ä¸º1ï¼Œæˆ–è€…å”¯ä¸€ä¸€ä¸ªå…ƒç´ çš„å€¼ä¸ä¸º0ï¼Œåˆ™å¯ç¡®å®šä¸æ˜¯å­—æ¯å¼‚ä½è¯ã€‚ if (set.size() != 1 || !set.contains(0)) { return false; } return true;}","link":"/2020/07/14/algorithm/leetcode/easy/242/"},{"title":"LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šé“¾è¡¨ç›¸äº¤","text":"é¢˜ç›®ï¼šç»™å®šä¸¤ä¸ªï¼ˆå•å‘ï¼‰é“¾è¡¨ï¼Œåˆ¤å®šå®ƒä»¬æ˜¯å¦ç›¸äº¤å¹¶è¿”å›äº¤ç‚¹ã€‚è¯·æ³¨æ„ç›¸äº¤çš„å®šä¹‰åŸºäºèŠ‚ç‚¹çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯åŸºäºèŠ‚ç‚¹çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€ä¸ªé“¾è¡¨çš„ç¬¬kä¸ªèŠ‚ç‚¹ä¸å¦ä¸€ä¸ªé“¾è¡¨çš„ç¬¬jä¸ªèŠ‚ç‚¹æ˜¯åŒä¸€èŠ‚ç‚¹ï¼ˆå¼•ç”¨å®Œå…¨ç›¸åŒï¼‰ï¼Œåˆ™è¿™ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šintersectVal = 8, listA = [4,1,8,4,5], listB = [5,0,1,8,4,5], skipA = 2, skipB = 3 è¾“å‡ºï¼šReference of the node with value = 8 è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º 8 ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º 0ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [4,1,8,4,5]ï¼Œé“¾è¡¨ B ä¸º [5,0,1,8,4,5]ã€‚åœ¨ A ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 2 ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 3 ä¸ªèŠ‚ç‚¹ã€‚ ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šintersectVal = 2, listA = [0,9,1,2,4], listB = [3,2,4], skipA = 3, skipB = 1 è¾“å‡ºï¼šReference of the node with value = 2 è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º 2 ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º 0ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [0,9,1,2,4]ï¼Œé“¾è¡¨ B ä¸º [3,2,4]ã€‚åœ¨ A ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 3 ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 1 ä¸ªèŠ‚ç‚¹ã€‚ ç¤ºä¾‹ 3ï¼š è¾“å…¥ï¼šintersectVal = 0, listA = [2,6,4], listB = [1,5], skipA = 3, skipB = 2 è¾“å‡ºï¼šnull è¾“å…¥è§£é‡Šï¼šä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [2,6,4]ï¼Œé“¾è¡¨ B ä¸º [1,5]ã€‚ç”±äºè¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œæ‰€ä»¥ intersectVal å¿…é¡»ä¸º 0ï¼Œè€Œ skipA å’Œ skipB å¯ä»¥æ˜¯ä»»æ„å€¼ã€‚è§£é‡Šï¼šè¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œå› æ­¤è¿”å› nullã€‚ æ³¨æ„ï¼š å¦‚æœä¸¤ä¸ªé“¾è¡¨æ²¡æœ‰äº¤ç‚¹ï¼Œè¿”å› null ã€‚ åœ¨è¿”å›ç»“æœåï¼Œä¸¤ä¸ªé“¾è¡¨ä»é¡»ä¿æŒåŸæœ‰çš„ç»“æ„ã€‚ å¯å‡å®šæ•´ä¸ªé“¾è¡¨ç»“æ„ä¸­æ²¡æœ‰å¾ªç¯ã€‚ ç¨‹åºå°½é‡æ»¡è¶³ O(n) æ—¶é—´å¤æ‚åº¦ï¼Œä¸”ä»…ç”¨ O(1) å†…å­˜ã€‚ æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰ é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/intersection-of-two-linked-lists-lcci è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ æ€è·¯ï¼šè‹¥ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ï¼Œé‚£ä¹ˆæƒ…å†µä¸€å®šæ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç›¸äº¤çš„èŠ‚ç‚¹åé¢ï¼Œä¸¤ä¸ªé“¾è¡¨å®Œå…¨é‡åˆï¼Œé‚£ä¹ˆå¦‚ä½•æ‰¾åˆ°ç›¸äº¤çš„èŠ‚ç‚¹å‘¢ï¼Ÿå¦‚æœä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸€æ ·ï¼Œé‚£ä¹ˆåŒæ—¶éå†ä¸¤ä¸ªé“¾è¡¨ï¼Œå½“é‡åˆ°å¼•ç”¨ç›¸ç­‰çš„èŠ‚ç‚¹æ—¶å°±æ˜¯ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤çš„èŠ‚ç‚¹ã€‚ä½†å¦‚æœä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸ä¸€æ ·å‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬èƒ½å¤ŸåŸºäºä¸¤ä¸ªé•¿åº¦ä¸åŒçš„é“¾è¡¨æ„é€ å‡ºé•¿åº¦ä¸€æ ·çš„ä¸¤ä¸ªé“¾è¡¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ‰¾åˆ°ç›¸äº¤çš„èŠ‚ç‚¹ã€‚é‚£é—®é¢˜è½¬æ¢æˆå¦‚ä½•æ„é€ é•¿åº¦ä¸€æ ·çš„é“¾è¡¨ï¼Ÿå¦‚æœä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ç›¸å·®xä¸ªèŠ‚ç‚¹ï¼Œå…ˆç”¨ä¸€ä¸ªæŒ‡é’ˆéå†è¾ƒé•¿çš„é“¾è¡¨xæ¬¡ï¼Œè¿™æ—¶å¦‚æœå°†è¯¥æŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ä½œä¸ºå¤´èŠ‚ç‚¹ï¼Œè·Ÿå¦ä¸€ä¸ªè¾ƒçŸ­é•¿åº¦çš„é“¾è¡¨å°±æ„æˆäº†é•¿åº¦ä¸€æ ·çš„ä¸¤ä¸ªé“¾è¡¨ã€‚ç„¶ååŒæ—¶è¿›è¡Œéå†ï¼Œç›´åˆ°é‡åˆ°å¼•ç”¨ç›¸ç­‰çš„èŠ‚ç‚¹å³ä¸ºå¤´èŠ‚ç‚¹ã€‚å¦‚æœæ•´ä¸ªè¿‡ç¨‹éƒ½æœªé‡åˆ°å¼•ç”¨ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™å¯æ–­å®šä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ã€‚ ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041public ListNode getIntersectionNode(ListNode headA, ListNode headB) { // åˆ†åˆ«è®¡ç®—ä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ int lenA = 0; int lenB = 0; ListNode a = headA; ListNode b = headB; while (a != null) { lenA++; a = a.next; } while (b != null) { lenB++; b = b.next; } // è¾ƒé•¿é“¾è¡¨å…ˆéå†é•¿åº¦ä¹‹å·®æ­¥ ListNode x = headA; ListNode y = headB; if (lenA &gt; lenB) { int diff = lenA - lenB; while (diff &gt; 0) { x = x.next; diff--; } } else { int diff = lenB - lenA; while (diff &gt; 0) { y = y.next; diff--; } } // æ­¤æ—¶ä»¥xã€yä¸ºå¤´èŠ‚ç‚¹çš„ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸€æ ·ï¼ŒåŒæ—¶è¿›è¡Œéå†ï¼Œå¦‚æœé‡åˆ°å¼•ç”¨ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™ä¸€å®šæ˜¯ç›¸äº¤çš„èŠ‚ç‚¹ã€‚ while (x != null &amp;&amp; y != null) { if (x == y) { return x; } x = x.next; y = y.next; } // éå†ç»“æŸï¼Œå¯æ–­å®šä¸¤ä¸ªä¸ç›¸äº¤ã€‚ return null;}","link":"/2020/07/14/algorithm/leetcode/tag/linkedlist/intersection-of-two-linked-lists-lcci/"},{"title":"äº‹åŠ¡çš„ç‰¹æ€§å’Œéš”ç¦»çº§åˆ«","text":"ç®€ä»‹æèµ·æ•°æ®åº“ï¼Œé‚£ä¸å¾—ä¸è¯´åˆ°äº‹åŠ¡ï¼Œä½†äº‹åŠ¡å¹¶ä¸æ˜¯MySQLæ•°æ®åº“çš„ä¸“å±ï¼Œè€Œæ˜¯SQLè¯­è¨€çš„ç‰¹æ€§ï¼Œäº‹åŠ¡å°±æ˜¯ä¸€ç»„åŸå­æ€§çš„SQLæŸ¥è¯¢ã€‚è¯¥ç»„æŸ¥è¯¢è¯­å¥è¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»ä½•ä¸€æ¡è¯­å¥æ‰§è¡Œå¤±è´¥æˆ–å› ä¸ºæ•°æ®åº“å¥”æºƒç­‰å…¶å®ƒåŸå› æ— æ³•æ‰§è¡Œï¼Œé‚£ä¹ˆæ‰€æœ‰è¯­å¥éƒ½ä¸ä¼šæ‰§è¡Œã€‚ äº‹åŠ¡ç‰¹æ€§äº‹åŠ¡çš„ç‰¹æ€§å°±æ˜¯æˆ‘ä»¬ä¿—ç§°çš„ACIDï¼Œä¸‹é¢ä¾æ¬¡è¿›è¡Œè§£é‡Šï¼š Aï¼šåŸå­æ€§ï¼ˆAtomicityï¼‰ ä¸€ä¸ªäº‹åŠ¡å¿…é¡»æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„æœ€å°æ‰§è¡Œå•å…ƒï¼Œæ•´ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥åå›æ»šï¼Œå¯¹äºä¸€ä¸ªäº‹åŠ¡è€Œè¨€ï¼Œä¸å¯èƒ½å‡ºç°å…¶ä¸­ä¸€éƒ¨åˆ†æ“ä½œæ‰§è¡ŒæˆåŠŸï¼Œå¦ä¸€éƒ¨åˆ†æ“ä½œæ‰§è¡Œå¤±è´¥çš„æƒ…å†µï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„åŸå­æ€§ã€‚ Cï¼šä¸€è‡´æ€§ï¼ˆconsistencyï¼‰ æ•°æ®åº“æ€»æ˜¯ä»ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€ã€‚ä¾‹å¦‚é“¶è¡Œè½¬è´¦ï¼Œç”¨æˆ·Açš„è´¦æˆ·å‘ç”¨æˆ·Bçš„è´¦æˆ·è½¬è´¦100å…ƒäººæ°‘å¸ï¼Œåœ¨è¿™ä¸ªäº‹åŠ¡ä¸­ï¼Œé¦–å…ˆä¼šä»ç”¨æˆ·Açš„è´¦æˆ·ä¸­æ‰£å‡100å…ƒï¼Œç„¶åç»™ç”¨æˆ·Bçš„è´¦æˆ·å¢åŠ 100å…ƒï¼Œç”±äºäº‹åŠ¡çš„åŸå­æ€§çš„ä¿è¯ï¼Œå³ä½¿åœ¨ä»ç”¨æˆ·Açš„è´¦æˆ·ä¸­æ‰£å‡100å…ƒåæ•°æ®åº“ç³»ç»Ÿå¥”æºƒï¼Œç”¨æˆ·Açš„è´¦æˆ·ä¸Šä¹Ÿä¸ä¼šæŸå¤±100å…ƒï¼Œå› ä¸ºäº‹åŠ¡æ²¡æœ‰æœ€ç»ˆè¿›è¡Œæäº¤ï¼Œç”¨æˆ·Açš„è´¦æˆ·æ‰£å‡ä¸ä¼šä¿å­˜è‡³æ•°æ®åº“ä¸­ï¼ŒåŒæ—¶ç”±äºç³»ç»Ÿå¥”æºƒï¼Œç”¨æˆ·Bçš„è´¦æˆ·ä¹Ÿä¸ä¼šå¢åŠ é‡‘é¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç»è¿‡ä¸€æ¬¡äº‹åŠ¡ï¼Œæ•´ä¸ªè´¦æˆ·ç³»ç»Ÿä¸­çš„é‡‘é¢æ€»æ•°ä¸ä¼šæ”¹å˜ï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„ä¸€è‡´æ€§ã€‚ Iï¼šéš”ç¦»æ€§ï¼ˆisolationï¼‰ éš”ç¦»æ€§æ˜¯æŒ‡å¤šä¸ªå®¢æˆ·ç«¯å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯çš„äº‹åŠ¡ä¸èƒ½è¢«å…¶å®ƒå®¢æˆ·ç«¯çš„äº‹åŠ¡æ‰€å¹²æ‰°ï¼Œå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦åšåˆ°äº‹åŠ¡éš”ç¦»ã€‚ éš”ç¦»æ€§éœ€è¦ç»“åˆäº‹åŠ¡çš„éš”ç¦»çº§åˆ«æ¥è¯´ï¼Œä¸‹æ–‡ä¼šå¯¹äº‹åŠ¡çš„éš”ç¦»çº§åˆ«è¿›è¡Œå±•å¼€è¯´æ˜ã€‚ é€šå¸¸çš„éš”ç¦»æ€§æ˜¯ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­çš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤äº‹åŠ¡ä¹‹å‰ï¼Œå¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚è¿˜æ˜¯é“¶è¡Œè½¬è´¦çš„ä¾‹å­ï¼Œåœ¨ç”¨æˆ·Aç»™ç”¨æˆ·Bè½¬è´¦çš„äº‹åŠ¡æäº¤ä¹‹å‰ï¼Œå¦‚æœç”¨æˆ·Aè¿˜å‘å¦ä¸€ä¸ªç”¨æˆ·Cè½¬è´¦ï¼Œè¿™æ—¶å€™çœ‹ç”¨æˆ·Açš„è´¦æˆ·æ˜¯è¿˜æœªæ‰£å‡100å…ƒçš„ï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„éš”ç¦»æ€§ã€‚ Dï¼šæŒä¹…æ€§ï¼ˆdurabilityï¼‰ ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œåˆ™è¯¥äº‹åŠ¡ä¸­æ‰€åšçš„æ‰€æœ‰ä¿®æ”¹éƒ½å°†æ°¸ä¹…ä¿å­˜è‡³æ•°æ®åº“ä¸­ï¼Œä¼šè¢«æŒä¹…åŒ–è‡³ç£ç›˜ä¸Šï¼Œå³ä½¿æ­¤æ—¶ç³»ç»Ÿå‘ç”Ÿå¥”æºƒï¼Œäº‹åŠ¡ä¸­å‘ç”Ÿä¿®æ”¹çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚ åœ¨MySQLä¸­ï¼Œäº‹åŠ¡çš„å®ç°åœ¨å¼•æ“å±‚ã€‚MySQLæ˜¯ä¸€ä¸ªæ”¯æŒå¤šå¼•æ“çš„ç³»ç»Ÿï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰å¼•æ“éƒ½æ”¯æŒäº‹åŠ¡ï¼Œä¾‹å¦‚MySQLåŸç”Ÿçš„MyISAMå¼•æ“å°±ä¸æ”¯æŒäº‹åŠ¡ï¼Œè€Œæˆ‘ä»¬ç†ŸçŸ¥çš„InnoDBå¼•æ“åˆ™æ˜¯æ”¯æŒäº‹åŠ¡çš„ã€‚ å¹¶å‘è®¿é—®çš„é—®é¢˜å½“å¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°å¹¶å‘é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæå‡ºäº†éš”ç¦»çº§åˆ«çš„æ¦‚å¿µï¼Œæ¯ä¸€ç§éš”ç¦»çº§åˆ«éƒ½å¯ä»¥è§£å†³ä¸€ä¸ªå¹¶å‘é—®é¢˜ã€‚ äº‹åŠ¡çš„å¹¶å‘æ‰§è¡Œå­˜åœ¨ä»¥ä¸‹ä¸‰ç§é—®é¢˜ï¼š è„è¯» ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡ä¸­æœªæäº¤çš„æ•°æ®ã€‚ ä¸å¯é‡å¤è¯» å‡è®¾å­˜åœ¨è¿™æ ·ä¸€ä¸ªäº‹åŠ¡ï¼Œé¦–å…ˆæŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œç„¶åä¿®æ”¹è¯¥æ¡è®°å½•çš„å€¼ï¼Œå†æ¬¡æŸ¥è¯¢è¯¥æ¡è®°å½•ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªäº‹åŠ¡è€Œè¨€ï¼Œä¸¤æ¬¡æŸ¥è¯¢åˆ°çš„è®°å½•çš„å€¼ä¸ä¸€è‡´ï¼Œè¿™è¢«ç§°ä¸ºä¸å¯é‡å¤è¯»ã€‚ å¹»è¯» å‡è®¾å­˜åœ¨è¿™æ ·ä¸€ä¸ªäº‹åŠ¡ï¼Œé¦–å…ˆæ¡ä»¶æŸ¥è¯¢æŸä¸ªèŒƒå›´å†…çš„è®°å½•ï¼Œæ­¤æ—¶æŸä¸ªå¹¶å‘æ‰§è¡Œçš„å…¶å®ƒäº‹åŠ¡åœ¨è¯¥èŒƒå›´å†…æ’å…¥äº†æ–°çš„è®°å½•ï¼Œå½“ä¹‹å‰çš„äº‹åŠ¡å†æ¬¡ä»¥ç›¸åŒçš„æ¡ä»¶èŒƒå›´æŸ¥è¯¢æ—¶ï¼Œå°±ä¼šæŸ¥è¯¢åˆ°æ–°æ’å…¥çš„è¡Œï¼ˆç§°ä¸ºå¹»è¡Œï¼‰ã€‚InnoDBå¼•æ“é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰æ¥è§£å†³å¹»è¯»çš„é—®é¢˜ã€‚ äº‹åŠ¡çš„éš”ç¦»çº§åˆ«æ¯ä¸€ç§éš”ç¦»çº§åˆ«éƒ½è§£å†³äº†ä¸€ä¸ªå¹¶å‘é—®é¢˜ï¼Œä½†å¿…é¡»æ˜ç™½ï¼Œé—®é¢˜è§£å†³çš„è¶Šå¤šï¼Œæ•ˆç‡å°±ä¼šè¶Šä½ã€‚å› æ­¤å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯æ¥é€‰æ‹©åˆé€‚çš„éš”ç¦»çº§åˆ«ã€‚ SQLæ ‡å‡†çš„äº‹åŠ¡éš”ç¦»çº§åˆ«åŒ…æ‹¬ï¼šè¯»æœªæäº¤ï¼ˆread uncommittedï¼‰ã€è¯»å·²æäº¤ï¼ˆread committedï¼‰ã€å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰ã€‚ è¯»æœªæäº¤ï¼ˆread uncommittedï¼‰ å¯è¯»å–å…¶å®ƒäº‹åŠ¡ä¸­æœªæäº¤çš„æ•°æ®ï¼Œä¸èƒ½è§£å†³ä»»ä½•å¹¶å‘é—®é¢˜ã€‚ è¯»å·²æäº¤ï¼ˆread committedï¼‰ åªèƒ½è¯»å–å…¶å®ƒäº‹åŠ¡ä¸­å·²æäº¤çš„æ•°æ®ï¼Œå¯ä»¥è§£å†³è„è¯»é—®é¢˜ã€‚ å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰ ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­èƒ½è¯»å–åˆ°çš„æ•°æ®ï¼Œæ€»æ˜¯è·Ÿè¿™ä¸ªäº‹åŠ¡åœ¨å¯åŠ¨æ—¶è¯»åˆ°çš„æ•°æ®ä¿æŒä¸€è‡´ã€‚å¯ä»¥è§£å†³è„è¯»å’Œä¸å¯é‡å¤è¯»é—®é¢˜ã€‚ å®ç°åŸç†æ˜¯åœ¨äº‹åŠ¡å¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œæ•´ä¸ªäº‹åŠ¡å­˜åœ¨æœŸé—´éƒ½ä¼šæŸ¥è¯¢è¯¥è§†å›¾ã€‚ ä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰ æœ€é«˜çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œä½¿ç”¨è¯»å†™é”å¼ºåˆ¶æ‰€æœ‰æ“ä½œä¸²è¡Œæ’é˜Ÿæ‰§è¡Œï¼Œè§£å†³äº†æ‰€æœ‰çš„å¹¶å‘é—®é¢˜ã€‚ä½†å…¶æ•ˆç‡ä¹Ÿæœ€ä¸ºä½ä¸‹ã€‚å¯¹äºåŒä¸€è¡Œè®°å½•ï¼Œâ€œå†™â€ä¼šåŠ â€œå†™é”â€ï¼Œâ€œè¯»â€ä¼šåŠ â€œè¯»é”â€ã€‚å½“å‡ºç°è¯»å†™é”å†²çªæ—¶ï¼Œåå¯åŠ¨çš„äº‹åŠ¡å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œå¹¶æäº¤åï¼Œæ‰èƒ½æ‰§è¡Œã€‚ ä¸åŒéš”ç¦»çº§åˆ«ä¹‹é—´çš„æ€§èƒ½æ¯”è¾ƒï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼šè¯»æœªæäº¤ &gt; è¯»å·²æäº¤ &gt; å¯é‡å¤è¯» &gt; ä¸²è¡ŒåŒ–ã€‚ æ€§èƒ½è¶Šé«˜ï¼Œå¹¶å‘å®‰å…¨æ€§è¶Šä½ã€‚MySQLåœ¨5.0ç‰ˆæœ¬ä¹‹åå¼€å§‹ï¼Œé€‰æ‹©å¯é‡å¤è¯»åšä¸ºé»˜è®¤çš„éš”ç¦»çº§åˆ«ã€‚ MySQLä¸ºä»€ä¹ˆé€‰æ‹©å¯é‡å¤è¯»ä½œä¸ºé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Ÿ ä¼ é€é—¨ æ·±å…¥ç†è§£äº‹åŠ¡éš”ç¦»çº§åˆ«è¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥å°è¯•ç†è§£äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚ åˆå§‹åŒ–è¡¨Tï¼Œæ’å…¥ä¸€æ¡è®°å½•ï¼š 1234567CREATE TABLE `T` ( `id` int(11) NOT NULL AUTO_INCREMENT, `num` int(11) NOT NULL DEFAULT 0, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;insert into `T` (`num`) values (1); å‡è®¾æœ‰ä¸¤ä¸ªäº‹åŠ¡çš„æ‰§è¡Œé¡ºåºå¦‚ä»¥ä¸‹è¡¨æ ¼æ‰€ç¤ºï¼š æ—¶é—´è½´ äº‹åŠ¡1 äº‹åŠ¡2 t0 begin begin t1 select num from T where id = 1; t2 select num from T where id = 1; t3 update T set num = 2 where id = 1; t4 select num from T where id = 1; t5 commit; t6 select num from T where id = 1; t7 commit; t8 select num from T where id = 1; t1æ—¶åˆ»äº‹åŠ¡1æŸ¥è¯¢å¾—åˆ°çš„numå€¼ä¸º1ã€‚ è®¾t4æ—¶åˆ»äº‹åŠ¡1æŸ¥è¯¢å¾—åˆ°çš„numå€¼ä¸ºN1ï¼Œt6æ—¶åˆ»äº‹åŠ¡1æŸ¥è¯¢å¾—åˆ°çš„numå€¼ä¸ºN2ï¼Œt8æ—¶åˆ»äº‹åŠ¡1æŸ¥è¯¢å¾—åˆ°çš„numå€¼ä¸ºN3ã€‚ åœ¨ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼ŒN1ã€N2å’ŒN3çš„å€¼ä¼šä¸€æ ·å—ï¼Ÿåˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ è¯»æœªæäº¤éš”ç¦»çº§åˆ«ä¸‹ï¼š äº‹åŠ¡1å¯è¯»åˆ°äº‹åŠ¡2ä¸­æœªæäº¤æ•°æ®ï¼Œäºæ˜¯N1=N2=N3=2ã€‚ è¯»å·²æäº¤éš”ç¦»çº§åˆ«ä¸‹ï¼š äº‹åŠ¡1åªèƒ½è¯»åˆ°äº‹åŠ¡2ä¸­å·²æäº¤çš„æ•°æ®ï¼Œäºæ˜¯N1=1, N2=2, N3=2ã€‚ å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹ï¼š äº‹åŠ¡1ä¸­è¯»åˆ°çš„æ•°æ®æ€»æ˜¯è·Ÿè¯¥äº‹åŠ¡åˆšå¯åŠ¨æ—¶è¯»åˆ°çš„æ•°æ®ä¿æŒä¸€è‡´ï¼Œäºæ˜¯N1=1, N2=1, N3=2ã€‚ ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ä¸‹ï¼š å¯¹åŒä¸€è¡Œæ•°æ®çš„æ“ä½œå¼ºåˆ¶æ’é˜Ÿæ‰§è¡Œã€‚t1æ—¶åˆ»äº‹åŠ¡1åŠ è¯»é”ï¼›t2æ—¶åˆ»äº‹åŠ¡2åŠ è¯»é”ï¼›t3æ—¶åˆ»äº‹åŠ¡2å°è¯•åŠ å†™é”ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç­‰å¾…äº‹åŠ¡1æäº¤åæ‰ä¼šæ‰§è¡Œupdateï¼›t8æ—¶åˆ»äº‹åŠ¡2å·²æäº¤ã€‚äºæ˜¯N1=1, N2=1, N3=2ã€‚ æ€»ç»“äº‹åŠ¡çš„å››å¤§ç‰¹æ€§ï¼šACIDï¼› äº‹åŠ¡çš„å¹¶å‘é—®é¢˜ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚ äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼šè¯»æœªæäº¤ã€è¯»å·²æäº¤ï¼ˆè§£å†³äº†è„è¯»ï¼‰ã€å¯é‡å¤è¯»ï¼ˆè§£å†³äº†ä¸å¯é‡å¤è¯»ï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆè§£å†³äº†å¹»è¯»ï¼Œæ— å¹¶å‘é—®é¢˜ï¼‰ã€‚ å‚è€ƒ ã€ŠMySQLå®æˆ˜45è®²ã€‹ - æå®¢æ—¶é—´","link":"/2020/07/12/database/mysql/transaction-characteristics-and-isolation-levels/"},{"title":"MySQLä¸ºä»€ä¹ˆé€‰æ‹©å¯é‡å¤è¯»ä½œä¸ºé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Ÿ","text":"é—®é¢˜åœ¨Oracleå’ŒSqlServerå…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œé»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯è¯»å·²æäº¤ã€‚ä¸ºä»€ä¹ˆMySQLçš„é»˜è®¤éš”ç¦»çº§åˆ«é€‰æ‹©å¯é‡å¤è¯»å‘¢ï¼Ÿ è§£ç­”è¿™ä¸ªé—®é¢˜å¾—ä»ä¸»ä»å¤åˆ¶è¯´èµ·ï¼ŒMySQLçš„ä¸»ä»å¤åˆ¶æ˜¯åŸºäºbinlogå¤åˆ¶çš„ã€‚ binlogæœ‰ä»¥ä¸‹ä¸‰ç§æ ¼å¼ï¼š Statementï¼šè®°å½•ä¿®æ”¹çš„SQLè¯­å¥ã€‚ Rowï¼šè®°å½•æ¯ä¸€è¡Œæ•°æ®çš„å˜æ›´ã€‚ Mixedï¼šStatementå’ŒRowæ¨¡å¼çš„æ··åˆã€‚ MySQLåœ¨5.0ç‰ˆæœ¬ä¹‹å‰ï¼Œbinlogåªæ”¯æŒStatementæ ¼å¼ï¼Œåœ¨è¯»å·²æäº¤éš”ç¦»çº§åˆ«ä¸‹ï¼Œè¿™ç§æ ¼å¼çš„ä¸»ä»å¤åˆ¶æ˜¯å­˜åœ¨é—®é¢˜çš„ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š åˆ›å»ºä¸€å¼ Sè¡¨ï¼Œå¹¶åˆå§‹åŒ–ä¸€æ¡æ•°æ®ã€‚ 1234567CREATE TABLE `S` ( `id` int(11) NOT NULL AUTO_INCREMENT, `val` varchar(32) NOT NULL DEFAULT '', PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;insert into `S` (`val`) values ('hello'); å‡è®¾æ­¤æ—¶æˆ‘ä»¬çš„MySQLæ˜¯5.0ç‰ˆæœ¬ï¼Œbinlogä¸ºStatementæ ¼å¼ï¼Œä¸”éš”ç¦»çº§åˆ«ä¸ºè¯»å·²æäº¤ã€‚åœ¨ä¸»ä»æ¶æ„ä¸‹ï¼Œä¸»åº“ä¸Šæ‰§è¡Œä»¥ä¸‹äº‹åŠ¡ï¼š Statement1 Statement2 begin begin delete from S where id &lt; 5; insert into S (val) values (â€˜javaâ€™); commit; commit; æ­¤æ—¶åœ¨ä¸»åº“ä¸Šæ‰§è¡Œselect * from Sï¼Œä¼šè¾“å‡ºä¸€æ¡è®°å½•javaï¼›è€Œåœ¨ä»åº“æ‰§è¡Œè¯¥è¯­å¥ä¼šè¾“å‡ºEmpty Setã€‚ ä¸»ä»åº“æ•°æ®å‡ºç°äº†ä¸ä¸€è‡´ã€‚é‚£åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ åœ¨ä¸»åº“ä¸Šï¼ŒStatement1çš„åˆ é™¤å…ˆæ‰§è¡Œï¼Œåœ¨å…¶æäº¤äº‹åŠ¡ä¹‹å‰Statement2æ’å…¥æ•°æ®å¹¶æäº¤ï¼ŒStatement2æ’å…¥çš„æ•°æ®ä¸ä¼šè¢«åˆ é™¤ï¼Œæœ€åStatement1äº‹åŠ¡æäº¤ï¼Œä¹Ÿå°±æ˜¯å…ˆåˆ é™¤åæ’å…¥ï¼Œè¡¨ä¸­ç•™ä¸‹äº†Statement2äº‹åŠ¡ä¸­æ’å…¥çš„æ•°æ®ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç”±äºStatement2å…ˆæäº¤ï¼Œbinlogå…ˆå°†æ’å…¥è®°å½•ä¸‹æ¥ï¼Œç„¶åè®°å½•åæäº¤çš„åˆ é™¤ã€‚åŒæ­¥åˆ°ä»åº“ä¸Šæ—¶ï¼Œå°±æ˜¯å…ˆæ’å…¥ååˆ é™¤ã€‚æ‰€ä»¥å¯¼è‡´äº†ä¸»ä»æ•°æ®ä¸ä¸€è‡´ã€‚ é‚£ä¹ˆå¦‚ä½•è§£å†³è¯¥é—®é¢˜å‘¢ï¼Ÿ æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼Œè¯¥çº§åˆ«ä¸‹å¼•å…¥é—´éš™é”ï¼Œåœ¨Statement1æ‰§è¡Œåˆ é™¤æ—¶ï¼Œé—´éš™é”ä¼šé”ä½ä¸€ä¸ªidåŒºé—´ï¼ˆè¿™ä¸ªåŒºé—´èŒƒå›´æœ‰ä¸€å®šçš„è§„åˆ™ï¼‰ï¼Œåœ¨è¿™ä¸ªåŒºé—´å†…çš„æ“ä½œéƒ½ä¼šé˜»å¡ï¼Œæ‰€ä»¥Statement2æ‰§è¡Œæ’å…¥ä¼šè¢«é˜»å¡ä½ï¼Œç›´åˆ°Statement1äº‹åŠ¡æäº¤æ‰æ‰§è¡Œã€‚ æ–¹æ¡ˆäºŒï¼šå°†binlogçš„æ ¼å¼ä¿®æ”¹ä¸ºRowæ ¼å¼ï¼ŒåŸºäºè¡Œçš„å¤åˆ¶ï¼Œè¿™æ ·å°±ä¿è¯äº†åˆ é™¤å’Œæ’å…¥çš„æ‰§è¡Œé¡ºåºã€‚ä½†è¯¥ç‰¹æ€§åœ¨5.0ç‰ˆæœ¬ä¹‹åæ‰å¼•å…¥ï¼Œæ‰€ä»¥ï¼ŒMySQLä¸ºäº†ä¿è¯ä¸»ä»åŒæ­¥æ•°æ®ä¸€è‡´æ€§ï¼Œå°†é»˜è®¤éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºå¯é‡å¤è¯»ã€‚ é—´éš™é”çš„å­˜åœ¨ï¼Œå¯¼è‡´å¯é‡å¤è¯»éš”ç¦»çº§åˆ«å‡ºç°æ­»é”çš„å‡ ç‡å˜å¤§ï¼Œä¸€æ—¦å‡ºç°æ­»é”ï¼Œå¯¹ä¸šåŠ¡çš„å½±å“å°†æ˜¯ä¸å¯é¢„æ–™çš„ï¼Œæ‰€ä»¥ï¼Œå®é™…ä¸šåŠ¡å¼€å‘ä¸­ï¼Œå¹¶ä¸æ¨èä½¿ç”¨é»˜è®¤çš„å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼Œè€Œæ˜¯æ¨èä½¿ç”¨è¯»å·²æäº¤éš”ç¦»çº§åˆ«ã€‚ æ€»ç»“å…³äºé—´éš™é”ï¼Œæˆ‘å°†å•ç‹¬å†™ä¸€ç¯‡åšå®¢è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚è¿™é‡Œåªéœ€ç†è§£åˆ°ä¼šé”ä½ä¸€ä¸ªåŒºé—´å³å¯ï¼Œåœ¨è¿™ä¸ªåŒºé—´å†…çš„æ“ä½œéƒ½ä¼šé˜»å¡ã€‚ MySQLçš„æ—©æœŸç‰ˆæœ¬æ²¡æœ‰é—´éš™é”ï¼Œåœ¨è¯»å·²æäº¤éš”ç¦»çº§åˆ«ä¸‹ä¸»ä»åŒæ­¥ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µï¼Œæ‰€ä»¥å°†é»˜è®¤çš„éš”ç¦»çº§åˆ«è®¾ä¸ºäº†è¯»å·²æäº¤ã€‚ å‚è€ƒ https://www.cnblogs.com/rjzheng/p/10510174.html","link":"/2020/07/12/database/mysql/why-does-mysql-choose-repeatable-read-as-the-default-isolation-level/"},{"title":"å…³äºJavaï¼Œä½ ä¸å¾—ä¸å­¦çš„java.lang.Stringç±»","text":"å‰è¨€åœ¨Javaå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä»å¤´è‡³å°¾éƒ½åœ¨ä¸Stringæ‰“äº¤é“ã€‚è¿˜è®°å¾—æˆ‘ä»¬æ•²ä¸‹çš„ç¬¬ä¸€è¡Œä»£ç å—ï¼Ÿ 1System.out.println(&quot;Hello World!&quot;); è¿™æ˜¯æˆ‘ä»¬æ‰€æœ‰å¼€å‘äººå‘˜æ¢¦å¼€å§‹çš„åœ°æ–¹ã€‚é‚£å¹´ï¼Œé’æ¶©çš„æˆ‘ä»¬åœ¨è¯¾å ‚ä¸Šæ•²ä¸‹è¿™ç¬¬ä¸€è¡Œä»£ç ï¼Œæ®Šä¸çŸ¥ï¼Œå®ƒç«Ÿä¼šå½±å“æˆ‘ä»¬æ¯ä¸ªäººçš„ä¸€ç”Ÿã€‚ java.lang.Stringç±»ç®€ä»‹å¯¹äºéƒ¨åˆ†åˆšå­¦ä¹ Javaçš„åˆå­¦è€…æ¥è¯´ï¼Œå½“é—®åˆ°Javaä¸­æœ‰å“ªäº›åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œå¯èƒ½ä¼šå›ç­”å‡ºStringå­—ç¬¦ä¸²ã€‚ ä½†äº‹å®ä¸Šï¼ŒStringæ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ã€‚ Javaä¸­çš„åŸºæœ¬ç±»å‹æœ‰ä»¥ä¸‹å…«ç§ï¼šbyteã€shortã€intã€longã€charã€floatã€doubleå’Œbooleanã€‚ ==å’Œequals()åŒºåˆ«æˆ‘ä»¬å…ˆæ¥çœ‹è¿™æ ·ä¸€æ®µä»£ç ï¼š 12345public static void main(String[] args) { String a = &quot;Hello&quot; + &quot; World&quot; + &quot;!&quot;; String b = &quot;Hello World!&quot;; System.out.println(a == b);} èªæ˜çš„ä½ æ˜¯å¦å·²ç»çŸ¥é“äº†è¿™æ®µä»£ç çš„è¿è¡Œç»“æœå‘¢ï¼Ÿ è¿è¡Œç»“æœï¼štrueã€‚ å¦‚æœä½ ç«‹åˆ»çŸ¥é“äº†ç»“æœä¸”æ‡‚å…¶åŸç†ï¼Œé‚£ä¹ˆè¿™ä¸€ä¸ªçŸ¥è¯†ç‚¹å¯ä»¥è·³è¿‡ï¼›å¦‚æœè¿˜æœ‰ä¸€ç‚¹å«ç³Šï¼Œé‚£å°±è¯·ä»”ç»†å¾€ä¸‹çœ‹ã€‚ è¦è§£é‡Šè¿™ä¸ªè¿è¡Œç»“æœçš„åŸç†ï¼Œéœ€è¦çŸ¥é“ä¸‹é¢ä¸‰ä¸ªé—®é¢˜ï¼š ==å’Œequals()æ˜¯å¦‚ä½•è¿›è¡Œæ¯”è¾ƒçš„ï¼Ÿ ä¸Šè¿°ä»£ç ä¸­çš„å˜é‡aå’Œbåœ¨å†…å­˜ä¸­æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ ç¼–è¯‘æ—¶çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚ ==çš„æ¯”è¾ƒæ–¹æ¡ˆåœ¨Javaè¯­è¨€ä¸­ï¼Œ==è¿ç®—ç¬¦ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå†…å­˜å•å…ƒä¸Šçš„å†…å®¹æ˜¯å¦ä¸€æ ·ï¼Œå®é™…æ˜¯æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œåœ¨è®¡ç®—æœºå†…éƒ¨å°±æ˜¯0å’Œ1ã€‚ å¯¹äºä¸ƒç§åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆbooleané™¤å¤–ï¼‰ï¼Œå°±æ˜¯ç›´æ¥æ¯”è¾ƒä¸¤è€…çš„æ•°å€¼æ˜¯å¦ç›¸ç­‰ã€‚ è€Œå¯¹äºå¼•ç”¨ç±»å‹ï¼Œä¾‹å¦‚ç¤ºä¾‹ä¸­çš„Stringå¼•ç”¨ç±»å‹ï¼Œæ¯”è¾ƒçš„æ˜¯â€œå¼•ç”¨çš„å€¼â€ï¼Œå®é™…å°±æ˜¯ä¸¤è€…çš„å†…å­˜åœ°å€å€¼ã€‚ å¦‚æœä¸¤ä¸ªå¼•ç”¨è¿›è¡Œ==æ¯”è¾ƒï¼Œæ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¼•ç”¨å¯¹è±¡çš„å†…å­˜åœ°å€å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå®é™…ä¸Šå°±æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¼•ç”¨æ‰€æŒ‡å‘çš„å¯¹è±¡æ˜¯å¦å­˜å‚¨åœ¨åŒä¸€ä¸ªå†…å­˜åŒºåŸŸä¸Šã€‚å¦‚æœæ˜¯ï¼Œåˆ™è¿”å›trueï¼›å¦åˆ™è¿”å›falseã€‚ ä¸¾ä¸€ä¸ªä¸å¤ªæ°å½“çš„æ¯”å–»ï¼šå¤§å®¶éƒ½è€ƒä¸Šäº†å¿ƒä»ªçš„å¤§å­¦ï¼Œç°åœ¨æ¯”è¾ƒå“ªäº›äººè€ƒä¸Šäº†åŒä¸€æ‰€å¤§å­¦ã€‚ equals()æ–¹æ³•çš„æ¯”è¾ƒæ–¹æ¡ˆå¯¹äºequals()æ–¹æ³•ï¼Œå®ƒçš„æºå¤´æ¥è‡ªäºObjectç±»ã€‚åœ¨Javaä¸­ï¼Œä»»ä½•å¯¹è±¡éƒ½éšå¼çš„ç»§æ‰¿äº†java.lang.Objectç±»ã€‚æ‰€ä»¥ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨equals()æ–¹æ³•è¿›è¡Œæ¯”è¾ƒã€‚ è€Œåœ¨java.lang.Objectç±»ä¸­ï¼Œequals()æ–¹æ³•çš„å®ç°æ˜¯è¿™æ ·çš„ï¼š 123public boolean equals(Object obj) { return (this == obj);} ç›´æ¥ä½¿ç”¨äº†==è¿ç®—ç¬¦æ¯”è¾ƒã€‚è¿™æ„å‘³ç€ï¼šå¦‚æœè°ƒç”¨equals()æ–¹æ³•è¿›è¡Œæ¯”è¾ƒçš„ç±»åŠå…¶æ˜¾å¼ä½¿ç”¨extendså…³é”®å­—ç»§æ‰¿çš„çˆ¶ç±»åˆ—è¡¨ä¸­éƒ½æ²¡æœ‰é‡å†™è¿‡equals()æ–¹æ³•ï¼Œé‚£ä¹ˆè°ƒç”¨equals()æ–¹æ³•å°±ç­‰åŒäºä½¿ç”¨==è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒã€‚ equals()æ–¹æ³•ä¹‹æ‰€ä»¥å­˜åœ¨äºObjectç±»ä¸­ï¼Œå°±æ˜¯å¸Œæœ›å­ç±»å»é‡å†™ï¼Œä»¥å®ç°æ¯”è¾ƒå¯¹è±¡ç›¸ç­‰çš„åŠŸèƒ½ã€‚ java.lang.Stringç±»å°±é‡å†™äº†equals()æ–¹æ³•ï¼Œå› ä¸ºå¯¹äºå­—ç¬¦ä¸²æ¥è¯´ï¼Œåªè¦å­—ç¬¦ä¸²å†…å®¹ç›¸åŒï¼Œåˆ™å¯è®¤ä¸ºè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯â€œç›¸ç­‰â€çš„ã€‚ ä¸¤ä¸ªå¯¹è±¡â€œç›¸ç­‰â€å¹¶ä¸æ„å‘³ç€å¯¹è±¡çš„æ‰€æœ‰å±æ€§éƒ½è¦ç›¸ç­‰ï¼Œéœ€è¦æ ¹æ®å¯¹è±¡çš„å…·ä½“ä¸šåŠ¡åœºæ™¯è¿›è¡Œå…·ä½“åˆ†æã€‚ ä¾‹å¦‚ï¼Œä¸¤ä¸ªç½—æŠ€ç‰Œé¼ æ ‡ï¼Œå®ƒä»¬çš„å±æ€§é™¤äº†å“ç‰Œã€å‹å·ã€å°ºå¯¸å’Œä»·æ ¼å¤–ï¼Œè¿˜æœ‰å¦‚ç”Ÿäº§åœ°åŒºã€å”®å–æ–¹å¼ç­‰å±æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬å¯èƒ½åªéœ€è¦å¯¹æ¯”å®ƒä»¬çš„å“ç‰Œã€å‹å·å’Œå°ºå¯¸ç­‰å±æ€§ï¼Œåœ¨è¿™ä¸ªèŒƒå›´å†…å…¶ä½™çš„å±æ€§ä¸éœ€å…³å¿ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸¤ä¸ªå¯¹è±¡çš„å€¼æ˜¯å¦ç›¸ç­‰éœ€è¦æ ¹æ®å¯¹è±¡çš„ä¸šåŠ¡åœºæ™¯å†³å®šï¼Œè€Œä¸æ˜¯æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡å‡†æ¥æ¯”è¾ƒã€‚ æ‰€ä»¥ï¼ŒObjectç±»æä¾›äº†equals()æ–¹æ³•æ¥è®©å„ä¸ªç±»é€‰æ‹©é‡å†™ï¼Œç”¨ä»¥å®ç°ç¬¦åˆè‡ªèº«ä¸šåŠ¡åœºæ™¯çš„å¯¹è±¡ç›¸ç­‰æ¯”è¾ƒã€‚ ä¸Šè¿°ä»£ç ä¸­çš„å˜é‡aå’Œbåœ¨å†…å­˜ä¸­çš„ç»“æ„åœ¨Javaä¸­ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨é€šå¸¸æ˜¯ï¼šæ ˆä¸­çš„å¼•ç”¨æŒ‡å‘å †å†…çš„å¯¹è±¡ã€‚å¯¹äºå­—ç¬¦ä¸²å¯¹è±¡æ¥è¯´ï¼Œè¿˜æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡æ± ç”¨æ¥å­˜å‚¨å­—ç¬¦ä¸²å¯¹è±¡ï¼ˆå®ƒæ˜¯ä¸€ä¸ªJVMçº§åˆ«çš„å­—ç¬¦ä¸²ç¼“å­˜ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¼šå‡ºç°æ ˆä¸­çš„å¼•ç”¨æŒ‡å‘å¸¸é‡æ± ä¸­çš„å¯¹è±¡ã€‚ åœ¨Java6ä¹‹å‰ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä½äºæ–¹æ³•åŒºå†…ï¼› è€Œåœ¨Java7ä¸­ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± è¢«ç§»åˆ°äº†å †å†…å­˜ä¸­ï¼› åœ¨Java8ä¸­ï¼Œæå‡ºäº†å…ƒç©ºé—´çš„æ¦‚å¿µï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä¹Ÿéšä¹‹ç§»åŠ¨åˆ°äº†å…ƒç©ºé—´ã€‚ ç¼–è¯‘æ—¶çš„ä¼˜åŒ–å˜é‡aæ˜¯é€šè¿‡+æ‹¼æ¥å­—é¢é‡è¿›è¡Œèµ‹å€¼çš„ï¼Œåœ¨ç¼–è¯‘æœŸï¼ŒString a = &quot;Hello&quot; + &quot; World&quot; + &quot;!&quot;;å°±å·²ç»è¢«ç¼–è¯‘æˆString a = &quot;Hello World!&quot;;äº†ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿå› ä¸ºå­—é¢é‡çš„å€¼æ˜¯ç¡®å®šçš„ï¼Œè¿è¡Œæ—¶ä¸å†éœ€è¦ä»»ä½•è®¡ç®—ï¼Œä¹Ÿå°±æ²¡æœ‰ä½¿ç”¨+è¿ç®—ç¬¦çš„å¿…è¦äº†ï¼Œç¼–è¯‘å™¨ä¹Ÿè¿™ä¹ˆè§‰å¾—ï¼šâ€œè¿™ä¸æ˜¯åœ¨è„±è£¤å­æ”¾å±å—â€ï¼Ÿæ‰€ä»¥åœ¨ç¼–è¯‘æœŸè¿ç®—ç¬¦å°±è¢«å»é™¤äº†ã€‚äºæ˜¯aå’Œbçš„èµ‹å€¼æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ è¿è¡ŒåŸç†å¯¹äºå˜é‡aå’Œbè¿™ç§ä½¿ç”¨å­—é¢é‡åˆ›å»ºå­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œåœ¨åˆ›å»ºå˜é‡aæ—¶ï¼ŒJVMé¦–å…ˆä¼šå»å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æŸ¥æ‰¾&quot;Hello World!&quot;è¿™ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­åˆ›å»ºä¸€ä¸ª&quot;Hello World!&quot;å¯¹è±¡ï¼Œç„¶åå°†å¸¸é‡æ± ä¸­&quot;Hello World!&quot;è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨åœ°å€èµ‹ç»™æ ˆä¸­çš„å¼•ç”¨aï¼Œè¿™æ ·æ ˆä¸­çš„å¼•ç”¨aå°±æŒ‡å‘äº†å¸¸é‡æ± ä¸­çš„&quot;Hello World!&quot;å¯¹è±¡ï¼›å¦‚æœå·²ç»å­˜åœ¨ï¼Œåˆ™ä¸ä¼šå†æ¬¡åˆ›å»ºæ–°å¯¹è±¡ï¼Œç›´æ¥å°†å·²æœ‰çš„&quot;Hello World!&quot;å¯¹è±¡çš„åœ°å€è¿”å›ï¼Œèµ‹ç»™æ ˆä¸­çš„å¼•ç”¨bï¼Œäºæ˜¯ï¼Œæ ˆä¸­çš„å¼•ç”¨bä¹ŸæŒ‡å‘äº†å¸¸é‡æ± ä¸­çš„&quot;Hello World!&quot;å¯¹è±¡ã€‚ å¸¸é‡æ± ä¸­çš„&quot;Hello World!&quot;å¯¹è±¡åªæœ‰ä¸€ä»½ï¼Œäºæ˜¯ä½¿ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒå˜é‡aå’Œbä¼šè¿”å›trueã€‚ ç¼–è¯‘å™¨çš„ä¼˜åŒ–æˆ‘ä»¬å†æ¥çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š 123456789101112131415public static void main(String[] args) { String m = &quot;a&quot;; final String n = &quot;a&quot;; String x = m + &quot;b&quot;; String y = n + &quot;b&quot;; String z = getA() + &quot;b&quot;; String compare = &quot;ab&quot;; System.out.println(x == compare); System.out.println(y == compare); System.out.println(z == compare);}public static String getA() { return &quot;a&quot;;} ä½ å¿ƒä¸­æœ‰ç­”æ¡ˆå—ï¼ŸçŸ¥é“æ¯ä¸ªç­”æ¡ˆçš„åŸç†å—ï¼Ÿ å¦‚æœè¿˜æ²¡æœ‰ï¼Œä¸‹é¢çš„å†…å®¹ä½ åº”è¯¥ä»”ç»†é˜…è¯»ã€‚ è¾“å‡ºç»“æœï¼š 123falsetruefalse é¦–å…ˆï¼Œç¬¬ä¸€ä¸ªè¾“å‡ºï¼Œå˜é‡xä¸compareæ¯”è¾ƒï¼Œå˜é‡xç­‰äºå±€éƒ¨å˜é‡måŠ ä¸Šå­—ç¬¦ä¸²&quot;b&quot;ï¼Œè™½ç„¶å±€éƒ¨å˜é‡mä¹ŸæŒ‡å‘äº†ä¸€ä¸ªå­—é¢é‡&quot;a&quot;ï¼Œä½†æ˜¯è¿™ä¸ªå¼•ç”¨å…³ç³»å¹¶æœªè¿›è¡Œâ€œå¼ºåˆ¶çº¦æŸâ€ï¼Œåœ¨è¿è¡ŒæœŸï¼Œå¯é€šè¿‡å­—èŠ‚ç å¢å¼ºæŠ€æœ¯æ¥åŠ¨æ€æ”¹å˜è¯¥å¼•ç”¨çš„æŒ‡å‘ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å¹¶æœªç›´æ¥å°†å…¶ä¼˜åŒ–æˆ&quot;ab&quot;ã€‚è€Œæ˜¯å°†å…¶ä¼˜åŒ–æˆäº†StringBuilderçš„å½¢å¼ï¼š 123StringBuilder temp = new StringBuilder();temp.append(m).append(&quot;b&quot;);String x = temp.toString(); ä½¿ç”¨newå…³é”®å­—åˆ›å»ºçš„StringBuilderå¯¹è±¡ä½äºå †å†…å­˜ä¸­ï¼Œäºæ˜¯å˜é‡xæŒ‡å‘äº†å †ä¸­çš„å¯¹è±¡ã€‚è€Œå±€éƒ¨å˜é‡compareæŒ‡å‘å­—é¢é‡&quot;ab&quot;ï¼ŒæŒ‰ç…§å‰æ–‡çš„å™è¿°ï¼ŒJVMå°†ä¼šå…ˆå»å­—ç¬¦ä¸²å¸¸é‡æ± å¯»æ‰¾&quot;ab&quot;å­—ç¬¦ä¸²å¯¹è±¡ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™ä¼šç›´æ¥è¿”å›å¸¸é‡æ± ä¸­åœ°å€è¿”å›ï¼Œèµ‹ç»™å¼•ç”¨compareã€‚ å˜é‡xæŒ‡å‘å †å†…å­˜ï¼Œè€Œå˜é‡compareæŒ‡å‘å¸¸é‡æ± å†…å­˜ï¼Œæ‰€ä»¥ä½¿ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒçš„ç»“æœä¸ºfalseã€‚ ç¬¬äºŒä¸ªè¾“å‡ºï¼Œå˜é‡yä¸compareæ¯”è¾ƒï¼Œå˜é‡yç­‰äºå±€éƒ¨å˜é‡nåŠ ä¸Šå­—ç¬¦ä¸²&quot;b&quot;ï¼Œè™½ç„¶ä¸å˜é‡xååˆ†ç±»ä¼¼ï¼Œä½†æ˜¯ï¼Œè¯·æ³¨æ„å±€éƒ¨å˜é‡nå‰é¢å£°æ˜çš„finalå…³é”®å­—ï¼Œå®ƒå…·æœ‰ä¸å¯å˜æ€§ï¼Œå³nåªä¼šè¢«èµ‹å€¼ä¸€æ¬¡ã€‚ä¿è¯äº†å±€éƒ¨å˜é‡nå§‹ç»ˆæŒ‡å‘å­—é¢é‡&quot;a&quot;æ‰€åœ¨çš„å†…å­˜åœ°å€ï¼ŒæŒ‰ç…§ç¨‹åºçš„é€»è¾‘é¡ºåºï¼Œå­—é¢é‡&quot;a&quot;æ­¤æ—¶å·²ç»å­˜åœ¨äºå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­äº†ï¼Œæ‰€ä»¥å±€éƒ¨å˜é‡nå§‹ç»ˆæŒ‡å‘å¸¸é‡æ± ä¸­&quot;a&quot;æ‰€åœ¨çš„å†…å­˜åœ°å€ã€‚è¿™ä¸ªå¼•ç”¨å…³ç³»æ˜¯æ— æ³•è¿›è¡Œä¿®æ”¹çš„ã€‚æ‰€ä»¥ç¼–è¯‘å™¨å°†å˜é‡yç›´æ¥ä¼˜åŒ–æˆäº†&quot;ab&quot;ã€‚ ç¬¬ä¸‰ä¸ªè¾“å‡ºï¼Œå˜é‡zä¸compareæ¯”è¾ƒï¼Œå˜é‡zç”±ä¸€ä¸ªæ–¹æ³•çš„è¿”å›å€¼åŠ ä¸Šå­—ç¬¦ä¸²&quot;b&quot;ç»„æˆï¼Œè™½ç„¶æ–¹æ³•å†…è¿”å›ä¸€ä¸ªå¸¸é‡çš„å¼•ç”¨ï¼Œä½†æ˜¯ç¼–è¯‘å™¨å¹¶ä¸ä¼šçœ‹æ–¹æ³•å†…è¿”å›äº†ä»€ä¹ˆï¼Œå› ä¸ºæ–¹æ³•å†…éƒ¨çš„è¡Œä¸ºæ˜¯æœªçŸ¥çš„ï¼Œå¯èƒ½ä¼šå‡ºç°å¤šé‡é€’å½’ï¼Œè€Œä¸”é€’å½’è¿‡åä¹Ÿä¸ä¸€å®šä¼šè¿”å›å›ºå®šçš„å¸¸é‡å€¼ã€‚æ‰€ä»¥ç¼–è¯‘å™¨ä¸ä¼šå°†å˜é‡zä¼˜åŒ–æˆ&quot;ab&quot;ã€‚ ç¼–è¯‘å™¨çš„ä»£ç ä¼˜åŒ–ä¸€å®šæ˜¯åœ¨ç¼–è¯‘æœŸå°±èƒ½ç¡®å®šä¼˜åŒ–åä¸ä¼šæ”¹å˜åŸæœ‰åŠŸèƒ½ï¼Œç±»ä¼¼äºfinalå¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨åªä¼šè¢«èµ‹å€¼ä¸€æ¬¡ã€‚åªæœ‰åœ¨ç¼–è¯‘é˜¶æ®µèƒ½ç¡®å®šè¿™ä¸ªå¼•ç”¨è¢«èµ‹å€¼çš„å†…å®¹ï¼Œç¼–è¯‘å™¨æ‰å¯èƒ½è¿›è¡Œç¼–è¯‘æœŸä¼˜åŒ–ï¼Œä¸è¦å’Œè¿è¡ŒæœŸçš„åŠ¨ä½œå…³è”åˆ°ä¸€èµ·ï¼Œç¼–è¯‘æœŸèƒ½ç¡®å®šçš„å†…å®¹åªæ¥æºäºå¸¸é‡æ± ï¼Œä½¿ç”¨newå…³é”®å­—åˆ›å»ºå¯¹è±¡å±äºè¿è¡ŒæœŸçš„åŠ¨ä½œã€‚åŒæ ·åœ°ï¼Œæ–¹æ³•çš„è¿”å›å€¼ä¹Ÿæ˜¯ä¸èƒ½ç¡®å®šçš„ï¼Œè¿è¡ŒæœŸçš„æ–¹æ³•å¯èƒ½ä¼šè¿”å›ä¸åŒçš„å€¼ã€‚ String#intern()æ–¹æ³•æœ‰äº†ä¸Šé¢çš„çŸ¥è¯†åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä»¥ä¸‹ä»£ç ï¼š 12345678910public static void main(String[] args) { String a = &quot;a&quot;; String b = a + &quot;b&quot;; String c = &quot;ab&quot;; String d = new String(b); System.out.println(b == c); System.out.println(c == d); System.out.println(c == d.intern()); System.out.println(b.intern() == d.intern());} è¿™æ®µä»£ç å¢åŠ äº†intern()æ–¹æ³•çš„è°ƒç”¨ï¼Œå…¶è¾“å‡ºç»“æœä¸ºï¼š 1234falsefalsetruetrue å¯¹äºå‰ä¸¤ä¸ªè¾“å‡ºï¼Œä½ åº”è¯¥èƒ½çŸ¥é“ç­”æ¡ˆã€‚ç¬¬ä¸€ä¸ªè¾“å‡ºåœ¨ä¸Šä¸€ä¸ªä¾‹å­ä¸­è®²è¿‡äº†ï¼Œè¾“å‡ºä¸ºfalseï¼›ç¬¬äºŒä¸ªè¾“å‡ºï¼Œå˜é‡cåœ¨å¸¸é‡æ± ä¸­ï¼Œå˜é‡dåœ¨å †ä¸­ï¼Œè¾“å‡ºä¸ºfalseã€‚ å¯¹äºåä¸¤ä¸ªè¾“å‡ºï¼Œå¦‚æœä½ ä¸äº†è§£intern()æ–¹æ³•çš„ä½œç”¨ï¼Œææ€•ä¸èƒ½ç»™å‡ºåˆç†çš„è§£é‡Šã€‚ å½“è°ƒç”¨Stringç±»çš„intern()æ–¹æ³•æ—¶ï¼ŒJVMä¼šåœ¨å¸¸é‡æ± ä¸­é€šè¿‡equals()æ–¹æ³•æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›å¸¸é‡æ± ä¸­çš„åœ°å€ï¼›å¦åˆ™ï¼Œåˆ™ä¼šå°†è¯¥å­—ç¬¦ä¸²åŠ å…¥å¸¸é‡æ± ï¼ˆå¼€è¾Ÿæ–°çš„å†…å­˜ç©ºé—´ï¼‰ï¼Œç„¶åè¿”å›å¸¸é‡æ± ä¸­æ–°å¼€è¾Ÿçš„è¿™å—å†…å­˜ç©ºé—´åœ°å€ã€‚æ‰€ä»¥ï¼Œåªè¦æ˜¯å€¼ç›¸ç­‰ï¼ˆequals()æ–¹æ³•æ¯”è¾ƒç›¸ç­‰ï¼‰çš„å­—ç¬¦ä¸²ï¼Œå½“è°ƒç”¨intern()æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šå¾—åˆ°å¸¸é‡æ± ä¸­å¯¹åº”å­—ç¬¦ä¸²çš„å¼•ç”¨åœ°å€ï¼Œæ‰€ä»¥ä½¿ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒä¼šè¿”å›trueã€‚ å¯¹äºç¬¬ä¸‰ä¸ªè¾“å‡ºï¼Œå˜é‡cä½¿ç”¨å­—é¢é‡èµ‹å€¼ï¼Œå¾—åˆ°çš„æ˜¯å¸¸é‡æ± ä¸­çš„å¼•ç”¨ï¼›è€Œå˜é‡dä½¿ç”¨newå…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªå †ä¸­å¯¹è±¡ï¼Œä½†è°ƒç”¨intern()æ–¹æ³•åå‘ç°å¸¸é‡æ± ä¸­å·²ç»å­˜åœ¨äº†&quot;ab&quot;ï¼Œæ‰€ä»¥è¿”å›å¸¸é‡æ± çš„å¼•ç”¨åœ°å€ï¼Œäºæ˜¯ä½¿ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒè¿”å›trueã€‚ å¯¹äºç¬¬å››ä¸ªè¾“å‡ºï¼Œå˜é‡bå’Œdéƒ½è°ƒç”¨äº†intern()æ–¹æ³•ï¼Œå¾—åˆ°çš„éƒ½æ˜¯å¸¸é‡æ± ä¸­çš„å¼•ç”¨åœ°å€ï¼Œè‡ªç„¶ä½¿ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒè¿”å›trueã€‚ StringBuilderå¯¹è±¡åœ¨é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œä¸­ï¼Œæ¨èåœ¨forå¾ªç¯ä½“å†…ä½¿ç”¨StringBuilderå¯¹è±¡çš„append()æ–¹æ³•è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œè€Œä¸æ˜¯+å·ã€‚ æ‰‹å†Œä¸­ç»™å‡ºçš„åä¾‹å¦‚ä¸‹ï¼š 1234String str = &quot;start&quot;;for (int i = 0;i &lt; 100;i++) { str = str + &quot;hello&quot;;} ç”±äºæ²¡æœ‰ç»™å‡ºæ­£ä¾‹ï¼Œæœ‰äº›äººåœ¨ç†è§£ä¸Šå¯èƒ½å‡ºç°äº†ä¸€äº›åå·®ï¼Œäºæ˜¯å‡ºç°äº†ä»¥ä¸‹ä»£ç ï¼š 1234567String str = &quot;start&quot;;for (int i = 0;i &lt; 100;i++) { StringBuilder sb = new StringBuilder(); sb.append(str) .append(&quot;hello&quot;); str = sb.toString();} å®é™…ä¸Šè¿™ä¹Ÿæ˜¯åä¾‹ï¼Œåªä¸è¿‡æ˜¯æ‰‹å†Œä¸­ç»™å‡ºçš„åä¾‹ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘ä¹‹åçš„ã€‚ é˜¿é‡Œå·´å·´çš„è¿™ä¸ªæ¨èçš„åˆè¡·æ˜¯ä¸è¦åœ¨å¾ªç¯ä½“å†…ä½¿ç”¨+å·ï¼Œå› ä¸º+å·ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–æˆStringBuilderå¯¹è±¡ï¼Œæ‰€ä»¥å®ƒçš„å»ºè®®å®é™…æ˜¯ä¸è¦åœ¨å¾ªç¯ä½“å†…åˆ›å»ºStringBuilderå¯¹è±¡ã€‚ æ­£ç¡®çš„å†™æ³•å¦‚ä¸‹ï¼š 1234567StringBuilder sb = new StringBuilder();String str = &quot;start&quot;;sb.append(str);for (int i = 0;i &lt; 100;i++) { sb.append(&quot;hello&quot;);}str = sb.toString(); ä¸ºä»€ä¹ˆè¿™æ ·å»ºè®®ï¼Ÿä½¿ç”¨+æœ‰ä»€ä¹ˆä¸å¥½çš„åœ°æ–¹ï¼Ÿ ä½¿ç”¨+å·å®é™…æ˜¯åœ¨å¾ªç¯ä½“å†…åˆ›å»ºäº†StringBuilderå¯¹è±¡ï¼Œè°ƒç”¨append()æ–¹æ³•æ‹¼æ¥åé‡æ–°ç»™å¼•ç”¨strèµ‹å€¼ï¼Œè¿™ä¼šå¯¼è‡´stræŒ‡å‘çš„å­—ç¬¦ä¸²è¶Šæ¥è¶Šå¤§ï¼Œåˆ°è¾¾ä¸€å®šç¨‹åº¦åä¼šè¿›å…¥è€å¹´ä»£ï¼Œç”šè‡³å‡ºç°OOMã€‚åŒæ—¶æ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªStringBuilderå¯¹è±¡ï¼Œåœ¨ä¸€æ¬¡å¾ªç¯ç»“æŸåï¼Œè¯¥å¯¹è±¡å°±ä¼šå˜æˆåƒåœ¾ç­‰å¾…å›æ”¶ï¼Œå¯¼è‡´å†…å­˜å¼€é”€å¢å¤§ã€‚ è€Œæ­£ç¡®çš„å†™æ³•ä¼šåœ¨å¾ªç¯ä½“å¤–é¢„å…ˆåˆ›å»ºä¸€ä¸ªStringBuilderå¯¹è±¡ï¼Œæ¯æ¬¡å¾ªç¯ä¸­éƒ½è°ƒç”¨è¯¥å¯¹è±¡çš„append()æ–¹æ³•æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œé¿å…äº†å†…å­˜å¼€é”€å¤§çš„æƒ…å†µã€‚ å°ç»“ï¼šè¦æ˜ç¡®çš„ä¸€ç‚¹æ˜¯ï¼Œä¸æ˜¯+å·æ“ä½œæœ¬èº«æ…¢ï¼Œè€Œæ˜¯åœ¨å¾ªç¯ä½“ä¸­æ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºå¯¹è±¡å¯¼è‡´å†…å­˜å¼€é”€å˜å¤§ï¼Œæ¯ä¸€æ¬¡å¾ªç¯åï¼Œåˆ›å»ºçš„å¯¹è±¡å˜æˆäº†åƒåœ¾å¼•å‘GCè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå¯¼è‡´ç¨‹åºå˜æ…¢ã€‚ æ€»ç»“å…³äºStringç±»ï¼Œæœ¬æ–‡åªæ˜¯æŠ›ç –å¼•ç‰ï¼Œå¾ˆå¤šç»†èŠ‚å¹¶æœªæåŠï¼Œä¾‹å¦‚StringBuilderåœ¨è¿›è¡Œappendæ—¶çš„æ‰©å®¹ï¼Œåœ¨æ‹¼æ¥å¤§å­—ç¬¦ä¸²å’Œå°å­—ç¬¦ä¸²æ—¶å¦‚ä½•åˆç†ä½¿ç”¨è®©å†…å­˜åˆ©ç”¨ç‡æ›´é«˜ï¼Œè¿˜åŒ…æ‹¬StringBufferåŒæ­¥ç±»ç­‰å…¶å®ƒå­—ç¬¦ä¸²ç›¸å…³çš„å†…å®¹ã€‚æ€»ä¹‹ï¼Œå­—ç¬¦ä¸²æ˜¯å¼€å‘ä¸­å¿…å®šä¼šä½¿ç”¨åˆ°çš„æ•°æ®ç±»å‹ï¼Œå¦‚æœæ¶‰åŠåˆ°å­—ç¬¦ä¸²æ“ä½œï¼Œè¯·ä¸€å®šè¦è€ƒè™‘åˆ°æ•ˆç‡é—®é¢˜ï¼Œä»å°çš„ç»†èŠ‚å…¥æ‰‹ç²¾å¿ƒé›•ç¢ä»£ç ã€‚","link":"/2020/06/29/javase/base/string/"},{"title":"å‹‡é—¯ç®—æ³•-é€’å½’æ³•æ‹¿ä¸‹åè½¬é“¾è¡¨çš„ä¸‰æ€","text":"å‰è¨€ç¼–ç¨‹è¯­è¨€ï¼šJavaï¼ˆJDK8ï¼‰ å•é“¾è¡¨èŠ‚ç‚¹ç±»ï¼š 12345public class ListNode { int val; ListNode next; ListNode(int x) { val = x; }} å…³äºåè½¬é“¾è¡¨ï¼Œæœ‰è¿­ä»£å’Œé€’å½’ä¸¤ç§å®ç°æ–¹å¼ï¼Œæœ¬æ–‡ä½¿ç”¨é€’å½’å®ç°åè½¬ã€‚ é¦–å…ˆä»‹ç»é€’å½’çš„æ€æƒ³ï¼Œç„¶åä»æœ€åŸºæœ¬çš„åè½¬æ•´ä¸ªå•é“¾è¡¨å¼€å§‹ï¼Œç”±æµ…å…¥æ·±ï¼Œæœ€ç»ˆæ‹¿ä¸‹åè½¬é“¾è¡¨çš„â€œä¸‰æ€â€ï¼ é€’å½’æ€æƒ³ ä»»ä½•ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœèƒ½å¤Ÿç”¨è¿­ä»£è§£å†³ï¼Œé‚£ä¹ˆä¸€å®šå¯ä»¥è½¬æ¢æˆé€’å½’ã€‚ â€”â€” æŸç®—æ³•å¤§ç¥ æˆ‘ä»¬å¾ˆéš¾å»è¯æ˜å¤§ç¥çš„è¯´æ³•ä¸æ­£ç¡®ï¼Œä½†æˆ‘ä»¬å¯ä»¥å…ˆå‡è®¾ä»–çš„ç†è®ºæˆç«‹ã€‚å…ˆå¼ºè¡Œè®©è‡ªå·±æ¥å—ã€‚ æ©ï¼æ²¡é”™ï¼èƒ½å¤Ÿç”¨è¿­ä»£è§£å†³å°±ä¸€å®šèƒ½ç”¨é€’å½’è§£å†³ï¼ æ˜¯ä¸æ˜¯æœ‰é€’å½’â€œå†…å‘³â€äº†ï¼Ÿå…ˆå‡è®¾æ¡ä»¶æˆç«‹ï¼ŒæŠŠä¸»è¦é€»è¾‘èµ°é€šã€‚ é‚£ä¹ˆåˆ°åº•å¦‚ä½•å°†è¿­ä»£è½¬æ¢æˆé€’å½’å‘¢ï¼Ÿ è¿­ä»£æ˜¯éå†ï¼Œä¸€ä¸ªä¸€ä¸ªåœ°è¿›è¡Œè¿­ä»£å¤„ç†ï¼› è€Œé€’å½’å‘¢ï¼Ÿåœ¨å¤„ç†ç¬¬ä¸€ä¸ªçš„æ—¶å€™è¦å…ˆå‡è®¾åé¢çš„å…¨éƒ¨éƒ½å¤„ç†å®Œäº†ï¼Œåªéœ€å¤„ç†ç¬¬ä¸€ä¸ªï¼Œæ‰€ä»¥ï¼Œåªè¦ç¬¬ä¸€ä¸ªå¤„ç†å®Œäº†ï¼Œæ•´ä¸ªå°±å¤„ç†å®Œäº†ï¼ˆæ„Ÿè§‰å®Œå…¨æ— æ³•æ¥å—å•Šï¼‰ã€‚ â€œå‡è®¾â€å§‹ç»ˆæ˜¯å‡è®¾ï¼Œä½†æ˜¯å®ƒèƒ½è®©æˆ‘ä»¬çš„å½“å‰é€»è¾‘èµ°é€šã€‚åœ¨ç¬¬ä¸€æ¬¡çš„å‡è®¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œç¬¬äºŒæ¬¡åœ°å‡è®¾ï¼Œå‡è®¾åé¢çš„æ•°æ®çš„ç¬¬ä¸€ä¸ªä¹‹åçš„æ•°æ®å…¨éƒ½å¤„ç†å®Œäº†ï¼Œåˆ™åªéœ€å¤„ç†æ­¤æ—¶çš„ç¬¬ä¸€ä¸ªã€‚è¿™æ ·ä¸åœåœ°å‡è®¾ä¸‹å»ï¼Œç›´åˆ°å‡è®¾åˆ°æ•´ä½“çš„æœ€åä¸€ä¸ªæ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™æ²¡æœ‰æ•°æ®è®©æˆ‘ä»¬å‡è®¾äº†ï¼Œä¸èƒ½å†â€œéª—è‡ªå·±â€äº†ï¼è¦æ‹¿å‡ºç‚¹çœŸæœ¬äº‹æ¥ï¼æˆ‘ä»¬å¯¹æ•´ä½“çš„æœ€åä¸€ä¸ªæ•°æ®è¿›è¡ŒçœŸå®çš„å¤„ç†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°ï¼Œå€’æ•°ç¬¬äºŒä¸ªæ•°æ®çš„å‡è®¾æˆç«‹äº†ï¼å¤šç±³åŒéª¨ç‰Œæ•ˆåº”ï¼ä¹‹å‰æ‰€æœ‰çš„å‡è®¾éƒ½æˆç«‹äº†ï¼é—®é¢˜è§£å†³äº†ï¼ First Bloodï¼šåè½¬æ•´ä¸ªå•é“¾è¡¨é¦–å…ˆç”¨é€’å½’æ¥è§£å†³æœ€åŸºæœ¬çš„æ•´ä¸ªå•é“¾è¡¨çš„åè½¬ã€‚ï¼ˆâ€œå¯¹é¢è¾…åŠ©å¼€å§‹æäº‹æƒ…äº†â€ï¼‰ ä¾‹å¦‚ï¼šå•é“¾è¡¨ä¸ºï¼š1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; nullï¼Œé‚£ä¹ˆåè½¬ä¹‹åçš„å•é“¾è¡¨ä¸ºï¼šnull &lt;- 1 &lt;- 2 &lt;- 3 &lt;- 4 &lt;- 5ã€‚ å¯¹åº”ä¸Šé¢çš„é€’å½’æ€æƒ³ï¼šåœ¨åè½¬ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå…ˆå‡è®¾åé¢çš„èŠ‚ç‚¹å…¨éƒ½åè½¬å®Œäº†ï¼Œè¿”å›äº†åè½¬åçš„å¤´èŠ‚ç‚¹ï¼Œå®ƒå°±æ˜¯æ•´ä¸ªå•é“¾è¡¨åè½¬å®Œæˆåçš„å¤´èŠ‚ç‚¹ï¼Œäºæ˜¯æˆ‘ä»¬åªéœ€å°†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œåè½¬ï¼Œæ•´ä¸ªé“¾è¡¨çš„åè½¬å°±å®Œæˆäº†ã€‚åœ¨ç¬¬ä¸€æ¬¡å‡è®¾ä¸­ï¼ŒåŒæ ·è¿›è¡Œå‡è®¾ï¼Œä¸åœåœ°å‡è®¾ï¼Œç›´åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œåé¢æ²¡æœ‰èŠ‚ç‚¹è®©æˆ‘ä»¬è¿›è¡Œå‡è®¾äº†ï¼Œæˆ‘ä»¬è¿›è¡ŒçœŸå®çš„åè½¬ã€‚è¿™æ—¶ä¹‹å‰æ‰€æœ‰çš„å‡è®¾åƒå¤šç±³åŒéª¨ç‰Œä¸€æ ·åœ°æˆç«‹äº†ï¼Œæ•´ä¸ªå•é“¾è¡¨åè½¬å®Œæˆï¼ å¥½åƒæ— æ³•ç†è§£ï¼Ÿæ²¡å…³ç³»ï¼ŒæŒ‰é€’å½’çš„æ€æƒ³ï¼Œå…ˆå‡è®¾è‡ªå·±ç†è§£äº†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹ä»£ç ï¼š 12345678910111213public static ListNode reverse(ListNode head) { // æœ€åä¸€ä¸ªèŠ‚ç‚¹ if (head.next == null) // ä¸èƒ½å†â€œéª—è‡ªå·±â€äº† return head; // å‡è®¾åé¢çš„èŠ‚ç‚¹å…¨éƒ½åè½¬å®Œæˆï¼Œè¿”å›äº†åè½¬åçš„å¤´èŠ‚ç‚¹ï¼Œå³ä¸ºæ•´ä¸ªå•é“¾è¡¨åè½¬åçš„å¤´èŠ‚ç‚¹ ListNode reverseHead = reverse(head.next); // åè½¬ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ head.next.next = head; head.next = null; // è¿”å›åè½¬åçš„å¤´èŠ‚ç‚¹ return reverseHead;} reverseå‡½æ•°çš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼šè¾“å…¥ä¸€ä¸ªèŠ‚ç‚¹headï¼Œå°†ä»¥headä¸ºå¤´èŠ‚ç‚¹çš„é“¾è¡¨åè½¬ï¼Œè¿”å›åè½¬åçš„å¤´èŠ‚ç‚¹ã€‚ æˆ‘ä»¬è¦åè½¬çš„é“¾è¡¨ä¸ºï¼š1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; nullï¼š reverse(1)ï¼šè¾“å…¥ç¬¬ä¸€ä¸ªèŠ‚ç‚¹1æ—¶ï¼› å‡è®¾åé¢çš„èŠ‚ç‚¹å·²ç»åè½¬å®Œæˆå¹¶è¿”å›äº†åè½¬åçš„å¤´èŠ‚ç‚¹ï¼šListNode reverseHead = reverse(head.next); åé¢çš„èŠ‚ç‚¹åè½¬åçš„ç»“æœä¸ºï¼šnull &lt;- 2 &lt;- 3 &lt;- 4 &lt;- 5ï¼Œè¿”å›çš„å¤´èŠ‚ç‚¹reverseHeadä¸º5ï¼› æ­¤æ—¶æˆ‘ä»¬åªéœ€è¦å¯¹èŠ‚ç‚¹1è¿›è¡Œåè½¬ï¼š 1234// å°†èŠ‚ç‚¹1çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹2çš„æŒ‡é’ˆåŸŸæŒ‡å‘èŠ‚ç‚¹1head.next.next = head;// å°†èŠ‚ç‚¹1çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘nullhead.next = null; æ•´ä¸ªé“¾è¡¨çš„åè½¬å°±å®Œæˆäº†ï¼ ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½â€œéª—è‡ªå·±â€ï¼reverseå‡½æ•°ä¸åœåœ°è¿›è¡Œå‡è®¾ï¼Œå½“å®ƒæ¥æ”¶åˆ°åŸé“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œæ²¡æœ‰èŠ‚ç‚¹è¿›è¡Œå‡è®¾äº†ï¼Œå¿…é¡»å»åè½¬ï¼ ç”±äºåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåè½¬åè¿˜æ˜¯è‡ªèº«ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¿”å›è¯¥èŠ‚ç‚¹ï¼Œå³ä¸ºåè½¬åçš„å¤´èŠ‚ç‚¹ã€‚è¿™æ—¶æˆ‘ä»¬æƒŠå¥‡çš„å‘ç°å‰é¢æ‰€æœ‰çš„å‡è®¾éƒ½æˆç«‹äº†ï¼ è¿™å°±æ˜¯æ‰€è°“çš„é€’å½’çš„å‡ºå£ï¼š 12if (head.next == null) return head; æˆ‘ä»¬ç”»å¼ å›¾æ¥çœ‹ä¸‹æ•´ä¸ªæµç¨‹ã€‚ æˆ‘ä»¬çš„é€’å½’ç®—æ³•åªéœ€è¦å…³æ³¨åŸé“¾è¡¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå¤´èŠ‚ç‚¹ï¼‰å’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå°¾èŠ‚ç‚¹ï¼‰ï¼Œä¹Ÿå°±æ˜¯é€’å½’å¼€å§‹çš„èŠ‚ç‚¹å’Œæ— æ³•å†è¿›è¡Œå‡è®¾çš„èŠ‚ç‚¹ã€‚åœ¨é€’å½’å‡½æ•°ä¸­ï¼Œé¦–å…ˆè¦å¤„ç†å°¾èŠ‚ç‚¹ï¼Œå› ä¸ºè¿™æ˜¯ä¸å¯å†å‡è®¾çš„èŠ‚ç‚¹ï¼›å½“å¤„ç†å¤´èŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬è¿›è¡Œå‡è®¾ï¼Œå‡è®¾å¤´èŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å·²å®Œæˆåè½¬åŒæ—¶è¿”å›äº†åè½¬åçš„æ–°å¤´èŠ‚ç‚¹ï¼Œç„¶åå¯¹å¤´èŠ‚ç‚¹è¿›è¡Œåè½¬ï¼Œæ­¤æ—¶å°±å®Œæˆäº†æ•´ä¸ªå•é“¾è¡¨çš„åè½¬ã€‚ å­¦ä¼šäº†é€’å½’æ€æƒ³åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„å¼€å§‹â€œä¸‰æ€â€ä¹‹æ—…äº†ï¼ Double Killï¼šåè½¬å•é“¾è¡¨çš„å‰Nä¸ªèŠ‚ç‚¹æœ‰äº†ä¸Šé¢çš„â€œä¸€è¡€â€ï¼Œâ€œåŒæ€â€ç®€ç›´å°±æ˜¯ç™½é€ï¼ï¼ˆâ€œè¾…åŠ©æ­»äº†ï¼ŒADCå¼€å§‹é€äº†â€ï¼‰ æˆ‘ä»¬è¦å®ç°çš„å‡½æ•°å¦‚ä¸‹ï¼š 123456/** * å°†å•é“¾è¡¨çš„å‰nä¸ªèŠ‚ç‚¹è¿›è¡Œåè½¬ã€‚ï¼ˆn &lt;= å•é“¾è¡¨é•¿åº¦ï¼‰ * @param head å•é“¾è¡¨å¤´èŠ‚ç‚¹ * @param n å‰nä¸ªèŠ‚ç‚¹ */public ListNode reverseN(ListNode head,int n) {...} å‡è®¾æˆ‘ä»¬è¦åè½¬å•é“¾è¡¨çš„å‰3ä¸ªå…ƒç´ ï¼Œé‚£æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æŒ‰ç…§é€’å½’æ€æƒ³ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨é€’å½’å¼€å§‹çš„èŠ‚ç‚¹å’Œæ— æ³•å†è¿›è¡Œå‡è®¾çš„èŠ‚ç‚¹ï¼šå³å¤´èŠ‚ç‚¹å’Œç¬¬Nä¸ªèŠ‚ç‚¹ã€‚ å¯¹äºåŸå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œå…ˆå‡è®¾å…¶åé¢çš„N - 1ä¸ªèŠ‚ç‚¹å·²ç»åè½¬å®Œæˆå¹¶è¿”å›äº†åè½¬åçš„æ–°å¤´èŠ‚ç‚¹ï¼Œæ­¤æ—¶æˆ‘ä»¬åªéœ€è¦åè½¬å¤´èŠ‚ç‚¹ï¼Œå°†å¤´èŠ‚ç‚¹æŒ‡å‘ç¬¬N + 1ä¸ªèŠ‚ç‚¹ï¼Œé“¾è¡¨å‰Nä¸ªèŠ‚ç‚¹çš„åè½¬å°±å®Œæˆäº†ã€‚ä½†æ˜¯æ­¤æ—¶ç¬¬N + 1ä¸ªèŠ‚ç‚¹æˆ‘ä»¬æ— æ³•å¾—çŸ¥ã€‚ ç”±äºå•é“¾è¡¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬åªæœ‰éå†åˆ°ç¬¬Nä¸ªèŠ‚ç‚¹æ—¶æ‰èƒ½å¾—åˆ°ç¬¬N + 1ä¸ªèŠ‚ç‚¹ï¼Œé‚£æˆ‘ä»¬æœ‰å¿…è¦å•ç‹¬å¯¹é“¾è¡¨è¿›è¡Œéå†è·å–ç¬¬N + 1ä¸ªèŠ‚ç‚¹å—ï¼Ÿ å®Œå…¨æ²¡å¿…è¦ï¼å› ä¸ºæˆ‘ä»¬çš„é€’å½’ç®—æ³•æœ¬èº«ä¸€å¼€å§‹å°±è¦å¤„ç†ç¬¬â€œNâ€ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒæ˜¯æ— æ³•å†è¿›è¡Œå‡è®¾çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥ï¼Œé€’å½’å‡½æ•°ä¸­ç¬¬ä¸€æ­¥å¤„ç†ç¬¬â€œNâ€ä¸ªèŠ‚ç‚¹æ—¶è¦è®°å½•ä¸‹ç¬¬N + 1ä¸ªèŠ‚ç‚¹ï¼ˆä½¿ç”¨å…¨å±€å˜é‡ï¼‰ã€‚æ³¨æ„ï¼šè¿™é‡Œçš„ç¬¬Nä¸ªèŠ‚ç‚¹æ˜¯é’ˆå¯¹åŸå•é“¾è¡¨è€Œè¨€çš„ï¼›å¯¹äºæœ€åä¸€ä¸ªæ— æ³•å†è¿›è¡Œå‡è®¾çš„å‡è®¾æ¥è¯´ï¼šN = 1ã€‚ äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥å®Œæˆå¯¹åŸé“¾è¡¨å¤´èŠ‚ç‚¹çš„åè½¬ã€‚ä»è€Œå®Œæˆæ•´ä¸ªå•é“¾è¡¨çš„å‰Nä¸ªèŠ‚ç‚¹åè½¬ï¼š 1234567891011121314151617181920/** * è®°å½•åŸé“¾è¡¨çš„ç¬¬N+1ä¸ªèŠ‚ç‚¹ */static ListNode nNext;public static ListNode reverseN(ListNode head,int n) { if (n == 1) { // è®°å½•åŸé“¾è¡¨çš„ç¬¬ n + 1 ä¸ªèŠ‚ç‚¹ nNext = head.next; // æ— æ³•å†è¿›è¡Œå‡è®¾äº†ï¼Œè¿”å›åè½¬åçš„å¤´èŠ‚ç‚¹ return head; } // å‡è®¾åé¢èŠ‚ç‚¹çš„å‰ N - 1 ä¸ªèŠ‚ç‚¹å·²ç»å®Œæˆäº†åè½¬ï¼Œå¹¶è¿”å›äº†åè½¬åçš„æ–°å¤´èŠ‚ç‚¹ ListNode reverseHead = reverseN(head.next,n - 1); // åè½¬åŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹ head.next.next = head; head.next = nNext; // è¿”å›åè½¬åçš„æ–°å¤´èŠ‚ç‚¹ return reverseHead;} â€œåŒæ€â€æ‹¿ä¸‹ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æŒæ¡åˆ°é€’å½’çš„å¥—è·¯ï¼Ÿï¼ˆâ€œæ­¤æ—¶å¯¹é¢æ‰“é‡èµ¶åˆ°ä¸‹è·¯ï¼Œå³å°†é€å‡ºä¸‰æ€â€ï¼‰ Triple Killï¼šåè½¬å•é“¾è¡¨çš„ç¬¬mä¸ªåˆ°ç¬¬nä¸ªèŠ‚ç‚¹ç»™å®šå•é“¾è¡¨çš„ç´¢å¼•åŒºé—´[m,n]ï¼ˆçº¦å®šä¸è¶Šç•Œï¼‰ï¼Œåè½¬æ­¤åŒºé—´å†…çš„èŠ‚ç‚¹ã€‚ï¼ˆâ€œæ•Œæ–¹æ‰“é‡æ­£åœ¨è·¯ä¸Šâ€ï¼‰ å·²çŸ¥æ¡ä»¶ä¸ºï¼šå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹å’ŒåŒºé—´mã€nçš„å€¼ï¼Œæˆ‘ä»¬è¦å®ç°çš„å‡½æ•°å¦‚ä¸‹ï¼š 1234567/** * åè½¬ä»måˆ°nä¹‹é—´çš„èŠ‚ç‚¹ã€‚1 &lt;= m &lt; n &lt;= é“¾è¡¨é•¿åº¦ * @param head åŸé“¾è¡¨å¤´èŠ‚ç‚¹ * @param m åè½¬å¼€å§‹èŠ‚ç‚¹ * @param n åè½¬ç»“æŸèŠ‚ç‚¹ */public static ListNode reverseBetweenMToN(ListNode head,int m,int n); ä¾‹å¦‚ï¼šå•é“¾è¡¨ä¸ºï¼š1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; nullï¼Œm = 2, n = 4ï¼Œé‚£ä¹ˆåè½¬ä¹‹åçš„å•é“¾è¡¨ä¸ºï¼š1 -&gt; 4 -&gt; 3 -&gt; 2 -&gt; 5 -&gt; nullã€‚ æŒ‰ç…§é€’å½’çš„æ€æƒ³ï¼Œæˆ‘ä»¬åœ¨å¤„ç†å¤´èŠ‚ç‚¹headæ—¶ï¼Œå…ˆå‡è®¾åé¢çš„èŠ‚ç‚¹å·²ç»åè½¬å®Œæˆå¹¶è¿”å›äº†åè½¬åçš„æ–°å¤´èŠ‚ç‚¹ï¼Œé‚£ä¹ˆåªéœ€å°†å¤´èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘åè½¬åçš„æ–°å¤´èŠ‚ç‚¹å°±å®Œæˆäº†éœ€æ±‚ã€‚ å¯¹äºå»é™¤å¤´èŠ‚ç‚¹headä¹‹åçš„é“¾è¡¨ï¼Œæˆ‘ä»¬éœ€è¦åè½¬çš„æ˜¯ä»m - 1åˆ°n - 1åŒºé—´å†…çš„èŠ‚ç‚¹ï¼š 12head.next = reverseBetweenMToN(head.next,m - 1,n - 1);return head; é‚£æŒ‰ç…§é€’å½’æ€æƒ³ï¼Œæˆ‘ä»¬ä»€ä¹ˆæ—¶å€™ä¸èƒ½å†â€œéª—è‡ªå·±â€äº†å‘¢ï¼Ÿå½“å‡è®¾åˆ°åŸé“¾è¡¨çš„ç¬¬mä¸ªèŠ‚ç‚¹æ—¶ï¼Œå¯¹äºè¿™ä¸ªå‡è®¾æ¥è¯´ï¼Œæ˜¯è¿™ä¸ªå‡è®¾çš„ç¬¬1ä¸ªèŠ‚ç‚¹ï¼Œæ­¤æ—¶è¿™ä¸ªå‡è®¾éœ€è¦åè½¬ä»ç¬¬1ä¸ªåˆ°ç¬¬n - m + 1 = nä¸ªèŠ‚ç‚¹ï¼Œè¿™ä¸æ­£æ˜¯Double Killä¸­çš„åè½¬å•é“¾è¡¨çš„å‰Nä¸ªèŠ‚ç‚¹å—ï¼Ÿ äºæ˜¯é€’å½’å‡½æ•°å®Œæ•´å®ç°ä¸ºï¼š 1234567public static ListNode reverseBetweenMToN(ListNode head,int m,int n) { if (m == 1) { return reverseN(head,n); } head.next = reverseBetweenMToN(head.next,m - 1,n - 1); return head;} â€œä¸‰æ€â€æ‹¿ä¸‹ï¼ æ€»ç»“æŒæ¡é€’å½’çš„æ€æƒ³å¾ˆé‡è¦ï¼šå¤„ç†ç¬¬ä¸€ä¸ªæ—¶ï¼Œå…ˆå‡è®¾åé¢çš„å…¨éƒ¨éƒ½å¤„ç†å®Œäº†ï¼Œåªéœ€å¤„ç†ç¬¬ä¸€ä¸ªï¼›ä¸åœåœ°å‡è®¾ï¼Œç›´åˆ°ä¸èƒ½å†å‡è®¾çš„æ—¶å€™ï¼Œå¼€å§‹çœŸæ­£è¿›è¡Œå¤„ç†ï¼›è¿™æ ·å‰é¢æ‰€æœ‰çš„å‡è®¾å°±åƒå¤šç±³åŒéª¨ç‰Œæ•ˆåº”ä¸€æ ·å…¨éƒ½æˆç«‹äº†ï¼Œæœ€ç»ˆï¼Œé—®é¢˜å°±è§£å†³äº†ã€‚ é€’å½’è™½å¥½ï¼Œä½†å´ä¸å¦‚è¿­ä»£æ³•é«˜æ•ˆï¼Œè™½ç„¶æ—¶é—´å¤æ‚åº¦éƒ½ä¸ºO(N)ï¼Œä½†å› ä¸ºé€’å½’éœ€è¦ç”³è¯·é¢å¤–çš„æ ˆç©ºé—´ï¼Œæ‰€ä»¥å…¶ç©ºé—´å¤æ‚åº¦ä¸ºO(N)ï¼Œè€Œè¿­ä»£æ³•çš„ç©ºé—´å¤æ‚åº¦ä»…ä¸ºO(1)ã€‚","link":"/2020/06/04/algorithm/base/recursive-reverse-link/"},{"title":"JDKæºç è§£æä¹‹ArrayList","text":"ç®€ä»‹ArrayListåº•å±‚æ•°æ®ç»“æ„æ˜¯åŠ¨æ€æ•°ç»„ï¼Œä¸æ™®é€šçš„æ•°ç»„ç›¸æ¯”ï¼Œå®ƒçš„å®¹é‡å¯ä»¥åŠ¨æ€å¢é•¿ã€‚åœ¨æ·»åŠ çš„å…ƒç´ æ•°é‡è¾¾åˆ°ä¸€å®šå€¼æ—¶ï¼Œä¼šè§¦å‘è‡ªåŠ¨æ‰©å®¹æœºåˆ¶ï¼Œä¿è¯é›†åˆçš„å¯ç”¨æ€§ã€‚ å®ƒç»§æ‰¿äº†AbstractListæŠ½è±¡ç±»ï¼Œå¹¶å®ç°äº†Listã€RandomAccessã€Cloneable å’Œ java.io.Serializableæ¥å£ã€‚ AbstractListæŠ½è±¡ç±»å·²ç»å®ç°äº†Listæ¥å£ï¼Œä¸ºä»€ä¹ˆArrayListè¿˜è¦å»å®ç°Listæ¥å£ï¼Ÿ ç”±äºåº•å±‚ç”±æ•°ç»„å­˜å‚¨å…ƒç´ ï¼Œå…¶å–æŒ‡å®šä¸‹æ ‡ä½ç½®å…ƒç´ ã€åœ¨é›†åˆå°¾éƒ¨æ’å…¥å…ƒç´ å’Œæ±‚æ•°ç»„é•¿åº¦çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼›è€Œåœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚ ä½¿ç”¨åˆ†æåœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šç»å¸¸ä½¿ç”¨ArrayListæ¥å­˜å‚¨å¯¹è±¡ï¼Œä¾‹å¦‚å¯¹æ•°æ®åº“æ‰¹é‡æ’å…¥/ä¿®æ”¹çš„å…¥å‚å®ä½“é›†åˆã€æ•°æ®åº“çš„åˆ—è¡¨æŸ¥è¯¢ç»“æœé›†è½¬æ¢æˆå‰ç«¯è§†å›¾æ¨¡å‹å¯¹è±¡ç­‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬çš„ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š 12345678910111213141516// æ— å‚æ„é€ List&lt;String&gt; list = new ArrayList&lt;&gt;();// è¿ç»­æ·»åŠ 10ä¸ªå…ƒç´ list.add(&quot;a&quot;);list.add(&quot;b&quot;);list.add(&quot;c&quot;);list.add(&quot;d&quot;);list.add(&quot;e&quot;);list.add(&quot;f&quot;);list.add(&quot;g&quot;);list.add(&quot;h&quot;);list.add(&quot;i&quot;);list.add(&quot;j&quot;);// æ·»åŠ ç¬¬11ä¸ªå…ƒç´ list.add(&quot;k&quot;);// do other è¿™æ ·ä½¿ç”¨ä¼¼ä¹æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†è¿™å´ä¸æ˜¯ä¸€ä¸ªåŒ å¿ƒç¨‹åºå‘˜è¯¥å†™å‡ºæ¥çš„ä»£ç ã€‚ ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ArrayListåº•å±‚æ˜¯åŠ¨æ€æ•°ç»„ï¼Œé‚£è¿™ä¸ªæ•°ç»„ä»€ä¹ˆæ—¶å€™è¿›è¡ŒåŠ¨æ€å‘¢ï¼Ÿæ¢å¥è¯è¯´ï¼Œæ•°ç»„ä»€ä¹ˆæ—¶å€™ä¼šè¿›è¡Œæ‰©å®¹ï¼Ÿåˆæ‰©å®¹åˆ°å¤šå°‘å‘¢ï¼Ÿ ä»¥ä¸Šä»£ç æ‰§è¡Œå®Œååˆ°åº•æœ‰æ²¡æœ‰è¿›è¡Œæ‰©å®¹ï¼Ÿè¿™äº›éƒ½æ˜¯é—®é¢˜ï¼Œè®©æˆ‘ä»¬å¸¦ç€è¿™äº›é—®é¢˜æ¥çœ‹ä¸‹é¢çš„æºç ã€‚ æºç è¯¦è§£æˆå‘˜å˜é‡1234567891011121314151617181920212223242526272829303132333435363738/** * åºåˆ—åŒ–ID */private static final long serialVersionUID = 8683452581122892189L;/** * é»˜è®¤åˆå§‹å®¹é‡ */private static final int DEFAULT_CAPACITY = 10;/** * ç”¨äºç©ºArrayListå®ä¾‹çš„å…±äº«ç©ºæ•°ç»„å®ä¾‹ */private static final Object[] EMPTY_ELEMENTDATA = {};/** * å…±äº«çš„ç©ºæ•°ç»„å®ä¾‹ï¼Œç”¨äºé»˜è®¤å¤§å°çš„ç©ºå®ä¾‹ã€‚ * å°†è¯¥æˆå‘˜å˜é‡ä¸EMPTY_ELEMENTDATAåŒºåˆ†å¼€æ¥ï¼Œä»¥äº†è§£æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶éœ€è¦å¡«å……å¤šå°‘ã€‚ */private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};/** * å­˜å‚¨ArrayListçš„å…ƒç´ çš„æ•°ç»„ç¼“å†²åŒºã€‚ArrayListçš„å®¹é‡æ˜¯æ­¤æ•°ç»„ç¼“å†²åŒºçš„é•¿åº¦ã€‚ * æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œä»»ä½•å…·æœ‰elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATAçš„ç©ºArrayListéƒ½å°†æ‰©å±•ä¸ºDEFAULT_CAPACITYã€‚ * éç§æœ‰æˆå‘˜ä»¥ç®€åŒ–åµŒå¥—ç±»è®¿é—®ã€‚ */transient Object[] elementData;/** * ArrayListçš„å¤§å°ï¼ˆå®ƒåŒ…å«çš„å…ƒç´ ä¸ªæ•°ï¼‰ã€‚ */private int size;/** * åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°ã€‚æŸäº›VMåœ¨æ•°ç»„ä¸­ä¿ç•™ä¸€äº›æ ‡å¤´å­—ã€‚ * å°è¯•åˆ†é…æ›´å¤§çš„æ•°ç»„å¯èƒ½ä¼šå¯¼è‡´OutOfMemoryErrorï¼šè¯·æ±‚çš„æ•°ç»„å¤§å°è¶…å‡ºVMé™åˆ¶ã€‚ */private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8; æ„é€ å™¨æ— å‚æ„é€ æ„é€ ä¸€ä¸ªåˆå§‹å®¹é‡ä¸º10çš„ç©ºåˆ—è¡¨ã€‚å°†DEFAULTCAPACITY_EMPTY_ELEMENTDATAç©ºåˆ—è¡¨èµ‹ç»™å­˜å‚¨å…ƒç´ çš„elementDataæ•°ç»„ç¼“å†²åŒºã€‚ 123public ArrayList() { this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;} æœ‰å‚æ„é€ 1ã€ æ„é€ ä¸€ä¸ªå…·æœ‰æŒ‡å®šåˆå§‹å®¹é‡çš„ç©ºåˆ—è¡¨ã€‚å…¥å‚initialCapacityä¸ºåˆ—è¡¨çš„æŒ‡å®šåˆå§‹å®¹é‡ï¼Œå¦‚æœä¸ºè´Ÿæ•°åˆ™æŠ›å‡ºIllegalArgumentExceptionå¼‚å¸¸ã€‚ 123456789101112public ArrayList(int initialCapacity) { if (initialCapacity &gt; 0) { // åˆ›å»ºinitialCapacityå¤§å°çš„Objectç±»æ•°ç»„ã€‚ this.elementData = new Object[initialCapacity]; } else if (initialCapacity == 0) { // æŒ‡å®šå®¹é‡ä¸º0ï¼Œèµ‹å€¼é™æ€ç©ºæ•°ç»„æˆå‘˜å˜é‡ã€‚ this.elementData = EMPTY_ELEMENTDATA; } else { // è´Ÿæ•°æŠ›å‡ºå¼‚å¸¸ã€‚ throw new IllegalArgumentException(&quot;Illegal Capacity: &quot; + initialCapacity); }} 2ã€ æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆå…ƒç´ çš„åˆ—è¡¨ï¼Œå…¶é¡ºåºç”±é›†åˆçš„è¿­ä»£å™¨è¿”å›ã€‚å…¥å‚cé›†åˆä¸­çš„å…ƒç´ å°†è¢«æ”¾å…¥æ­¤åˆ—è¡¨ï¼Œå¦‚æœé›†åˆä¸ºnullåˆ™æŠ›å‡ºNullPointerExceptionå¼‚å¸¸ã€‚ 12345678910111213public ArrayList(Collection&lt;? extends E&gt; c) { // é›†åˆè½¬æ•°ç»„èµ‹å€¼ç»™elementData elementData = c.toArray(); // é›†åˆå…ƒç´ ä¸ªæ•°ä¸ä¸º0ã€‚ if ((size = elementData.length) != 0) { // c.toArrayæ–¹æ³•è¿”å›çš„å¯èƒ½ä¸æ˜¯Object[]æ•°ç»„ï¼Œæ­¤å¤„åˆ¤æ–­å¦‚æœä¸ä¸ºObject[]ç±»å‹åˆ™è½¬æ¢æˆObject[]ç±»å‹ã€‚ if (elementData.getClass() != Object[].class) elementData = Arrays.copyOf(elementData, size, Object[].class); } else { // èµ‹å€¼é™æ€ç©ºæ•°ç»„æˆå‘˜å˜é‡ã€‚ this.elementData = EMPTY_ELEMENTDATA; }} æ•°ç»„æ‹·è´æ–¹æ³•ç”±äºArrayListåº•å±‚ä½¿ç”¨æ•°ç»„è¿›è¡Œå…ƒç´ å­˜å‚¨ï¼Œå…¶å¾ˆå¤šå®ç°éƒ½æ˜¯å¯¹æ•°ç»„è¿›è¡Œç›´æ¥æ“ä½œã€‚æ‰€ä»¥åœ¨çœ‹å…¶å®ƒæ–¹æ³•ä¹‹å‰ï¼Œå¾ˆæœ‰å¿…è¦å…ˆå¼„æ‡‚ä¸€äº›æ•°ç»„çš„æ–¹æ³•ã€‚ java.util.Arraysæ˜¯JDKæä¾›çš„ä¸€ä¸ªæ•°ç»„å·¥å…·ç±»ï¼Œåœ¨ArrayListä¸­å¤§é‡ä½¿ç”¨äº†å®ƒçš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839/** * æ•°ç»„æ‹·è´ * @param original å¾…æ‹·è´æ•°ç»„ * @param newLength æ‹·è´åæ–°æ•°ç»„çš„é•¿åº¦ */public static &lt;T&gt; T[] copyOf(T[] original, int newLength) { return (T[]) copyOf(original, newLength, original.getClass());}/** * @param original å¾…æ‹·è´æ•°ç»„ * @param newLength æ‹·è´åæ–°æ•°ç»„çš„é•¿åº¦ * @param newType æ•°ç»„å…ƒç´ ç±»å‹ */public static &lt;T,U&gt; T[] copyOf(U[] original, int newLength, Class&lt;? extends T[]&gt; newType) { @SuppressWarnings(&quot;unchecked&quot;) // ä¼ å…¥çš„newTypeç±»å‹æ˜¯å¦æ˜¯Objectç±»å‹ï¼Œæ˜¯åˆ™åˆ›å»ºObjectæ•°ç»„ï¼Œå¦åˆ™åˆ›å»ºæŒ‡å®šç±»å‹æ•°ç»„ã€‚ T[] copy = ((Object)newType == (Object)Object[].class) ? (T[]) new Object[newLength] : (T[]) Array.newInstance(newType.getComponentType(), newLength); // nativeæ–¹æ³• System.arraycopy(original, 0, copy, 0, Math.min(original.length, newLength)); // è¿”å›åˆ›å»ºçš„æ–°é•¿åº¦çš„æ•°ç»„ return copy;}/** * å°†srcæ•°ç»„ä¸­srcPosç´¢å¼•åŠå…¶ä¹‹åçš„lengthä¸ªå…ƒç´ åˆ†åˆ«æ‹·è´è‡³destæ•°ç»„ä¸­destPosç´¢å¼•åŠå…¶ä¹‹åçš„lengthä¸ªä½ç½®ä¸Šã€‚ * * @param src æºæ•°ç»„ * @param srcPos æºæ•°ç»„æ‹·è´å¼€å§‹ä½ç½®ç´¢å¼• * @param dest ç›®æ ‡æ•°ç»„ * @param destPos ç›®æ ‡æ•°ç»„æ‹·è´å¼€å§‹ä½ç½®ç´¢å¼• * @param length æ‹·è´çš„é•¿åº¦ */public static native void arraycopy(Object src, int srcPos, Object dest, int destPos, int length); æ’å…¥å…ƒç´ ArrayListæä¾›äº†ä¸¤ä¸ªé‡è½½çš„addæ’å…¥æ–¹æ³•ã€‚ç¬¬ä¸€ä¸ªæ˜¯å°†æŒ‡å®šå…ƒç´ æ·»åŠ è‡³åˆ—è¡¨æœ«å°¾ï¼›ç¬¬äºŒä¸ªæ˜¯å°†æŒ‡å®šå…ƒç´ æ·»åŠ è‡³æŒ‡å®šä½ç½®ï¼›åŒæ—¶è¿˜æä¾›äº†ä¸¤ä¸ªé‡è½½çš„addAllæ–¹æ³•ï¼Œç”¨æ¥æ‰¹é‡æ’å…¥ã€‚ æ’å…¥è‡³åˆ—è¡¨æœ«å°¾æºç å¦‚ä¸‹ï¼š 12345public boolean add(E e) { ensureCapacityInternal(size + 1); // Increments modCount!! elementData[size++] = e; return true;} çœ‹åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¯¹ä½¿ç”¨åˆ†æä¸­çš„ç¤ºä¾‹ä»£ç è¿›è¡Œåˆ†æäº†ï¼š é¦–å…ˆä½¿ç”¨newå…³é”®å­—è°ƒç”¨æ— å‚æ„é€ å™¨åˆå§‹åŒ–ä¸€ä¸ªArrayListé›†åˆå¯¹è±¡ï¼Œæˆ‘ä»¬çŸ¥é“å…¶å®è´¨æ˜¯å°†DEFAULTCAPACITY_EMPTY_ELEMENTDATAç©ºåˆ—è¡¨èµ‹ç»™å­˜å‚¨å…ƒç´ çš„elementDataæ•°ç»„ç¼“å†²åŒºã€‚åˆ›å»ºå‡ºçš„listå¯¹è±¡çš„sizeæˆå‘˜å˜é‡åˆå§‹åŒ–ä¸º0ï¼Œç„¶åè°ƒç”¨listå¯¹è±¡çš„addæ–¹æ³•æ·»åŠ å…ƒç´ ã€‚ ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼šlist.add(&quot;a&quot;); åœ¨addæ–¹æ³•ä¸­é¦–å…ˆè°ƒç”¨ensureCapacityInternalæ–¹æ³•ï¼Œç¡®ä¿å†…éƒ¨å®¹é‡ï¼Œç„¶åå°†ä¼ å…¥çš„å…ƒç´ èµ‹å€¼ç»™elementDataæ•°æ®åŸŸæœ«å°¾ã€‚æœ€åè¿”å›trueã€‚ ç¡®ä¿å†…éƒ¨å®¹é‡ensureCapacityInternalæ–¹æ³•æºç å¦‚ä¸‹ï¼š 123private void ensureCapacityInternal(int minCapacity) { ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));} ç¬¬ä¸€æ¬¡è°ƒç”¨addæ–¹æ³•æ—¶ï¼šelementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATAï¼ˆæ„é€ å™¨ä¸­åˆå§‹åŒ–ï¼‰ï¼ŒminCapacity = size + 1ï¼ˆå…¶å€¼ä¸º1ï¼‰ã€‚ è°ƒç”¨calculateCapacity(elementData, minCapacity)æ–¹æ³•è®¡ç®—å®¹é‡ï¼š 1234567private static int calculateCapacity(Object[] elementData, int minCapacity) { // new ArrayList&lt;&gt;() æ—¶ï¼Œåˆå§‹åŒ–ä¸º elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) { return Math.max(DEFAULT_CAPACITY, minCapacity); } return minCapacity;} æ­¤æ—¶elementDataç­‰äºDEFAULTCAPACITY_EMPTY_ELEMENTDATAï¼Œè¿”å›DEFAULT_CAPACITYï¼ˆå…¶å€¼ä¸º10ï¼‰å’ŒminCapacityï¼ˆå…¶å€¼ä¸º1ï¼‰ä¸­è¾ƒå¤§çš„å€¼ï¼Œå³è¿”å›10ã€‚ éšå³è°ƒç”¨äº†ensureExplicitCapacity(10)æ–¹æ³•ï¼š 1234567private void ensureExplicitCapacity(int minCapacity) { modCount++; // overflow-conscious code if (minCapacity - elementData.length &gt; 0) grow(minCapacity);} é¦–å…ˆå¢åŠ å½“å‰é›†åˆçš„ä¿®æ”¹æ¬¡æ•°ã€‚ç„¶ååˆ¤æ–­è®¡ç®—å‡ºçš„å®¹é‡æ˜¯å¦è¶…å‡ºäº†å½“å‰elementDataæ•°ç»„é•¿åº¦ï¼Œå¦‚æœè¶…è¿‡åˆ™è¿›è¡Œgrowæ‰©å®¹ã€‚ åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨addæ–¹æ³•æ—¶æ˜¾ç„¶è¶…è¿‡äº†ï¼Œè¿›è¡Œæ‰©å®¹ï¼š 12345678910111213141516private void grow(int minCapacity) { // overflow-conscious code // æ—§çš„å®¹é‡ int oldCapacity = elementData.length; // æ–°å®¹é‡ä¸ºåŸæ¥çš„1.5å€ int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); if (newCapacity - minCapacity &lt; 0) // æ–°å®¹é‡å°äºä¼ å…¥çš„è®¡ç®—å‡ºçš„å®¹é‡ï¼Œåˆ™æ–°å®¹é‡ä¸ºä¼ å…¥å®¹é‡ã€‚ newCapacity = minCapacity; if (newCapacity - MAX_ARRAY_SIZE &gt; 0) // æ–°å®¹é‡è¶…è¿‡äº†æœ€å¤§å€¼ï¼Œåˆ™è®¡ç®—æœ€å¤§å®¹é‡ newCapacity = hugeCapacity(minCapacity); // minCapacity is usually close to size, so this is a win: // æ•°ç»„å†…å®¹æ‹·è´ elementData = Arrays.copyOf(elementData, newCapacity);} æ‰©å®¹æµç¨‹ä¸ºï¼š è·å–æ—§å®¹é‡oldCapacityï¼› è®¡ç®—æ–°å®¹é‡ï¼Œåˆ©ç”¨ä½è¿ç®—ï¼ˆé€Ÿåº¦è¿œè¶…æ•´é™¤è¿ç®—ï¼‰å¾—åˆ°æ—§å®¹é‡çš„ä¸€åŠå†åŠ ä¸Šæ—§å®¹é‡ï¼Œå³æ‰©å®¹1.5å€ï¼› æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å°äºä¼ å…¥çš„è®¡ç®—å®¹é‡minCapacityï¼Œå¦‚æœå°äºï¼Œåˆ™å°†ä¼ å…¥çš„å®¹é‡ä½œä¸ºæ–°å®¹é‡ï¼› æ£€æŸ¥å¾—åˆ°çš„æ–°å®¹é‡æ˜¯å¦å¤§äºArrayListå®šä¹‰çš„æ‰€èƒ½å®¹çº³çš„æœ€å¤§å®¹é‡ï¼šInteger,MAX_VALUE - 8ï¼› å¦‚æœå¤§äºï¼Œåˆ™è°ƒç”¨hugeCapacity(minCapacity)è®¡ç®—æœ€å¤§å®¹é‡ï¼šå¦‚æœminCapacityå¤§äºInteger.MAX_VALUE - 8ï¼Œåˆ™æœ€å¤§å®¹é‡ä¸ºInteger.MAX_VALUEï¼Œå¦åˆ™ä¸ºInteger.MAX_VALUE - 8ã€‚ æœ€åè°ƒç”¨Arrays.copyOf(elementData, newCapacity)è¿›è¡Œæ•°ç»„æ‹·è´ï¼Œå¾—åˆ°ä¸€ä¸ªä»¥æ–°å®¹é‡ä¸ºé•¿åº¦çš„æ•°ç»„å¯¹è±¡å¹¶èµ‹å€¼ç»™elementDataã€‚ ç¬¬ä¸€æ¬¡è°ƒç”¨addæ–¹æ³•æ—¶ï¼Œæ—§å®¹é‡oldCapacity = 0ï¼Œé€šè¿‡ä½è¿ç®—è®¡ç®—å‡ºçš„æ–°å®¹é‡ä¹Ÿä¸º0ï¼Œæ‰€ä»¥æœ€åæ–°å®¹é‡newCapacity = minCapacityï¼Œç­‰äº10ã€‚ æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨newå…³é”®å­—è°ƒç”¨æ— å‚æ„é€ å™¨åˆ›å»ºArrayListå¯¹è±¡æ—¶ï¼Œå®é™…ä¸Šåªåˆå§‹åŒ–äº†ä¸€ä¸ªç©ºæ•°ç»„ï¼Œåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨addæ–¹æ³•æ—¶æ‰ä¼šè¿›è¡Œç©ºæ•°ç»„çš„æ‰©å®¹ã€‚ æ‰©å®¹å®Œæˆåï¼ŒelementDataæ•°ç»„å®¹é‡å……è¶³ï¼Œå¯ä»¥å¾€å…¶æœ«å°¾æ·»åŠ å…ƒç´ ï¼š 1elementData[size++] = e; åƒä½¿ç”¨åˆ†æä¸­çš„ç¤ºä¾‹ä»£ç ä¸€æ ·ï¼Œæˆ‘ä»¬ä¸æ–­åœ°å‘å…¶ä¸­æ·»åŠ å…ƒç´ ï¼Œå½“æ·»åŠ çš„å…ƒç´ ä¸ªæ•°ä¸è¶…è¿‡10æ—¶ï¼ŒensureExplicitCapacity(int minCapacity)æ–¹æ³•åˆ¤æ–­minCapacity - elementData.lengthå§‹ç»ˆå°äº0ï¼ˆç»è¿‡ç¬¬ä¸€æ¬¡æ‰©å®¹åelementData.lengthçš„å€¼ä¸º10ï¼‰ï¼Œä¸ä¼šè¿›è¡Œgrowæ‰©å®¹; è€Œå½“æ·»åŠ è‡³ç¬¬11ä¸ªå…ƒç´ kæ—¶ï¼Œæƒ…å†µå‘ç”Ÿå˜åŒ–ï¼š calculateCapacity(elementData, minCapacity)æ–¹æ³•ç›´æ¥è¿”å›minCapacity = 11ï¼› ç„¶åè°ƒç”¨ensureExplicitCapacity(int minCapacity)æ–¹æ³•ï¼Œæ­¤æ—¶elementDataæ•°ç»„é•¿åº¦ä¸º10ï¼ŒminCapacity - elementData.lengthå¤§äº0ï¼Œå°†å†æ¬¡è¿›è¡Œgrowæ‰©å®¹ã€‚ è€Œæ‰©å®¹çš„æµç¨‹æˆ‘ä»¬çŸ¥é“ï¼Œä¼šè°ƒç”¨Arrays.copyOf(elementData, newCapacity)æ–¹æ³•è¿›è¡Œæ•°ç»„æ‹·è´ï¼Œä¼šæœ‰æ€§èƒ½æŸè€—ã€‚ æ‰€ä»¥ï¼Œå…·æœ‰åŒ å¿ƒçš„ä»£ç åº”è¯¥åƒä¸‹é¢è¿™æ ·ï¼š 12345678910111213141516// æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ List&lt;String&gt; list = new ArrayList&lt;&gt;(11);// è¿ç»­æ·»åŠ 10ä¸ªå…ƒç´ list.add(&quot;a&quot;);list.add(&quot;b&quot;);list.add(&quot;c&quot;);list.add(&quot;d&quot;);list.add(&quot;e&quot;);list.add(&quot;f&quot;);list.add(&quot;g&quot;);list.add(&quot;h&quot;);list.add(&quot;i&quot;);list.add(&quot;j&quot;);// æ·»åŠ ç¬¬11ä¸ªå…ƒç´ list.add(&quot;k&quot;);// do other è°ƒç”¨æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å™¨ï¼Œåœ¨åˆ›å»ºlistå¯¹è±¡æ—¶å°±ä¼šå¯¹elementDataæ•°ç»„è¿›è¡Œåˆå§‹åŒ–ï¼Œè€Œä¸æ˜¯åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨addæ–¹æ³•æ—¶ã€‚ æ‰€ä»¥å¦‚æœèƒ½æå‰é¢„ä¼°åˆ°é›†åˆå®¹é‡ï¼Œå°½é‡æå‰æŒ‡å®šå®¹é‡ï¼Œé¿å…é¢‘ç¹çš„æ‰©å®¹å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚ æ ¹æ®ä½¿ç”¨åœºæ™¯ï¼Œå¦‚æœé›†åˆçš„æ•°æ®é‡ä¸å¥½é¢„ä¼°ï¼Œä¸”åªä¼šå¯¹å…¶è¿›è¡Œå¢åˆ æ“ä½œï¼Œåˆ™ä¸å»ºè®®ä½¿ç”¨ArrayListé›†åˆï¼Œè€Œæ˜¯å»ºè®®ä½¿ç”¨LinkedListé›†åˆã€‚ æ’å…¥è‡³æŒ‡å®šä½ç½®æºç å¦‚ä¸‹ï¼š 1234567891011121314151617/** * @param index å¾…æ’å…¥å…ƒç´ çš„æŒ‡å®šçš„ä½ç½®çš„ç´¢å¼• * @param element å¾…æ’å…¥çš„å…ƒç´  */public void add(int index, E element) { // æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ rangeCheckForAdd(index); // ç¡®ä¿å®¹é‡ï¼Œä¿®æ”¹modCountå€¼ ensureCapacityInternal(size + 1); // Increments modCount!! // æ•°ç»„æ‹·è´ï¼šå°†[index,size)ç´¢å¼•åŒºé—´çš„å…ƒç´ æ•´ä½“å‘åç§»åŠ¨ä¸€ä¸ªå•ä½ï¼Œå°†é›†åˆçš„`index`ä½ç½®ç•™ç©ºã€‚ System.arraycopy(elementData, index, elementData, index + 1, size - index); // ç»™indexç´¢å¼•ä½ç½®èµ‹å€¼ä¸ºå¾…æ’å…¥å…ƒç´  elementData[index] = element; // é›†åˆå¤§å°å¢åŠ  size++;} å°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥è‡³å½“å‰é›†åˆæœ«å°¾æºç å¦‚ä¸‹ï¼š 1234567891011121314public boolean addAll(Collection&lt;? extends E&gt; c) { // é›†åˆè½¬æ•°ç»„ Object[] a = c.toArray(); // å¾…æ·»åŠ å…ƒç´ ä¸ªæ•° int numNew = a.length; // ç¡®ä¿å®¹é‡ ensureCapacityInternal(size + numNew); // Increments modCount // æ•°ç»„æ‹·è´ System.arraycopy(a, 0, elementData, size, numNew); // é›†åˆå¤§å°å¢åŠ  size += numNew; // ä¼ å…¥é›†åˆæ— å…ƒç´ åˆ™è¿”å›falseï¼Œå¦åˆ™è¿”å›trueã€‚ return numNew != 0;} é¦–å…ˆå°†ä¼ å…¥çš„é›†åˆcè½¬ä¸ºObject[]å¯¹è±¡æ•°ç»„ï¼Œè°ƒç”¨Collectionçš„toArray()æ–¹æ³•ï¼Œä¸ç®¡æ˜¯å“ªç§é›†åˆçš„å®ç°ï¼Œæœ€ç»ˆéƒ½ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ã€‚ä»¥ä¸‹æ˜¯ArrayListç±»çš„å®ç°ï¼š 123public Object[] toArray() { return Arrays.copyOf(elementData, size);} è°ƒç”¨å·¥å…·ç±»çš„æ–¹æ³•Arrays.copyOfæ–¹æ³•è¿›è¡Œæ•°ç»„æ‹·è´ï¼Œè¿”å›ä¸€ä¸ªObject[]æ•°ç»„ã€‚ ä»å½“å‰é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹ï¼Œå°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥æºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627/** * * @param index æŒ‡å®šç´¢å¼• * @param c å¾…æ’å…¥é›†åˆ */public boolean addAll(int index, Collection&lt;? extends E&gt; c) { // æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ rangeCheckForAdd(index); // é›†åˆè½¬Objectæ•°ç»„ Object[] a = c.toArray(); // å¾…æ’å…¥é›†åˆå…ƒç´ ä¸ªæ•° int numNew = a.length; // ç¡®ä¿å®¹é‡ ensureCapacityInternal(size + numNew); // Increments modCount // éœ€è¦ç§»åŠ¨çš„å…ƒç´ ä¸ªæ•° int numMoved = size - index; if (numMoved &gt; 0) // ä¸æ˜¯ä»æœ«å°¾æ·»åŠ ï¼Œåˆ™å°†[index,size)ç´¢å¼•ä¸Šçš„å…ƒç´ æ•´ä½“å‘åç§»åŠ¨numMovedä¸ªå•ä½ã€‚ System.arraycopy(elementData, index, elementData, index + numNew, numMoved); // Objectæ•°ç»„æ‹·è´è‡³elementData System.arraycopy(a, 0, elementData, index, numNew); // é›†åˆå¤§å°å¢åŠ  size += numNew; // ä¼ å…¥é›†åˆæ— å…ƒç´ åˆ™è¿”å›falseï¼Œå¦åˆ™è¿”å›trueã€‚ return numNew != 0;} åˆ é™¤å…ƒç´ åˆ é™¤é›†åˆä¸­çš„å…ƒç´ æœ‰å¤šç§æƒ…å†µï¼šåˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´ /åˆ é™¤æŒ‡å®šå…ƒç´ /åˆ é™¤æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ /åˆ é™¤å…¨éƒ¨å…ƒç´ /æŒ‡å®šæ¡ä»¶åˆ é™¤ï¼ˆJava8æ–°å¢ï¼‰ç­‰ã€‚ åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´ æºç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122/** * åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´  * @param index æŒ‡å®šç´¢å¼• */public E remove(int index) { // æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ rangeCheck(index); // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++; // è·å–æ—§çš„indexç´¢å¼•ä½ç½®å…ƒç´ å€¼ E oldValue = elementData(index); // è®¡ç®—éœ€è¦ç§»åŠ¨çš„å…ƒç´ ä¸ªæ•° int numMoved = size - index - 1; if (numMoved &gt; 0) // ç§»åŠ¨å…ƒç´ ï¼š[index+1,size)ç´¢å¼•åŒºé—´çš„å…ƒç´ æ•´ä½“å‘å‰ç§»åŠ¨ä¸€ä¸ªå•ä½ã€‚ System.arraycopy(elementData, index+1, elementData, index, numMoved); // æ¸…é™¤æœ«å°¾ç´¢å¼•åŸæœ‰çš„å¼•ç”¨ï¼Œå‡å°é›†åˆå¤§å° elementData[--size] = null; // clear to let GC do its work // è¿”å›è¢«åˆ é™¤çš„å…ƒç´ å€¼ return oldValue;} ä¸ºä»€ä¹ˆåˆ¤æ–­size - index - 1 &gt; 0ï¼Ÿ ç­”ï¼šé›†åˆå¤§å°sizeæ˜¯ä»1å¼€å§‹è®¡ç®—ï¼Œè€Œæ•°ç»„ä¸‹æ ‡ç´¢å¼•indexæ˜¯ä»0å¼€å§‹è®¡ç®—ã€‚ åˆ é™¤æŒ‡å®šå…ƒç´ ç”±äºArrayListé›†åˆä¸­çš„å…ƒç´ å¯ä»¥é‡å¤ï¼ŒæŒ‡å®šçš„å…ƒç´ å¯èƒ½åœ¨é›†åˆä¸­å‡ºç°å¤šæ¬¡ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•åˆ é™¤çš„æ˜¯æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®çš„å…ƒç´ ã€‚ æºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021/** * @param o æŒ‡å®šå…ƒç´  */public boolean remove(Object o) { if (o == null) { // æŒ‡å®šå…ƒç´ ä¸ºnullï¼š==è¿ç®—ç¬¦æ¯”è¾ƒ for (int index = 0; index &lt; size; index++) if (elementData[index] == null) { fastRemove(index); return true; } } else { // énullï¼šequalsæ–¹æ³•æ¯”è¾ƒ for (int index = 0; index &lt; size; index++) if (o.equals(elementData[index])) { fastRemove(index); return true; } } return false;} foriå¾ªç¯æ˜¯ä»ç´¢å¼•ä¸º0å¼€å§‹éå†ï¼Œæ‰€ä»¥åˆ é™¤çš„æ˜¯å…·æœ‰æœ€ä½ç´¢å¼•çš„å…ƒç´ ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹fastRemove(index);çš„å®ç°ï¼š 123456789101112131415/** * @param index æŒ‡å®šç´¢å¼• */private void fastRemove(int index) { // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++; // è®¡ç®—éœ€è¦ç§»åŠ¨çš„å…ƒç´ ä¸ªæ•° int numMoved = size - index - 1; if (numMoved &gt; 0) // ç§»åŠ¨å…ƒç´ ï¼š[index+1,size)ç´¢å¼•åŒºé—´å…ƒç´ æ•´ä½“å‘å‰ç§»åŠ¨ä¸€ä½ã€‚ System.arraycopy(elementData, index+1, elementData, index, numMoved); // æ¸…é™¤æœ«å°¾ç´¢å¼•åŸæœ‰çš„å¼•ç”¨ï¼Œå‡å°é›†åˆå¤§å° elementData[--size] = null; // clear to let GC do its work} åˆ é™¤æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ è¯¥æ–¹æ³•ä¸ºArrayListç±»ä¸­å—ä¿æŠ¤çš„æ–¹æ³•ï¼Œå¤–éƒ¨æ— æ³•ç›´æ¥è¿›è¡Œè°ƒç”¨ã€‚ç”±JDKé›†åˆæ¡†æ¶å†…éƒ¨è¿›è¡Œä½¿ç”¨ã€‚ æºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324/** * çº¦å®š fromIndex å°äº toIndexï¼Œå¦åˆ™ï¼Œè¿›è¡Œå…ƒç´ ç§»åŠ¨æ—¶ä¼šå‡ºç°ç´¢å¼•è¶Šç•Œã€‚ * @param fromIndex å¼€å§‹ç´¢å¼• * @param toIndex ç»“æŸç´¢å¼• */protected void removeRange(int fromIndex, int toIndex) { // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++; // è®¡ç®—éœ€è¦ç§»åŠ¨çš„å…ƒç´ ä¸ªæ•° int numMoved = size - toIndex; // ç§»åŠ¨å…ƒç´ ï¼š[toIndex,size)ç´¢å¼•åŒºé—´å…ƒç´ æ•´ä½“å‘å‰ç§»åŠ¨toIndex - fromIndexä¸ªå•ä½ã€‚ System.arraycopy(elementData, toIndex, elementData, fromIndex, numMoved); // clear to let GC do its work // è®¡ç®—æ–°çš„æ•°ç»„å¤§å° int newSize = size - (toIndex-fromIndex); for (int i = newSize; i &lt; size; i++) { // æ¸…é™¤åˆ é™¤çš„ç´¢å¼•ä½ç½®åŸæœ‰çš„å¼•ç”¨ elementData[i] = null; } // æŒ‡å®šæ–°çš„æ•°ç»„å¤§å° size = newSize;} åˆ é™¤å…¨éƒ¨å…ƒç´ æœ‰ä¸¤ç§æƒ…å†µï¼šä¸€ç§æ˜¯åˆ é™¤å½“å‰é›†åˆå…¨éƒ¨å…ƒç´ ï¼Œæ–¹æ³•ä¸ºclear()ï¼›å¦ä¸€ç§æ˜¯ä»å½“å‰é›†åˆä¸­åˆ é™¤æŒ‡å®šé›†åˆä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ ï¼Œæ–¹æ³•ä¸ºremoveAll(Collection&lt;?&gt; c)ã€‚ clear()æ–¹æ³•æºç å¦‚ä¸‹ï¼š 1234567891011public void clear() { // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++; // clear to let GC do its work // æ¸…é™¤æ‰€æœ‰ç´¢å¼•ä½ç½®çš„å¼•ç”¨å¯¹è±¡ for (int i = 0; i &lt; size; i++) elementData[i] = null; // é›†åˆå¤§å°ç½®0 size = 0;} removeAll(Collection&lt;?&gt; c)æ–¹æ³•æºç å¦‚ä¸‹ï¼š 12345public boolean removeAll(Collection&lt;?&gt; c) { // éç©º Objects.requireNonNull(c); return batchRemove(c, false);} é¦–å…ˆï¼Œè°ƒç”¨Java8æä¾›çš„Objects.requireNonNull(c);æ–¹æ³•å¯¹ä¼ å…¥çš„é›†åˆcè¿›è¡Œéç©ºæ ¡éªŒã€‚ ç„¶åï¼Œè°ƒç”¨ç§æœ‰æ–¹æ³•batchRemove(c, false)ï¼Œä¼ å…¥é›†åˆcå’Œå¸ƒå°”å€¼falseï¼š 12345678910111213141516171819202122232425262728private boolean batchRemove(Collection&lt;?&gt; c, boolean complement) { final Object[] elementData = this.elementData; int r = 0, w = 0; boolean modified = false; try { for (; r &lt; size; r++) if (c.contains(elementData[r]) == complement) elementData[w++] = elementData[r]; } finally { // Preserve behavioral compatibility with AbstractCollection, // even if c.contains() throws. if (r != size) { System.arraycopy(elementData, r, elementData, w, size - r); w += size - r; } if (w != size) { // clear to let GC do its work for (int i = w; i &lt; size; i++) elementData[i] = null; modCount += size - w; size = w; modified = true; } } return modified;} æˆ‘ä»¬æ¥å†™ä¸€ä¸ªç®€å•çš„demoæ¥çœ‹ä¸‹å…¶è¿‡ç¨‹ï¼š 12345678910111213141516171819...... List&lt;Integer&gt; removeList = new ArrayList&lt;&gt;(); removeList.add(1); removeList.add(2); removeList.add(3); removeList.add(4); removeList.add(5); removeList.add(6); List&lt;Integer&gt; beRemovedList = new ArrayList&lt;&gt;(); beRemovedList.add(3); beRemovedList.add(4); beRemovedList.add(6); System.out.println(removeList); System.out.println(beRemovedList); removeList.removeAll(beRemovedList); System.out.println(removeList);...... åˆ›å»ºä¸€ä¸ªremoveListé›†åˆå¹¶åˆå§‹åŒ–å…­ä¸ªå…ƒç´ ï¼Œå†åˆ›å»ºä¸€ä¸ªå¾…åˆ é™¤çš„beRemovedListé›†åˆå¹¶åˆå§‹åŒ–ä¸‰ä¸ªå…ƒç´ ï¼ˆåœ¨removeListä¸­ï¼‰ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æremoveAllæ–¹æ³•çš„å…·ä½“æ‰§è¡Œæµç¨‹ï¼š å½“æˆ‘ä»¬è°ƒç”¨removeList.removeAll(beRemovedList);æ—¶ï¼Œä¼šå…ˆå¯¹beRemovedListè¿›è¡Œéç©ºæ ¡éªŒï¼Œç„¶åè°ƒç”¨batchRemoveæ–¹æ³•ï¼š 1ã€ä½¿ç”¨å±€éƒ¨æœ€ç»ˆå˜é‡elementDataæŒ‡å‘å½“å‰é›†åˆï¼ˆremoveListï¼‰çš„å¼•ç”¨ï¼š 1final Object[] elementData = this.elementData; 2ã€å®šä¹‰ä¸¤ä¸ªç´¢å¼•å¹¶åˆå§‹åŒ–ä¸º0ï¼Œä»¥åŠå®šä¹‰ä¸€ä¸ªå¸ƒå°”å€¼ç”¨æ¥è®°å½•å½“å‰é›†åˆæ˜¯å¦è¢«ä¿®æ”¹ï¼š 12int r = 0, w = 0;boolean modified = false; 3ã€ä»råˆ°sizeè¿›è¡Œéå†ï¼Œåˆ¤æ–­ä¼ å…¥çš„é›†åˆcæ˜¯å¦åŒ…å«rä½ç½®çš„å…ƒç´ ã€‚ 123for (; r &lt; size; r++) if (c.contains(elementData[r]) == complement) elementData[w++] = elementData[r]; æˆ‘ä»¬å¯¹ç€æˆ‘ä»¬çš„demoç¨‹åºè¿›è¡Œåˆ†æï¼Œc = {3, 4, 6}ï¼ŒelementData = {1, 2, 3, 4, 5, 6}ï¼Œsize=6ï¼Œcomplement = falseã€‚ æ¯æ¬¡å¾ªç¯rçš„å€¼å¢ä¸€ï¼Œå¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸ºr &lt; sizeä¸æˆç«‹ï¼Œå³å½“r = sizeæ—¶å¾ªç¯ç»“æŸã€‚ ç¬¬ä¸€æ¬¡å¾ªç¯ï¼šr = 0ï¼ŒelementData[r] = 1ï¼Œc.contains(1) = falseã€‚ifæ¡ä»¶æˆç«‹ï¼Œw = 0ã€‚å°†elementData[r]èµ‹å€¼ç»™elementData[w++]ï¼šå³å°†å½“å‰ä¸åœ¨cé›†åˆä¸­çš„å…ƒç´ èµ‹å€¼åˆ°é›†åˆçš„ç¬¬0ä½ç½®ï¼Œéšåwå¢ä¸€ã€‚æ­¤æ—¶elementDataçš„ç¬¬0ä½ç½®å…ƒç´ ä¸ºï¼š1ã€‚ ç¬¬äºŒæ¬¡å¾ªç¯ï¼šr = 1ï¼ŒelementData[r] = 2ï¼Œc.contains(2) = falseã€‚ifæ¡ä»¶æˆç«‹ï¼Œw = 1ã€‚å°†elementData[r]èµ‹å€¼ç»™elementData[w++]ï¼šå³å°†å½“å‰ä¸åœ¨cé›†åˆä¸­çš„å…ƒç´ èµ‹å€¼åˆ°é›†åˆçš„ç¬¬1ä½ç½®ï¼Œéšåwå¢ä¸€ã€‚æ­¤æ—¶elementDataçš„ç¬¬1ä½ç½®å…ƒç´ ä¸ºï¼š2ã€‚ ç¬¬ä¸‰æ¬¡å¾ªç¯ï¼šr = 2ï¼ŒelementData[r] = 3ï¼Œc.contains(3) = trueã€‚ifæ¡ä»¶ä¸æˆç«‹ï¼Œwçš„å€¼ä¸º2ï¼Œä¸åšä»»ä½•æ“ä½œã€‚ ç¬¬å››æ¬¡å¾ªç¯ï¼šr = 3ï¼ŒelementData[r] = 4ï¼Œc.contains(4) = trueã€‚ifæ¡ä»¶ä¸æˆç«‹ï¼Œwçš„å€¼ä¸º2ï¼Œä¸åšä»»ä½•æ“ä½œã€‚ ç¬¬äº”æ¬¡å¾ªç¯ï¼šr = 4ï¼ŒelementData[r] = 5ï¼Œc.contains(5) = falseã€‚ifæ¡ä»¶æˆç«‹ï¼Œw = 2ï¼Œå°†elementData[r]èµ‹å€¼ç»™elementData[w++]ï¼šå³å°†å½“å‰ä¸åœ¨cé›†åˆä¸­çš„å…ƒç´ èµ‹å€¼åˆ°é›†åˆçš„ç¬¬2ä½ç½®ï¼Œéšåwå¢ä¸€ã€‚æ­¤æ—¶elementDataçš„ç¬¬2ä½ç½®å…ƒç´ ä¸ºï¼š5ã€‚ ç¬¬å…­æ¬¡å¾ªç¯ï¼šr = 5ï¼ŒelementData[r] = 6ï¼Œc.contains(6) = trueã€‚ifæ¡ä»¶ä¸æˆç«‹ï¼Œwçš„å€¼ä¸º3ï¼Œä¸åšä»»ä½•æ“ä½œã€‚ å¾ªç¯ç»“æŸï¼Œw = 3ï¼ŒelementData = {1, 2, 5, ......}ï¼Œr = 6ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹finallyå—ä¸­çš„ä»£ç ï¼š 1234567891011121314// Preserve behavioral compatibility with AbstractCollection,// even if c.contains() throws.if (r != size) { System.arraycopy(elementData, r,elementData, w,size - r); w += size - r;}if (w != size) { // clear to let GC do its work for (int i = w; i &lt; size; i++) elementData[i] = null; modCount += size - w; size = w; modified = true;} å¯¹äºæˆ‘ä»¬çš„demoç¨‹åºï¼š æ­¤æ—¶r = sizeï¼Œç¬¬ä¸€ä¸ªifå—ä¸è¿›å…¥ã€‚ æ­¤æ—¶(w = 3) != (size = 6)ï¼Œè¿›å…¥ç¬¬äºŒä¸ªifå—ï¼Œå°†ç´¢å¼•ä»wåˆ°size - 1ä½ç½®çš„å…ƒç´ ç½®ä¸ºnullï¼Œé‡Šæ”¾å¯¹åŸæ¥å…ƒç´ çš„å¼•ç”¨ã€‚ æ¥ä¸‹æ¥æ˜¯ä¸€äº›æ”¶å°¾å·¥ä½œï¼š è®°å½•ä¿®æ”¹æ¬¡æ•°ï¼Œä¿®æ”¹ï¼ˆç§»é™¤ï¼‰äº†size - wä¸ªå…ƒç´ ï¼› å°†é›†åˆå¤§å°è®¾ä¸ºwï¼šä¸ºåœ¨forå¾ªç¯ä¸­ç»™elementDataåŸŸèµ‹å€¼çš„å…ƒç´ ä¸ªæ•°ã€‚ è®¾ç½®ä¿®æ”¹æ ‡è®°ä¸ºtrueï¼Œæ­¤å¤„æ˜¯cé›†åˆä¸­çš„å…ƒç´ å…¨éƒ¨ä»é›†åˆä¸­åˆ é™¤ã€‚ æœ€åï¼ŒbatchRemoveæ–¹æ³•è¿”å›modifiedå¸ƒå°”å€¼ï¼šè¡¨ç¤ºæ˜¯å¦å½“å‰é›†åˆä¸­åˆ é™¤äº†æŒ‡å®šé›†åˆcä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ ã€‚ ä¿®æ”¹å…ƒç´ ä¿®æ”¹æ–¹æ³•åªæœ‰ä¸€ä¸ªï¼šä¿®æ”¹æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ä¸ºæ–°çš„å…ƒç´ ã€‚ æºç å¦‚ä¸‹ï¼š 1234567891011121314/** * @param index æŒ‡å®šç´¢å¼• * @param element æŒ‡å®šçš„æ–°å…ƒç´  */public E set(int index, E element) { // æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ rangeCheck(index); // è·å–indexç´¢å¼•ä½ç½®çš„æ—§å…ƒç´  E oldValue = elementData(index); // èµ‹å€¼ä¸ºæ–°çš„æŒ‡å®šå…ƒç´  elementData[index] = element; // è¿”å›æ—§å…ƒç´  return oldValue;} æŸ¥è¯¢å…ƒç´ ç”±äºArrayListåº•å±‚ç”±elementDataæ•°ç»„å­˜å‚¨å…ƒç´ ï¼Œæ‰€ä»¥æ”¯æŒæŒ‰æ•°ç»„ä¸‹æ ‡è®¿é—®ï¼šå³éšæœºå¿«é€Ÿè®¿é—®ã€‚å…¶æŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆArrayListå®ç°RandomAccessçš„åŸå› ï¼šæ ‡è®°è¯¥ç±»æ”¯æŒéšæœºå¿«é€Ÿè®¿é—®ã€‚ 12345678910public E get(int index) { // æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ rangeCheck(index); // æŒ‰æ•°ç»„ä¸‹æ ‡å–å€¼ return elementData(index);}E elementData(int index) { return (E) elementData[index];} å…¶å®ƒæ–¹æ³•cloneæ–¹æ³•ä¼ é€é—¨ sizeæ–¹æ³•è·å–é›†åˆå¤§å°ï¼šè¿”å›æˆå‘˜å˜é‡sizeã€‚ isEmptyæ–¹æ³•åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©ºé›†åˆï¼šè¿”å›size == 0å¾—åˆ°çš„å€¼ã€‚ indexOfæ–¹æ³•è¿”å›æŒ‡å®šå…ƒç´ åœ¨å½“å‰é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ç´¢å¼•ã€‚å¦‚æœå½“å‰é›†åˆä¸­ä¸åŒ…å«æ­¤å…ƒç´ ï¼Œè¿”å›-1ã€‚ 123456789101112131415public int indexOf(Object o) { if (o == null) { // æŒ‡å®šå…ƒç´ ä¸ºnullï¼šä½¿ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒ for (int i = 0; i &lt; size; i++) if (elementData[i]==null) return i; } else { // énullï¼šä½¿ç”¨equalsæ–¹æ³•æ¯”è¾ƒ for (int i = 0; i &lt; size; i++) if (o.equals(elementData[i])) return i; } // æœªæ‰¾åˆ°ï¼Œè¿”å›-1ã€‚ return -1;} ä»å‰å¾€åéå†ï¼Œnullå€¼ä½¿ç”¨==è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œå…¶å®ƒå¯¹è±¡ä½¿ç”¨equalsæ–¹æ³•æ¯”è¾ƒã€‚ lastIndexOfæ–¹æ³•è¿”å›æŒ‡å®šå…ƒç´ åœ¨å½“å‰é›†åˆä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ç´¢å¼•ã€‚å¦‚æœå½“å‰é›†åˆä¸­ä¸åŒ…å«æ­¤å…ƒç´ ï¼Œè¿”å›-1ã€‚ 123456789101112public int lastIndexOf(Object o) { if (o == null) { for (int i = size-1; i &gt;= 0; i--) if (elementData[i]==null) return i; } else { for (int i = size-1; i &gt;= 0; i--) if (o.equals(elementData[i])) return i; } return -1;} ä»åå¾€å‰éå†ï¼Œnullå€¼ä½¿ç”¨==è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œå…¶å®ƒå¯¹è±¡ä½¿ç”¨equalsæ–¹æ³•æ¯”è¾ƒã€‚ containsæ–¹æ³•åˆ¤æ–­æŒ‡å®šå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­ã€‚è°ƒç”¨çš„æ˜¯indexOf(o)æ–¹æ³•ï¼Œåˆ¤æ–­å…¶è¿”å›å€¼æ˜¯å¦å¤§äºç­‰äº0ï¼Œç­‰äº-1è¯´æ˜ä¸åœ¨é›†åˆä¸­ã€‚ iteratoræ–¹æ³•è¯¥æ–¹æ³•æ˜¯è¿­ä»£å™¨è®¾è®¡æ¨¡å¼çš„ä½“ç°ã€‚ä½¿ç”¨äº†newå…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªç§æœ‰å†…éƒ¨ç±»Itrå¯¹è±¡ã€‚ 123456789101112public Iterator&lt;E&gt; iterator() { return new Itr();}private class Itr implements Iterator&lt;E&gt; { int cursor; // index of next element to return int lastRet = -1; // index of last element returned; -1 if no such int expectedModCount = modCount; Itr() {} ......} ç§æœ‰å†…éƒ¨ç±»Itrå®ç°äº†java.util.Iteratorè¿­ä»£å™¨æ¥å£ã€‚å…¶æˆå‘˜å˜é‡æœ‰ä¸‰ä¸ªï¼š cursorï¼šæ¸¸æ ‡ï¼ˆä¸‹ä¸€ä¸ªè¦è¿”å›å…ƒç´ çš„ç´¢å¼•ï¼‰ã€‚ lastRetï¼šåˆå§‹åŒ–ä¸º-1ï¼Œæœ€åä¸€ä¸ªè¢«è¿”å›å…ƒç´ çš„ç´¢å¼•ï¼›å¦‚æœé›†åˆä¸­æœ¬æ¥æ²¡æœ‰ä»»ä½•å…ƒç´ åˆ™è¿”å›-1ã€‚ expectedModCountï¼šæœŸæœ›çš„ä¿®æ”¹æ¬¡æ•°ã€‚åˆå§‹åŒ–ä¸ºå½“å‰é›†åˆçš„modCountã€‚ åªæœ‰ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ã€‚ æˆ‘ä»¬çŸ¥é“ä½¿ç”¨è¿­ä»£å™¨å¯¹ArrayListè¿›è¡Œéå†çš„å†™æ³•å¦‚ä¸‹ï¼š 123456789101112List&lt;Integer&gt; iteratorList = new ArrayList&lt;&gt;();iteratorList.add(1);iteratorList.add(2);iteratorList.add(3);iteratorList.add(4);iteratorList.add(5);iteratorList.add(6);Iterator&lt;Integer&gt; iterator = iteratorList.iterator();while (iterator.hasNext()) { Integer next = iterator.next(); System.out.println(next);} å…¶ä¸­å…³é”®çš„ä¸¤ä¸ªæ–¹æ³•ä¸ºï¼šhasNext()å’Œnext()ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç€é‡æ¥çœ‹ä¸‹è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ é¦–å…ˆè°ƒç”¨iteratorListå¯¹è±¡çš„iterator()æ–¹æ³•å¾—åˆ°ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œç»è¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬å¯çŸ¥è¿™å®é™…æ˜¯ä¸€ä¸ªItrå¯¹è±¡ã€‚ å…¶hasNext()æ–¹æ³•æºç å¦‚ä¸‹ï¼š 123public boolean hasNext() { return cursor != size;} è¿”å›å½“å‰æ¸¸æ ‡cursoræ˜¯å¦ä¸ç­‰äºé›†åˆå¤§å°sizeã€‚å¦‚æœä¸ç­‰äºsizeï¼Œè¯´æ˜è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚å¯ç»§ç»­è¿­ä»£ã€‚å¦åˆ™è¿­ä»£å®Œæˆã€‚ next()æ–¹æ³•æºç å¦‚ä¸‹ï¼š 123456789101112131415161718public E next() { // fail-fastæœºåˆ¶ checkForComodification(); // è·å–å½“å‰æ¸¸æ ‡ int i = cursor; // å½“å‰æ¸¸æ ‡è¶…è¿‡é›†åˆå¤§å°åˆ™æŠ›å‡ºå¼‚å¸¸ if (i &gt;= size) throw new NoSuchElementException(); // è·å–å­˜å‚¨å…ƒç´ çš„æ•°ç»„å¯¹è±¡ Object[] elementData = ArrayList.this.elementData; if (i &gt;= elementData.length) // å½“å‰æ¸¸æ ‡è¶…å‡ºæ•°ç»„é•¿åº¦ï¼šä¸hasNextæ–¹æ³•ä¸­çš„åˆ¤æ–­å‡ºç°äº†çŸ›ç›¾ã€‚å¹¶å‘ä¿®æ”¹ï¼šfail-fastæœºåˆ¶ throw new ConcurrentModificationException(); // æ ¡éªŒé€šè¿‡ï¼Œæ¸¸æ ‡åŠ ä¸€ cursor = i + 1; // æœ€åä¸€ä¸ªè¢«è¿”å›å…ƒç´ çš„ç´¢å¼•èµ‹å€¼ä¸ºæ—§çš„æ¸¸æ ‡iï¼Œè¿”å›æ—§çš„æ¸¸æ ‡å¯¹åº”çš„å…ƒç´ ã€‚ return (E) elementData[lastRet = i];} åœ¨Itrç±»ä¸­ä½¿ç”¨thisæŒ‡ä»£çš„æ˜¯å½“å‰Itrå¯¹è±¡ï¼Œä½¿ç”¨ArrayList.thisæŒ‡ä»£çš„æ˜¯é›†åˆå¯¹è±¡ã€‚ ä¸ºä»€ä¹ˆArrayListä½¿ç”¨è¿­ä»£å™¨éå†æ²¡æœ‰æ™®é€šforiå¾ªç¯éå†æ•ˆç‡é«˜ï¼Ÿ ç­”ï¼šç»è¿‡ä»¥ä¸Šä»£ç çš„åˆ†æï¼ŒåŸå› æ˜¾è€Œæ˜“è§ï¼šä½¿ç”¨è¿­ä»£å™¨éå†ï¼Œé¦–å…ˆéœ€è¦ä½¿ç”¨newå…³é”®å­—åˆ›å»ºä¸€ä¸ªItrå¯¹è±¡ï¼Œåˆ›å»ºå¯¹è±¡éœ€è¦è€—æ—¶ï¼ˆä¸€æ¬¡ï¼‰ï¼›å…¶æ¬¡ï¼Œä¸­é—´æœ‰å¤šæ¬¡æ¡ä»¶åˆ¤æ–­å¹¶ä¸”æœ‰å±€éƒ¨å˜é‡äº§ç”Ÿï¼Œä»¥åŠä¸€ä¸ªåŠ 1æ“ä½œï¼Œè¿™ä¹Ÿéœ€è¦è€—è´¹æ—¶é—´ï¼ˆå¤šæ¬¡ï¼šæ¯æ¬¡è°ƒç”¨nextæ–¹æ³•ï¼‰ã€‚ Demoå®æˆ˜123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145package com.sunchaser.javase.collect;import java.util.ArrayList;import java.util.Iterator;import java.util.List;/** * @author sunchaser * @date 2020/5/2 * @since 1.0 */public class ArrayListTest { public static void main(String[] args) { // æ’å…¥å…ƒç´  ArrayList&lt;String&gt; addList = new ArrayList&lt;&gt;(); // é›†åˆå°¾éƒ¨æ’å…¥ addList.add(&quot;æµ‹è¯•1&quot;); System.out.println(addList); // é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥ addList.add(1,&quot;æŒ‡å®šä½ç½®1&quot;); System.out.println(addList); // é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥ï¼šç´¢å¼•ä½ç½®æ— å…ƒç´ ä¸”ä¸æ˜¯å°¾éƒ¨ï¼šç´¢å¼•è¶Šç•Œã€‚ // addList.add(10,&quot;æŒ‡å®šä½ç½®2&quot;); // å¾…æ’å…¥é›†åˆåˆå§‹åŒ– ArrayList&lt;String&gt; toBeAddList = new ArrayList&lt;&gt;(); toBeAddList.add(&quot;æµ‹è¯•2&quot;); toBeAddList.add(&quot;æµ‹è¯•3&quot;); toBeAddList.add(&quot;æµ‹è¯•4&quot;); // å¾…æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥é›†åˆåˆå§‹åŒ– ArrayList&lt;String&gt; toBeAddIndexList = new ArrayList&lt;&gt;(); toBeAddIndexList.add(&quot;æµ‹è¯•5&quot;); toBeAddIndexList.add(&quot;æµ‹è¯•6&quot;); // å°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥è‡³å½“å‰é›†åˆæœ«å°¾ addList.addAll(toBeAddList); System.out.println(addList); // ä»å½“å‰é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹ï¼Œå°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥ addList.addAll(1,toBeAddIndexList); System.out.println(addList); // åˆ é™¤å…ƒç´  List&lt;Integer&gt; removeList = new ArrayList&lt;&gt;(); removeList.add(1); removeList.add(2); removeList.add(6); removeList.add(3); removeList.add(4); removeList.add(5); removeList.add(6); removeList.add(4); System.out.println(removeList); // åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´  removeList.remove(1); System.out.println(removeList); // åˆ é™¤æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®çš„å…ƒç´  removeList.remove(new Integer(6)); System.out.println(removeList); // å¾…åˆ é™¤å…ƒç´ é›†åˆ List&lt;Integer&gt; beRemovedList = new ArrayList&lt;&gt;(); beRemovedList.add(2); beRemovedList.add(3); beRemovedList.add(6); System.out.println(removeList); System.out.println(beRemovedList); // ä»å½“å‰é›†åˆä¸­åˆ é™¤æŒ‡å®šé›†åˆä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´  boolean b = removeList.removeAll(beRemovedList); System.out.println(b); System.out.println(removeList); // åˆ é™¤å…¨éƒ¨å…ƒç´  removeList.clear(); System.out.println(removeList); // ä¿®æ”¹å…ƒç´ é›†åˆåˆå§‹åŒ– ArrayList&lt;Integer&gt; operatorList = new ArrayList&lt;&gt;(); operatorList.add(1); operatorList.add(2); operatorList.add(3); operatorList.add(2); operatorList.add(1); System.out.println(operatorList); // ä¿®æ”¹å…ƒç´ ï¼Œå°†ç´¢å¼•ä¸º1çš„å…ƒç´ ä¿®æ”¹ä¸º6 operatorList.set(1,6); System.out.println(operatorList); // æŸ¥è¯¢å…ƒç´  Integer integer = operatorList.get(1); System.out.println(integer); // å…‹éš† Object clone = operatorList.clone(); System.out.println(clone); // size System.out.println(operatorList.size()); // isEmpty System.out.println(operatorList.isEmpty()); // indexOf System.out.println(operatorList.indexOf(1)); // lastIndexOf System.out.println(operatorList.lastIndexOf(1)); // contains System.out.println(operatorList.contains(3)); System.out.println(operatorList.contains(4)); // è¿­ä»£å™¨è®¾è®¡æ¨¡å¼ List&lt;Integer&gt; iteratorList = new ArrayList&lt;&gt;(); iteratorList.add(1); iteratorList.add(2); iteratorList.add(3); iteratorList.add(4); iteratorList.add(5); iteratorList.add(6); Iterator&lt;Integer&gt; iterator = iteratorList.iterator(); while (iterator.hasNext()) { Integer next = iterator.next(); System.out.println(next); } // æ™®é€šforiå¾ªç¯éå† for (int i = 0,size = iteratorList.size(); i &lt; size; i++) { System.out.println(iteratorList.get(i)); } // forEachéå†ï¼Œåº•å±‚å®ç°ä¸ºè¿­ä»£å™¨ for (Integer i : iteratorList) { System.out.println(i); } }} æ€»ç»“ArrayListé›†åˆæ˜¯æˆ‘ä»¬åœ¨å·¥ä½œä¸­ç”¨åˆ°çš„æœ€å¤šçš„é›†åˆï¼Œæˆ‘ä»¬å¿…é¡»ç†Ÿç»ƒæŒæ¡å…¶ç‰¹æ€§ã€‚ é€šè¿‡ä¸Šé¢çš„æºç åˆ†æå¯çŸ¥ï¼ŒArrayListé›†åˆæŸ¥æ‰¾æ•ˆç‡éå¸¸é«˜ã€‚é¡ºåºæ·»åŠ å…ƒç´ è‡³æœ«å°¾æ•ˆç‡ä¹Ÿå¾ˆé«˜ï¼Œä½†éœ€è¦ç¡®ä¿ä¸æ‰©å®¹ï¼Œå¦åˆ™è¿›è¡Œæ•°ç»„æ‹·è´å¾ˆè€—æ—¶ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨åˆ›å»ºArrayListå¯¹è±¡æ—¶ï¼Œå¦‚æœå¯ä»¥é¢„ä¼°åˆ°é›†åˆä¸­å…ƒç´ ä¸ªæ•°ï¼Œæœ€å¥½æŒ‡å®šåˆå§‹å®¹é‡ï¼Œä»¥é¿å…åœ¨æ’å…¥æ—¶æ‰©å®¹å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚ æœ¬æ–‡Demoå®æˆ˜ä»£ç è§ï¼šä¼ é€é—¨","link":"/2020/06/01/javase/base/arraylist/"},{"title":"JDKæºç è§£æä¹‹AbstractSequentialList","text":"ç®€ä»‹AbstractSequentialListç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒç»§æ‰¿äº†AbstractListæŠ½è±¡ç±»ã€‚åŒæ ·æä¾›äº†æœ‰åºé›†åˆçš„éª¨æ¶å®ç°ï¼Œä½†æ˜¯å®ƒæ˜¯æœ€å¤§ç¨‹åº¦åœ°å‡å°‘äº†æ”¯æŒé¡ºåºè®¿é—®æ•°æ®çš„å®ç°ç±»æ‰€éœ€çš„å·¥ä½œã€‚å¦‚æœéœ€è¦éšæœºè®¿é—®æ•°æ®ï¼Œä¼˜å…ˆä½¿ç”¨AbstractListæŠ½è±¡ç±»ã€‚ ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œè¯¥ç±»ä¸AbstractListæŠ½è±¡ç±»ç›¸åï¼Œè¯¥ç±»å®ç°äº†éšæœºè®¿é—®æ–¹æ³•ï¼Œè€Œä¸æ˜¯åƒAbstractListæŠ½è±¡ç±»ä¸€æ ·æŠ›å‡ºå¼‚å¸¸ã€‚ ç‰¹æ€§è¯¥æŠ½è±¡ç±»æä¾›äº†æœ‰åºé›†åˆçš„éª¨æ¶å®ç°ã€‚è®©å®ç°ç±»æ”¯æŒé¡ºåºè®¿é—®ã€‚ å¦‚æœè¦å®ç°é›†åˆï¼Œåªéœ€ç»§æ‰¿è¯¥ç±»å¹¶å®ç°è¯¥ç±»çš„listIterator()æŠ½è±¡æ–¹æ³•å’ŒAbstractCollection#size()æ–¹æ³•ï¼› å¦‚æœè¦å®ç°ä¸å¯ä¿®æ”¹çš„é›†åˆï¼Œåªéœ€ç»§æ‰¿è¯¥ç±»å¹¶å®ç°åˆ—è¡¨è¿­ä»£å™¨ListIteratorçš„hasNext/next/hasPrevious/previous/indexæ–¹æ³•ã€‚ å¦‚æœè¦å®ç°å¯ä¿®æ”¹çš„é›†åˆï¼Œåœ¨å®ç°ä¸å¯ä¿®æ”¹é›†åˆçš„åŸºç¡€ä¸Šï¼Œéœ€è¦å¦å¤–å®ç°åˆ—è¡¨è¿­ä»£å™¨çš„setæ–¹æ³•ï¼›å¯¹äºå¯å˜å¤§å°çš„é›†åˆï¼Œè¿˜éœ€è¦å®ç°åˆ—è¡¨è¿­ä»£å™¨çš„removeå’Œaddæ–¹æ³•ã€‚ æ­¤å¤–ï¼Œå®ç°ç±»åŒæ ·åº”è¯¥éµå¾ªCollectionæ¥å£ä¸­æå‡ºçš„è§„èŒƒï¼šå¿…é¡»æä¾›ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼švoidæ— å‚æ„é€ å™¨å’Œå¸¦Collectionç±»å‹çš„å•ä¸ªå‚æ•°çš„æ„é€ å™¨ã€‚ æºç è¯¦è§£æ„é€ å™¨12protected AbstractSequentialList() {} åªæœ‰ä¸€ä¸ªä½¿ç”¨protectedä¿®é¥°ç¬¦ä¿®é¥°çš„æ— å‚æ„é€ å™¨ã€‚è¯´æ˜è¯¥æŠ½è±¡ç±»ä¸å…è®¸å¤–éƒ¨ç›´æ¥å®ä¾‹åŒ–ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªéª¨æ¶å®ç°ï¼Œå¹¶ä¸æä¾›é¡ºåºè®¿é—®é›†åˆçš„å®Œæ•´åŠŸèƒ½ã€‚ æŠ½è±¡æ–¹æ³•1public abstract ListIterator&lt;E&gt; listIterator(int index); æŒ‰æ­£ç¡®çš„é¡ºåºè¿”å›æ­¤åˆ—è¡¨çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œå…¶å¼€å§‹ç´¢å¼•ä¸ºå…¥å‚indexã€‚è¯¥ç±»ä¸­çš„å…¶å®ƒæ–¹æ³•éƒ½æ˜¯åŸºäºæ­¤æŠ½è±¡æ–¹æ³•è¿”å›çš„åˆ—è¡¨è¿­ä»£å™¨å®ç°çš„ã€‚ å·²å®ç°æ–¹æ³•æ‰€æœ‰çš„å·²å®ç°æ–¹æ³•éƒ½ä¼ å…¥äº†ç´¢å¼•å€¼ï¼Œå¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œçœ‹ä¼¼æ˜¯éšæœºè®¿é—®ï¼Œä½†å†…éƒ¨å®ç°å´æ˜¯é¡ºåºè®¿é—®ã€‚ è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ 1234567public E get(int index) { try { return listIterator(index).next(); } catch (NoSuchElementException exc) { throw new IndexOutOfBoundsException(&quot;Index: &quot;+index); }} è·å–indexç´¢å¼•å¼€å§‹çš„åˆ—è¡¨è¿­ä»£å™¨åè°ƒç”¨å…¶nextæ–¹æ³•è·å–indexç´¢å¼•ä½ç½®å…ƒç´ è¿”å›ã€‚ ç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ 12345678910public E set(int index, E element) { try { ListIterator&lt;E&gt; e = listIterator(index); E oldVal = e.next(); e.set(element); return oldVal; } catch (NoSuchElementException exc) { throw new IndexOutOfBoundsException(&quot;Index: &quot;+index); }} è·å–indexç´¢å¼•å¼€å§‹çš„åˆ—è¡¨è¿­ä»£å™¨åè°ƒç”¨å…¶nextæ–¹æ³•è·å–indexç´¢å¼•ä½ç½®çš„æ—§å€¼ï¼Œç„¶åè°ƒç”¨åˆ—è¡¨è¿­ä»£å™¨çš„setæ–¹æ³•ï¼Œè¦†ç›–nextæ–¹æ³•æœ€åè¿”å›çš„indexç´¢å¼•ä½ç½®çš„å…ƒç´ ï¼Œæœ€åè¿”å›æ—§å€¼ã€‚ åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šå…ƒç´ 1234567public void add(int index, E element) { try { listIterator(index).add(element); } catch (NoSuchElementException exc) { throw new IndexOutOfBoundsException(&quot;Index: &quot;+index); }} æ­¤å®ç°ä¼šå°†å½“å‰ä½äºindexä½ç½®çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å’Œåç»­æ‰€æœ‰å…ƒç´ å³ç§»ä¸€ä½ï¼ˆç´¢å¼•å¢ä¸€ï¼‰ã€‚ é¦–å…ˆè·å–indexç´¢å¼•å¼€å§‹çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åè°ƒç”¨åˆ—è¡¨è¿­ä»£å™¨çš„addæ–¹æ³•æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚ æ‰€ä»¥åˆ—è¡¨è¿­ä»£å™¨å¿…é¡»å®ç°addæ–¹æ³•ï¼Œå¦åˆ™è¯¥æ–¹æ³•å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ 12345678910public E remove(int index) { try { ListIterator&lt;E&gt; e = listIterator(index); E outCast = e.next(); e.remove(); return outCast; } catch (NoSuchElementException exc) { throw new IndexOutOfBoundsException(&quot;Index: &quot;+index); }} æ­¤å®ç°ä¼šå°†indexç´¢å¼•ä½ç½®åç»­æ‰€æœ‰å…ƒç´ å·¦ç§»ä¸€ä½ï¼ˆç´¢å¼•å‡ä¸€ï¼‰ã€‚ é¦–å…ˆè·å–indexç´¢å¼•å¼€å§‹çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åè·å–indexç´¢å¼•ä½ç½®çš„æ—§å…ƒç´ ï¼Œå†è°ƒç”¨åˆ—è¡¨è¿­ä»£å™¨çš„removeæ–¹æ³•åˆ é™¤å…ƒç´ ï¼Œæœ€åè¿”å›æ—§å…ƒç´ ã€‚ æ‰€ä»¥åˆ—è¡¨è¿­ä»£å™¨å¿…é¡»å®ç°removeæ–¹æ³•ï¼Œå¦åˆ™è¯¥æ–¹æ³•å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šé›†åˆ1234567891011121314public boolean addAll(int index, Collection&lt;? extends E&gt; c) { try { boolean modified = false; ListIterator&lt;E&gt; e1 = listIterator(index); Iterator&lt;? extends E&gt; e2 = c.iterator(); while (e2.hasNext()) { e1.add(e2.next()); modified = true; } return modified; } catch (NoSuchElementException exc) { throw new IndexOutOfBoundsException(&quot;Index: &quot;+index); }} æ­¤å®ç°ä¼šå°†å½“å‰ä½äºindexç´¢å¼•ä½ç½®åŠå…¶åç»­æ‰€æœ‰å…ƒç´ å³ç§»ï¼ŒæŒ‡å®šé›†åˆä¸­çš„å…ƒç´ å°†ä»¥å…¶è¿­ä»£å™¨è¿”å›çš„é¡ºåºæ˜¾ç¤ºåœ¨å½“å‰é›†åˆä¸­ã€‚ åˆ†åˆ«è·å–å½“å‰é›†åˆçš„åˆ—è¡¨è¿­ä»£å™¨å’ŒæŒ‡å®šé›†åˆçš„æ™®é€šè¿­ä»£å™¨ï¼Œè¿­ä»£æŒ‡å®šé›†åˆï¼Œä¾æ¬¡å°†å…ƒç´ addè‡³å½“å‰é›†åˆä¸­ã€‚ æ‰€ä»¥åˆ—è¡¨è¿­ä»£å™¨å¿…é¡»å®ç°addæ–¹æ³•ï¼Œå¦åˆ™è¯¥æ–¹æ³•å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ è·å–æ™®é€šè¿­ä»£å™¨123public Iterator&lt;E&gt; iterator() { return listIterator();} ç›´æ¥è°ƒç”¨å½“å‰ç±»çš„æŠ½è±¡æ–¹æ³•listIterator()ï¼Œè¿”å›åˆ—è¡¨è¿­ä»£å™¨ã€‚ æ€»ç»“è¯¥æŠ½è±¡ç±»æä¾›äº†é¡ºåºè®¿é—®é›†åˆçš„éª¨æ¶å®ç°ï¼Œæ˜¯LinkedListé›†åˆçš„ç›´æ¥çˆ¶ç±»ã€‚æ‰€æœ‰å®ç°ä¾æ‰˜äºè¯¥ç±»çš„listIterator()æŠ½è±¡æ–¹æ³•ã€‚","link":"/2020/05/27/javase/base/abstract-sequential-list/"},{"title":"JDKæºç è§£æä¹‹LinkedList","text":"å‰è¨€LinkedListçš„åº•å±‚å®ç°æ˜¯åŒå‘é“¾è¡¨ï¼Œåœ¨å­¦ä¹ å…¶æºç ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ææ‡‚é“¾è¡¨çš„åŸç†ã€‚ å•é“¾è¡¨ç®€ä»‹å•é“¾è¡¨ä¸­çš„æ•°æ®æ˜¯ä»¥èŠ‚ç‚¹çš„å½¢å¼æ¥è¡¨ç¤ºçš„ï¼Œæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨äº†å½“å‰èŠ‚ç‚¹çš„å…ƒç´ å€¼ï¼ˆæ•°æ®åŸŸï¼‰å’Œä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆåç»§èŠ‚ç‚¹ï¼‰çš„åœ°å€å€¼ï¼ˆæŒ‡é’ˆåŸŸï¼‰ã€‚æ¯ä¸ªèŠ‚ç‚¹çš„å†…å­˜ç©ºé—´å¯ä»¥æ˜¯ä¸è¿ç»­çš„ï¼Œå®ƒé€šè¿‡æ¯ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸå°†å„ä¸ªèŠ‚ç‚¹è¿æ¥èµ·æ¥ã€‚ æ¯ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªæŒ‡é’ˆåŸŸçš„é“¾è¡¨ç§°ä¸ºå•é“¾è¡¨ã€‚å¦‚æœæƒ³è¦éå†å•é“¾è¡¨ï¼Œåˆ™å¿…é¡»ä»å¤´èŠ‚ç‚¹å¼€å§‹è¿­ä»£ã€‚ åŒå‘é“¾è¡¨ç®€ä»‹åŒå‘é“¾è¡¨ä¸å•é“¾è¡¨ç›¸æ¯”ï¼Œå®ƒçš„æ¯ä¸ªèŠ‚ç‚¹åœ¨å•é“¾è¡¨çš„åŸºç¡€ä¸Šè¿˜å­˜å‚¨äº†ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå‰é©±èŠ‚ç‚¹ï¼‰çš„åœ°å€å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä»ä»»ä¸€èŠ‚ç‚¹å¼€å§‹ï¼Œéƒ½å¯ä»¥éå†æ•´ä¸ªé“¾è¡¨ã€‚ å¾ªç¯é“¾è¡¨ç®€ä»‹å•é“¾è¡¨å’ŒåŒé“¾è¡¨éƒ½å¯ä»¥æ„é€ æˆå¾ªç¯é“¾è¡¨ï¼Œåªéœ€å°†æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„åç»§ç»“ç‚¹æŒ‡é’ˆåŸŸæŒ‡å‘å¤´èŠ‚ç‚¹ï¼Œå½¢æˆä¸€ä¸ªç¯ã€‚å› æ­¤ï¼Œä»å¾ªç¯é“¾è¡¨çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œéƒ½å¯ä»¥éå†æ•´ä¸ªé“¾è¡¨ã€‚ LinkedListç®€ä»‹LinkedListç±»æ˜¯åŸºäºåŒå‘é“¾è¡¨å®ç°çš„ï¼Œå®ƒç»§æ‰¿äº†AbstractSequentialListé¡ºåºè®¿é—®é›†åˆæŠ½è±¡æ¨¡æ¿ç±»ï¼Œå®ç°äº†æœ‰åºé›†åˆæ¥å£Listå’ŒåŒç«¯é˜Ÿåˆ—æ¥å£Dequeã€‚æ‰€ä»¥ï¼ŒLinkedListå³å¯ä»¥ä½œä¸ºé›†åˆä½¿ç”¨ï¼ŒåŒæ—¶å¯ä»¥ç”¨ä½œåŒç«¯é˜Ÿåˆ—ï¼Œè¿˜å¯ä»¥ç”¨ä½œæ ˆã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„å®ç°ç±»ã€‚ LinkedListç‰¹æ€§ç”±äºLinkedListç±»ç»§æ‰¿è‡ªAbstractSequentialListæŠ½è±¡ç±»ï¼Œè€ŒAbstractSequentialListæŠ½è±¡ç±»åˆç»§æ‰¿è‡ªAbstractListæŠ½è±¡ç±»ã€‚äºæ˜¯LinkedListç±»å¾—åˆ°äº†AbstractListæŠ½è±¡ç±»çš„modCountå­—æ®µã€‚åŸºäºè¯¥å­—æ®µå®ç°äº†fail-fastæœºåˆ¶ã€‚ æºç è¯¦è§£æˆå‘˜å˜é‡12345678910111213141516171819202122/** * å®šä¹‰é›†åˆçš„å¤§å° */transient int size = 0;/** * æŒ‡å‘åŒå‘é“¾è¡¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ */transient Node&lt;E&gt; first;/** * æŒ‡å‘åŒå‘é“¾è¡¨æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ */transient Node&lt;E&gt; last;.../** * åºåˆ—åŒ–ID */private static final long serialVersionUID = 876323262645176354L; NodeèŠ‚ç‚¹ç±»1234567891011121314private static class Node&lt;E&gt; { // æ•°æ®åŸŸ E item; // åç»§èŠ‚ç‚¹ Node&lt;E&gt; next; // å‰é©±èŠ‚ç‚¹ Node&lt;E&gt; prev; Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) { this.item = element; this.next = next; this.prev = prev; }} æ„é€ å™¨éµå¾ªäº†Collectionæ¥å£çš„è§„èŒƒï¼šæä¾›äº†ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼švoidæ— å‚æ„é€ å™¨å’Œå¸¦Collectionç±»å‹çš„å•ä¸ªå‚æ•°æ„é€ å™¨ã€‚ 12345678910111213/** * æ— å‚æ„é€ å™¨ */public LinkedList() {}/** * å¸¦å‚æ„é€ å™¨ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆä¸­å…ƒç´ çš„é“¾è¡¨ï¼Œå…¶é¡ºåºä¸ºæŒ‡å®šé›†åˆè¿­ä»£å™¨è¿”å›çš„é¡ºåº */public LinkedList(Collection&lt;? extends E&gt; c) { this(); addAll(c);} æ— å‚æ„é€ å™¨ä¸­æ²¡æœ‰ä»»ä½•æ“ä½œã€‚ å¸¦å‚æ„é€ å™¨ä¸­é¦–å…ˆè°ƒç”¨äº†æ— å‚æ„é€ å™¨ï¼Œç„¶åè°ƒç”¨addAll(c)æ–¹æ³•æ„é€ é“¾è¡¨ã€‚ 123public boolean addAll(Collection&lt;? extends E&gt; c) { return addAll(size, c);} è¯¥addAll(c)æ–¹æ³•æ˜¯å°†æŒ‡å®šé›†åˆcæ·»åŠ è‡³æ­¤åˆ—è¡¨æœ«å°¾ï¼Œç”±äºæ˜¯åœ¨æ„é€ å™¨ä¸­è°ƒç”¨ï¼Œæ‰€ä»¥sizeä¸ºåˆå§‹å€¼0ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹é‡è½½çš„addAll(size,c)æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758public boolean addAll(int index, Collection&lt;? extends E&gt; c) { // æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ checkPositionIndex(index); // é›†åˆè½¬Objectæ•°ç»„ Object[] a = c.toArray(); // è®¡ç®—æ•°ç»„é•¿åº¦ int numNew = a.length; if (numNew == 0) return false; // predï¼š æ’å…¥ä½ç½®çš„å‰é©±èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼šindex - 1ï¼‰ // succï¼š æ’å…¥ä½ç½®çš„åç»§èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼šindex + 1ï¼‰ Node&lt;E&gt; pred, succ; if (index == size) { // æ’å…¥ä½ç½®ä¸ºæœ«å°¾ // åç»§èŠ‚ç‚¹ä¸ºnull succ = null; // å‰é©±èŠ‚ç‚¹ä¸º last pred = last; } else { // æ’å…¥ä½ç½®ä¸åœ¨æœ«å°¾ï¼Œåœ¨é“¾è¡¨ä¸­é—´ // åç»§èŠ‚ç‚¹ä¸º node(index) succ = node(index); // å‰é©±èŠ‚ç‚¹ä¸ºåç»§èŠ‚ç‚¹succçš„å‰é©±èŠ‚ç‚¹ pred = succ.prev; } // è¿­ä»£Objectæ•°ç»„a for (Object o : a) { // å¼ºåˆ¶ç±»å‹è½¬æ¢ @SuppressWarnings(&quot;unchecked&quot;) E e = (E) o; // åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹newNodeï¼šå…¶å‰é©±èŠ‚ç‚¹ä¸ºpredï¼ŒèŠ‚ç‚¹æ•°æ®åŸŸä¸ºæ­¤æ¬¡è¿­ä»£å…ƒç´ eï¼Œåç»§èŠ‚ç‚¹ä¸ºnull Node&lt;E&gt; newNode = new Node&lt;&gt;(pred, e, null); if (pred == null) // å‰é©±èŠ‚ç‚¹ä¸ºnullï¼šé“¾è¡¨åˆå§‹ä¸ºç©ºé“¾è¡¨ï¼›æ–°èŠ‚ç‚¹newNodeä¸ºå¤´èŠ‚ç‚¹ first = newNode; else // å‰é©±èŠ‚ç‚¹ä¸ä¸ºnullï¼šå°†predçš„åç»§èŠ‚ç‚¹æŒ‡å‘newNode pred.next = newNode; // å°†å‰é©±èŠ‚ç‚¹ç½®ä¸ºnewNodeï¼Œä»¥ä¾¿ä¸‹æ¬¡è¿­ä»£é“¾æ¥èŠ‚ç‚¹ã€‚ pred = newNode; } // è¿­ä»£å®Œæˆ if (succ == null) { // åç»§èŠ‚ç‚¹ä¸ºnullï¼šåˆå§‹æ’å…¥ä½ç½®ä¸ºé“¾è¡¨æœ«å°¾ï¼šå°†lastç½®ä¸ºæœ€åä¸€æ¬¡è¿­ä»£çš„predï¼Œå³ä¸ºé“¾è¡¨æœ«å°¾å…ƒç´ ã€‚ last = pred; } else { // åç»§èŠ‚ç‚¹ä¸ä¸ºnullï¼šä»é“¾è¡¨ä¸­é—´è¿›è¡Œæ’å…¥ï¼šå°†æœ€åä¸€æ¬¡è¿­ä»£çš„predå…ƒç´ çš„åç»§èŠ‚ç‚¹æŒ‡å‘succã€‚ pred.next = succ; // å°†succçš„å‰é©±èŠ‚ç‚¹æŒ‡å‘predã€‚ succ.prev = pred; } // é›†åˆå¤§å°å¢åŠ  size += numNew; // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++; return true;} è¯¥æ–¹æ³•æ˜¯å°†æŒ‡å®šé›†åˆæ’å…¥è‡³æŒ‡å®šç´¢å¼•ä½ç½®ï¼ŒæŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å’Œåç»­æ‰€æœ‰å…ƒç´ éƒ½å°†å³ç§»ã€‚ åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š 1ã€ ä»é“¾è¡¨å°¾éƒ¨æ’å…¥ åˆå§‹æ¡ä»¶ä¸ºï¼š åˆå§‹é“¾è¡¨ä¸ºï¼š[L,I,N] æŒ‡å®šç´¢å¼•ä½ç½®ï¼šindexï¼š3 å¾…æ’å…¥å…ƒç´ é›†åˆï¼šcollectionï¼š[K,E,D] æ’å…¥ä½ç½®çš„å‰é©±èŠ‚ç‚¹ï¼špredï¼šN æ’å…¥ä½ç½®çš„åç»§èŠ‚ç‚¹ï¼šsuccï¼šnull æ’å…¥è¿‡ç¨‹ï¼š è¿­ä»£å¼€å§‹ï¼š å¾…æ’å…¥é›†åˆè½¬æ•°ç»„ï¼šaï¼š[K,E,D] ç¬¬ä¸€æ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹newNodeï¼Œå€¼ä¸ºKï¼Œå‰é©±èŠ‚ç‚¹predä¸ºNï¼Œåç»§èŠ‚ç‚¹succä¸ºnullï¼Œå°†Nçš„åç»§èŠ‚ç‚¹æŒ‡å‘Kï¼Œå°†å‰é©±èŠ‚ç‚¹predå¼•ç”¨newNode:Kã€‚ ç¬¬äºŒæ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹newNodeï¼Œå€¼ä¸ºEï¼Œå‰é©±èŠ‚ç‚¹predä¸ºKï¼Œåç»§èŠ‚ç‚¹succä¸ºnullï¼Œå°†Kçš„åç»§èŠ‚ç‚¹æŒ‡å‘Eï¼Œ å°†å‰é©±èŠ‚ç‚¹predå¼•ç”¨newNode:Eã€‚ ç¬¬ä¸‰æ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹newNodeï¼Œå€¼ä¸ºDï¼Œå‰é©±èŠ‚ç‚¹predä¸ºEï¼Œåç»§èŠ‚ç‚¹succä¸ºnullï¼Œå°†Eçš„åç»§èŠ‚ç‚¹æŒ‡å‘Dï¼Œå°†å‰é©±èŠ‚ç‚¹predå¼•ç”¨newNode:Dã€‚ è¿­ä»£å®Œæˆã€‚ æ­¤æ—¶åç»§èŠ‚ç‚¹succä»æŒ‡å‘nullï¼Œå‰é©±èŠ‚ç‚¹predå¼•ç”¨newNode:Dï¼Œä¸ºé“¾è¡¨æœ«å°¾èŠ‚ç‚¹ï¼Œå°†lastå¼•ç”¨ç½®ä¸ºpredã€‚ é›†åˆå¤§å°å¢åŠ äº†æ•°ç»„açš„é•¿åº¦ä¸ªï¼›ä¿®æ”¹æ¬¡æ•°modCountå¢åŠ ã€‚ 2ã€ ä»é“¾è¡¨ä¸­é—´æ’å…¥ åˆå§‹æ¡ä»¶ä¸ºï¼š åˆå§‹é“¾è¡¨ä¸ºï¼š[L,I,N,D] æŒ‡å®šç´¢å¼•ä½ç½®ï¼šindexï¼š3 å¾…æ’å…¥å…ƒç´ é›†åˆï¼šcollectionï¼š[K,E] æ’å…¥ä½ç½®çš„å‰é©±èŠ‚ç‚¹ï¼špredï¼šN æ’å…¥ä½ç½®çš„åç»§èŠ‚ç‚¹ï¼šsuccï¼šD æ’å…¥è¿‡ç¨‹ï¼š è¿­ä»£å¼€å§‹ï¼š å¾…æ’å…¥é›†åˆè½¬æ•°ç»„ï¼šaï¼š[K,E] ç¬¬ä¸€æ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹newNodeï¼Œå€¼ä¸ºKï¼Œå‰é©±èŠ‚ç‚¹predä¸ºNï¼Œåç»§èŠ‚ç‚¹succä¸ºDï¼Œå°†Nçš„åç»§èŠ‚ç‚¹æŒ‡å‘Kï¼Œå°†å‰é©±èŠ‚ç‚¹predå¼•ç”¨newNode:Kã€‚ ç¬¬äºŒæ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹newNodeï¼Œå€¼ä¸ºEï¼Œå‰é©±èŠ‚ç‚¹predä¸ºKï¼Œåç»§èŠ‚ç‚¹succä¸ºDï¼Œå°†Kçš„åç»§èŠ‚ç‚¹æŒ‡å‘Eï¼Œ å°†å‰é©±èŠ‚ç‚¹predå¼•ç”¨newNode:Eã€‚ è¿­ä»£å®Œæˆã€‚ æ­¤æ—¶åç»§èŠ‚ç‚¹succä»æŒ‡å‘Dï¼Œå‰é©±èŠ‚ç‚¹predå¼•ç”¨newNode:Eï¼Œlastå¼•ç”¨ä»æŒ‡å‘Dã€‚ å°†predçš„åç»§èŠ‚ç‚¹æŒ‡å‘Dï¼Œå°†Dçš„å‰é©±èŠ‚ç‚¹æŒ‡å‘Eã€‚ é›†åˆå¤§å°å¢åŠ äº†æ•°ç»„açš„é•¿åº¦ä¸ªï¼›ä¿®æ”¹æ¬¡æ•°modCountå¢åŠ ã€‚ å†…éƒ¨æ–¹æ³•LinkedListç±»ä¸­æä¾›äº†ä¸€äº›é»˜è®¤æˆ–ç§æœ‰æ–¹æ³•ç”¨æ¥å°†ä¸€ä¸ªæŒ‡å®šå…ƒç´ è¿æ¥è‡³æ•´ä¸ªé“¾è¡¨ã€‚ è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå¤´èŠ‚ç‚¹123456789101112131415161718private void linkFirst(E e) { // è·å–é“¾è¡¨å¤´èŠ‚ç‚¹f final Node&lt;E&gt; f = first; // åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå…¶æ•°æ®åŸŸä¸ºeï¼Œåç»§èŠ‚ç‚¹ä¸ºé“¾è¡¨å¤´èŠ‚ç‚¹fã€‚ final Node&lt;E&gt; newNode = new Node&lt;&gt;(null, e, f); // é“¾è¡¨å¤´èŠ‚ç‚¹å¼•ç”¨æŒ‡å‘æ–°èŠ‚ç‚¹ first = newNode; if (f == null) // æ—§çš„å¤´èŠ‚ç‚¹ä¸ºnullï¼šåŸé“¾è¡¨ä¸ºç©ºé“¾è¡¨ã€‚å°†å°¾èŠ‚ç‚¹å¼•ç”¨lastä¹ŸæŒ‡å‘æ–°èŠ‚ç‚¹ã€‚ last = newNode; else // æ—§çš„å¤´èŠ‚ç‚¹ä¸ä¸ºnullï¼šæ–°èŠ‚ç‚¹å°†ä½œä¸ºæ•´ä¸ªé“¾è¡¨çš„æ–°çš„å¤´èŠ‚ç‚¹ã€‚å°†æ—§çš„å¤´èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ã€‚ f.prev = newNode; // é›†åˆå¤§å°å¢åŠ  size++; // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++;} é¦–å…ˆé€šè¿‡å¤´èŠ‚ç‚¹å¼•ç”¨firstè·å–å½“å‰é“¾è¡¨å¤´èŠ‚ç‚¹fï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„NodeèŠ‚ç‚¹newNodeï¼Œå…¶æ•°æ®åŸŸä¸ºæŒ‡å®šå…ƒç´ eï¼Œåç»§èŠ‚ç‚¹ä¸ºå½“å‰é“¾è¡¨å¤´èŠ‚ç‚¹fï¼› ç„¶åå°†å¤´èŠ‚ç‚¹å¼•ç”¨firstæŒ‡å‘newNodeï¼Œåˆ¤æ–­æ—§çš„å¤´èŠ‚ç‚¹fæ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯ï¼Œåˆ™åŸé“¾è¡¨ä¸ºç©ºé“¾è¡¨ï¼Œå°†å°¾èŠ‚ç‚¹å¼•ç”¨lastæŒ‡å‘newNodeï¼›å¦åˆ™ï¼Œå°†æ—§çš„å¤´èŠ‚ç‚¹fçš„å‰é©±èŠ‚ç‚¹æŒ‡å‘newNodeã€‚ è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå°¾èŠ‚ç‚¹123456789101112131415161718void linkLast(E e) { // è·å–é“¾è¡¨å°¾èŠ‚ç‚¹ final Node&lt;E&gt; l = last; // åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå…¶æ•°æ®åŸŸä¸ºeï¼Œå‰é©±èŠ‚ç‚¹ä¸ºé“¾è¡¨å°¾èŠ‚ç‚¹l final Node&lt;E&gt; newNode = new Node&lt;&gt;(l, e, null); // é“¾è¡¨å°¾èŠ‚ç‚¹å¼•ç”¨æ‰§è¡Œæ–°èŠ‚ç‚¹ last = newNode; if (l == null) // æ—§çš„å°¾èŠ‚ç‚¹ä¸ºnullï¼šåŸé“¾è¡¨ä¸ºç©ºé“¾è¡¨ã€‚å°†å¤´èŠ‚ç‚¹å¼•ç”¨ä¹ŸæŒ‡å‘æ–°èŠ‚ç‚¹ã€‚ first = newNode; else // æ—§çš„å°¾èŠ‚ç‚¹ä¸ä¸ºnullï¼šæ–°èŠ‚ç‚¹å°†ä½œä¸ºæ•´ä¸ªé“¾è¡¨çš„æ–°çš„å°¾èŠ‚ç‚¹ã€‚å°†æ—§çš„å°¾èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ã€‚ l.next = newNode; // é›†åˆå¤§å°å¢åŠ  size++; // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++;} é¦–å…ˆé€šè¿‡å°¾èŠ‚ç‚¹å¼•ç”¨lastè·å–å½“å‰é“¾è¡¨å°¾èŠ‚ç‚¹lï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„NodeèŠ‚ç‚¹newNodeï¼Œå…¶æ•°æ®åŸŸä¸ºæŒ‡å®šå…ƒç´ eï¼Œå‰é©±èŠ‚ç‚¹ä¸ºå½“å‰é“¾è¡¨å°¾èŠ‚ç‚¹lï¼› ç„¶åå°†å°¾èŠ‚ç‚¹å¼•ç”¨lastæŒ‡å‘newNodeï¼Œåˆ¤æ–­æ—§çš„å°¾èŠ‚ç‚¹læ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯ï¼Œåˆ™åŸé“¾è¡¨ä¸ºç©ºé“¾è¡¨ï¼Œå°†å¤´èŠ‚ç‚¹å¼•ç”¨firstæŒ‡å‘newNodeï¼›å¦åˆ™ï¼Œå°†æ—§çš„å°¾èŠ‚ç‚¹lçš„åç»§èŠ‚ç‚¹æŒ‡å‘newNodeã€‚ åœ¨æŒ‡å®šèŠ‚ç‚¹ä¹‹å‰è¿æ¥æŒ‡å®šå…ƒç´ 12345678910111213141516171819202122/** * çº¦å®šæŒ‡å®šèŠ‚ç‚¹succä¸ä¸ºnull */void linkBefore(E e, Node&lt;E&gt; succ) { // assert succ != null; // è·å–æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ final Node&lt;E&gt; pred = succ.prev; // åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå…¶æ•°æ®åŸŸä¸ºeï¼Œå‰é©±èŠ‚ç‚¹ä¸ºæŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ï¼Œåç»§èŠ‚ç‚¹ä¸ºæŒ‡å®šèŠ‚ç‚¹ã€‚ final Node&lt;E&gt; newNode = new Node&lt;&gt;(pred, e, succ); // æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ succ.prev = newNode; if (pred == null) // æŒ‡å®šèŠ‚ç‚¹çš„æ—§çš„å‰é©±èŠ‚ç‚¹ä¸ºnullï¼šæŒ‡å®šèŠ‚ç‚¹ä¸ºåŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚æ–°èŠ‚ç‚¹å°†ä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚ first = newNode; else // æŒ‡å®šèŠ‚ç‚¹çš„æ—§çš„å‰é©±èŠ‚ç‚¹ä¸ä¸ºnullï¼šå°†æŒ‡å®šèŠ‚ç‚¹çš„æ—§çš„å‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ã€‚ pred.next = newNode; // é›†åˆå¤§å°å¢åŠ  size++; // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++;} çº¦å®šæŒ‡å®šèŠ‚ç‚¹succéç©ºï¼Œå¦åˆ™å°†å¯¼è‡´NPEé—®é¢˜ã€‚ é¦–å…ˆè·å–æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹predï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„NodeèŠ‚ç‚¹newNodeï¼Œå…¶å‰é©±èŠ‚ç‚¹ä¸ºpredï¼Œæ•°æ®åŸŸä¸ºæŒ‡å®šå…ƒç´ eï¼Œåç»§èŠ‚ç‚¹ä¸ºæŒ‡å®šèŠ‚ç‚¹succã€‚ å°†æŒ‡å®šèŠ‚ç‚¹succçš„å‰é©±èŠ‚ç‚¹æŒ‡å‘newNodeï¼Œåˆ¤æ–­æŒ‡å®šèŠ‚ç‚¹succçš„æ—§çš„å‰é©±èŠ‚ç‚¹predæ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æŒ‡å®šèŠ‚ç‚¹succä¸ºåŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œå°†å¤´èŠ‚ç‚¹å¼•ç”¨firstæŒ‡å‘newNodeï¼›å¦åˆ™ï¼Œå°†æ—§çš„å‰é©±èŠ‚ç‚¹predçš„åç»§èŠ‚ç‚¹æŒ‡å‘newNodeã€‚ å–æ¶ˆå¤´èŠ‚ç‚¹çš„è¿æ¥123456789101112131415161718192021222324252627/** * çº¦å®šæŒ‡å®šèŠ‚ç‚¹fä¸ºé“¾è¡¨å¤´èŠ‚ç‚¹ä¸”ä¸ä¸ºnull */private E unlinkFirst(Node&lt;E&gt; f) { // assert f == first &amp;&amp; f != null; // è·å–å¤´èŠ‚ç‚¹çš„å…ƒç´ å€¼ final E element = f.item; // è·å–å¤´èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ï¼šå³å°†æˆä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚ final Node&lt;E&gt; next = f.next; // å°†åŸå¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸå’Œåç»§èŠ‚ç‚¹ç½®ä¸ºnullã€‚è§£é™¤å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚ f.item = null; f.next = null; // help GC // å°†å¤´èŠ‚ç‚¹å¼•ç”¨æŒ‡å‘next first = next; if (next == null) // nextä¸ºnullï¼šåŸé“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚å°†å°¾èŠ‚ç‚¹å¼•ç”¨ç½®ä¸ºnullã€‚ last = null; else // nextä¸ä¸ºnullï¼šå°†nextçš„å‰é©±èŠ‚ç‚¹ç½®ä¸ºnullã€‚å–æ¶ˆå¯¹åŸå¤´èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚ next.prev = null; // é›†åˆå¤§å°å‡å°‘ size--; // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++; // è¿”å›è¢«å‰”é™¤çš„èŠ‚ç‚¹å…ƒç´ å€¼ã€‚ return element;} çº¦å®šæŒ‡å®šèŠ‚ç‚¹ä¸ºé“¾è¡¨çš„å¤´èŠ‚ç‚¹ä¸”éç©ºï¼Œå¦åˆ™å°†å¯¼è‡´NPEé—®é¢˜ã€‚ è·å–å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸå€¼elementå’Œåç»§èŠ‚ç‚¹nextï¼Œå°†å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸå’Œåç»§èŠ‚ç‚¹ç½®ä¸ºnullã€‚è§£é™¤å¯¹åŸå¯¹è±¡çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚ ç„¶åå°†å¤´èŠ‚ç‚¹å¼•ç”¨firstæŒ‡å‘nextï¼Œåˆ¤æ–­nextæ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯ï¼Œåˆ™åŸé“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†å°¾èŠ‚ç‚¹å¼•ç”¨lastç½®ä¸ºnullï¼›å¦åˆ™ï¼Œå°†nextèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ç½®ä¸ºnullï¼Œå–æ¶ˆå¯¹åŸé“¾è¡¨å¤´èŠ‚ç‚¹çš„å¼•ç”¨ã€‚ å–æ¶ˆå°¾èŠ‚ç‚¹çš„è¿æ¥123456789101112131415161718192021222324252627/** * çº¦å®šæŒ‡å®šèŠ‚ç‚¹lä¸ºé“¾è¡¨å°¾èŠ‚ç‚¹ä¸”ä¸ä¸ºnull */private E unlinkLast(Node&lt;E&gt; l) { // assert l == last &amp;&amp; l != null; // è·å–å°¾èŠ‚ç‚¹çš„å…ƒç´ å€¼ final E element = l.item; // è·å–å°¾èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ï¼šå³å°†æˆä¸ºæ–°çš„å°¾èŠ‚ç‚¹ã€‚ final Node&lt;E&gt; prev = l.prev; // å°†åŸå°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸå’Œå‰é©±èŠ‚ç‚¹ç½®ä¸ºnullã€‚è§£é™¤å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚ l.item = null; l.prev = null; // help GC // å°†å°¾èŠ‚ç‚¹å¼•ç”¨æŒ‡å‘prev last = prev; if (prev == null) // prevä¸ºnullï¼šåŸé“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚å°†å¤´èŠ‚ç‚¹å¼•ç”¨ç½®ä¸ºnullã€‚ first = null; else // prevä¸ä¸ºnullï¼šå°†prevçš„åç»§èŠ‚ç‚¹ç½®ä¸ºnullã€‚å–æ¶ˆå¯¹åŸå°¾èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚ prev.next = null; // é›†åˆå¤§å°å‡å°‘ size--; // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++; // è¿”å›è¢«å‰”é™¤çš„èŠ‚ç‚¹å…ƒç´ å€¼ return element;} çº¦å®šæŒ‡å®šèŠ‚ç‚¹ä¸ºé“¾è¡¨çš„å°¾èŠ‚ç‚¹ä¸”éç©ºï¼Œå¦åˆ™å°†å¯¼è‡´NPEé—®é¢˜ã€‚ è·å–å°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸå€¼elementå’Œå‰é©±èŠ‚ç‚¹prevï¼Œå°†å°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸå’Œå‰é©±èŠ‚ç‚¹ç½®ä¸ºnullã€‚è§£é™¤å¯¹åŸå¯¹è±¡çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚ ç„¶åå°†å°¾èŠ‚ç‚¹å¼•ç”¨lastæŒ‡å‘prevï¼Œåˆ¤æ–­prevæ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯ï¼Œåˆ™åŸé“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†å¤´èŠ‚ç‚¹å¼•ç”¨firstç½®ä¸ºnullï¼›å¦åˆ™ï¼Œå°†prevèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ç½®ä¸ºnullï¼Œå–æ¶ˆå¯¹åŸé“¾è¡¨å°¾èŠ‚ç‚¹çš„å¼•ç”¨ã€‚ å–æ¶ˆæŒ‡å®šèŠ‚ç‚¹çš„è¿æ¥1234567891011121314151617181920212223242526272829303132333435363738394041/** * çº¦å®šæŒ‡å®šèŠ‚ç‚¹xä¸ä¸ºnull */E unlink(Node&lt;E&gt; x) { // assert x != null; // è·å–æŒ‡å®šèŠ‚ç‚¹xçš„æ•°æ®åŸŸå…ƒç´  final E element = x.item; // è·å–æŒ‡å®šèŠ‚ç‚¹xçš„åç»§èŠ‚ç‚¹ final Node&lt;E&gt; next = x.next; // è·å–æŒ‡å®šèŠ‚ç‚¹xçš„å‰é©±èŠ‚ç‚¹ final Node&lt;E&gt; prev = x.prev; if (prev == null) { // æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ä¸ºnullï¼šæŒ‡å®šèŠ‚ç‚¹ä¸ºåŸé“¾è¡¨å¤´èŠ‚ç‚¹ã€‚æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹å°†ä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚ first = next; } else { // å¦åˆ™ï¼Œå°†æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ã€‚ prev.next = next; // æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ç½®ä¸ºnull x.prev = null; } if (next == null) { // æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ä¸ºnullï¼šæŒ‡å®šèŠ‚ç‚¹ä¸ºåŸé“¾è¡¨å°¾èŠ‚ç‚¹ã€‚æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹å°†ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ã€‚ last = prev; } else { // å¦åˆ™ï¼Œå°†æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ã€‚ next.prev = prev; // æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ç½®ä¸ºnull x.next = null; } // æŒ‡å®šèŠ‚ç‚¹çš„æ•°æ®åŸŸå…ƒç´ ç½®ä¸ºnull x.item = null; // é›†åˆå¤§å°å‡å°‘ size--; // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++; // è¿”å›è¢«å‰”é™¤çš„èŠ‚ç‚¹å…ƒç´ å€¼ return element;} çº¦å®šæŒ‡å®šèŠ‚ç‚¹xéç©ºï¼Œå¦åˆ™å°†å¯¼è‡´NPEé—®é¢˜ã€‚ åˆ†åˆ«è·å–æŒ‡å®šèŠ‚ç‚¹xçš„æ•°æ®åŸŸå…ƒç´ elementã€åç»§èŠ‚ç‚¹nextå’Œå‰é©±èŠ‚ç‚¹prevã€‚ å¦‚æœå‰é©±èŠ‚ç‚¹prevä¸ºnullï¼Œåˆ™åœ¨åŸé“¾è¡¨ä¸­ï¼ŒæŒ‡å®šèŠ‚ç‚¹xä¸ºå¤´èŠ‚ç‚¹ï¼ŒæŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹nextå°†ä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ï¼šå°†firstå¼•ç”¨æŒ‡å‘åç»§èŠ‚ç‚¹nextï¼›å¦åˆ™å°†å‰é©±èŠ‚ç‚¹prevçš„åç»§èŠ‚ç‚¹æŒ‡å‘nextï¼Œå°†æŒ‡å®šå…ƒç´ xçš„å‰é©±èŠ‚ç‚¹ç½®ä¸ºnullã€‚ å¦‚æœåç»§èŠ‚ç‚¹nextä¸ºnullï¼Œåˆ™åœ¨åŸé“¾è¡¨ä¸­ï¼ŒæŒ‡å®šèŠ‚ç‚¹xä¸ºå°¾èŠ‚ç‚¹ï¼ŒæŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹prevå°†ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ï¼šå°†lastå¼•ç”¨æŒ‡å‘å‰é©±èŠ‚ç‚¹prevï¼›å¦åˆ™å°†åç»§èŠ‚ç‚¹nextçš„å‰é©±èŠ‚ç‚¹æŒ‡å‘prevï¼Œå°†æŒ‡å®šå…ƒç´ xçš„åç»§èŠ‚ç‚¹ç½®ä¸ºnullã€‚ æœ€åå°†æŒ‡å®šèŠ‚ç‚¹xçš„æ•°æ®åŸŸç½®ä¸ºnullï¼Œè§£é™¤å¯¹è±¡å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚ è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„NodeèŠ‚ç‚¹1234567891011121314151617181920212223242526/** * çº¦å®šæŒ‡å®šç´¢å¼•åˆæ³• */Node&lt;E&gt; node(int index) { // assert isElementIndex(index); // äºŒåˆ†æ³• if (index &lt; (size &gt;&gt; 1)) { // æŒ‡å®šç´¢å¼•åœ¨[0,size/2)ä¹‹é—´ // è·å–å¤´èŠ‚ç‚¹x Node&lt;E&gt; x = first; // ä»0è¿­ä»£åˆ°indexï¼Œæ¯æ¬¡è¿­ä»£å°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹ for (int i = 0; i &lt; index; i++) x = x.next; // è¿­ä»£å®Œæˆï¼Œxå³ä¸ºæŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ return x; } else { // æŒ‡å®šç´¢å¼•åœ¨[size/2,size]ä¹‹é—´ // è·å–å°¾èŠ‚ç‚¹ Node&lt;E&gt; x = last; // ä»size-1è¿­ä»£åˆ°indexï¼Œæ¯æ¬¡è¿­ä»£å°†xèµ‹å€¼ä¸ºxçš„å‰é©±èŠ‚ç‚¹ for (int i = size - 1; i &gt; index; i--) x = x.prev; // è¿­ä»£å®Œæˆï¼Œxå³ä¸ºæŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ return x; }} çº¦å®šæŒ‡å®šç´¢å¼•ä¸ä¼šäº§ç”Ÿè¶Šç•Œã€‚ é‡‡ç”¨äºŒåˆ†æ³•çš„æ€æƒ³ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ï¼Œå¦‚æœæŒ‡å®šç´¢å¼•indexåœ¨[0,size/2)èŒƒå›´å†…ï¼Œåˆ™ä»0è¿­ä»£è‡³index - 1ï¼Œè¿­ä»£ä¹‹å‰è·å–å¤´èŠ‚ç‚¹xï¼Œæ¯æ¬¡è¿­ä»£å°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹ï¼Œè¿­ä»£å®Œæˆæ—¶ï¼Œxå³ä¸ºæŒ‡å®šç´¢å¼•indexä½ç½®çš„å…ƒç´ ï¼›å¦‚æœæŒ‡å®šç´¢å¼•indexåœ¨[size/2,size)ä¹‹é—´ï¼Œåˆ™ä»size - 1è¿­ä»£è‡³index + 1ï¼Œè¿­ä»£ä¹‹å‰è·å–å°¾èŠ‚ç‚¹xï¼Œæ¯æ¬¡è¿­ä»£å°†xèµ‹å€¼ä¸ºxçš„å‰é©±èŠ‚ç‚¹ï¼Œè¿­ä»£å®Œæˆæ—¶ï¼Œxå³ä¸ºæŒ‡å®šç´¢å¼•indexä½ç½®çš„å…ƒç´ ã€‚ é›†åˆæ–¹æ³•LinkedListç»§æ‰¿äº†AbstractSequentialListæœ‰åºé›†åˆé¡ºåºè®¿é—®æŠ½è±¡æ¨¡æ¿ç±»ã€‚å¯¹é›†åˆæ–¹æ³•è¿›è¡Œäº†å®ç°ï¼Œå¯ä»¥ä½œä¸ºé›†åˆä½¿ç”¨ã€‚ æ·»åŠ æŒ‡å®šå…ƒç´ è‡³é›†åˆæœ«å°¾12345public boolean add(E e) { // è°ƒç”¨å†…éƒ¨æ–¹æ³•linkLast(e) linkLast(e); return true;} è¯¥æ–¹æ³•çš„æœ€åˆæ¥æºæ˜¯Collectionæ¥å£ä¸­å®šä¹‰çš„add(E e)æ–¹æ³•ã€‚ AbstractSequentialListæŠ½è±¡ç±»ç»§æ‰¿äº†AbstractListæŠ½è±¡ç±»ï¼Œåœ¨AbstractListæŠ½è±¡ç±»ä¸­å·²ç»å®ç°äº†add(E e)æ–¹æ³•ã€‚å®ƒåªè¦æ±‚å­ç±»å»å®ç°add(int index,E e)æ–¹æ³•å³å¯å®ç°add(E e)ã€‚åœ¨LinkedListç±»ä¸­å·²ç»æä¾›äº†add(int index,E e)æ–¹æ³•çš„å®ç°ï¼Œå®ƒä¸ºä»€ä¹ˆè¿˜è¦é‡å†™add(E e)æ–¹æ³•å‘¢ï¼Ÿ ç†è§£ï¼šLinkedListä½œä¸ºä¸€ä¸ªä¼˜ç§€çš„å®ç°ç±»ï¼Œå®ƒç»§æ‰¿/å®ç°äº†å¤šä¸ªæ¥å£ã€‚åœ¨ç¼–ç å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¾‹å¦‚ï¼šList&lt;String&gt; list = new LinkedList&lt;&gt;()ã€‚LinkedListç±»çš„å¯¹è±¡ä¼šå‘ä¸Šè½¬å‹ä¸ºListç±»ã€‚å¯¹äºå®ä¾‹å¯¹è±¡listæ¥è¯´ï¼Œæ­¤æ—¶å®ƒæ˜¯ä¸€ä¸ªListï¼Œå®ƒæ‰€å…·æœ‰çš„æ–¹æ³•æ˜¯Listæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯LinkedListç±»ä¸­çš„æ–¹æ³•ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è°ƒç”¨list.add(E e)æ—¶ï¼Œå®é™…ä¸Šè°ƒç”¨çš„æ˜¯Listç±»ä¸­å®šä¹‰çš„add(E e)æ–¹æ³•ï¼Œè€Œå®ƒçš„å®ç°æ˜¯åœ¨LinkedListç±»ä¸­ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬æƒ³æŠŠLinkedListä½œä¸ºListé›†åˆä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆï¼šList&lt;String&gt; list = new LinkedList&lt;&gt;()ã€‚è€Œå½“æˆ‘ä»¬æƒ³æŠŠLinkedListå½“åšQueueé˜Ÿåˆ—ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆQueue&lt;String&gt; queue = new LinkedList&lt;&gt;()ã€‚å®ƒå¯ä»¥å‘ä¸Šè½¬å‹æˆä»»æ„çš„çˆ¶æ¥å£ï¼ˆæˆ–çˆ¶æ¥å£çš„çˆ¶æ¥å£ï¼‰ï¼Œå‘ä¸Šè½¬å‹åï¼Œå®ä¾‹å¯¹è±¡åªæ‹¥æœ‰è½¬å‹åçš„æ¥å£ä¸­æ‰€å®šä¹‰çš„æ–¹æ³•ã€‚æ‰€ä»¥ï¼ŒLinkedListç±»ä¸­å¯¹æ‰€æœ‰çˆ¶æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•éƒ½è¿›è¡Œäº†å®ç°ï¼Œä»¥ä¾¿å‘ä¸Šè½¬å‹ä½¿ç”¨ã€‚ è¿™ä½“ç°äº†Javaçš„å¤šæ€æœºåˆ¶ã€‚ ç›´æ¥è°ƒç”¨äº†å†…éƒ¨æ–¹æ³•linkLast(e)ï¼Œåœ¨ä¸å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹å›ºå®šè¿”å›trueã€‚ åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ 1234567891011public void add(int index, E element) { // æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ checkPositionIndex(index); if (index == size) // æŒ‡å®šç´¢å¼•åœ¨é›†åˆæœ«å°¾ï¼šè°ƒç”¨å†…éƒ¨æ–¹æ³•è¿æ¥æŒ‡å®šå…ƒç´ è‡³é“¾è¡¨æœ«å°¾ linkLast(element); else // æŒ‡å®šç´¢å¼•åœ¨é›†åˆä¸­é—´ï¼šè°ƒç”¨å†…éƒ¨æ–¹æ³•è¿æ¥æŒ‡å®šå…ƒç´ è‡³æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ä¹‹å‰ã€‚ linkBefore(element, node(index));} é¦–å…ˆæ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œï¼Œç„¶ååˆ¤æ–­æŒ‡å®šç´¢å¼•æ˜¯å¦åœ¨é›†åˆæœ«å°¾ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æŒ‡å®šå…ƒç´ ä¸ºé“¾è¡¨çš„æ–°å°¾èŠ‚ç‚¹ï¼Œè°ƒç”¨å†…éƒ¨æ–¹æ³•linkLast(e)ï¼Œå°†æŒ‡å®šå…ƒç´ è¿æ¥è‡³é“¾è¡¨æœ«å°¾ï¼›å¦åˆ™ï¼Œè°ƒç”¨å†…éƒ¨æ–¹æ³•linkBefore(e,node)å°†æŒ‡å®šå…ƒç´ è¿æ¥è‡³æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ä¹‹å‰ã€‚ æ¸…ç©ºæ‰€æœ‰å…ƒç´ 1234567891011121314151617181920212223public void clear() { // Clearing all of the links between nodes is &quot;unnecessary&quot;, but: // - helps a generational GC if the discarded nodes inhabit // more than one generation // - is sure to free memory even if there is a reachable Iterator for (Node&lt;E&gt; x = first; x != null; ) { // è¿­ä»£ï¼šåˆå§‹xä¸ºå¤´èŠ‚ç‚¹ï¼›è¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºï¼šxä¸ºnullã€‚ // è·å–xçš„åç»§èŠ‚ç‚¹ Node&lt;E&gt; next = x.next; // å½“å‰xçš„æ•°æ®åŸŸã€åç»§èŠ‚ç‚¹å’Œå‰é©±èŠ‚ç‚¹éƒ½ç½®ä¸ºnull x.item = null; x.next = null; x.prev = null; // xèµ‹å€¼ä¸ºå…¶åç»§èŠ‚ç‚¹ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ã€‚ x = next; } // æ¸…é™¤å¤´å°¾èŠ‚ç‚¹å¼•ç”¨ first = last = null; // é‡ç½®é›†åˆå¤§å° size = 0; // ä¿®æ”¹æ¬¡æ•°å¢åŠ  modCount++;} è¿­ä»£é“¾è¡¨ï¼Œforå¾ªç¯ä¸­è·å–åŸé“¾è¡¨å¤´èŠ‚ç‚¹xï¼Œè¿­ä»£è¿‡ç¨‹ä¸­å¯¹xè¿›è¡Œé‡æ–°èµ‹å€¼ï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºxä¸ºnullã€‚ æ¯æ¬¡è¿­ä»£å°†å½“å‰è¿­ä»£çš„èŠ‚ç‚¹xçš„æ•°æ®åŸŸã€åç»§èŠ‚ç‚¹å’Œå‰é©±èŠ‚ç‚¹éƒ½ç½®ä¸ºnullï¼Œç„¶åå°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ï¼Œç›´è‡³xä¸ºå°¾èŠ‚ç‚¹ã€‚ è¿­ä»£å®Œæˆåæ¸…é™¤å¤´å°¾èŠ‚ç‚¹firstå’Œlastçš„å¼•ç”¨ï¼Œé‡ç½®é›†åˆå¤§å°ä¸º0ã€‚ è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®123456789101112131415161718192021222324public int indexOf(Object o) { // ç´¢å¼•è®°å½• int index = 0; if (o == null) { // æŒ‡å®šå…ƒç´ ä¸ºnull for (Node&lt;E&gt; x = first; x != null; x = x.next) { // è¿­ä»£ï¼šè·å–é“¾è¡¨å¤´èŠ‚ç‚¹xï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºxä¸ºnullï¼Œæ¯æ¬¡è¿­ä»£å®Œæˆå°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹ // åˆ¤æ–­èŠ‚ç‚¹xçš„æ•°æ®åŸŸæ˜¯å¦ä¸ºnullï¼šæ˜¯åˆ™æ‰¾åˆ°äº†æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œè¿”å›ç´¢å¼•è®°å½•indexï¼›å¦åˆ™ï¼Œç´¢å¼•å¢ä¸€ã€‚ if (x.item == null) return index; index++; } } else { // æŒ‡å®šå…ƒç´ ä¸ä¸ºnullï¼Œé‡‡ç”¨equalsæ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ for (Node&lt;E&gt; x = first; x != null; x = x.next) { // è¿­ä»£çš„æ¡ä»¶åŒæŒ‡å®šå…ƒç´ ä¸ºnullçš„æƒ…å†µ if (o.equals(x.item)) return index; index++; } } // è¿­ä»£å®Œæˆä»æœªè¿”å›ï¼šé›†åˆä¸­ä¸å­˜åœ¨æŒ‡å®šå…ƒç´ ï¼Œè¿”å›-1ã€‚ return -1;} é¦–å…ˆåˆ›å»ºä¸€ä¸ªç´¢å¼•è®°å½•indexåˆå§‹ä¸º0ï¼Œç„¶åè¿­ä»£é“¾è¡¨ï¼Œåˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸ºnullå’Œénullä¸¤ç§æƒ…å†µï¼Œä¸ºnullåˆ™é‡‡ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒï¼›énullåˆ™é‡‡ç”¨equalsæ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚ä»é“¾è¡¨å¤´èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œä¸€æ—¦æ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ ï¼Œåˆ™è¿”å›ç´¢å¼•indexï¼Œå¦åˆ™ç´¢å¼•å¢ä¸€ã€‚å¦‚æœè¿­ä»£å®Œæˆä»æœªæ‰¾åˆ°æŒ‡å®šå…ƒç´ ï¼Œåˆ™è¿”å›-1ã€‚ è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®12345678910111213141516171819202122232425public int lastIndexOf(Object o) { // ç´¢å¼•è®°å½•åˆå§‹ä¸ºé›†åˆå¤§å°size int index = size; if (o == null) { // æŒ‡å®šå…ƒç´ ä¸ºnullï¼Œé‡‡ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒ for (Node&lt;E&gt; x = last; x != null; x = x.prev) { // è¿­ä»£ï¼šè·å–é“¾è¡¨å°¾èŠ‚ç‚¹xï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºxä¸ºnullï¼Œæ¯æ¬¡è¿­ä»£åå°†xèµ‹å€¼ä¸ºxçš„å‰é©±èŠ‚ç‚¹ // é¦–å…ˆç´¢å¼•è®°å½•å‡ä¸€ index--; // åˆ¤æ–­èŠ‚ç‚¹xçš„æ•°æ®åŸŸæ˜¯å¦ä¸ºnullï¼šæ˜¯åˆ™æ‰¾åˆ°äº†æŒ‡å®šå…ƒç´ çš„æœ€åä¸€æ¬¡å‡ºç°ï¼Œè¿”å›ç´¢å¼•è®°å½•indexï¼›å¦åˆ™ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ã€‚ if (x.item == null) return index; } } else { // æŒ‡å®šå…ƒç´ ä¸ä¸ºnullï¼Œé‡‡ç”¨equalsæ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ for (Node&lt;E&gt; x = last; x != null; x = x.prev) { // è¿­ä»£çš„æ¡ä»¶åŒæŒ‡å®šå…ƒç´ ä¸ºnullçš„æƒ…å†µ index--; if (o.equals(x.item)) return index; } } // è¿­ä»£å®Œæˆä»æœªè¿”å›ï¼šé›†åˆä¸­ä¸å­˜åœ¨æŒ‡å®šå…ƒç´ ï¼Œè¿”å›-1ã€‚ return -1;} é¦–å…ˆåˆ›å»ºä¸€ä¸ªç´¢å¼•è®°å½•indexåˆå§‹ä¸ºé›†åˆå¤§å°sizeï¼Œç„¶åè¿­ä»£é“¾è¡¨ï¼Œåˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸ºnullå’Œénullä¸¤ç§æƒ…å†µï¼Œä¸ºnullåˆ™é‡‡ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒï¼›énullåˆ™é‡‡ç”¨equalsæ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚ä»é“¾è¡¨å°¾èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œè¿­ä»£ä¸€å¼€å§‹å°±å°†ç´¢å¼•è®°å½•å‡ä¸€ï¼Œç„¶åè¿›è¡Œç›¸ç­‰æ¯”è¾ƒï¼Œä¸€æ—¦æ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ ï¼Œåˆ™è¿”å›ç´¢å¼•indexï¼Œå¦åˆ™è¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ã€‚å¦‚æœè¿­ä»£å®Œæˆä»æœªæ‰¾åˆ°æŒ‡å®šå…ƒç´ ï¼Œåˆ™è¿”å›-1ã€‚ åˆ¤æ–­æŒ‡å®šå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­è‡³å°‘å‡ºç°ä¸€æ¬¡123public boolean contains(Object o) { return indexOf(o) != -1;} å®é™…ä¸Šè°ƒç”¨çš„æ˜¯indexOfæ–¹æ³•å¯»æ‰¾æŒ‡å®šå…ƒç´ çš„ç´¢å¼•ä½ç½®ï¼Œå¦‚æœè¿”å›-1åˆ™é›†åˆä¸­ä¸å­˜åœ¨è¯¥æŒ‡å®šå…ƒç´ ï¼Œå¦åˆ™è¡¨ç¤ºæŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­è‡³å°‘å‡ºç°è¿‡ä¸€æ¬¡ã€‚ è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ 123456public E get(int index) { // æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ checkElementIndex(index); // è°ƒç”¨å†…éƒ¨æ–¹æ³•node(index)è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ï¼Œå–å‡ºæ•°æ®åŸŸitemè¿”å›ã€‚ return node(index).item;} é¦–å…ˆæ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œï¼Œç„¶åè°ƒç”¨å†…éƒ¨æ–¹æ³•node(index)è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ï¼Œå–å‡ºå…¶æ•°æ®åŸŸitemè¿”å›ã€‚ å‰”é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ 123456public E remove(int index) { // æ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œ checkElementIndex(index); // è°ƒç”¨å†…éƒ¨æ–¹æ³•nodeè·å–æŒ‡å®šç´¢å¼•ä½ç½®èŠ‚ç‚¹ï¼Œå†è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkå–æ¶ˆæ­¤èŠ‚ç‚¹çš„è¿æ¥ return unlink(node(index));} é¦–å…ˆæ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œï¼Œç„¶åè°ƒç”¨å†…éƒ¨æ–¹æ³•node(index)è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ï¼Œæœ€åè°ƒç”¨å†…éƒ¨æ–¹æ³•unlink(node)å–æ¶ˆæ­¤èŠ‚ç‚¹çš„è¿æ¥ã€‚ å‰”é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°1234567891011121314151617181920212223public boolean remove(Object o) { if (o == null) { // æŒ‡å®šå…ƒç´ ä¸ºnullï¼šä»å¤´èŠ‚ç‚¹xå¼€å§‹è¿­ä»£ï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºxä¸ºnullï¼Œæ¯æ¬¡è¿­ä»£å°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹ã€‚ for (Node&lt;E&gt; x = first; x != null; x = x.next) { if (x.item == null) { // å¦‚æœæ‰¾åˆ°äº†nullå…ƒç´ ï¼Œåˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkå‰”é™¤xå…ƒç´ çš„è¿æ¥ã€‚ unlink(x); return true; } } } else { // æŒ‡å®šå…ƒç´ énull for (Node&lt;E&gt; x = first; x != null; x = x.next) { // è¿­ä»£çš„æ¡ä»¶åŒæŒ‡å®šå…ƒç´ ä¸ºnullçš„æƒ…å†µï¼Œä½¿ç”¨equalsæ¯”è¾ƒå½“å‰è¿­ä»£å…ƒç´ xä¸æŒ‡å®šå…ƒç´ æ˜¯å¦ç›¸ç­‰ã€‚ if (o.equals(x.item)) { unlink(x); return true; } } } // è¿­ä»£å®Œæˆéƒ½æœªè¿”å›ï¼Œåˆ™é›†åˆä¸­æ— è¯¥å…ƒç´ ï¼Œè¿”å›falseã€‚ return false;} è¿­ä»£é“¾è¡¨ï¼Œåˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸ºnullå’Œénullä¸¤ç§æƒ…å†µï¼Œä¸ºnullé‡‡ç”¨==è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œénullåˆ™é‡‡ç”¨equalsæ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚ä»é“¾è¡¨å¤´èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œä¸€æ—¦æ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ ï¼Œåˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlink(node)å–æ¶ˆè¯¥èŠ‚ç‚¹çš„è¿æ¥ï¼Œè¿”å›trueã€‚å¦‚æœè¿­ä»£å®Œæˆæ—¶éƒ½æœªæ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ ï¼Œåˆ™è¿”å›falseã€‚ è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ 123456789101112public E set(int index, E element) { // æ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œ checkElementIndex(index); // è·å–æŒ‡å®šç´¢å¼•ä½ç½®èŠ‚ç‚¹x Node&lt;E&gt; x = node(index); // å–å‡ºxçš„æ•°æ®åŸŸ E oldVal = x.item; // ç»™xçš„æ•°æ®åŸŸèµ‹å€¼ä¸ºæŒ‡å®šå…ƒç´  x.item = element; // è¿”å›xèŠ‚ç‚¹æ—§çš„æ•°æ®åŸŸ return oldVal;} é¦–å…ˆæ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œï¼Œç„¶åè°ƒç”¨å†…éƒ¨æ–¹æ³•node(index)è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹xï¼Œå–å‡ºèŠ‚ç‚¹xçš„æ•°æ®åŸŸï¼Œç„¶åä¸ºxçš„æ•°æ®åŸŸé‡æ–°èµ‹å€¼ä¸ºæŒ‡å®šå…ƒç´ ï¼Œæœ€åè¿”å›èŠ‚ç‚¹xæ—§çš„æ•°æ®åŸŸã€‚ è·å–é›†åˆä¸­å…ƒç´ ä¸ªæ•°123public int size() { return size;} ç›´æ¥è¿”å›sizeæˆå‘˜å˜é‡ã€‚ è½¬æ¢æˆObjectæ•°ç»„1234567891011public Object[] toArray() { // å®šä¹‰sizeé•¿åº¦çš„æ•°ç»„ Object[] result = new Object[size]; int i = 0; // ä»å¤´èŠ‚ç‚¹xå¼€å§‹è¿­ä»£ï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºx=nullï¼Œæ¯æ¬¡è¿­ä»£å®Œæˆå°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹ for (Node&lt;E&gt; x = first; x != null; x = x.next) // å¡«å……æ•°ç»„ result[i++] = x.item; // è¿”å›æ•°ç»„ return result;} é¦–å…ˆå®šä¹‰ä¸€ä¸ªsizeé•¿åº¦çš„Objectæ•°ç»„ï¼Œç„¶åä»é“¾è¡¨å¤´èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œæ¯æ¬¡è¿­ä»£å‘Objectæ•°ç»„ä¸­å¡«å……ä¸€ä¸ªå…ƒç´ ï¼Œè¿­ä»£å®Œæˆæ—¶æ•°ç»„ä¸­çš„å…ƒç´ å³ä¸ºé“¾è¡¨ä¸­çš„å…¨éƒ¨å…ƒç´ ï¼Œæœ€åè¿”å›æ•°ç»„ã€‚ è½¬æ¢æˆæŒ‡å®šç±»å‹æ•°ç»„1234567891011121314151617181920@SuppressWarnings(&quot;unchecked&quot;)public &lt;T&gt; T[] toArray(T[] a) { // æŒ‡å®šæ•°ç»„é•¿åº¦æ˜¯å¦å°äºé“¾è¡¨é•¿åº¦ if (a.length &lt; size) // å°äºï¼šé‡æ–°åˆ†é…ä¸€ä¸ªsizeé•¿åº¦æ•°ç»„ a = (T[])java.lang.reflect.Array.newInstance( a.getClass().getComponentType(), size); int i = 0; // è¿”å›æ•°ç»„å®¹å™¨ Object[] result = a; // è¿­ä»£é“¾è¡¨ï¼Œå¡«å……å…ƒç´ ã€‚ for (Node&lt;E&gt; x = first; x != null; x = x.next) result[i++] = x.item; // è¿­ä»£å®Œæˆï¼Œå¦‚æœæŒ‡å®šæ•°ç»„çš„é•¿åº¦å¤§äºé“¾è¡¨é•¿åº¦ï¼Œåˆ™å°†è¿”å›æ•°ç»„å®¹å™¨ä¸­sizeç´¢å¼•ä½ç½®çš„å…ƒç´ ç½®ä¸ºnull // nullå…ƒç´ ä¹‹å‰ä¸ºåŸé“¾è¡¨å…ƒç´ ï¼Œnullå…ƒç´ ä¹‹åä¸ºåŸæŒ‡å®šæ•°ç»„å…ƒç´ ã€‚ if (a.length &gt; size) a[size] = null; // æ•°ç»„è¿”å›ã€‚æ­¤æ—¶æ•°ç»„ä¸­å…ƒç´ ç±»å‹å·²ç”±Objectå¼ºè½¬æˆæ³›å‹T return a;} å…¥å‚ä¸ºæ³›å‹æ•°ç»„aï¼Œåˆ¤æ–­å…¥å‚æ•°ç»„é•¿åº¦æ˜¯å¦å°äºé“¾è¡¨é•¿åº¦ï¼Œå°äºåˆ™é‡æ–°åˆ†é…ä¸€ä¸ªé“¾è¡¨é•¿åº¦sizeå¤§å°çš„æ•°ç»„ç©ºé—´ã€‚è¿­ä»£é“¾è¡¨ï¼Œå°†å…ƒç´ å¡«å……è‡³æ•°ç»„ï¼Œè¿­ä»£å®Œæˆæ—¶ï¼Œå¦‚æœæ˜¯é‡æ–°åˆ†é…çš„æ•°ç»„ç©ºé—´ï¼Œåˆ™æ•°ç»„ä¸­çš„å…ƒç´ æ°å¥½å…¨éƒ¨ä¸ºé“¾è¡¨ä¸­çš„å…ƒç´ ï¼›å¦åˆ™æ•°ç»„ä¸­çš„å…ƒç´ å¤šäºé“¾è¡¨ä¸­çš„å…ƒç´ ï¼Œå°†sizeç´¢å¼•ä½ç½®çš„å…ƒç´ ç½®ä¸ºnullï¼Œæ­¤æ—¶ï¼Œnullå…ƒç´ ä¹‹å‰ä¸ºåŸé“¾è¡¨å…ƒç´ ï¼Œä¹‹åä¸ºåŸå…¥å‚æ•°ç»„å…ƒç´ ã€‚æœ€åè¿”å›å°†Objectæ•°ç»„å¼ºè½¬æˆæ³›å‹æ•°ç»„ã€‚ æ­¤æ–¹æ³•å¯ç”¨äºå°†é›†åˆä¸­çš„å…ƒç´ ç±»å‹è½¬æ¢ä¸ºæŒ‡å®šç±»å‹å¹¶è½¬æ¢æˆæ•°ç»„ã€‚ åŒç«¯é˜Ÿåˆ—æ–¹æ³•LinkedListå®ç°äº†DequeåŒç«¯é˜Ÿåˆ—æ¥å£ï¼Œæä¾›äº†åŒç«¯é˜Ÿåˆ—çš„åŸºæœ¬å®ç°ã€‚ å…¥é˜Ÿåˆ—å…¥é˜Ÿé¦–123public void addFirst(E e) { linkFirst(e);} ç›´æ¥è°ƒç”¨å†…éƒ¨æ–¹æ³•linkFirst(e)è¿æ¥æŒ‡å®šå…ƒç´ eä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚ 1234public boolean offerFirst(E e) { addFirst(e); return true;} åŒæ ·æ˜¯è°ƒç”¨äº†å†…éƒ¨æ–¹æ³•linkFirst(e)è¿æ¥æŒ‡å®šå…ƒç´ eä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚ç„¶åè¿”å›ç‰¹æ®Šå€¼trueã€‚ å…¥é˜Ÿå°¾123public void addLast(E e) { linkLast(e);} ç›´æ¥è°ƒç”¨å†…éƒ¨æ–¹æ³•linkLast(e)è¿æ¥æŒ‡å®šå…ƒç´ eä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ã€‚ 1234public boolean offerLast(E e) { addLast(e); return true;} åŒæ ·æ˜¯è°ƒç”¨äº†å†…éƒ¨æ–¹æ³•linkLast(e)è¿æ¥æŒ‡å®šå…ƒç´ eä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ã€‚ç„¶åè¿”å›ç‰¹æ®Šå€¼trueã€‚ å‡ºé˜Ÿåˆ—ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—123456public E removeFirst() { final Node&lt;E&gt; f = first; if (f == null) throw new NoSuchElementException(); return unlinkFirst(f);} é¦–å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼ŒæŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚ å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkFirst(e)å‰”é™¤å¤´èŠ‚ç‚¹çš„è¿æ¥ã€‚ 1234public E pollFirst() { final Node&lt;E&gt; f = first; return (f == null) ? null : unlinkFirst(f);} åŒæ ·æ˜¯å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›nullï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkFirst(e)å‰”é™¤å¤´èŠ‚ç‚¹çš„è¿æ¥ã€‚ æ­¤å®ç°ç¬¦åˆDequeæ¥å£ä¸­çš„å®šä¹‰ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶ï¼ŒremoveFirst()æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œè€ŒpollFirst()æ–¹æ³•è¿”å›ç‰¹æ®Šå€¼nullã€‚ ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—123456public E removeLast() { final Node&lt;E&gt; l = last; if (l == null) throw new NoSuchElementException(); return unlinkLast(l);} é¦–å…ˆè·å–é“¾è¡¨å°¾èŠ‚ç‚¹ï¼Œå¦‚æœå°¾èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼ŒæŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚ å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkLast(e)å‰”é™¤å°¾èŠ‚ç‚¹çš„è¿æ¥ã€‚ 1234public E pollLast() { final Node&lt;E&gt; l = last; return (l == null) ? null : unlinkLast(l);} åŒæ ·æ˜¯å…ˆè·å–é“¾è¡¨å°¾èŠ‚ç‚¹ï¼Œå¦‚æœå°¾èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›nullï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkLast(e)å‰”é™¤å°¾èŠ‚ç‚¹çš„è¿æ¥ã€‚ æ­¤å®ç°ä¹Ÿç¬¦åˆDequeæ¥å£ä¸­çš„å®šä¹‰ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶ï¼ŒremoveLast()æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œè€ŒpollLast()æ–¹æ³•è¿”å›ç‰¹æ®Šå€¼nullã€‚ æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ 123456public E getFirst() { final Node&lt;E&gt; f = first; if (f == null) throw new NoSuchElementException(); return f.item;} é¦–å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼ŒæŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚å¦åˆ™è¿”å›å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚ 1234public E peekFirst() { final Node&lt;E&gt; f = first; return (f == null) ? null : f.item; } åŒæ ·æ˜¯å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›nullï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›å¦åˆ™è¿”å›å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚ æ­¤å®ç°ä¹Ÿç¬¦åˆDequeæ¥å£ä¸­çš„å®šä¹‰ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶ï¼ŒgetFirst()æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œè€ŒpeekFirst()æ–¹æ³•è¿”å›ç‰¹æ®Šå€¼nullã€‚ æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ 123456public E getLast() { final Node&lt;E&gt; l = last; if (l == null) throw new NoSuchElementException(); return l.item;} é¦–å…ˆè·å–é“¾è¡¨å°¾èŠ‚ç‚¹ï¼Œå¦‚æœå°¾èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼ŒæŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚å¦åˆ™è¿”å›å°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚ 1234public E peekLast() { final Node&lt;E&gt; l = last; return (l == null) ? null : l.item;} åŒæ ·æ˜¯å…ˆè·å–é“¾è¡¨å°¾èŠ‚ç‚¹ï¼Œå¦‚æœå°¾èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›nullï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›å¦åˆ™è¿”å›å°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚ æ­¤å®ç°ä¹Ÿç¬¦åˆDequeæ¥å£ä¸­çš„å®šä¹‰ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶ï¼ŒgetLast()æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œè€ŒpeekLast()æ–¹æ³•è¿”å›ç‰¹æ®Šå€¼nullã€‚ åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ 123public boolean removeFirstOccurrence(Object o) { return remove(o);} ç›´æ¥è°ƒç”¨é›†åˆæ–¹æ³•remove(o)å‰”é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°ã€‚ åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ 1234567891011121314151617181920212223public boolean removeLastOccurrence(Object o) { if (o == null) { // æŒ‡å®šå…ƒç´ ä¸ºnull // ä»å°¾èŠ‚ç‚¹å¼€å§‹è¿­ä»£é“¾è¡¨ï¼Œä¸€æ—¦æ‰¾åˆ°æ•°æ®åŸŸä¸ºnullçš„èŠ‚ç‚¹ï¼Œåˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkå‰”é™¤è¯¥èŠ‚ç‚¹çš„è¿æ¥ã€‚ for (Node&lt;E&gt; x = last; x != null; x = x.prev) { if (x.item == null) { unlink(x); return true; } } } else { // æŒ‡å®šå…ƒç´ énullï¼Œä½¿ç”¨equalsæ¯”è¾ƒå…ƒç´ æ˜¯å¦ç›¸ç­‰ // è¿­ä»£çš„æ¡ä»¶åŒæŒ‡å®šå…ƒç´ ä¸ºnullçš„æƒ…å†µ for (Node&lt;E&gt; x = last; x != null; x = x.prev) { if (o.equals(x.item)) { unlink(x); return true; } } } // è¿­ä»£å®Œæˆä»æœªæ‰¾åˆ°ï¼Œè¿”å›falseã€‚ return false;} åˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸ºnullå’Œénullä¸¤ç§æƒ…å†µï¼Œä¸ºnullé‡‡ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒï¼Œénullé‡‡ç”¨equalsæ–¹æ³•æ¯”è¾ƒã€‚ä»å°¾èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œä¸€æ—¦æ‰¾åˆ°æ•°æ®åŸŸä¸æŒ‡å®šå…ƒç´ ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkå‰”é™¤è¯¥èŠ‚ç‚¹çš„è¿æ¥ã€‚ æ™®é€šé˜Ÿåˆ—æ–¹æ³•DequeåŒç«¯é˜Ÿåˆ—æ¥å£ä¸­åŒæ ·å£°æ˜äº†æ™®é€šé˜Ÿåˆ—Queueæ¥å£ä¸­å®šä¹‰çš„ä¸€ç³»åˆ—æ–¹æ³•ã€‚LinkedListç±»ä¹Ÿå¯¹å…¶è¿›è¡Œäº†å®ç°ã€‚ Queueæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•å¦‚ä¸‹ï¼š action throws exception returns special value insert add(e) offer(e) remove remove() poll() get head element() peek() å®ƒæœ‰ä¸‰ç»„å…±å…­ä¸ªæ–¹æ³•ï¼Œåœ¨Queueæ¥å£çš„å£°æ˜ä¸­çº¦å®šäº†æ¯ç»„æ–¹æ³•ä¸­æœ‰ä¸€ä¸ªæ˜¯å¤±è´¥æ—¶æŠ›å‡ºæŒ‡å®šå¼‚å¸¸ï¼Œå¦ä¸€ä¸ªæ˜¯è¿”å›ç‰¹æ®Šå€¼nullæˆ–falseã€‚ LinkedListç±»å´æ²¡æœ‰å®Œå…¨éµå®ˆQueueæ¥å£çš„çº¦å®šï¼Œæ‰€æœ‰æ–¹æ³•åœ¨æ‰§è¡Œå¤±è´¥æ—¶å‡æœªæŠ›å‡ºæŒ‡å®šå¼‚å¸¸ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ åœ¨æˆ‘çœ‹æ¥ï¼ŒLinkedListçš„å®ç°åˆè¡·æ˜¯ä½œä¸ºListé›†åˆä½¿ç”¨ï¼ˆè¿™ç‚¹å¯ä»ç±»åä½“ç°å‡ºæ¥ï¼Œå®ƒæ˜¯ä¸€ç§Listï¼‰ã€‚ç”±äºå…¶åº•å±‚æ•°æ®ç»“æ„æ˜¯åŒå‘é“¾è¡¨ï¼Œå®ƒå¯ä»¥ç”¨æ¥å®ç°é˜Ÿåˆ—ç­‰å…¶å®ƒæ•°æ®ç»“æ„ï¼Œæ‰€ä»¥è®¾è®¡è€…è®©LinkedListç±»å®ç°äº†é˜Ÿåˆ—æ¥å£ã€‚ æ˜¯å› ä¸ºåŒå‘é“¾è¡¨è¿™ç§æ•°æ®ç»“æ„å¯ä»¥ç”¨æ¥å®ç°é˜Ÿåˆ—ï¼Œæ‰€ä»¥æ‰å®ç°é˜Ÿåˆ—æ¥å£ã€‚è€Œä¸æ˜¯å› ä¸ºå®ç°äº†é˜Ÿåˆ—æ¥å£ï¼Œæ‰å†³å®šä½¿ç”¨åŒå‘é“¾è¡¨è¿™ç§æ•°æ®ç»“æ„ã€‚ ä»é˜Ÿå°¾å…¥é˜Ÿåˆ—ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯add(e)ï¼Œå®é™…ä¸Šè¿™ä¹Ÿæ˜¯åœ¨Listæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå®ƒçš„å®ç°æ—¢ç¬¦åˆåˆ—è¡¨çš„å®šä¹‰ï¼Œåˆç¬¦åˆé˜Ÿåˆ—çš„å®šä¹‰ã€‚ è¯¦æƒ…è§é›†åˆæ–¹æ³•ä¸­çš„add(e)ã€‚ ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯offer(e)ï¼š 123public boolean offer(E e) { return add(e);} ç›´æ¥è°ƒç”¨äº†add(e)æ–¹æ³•ã€‚ ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯remove()ï¼Œè¯¥æ–¹æ³•åŒæ ·ä¹Ÿå®šä¹‰åœ¨äº†Listæ¥å£ä¸­ï¼Œè¯¦æƒ…è§é›†åˆæ–¹æ³•ä¸­çš„removeã€‚ ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯poll()ï¼š 1234public E poll() { final Node&lt;E&gt; f = first; return (f == null) ? null : unlinkFirst(f);} é¦–å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›ç‰¹æ®Šå€¼nullï¼›å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkFirst(f)å‰”é™¤å¤´èŠ‚ç‚¹çš„è¿æ¥ã€‚è¿™ç¬¦åˆQueueæ¥å£ä¸­pollæ–¹æ³•çš„å®šä¹‰ã€‚ æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯element()ï¼š 123public E element() { return getFirst();} ç›´æ¥è°ƒç”¨åŒç«¯é˜Ÿåˆ—çš„getFirst()æ–¹æ³•æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ ã€‚ ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯peek()ï¼š 1234public E peek() { final Node&lt;E&gt; f = first; return (f == null) ? null : f.item;} é¦–å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸ºnullï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›ç‰¹æ®Šå€¼nullï¼›å¦åˆ™è¿”å›å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚è¿™ç¬¦åˆQueueæ¥å£ä¸­peekæ–¹æ³•çš„å®šä¹‰ã€‚ è¿­ä»£å™¨LinkedListç±»åªæä¾›äº†åˆ—è¡¨è¿­ä»£å™¨çš„å®ç°ï¼ŒåŸºç±»AbstractSequentialListç±»ä¸­æä¾›çš„æ™®é€šè¿­ä»£å™¨å®ç°ä¹Ÿæ˜¯åˆ—è¡¨è¿­ä»£å™¨ã€‚ 123456public ListIterator&lt;E&gt; listIterator(int index) { // æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ checkPositionIndex(index); // è¿”å›ä»indexä½ç½®å¼€å§‹çš„è¿­ä»£å™¨å¯¹è±¡ return new ListItr(index);} è¿­ä»£å™¨ListItrå®ç°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170private class ListItr implements ListIterator&lt;E&gt; { /** * æœ€åä¸€æ¬¡é€šè¿‡è¿­ä»£å™¨è¿”å›çš„èŠ‚ç‚¹å¯¹è±¡ */ private Node&lt;E&gt; lastReturned; /** * å½“å‰è¿­ä»£å™¨æ‰€æŒæœ‰çš„èŠ‚ç‚¹å¯¹è±¡ï¼Œå®ƒå°†ä½œä¸ºè¿­ä»£çš„ä¾æ®ï¼Œè°ƒç”¨previousæ–¹æ³•å°†è¿”å›å…¶å‰é©±èŠ‚ç‚¹ï¼›è°ƒç”¨nextæ–¹æ³•å°†è¿”å›å…¶åç»§èŠ‚ç‚¹ã€‚ */ private Node&lt;E&gt; next; /** * å½“å‰è¿­ä»£å™¨æ‰€æŒæœ‰çš„èŠ‚ç‚¹å¯¹è±¡çš„ç´¢å¼• */ private int nextIndex; /** * fail-fastæœºåˆ¶çš„æœŸæœ›ä¿®æ”¹æ¬¡æ•°ï¼Œåˆå§‹åŒ–ä¸ºAbstractList#modCount */ private int expectedModCount = modCount; /** * å¸¦å‚æ„é€ å™¨ï¼Œæ„é€ æŒ‡å®šç´¢å¼•ä½ç½®çš„åˆ—è¡¨è¿­ä»£å™¨ã€‚ç”±å¤–éƒ¨æ ¡éªŒç´¢å¼•åˆæ³•ã€‚ */ ListItr(int index) { // assert isPositionIndex(index); // index = size æ˜¯åˆæ³•çš„ï¼Œä¾¿äºä»åå‘å‰è¿­ä»£ã€‚æ­¤æ—¶nextä¸ºå°¾èŠ‚ç‚¹lastçš„åç»§èŠ‚ç‚¹nullï¼Œå¯ä»¥è°ƒç”¨previousæ–¹æ³•è¿­ä»£å°¾èŠ‚ç‚¹ã€‚ next = (index == size) ? null : node(index); nextIndex = index; } /** * åˆ¤æ–­æ˜¯å¦è¿­ä»£åˆ°äº†åˆ—è¡¨æœ«å°¾ */ public boolean hasNext() { return nextIndex &lt; size; } /** * è·å–å½“å‰nextIndexç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹å…ƒç´ ï¼Œä¸”ç´¢å¼•å³ç§»ä¸€ä½ã€‚ */ public E next() { // fail-fast checkForComodification(); if (!hasNext()) throw new NoSuchElementException(); // è®°å½•æœ€åä¸€æ¬¡é€šè¿‡è¿­ä»£å™¨è¿”å›çš„èŠ‚ç‚¹å¯¹è±¡ lastReturned = next; // å½“å‰è¿­ä»£å™¨æ‰€æŒæœ‰çš„èŠ‚ç‚¹å¯¹è±¡ èµ‹å€¼ ä¸ºå…¶åç»§èŠ‚ç‚¹ next = next.next; // ç´¢å¼•å³ç§» nextIndex++; // è¿”å›å…ƒç´ å€¼ return lastReturned.item; } /** * åˆ¤æ–­æ˜¯å¦è¿­ä»£åˆ°äº†åˆ—è¡¨å¼€å¤´ */ public boolean hasPrevious() { return nextIndex &gt; 0; } /** * è·å–å½“å‰nextIndexç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹å…ƒç´ ï¼Œä¸”ç´¢å¼•å·¦ç§»ä¸€ä½ã€‚ */ public E previous() { // fail-fastæœºåˆ¶ checkForComodification(); if (!hasPrevious()) throw new NoSuchElementException(); // å¦‚æœnextä¸ºnullï¼Œåˆ™åˆå§‹åŒ–è¯¥è¿­ä»£å™¨å¯¹è±¡æ—¶ï¼Œæ„é€ æ–¹æ³•ä¸­ä¼ å…¥çš„index=sizeã€‚ // è¡¨ç¤ºä»åˆ—è¡¨å°¾éƒ¨å¼€å§‹è¿­ä»£ï¼Œå°†nextèµ‹å€¼ä¸ºå°¾èŠ‚ç‚¹lastï¼›å¦åˆ™èµ‹å€¼ä¸ºå…¶å‰é©±èŠ‚ç‚¹ã€‚ lastReturned = next = (next == null) ? last : next.prev; nextIndex--; return lastReturned.item; } /** * è¿”å›å½“å‰è¿­ä»£ç´¢å¼•ï¼Œå…¶å€¼ç”±æ„é€ å™¨åˆå§‹åŒ–ã€‚ */ public int nextIndex() { return nextIndex; } /** * è¿”å›å½“å‰è¿­ä»£ç´¢å¼•å‰ä¸€ä½ */ public int previousIndex() { return nextIndex - 1; } /** * å®‰å…¨åœ°ä»åˆ—è¡¨ä¸­åˆ é™¤ä¸Šä¸€æ¬¡è¿­ä»£æ–¹æ³•ï¼ˆnext/previousï¼‰è¿”å›çš„èŠ‚ç‚¹ã€‚ * è¿­ä»£è¿‡ç¨‹ä¸­åªèƒ½è°ƒç”¨è¯¥æ–¹æ³•ä¿®æ”¹åˆ—è¡¨ï¼Œå¦åˆ™å°†å¼•å‘fail-fastæœºåˆ¶ã€‚ */ public void remove() { // fail-fastæœºåˆ¶ checkForComodification(); // è¿­ä»£çŠ¶æ€æ ¡éªŒï¼šè°ƒç”¨æ­¤removeæ–¹æ³•ä¹‹å‰å¿…é¡»å…ˆè°ƒç”¨è¿­ä»£æ–¹æ³•ã€‚ if (lastReturned == null) throw new IllegalStateException(); // è·å–ä¸Šæ¬¡è¿­ä»£è¿”å›èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ Node&lt;E&gt; lastNext = lastReturned.next; // å‰”é™¤lastReturnedèŠ‚ç‚¹çš„è¿æ¥ï¼ˆä¼šå¯¼è‡´AbstractList#modCountå¢åŠ ï¼‰ unlink(lastReturned); // ä»åå¾€å‰ï¼ˆpreviousï¼‰è¿­ä»£æ—¶ï¼Œnext = lastReturnedæˆç«‹ if (next == lastReturned) // å½“å‰è¿­ä»£å™¨æ‰€æŒæœ‰çš„èŠ‚ç‚¹å¯¹è±¡èµ‹å€¼ä¸ºä¸Šæ¬¡è¿­ä»£è¿”å›èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ next = lastNext; else // ä»å‰å¾€åï¼ˆnextï¼‰è¿­ä»£æ—¶ï¼Œè¿›å…¥elseåˆ†æ”¯ï¼Œè¿­ä»£ç´¢å¼•å‡ä¸€ã€‚ nextIndex--; // é‡ç½®è¿­ä»£å™¨è¿­ä»£çŠ¶æ€ï¼Œä¸‹æ¬¡è°ƒç”¨è¿­ä»£æ–¹æ³•ä¹‹å‰ä¸å¯å†è°ƒç”¨removeæ–¹æ³•ã€‚ lastReturned = null; // æœŸæœ›ä¿®æ”¹æ¬¡æ•°å¢åŠ  expectedModCount++; } /** * è¦†ç›–ä¸Šæ¬¡è¿­ä»£æ–¹æ³•è¿”å›çš„èŠ‚ç‚¹æ•°æ®åŸŸ */ public void set(E e) { // è¿­ä»£çŠ¶æ€æ ¡éªŒ if (lastReturned == null) throw new IllegalStateException(); // fail-fastæœºåˆ¶ checkForComodification(); // è¦†ç›– lastReturned.item = e; } /** * åœ¨ä¸‹æ¬¡è°ƒç”¨è¿­ä»£æ–¹æ³•å°†è¿”å›çš„èŠ‚ç‚¹ä¹‹å‰è¿æ¥æŒ‡å®šèŠ‚ç‚¹e */ public void add(E e) { checkForComodification(); lastReturned = null; if (next == null) linkLast(e); else linkBefore(e, next); nextIndex++; expectedModCount++; } /** * JDK8 æ–°å¢ */ public void forEachRemaining(Consumer&lt;? super E&gt; action) { Objects.requireNonNull(action); while (modCount == expectedModCount &amp;&amp; nextIndex &lt; size) { action.accept(next.item); lastReturned = next; next = next.next; nextIndex++; } checkForComodification(); } /** * fail-fastæœºåˆ¶ï¼šæ ¡éªŒå®é™…ä¿®æ”¹æ¬¡æ•°æ˜¯å¦ç­‰äºæœŸæœ›ä¿®æ”¹æ¬¡æ•°ã€‚ä¸ç­‰åˆ™ç«‹å³æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ã€‚ */ final void checkForComodification() { if (modCount != expectedModCount) throw new ConcurrentModificationException(); }} å…¶å®ƒæ–¹æ³•å…‹éš†è¯¥ç±»æä¾›äº†æ·±æ‹·è´æ–¹æ³•ï¼ˆä»LinkedListç»´åº¦æ¥è¯´å¯ä»¥ç§°ä¸ºæ·±æ‹·è´ï¼‰ã€‚ç”±äºå…¶å†…éƒ¨æŒæœ‰çš„æ˜¯å¯¹è±¡å¼•ç”¨ï¼Œåˆ—è¡¨ä¸­çš„å…ƒç´ å¹¶æ²¡æœ‰è¿›è¡Œâ€œæ·±æ‹·è´â€ã€‚ 1234567891011121314151617181920212223242526272829/** * å…‹éš†å®ç° */public Object clone() { // è·å–ä¸€ä¸ªæµ…æ‹·è´å¯¹è±¡ LinkedList&lt;E&gt; clone = superClone(); // åˆå§‹åŒ–çŠ¶æ€ // Put clone into &quot;virgin&quot; state clone.first = clone.last = null; clone.size = 0; clone.modCount = 0; // å€¼å¡«å…… // Initialize clone with our elements for (Node&lt;E&gt; x = first; x != null; x = x.next) clone.add(x.item); return clone;}/** * ç§æœ‰æ–¹æ³•ï¼šè°ƒç”¨Object#cloneæµ…æ‹·è´ */private LinkedList&lt;E&gt; superClone() { try { return (LinkedList&lt;E&gt;) super.clone(); } catch (CloneNotSupportedException e) { throw new InternalError(e); }}","link":"/2020/05/27/javase/base/linkedlist/"},{"title":"JDKæºç è§£æä¹‹Deque","text":"åŒç«¯é˜Ÿåˆ—ç®€è¿°åŒç«¯é˜Ÿåˆ—æ˜¯ä¸€ç§æ›´ç‰¹æ®Šçš„çº¿æ€§è¡¨ã€‚æ™®é€šé˜Ÿåˆ—Queueåªå…è®¸åœ¨é˜Ÿé¦–åˆ é™¤å…ƒç´ ï¼Œåœ¨é˜Ÿå°¾æ’å…¥å…ƒç´ ã€‚è€ŒåŒç«¯é˜Ÿåˆ—åŒæ—¶å…è®¸åœ¨é˜Ÿé¦–å’Œé˜Ÿå°¾æ’å…¥å’Œåˆ é™¤å…ƒç´ ã€‚ Dequeæ¥å£ç®€è¿°Dequeæ¥å£æ˜¯Javaä¸­çš„åŒç«¯é˜Ÿåˆ—å®šä¹‰ï¼Œç»§æ‰¿java.util.Queueæ¥å£ï¼Œå®ƒæä¾›äº†æ“ä½œé˜Ÿé¦–å’Œé˜Ÿå°¾çš„å…­ç»„æ–¹æ³•ï¼šæ’å…¥é˜Ÿé¦–/é˜Ÿå°¾å…ƒç´ ã€åˆ é™¤é˜Ÿé¦–/é˜Ÿå°¾å…ƒç´ ã€æå–é˜Ÿé¦–/é˜Ÿå°¾å…ƒç´ ã€‚åŒQueueæ¥å£ä¸€æ ·ï¼Œæ¯ç»„æ“ä½œéƒ½åŒ…å«ä¸¤ç§å½¢å¼ï¼šä¸€ç§åœ¨æ“ä½œå¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸ï¼›å¦ä¸€ç§è¿”å›ç‰¹æ®Šçš„å€¼ï¼ˆnullæˆ–falseï¼‰ã€‚ å½“æŠŠåŒç«¯é˜Ÿåˆ—å½“åšæ™®é€šé˜Ÿåˆ—ä½¿ç”¨æ—¶ï¼Œå°†å‡ºç°FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰è¡Œä¸ºã€‚ç»§æ‰¿è‡ªQueueæ¥å£çš„æ–¹æ³•ç­‰åŒäºDequeæ¥å£ä¸­çš„ç‰¹å®šæ–¹æ³•ã€‚ åŒç«¯é˜Ÿåˆ—ä¹Ÿå¯ç”¨åšLIFOï¼ˆåè¿›å…ˆå‡ºï¼‰å †æ ˆã€‚åº”è¯¥ä¼˜å…ˆé€‰ç”¨æ­¤æ¥å£ï¼Œå°½é‡ä¸è¦ä½¿ç”¨æ—§ç‰ˆjava.util.Stackç±»ï¼ˆç»§æ‰¿è‡ªåŒæ­¥é›†åˆVectorï¼‰ã€‚ æ¥å£è¯¦è§£åŒç«¯é˜Ÿåˆ—æ“ä½œæ¥å£ï¼š æ“ä½œä½ç½® é˜Ÿé¦–ï¼ˆHeadï¼‰ é˜Ÿå°¾ï¼ˆTailï¼‰ å“åº” throws exception special value throws exception special value insert addFirst(e) offerFirst(e) addLast(e) offerLast(e) remove removeFirst() pollFirst() removeLast() pollLast() get element getFirst() peekFirst() getLast() peekLast() å…¥é˜Ÿåˆ—å…¥é˜Ÿé¦–1void addFirst(E e); æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿé¦–ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›trueï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™æŠ›å‡ºIllegalStateExceptionå¼‚å¸¸ã€‚ 1boolean offerFirst(E e); åŒæ ·æ˜¯æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿé¦–ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›trueï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™è¿”å›falseã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ æ‰€ä»¥ï¼Œå½“ä½¿ç”¨å®¹é‡å—é™çš„é˜Ÿåˆ—æ—¶ï¼Œé€šå¸¸ä½¿ç”¨offerFirstæ–¹æ³•æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿé¦–ã€‚ å…¥é˜Ÿå°¾1void addLast(E e); æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›trueï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™æŠ›å‡ºIllegalStateExceptionå¼‚å¸¸ã€‚ 1boolean offerLast(E e); åŒæ ·æ˜¯æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›trueï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™è¿”å›falseã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ æ‰€ä»¥ï¼Œå½“ä½¿ç”¨å®¹é‡å—é™çš„é˜Ÿåˆ—æ—¶ï¼Œé€šå¸¸ä½¿ç”¨offerLastæ–¹æ³•æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ã€‚ å‡ºé˜Ÿåˆ—ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—1E removeFirst(); åˆ é™¤é˜Ÿé¦–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚ 1E pollFirst(); åŒæ ·æ˜¯åˆ é™¤é˜Ÿé¦–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›nullã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—1E removeLast(); åˆ é™¤é˜Ÿå°¾ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚ 1E pollLast(); åŒæ ·æ˜¯åˆ é™¤é˜Ÿå°¾ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›nullã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ æŸ¥è¯¢é˜Ÿåˆ—å…ƒç´ æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ 1E getFirst(); è·å–é˜Ÿé¦–å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚ 1E peekFirst(); åŒæ ·æ˜¯è·å–é˜Ÿé¦–å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›nullã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ 1E getLast(); è·å–é˜Ÿå°¾å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚ 1E peekLast(); åŒæ ·æ˜¯è·å–é˜Ÿå°¾å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›nullã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ åˆ é™¤æŒ‡å®šå…ƒç´ åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ 1boolean removeFirstOccurrence(Object o); ä»æ­¤åŒç«¯é˜Ÿåˆ—ä¸­åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ eã€‚å¦‚æœä»æœªå‡ºç°ï¼Œåˆ™é˜Ÿåˆ—ä¿æŒä¸å˜ã€‚åˆ¤æ–­é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸æŒ‡å®šå…ƒç´ ç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼šo == null ? e == null : o.equals(e)ã€‚ åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ 1boolean removeLastOccurrence(Object o); ä»æ­¤åŒç«¯é˜Ÿåˆ—ä¸­åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ eã€‚å¦‚æœä»æœªå‡ºç°ï¼Œåˆ™é˜Ÿåˆ—ä¿æŒä¸å˜ã€‚åˆ¤æ–­é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸æŒ‡å®šå…ƒç´ ç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼šo == null ? e == null : o.equals(e)ã€‚ ä½œä¸ºæ™®é€šé˜Ÿåˆ—è¯¥åŒç«¯é˜Ÿåˆ—Dequeæ¥å£åŒæ ·æä¾›äº†æ™®é€šé˜Ÿåˆ—Queueçš„å…­ä¸ªæ“ä½œæ–¹æ³•ã€‚ç”¨ä½œæ™®é€šé˜Ÿåˆ—æ—¶ï¼Œäº§ç”ŸFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰è¡Œä¸ºï¼Œå…¶æ–¹æ³•ç­‰åŒäºä¸Šè¿°åŒç«¯é˜Ÿåˆ—çš„ç‰¹å®šæ–¹æ³•ã€‚ä¸‹é¢æ˜¯å®ƒä»¬çš„å¯¹åº”å…³ç³»ï¼š Queue Method Equivalent Deque Method add(e) addLast(e) offer(e) offerLast(e) remove() removeFirst() poll() pollFirst() element() getFirst() peek() peekFirst() è™½ç„¶Dequeæ¥å£ä¹Ÿæä¾›äº†æ™®é€šé˜Ÿåˆ—çš„å…­ä¸ªæ“ä½œæ–¹æ³•ï¼Œä½†æˆ‘ä»¬å°½é‡ä¸è¦å»ä½¿ç”¨å®ƒä»¬ï¼Œè€Œæ˜¯ä½¿ç”¨å…¶å¯¹åº”çš„æ–¹æ³•ã€‚ ä¾‹å¦‚å…¥é˜Ÿåˆ—ï¼Œæœ€å¥½ä¸è¦è°ƒç”¨offer(e)ï¼Œè€Œæ˜¯è°ƒç”¨offerLast(e)ã€‚ å› ä¸ºå½“ä½¿ç”¨offer(e)æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ€è€ƒï¼Œoffer(e)å®é™…ä¸Šå°±æ˜¯offerLast(e)ï¼šä»é˜Ÿå°¾å…¥é˜Ÿåˆ—ã€‚å¦‚æœæˆ‘ä»¬ç›´æ¥è°ƒç”¨offerLast(e)ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºæ˜¯ä»é˜Ÿå°¾å…¥é˜Ÿåˆ—ã€‚ æ‰€ä»¥ï¼Œä½¿ç”¨Dequeæ¥å£æ—¶ï¼Œæ¨èæ˜ç¡®ä½¿ç”¨xxxLast/xxxFirstè¿™ç±»æ–¹æ³•ã€‚ ä½œä¸ºæ ˆåŒç«¯é˜Ÿåˆ—å¯ä»¥å½“åšæ ˆï¼ˆLIFOåè¿›å…ˆå‡ºï¼‰æ¥ä½¿ç”¨ã€‚å®ƒæä¾›äº†é—ç•™ç±»Stackä¸­å¯¹æ ˆçš„åŸºæœ¬æ“ä½œæ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ç­‰åŒäºä¸Šè¿°åŒç«¯é˜Ÿåˆ—çš„ç‰¹å®šæ–¹æ³•ã€‚ä¸‹é¢æ˜¯å®ƒä»¬çš„å¯¹åº”å…³ç³»ï¼š Stack Method Equivalent Deque Method push(e) addFirst(e) pop() removeFirst() peek() peekFirst() å½“åšæ ˆä½¿ç”¨æ—¶ï¼Œå°½é‡ä½¿ç”¨æ ˆçš„æ–¹æ³•ï¼špush(e)/pop/peekï¼Œä¸è¦è°ƒç”¨å…¶å¯¹åº”çš„æ–¹æ³•ã€‚ å› ä¸ºé—ç•™ç±»Stackå·²ç»å­˜åœ¨äº†ï¼Œè€ƒè™‘åˆ°ç±»åº“å…¼å®¹æ€§é—®é¢˜æ— æ³•å°†å…¶è¦†ç›–ï¼Œæ‰€ä»¥åœ¨Dequeæ¥å£ä¸­å®šä¹‰äº†æ ˆçš„æ–¹æ³•ï¼Œå½“æˆ‘ä»¬æŠŠDequeå½“åšæ ˆä½¿ç”¨æ—¶ï¼Œç›´æ¥è°ƒç”¨æ ˆçš„æ–¹æ³•ä¼šä½¿è¯­ä¹‰æ›´åŠ æ˜ç¡®ã€‚ ä½œä¸ºé›†åˆç”±äºDequeæ¥å£ç»§æ‰¿äº†Queueæ¥å£ï¼Œè€ŒQueueæ¥å£åˆç»§æ‰¿äº†Collectionæ¥å£ï¼Œæ‰€ä»¥Dequeä¹Ÿå¯ä½œä¸ºé›†åˆä½¿ç”¨ã€‚å®ƒä¹Ÿå®šä¹‰äº†ä¸€äº›é›†åˆçš„åŸºæœ¬æ“ä½œã€‚ åˆ¤æ–­æŒ‡å®šå…ƒç´ oä¸åŒç«¯é˜Ÿåˆ—ä¸­å…ƒç´ eç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼šo == null ? e == null : o.equals(e)ã€‚ åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ 1boolean remove(Object o); ä¸Collectionæ¥å£ä¸­å®šä¹‰çš„ç±»ä¼¼ï¼Œåˆ é™¤æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°ã€‚å®é™…ä¸Šï¼Œè¯¥æ–¹æ³•ç­‰åŒä¸removeFirstOccurrence(o)æ–¹æ³•ã€‚ åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ 1boolean contains(Object o); è¯¥åŒç«¯é˜Ÿåˆ—ä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å…ƒç´ oã€‚ æŸ¥è¯¢å…ƒç´ ä¸ªæ•°1public int size(); è¿”å›è¯¥åŒç«¯é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°ã€‚ è¿­ä»£å™¨æä¾›äº†ä¸¤ä¸ªä¸åŒå…ƒç´ é¡ºåºçš„è¿­ä»£å™¨ã€‚ ä»é˜Ÿé¦–åˆ°é˜Ÿå°¾çš„è¿­ä»£å™¨1Iterator&lt;E&gt; iterator(); è¿­ä»£å™¨ä¸­çš„å…ƒç´ é¡ºåºä¸ºåŒç«¯é˜Ÿåˆ—ä»é˜Ÿé¦–åˆ°é˜Ÿå°¾çš„å…ƒç´ é¡ºåºã€‚ ä»é˜Ÿå°¾åˆ°é˜Ÿé¦–çš„è¿­ä»£å™¨1Iterator&lt;E&gt; descendingIterator(); ä»¥ç›¸åçš„é¡ºåºè¿”å›è¿­ä»£å™¨ã€‚ æ€»ç»“Dequeæ¥å£å®šä¹‰äº†ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼ˆDouble Ended Queueï¼‰ï¼Œå®ƒå¯ä»¥ä»é˜Ÿé¦–æˆ–é˜Ÿå°¾æ“ä½œå…ƒç´ ï¼›ä¹Ÿå¯ä»¥å½“åšæ™®é€šé˜Ÿåˆ—Queueä½¿ç”¨ï¼›åŒæ—¶è¿˜å¯ä»¥å½“åšæ ˆStackæ¥ä½¿ç”¨ã€‚","link":"/2020/05/11/javase/base/deque/"},{"title":"JDKæºç è§£æä¹‹Queue","text":"é˜Ÿåˆ—ç®€è¿°é˜Ÿåˆ—æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§è¡¨ï¼Œå®ƒå…·æœ‰å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„ç‰¹ç‚¹ï¼Œåªå…è®¸åœ¨è¡¨çš„å‰ç«¯ï¼ˆfrontï¼‰è¿›è¡Œåˆ é™¤æ“ä½œï¼Œè€Œåœ¨è¡¨çš„åç«¯ï¼ˆrearï¼‰è¿›è¡Œæ’å…¥æ“ä½œã€‚è¿›è¡Œæ’å…¥æ“ä½œçš„ç«¯ç§°ä¸ºé˜Ÿå°¾ï¼Œè¿›è¡Œåˆ é™¤æ“ä½œçš„ç«¯ç§°ä¸ºé˜Ÿå¤´ã€‚é˜Ÿåˆ—ä¸­æ²¡æœ‰å…ƒç´ æ—¶ï¼Œç§°ä¸ºç©ºé˜Ÿåˆ—ã€‚ Queueæ¥å£ç®€è¿°Queueæ¥å£æ˜¯Javaä¸­çš„é˜Ÿåˆ—å®šä¹‰ï¼Œå®ƒä¹Ÿæ˜¯Javaå®¹å™¨ä¸­çš„ä¸€å‘˜ï¼Œç»§æ‰¿è‡ªjava.util.Collectionæ¥å£ã€‚Queueæ¥å£åœ¨Collectionæ¥å£çš„åŸºç¡€ä¸Šå®šä¹‰äº†ä¸‰ç»„æ“ä½œï¼šæ’å…¥ã€åˆ é™¤å’Œæå–ã€‚æ¯ç»„æ“ä½œéƒ½åŒ…å«ä¸¤ç§å½¢å¼ï¼šä¸€ç§åœ¨æ“ä½œå¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸ï¼›å¦ä¸€ç§è¿”å›ç‰¹æ®Šçš„å€¼ï¼ˆnullæˆ–falseï¼‰ã€‚ æ¥å£è¯¦è§£ action throws exception returns special value insert add(e) offer(e) remove remove() poll() get head element() peek() å…¥é˜Ÿåˆ—1boolean add(E e); æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›trueï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™æŠ›å‡ºIllegalStateExceptionå¼‚å¸¸ã€‚ 1boolean offer(E e); åŒæ ·æ˜¯æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›trueï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™è¿”å›falseã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ æ‰€ä»¥ï¼Œå½“ä½¿ç”¨å®¹é‡å—é™çš„é˜Ÿåˆ—æ—¶ï¼Œé€šå¸¸ä½¿ç”¨offeræ–¹æ³•æ’å…¥å…ƒç´ ã€‚ å‡ºé˜Ÿåˆ—1E remove(); åˆ é™¤é˜Ÿé¦–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚ 1E poll(); åŒæ ·æ˜¯åˆ é™¤é˜Ÿé¦–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›nullã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ 1E element(); è·å–é˜Ÿé¦–å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚ 1E peek(); åŒæ ·æ˜¯è·å–é˜Ÿé¦–å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›nullã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ æ€»ç»“Queueæ¥å£å®ç°é€šå¸¸ä¸å…è®¸æ’å…¥nullå…ƒç´ ï¼Œå°½ç®¡æŸäº›å®ç°ï¼ˆä¾‹å¦‚LinkedListï¼‰å¯ä»¥æ’å…¥nullå…ƒç´ ï¼Œä¹Ÿä¸åº”å°†nullæ’å…¥é˜Ÿåˆ—ä¸­ï¼Œå› ä¸ºpollå’Œpeekæ–¹æ³•ä¼šåœ¨é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶è¿”å›ç‰¹æ®Šå€¼nullï¼Œä¼šäº§ç”Ÿæ­§ä¹‰ã€‚","link":"/2020/05/11/javase/base/queue/"},{"title":"JDKæºç è§£æä¹‹AbstractList","text":"ç®€ä»‹AbstractListç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒç»§æ‰¿äº†AbstractCollectionæŠ½è±¡ç±»å¹¶å®ç°äº†Listæ¥å£ã€‚Listæ¥å£å®šä¹‰äº†ä¸€ç§æœ‰åºé›†åˆï¼Œå¯ä»¥ç²¾ç¡®æ§åˆ¶æ¯ä¸ªå…ƒç´ çš„æ’å…¥ä½ç½®ï¼›è€ŒAbstractCollectionæŠ½è±¡ç±»æä¾›äº†ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼ŒåŸºäºè¿™ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•æä¾›å‡ºäº†é›†åˆçš„æœ€åŸºæœ¬å®ç°ã€‚ æ‰€ä»¥ï¼ŒAbstractListæŠ½è±¡ç±»æä¾›çš„æ˜¯æœ‰åºé›†åˆçš„éª¨æ¶å®ç°ï¼Œç”¨ä»¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘æ”¯æŒéšæœºè®¿é—®æ•°æ®ï¼ˆä¾‹å¦‚æ•°ç»„ï¼‰çš„å®ç°ç±»æ‰€éœ€çš„å·¥ä½œã€‚è€Œå¯¹äºé¡ºåºè®¿é—®æ•°æ®ï¼ˆä¾‹å¦‚é“¾è¡¨ï¼‰ï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨AbstractSequentialListæŠ½è±¡ç±»ã€‚ ç‰¹æ€§è¯¥æŠ½è±¡ç±»æä¾›äº†æœ‰åºé›†åˆçš„éª¨æ¶å®ç°ã€‚è®©å®ç°ç±»æ”¯æŒéšæœºå¿«é€Ÿè®¿é—®ã€‚ å¦‚æœè¦å®ç°ä¸å¯ä¿®æ”¹çš„æœ‰åºé›†åˆï¼Œåªéœ€ç»§æ‰¿è¯¥ç±»å¹¶ä¸ºgetå’Œsizeæ–¹æ³•æä¾›å®ç°ï¼›å¦‚æœè¦å®ç°å¯ä¿®æ”¹çš„æœ‰åºé›†åˆï¼Œåœ¨å®ç°ä¸å¯ä¿®æ”¹çš„æœ‰åºé›†åˆåŸºç¡€ä¹‹ä¸Šï¼Œè¿˜è¦å¦å¤–é‡å†™æ­¤ç±»çš„ä¸¤ä¸ªé‡è½½çš„setæ–¹æ³•ï¼ˆå¦åˆ™å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ï¼‰ï¼Œå¦‚æœé›†åˆçš„å¤§å°æ˜¯å¯å˜çš„ï¼Œè¿˜è¦å†å¦å¤–é‡å†™ä¸¤ä¸ªé‡è½½çš„addæ–¹æ³•å’Œä¸€ä¸ªremoveæ–¹æ³•ã€‚ æ­¤å¤–ï¼Œå®ç°ç±»åŒæ ·åº”è¯¥éµå¾ªCollectionæ¥å£ä¸­æå‡ºçš„è§„èŒƒï¼šå¿…é¡»æä¾›ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼švoidæ— å‚æ„é€ å™¨å’Œå¸¦Collectionç±»å‹çš„å•ä¸ªå‚æ•°çš„æ„é€ å™¨ã€‚ ä¸å…¶å®ƒæŠ½è±¡é›†åˆå®ç°ä¸åŒï¼Œæ­¤ç±»çš„å®ç°ç±»ä¸æ˜¯å¿…é¡»è¦æä¾›è¿­ä»£å™¨å®ç°ï¼›æ­¤ç±»çš„è¿­ä»£å™¨å’Œåˆ—è¡¨è¿­ä»£å™¨æ˜¯åœ¨â€œéšæœºè®¿é—®â€æ–¹æ³•ä¹‹ä¸Šç”±æ­¤ç±»è‡ªèº«è¿›è¡Œå®ç°çš„ã€‚ â€œéšæœºè®¿é—®â€æ–¹æ³•ï¼ˆç´¢å¼•è®¿é—®ï¼‰æœ‰ï¼š get(int) set(int, Object) set(int, E) add(int Object) add(int, E) remove(int) æºç è¯¦è§£æ„é€ å™¨åªæœ‰ä¸€ä¸ªä½¿ç”¨protectedä¿®é¥°ç¬¦ä¿®é¥°çš„æ— å‚æ„é€ å™¨ã€‚è¯´æ˜è¯¥æŠ½è±¡ç±»ä¸å…è®¸å¤–éƒ¨ç›´æ¥å®ä¾‹åŒ–ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªéª¨æ¶å®ç°ï¼Œå¹¶ä¸æä¾›æœ‰åºé›†åˆçš„å®Œæ•´åŠŸèƒ½ã€‚ 12protected AbstractList() {} æˆå‘˜å˜é‡1protected transient int modCount = 0; åªæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œè¡¨ç¤ºè¯¥åˆ—è¡¨è¢«ç»“æ„ä¿®æ”¹çš„æ¬¡æ•°ã€‚ ç»“æ„ä¿®æ”¹æ˜¯æŒ‡ï¼šæ›´æ”¹åˆ—è¡¨å¤§å°æˆ–ä»¥å…¶å®ƒæ–¹å¼å¹²æ‰°åˆ—è¡¨ã€‚ æ­¤å­—æ®µç”±iteratorå’ŒlistIteratoræ–¹æ³•è¿”å›çš„è¿­ä»£å™¨ä½¿ç”¨ã€‚å¦‚æœåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä¿®æ”¹äº†è¯¥å­—æ®µçš„å€¼ï¼Œåˆ™è¿­ä»£å™¨å°†åœ¨nextã€removeå’Œpreviousæ–¹æ³•ä¸­æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ã€‚è¿™é‡Œå°±æ˜¯Javaæ™®é€šé›†åˆçš„fail-fastæœºåˆ¶ã€‚å¦åˆ™å°†å‡ºç°ä¸ç¡®å®šçš„è¡Œä¸ºã€‚ å­ç±»å¯¹è¯¥å­—æ®µçš„ä½¿ç”¨æ˜¯å¯é€‰çš„ï¼Œå½“å­ç±»éœ€è¦æä¾›å…·æœ‰fail-fastæœºåˆ¶çš„è¿­ä»£å™¨ï¼ˆæˆ–åˆ—è¡¨è¿­ä»£å™¨ï¼‰æ—¶ï¼Œåªéœ€åœ¨å…¶addå’Œremoveæ–¹æ³•ä¸­ä¿®æ”¹è¯¥å­—æ®µçš„å€¼ï¼Œä¸€æ¬¡è°ƒç”¨addæˆ–removeæ–¹æ³•å¿…é¡»ä¿®æ”¹è¯¥å€¼ä¸”ä¸è¶…è¿‡1ã€‚å¦åˆ™è¿­ä»£å™¨å°†æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼›å½“å­ç±»ä¸éœ€è¦æä¾›å…·æœ‰fail-fastæœºåˆ¶çš„è¿­ä»£å™¨æ—¶ï¼Œå¯ç›´æ¥å¿½ç•¥è¯¥å­—æ®µã€‚ æŠ½è±¡æ–¹æ³•è¯¥ç±»ä¸­åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç”¨äºæ”¯æŒéšæœºå¿«é€Ÿè®¿é—®ï¼ˆæ ¹æ®ç´¢å¼•å–å€¼ï¼‰ã€‚ 1abstract public E get(int index); å·²å®ç°æ–¹æ³•æ‰€æœ‰çš„å®ç°æ–¹æ³•éƒ½æ˜¯åŸºäºè¯¥ç±»çš„æŠ½è±¡æ–¹æ³•æˆ–å…¶å®ƒå·²å®ç°æ–¹æ³•ï¼Œå¤§éƒ¨åˆ†å®ç°æ˜¯åŸºäºè¿­ä»£å™¨çš„ã€‚éƒ¨åˆ†æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ï¼Œè¿™æ ·çš„å®ç°è¡¨ç¤ºè¯¥æ–¹æ³•éœ€è¦å­ç±»è¿›è¡Œé‡å†™å®ç°ã€‚æ€»çš„æ¥çœ‹ï¼Œè¯¥ç±»æä¾›äº†æœ‰åºé›†åˆçš„æ¨¡æ¿å®ç°ã€‚ä¸‹é¢æˆ‘ä»¬æ¥å…·ä½“çš„åˆ†ææ¯ä¸ªæ–¹æ³•ã€‚ å¿«é€Ÿè®¿é—®æ·»åŠ æŒ‡å®šå…ƒç´ è‡³åˆ—è¡¨æœ«å°¾1234public boolean add(E e) { add(size(), e); return true;} è°ƒç”¨äº†é‡è½½çš„addæ–¹æ³•ï¼Œä¼ å…¥size()æ–¹æ³•çš„è¿”å›å€¼å’ŒæŒ‡å®šå…ƒç´ ï¼Œç„¶åè¿”å›trueã€‚ åªè¦é‡è½½çš„addæ–¹æ³•ä¸­ä¸å‡ºç°å¼‚å¸¸ï¼Œåˆ™è¯¥addæ–¹æ³•å§‹ç»ˆè¿”å›trueã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ”¯æŒæ­¤æ“ä½œçš„åˆ—è¡¨å¯èƒ½ä¼šå¯¹å¯ä»¥æ·»åŠ è‡³åˆ—è¡¨çš„å…ƒç´ è¿›è¡Œé™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒæŸäº›åˆ—è¡¨æ‹’ç»æ·»åŠ nullå…ƒç´ ï¼Œè€Œå¦ä¸€äº›å¯¹å¯èƒ½æ·»åŠ çš„å…ƒç´ è¿›è¡Œç±»å‹é™åˆ¶ã€‚æ‰€ä»¥å®ç°ç±»åº”åœ¨å…¶æ–‡æ¡£ä¸­æ˜ç¡®æŒ‡å‡ºå¯¹å¯ä»¥æ·»åŠ çš„å…ƒç´ æœ‰å“ªäº›é™åˆ¶ã€‚ åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ 123public void add(int index, E element) { throw new UnsupportedOperationException();} è¯¥æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ï¼Œæ˜¯å¿…é¡»è¦å­ç±»é‡å†™è¿›è¡Œå…·ä½“å®ç°çš„ã€‚ ç”¨æŒ‡å®šå…ƒç´ æ¥è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å€¼123public E set(int index, E element) { throw new UnsupportedOperationException();} è¯¥æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ï¼Œæ˜¯å¿…é¡»è¦å­ç±»é‡å†™è¿›è¡Œå…·ä½“å®ç°çš„ã€‚ æ·»åŠ æŒ‡å®šå…ƒç´ è‡³æŒ‡å®šç´¢å¼•ä½ç½®123public void add(int index, E element) { throw new UnsupportedOperationException();} è¯¥æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ï¼Œæ˜¯å¿…é¡»è¦å­ç±»é‡å†™è¿›è¡Œå…·ä½“å®ç°çš„ã€‚ åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ 123public E remove(int index) { throw new UnsupportedOperationException();} è¯¥æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ï¼Œæ˜¯å¿…é¡»è¦å­ç±»é‡å†™è¿›è¡Œå…·ä½“å®ç°çš„ã€‚ æŸ¥è¯¢æ“ä½œæŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®12345678910111213public int indexOf(Object o) { ListIterator&lt;E&gt; it = listIterator(); if (o==null) { while (it.hasNext()) if (it.next()==null) return it.previousIndex(); } else { while (it.hasNext()) if (o.equals(it.next())) return it.previousIndex(); } return -1;} è¯¥æ–¹æ³•çš„å®ç°ä¸ºï¼šé¦–å…ˆè°ƒç”¨è¯¥ç±»çš„listIterator()æ–¹æ³•è·å–ä¸€ä¸ªæŒ‡å‘åˆ—è¡¨å¼€å¤´çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åï¼Œä»å‰å¾€åéå†åˆ—è¡¨ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡æ‰¾åˆ°æŒ‡å®šçš„å…ƒç´ æˆ–åˆ°è¾¾åˆ—è¡¨çš„æœ«å°¾ï¼ˆè¿”å›-1ï¼‰ã€‚ æŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®12345678910111213public int lastIndexOf(Object o) { ListIterator&lt;E&gt; it = listIterator(size()); if (o==null) { while (it.hasPrevious()) if (it.previous()==null) return it.nextIndex(); } else { while (it.hasPrevious()) if (o.equals(it.previous())) return it.nextIndex(); } return -1;} è¯¥æ–¹æ³•çš„å®ç°ä¸ºï¼šé¦–å…ˆè°ƒç”¨è¯¥ç±»çš„listIterator()æ–¹æ³•ä¼ å…¥size()æ–¹æ³•çš„è¿”å›å€¼ï¼ˆè¯¥åˆ—è¡¨çš„å¤§å°ï¼‰è·å–ä¸€ä¸ªæŒ‡å‘åˆ—è¡¨æœ«å°¾çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åï¼Œä»åå¾€å‰éå†åˆ—è¡¨ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡æ‰¾åˆ°æŒ‡å®šçš„å…ƒç´ æˆ–åˆ°è¾¾åˆ—è¡¨çš„å¼€å¤´ï¼ˆè¿”å›-1ï¼‰ã€‚ æ‰¹é‡æ“ä½œæ¸…ç©ºåˆ—è¡¨123public void clear() { removeRange(0, size());} åˆ é™¤æ­¤åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå†…éƒ¨è°ƒç”¨çš„æ˜¯removeRangeæ–¹æ³•ã€‚å­ç±»å¿…é¡»é‡å†™æœ¬ç±»çš„removeæˆ–removeRangeæ–¹æ³•ï¼Œå¦åˆ™å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹removeRangeæ–¹æ³•çš„å®ç°ï¼š 1234567protected void removeRange(int fromIndex, int toIndex) { ListIterator&lt;E&gt; it = listIterator(fromIndex); for (int i=0, n=toIndex-fromIndex; i&lt;n; i++) { it.next(); it.remove(); }} ä»è¯¥åˆ—è¡¨ä¸­åˆ é™¤ç´¢å¼•ä»‹äºfromIndexå’ŒtoIndexä¹‹é—´çš„å…ƒç´ ï¼Œå°†toIndexç´¢å¼•åçš„æ‰€æœ‰å…ƒç´ å·¦ç§»ã€‚å½“fromIndexç­‰äºtoIndexæ—¶ï¼Œæ­¤æ–¹æ³•ä¸ä¼šåšä»»ä½•æ“ä½œã€‚ å…¥å‚æœ‰ä¸¤ä¸ªï¼š fromIndexï¼šè¦åˆ é™¤çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ï¼› toIndexï¼šè¦åˆ é™¤çš„æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„ç´¢å¼•ã€‚ é¦–å…ˆè°ƒç”¨listIterator(fromIndex)æ–¹æ³•è·å–ä½äºfromIndexä¹‹å‰çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åè¿­ä»£ç´¢å¼•åŒºé—´ä¸º[0,toIndex-fromIndex)çš„å…ƒç´ ï¼Œåœ¨æ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨ListIterator.nextæ–¹æ³•è·å–ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åè°ƒç”¨ListIterator.removeæ–¹æ³•åˆ é™¤å½“å‰è¿­ä»£ç´¢å¼•å…ƒç´ ï¼Œç›´åˆ°åˆ é™¤äº†æ•´ä¸ªèŒƒå›´å†…çš„å…ƒç´ ä¸ºæ­¢ã€‚ å¦‚æœListIterator.removeæ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2)ã€‚ å°†æŒ‡å®šé›†åˆä»æŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹æ’å…¥123456789public boolean addAll(int index, Collection&lt;? extends E&gt; c) { rangeCheckForAdd(index); boolean modified = false; for (E e : c) { add(index++, e); modified = true; } return modified;} å°†æŒ‡å®šé›†åˆcä»ç´¢å¼•ä¸ºindexçš„ä½ç½®å¼€å§‹æ’å…¥ï¼Œéœ€è¦å­ç±»å®ç°add(int,E)æ–¹æ³•ï¼Œå¦åˆ™å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ é¦–å…ˆè°ƒç”¨rangeCheckForAdd(index)æ–¹æ³•æ ¡éªŒç´¢å¼•èŒƒå›´ï¼ˆåŒºé—´ä¸º[0,size())ï¼‰ï¼Œç„¶åè¿­ä»£æŒ‡å®šé›†åˆcï¼Œä½¿ç”¨add(int,E)æ–¹æ³•è¿›è¡Œæ’å…¥ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå­ç±»ä¼šé€‰æ‹©é‡å†™è¯¥æ–¹æ³•æ¥æé«˜æ‰¹é‡æ’å…¥æ•ˆç‡ã€‚ è¿­ä»£å™¨æ™®é€šè¿­ä»£å™¨123public Iterator&lt;E&gt; iterator() { return new Itr();} ç›´æ¥åˆ›å»ºå†…éƒ¨ç±»Itrçš„å®ä¾‹å¯¹è±¡è¿”å›ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸ªå†…éƒ¨ç±»Itrï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859private class Itr implements Iterator&lt;E&gt; { /** * Index of element to be returned by subsequent call to next. */ int cursor = 0; /** * Index of element returned by most recent call to next or * previous. Reset to -1 if this element is deleted by a call * to remove. */ int lastRet = -1; /** * The modCount value that the iterator believes that the backing * List should have. If this expectation is violated, the iterator * has detected concurrent modification. */ int expectedModCount = modCount; public boolean hasNext() { return cursor != size(); } public E next() { checkForComodification(); try { int i = cursor; E next = get(i); lastRet = i; cursor = i + 1; return next; } catch (IndexOutOfBoundsException e) { checkForComodification(); throw new NoSuchElementException(); } } public void remove() { if (lastRet &lt; 0) throw new IllegalStateException(); checkForComodification(); try { AbstractList.this.remove(lastRet); if (lastRet &lt; cursor) cursor--; lastRet = -1; expectedModCount = modCount; } catch (IndexOutOfBoundsException e) { throw new ConcurrentModificationException(); } } final void checkForComodification() { if (modCount != expectedModCount) throw new ConcurrentModificationException(); } } æœ‰ä¸‰ä¸ªæˆå‘˜å˜é‡ï¼š cursorï¼šæ¸¸æ ‡ï¼Œåˆå§‹åŒ–ä¸º0ï¼Œåç»­è°ƒç”¨è¯¥å†…éƒ¨ç±»çš„nextæ–¹æ³•è¿”å›çš„å…ƒç´ ç´¢å¼•ã€‚ lastRetï¼šåˆå§‹åŒ–ä¸º-1ï¼Œæœ€è¿‘ä¸€æ¬¡è°ƒç”¨nextæˆ–previousæ–¹æ³•è¿”å›çš„å…ƒç´ ç´¢å¼•ã€‚å¦‚æœä¸€æ¬¡è°ƒç”¨ä¸­åˆ é™¤äº†å½“å‰æŒ‡å‘çš„å…ƒç´ ï¼Œåˆ™å°†å…¶é‡ç½®ä¸º-1ã€‚ expectedModCountï¼šæœŸæœ›ä¿®æ”¹æ¬¡æ•°ï¼Œåˆå§‹åŒ–ä¸ºå¤–éƒ¨ç±»AbstractListçš„æˆå‘˜å˜é‡modCountï¼Œè¿­ä»£å™¨è®¤ä¸ºåç»­è¿­ä»£è¿‡ç¨‹ä¸­åˆ—è¡¨åº”è¯¥å…·æœ‰çš„modCountå€¼ï¼Œå¦‚æœæœŸæœ›å€¼ä¸å®é™…modCountå€¼ä¸ç›¸ç­‰ï¼Œåˆ™å‡ºç°äº†å¹¶å‘ä¿®æ”¹çš„æƒ…å†µã€‚ æœ‰ä¸‰ä¸ªå…¬å…±æ–¹æ³•ï¼š 1ã€åˆ¤æ–­æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼š 123public boolean hasNext() { return cursor != size();} åˆ¤æ–­å½“å‰æ¸¸æ ‡æ˜¯å¦ç­‰äºåˆ—è¡¨å¤§å°ã€‚size()æ–¹æ³•ä¸ºçˆ¶ç±»AbstractCollectionä¸­çš„æŠ½è±¡size()æ–¹æ³•ã€‚ 2ã€è·å–å½“å‰æ¸¸æ ‡ç´¢å¼•æŒ‡å‘çš„å…ƒç´ ï¼š 12345678910111213public E next() { checkForComodification(); try { int i = cursor; E next = get(i); lastRet = i; cursor = i + 1; return next; } catch (IndexOutOfBoundsException e) { checkForComodification(); throw new NoSuchElementException(); }} é¦–å…ˆè°ƒç”¨å½“å‰å†…éƒ¨ç±»çš„checkForComodification()æ–¹æ³•æ ¡éªŒæœŸæœ›ä¿®æ”¹æ¬¡æ•°expectedModCountæ˜¯å¦ç­‰äºå®é™…ä¿®æ”¹æ¬¡æ•°modCountã€‚å¦‚æœä¸ç›¸ç­‰ï¼Œåˆ™å·²å‡ºç°å¹¶å‘ä¿®æ”¹ï¼ŒæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ã€‚ ç„¶åè°ƒç”¨å¤–éƒ¨ç±»AbstractListçš„æŠ½è±¡æ–¹æ³•get(int)æ ¹æ®å½“å‰æ¸¸æ ‡ç´¢å¼•å–å€¼ï¼Œå°†å½“å‰æ¸¸æ ‡å€¼èµ‹ç»™æˆå‘˜å˜é‡lastRetï¼Œå½“å‰æ¸¸æ ‡å³ç§»ä¸€ä½ï¼Œæœ€åè¿”å›å–åˆ°çš„å…ƒç´ ã€‚ å…ˆæ ¡éªŒmodCountçš„å€¼ï¼Œå¦‚æœåœ¨æ ¡éªŒé€šè¿‡ä¸”ä»£ç æ‰§è¡Œåˆ°get(i)ä¹‹å‰æ—¶æœ‰å…¶å®ƒçº¿ç¨‹ä¿®æ”¹äº†å½“å‰åˆ—è¡¨çš„å¤§å°ï¼Œåˆ™å¯èƒ½ä¼šå‡ºç°ç´¢å¼•è¶Šç•ŒIndexOutOfBoundsExceptionçš„å¼‚å¸¸ï¼Œæ­¤æ—¶å°†å…¶æ•è·ï¼Œåœ¨catchå—ä¸­å†æ¬¡è¿›è¡ŒmodCountæ ¡éªŒï¼Œå¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œåˆ™ä¼šç›´æ¥æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼›ä½†å¯èƒ½åœ¨è¿™æ¬¡æ ¡éªŒä¹‹å‰åˆæœ‰å…¶å®ƒçº¿ç¨‹å°†å½“å‰åˆ—è¡¨è¿˜åŸäº†ï¼Œæ­¤æ—¶æ ¡éªŒåˆä¼šé€šè¿‡ï¼Œæ‰€ä»¥åœ¨æ ¡éªŒä¹‹åä¸»åŠ¨æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚ 3ã€åˆ é™¤æœ€è¿‘ä¸€æ¬¡é€šè¿‡nextæ–¹æ³•è·å–åˆ°çš„å…ƒç´ ï¼š 123456789101112131415public void remove() { if (lastRet &lt; 0) throw new IllegalStateException(); checkForComodification(); try { AbstractList.this.remove(lastRet); if (lastRet &lt; cursor) cursor--; lastRet = -1; expectedModCount = modCount; } catch (IndexOutOfBoundsException e) { throw new ConcurrentModificationException(); }} é¦–å…ˆå¦‚æœlastRetå°äº0ï¼Œåˆ™è¯¥è¿­ä»£å™¨çš„nextæ–¹æ³•æœªå…ˆè°ƒç”¨ï¼ŒæŠ›å‡ºIllegalStateExceptionå¼‚å¸¸ã€‚ ç„¶åæ£€æŸ¥expectedModCountä¸modCountæ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰åˆ™å‡ºç°å¹¶å‘ä¿®æ”¹ï¼ŒæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ã€‚ æ¥ä¸‹æ¥è°ƒç”¨å¤–éƒ¨ç±»AbstractListçš„removeæ–¹æ³•ï¼Œåˆ é™¤ä¸Šæ¬¡é€šè¿‡nextæ–¹æ³•è·å–åˆ°çš„å…ƒç´ ã€‚æ‰€ä»¥AbstractListçš„å­ç±»å¿…é¡»é‡å†™AbstractListç±»çš„removeæ–¹æ³•ã€‚ åˆ é™¤å…ƒç´ ä¹‹åï¼Œå°†æ¸¸æ ‡å·¦ç§»ä¸€ä½ï¼Œæ­¤æ—¶æŒ‡å‘çš„æ˜¯åˆ é™¤çš„å…ƒç´ ä¹‹åçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ç„¶åé‡ç½®lastRet=-1ï¼Œé‡æ–°å°†ä¿®æ”¹è¿‡åçš„modCountèµ‹ç»™expectedModCountã€‚ è§£é‡Šï¼š ä¾‹å¦‚åˆ—è¡¨A,B,Cã€‚ åˆå§‹çŠ¶æ€ï¼šåˆå§‹æ¸¸æ ‡cursorä¸º0æŒ‡å‘å…ƒç´ Aï¼ŒlastRet=-1ï¼› ç¬¬ä¸€æ¬¡è°ƒç”¨nextæ–¹æ³•ï¼šæ¸¸æ ‡cursorå³ç§»ä¸€ä½ä¸º1æŒ‡å‘å…ƒç´ Bï¼ŒlastRet=0ï¼› æ­¤æ—¶è°ƒç”¨AbstractListçš„removeæ–¹æ³•ï¼šåˆ é™¤ç´¢å¼•ä¸ºlastRet=0çš„å…ƒç´ Aï¼ŒlastRet=0 &lt; cursor=1ï¼Œæ¸¸æ ‡å·¦ç§»ä¸€ä½ä¸º0æŒ‡å‘å…ƒç´ Bï¼Œé‡ç½®lastRet=-1å¹¶å°†modCounté‡æ–°èµ‹å€¼ç»™expectedModCountã€‚ ç”±äºè°ƒç”¨è¿‡å¤–éƒ¨ç±»AbstractListçš„removeæ–¹æ³•ï¼Œæ­¤æ—¶çš„modCountå€¼å·²ç»ä¿®æ”¹ã€‚ åˆ—è¡¨è¿­ä»£å™¨123public ListIterator&lt;E&gt; listIterator() { return listIterator(0);} ç›´æ¥è°ƒç”¨listIterator(0)æ–¹æ³•è¿”å›ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹è¯¥æ–¹æ³•ï¼š 12345public ListIterator&lt;E&gt; listIterator(final int index) { rangeCheckForAdd(index); return new ListItr(index);} é¦–å…ˆæ ¡éªŒä¼ å…¥ç´¢å¼•indexèŒƒå›´ï¼Œç„¶åç›´æ¥ä¸€ä¸ªè¿”å›ListItrçš„å®ä¾‹å¯¹è±¡ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹ListItrçš„å®ç°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657private class ListItr extends Itr implements ListIterator&lt;E&gt; { ListItr(int index) { cursor = index; } public boolean hasPrevious() { return cursor != 0; } public E previous() { checkForComodification(); try { int i = cursor - 1; E previous = get(i); lastRet = cursor = i; return previous; } catch (IndexOutOfBoundsException e) { checkForComodification(); throw new NoSuchElementException(); } } public int nextIndex() { return cursor; } public int previousIndex() { return cursor-1; } public void set(E e) { if (lastRet &lt; 0) throw new IllegalStateException(); checkForComodification(); try { AbstractList.this.set(lastRet, e); expectedModCount = modCount; } catch (IndexOutOfBoundsException ex) { throw new ConcurrentModificationException(); } } public void add(E e) { checkForComodification(); try { int i = cursor; AbstractList.this.add(i, e); lastRet = -1; cursor = i + 1; expectedModCount = modCount; } catch (IndexOutOfBoundsException ex) { throw new ConcurrentModificationException(); } } } è¯¥ç±»ç»§æ‰¿äº†å†…éƒ¨ç±»Itrå¹¶å®ç°äº†ListIteratoræ¥å£ã€‚ ç»§æ‰¿å¾—åˆ°äº†Itrç±»çš„ä¸‰ä¸ªå±æ€§ï¼šcursorã€lastRetå’ŒexpectedModCountã€‚ åªæœ‰ä¸€ä¸ªå¸¦å‚æ„é€ å™¨ï¼š 123ListItr(int index) { cursor = index;} è®©æ¸¸æ ‡æŒ‡å‘ä¼ å…¥çš„ç´¢å¼•indexã€‚ é‡å†™äº†ListIteratoræ¥å£çš„å…­ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬æ¥ä¾æ¬¡çœ‹ä¸‹å®ç°ï¼š 1ã€åˆ¤æ–­æ˜¯å¦æœ‰å‰ä¸€ä¸ªå…ƒç´  123public boolean hasPrevious() { return cursor != 0;} ç›´æ¥åˆ¤æ–­å½“å‰æ¸¸æ ‡cursoræ˜¯å¦æŒ‡å‘0ï¼Œä¸º0è¡¨ç¤ºæŒ‡å‘åˆ—è¡¨å¼€å§‹ä½ç½®ï¼Œæ— å‰ä¸€ä¸ªå…ƒç´ ã€‚ 2ã€è·å–å‰ä¸€ä¸ªå…ƒç´  123456789101112public E previous() { checkForComodification(); try { int i = cursor - 1; E previous = get(i); lastRet = cursor = i; return previous; } catch (IndexOutOfBoundsException e) { checkForComodification(); throw new NoSuchElementException(); }} è·å–å½“å‰æ¸¸æ ‡æŒ‡å‘ç´¢å¼•çš„å‰ä¸€ä½iï¼Œè·å–å…¶å…ƒç´ å€¼previousï¼Œå°†ç´¢å¼•ièµ‹å€¼ç»™æ¸¸æ ‡cursorå’Œæœ€åè¿”å›å…ƒç´ ç´¢å¼•lastRetï¼Œæœ€åè¿”å›å…ƒç´ previousã€‚æ ¡éªŒé€»è¾‘åŒItrè¿­ä»£å™¨çš„nextæ–¹æ³•ã€‚ 3ã€è·å–ä¸‹ä¸€ä¸ªå³å°†è¿­ä»£å…ƒç´ ç´¢å¼• 123public int nextIndex() { return cursor;} ç›´æ¥è¿”å›æ¸¸æ ‡cursorã€‚ 4ã€è·å–å³å°†è¿­ä»£å…ƒç´ çš„å‰ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼• 123public int previousIndex() { return cursor-1;} ç›´æ¥è¿”å›æ¸¸æ ‡cursorå‡ä¸€ã€‚ 5ã€ç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢æœ€è¿‘ä¸€æ¬¡è¿­ä»£è¿”å›çš„å…ƒç´  123456789101112public void set(E e) { if (lastRet &lt; 0) throw new IllegalStateException(); checkForComodification(); try { AbstractList.this.set(lastRet, e); expectedModCount = modCount; } catch (IndexOutOfBoundsException ex) { throw new ConcurrentModificationException(); }} ä»…èƒ½åœ¨ä¸Šæ¬¡è°ƒç”¨nextæˆ–previousæ–¹æ³•ä¹‹åæ²¡æœ‰è°ƒç”¨è¿­ä»£å™¨çš„removeæˆ–addæ–¹æ³•çš„æƒ…å†µä¸‹æ‰èƒ½è°ƒç”¨ã€‚ è°ƒç”¨äº†å¤–éƒ¨æŠ½è±¡ç±»AbstractListçš„setæ–¹æ³•å°†lastRetç´¢å¼•æŒ‡å‘çš„å…ƒç´ æ›¿æ¢æˆæŒ‡å®šå…ƒç´ eï¼Œç„¶åå°†å®é™…modCountèµ‹ç»™æœŸæœ›ä¿®æ”¹æ¬¡æ•°expectedModCountã€‚æ ¡éªŒé€»è¾‘åŒItrè¿­ä»£å™¨çš„removeæ–¹æ³•ã€‚ 6ã€æ’å…¥æŒ‡å®šå…ƒç´ è‡³åˆ—è¡¨ 12345678910111213public void add(E e) { checkForComodification(); try { int i = cursor; AbstractList.this.add(i, e); lastRet = -1; cursor = i + 1; expectedModCount = modCount; } catch (IndexOutOfBoundsException ex) { throw new ConcurrentModificationException(); }} å°†æŒ‡å®šå…ƒç´ eæ’å…¥åˆ—è¡¨ï¼Œè¯¥å…ƒç´ çš„æ’å…¥ä½ç½®ä¸ºï¼šnextæ–¹æ³•è¿”å›çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰å…ƒç´ ï¼‰ä¹‹å‰å’Œpreviousæ–¹æ³•è¿”å›çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰å…ƒç´ ï¼‰ä¹‹åã€‚å¦‚æœåˆ—è¡¨ä¸­æœ¬æ¥ä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œåˆ™æŒ‡å®šå…ƒç´ eå°†æˆä¸ºåˆ—è¡¨ä¸­çš„å”¯ä¸€å…ƒç´ ã€‚è°ƒç”¨æ­¤æ–¹æ³•åï¼ŒnextIndexå’ŒpreviousIndexæ–¹æ³•çš„è°ƒç”¨è¿”å›å€¼å°†å¢åŠ ä¸€ã€‚ é¦–å…ˆè·å–å½“å‰æ¸¸æ ‡æŒ‡å‘ç´¢å¼•iï¼Œç„¶åè°ƒç”¨å¤–éƒ¨ç±»AbstractListçš„addæ–¹æ³•å°†æŒ‡å®šå…ƒç´ eæ’å…¥æŒ‡å®šç´¢å¼•iä½ç½®ã€‚å°†lastReté‡ç½®ä¸º-1ï¼Œæ¸¸æ ‡cursorå¢ä¸€ï¼Œå³ä¸‹æ¬¡è°ƒç”¨nextæ–¹æ³•å°†è¿”å›æŒ‡å®šå…ƒç´ eä¹‹åçš„å…ƒç´ ï¼Œè€Œè°ƒç”¨previousæ–¹æ³•å°†è¿”å›æŒ‡å®šå…ƒç´ eã€‚æœ€åå°†å®é™…modCountèµ‹ç»™æœŸæœ›ä¿®æ”¹æ¬¡æ•°expectedModCountã€‚æ ¡éªŒé€»è¾‘åŒsetæ–¹æ³•ã€‚ æ¯”è¾ƒå’Œå“ˆå¸Œequalsæ¯”è¾ƒ12345678910111213141516public boolean equals(Object o) { if (o == this) return true; if (!(o instanceof List)) return false; ListIterator&lt;E&gt; e1 = listIterator(); ListIterator&lt;?&gt; e2 = ((List&lt;?&gt;) o).listIterator(); while (e1.hasNext() &amp;&amp; e2.hasNext()) { E o1 = e1.next(); Object o2 = e2.next(); if (!(o1==null ? o2==null : o1.equals(o2))) return false; } return !(e1.hasNext() || e2.hasNext());} æ¯”è¾ƒæŒ‡å®šå¯¹è±¡ä¸æ­¤å¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚å½“ä¸”ä»…å½“æŒ‡å®šå¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä¸”ä¸¤ä¸ªåˆ—è¡¨å…·æœ‰ç›¸åŒçš„å¤§å°ï¼Œå¹¶ä¸”ä¸¤ä¸ªåˆ—è¡¨ä¸­æ‰€æœ‰å¯¹åº”çš„å…ƒç´ ä¹Ÿå‡ç›¸ç­‰æ—¶ï¼Œè¿”å›trueã€‚åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ ç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼šå½“ä¸”ä»…å½“e1 == null ? e2 == null : e1.equals(e2)æ—¶ï¼Œä¸¤ä¸ªå…ƒç´ è®¤ä¸ºæ˜¯ç›¸ç­‰çš„ã€‚ æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨åŒ…å«ç›¸åŒé¡ºåºçš„ç›¸åŒå…ƒç´ ï¼Œåˆ™å°†å®ƒä»¬å®šä¹‰ä¸ºç›¸ç­‰ã€‚ æ­¤å®ç°é¦–å…ˆæ£€æŸ¥æŒ‡å®šçš„å¯¹è±¡æ˜¯å¦ä¸ºå½“å‰åˆ—è¡¨ï¼ˆ==åˆ¤æ–­åœ°å€æ˜¯å¦ç›¸ç­‰ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å›trueï¼›å¦‚æœä¸æ˜¯ï¼Œå°†æ£€æŸ¥æŒ‡å®šå¯¹è±¡æ˜¯å¦ä¸ºListç±»å‹ï¼Œå¦‚æœä¸æ˜¯åˆ™è¿”å›falseï¼›å¦‚æœæ˜¯ï¼Œåˆ™è¿­ä»£ä¸¤ä¸ªåˆ—è¡¨ï¼Œæ¯”è¾ƒç›¸å¯¹åº”çš„å…ƒç´ å¯¹ï¼Œå¦‚æœæœ‰ä»»ä½•æ¯”è¾ƒè¿”å›falseï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›falseã€‚å¦‚æœæ¯”è¾ƒå®Œæˆåä»»æ„ä¸€ä¸ªè¿­ä»£å™¨è¿˜æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›falseï¼ˆå› ä¸ºä¸¤ä¸ªåˆ—è¡¨é•¿åº¦ä¸ç›¸ç­‰ï¼‰ï¼Œå¦åˆ™è¿­ä»£å®Œæˆåå°†è¿”å›trueã€‚ hashCode123456public int hashCode() { int hashCode = 1; for (E e : this) hashCode = 31*hashCode + (e==null ? 0 : e.hashCode()); return hashCode;} æ­¤å®ç°å®Œå…¨ä½¿ç”¨List#hashCodeæ–¹æ³•æ–‡æ¡£ä¸­å®šä¹‰çš„åˆ—è¡¨å“ˆå¸Œå‡½æ•°çš„ä»£ç ã€‚","link":"/2020/05/08/javase/base/abstract-list/"},{"title":"JDKæºç è§£æä¹‹AbstractCollection","text":"ç®€ä»‹java.util.AbstractCollectionç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå®ç°äº†Collectionæ¥å£ã€‚ä»è®¾è®¡æ¨¡å¼çš„è§’åº¦æ¥çœ‹ï¼Œä»¥Abstractå¼€å¤´çš„ç±»åº”è¯¥æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ç±»ã€‚äº‹å®ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå®ƒæä¾›äº†å¯¹Collectionæ¥å£çš„æœ€åŸºæœ¬å®ç°ã€‚ä»¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘å®ç°ç±»æ‰€éœ€çš„å·¥ä½œã€‚ ç‰¹æ€§è¯¥æŠ½è±¡ç±»åªæä¾›äº†é›†åˆçš„æœ€åŸºæœ¬å®ç°ï¼Œå¹¶æœªå¯¹å®ç°ç±»çš„ç‰¹æ€§è¿›è¡Œä»»ä½•é™åˆ¶ã€‚ å¦‚æœè¦å®ç°ä¸å¯ä¿®æ”¹çš„é›†åˆï¼Œåªéœ€ç»§æ‰¿è¯¥ç±»å¹¶ä¸ºiteratorå’Œsizeæ–¹æ³•æä¾›å®ç°ï¼ˆç”±iteratoræ–¹æ³•è¿”å›çš„è¿­ä»£å™¨å¿…é¡»å®ç°hasNextå’Œnextæ–¹æ³•ï¼‰ï¼›å¦‚æœè¦å®ç°å¯ä¿®æ”¹çš„é›†åˆï¼Œåœ¨å®ç°ä¸å¯ä¿®æ”¹é›†åˆçš„åŸºç¡€ä¹‹ä¸Šï¼Œè¿˜è¦å¦å¤–é‡å†™æ­¤ç±»çš„addæ–¹æ³•ï¼ˆå¦åˆ™å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ï¼‰ï¼ŒåŒæ—¶ç”±iteratoræ–¹æ³•è¿”å›çš„è¿­ä»£å™¨å¿…é¡»å¦å¤–å®ç°å…¶removeæ–¹æ³•ã€‚ æ­¤å¤–ï¼Œå®ç°ç±»åŒæ ·åº”è¯¥éµå¾ªCollectionæ¥å£ä¸­æå‡ºçš„è§„èŒƒï¼šå¿…é¡»æä¾›ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼švoidæ— å‚æ„é€ å™¨å’Œå¸¦Collectionç±»å‹çš„å•ä¸ªå‚æ•°çš„æ„é€ å™¨ã€‚ æ‰€æœ‰æœªè¿›è¡Œå®ç°çš„æ–¹æ³•éƒ½è¢«æ ‡è®°ä¸ºæŠ½è±¡æ–¹æ³•å¾…å­ç±»å®ç°ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹åœ¨è¯¥æŠ½è±¡ç±»ä¸­æ˜¯å¦‚ä½•å¯¹é›†åˆè¿›è¡Œæœ€åŸºæœ¬å®ç°çš„ã€‚ æºç è¯¦è§£æ„é€ å™¨åªæœ‰ä¸€ä¸ªä½¿ç”¨protectedä¿®é¥°ç¬¦ä¿®é¥°çš„æ— å‚æ„é€ å™¨ã€‚è¯´æ˜è¯¥æŠ½è±¡ç±»ä¸å…è®¸å¤–éƒ¨ç›´æ¥å®ä¾‹åŒ–ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåªæ˜¯æœ€åŸºæœ¬çš„å®ç°ï¼Œå¹¶ä¸å…·å¤‡é›†åˆçš„å®Œæ•´åŠŸèƒ½ã€‚ 12protected AbstractCollection() {} æˆå‘˜å˜é‡1private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8; åªæœ‰ä¸€ä¸ªé™æ€æˆå‘˜å˜é‡ï¼Œå®ƒè¡¨æ˜äº†è¦åˆ†é…çš„æ•°ç»„çš„æœ€å¤§å¤§å°ã€‚å¦‚æœè¶…å‡ºæ­¤é™åˆ¶å¯èƒ½ä¼šå¯¼è‡´OutOfMemoryErrorã€‚ æŠ½è±¡æ–¹æ³•æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•éƒ½æ˜¯å¾…å…·ä½“å­ç±»å»å®ç°çš„æ–¹æ³•ã€‚ä¸€å…±æœ‰ä¸¤ä¸ªï¼š public abstract Iterator&lt;E&gt; iterator();ï¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ã€‚ public abstract int size();ï¼šè®¡ç®—é›†åˆå¤§å°ã€‚ å·²å®ç°æ–¹æ³•æ‰€æœ‰å®ç°æ–¹æ³•éƒ½æ˜¯æœ€åŸºæœ¬çš„å®ç°ï¼Œå½“å­ç±»æœ‰æ›´å¥½çš„å®ç°æ–¹å¼æ—¶å®Œå…¨å¯ä»¥è¿›è¡Œé‡å†™ã€‚ æŸ¥è¯¢æ“ä½œåˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º123public boolean isEmpty() { return size() == 0;} åªéœ€åˆ¤æ–­size()æ–¹æ³•è®¡ç®—å‡ºçš„é›†åˆå¤§å°æ˜¯å¦ä¸º0å³å¯ã€‚ç”±äºsize()æ–¹æ³•æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ç›¸å½“äºè¿˜æ˜¯äº¤ç”±å­ç±»å®ç°ã€‚ åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„å…ƒç´ 12345678910111213public boolean contains(Object o) { Iterator&lt;E&gt; it = iterator(); if (o==null) { while (it.hasNext()) if (it.next()==null) return true; } else { while (it.hasNext()) if (o.equals(it.next())) return true; } return false;} é¦–å…ˆè°ƒç”¨æŠ½è±¡çš„iteratoræ–¹æ³•è·å–ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œç„¶åå¯¹é›†åˆè¿›è¡Œè¿­ä»£éå†ã€‚ åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼ŒæŒ‡å®šçš„å…ƒç´ ä¸ºnullå’Œénullï¼Œå¦‚æœä¸ºnullï¼Œåˆ™ä½¿ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒï¼›å¦‚æœä¸ºénullï¼Œåˆ™ä½¿ç”¨equalsæ–¹æ³•è¿›è¡Œæ¯”è¾ƒã€‚ è¿­ä»£å™¨å¯¹è±¡çš„hasNextå’Œnextæ–¹æ³•å‡ç”±å…·ä½“å­ç±»è¿›è¡Œå®ç°ã€‚ å°†é›†åˆè½¬æ¢æˆå¯¹è±¡æ•°ç»„å°†è¯¥é›†åˆçš„è¿­ä»£å™¨è¿”å›çš„æ‰€æœ‰å…ƒç´ æŒ‰ç›¸åŒé¡ºåºè¿ç»­å­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ã€‚è¿”å›çš„æ•°ç»„é•¿åº¦ç­‰äºé›†åˆå…ƒç´ çš„æ•°é‡ï¼Œå³ä½¿åœ¨è¿­ä»£è¿‡ç¨‹ä¸­æ­¤é›†åˆçš„å¤§å°å‘ç”Ÿäº†æ”¹å˜ï¼ˆå¹¶å‘ä¿®æ”¹ï¼‰ï¼Œæœ€ç»ˆè¿”å›çš„æ•°ç»„ä¹Ÿä¸é›†åˆä¿æŒä¸€è‡´ã€‚ æºç å¦‚ä¸‹ï¼š 1234567891011public Object[] toArray() { // Estimate size of array; be prepared to see more or fewer elements Object[] r = new Object[size()]; Iterator&lt;E&gt; it = iterator(); for (int i = 0; i &lt; r.length; i++) { if (! it.hasNext()) // fewer elements than expected return Arrays.copyOf(r, i); r[i] = it.next(); } return it.hasNext() ? finishToArray(r, it) : r;} é¦–å…ˆåˆ›å»ºsize()å¤§å°çš„Objectæ•°ç»„ï¼Œè°ƒç”¨iteratoræ–¹æ³•å¾—åˆ°é›†åˆçš„è¿­ä»£å™¨ï¼Œç„¶åå¯¹åˆ›å»ºçš„Objectæ•°ç»„è¿›è¡Œä¸‹æ ‡ç´¢å¼•éå†ï¼š æ­£å¸¸æƒ…å†µä¸‹ï¼Œåœ¨forå¾ªç¯çš„éå†ä¸­ï¼Œit.hasNext()æ–¹æ³•å°†ä¸€ç›´è¿”å›trueï¼Œifæ¡ä»¶åˆ¤æ–­å°†ä¸ä¼šæˆç«‹ï¼Œå¾ªç¯å®Œæˆåï¼Œè¿­ä»£å™¨çš„hasNextæ–¹æ³•å°†è¿”å›falseï¼Œæœ€ç»ˆå°†ræ•°ç»„è¿”å›ï¼› è€Œåœ¨å¹¶å‘ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œä¼šå‡ºç°è¿­ä»£è¿‡ç¨‹ä¸­é›†åˆå…ƒç´ å‡å°‘çš„æƒ…å†µï¼Œè¿™æ—¶if(!it.hasNext())åˆ¤æ–­æˆç«‹ï¼Œå°†è¿”å›Arrays.copyOf(r,i)ï¼šæ‹·è´ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶é•¿åº¦ä¸ºiï¼› åŒæ ·åœ°ï¼Œå¹¶å‘ä¿®æ”¹ä¼šé€ æˆé›†åˆå…ƒç´ å¢åŠ çš„æƒ…å†µï¼Œforå¾ªç¯éå†åŸé›†åˆé•¿åº¦r.lengthæ¬¡åå°±å·²ç»ç»“æŸäº†ï¼Œå†è¿”å›æ—¶è¿›è¡Œäº†ä¸‰ç›®è¡¨è¾¾å¼åˆ¤æ–­ï¼Œå¦‚æœè¿­ä»£å™¨çš„hasNextæ–¹æ³•è¿”å›trueï¼ˆè¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œåˆ™è°ƒç”¨finishToArray(r, it)æ–¹æ³•å¹¶è¿”å›ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹finishToArrayæ–¹æ³•çš„å…·ä½“å®ç°ï¼š 12345678910111213141516private static &lt;T&gt; T[] finishToArray(T[] r, Iterator&lt;?&gt; it) { int i = r.length; while (it.hasNext()) { int cap = r.length; if (i == cap) { int newCap = cap + (cap &gt;&gt; 1) + 1; // overflow-conscious code if (newCap - MAX_ARRAY_SIZE &gt; 0) newCap = hugeCapacity(cap + 1); r = Arrays.copyOf(r, newCap); } r[i++] = (T)it.next(); } // trim if overallocated return (i == r.length) ? r : Arrays.copyOf(r, i);} å…¥å‚ä¸ºåŸé›†åˆçš„å¯¹è±¡æ•°ç»„ï¼ˆå¹¶å‘ä¿®æ”¹å‰çš„é›†åˆï¼‰å’Œé›†åˆçš„è¿­ä»£å™¨ã€‚ é¦–å…ˆè®°å½•åŸæ•°ç»„çš„é•¿åº¦ä¸ºiï¼› ç„¶åå¼€å§‹è¿­ä»£ï¼Œå†æ¬¡è®°å½•ä¸€æ¬¡åŸæ•°ç»„é•¿åº¦ï¼Œç”¨å±€éƒ¨å˜é‡capæ¥æ”¶ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶i == capæˆç«‹ï¼Œå¯¹capè¿›è¡Œæ‰©å®¹ï¼ŒnewCap = cap + (cap &gt;&gt; 1) + 1;ï¼šæ‰©å®¹å¤§çº¦ä¸ºåŸcapçš„1.5å€ã€‚ æ‰©å®¹åå¦‚æœå‘ç°å¤§äºäº†å®šä¹‰çš„é™æ€æˆå‘˜å˜é‡MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8æ—¶ï¼Œåˆ™è¿›è¡Œå®¹é‡æœ€å¤§åŒ–å¤„ç†ï¼šè°ƒç”¨hugeCapacityæ–¹æ³•ã€‚ hugeCapacityæ–¹æ³•æºç å¦‚ä¸‹ï¼š 12345678private static int hugeCapacity(int minCapacity) { if (minCapacity &lt; 0) // overflow throw new OutOfMemoryError (&quot;Required array size too large&quot;); return (minCapacity &gt; MAX_ARRAY_SIZE) ? Integer.MAX_VALUE : MAX_ARRAY_SIZE;} å¯çœ‹åˆ°è¿”å›çš„æœ€å¤§å®¹é‡ä¸ºInteger.MAX_VALUEã€‚ æ¥ä¸‹æ¥è°ƒç”¨r = Arrays.copyOf(r, newCap);ï¼Œå°†æ•°ç»„rä¸­çš„å…ƒç´ æ‹·è´è‡³ä¸€ä¸ªæ–°çš„å®¹é‡ä¸ºnewCapçš„æ•°ç»„ä¸­å¹¶èµ‹å€¼ç»™rã€‚ å†æ¥ä¸‹æ¥è°ƒç”¨r[i++] = (T)it.next();å°†é›†åˆä¸­çš„å‰©ä½™å…ƒç´ ï¼ˆå¹¶å‘ä¿®æ”¹äº§ç”Ÿçš„ï¼Œç´¢å¼•å¤§äºiï¼‰å¡«å……è‡³æ–°å®¹é‡çš„ræ•°ç»„ä¸­ã€‚ ç„¶åè¿›è¡Œä¸‹ä¸€æ¬¡çš„è¿­ä»£ï¼Œå¦‚æœnewCapå®¹é‡çš„æ•°ç»„ä»ä¸èƒ½å®Œå…¨å¡«å……é›†åˆä¸­çš„å‰©ä½™å…ƒç´ ï¼Œåˆ™i == capæ¡ä»¶ä¼šå†æ¬¡æˆç«‹ï¼Œä¼šå†æ¬¡è¿›è¡Œæ‰©å®¹ï¼Œç›´è‡³å®Œå…¨å¡«å……ã€‚ å¡«å……å®Œæˆåï¼Œræ•°ç»„å¹¶ä¸æ˜¯æ°å¥½è¢«å¡«æ»¡ï¼Œå› ä¸ºæ‰©å®¹æ˜¯ç›´æ¥æ‰©å®¹1.5å€ï¼Œå¾ˆå¯èƒ½æ•°ç»„æœ«å°¾æ²¡æœ‰ä»»ä½•å…ƒç´ ï¼Œæ‰€ä»¥åœ¨returnæ—¶åˆ©ç”¨ä¸‰ç›®è¿ç®—ç¬¦åˆ¤æ–­i == r.lengthæ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹åˆ™è¡¨ç¤ºæ°å¥½å¡«æ»¡ï¼Œç›´æ¥è¿”å›ræ•°ç»„ï¼›å¦åˆ™è°ƒç”¨Arrays.copyOf(r, i)å°†ræ•°ç»„æ‹·è´è‡³ä¸€ä¸ªæ–°çš„å®¹é‡ä¸ºiçš„æ•°ç»„ä¸­è¿”å›ã€‚ ä¿®æ”¹æ“ä½œæ·»åŠ å…ƒç´ è‡³é›†åˆæ­¤æŠ½è±¡ç±»ç›´æ¥æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ç”±å…·ä½“å­ç±»å»é‡å†™addæ–¹æ³•æ¥å®ç°å‘é›†åˆä¸­æ·»åŠ å…ƒç´ ã€‚ æ·»åŠ å…ƒç´ å·²ç»å±äºé›†åˆçš„ä¸ªæ€§åŒ–æ“ä½œäº†ï¼Œä¸åŒçš„é›†åˆä¿å­˜å…ƒç´ çš„æ–¹å¼ä¸åŒï¼Œæ·»åŠ çš„æ–¹å¼ä¹Ÿä¸åŒï¼Œåœ¨æŠ½è±¡ç±»ä¸­ä¸åº”æœ‰ä»»ä½•å…·ä½“å®ç°ã€‚ 123public boolean add(E e) { throw new UnsupportedOperationException();} ä»é›†åˆä¸­åˆ é™¤æŒ‡å®šå…ƒç´ æ­¤æŠ½è±¡ç±»ä¸­æ²¡æœ‰ä»»ä½•å­˜å‚¨é›†åˆå…ƒç´ çš„ä»‹è´¨ï¼Œå”¯ä¸€èƒ½æ¥è§¦åˆ°é›†åˆå…ƒç´ çš„æ˜¯è¿­ä»£å™¨ã€‚ è¿™é‡Œå°±ä½“ç°å‡ºè¿­ä»£å™¨è®¾è®¡æ¨¡å¼çš„å¥½å¤„äº†ï¼šä¸ç”¨å»å…³å¿ƒå­ç±»é‡‡ç”¨ä½•ç§ç®—æ³•å»å®ç°è¿­ä»£ï¼Œåªéœ€è¦çŸ¥é“hasNextæ–¹æ³•å¯åˆ¤æ–­é›†åˆä¸­æ˜¯å¦è¿˜æœ‰å…ƒç´ ï¼›nextæ–¹æ³•å¯è·å–åˆ°æœ¬æ¬¡è¿­ä»£çš„å…ƒç´ å³å¯ã€‚ æ‰€ä»¥åˆ é™¤æŒ‡å®šå…ƒç´ åˆ©ç”¨çš„æ˜¯è¿­ä»£å™¨çš„åˆ é™¤æ–¹æ³•ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹å…·ä½“ä»£ç å®ç°ï¼š 12345678910111213141516171819public boolean remove(Object o) { Iterator&lt;E&gt; it = iterator(); if (o==null) { while (it.hasNext()) { if (it.next()==null) { it.remove(); return true; } } } else { while (it.hasNext()) { if (o.equals(it.next())) { it.remove(); return true; } } } return false;} åˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸ºnullå’Œénullä¸¤ç§æƒ…å†µï¼šnullä½¿ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒï¼›énullä½¿ç”¨equalsæ–¹æ³•æ¯”è¾ƒã€‚æœ€ç»ˆéƒ½ä¼šè°ƒç”¨è¿­ä»£å™¨çš„removeæ–¹æ³•åˆ é™¤æŒ‡å®šå…ƒç´ ã€‚ æ‰€ä»¥å®ç°ç±»å¦‚æœä¸é‡å†™è¯¥remove(Object o)æ–¹æ³•ï¼Œåˆ™å¿…é¡»åœ¨iterator()æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨ä¸­å®ç°è¿­ä»£å™¨çš„removeæ–¹æ³•ã€‚å¦åˆ™å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ æ‰¹é‡æ“ä½œåˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ ä½¿ç”¨è¿­ä»£å™¨éå†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œéå†è¿‡ç¨‹ä¸­è°ƒç”¨æœ¬æŠ½è±¡ç±»ä¸­çš„containsæ–¹æ³•åˆ¤æ–­æ˜¯å¦åŒ…å«ï¼Œåªè¦å‡ºç°ä¸€ä¸ªä¸åŒ…å«çš„æƒ…å†µï¼Œè¿”å›falseï¼Œå…¨éƒ¨åŒ…å«è¿”å›trueã€‚ è¯­æ³•ç³–ï¼šJDK5å¼•å…¥çš„forEachå¾ªç¯å®é™…è°ƒç”¨çš„æ˜¯è¿­ä»£å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ã€‚ 123456public boolean containsAll(Collection&lt;?&gt; c) { for (Object e : c) if (!contains(e)) return false; return true;} æ·»åŠ æŒ‡å®šé›†åˆè‡³å½“å‰é›†åˆä½¿ç”¨è¿­ä»£å™¨è¿­ä»£æŒ‡å®šçš„é›†åˆï¼Œå¹¶å°†è¿­ä»£å™¨è¿”å›çš„æ¯ä¸ªå¯¹è±¡æ·»åŠ è‡³å½“å‰é›†åˆä¸­ã€‚ ç”±äºå½“å‰é›†åˆçš„addæ–¹æ³•ä¸­ç›´æ¥æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•ä¾èµ–äºå…·ä½“å­ç±»çš„addæ–¹æ³•å®ç°ã€‚ 1234567public boolean addAll(Collection&lt;? extends E&gt; c) { boolean modified = false; for (E e : c) if (add(e)) modified = true; return modified;} åˆ é™¤æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ ä½¿ç”¨è¿­ä»£å™¨éå†å½“å‰é›†åˆï¼Œå¦‚æœè¿­ä»£å™¨è¿”å›çš„å…ƒç´ åŒ…å«åœ¨æŒ‡å®šé›†åˆä¸­ï¼Œåˆ™è°ƒç”¨è¿­ä»£å™¨çš„removeæ–¹æ³•å°†å…¶ä»å½“å‰é›†åˆä¸­åˆ é™¤ã€‚ æ‰€ä»¥ï¼Œå­ç±»å®ç°çš„iteratoræ–¹æ³•è¿”å›çš„è¿­ä»£å™¨å¿…é¡»åŒ…å«removeæ–¹æ³•å®ç°ã€‚å¦åˆ™è°ƒç”¨è¯¥æ–¹æ³•å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ 123456789101112public boolean removeAll(Collection&lt;?&gt; c) { Objects.requireNonNull(c); boolean modified = false; Iterator&lt;?&gt; it = iterator(); while (it.hasNext()) { if (c.contains(it.next())) { it.remove(); modified = true; } } return modified;} ä»å½“å‰é›†åˆä¸­åˆ é™¤æŒ‡å®šé›†åˆä¹‹å¤–çš„å…¨éƒ¨å…ƒç´ ä½¿ç”¨è¿­ä»£å™¨éå†å½“å‰é›†åˆï¼Œå¦‚æœè¿­ä»£å™¨è¿”å›çš„å…ƒç´ ä¸åŒ…å«åœ¨æŒ‡å®šé›†åˆä¸­ï¼Œåˆ™è°ƒç”¨è¿­ä»£å™¨çš„removeæ–¹æ³•å°†å…¶é‡å½“å‰é›†åˆä¸­åˆ é™¤ã€‚ æ‰€ä»¥ï¼Œå­ç±»å®ç°çš„iteratoræ–¹æ³•è¿”å›çš„è¿­ä»£å™¨å¿…é¡»åŒ…å«removeæ–¹æ³•å®ç°ã€‚å¦åˆ™è°ƒç”¨è¯¥æ–¹æ³•å°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ 123456789101112public boolean retainAll(Collection&lt;?&gt; c) { Objects.requireNonNull(c); boolean modified = false; Iterator&lt;E&gt; it = iterator(); while (it.hasNext()) { if (!c.contains(it.next())) { it.remove(); modified = true; } } return modified;} æ¸…ç©ºé›†åˆåœ¨æ­¤æŠ½è±¡ç±»ä¸­ï¼Œæ˜¯ä½¿ç”¨è¿­ä»£å™¨éå†å½“å‰é›†åˆï¼Œè°ƒç”¨è¿­ä»£å™¨çš„removeæ–¹æ³•ä¾æ¬¡åˆ é™¤æ¯ä¸ªå…ƒç´ ã€‚ ä½†å¤§å¤šæ•°å…·ä½“å®ç°ç±»ä¼šé€‰æ‹©é‡å†™è¯¥æ–¹æ³•ä»¥æé«˜æ•ˆç‡ã€‚ 1234567public void clear() { Iterator&lt;E&gt; it = iterator(); while (it.hasNext()) { it.next(); it.remove(); }} è½¬æ¢æˆå­—ç¬¦ä¸²æ­¤æ–¹æ³•æ˜¯é‡å†™Object#toStringæ–¹æ³•ï¼Œé¿å…åœ¨æ§åˆ¶å°æ‰“å°é›†åˆæ—¶æ‰“å°å‡ºé›†åˆå¯¹è±¡çš„åœ°å€å€¼ã€‚å…¶æ ¼å¼ä¸ºï¼šæœ€å¤–å±‚ç”¨æ–¹æ‹¬å·[]æ‹¬èµ·æ¥ï¼Œæ–¹æ‹¬å·ä¸­é—´å¡«å……ç”±è¿­ä»£å™¨è¿”å›çš„å…ƒç´ ï¼Œé¡ºåºä¸ºè¿­ä»£å™¨è¿”å›çš„é¡ºåºã€‚ç›¸é‚»å…ƒç´ ä¸­é—´ä»¥è‹±æ–‡é€—å·,åˆ†éš”ã€‚æ¯ä¸€ä¸ªå…ƒç´ é€šè¿‡String.valueOf(Object)æ–¹æ³•è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚ 123456789101112131415public String toString() { Iterator&lt;E&gt; it = iterator(); if (! it.hasNext()) return &quot;[]&quot;; StringBuilder sb = new StringBuilder(); sb.append('['); for (;;) { E e = it.next(); sb.append(e == this ? &quot;(this Collection)&quot; : e); if (! it.hasNext()) return sb.append(']').toString(); sb.append(',').append(' '); }} æ­¤æ–¹æ³•æ˜¯å¤§å¤šæ•°é›†åˆçš„toStringæ–¹æ³•ï¼Œå…·ä½“å®ç°ç±»ï¼ˆä¾‹å¦‚ArrayListï¼‰ä¸­å¹¶æœªé‡å†™è¯¥æ–¹æ³•ã€‚ æ€»ç»“è¯¥æŠ½è±¡ç±»è™½ç„¶æä¾›äº†å¾ˆå¤šæ–¹æ³•çš„å®ç°ï¼Œä½†æ‰€æœ‰çš„å®ç°éƒ½æ˜¯åŸºäºiteratorå’Œsizeè¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ä»æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼çš„è§’åº¦çœ‹ï¼Œè¯¥ç±»å®šä¹‰äº†é›†åˆæ“ä½œçš„ç®—æ³•éª¨æ¶ï¼Œå…·ä½“å®ç°è¿˜æ˜¯å¾—ç”±å­ç±»å»è¿›è¡Œå®ç°ã€‚","link":"/2020/05/05/javase/base/abstract-collection/"},{"title":"JDKæºç è§£æä¹‹Collection","text":"ç®€ä»‹Collectionæ¥å£æ˜¯Javaå®¹å™¨ç±»åº“ä¸­çš„é¡¶å±‚æ¥å£ä¹‹ä¸€ã€‚å®ƒæ¦‚æ‹¬äº†åºåˆ—çš„æ¦‚å¿µï¼šä¸€ç§å­˜æ”¾ä¸€ç»„å¯¹è±¡çš„æ–¹å¼ã€‚ JDKä¸æä¾›Collectionæ¥å£çš„ç›´æ¥å®ç°ï¼Œè€Œæ˜¯æä¾›æ›´ç‰¹æ®Šçš„å­æ¥å£çš„å®ç°ï¼Œæ¯”å¦‚Setå’ŒListã€‚è¯¥æ¥å£é€šå¸¸ç”¨äºä¼ é€’é›†åˆå¹¶åœ¨éœ€è¦æœ€å¤§é€šç”¨æ€§çš„åœ°æ–¹æ“çºµå®ƒä»¬ã€‚ ç‰¹æ€§æ‰€æœ‰é€šç”¨çš„Collectionæ¥å£å®ç°ç±»ï¼ˆé€šå¸¸é€šè¿‡å…¶å­æ¥å£ä¹‹ä¸€æ¥é—´æ¥å®ç°ï¼‰åº”è¯¥æä¾›ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼š voidæ— å‚æ„é€ å™¨ï¼šåˆ›å»ºä¸€ä¸ªç©ºé›†åˆã€‚ å¸¦æœ‰Collectionç±»å‹çš„å•ä¸ªå‚æ•°çš„æ„é€ å™¨ï¼šåˆ›å»ºä¸€ä¸ªæ–°é›†åˆï¼Œè¯¥é›†åˆå…·æœ‰ä¸å‚æ•°ç›¸åŒçš„å…ƒç´ ã€‚ äº‹å®ä¸Šï¼Œåä¸€ä¸ªæ„é€ å™¨å…è®¸æˆ‘ä»¬å¤åˆ¶ä»»ä½•é›†åˆï¼Œä»è€Œäº§ç”Ÿæ‰€éœ€å®ç°ç±»å‹çš„ç­‰æ•ˆé›†åˆã€‚ ç”±äºæ¥å£æ— æ³•åŒ…å«æ„é€ å™¨ï¼Œæ‰€ä»¥æ— æ³•å¼ºåˆ¶æ‰§è¡Œæ­¤è§„èŒƒï¼Œä½†æ˜¯Javaå¹³å°åº“ä¸­çš„æ‰€æœ‰é€šç”¨Collectionå®ç°éƒ½éµå¾ªäº†è¯¥è§„èŒƒã€‚ æ­¤æ¥å£ä¸­åŒ…å«ä¸€äº›â€œç ´åæ€§â€æ–¹æ³•ï¼šä¿®æ”¹é›†åˆçš„æ“ä½œã€‚å¦‚æœå®ç°ç±»ä¸æ”¯æŒï¼Œå°†æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœè°ƒç”¨å¯¹é›†åˆæ²¡æœ‰å½±å“ï¼Œåˆ™å¯ä»¥ä½†ä¸å¼ºåˆ¶è¦æ±‚è¿™äº›æ–¹æ³•æŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚ä¾‹å¦‚ï¼Œå¯¹ä¸å¯ä¿®æ”¹çš„é›†åˆè°ƒç”¨addAll(Collection c)æ–¹æ³•æ—¶ï¼Œå¦‚æœå¾…æ·»åŠ çš„é›†åˆcä¸ºç©ºï¼Œåˆ™å¯ä»¥ä½†ä¸æ˜¯å¿…é¡»æŠ›å‡ºå¼‚å¸¸ã€‚ æœ‰äº›é›†åˆå®ç°å¯¹å®ƒä»¬å¯èƒ½åŒ…å«çš„å…ƒç´ æœ‰é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œæœ‰äº›å®ç°ç¦æ­¢nullå…ƒç´ ï¼Œè€Œæœ‰äº›å®ç°å¯¹å…¶å…ƒç´ ç±»å‹æœ‰é™åˆ¶ã€‚å°è¯•æ·»åŠ ä¸åˆæ³•å…ƒç´ ä¼šå¼•å‘æœªç»æ£€æŸ¥çš„å¼‚å¸¸ï¼Œé€šå¸¸ä¸ºNullPointerExceptionæˆ–ClassCastExceptionã€‚å°è¯•æŸ¥è¯¢ä¸åˆæ³•å…ƒç´ çš„å­˜åœ¨å¯èƒ½ä¼šå¼•å‘å¼‚å¸¸ï¼Œæˆ–è€…å¯èƒ½ä»…è¿”å›falseã€‚ä¸€äº›å®ç°ç±»å°†è¡¨ç°å‡ºå‰è€…çš„è¡Œä¸ºï¼Œè€ŒæŸäº›å®ç°ç±»åˆ™è¡¨ç°å‡ºåè€…çš„è¡Œä¸ºã€‚æ›´ä¸€èˆ¬çš„ï¼Œå°è¯•å¯¹ä¸åˆæ³•å…ƒç´ è¿›è¡Œæ“ä½œï¼Œè¯¥æ“ä½œçš„å®Œæˆä¸ä¼šå¯¼è‡´ä¸åˆæ³•å…ƒç´ æ’å…¥é›†åˆä¸­ï¼Œè¿™å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæˆ–è€…å¯èƒ½ä¼šæˆåŠŸï¼Œä¸€åˆ‡éƒ½å–å†³äºå®ç°ç±»ã€‚å¯¹äºCollectionæ¥å£çš„è§„èŒƒæ¥è¯´ï¼Œè¿™äº›å¼‚å¸¸æ˜¯å¯é€‰çš„ï¼Œå¹¶æœªæ˜¾å¼æŠ›å‡ºã€‚ è¯¥æ¥å£ä¸­çš„è®¸å¤šæ–¹æ³•éƒ½æ˜¯æ ¹æ®Object#equals(Object o)æ–¹æ³•çš„æœ¯è¯­å®šä¹‰çš„ã€‚ä¾‹å¦‚ä»¥ä¸‹æ–¹æ³•ï¼š 1boolean contains(Object o); æ­¤æ¥å£çš„å®šä¹‰ä¸ºï¼šå½“ä¸”ä»…å½“æ­¤é›†åˆä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ eï¼Œä½¿å¾—o == null ? e == null : o.equals(e)æˆç«‹ã€‚ ä¸åº”ç†è§£ä¸ºå¯¹é›†åˆä¸­æ‰€æœ‰å…ƒç´ éƒ½è°ƒç”¨equalsæ–¹æ³•ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å°±å¯ä»¥è¿”å›ã€‚å®ç°ç±»å¯ä»¥è‡ªç”±è¿›è¡Œä¼˜åŒ–ï¼Œä»è€Œé¿å…equalsé¢‘ç¹è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å…ˆæ¯”è¾ƒä¸¤ä¸ªå…ƒç´ çš„å“ˆå¸Œç ï¼ˆObject#hashCode()æ–¹æ³•çš„è§„èŒƒä¿è¯äº†å…·æœ‰ä¸ç›¸ç­‰å“ˆå¸Œç çš„ä¸¤ä¸ªå¯¹è±¡ä¸€å®šä¸ç›¸ç­‰ã€‚ï¼‰ ç®€å•çš„è¯´ï¼Œå„ç§Collectionæ¥å£å®ç°ç±»éƒ½å¯ä»¥è‡ªç”±åˆ©ç”¨åŸºç¡€æ–¹æ³•ï¼ˆObjectç±»çš„æ–¹æ³•ï¼‰ï¼Œåªè¦å®ç°ç±»è®¤ä¸ºåˆé€‚å³å¯ã€‚ æ¥å£ç­¾åæŸ¥è¯¢æ“ä½œ int size()ï¼šè¿”å›é›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œæœ€å¤šä¸ºInteger.MAX_VALUEã€‚ boolean isEmpty()ï¼šå¦‚æœé›†åˆä¸­ä¸åŒ…å«ä»»ä½•å…ƒç´ åˆ™è¿”å›trueã€‚ boolean contains(Object o)ï¼šå½“ä¸”ä»…å½“æ­¤é›†åˆä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ eä½¿å¾—o == null ? e == null : o.equals(e)æˆç«‹æ—¶è¿”å›trueã€‚ Iterator&lt;E&gt; iterator()ï¼šè¿”å›æ­¤é›†åˆä¸­å…ƒç´ çš„è¿­ä»£å™¨ã€‚ Object[] toArray()ï¼šè¿”å›åŒ…å«æ­¤é›†åˆä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ã€‚å¦‚æœæ­¤é›†åˆå¯¹ç”±å…¶è¿­ä»£å™¨è¿”å›å…ƒç´ çš„é¡ºåºè¿›è¡Œäº†ä»»ä½•ä¿è¯ï¼Œåˆ™æ­¤æ–¹æ³•å¿…é¡»æŒ‰ç›¸åŒçš„é¡ºåºè¿”å›å…ƒç´ ã€‚æ“ä½œè¿”å›çš„æ•°ç»„ä¸ä¼šå¯¹åŸé›†åˆäº§ç”Ÿä»»ä½•å½±å“ï¼ˆå®‰å…¨ï¼‰ã€‚æ­¤æ–¹æ³•å……å½“åŸºäºæ•°ç»„çš„APIå’ŒåŸºäºé›†åˆçš„APIä¹‹é—´çš„æ¡¥æ¢ã€‚ ä¿®æ”¹æ“ä½œ boolean add(E e)ï¼šæ’å…¥å…ƒç´ eè‡³é›†åˆä¸­ï¼Œå¦‚æœæ­¤é›†åˆç”±äºè°ƒç”¨è¯¥æ–¹æ³•å‘ç”Ÿæ›´æ”¹ï¼Œåˆ™è¿”å›trueï¼›å¦‚æœé›†åˆä¸å…è®¸é‡å¤å…ƒç´ ï¼Œä¸”å·²ç»åŒ…å«eï¼Œåˆ™è¿”å›falseã€‚ boolean remove(Object o)ï¼šä»é›†åˆä¸­åˆ é™¤å…ƒç´ oã€‚éœ€æ»¡è¶³æ¡ä»¶ï¼šo == null ? e == null : o.equals(e)ã€‚å¦‚æœå­˜åœ¨å¤šä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œåˆ™åªä¼šåˆ é™¤å…ˆæ‰¾åˆ°çš„é‚£ä¸ªã€‚ æ‰¹é‡æ“ä½œ boolean containsAll(Collection&lt;?&gt; c)ï¼šå¦‚æœé›†åˆä¸­åŒ…å«æŒ‡å®šé›†åˆcä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›trueã€‚ boolean addAll(Collection&lt;? extends E&gt; c)ï¼šå°†æŒ‡å®šé›†åˆcä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³å½“å‰é›†åˆä¸­ã€‚å¦‚æœåœ¨æ“ä½œè¿‡ç¨‹ä¸­ä¿®æ”¹äº†æŒ‡å®šçš„é›†åˆcï¼Œåˆ™æ­¤æ“ä½œçš„è¡Œä¸ºæ˜¯ä¸ç¡®å®šçš„ã€‚ boolean removeAll(Collection&lt;?&gt; c)ï¼šåˆ é™¤æ‰€æœ‰åŒ…å«åœ¨æŒ‡å®šé›†åˆcä¸­çš„å…ƒç´ ã€‚æ­¤è°ƒç”¨è¿”å›åï¼Œå½“å‰é›†åˆä¸­å°†ä¸åŒ…å«ä¸æŒ‡å®šé›†åˆç›¸åŒçš„å…ƒç´ ã€‚ boolean retainAll(Collection&lt;?&gt; c)ï¼šä»…ä¿ç•™æ­¤é›†åˆä¸­åŒ…å«åœ¨æŒ‡å®šé›†åˆcä¸­çš„å…ƒç´ ã€‚æ¢å¥è¯è¯´ï¼Œæ­¤æ“ä½œå®Œæˆåï¼Œå½“å‰é›†åˆä¸æŒ‡å®šé›†åˆä¸­çš„å…ƒç´ å®Œå…¨ç›¸åŒã€‚ void clear()ï¼šåˆ é™¤æ­¤é›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ ã€‚ æ¯”è¾ƒå’Œå“ˆå¸Œè¯¥æ¥å£é‡æ–°å£°æ˜äº†Object#equalså’ŒObject#hashCodeæ–¹æ³•ï¼Œå¼ºåˆ¶å­ç±»å¿…é¡»å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ Collectionæ¥å£è¦æ±‚hashCodeæ–¹æ³•è¿”å›è¯¥é›†åˆçš„å“ˆå¸Œç ï¼›equalsæ–¹æ³•æ¯”è¾ƒæŒ‡å®šçš„å¯¹è±¡ä¸è¯¥é›†åˆæ˜¯å¦ç›¸ç­‰ã€‚ JDK8æ–°å¢é»˜è®¤æ–¹æ³•JDK8çš„StreamAPIæä¾›çš„ä¸¤ä¸ªæ–¹æ³•ã€‚åœ¨æ­¤é¡¶å±‚æ¥å£ä¸­å®šä¹‰é»˜è®¤å®ç°ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„é›†åˆéƒ½å¯ä»¥ä½¿ç”¨æµæ“ä½œã€‚ è·å–ä¸²è¡Œæµ123default Stream&lt;E&gt; stream() { return StreamSupport.stream(spliterator(), false);} è·å–å¹¶è¡Œæµ123default Stream&lt;E&gt; parallelStream() { return StreamSupport.stream(spliterator(), true);}","link":"/2020/05/05/javase/base/collection/"},{"title":"JDKæºç è§£æä¹‹List","text":"ç®€ä»‹Listæ¥å£ç»§æ‰¿äº†Collectionæ¥å£ï¼Œæ›´ç²¾ç¡®çš„å®šä¹‰äº†ä¸€ç§é›†åˆç±»å‹ã€‚ è¯¥æ¥å£å®šä¹‰çš„æ˜¯ä¸€ç§æœ‰åºé›†åˆï¼Œä¹Ÿç§°ä¸ºåºåˆ—ã€‚æ¥å£çš„ä½¿ç”¨è€…å¯ä»¥ç²¾ç¡®æ§åˆ¶åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ çš„æ’å…¥ä½ç½®ã€‚å¯ä»¥é€šè¿‡å…¶æ•´æ•°ç´¢å¼•ï¼ˆåºåˆ—ä¸­çš„ä½ç½®ï¼‰è®¿é—®å…ƒç´ ï¼Œå¹¶åœ¨åºåˆ—ä¸­æœç´¢å…ƒç´ ã€‚ ä¸Seté›†åˆä¸åŒï¼Œåºåˆ—é€šå¸¸å…è®¸é‡å¤çš„å…ƒç´ ï¼ˆequalsæ¯”è¾ƒç›¸ç­‰ï¼‰ã€‚å¹¶ä¸”å…è®¸å¤šä¸ªnullå…ƒç´ ã€‚ ä¸»è¦æ¥å£ç­¾åå¯¹äºIteratorã€addã€removeã€equalså’ŒhashCodeæ–¹æ³•ï¼Œåºåˆ—åœ¨Collectionæ¥å£çš„å®šä¹‰ä¹‹å¤–ï¼Œåˆå¢åŠ äº†ä¸€äº›å…¶å®ƒå®šä¹‰ã€‚åŒæ—¶ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œåºåˆ—ä¸­è¿˜åŒ…å«äº†å¯¹ç»§æ‰¿æ–¹æ³•çš„é‡æ–°å£°æ˜ã€‚ hashCode()Collectionæ¥å£ä¸­çš„hashCodeæ–¹æ³•åªæ˜¯å®šä¹‰äº†è¿”å›å€¼æ˜¯è¯¥é›†åˆçš„å“ˆå¸Œç ï¼ˆè°ƒç”¨çš„æ˜¯Objectç±»çš„hashCodeæ–¹æ³•ï¼‰ã€‚è€ŒListæ¥å£æ˜ç¡®è§„å®šäº†é›†åˆhashCodeçš„è®¡ç®—æ–¹å¼ï¼š 123int hashCode = 1;for (E e : list) hashCode = 31*hashCode + (e==null ? 0 : e.hashCode()); è®¡ç®—æ¯ä¸€ä¸ªå…ƒç´ çš„hashCodeå¹¶ç›¸åŠ ã€‚ è¿™ç¡®ä¿äº†å¯¹äºä»»æ„ä¸¤ä¸ªé›†åˆlist1å’Œlist2ï¼Œå¦‚æœæ»¡è¶³list1.hashCode() == list2.hashCode()ï¼Œåˆ™list1.equals(list2)ä¸€å®šç›¸ç­‰ã€‚è¿™ç¬¦åˆObject#hashCodeçš„è§„å®šã€‚ equals(Object o)Collectionæ¥å£ä¸­çš„equalsæ–¹æ³•çš„å®šä¹‰æ˜¯æŒ‡å®šå¯¹è±¡ä¸å½“å‰é›†åˆæ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœå®ç°ç±»å¸Œæœ›ä¸ä½¿ç”¨é»˜è®¤çš„Object#equalsæ–¹æ³•çš„==æ¯”è¾ƒï¼Œé‚£ä¹ˆéœ€è¦é‡å†™è¯¥æ–¹æ³•ã€‚ Listæ¥å£ä¸­é‡å†™çš„equalsæ–¹æ³•è§„å®šäº†åˆ¤æ–­æŒ‡å®šå¯¹è±¡ä¸é›†åˆæ˜¯å¦ç›¸ç­‰çš„é€»è¾‘ï¼šå½“ä¸”ä»…å½“æŒ‡å®šçš„å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªListåºåˆ—ï¼Œå…·æœ‰ç›¸åŒçš„å¤§å°ï¼Œå¹¶ä¸”ä¸¤ä¸ªåºåˆ—ä¸­æ‰€æœ‰å¯¹åº”ä½ç½®çš„å…ƒç´ éƒ½ç›¸ç­‰ï¼ˆç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼še1 == null ? e2 == null : e1.equals(e2)ï¼‰ã€‚ æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸¤ä¸ªåºåˆ—ä¸­ç›¸åŒç´¢å¼•ä½ç½®çš„å…ƒç´ éƒ½ç›¸ç­‰ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªåºåˆ—è¢«å®šä¹‰ä¸ºç›¸ç­‰ã€‚ è¿™ä¸ªå®šä¹‰ç¡®ä¿äº†equalsæ–¹æ³•å¯ä»¥åœ¨Listæ¥å£çš„ä¸åŒå®ç°ç±»ä¸­æ­£å¸¸è¿è¡Œã€‚ add(E e)Collectionæ¥å£ä¸­çš„addæ–¹æ³•å®šä¹‰äº†å¯ä»¥å‘é›†åˆä¸­æ·»åŠ å…ƒç´ ã€‚è€ŒListæ¥å£ä¸­å®šä¹‰çš„addæ–¹æ³•è§„å®šäº†å…ƒç´ æ·»åŠ çš„ä½ç½®ï¼šæ·»åŠ åˆ°åŸé›†åˆæœ«å°¾ã€‚ add(int index, E element)Listæ¥å£ä¸­æ–°å¢çš„æ¥å£ç­¾åï¼Œåœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šå…ƒç´ ã€‚å¦‚æœæŒ‡å®šç´¢å¼•ä½ç½®æœ‰å…ƒç´ ï¼Œè¯¥å…ƒç´ åŠå…¶ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ•´ä½“å‘åç§»åŠ¨ä¸€ä½ã€‚ addAll(Collection&lt;? extends E&gt; c)åŒæ ·åœ°ï¼ŒCollectionæ¥å£ä¸­çš„addæ–¹æ³•åªæ˜¯å®šä¹‰äº†å¯ä»¥å‘å½“å‰é›†åˆä¸­æ’å…¥å¦ä¸€ä¸ªé›†åˆã€‚è€ŒListæ¥å£æ˜ç¡®è§„å®šäº†æ’å…¥çš„ä½ç½®ä¸ºåŸé›†åˆæœ«å°¾ã€‚ addAll(int index, Collection&lt;? extends E&gt; c)Listæ¥å£ä¸­æ–°å¢çš„æ¥å£ç­¾åï¼Œåœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šé›†åˆã€‚å¦‚æœæŒ‡å®šç´¢å¼•ä½ç½®æœ‰å…ƒç´ ï¼Œè¯¥å…ƒç´ åŠå…¶ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ•´ä½“å‘åç§»åŠ¨æŒ‡å®šé›†åˆå¤§å°ä½ã€‚ remove(int index)Listæ¥å£ä¸­æ–°å¢çš„æ¥å£ç­¾åï¼Œåˆ é™¤åºåˆ—ä¸­æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ã€‚å¦‚æœæŒ‡å®šç´¢å¼•ä½ç½®åè¿˜æœ‰å…¶å®ƒå…ƒç´ ï¼Œåˆ™ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ•´ä½“å‘å‰ç§»åŠ¨ä¸€ä½ï¼Œæœ€åè¿”å›è¢«ç§»é™¤çš„é‚£ä¸ªå…ƒç´ ã€‚ IteratorListæ¥å£æä¾›äº†ä¸€ä¸ªç§°ä¸ºListIteratorçš„ç‰¹æ®Šè¿­ä»£å™¨ï¼Œé™¤äº†å…è®¸Iteratoræ¥å£æä¾›çš„å¸¸è§„æ“ä½œå¤–ï¼Œå®ƒè¿˜å…è®¸å…ƒç´ çš„æ’å…¥å’Œæ›¿æ¢ä»¥åŠåŒå‘è®¿é—®ã€‚æä¾›äº†ä¸€ç§æ–¹å¼æ¥è·å–ä»åºåˆ—çš„æŒ‡å®šä½ç½®å¼€å§‹çš„åºåˆ—è¿­ä»£å™¨ã€‚ å®šä¹‰äº†ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•è·å–åºåˆ—è¿­ä»£å™¨ï¼š 123ListIterator&lt;E&gt; listIterator();ListIterator&lt;E&gt; listIterator(int index); å…¶ä¸­é‡è½½çš„å¸¦ä¸€ä¸ªå‚æ•°çš„listIterator(int index)æ–¹æ³•ä»æŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹è¿”å›åºåˆ—è¿­ä»£å™¨ï¼Œå®ƒè¡¨ç¤ºåœ¨é¦–æ¬¡è°ƒç”¨ListIterator#nextæ–¹æ³•æ—¶å°†è¿”å›æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ã€‚é¦–æ¬¡è°ƒç”¨ListIterator#previousæ–¹æ³•æ—¶å°†è¿”å›æŒ‡å®šç´¢å¼•å‡ä¸€ä½ç½®çš„å…ƒç´ ã€‚ å…¶å®ƒç‰¹æ€§Listæ¥å£å®šä¹‰äº†å››ä¸ªæ–¹æ³•ç”¨äºå¯¹åºåˆ—å…ƒç´ è¿›è¡Œä½ç½®ï¼ˆç´¢å¼•ï¼‰è®¿é—®ã€‚ç´¢å¼•ä»0å¼€å§‹ã€‚åœ¨æŸäº›å®ç°ç±»ä¸­ï¼Œä¾‹å¦‚LinkedListï¼Œè¿™äº›æ–¹æ³•çš„å®ç°å¯èƒ½åœ¨æ—¶é—´ä¸Šä¸ç´¢å¼•çš„å€¼æˆæ¯”ä¾‹å¢é•¿ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨ç¼–ç è¿‡ç¨‹ä¸­ä¸çŸ¥é“Listçš„å®ç°ç±»ï¼ˆä¾‹å¦‚ä½¿ç”¨åå°„ç­‰ï¼‰å…·ä½“æ˜¯å“ªä¸ªç±»ï¼Œåˆ™éå†åºåˆ—å¯èƒ½æ¯”é€šè¿‡ç´¢å¼•è¿›è¡Œç´¢å¼•æ›´åŠ é«˜æ•ˆã€‚ void add(int index, E element);ï¼šåœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ ã€‚ E get(int index);ï¼šè·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ã€‚ E remove(int index);ï¼šç§»é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ã€‚ E set(int index, E element);ï¼šç»™æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ èµ‹å€¼ã€‚ å¦å¤–ï¼ŒListæ¥å£è¿˜å®šä¹‰äº†ä¸¤ä¸ªç”¨æ¥æœç´¢æŒ‡å®šå¯¹è±¡çš„æ–¹æ³•ï¼Œä»æ€§èƒ½æ¥çœ‹ï¼Œåº”è°¨æ…ä½¿ç”¨è¿™äº›æ–¹æ³•ã€‚åœ¨è®¸å¤šå®ç°ç±»ä¸­ï¼Œå®ƒä»¬çš„æ‰§è¡Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚ int indexOf(Object o);ï¼šè¿”å›æŒ‡å®šå…ƒç´ ç¬¬ä¸€æ¬¡å‡ºç°åœ¨è¯¥åºåˆ—ä¸­çš„ç´¢å¼•ä½ç½®ã€‚å¦‚æœä¸å­˜åœ¨åˆ™è¿”å›-1ã€‚ int lastIndexOf(Object o);ï¼šè¿”å›æŒ‡å®šå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°åœ¨è¯¥åºåˆ—ä¸­çš„ç´¢å¼•ä½ç½®ã€‚å¦‚æœä¸å­˜åœ¨åˆ™è¿”å›-1ã€‚ æ€»ç»“Listæ¥å£æ˜¯å¯¹Collectionæ¥å£çš„è¿›ä¸€æ­¥å®šä¹‰ï¼Œæ˜ç¡®äº†ä¸€ç§é›†åˆçš„ç±»å‹ï¼šåºåˆ—ã€‚ æ¥å£ä¸­çš„æ–¹æ³•ä¸€éƒ¨åˆ†æ˜¯å¯¹çˆ¶æ¥å£æ–¹æ³•çš„é‡æ–°å£°æ˜ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ä¸ºäº†å¯¹åºåˆ—è¿™ç§é›†åˆå»ºæ¨¡è€Œå¢åŠ çš„æ¥å£ã€‚ æˆ‘ä»¬å­¦ä¹ è¯¥æ¥å£æ˜¯ä¸ºäº†â€œä»ä¸Šå¾€ä¸‹â€åœ°å¯¹é›†åˆæ¡†æ¶çš„ç‰¹æ€§è¿›è¡Œè®¤çŸ¥ã€‚","link":"/2020/05/05/javase/base/list/"},{"title":"JDKæºç è§£æä¹‹Cloneable","text":"Cloneableæ¥å£ç®€ä»‹1ã€ä¸€ä¸ªç±»å®ç°java.lang.Cloneableæ ‡è®°æ€§æ¥å£ä»¥å‘java.lang.Object#clone()æ–¹æ³•æŒ‡ç¤ºè¯¥æ–¹æ³•ä¸ºè¯¥ç±»çš„å®ä¾‹è¿›è¡Œé€åŸŸå¤åˆ¶æ˜¯åˆæ³•çš„ã€‚ 2ã€åœ¨æœªå®ç°java.lang.Cloneableæ¥å£çš„å®ä¾‹ä¸Šè°ƒç”¨java.lang.Object#clone()æ–¹æ³•ä¼šå¯¼è‡´æŠ›å‡ºjava.lang.CloneNotSupportedExceptionå¼‚å¸¸ã€‚ 3ã€æŒ‰ç…§çº¦å®šï¼Œå®ç°äº†java.lang.Cloneableæ¥å£çš„ç±»åº”ä½¿ç”¨publicå…¬å…±æ–¹æ³•é‡å†™java.lang.Object#clone()æ–¹æ³•ï¼ˆprotectedå—ä¿æŠ¤çš„ï¼‰ã€‚ å…‹éš†çš„åŸºæœ¬ä½¿ç”¨ç”±äºjava.util.ArrayListç±»å®ç°äº†Cloneableæ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªArrayListé›†åˆçš„æ•°æ®å…‹éš†è‡³å¦ä¸€ä¸ªæ–°çš„é›†åˆä¸­ã€‚ ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324package com.sunchaser.javase.base.cloneable;import com.google.common.collect.Lists;import java.util.ArrayList;/** * å°†ä¸€ä¸ªArrayListé›†åˆçš„æ•°æ®å…‹éš†è‡³å¦ä¸€ä¸ªæ–°çš„é›†åˆ * @author sunchaser * @date 2020/4/1 * @since 1.0 */public class ArrayListClone { public static void main(String[] args) { ArrayList&lt;String&gt; list = Lists.newArrayList(); list.add(&quot;Javaå¤§æ³•å¥½&quot;); list.add(&quot;PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€&quot;); list.add(&quot;å‘æ—¥è‘µçš„è‡ªæˆ‘ä¿®å…»&quot;); Object clone = list.clone(); System.out.println(clone == list); System.out.println(clone); System.out.println(list); }} ä»£ç è¯´æ˜ï¼š åˆ›å»ºä¸€ä¸ªArrayListé›†åˆå¯¹è±¡ï¼› å¾€å…¶ä¸­æ·»åŠ ä¸‰ä¸ªå…ƒç´ ï¼› è°ƒç”¨é›†åˆå¯¹è±¡çš„clone()æ–¹æ³•ï¼› åˆ¤æ–­å…‹éš†åçš„é›†åˆåœ°å€ä¸åŸé›†åˆåœ°å€æ˜¯å¦ç›¸ç­‰ï¼› åˆ†åˆ«æ‰“å°ä¸¤ä¸ªé›†åˆçš„å†…å®¹ã€‚ è¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå…‹éš†åçš„ArrayListé›†åˆä¸æ—§é›†åˆçš„åœ°å€ä¸ä¸€æ ·ï¼Œä½†å…¶å†…å®¹ç›¸åŒã€‚ ArrayList#clone()æ–¹æ³•æºç åˆ†æè°ƒç”¨äº†listå¯¹è±¡çš„clone()æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å…¶å®ç°ï¼š 1234567891011public Object clone() { try { ArrayList&lt;?&gt; v = (ArrayList&lt;?&gt;) super.clone(); v.elementData = Arrays.copyOf(elementData, size); v.modCount = 0; return v; } catch (CloneNotSupportedException e) { // this shouldn't happen, since we are Cloneable throw new InternalError(e); }} å¯ä»¥å‘ç°å…¶è°ƒç”¨çš„æ˜¯super.clone()æ–¹æ³•å¾—åˆ°çš„ä¸€ä¸ªæ–°çš„é›†åˆã€‚ é‚£ä¹ˆè¯¥superæŒ‡ä»£çš„æ˜¯å“ªä¸ªçˆ¶ç±»å‘¢ï¼Ÿ java.util.ArrayListçš„ç›´æ¥çˆ¶ç±»æ˜¯java.util.AbstractListï¼› java.util.AbstractListçš„ç›´æ¥çˆ¶ç±»æ˜¯java.util.AbstractCollectionï¼› java.util.AbstractCollectionæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ç°äº†java.util.Collectionæ¥å£ï¼Œæ²¡æœ‰ç»§æ‰¿ä»»ä½•çˆ¶ç±»ã€‚ ä½†æ˜¯æˆ‘ä»¬å´æ²¡æœ‰åœ¨java.util.AbstractListå’Œjava.util.AbstractCollectionç±»ä¸­æ‰¾åˆ°clone()æ–¹æ³•ã€‚ äº‹å®ä¸Šå¯ä»¥ç›´æ¥å€ŸåŠ©IDEAçš„å¿«æ·é”®å¾—åˆ°å…¶æ˜¯Objectç±»çš„clone()æ–¹æ³•ã€‚ åªæœ‰java.util.ArrayListç±»ä¸­æœ‰clone()æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨åŸºæœ¬ä½¿ç”¨çš„ä»£ç ä¸­åˆ›å»ºçš„é›†åˆï¼Œä½¿ç”¨java.util.ArrayListæ¥æ”¶è€Œä¸ç”¨é¡¶å±‚æ¥å£java.util.Listæ¥æ”¶çš„åŸå› ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹Object#clone()æ–¹æ³•çš„æºç ï¼š 1protected native Object clone() throws CloneNotSupportedException; è¿™æ˜¯ä¸€ä¸ªæœ¬åœ°naviveæ–¹æ³•ï¼Œä½¿ç”¨äº†protectedè®¿é—®ä¿®é¥°ç¬¦ï¼Œå¹¶æ˜¾å¼æŠ›å‡ºäº†java.lang.CloneNotSupportedExceptionå¼‚å¸¸ã€‚å…¶å®ç°æ˜¯ç”±åº•å±‚çš„c/c++è¯­è¨€è¿›è¡Œå®ç°çš„ï¼Œæˆ‘ä»¬æ— æ³•ä»Javaè¯­è¨€å±‚é¢çœ‹åˆ°ã€‚ å…‹éš†å‡ºä¸€ä¸ªArrayListå¯¹è±¡vä¹‹åï¼Œè°ƒç”¨å·¥å…·ç±»java.util.Arraysçš„copyOfæ–¹æ³•ï¼Œå°†åŸé›†åˆçš„æ•°æ®elementDataå’Œé›†åˆå¤§å°sizeä¼ å…¥ï¼Œæ‹·è´é›†åˆå…ƒç´ è‡³å…‹éš†é›†åˆvçš„elementDataåŸŸä¸­ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹java.util.Arrays#copyOf()æ–¹æ³•çš„å®ç°ï¼š 12345678910111213public static &lt;T&gt; T[] copyOf(T[] original, int newLength) { return (T[]) copyOf(original, newLength, original.getClass());}public static &lt;T,U&gt; T[] copyOf(U[] original, int newLength, Class&lt;? extends T[]&gt; newType) { @SuppressWarnings(&quot;unchecked&quot;) T[] copy = ((Object)newType == (Object)Object[].class) ? (T[]) new Object[newLength] : (T[]) Array.newInstance(newType.getComponentType(), newLength); System.arraycopy(original, 0, copy, 0, Math.min(original.length, newLength)); return copy;} copyOfæ–¹æ³•å†…éƒ¨è°ƒç”¨çš„æ˜¯å¦ä¸€ä¸ªé‡è½½çš„copyOfæ–¹æ³•ï¼Œåˆ¤æ–­ä¼ å…¥çš„é›†åˆæ•°æ®elementDataç±»å‹æ˜¯ä¸æ˜¯Object[]æ•°ç»„ç±»å‹ï¼Œå¦‚æœæ˜¯Objectç±»å‹åˆ™ä½¿ç”¨newå…³é”®å­—åˆ›å»ºä¸€ä¸ªæ–°çš„Object[]æ•°ç»„ï¼Œå¦åˆ™åˆ›å»ºå…¶å®ƒç±»å‹çš„æ•°ç»„ï¼Œæœ€åè°ƒç”¨System.arraycopyæ–¹æ³•å°†ä¼ å…¥çš„æ•°ç»„å…ƒç´ æ‹·è´è‡³æ–°å»ºçš„æ•°ç»„ä¸­è¿”å›ã€‚ è¿”å›äº†æ–°çš„æ•°ç»„ä¹‹åï¼Œå°†å…‹éš†å‡ºæ¥çš„é›†åˆvçš„elementDataåŸŸå¼•ç”¨æŒ‡å‘æ–°çš„æ•°ç»„åœ°å€ï¼Œç„¶åè®¾ç½®ä¿®æ”¹æ¬¡æ•°modCountå­—æ®µä¸º0ï¼Œå¾—åˆ°ä¸€ä¸ªå…¨æ–°çš„å…‹éš†é›†åˆè¿”å›ã€‚ æ€»ç»“Javaä¸­æ‰€æœ‰ç±»éƒ½æ˜¯ä»java.lang.Objectç±»ç»§æ‰¿è€Œæ¥çš„ï¼Œè€ŒObjectç±»æä¾›protected Object clone()æ–¹æ³•å¯¹å¯¹è±¡è¿›è¡Œå…‹éš†ï¼Œå­ç±»å¿…é¡»å®ç°æ ‡è®°å‹æ¥å£java.lang.Cloneableæ‰æ”¯æŒå…‹éš†ï¼Œå½“ç„¶å­ç±»ä¹Ÿå¯ä»¥é‡å†™Object#clone()æ–¹æ³•æ¥å®ç°è‡ªå·±çš„å…‹éš†æ–¹å¼ã€‚ å¯¹è±¡çš„å…‹éš†æœ‰ä¸€ä¸ªåŸºæœ¬é—®é¢˜ï¼šå¯¹è±¡å¯èƒ½åŒ…å«å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ï¼Œå½“ä½¿ç”¨Object#clone()æ–¹æ³•æ¥å…‹éš†å¯¹è±¡æ—¶ï¼Œæ­¤å¯¹è±¡å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ä¹Ÿè¢«å…‹éš†äº†ä¸€ä»½ï¼ˆæ³¨æ„ï¼šè¿™é‡Œå…‹éš†çš„æ˜¯å¼•ç”¨ï¼‰ã€‚ java.lang.Cloneableæ¥å£åªèµ·ä¸€ä¸ªä½œç”¨ï¼Œå°±æ˜¯åœ¨è¿è¡ŒæœŸæŒ‡ç¤ºè™šæ‹Ÿæœºåœ¨å½“å‰ç±»ä½¿ç”¨Object#clone()æ–¹æ³•æ˜¯åˆæ³•çš„ã€‚é€šè¿‡å…‹éš†å¯ä»¥å¾—åˆ°ä¸€ä¸ªå¯¹è±¡çš„å¤åˆ¶ã€‚ä½†ç”±äºObjectç±»å¹¶æœªå®ç°java.lang.Cloneableæ¥å£ï¼Œæ‰€ä»¥è¢«å…‹éš†çš„ç±»å¦‚æœæœªå®ç°java.lang.Cloneableæ¥å£ï¼Œåœ¨è°ƒç”¨java.lang.Object#clone()æ–¹æ³•æ—¶ä¼šæŠ›å‡ºjava.lang.CloneNotSupportedExceptionå¼‚å¸¸ã€‚","link":"/2020/04/26/javase/base/cloneable/"},{"title":"æ·±å…¥ç†è§£æ·±æµ…æ‹·è´","text":"æ— è®ºæ˜¯java.lang.Object#clone()æ–¹æ³•è¿˜æ˜¯è‡ªå·±å®ç°çš„å…‹éš†æ–¹æ³•ï¼Œéƒ½å­˜åœ¨ç€æµ…æ‹·è´å’Œæ·±æ‹·è´çš„é—®é¢˜ã€‚ é‚£ä¹ˆä»€ä¹ˆæ˜¯æµ…æ‹·è´å’Œæ·±æ‹·è´å‘¢ï¼Ÿ ä¸¾ä¸€ä¸ªä¸å¤ªæ°å½“çš„ä¾‹å­ï¼šå¤§å®¶éƒ½ç©è¿‡è‹±é›„è”ç›Ÿè¿™æ¬¾æ¸¸æˆå§ï¼Ÿè‹±é›„è”ç›Ÿä¸­çš„å­™æ‚Ÿç©ºè¿™ä¸ªè‹±é›„çš„WæŠ€èƒ½æ˜¯â€œçœŸå‡çŒ´ç‹â€ï¼šå­™æ‚Ÿç©ºè¿›å…¥éšå½¢çŠ¶æ€ç‰‡åˆ»ï¼Œå¹¶ç•™ä¸‹ä¸€ä¸ªæ›¿èº«ï¼Œæ›¿èº«åœ¨ç‰‡åˆ»åä¼šå¯¹å…¶å‘¨å›´çš„æ•Œäººé€ æˆé­”æ³•ä¼¤å®³ã€‚å¦‚æœç©å®¶æ”»å‡»æ›¿èº«ï¼Œæ›¿èº«æ‰è¡€ä½†æœ¬èº«ä¸æ‰è¡€ã€‚è¿™ä¼¼ä¹å¯ä»¥ç†è§£æˆæ·±æ‹·è´ã€‚ æµ…æ‹·è´å’Œæ·±æ‹·è´ç®€ä»‹ æµ…æ‹·è´ï¼šåªæ‹·è´è¢«å…‹éš†å¯¹è±¡ä¸­æŒ‰å€¼ä¼ é€’çš„å±æ€§æ•°æ®ï¼Œä¸æ‹·è´å¼•ç”¨ç±»å‹çš„å±æ€§æ•°æ®ã€‚æ¢è¨€ä¹‹ï¼Œæ‰€æœ‰å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ä»æŒ‡å‘åŸæ¥çš„å¯¹è±¡ï¼Œæ‹·è´çš„æ˜¯æ ˆå†…çš„å¼•ç”¨è€Œä¸æ˜¯å †å†…çš„å¯¹è±¡ã€‚ æ·±æ‹·è´ï¼šé™¤äº†æµ…æ‹·è´éœ€è¦å…‹éš†çš„å€¼ä¼ é€’çš„å±æ€§æ•°æ®ä¹‹å¤–ï¼Œè¿˜ä¼šæ‹·è´å¼•ç”¨ç±»å‹æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œå³æ‹·è´çš„å¼•ç”¨ä¼šæŒ‡å‘æ–°çš„å¯¹è±¡ã€‚æ¢è¨€ä¹‹ï¼Œæ·±æ‹·è´æŠŠå¾…å…‹éš†çš„å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡å…¨éƒ½æ‹·è´äº†ä¸€éã€‚ æ·±æ‹·è´è¦æ·±å…¥åˆ°å¤šå°‘å±‚ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦æ ¹æ®å®é™…æƒ…å†µæ¥å†³å®šçš„é—®é¢˜ã€‚å½“æ‹·è´è‡³æ— å¼•ç”¨å¯¹è±¡çš„æ—¶å€™ï¼Œå°±å¯ç§°ä¹‹ä¸ºå®Œå…¨æ·±æ‹·è´ã€‚æ­¤å¤–ï¼Œæ·±æ‹·è´ä¸­è¿˜å¯èƒ½ä¼šå‡ºç°å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œéœ€è¦ä»”ç»†å¤„ç†ã€‚ java.lang.Object#clone()æµ…æ‹·è´ä¸ºäº†è¯å®è¯¥æ–¹æ³•æ˜¯æµ…æ‹·è´ï¼Œæˆ‘ä»¬å…ˆæ¥å°è¯•è®¾è®¡ä¸€ä¸‹è‹±é›„ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªLOLè‹±é›„æ¥å£ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼šæ”»å‡»å’Œè¢«æ”»å‡»ï¼Œæ”»å‡»æ—¶æ³•åŠ›å€¼å‡å°‘ï¼Œè¢«æ”»å‡»æ—¶ç”Ÿå‘½å€¼å‡å°‘ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021package com.sunchaser.javase.base.cloneable;/** * LOLè‹±é›„æ¥å£ * @author sunchaser * @date 2020/4/7 * @since 1.0 */public interface LolHero { /** * æ”»å‡» * @param lolSkill ä½¿ç”¨çš„æŠ€èƒ½ */ void attack(LolSkill lolSkill); /** * å—åˆ°å…¶å®ƒè‹±é›„æ”»å‡» */ void beAttacked();} ç„¶åæˆ‘ä»¬æ¥å®šä¹‰æŠ€èƒ½ç±»ï¼ŒæŠ€èƒ½åŒ…æ‹¬æŒ‰é”®keyã€æŠ€èƒ½åç§°å’ŒæŠ€èƒ½æè¿°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344package com.sunchaser.javase.base.cloneable;/** * LOLè‹±é›„çš„æŠ€èƒ½ç±» * @author sunchaser * @date 2020/4/7 * @since 1.0 */public class LolSkill { private String key; private String name; private String desc; public LolSkill() { } public LolSkill(String key, String name, String desc) { this.key = key; this.name = name; this.desc = desc; } public String getKey() { return key; } public String getName() { return name; } public String getDesc() { return desc; } @Override public String toString() { final StringBuilder sb = new StringBuilder(&quot;LolSkill{&quot;); sb.append(&quot;key='&quot;).append(key).append('\\''); sb.append(&quot;, name='&quot;).append(name).append('\\''); sb.append(&quot;, desc='&quot;).append(desc).append('\\''); sb.append('}'); return sb.toString(); }} æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®šä¹‰ç”Ÿå‘½å€¼å’Œæ³•åŠ›å€¼ç±»ã€‚ ç”Ÿå‘½å€¼ç±»ï¼š 1234567891011121314151617181920212223242526272829303132333435package com.sunchaser.javase.base.cloneable;/** * è‹±é›„ç”Ÿå‘½å€¼ç±» * @author sunchaser * @date 2020/4/7 * @since 1.0 */public class LifeValue { private Integer lifeValue; public LifeValue() { } public LifeValue(Integer lifeValue) { this.lifeValue = lifeValue; } public Integer getLifeValue() { return lifeValue; } public LifeValue setLifeValue(Integer lifeValue) { this.lifeValue = lifeValue; return this; } @Override public String toString() { final StringBuilder sb = new StringBuilder(&quot;LifeValue{&quot;); sb.append(&quot;lifeValue=&quot;).append(lifeValue); sb.append('}'); return sb.toString(); }} æ³•åŠ›å€¼ç±»ï¼š 1234567891011121314151617181920212223242526272829303132333435package com.sunchaser.javase.base.cloneable;/** * è‹±é›„æ³•åŠ›å€¼ç±» * @author sunchaser * @date 2020/4/7 * @since 1.0 */public class Mana { private Integer mana; public Mana() { } public Mana(Integer mana) { this.mana = mana; } public Integer getMana() { return mana; } public Mana setMana(Integer mana) { this.mana = mana; return this; } @Override public String toString() { final StringBuilder sb = new StringBuilder(&quot;Mana{&quot;); sb.append(&quot;mana=&quot;).append(mana); sb.append('}'); return sb.toString(); }} æœ€åæˆ‘ä»¬æ¥åˆ›å»ºå­™æ‚Ÿç©ºè‹±é›„ç±»ï¼Œå®ƒå®ç°äº†è‡ªå®šä¹‰çš„LOLè‹±é›„æ¥å£å’Œjava.lang.Cloneableæ¥å£ï¼ŒåŒ…å«è‹±é›„åç§°ã€ç”Ÿå‘½å€¼ã€æ³•åŠ›å€¼å’Œå››ä¸ªæŠ€èƒ½ç­‰å±æ€§ï¼Œé‡å†™äº†java.lang.Cloneable#clone()æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879package com.sunchaser.javase.base.cloneable;/** * è‹±é›„ï¼šå­™æ‚Ÿç©º * @author sunchaser * @date 2020/4/7 * @since 1.0 */public class SunWuKong implements LolHero,Cloneable { /** * åå­— */ private String name = &quot;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&quot;; /** * ç”Ÿå‘½å€¼ */ private LifeValue sunWuKongLifeValue; /** * æ³•åŠ›å€¼ */ private Mana sunWuKongMana; /* skill */ private LolSkill Q = new LolSkill(&quot;Q&quot;,&quot;ç²‰ç¢æ‰“å‡»&quot;,&quot;å­™æ‚Ÿç©ºçš„ä¸‹æ¬¡æ”»å‡»é€ æˆé¢å¤–ç‰©ç†ä¼¤å®³ï¼Œè·å¾—è·ç¦»åŠ æˆï¼Œå¹¶æš‚æ—¶å‡å°‘æ•Œäººçš„æŠ¤ç”²ã€‚&quot;); private LolSkill W = new LolSkill(&quot;W&quot;,&quot;çœŸå‡çŒ´ç‹&quot;,&quot;å­™æ‚Ÿç©ºè¿›å…¥éšå½¢çŠ¶æ€ç‰‡åˆ»ï¼Œå¹¶ç•™ä¸‹ä¸€ä¸ªæ›¿èº«ï¼Œæ›¿èº«åœ¨ç‰‡åˆ»åä¼šå¯¹å…¶å‘¨å›´çš„æ•Œäººé€ æˆé­”æ³•ä¼¤å®³ã€‚&quot;); private LolSkill E = new LolSkill(&quot;E&quot;,&quot;è…¾äº‘çªå‡»&quot;,&quot;å­™æ‚Ÿç©ºçªè¿›è‡³ç›®æ ‡æ•Œäººå¤„ï¼Œå¹¶å˜å‡ºæœ€å¤š2ä¸ªåˆ†èº«ï¼Œæ”»å‡»é™„è¿‘ç›®æ ‡ã€‚å¯¹æ¯ä¸ªå‡»ä¸­çš„ç›®æ ‡é€ æˆç‰©ç†ä¼¤å®³ã€‚&quot;); private LolSkill R = new LolSkill(&quot;R&quot;,&quot;å¤§é—¹å¤©å®«&quot;,&quot;å­™æ‚Ÿç©ºå±•å¼€é‡‘ç®æ£’ï¼Œä¸åœåœ°æ—‹è½¬ï¼Œå¯¹æ•Œäººé€ æˆä¼¤å®³å¹¶å°†å…¶å‡»é£ã€‚åœ¨æ­¤æœŸé—´ï¼Œå­™æ‚Ÿç©ºé€Ÿåº¦æŒç»­å¢åŠ ã€‚&quot;); @Override public Object clone() throws CloneNotSupportedException { return super.clone(); } @Override public void attack(LolSkill lolSkill) { System.out.println(&quot;ä½¿ç”¨äº†&quot; + lolSkill + &quot;è¿›è¡Œäº†æ”»å‡»&quot;); } @Override public void beAttacked() { Integer oldSunWuKongLifeValue = this.sunWuKongLifeValue.getLifeValue() - 1; this.sunWuKongLifeValue.setLifeValue(oldSunWuKongLifeValue); } public String getName() { return name; } public LifeValue getSunWuKongLifeValue() { return sunWuKongLifeValue; } public SunWuKong setSunWuKongLifeValue(LifeValue sunWuKongLifeValue) { this.sunWuKongLifeValue = sunWuKongLifeValue; return this; } public Mana getSunWuKongMana() { return sunWuKongMana; } public SunWuKong setSunWuKongMana(Mana sunWuKongMana) { this.sunWuKongMana = sunWuKongMana; return this; } @Override public String toString() { final StringBuilder sb = new StringBuilder(&quot;SunWuKong{&quot;); sb.append(&quot;name='&quot;).append(name).append('\\''); sb.append(&quot;, sunWuKongLifeValue=&quot;).append(sunWuKongLifeValue); sb.append(&quot;, sunWuKongMana=&quot;).append(sunWuKongMana); sb.append('}'); return sb.toString(); }} ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š 123456789101112131415161718192021222324252627package com.sunchaser.javase.base.cloneable;/** * æ·±æµ…æ‹·è´æµ‹è¯• * @author sunchaser * @date 2020/4/7 * @since 1.0 */public class DepthCopyTest { public static void main(String[] args) throws CloneNotSupportedException { // åˆ›å»ºä¸€ä¸ªå­™æ‚Ÿç©ºè‹±é›„å¯¹è±¡ï¼Œå¹¶èµ‹äºˆç”Ÿå‘½å€¼1000ï¼Œæ³•åŠ›å€¼2000 SunWuKong sunWuKong = new SunWuKong(); sunWuKong.setSunWuKongLifeValue(new LifeValue(1000)) .setSunWuKongMana(new Mana(2000)); // å…‹éš†ä¸€ä¸ªæ›¿èº« SunWuKong clone = (SunWuKong) sunWuKong.clone(); System.out.println(sunWuKong); System.out.println(clone); System.out.println(sunWuKong == clone); // æ›¿èº«å—åˆ°æ”»å‡» clone.beAttacked(); System.out.println(sunWuKong); System.out.println(clone); System.out.println(sunWuKong == clone); }} è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºï¼š 123456SunWuKong{name='é½å¤©å¤§åœ£-å­™æ‚Ÿç©º', sunWuKongLifeValue=LifeValue{lifeValue=1000}, sunWuKongMana=Mana{mana=2000}}SunWuKong{name='é½å¤©å¤§åœ£-å­™æ‚Ÿç©º', sunWuKongLifeValue=LifeValue{lifeValue=1000}, sunWuKongMana=Mana{mana=2000}}falseSunWuKong{name='é½å¤©å¤§åœ£-å­™æ‚Ÿç©º', sunWuKongLifeValue=LifeValue{lifeValue=999}, sunWuKongMana=Mana{mana=2000}}SunWuKong{name='é½å¤©å¤§åœ£-å­™æ‚Ÿç©º', sunWuKongLifeValue=LifeValue{lifeValue=999}, sunWuKongMana=Mana{mana=2000}}false å­™æ‚Ÿç©ºâ€œæ›¿èº«â€å—åˆ°æ”»å‡»åï¼Œâ€œçœŸèº«â€çš„ç”Ÿå‘½å€¼ä¹Ÿå‡å°‘äº†ã€‚å¯ä»¥çœ‹å‡ºçœŸèº«å’Œæ›¿èº«å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªç”Ÿå‘½å€¼å¯¹è±¡ã€‚è¶³ä»¥è¯å®java.lang.Cloneable#clone()æ–¹æ³•æ˜¯æµ…æ‹·è´ã€‚ æ·±æ‹·è´çš„å®ç°æ·±æ‹·è´åˆ™ä¸èƒ½ç®€å•çš„åœ¨é‡å†™çš„cloneæ–¹æ³•å†…ç›´æ¥è°ƒç”¨super.clone()ï¼Œéœ€è¦å°†å½“å‰ç±»çš„æ¯ä¸€ä¸ªå¼•ç”¨å¯¹è±¡éƒ½è¿›è¡Œæ‹·è´ï¼Œå¦‚æœå¼•ç”¨å¯¹è±¡è¿˜åŒ…å«å¼•ç”¨å¯¹è±¡ï¼Œåˆ™éœ€è¿›è¡Œå¤šå±‚æ‹·è´ã€‚ å½“å‰ç±»çš„æ¯ä¸€ä¸ªå¼•ç”¨å¯¹è±¡å‡éœ€å®ç°java.lang.Cloneableæ¥å£å¹¶é‡å†™å…¶cloneæ–¹æ³•ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹SunWuKongç±»çš„å¼•ç”¨å¯¹è±¡ï¼šLifeValueå’ŒManaã€‚ LifeValueä»£ç å®ç°ä¸ºï¼š 123456789101112131415161718package com.sunchaser.javase.base.cloneable;/** * è‹±é›„ç”Ÿå‘½å€¼ç±» * @author sunchaser * @date 2020/4/7 * @since 1.0 */public class LifeValue implements Cloneable { private Integer lifeValue; @Override protected Object clone() throws CloneNotSupportedException { return super.clone(); } ......} Manaä»£ç å®ç°ä¸ºï¼š 123456789101112131415161718package com.sunchaser.javase.base.cloneable;/** * è‹±é›„æ³•åŠ›å€¼ç±» * @author sunchaser * @date 2020/4/7 * @since 1.0 */public class Mana implements Cloneable { private Integer mana; @Override protected Object clone() throws CloneNotSupportedException { return super.clone(); } ......} æ­¤æ—¶SunWuKongç±»çš„cloneæ–¹æ³•å®ç°å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839package com.sunchaser.javase.base.cloneable;/** * è‹±é›„ï¼šå­™æ‚Ÿç©º * @author sunchaser * @date 2020/4/7 * @since 1.0 */public class SunWuKong implements LolHero,Cloneable { /** * åå­— */ private String name = &quot;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&quot;; /** * ç”Ÿå‘½å€¼ */ private LifeValue sunWuKongLifeValue; /** * æ³•åŠ›å€¼ */ private Mana sunWuKongMana; ...... @Override public Object clone() throws CloneNotSupportedException { SunWuKong clone = (SunWuKong) super.clone(); LifeValue lifeValueClone = (LifeValue) this.sunWuKongLifeValue.clone(); Mana manaClone = (Mana) this.sunWuKongMana.clone(); clone.setSunWuKongLifeValue(lifeValueClone); clone.setSunWuKongMana(manaClone); return clone; } ......} æˆ‘ä»¬å†æ¥çœ‹ä¸‹è¾“å‡ºç»“æœï¼š 123456SunWuKong{name='é½å¤©å¤§åœ£-å­™æ‚Ÿç©º', sunWuKongLifeValue=LifeValue{lifeValue=1000}, sunWuKongMana=Mana{mana=2000}}SunWuKong{name='é½å¤©å¤§åœ£-å­™æ‚Ÿç©º', sunWuKongLifeValue=LifeValue{lifeValue=1000}, sunWuKongMana=Mana{mana=2000}}falseSunWuKong{name='é½å¤©å¤§åœ£-å­™æ‚Ÿç©º', sunWuKongLifeValue=LifeValue{lifeValue=1000}, sunWuKongMana=Mana{mana=2000}}SunWuKong{name='é½å¤©å¤§åœ£-å­™æ‚Ÿç©º', sunWuKongLifeValue=LifeValue{lifeValue=999}, sunWuKongMana=Mana{mana=2000}}false æ›¿èº«å¯¹è±¡å—åˆ°æ”»å‡»åï¼ŒåŸå¯¹è±¡ç”Ÿå‘½å€¼ä¸å˜ï¼Œæ›¿èº«å¯¹è±¡ç”Ÿå‘½å€¼å‡å°‘ã€‚è¿™å°±æ˜¯æ·±æ‹·è´çš„å®ç°ã€‚ æ€»ç»“æ·±æ‹·è´è¦æ±‚è¢«æ‹·è´çš„ç±»çš„æ¯ä¸€ä¸ªå¼•ç”¨å¯¹è±¡éƒ½å®ç°java.lang.Cloneableæ¥å£å¹¶å®ç°cloneæ–¹æ³•ï¼Œæ‰€ä»¥å½“éœ€è¦å®ç°æ·±æ‹·è´æ—¶ï¼Œéœ€è¦è¿›è¡Œå¯¹è±¡åŠŸèƒ½çš„å…¨é¢è€ƒè™‘ï¼Œç‰¹åˆ«æ˜¯å½“å¼•ç”¨å¯¹è±¡è¿˜åŒ…å«å¼•ç”¨å¯¹è±¡çš„å¤šå±‚åµŒå¥—æ—¶ï¼Œéœ€è¦ç»“åˆå¯¹è±¡çš„åŠŸèƒ½è¿›è¡Œè€ƒè™‘ã€‚ æœ¬ç¯‡æ–‡ç« æ‰€æœ‰æºä»£ç åœ°å€ï¼šä¼ é€é—¨","link":"/2020/04/26/javase/base/depth-shallow-copy/"},{"title":"JDKæºç è§£æä¹‹RandomAccess","text":"ç®€ä»‹è¯¥æ¥å£æ˜¯Listå®ç°ä½¿ç”¨çš„æ ‡è®°å‹æ¥å£ï¼Œè¡¨æ˜å®ƒä»¬æ”¯æŒå¿«é€Ÿï¼ˆé€šå¸¸æ˜¯æ’å®šæ—¶é—´ï¼‰éšæœºè®¿é—®ã€‚æ­¤æ¥å£çš„ä¸»è¦ç›®çš„æ˜¯å…è®¸é€šç”¨ç®—æ³•æ›´æ”¹å…¶è¡Œä¸ºï¼Œä»¥åº”ç”¨äºéšæœºè®¿é—®åˆ—è¡¨æˆ–é¡ºåºè®¿é—®åˆ—è¡¨æ—¶æä¾›è‰¯å¥½çš„æ€§èƒ½ã€‚ å½“åº”ç”¨äºé¡ºåºè®¿é—®åˆ—è¡¨ï¼ˆä¾‹å¦‚LinkedListï¼‰æ—¶ï¼Œç”¨äºæ“çºµéšæœºè®¿é—®åˆ—è¡¨ï¼ˆä¾‹å¦‚ArrayListï¼‰çš„æœ€ä½³ç®—æ³•ä¼šäº§ç”ŸäºŒæ¬¡è¡Œä¸ºã€‚é¼“åŠ±ä½¿ç”¨é€šç”¨åˆ—è¡¨ç®—æ³•ï¼Œå…ˆæ£€æŸ¥ç»™å®šåˆ—è¡¨æ˜¯å¦ä¸ºè¯¥æ¥å£çš„å®ä¾‹ï¼Œç„¶åå†åº”ç”¨ä¸€ç§ç®—æ³•ï¼ˆå¦‚æœå°†å…¶åº”ç”¨äºé¡ºåºè®¿é—®åˆ—è¡¨åˆ™æ€§èƒ½è¾ƒå·®ï¼‰ï¼Œå¹¶åœ¨å¿…è¦æ—¶æ›´æ”¹å…¶è¡Œä¸ºä»¥ä¿è¯å¯æ¥å—çš„æ€§èƒ½ã€‚ å…¬è®¤çš„æ˜¯ï¼Œéšæœºè®¿é—®å’Œé¡ºåºè®¿é—®ä¹‹é—´çš„åŒºåˆ«é€šå¸¸æ˜¯æ¨¡ç³Šçš„ã€‚ä¾‹å¦‚ï¼ŒæŸäº›Listå®ç°åœ¨å˜å¾—åºå¤§çš„æƒ…å†µä¸‹æä¾›æ¸è¿›çº¿æ€§çš„è®¿é—®æ—¶é—´ï¼Œä½†å®é™…ä¸Šå´æ˜¯æ’å®šçš„è®¿é—®æ—¶é—´ã€‚è¿™æ ·çš„Listå®ç°é€šå¸¸åº”è¯¥å®ç°æ­¤æ¥å£ã€‚æ ¹æ®ç»éªŒï¼Œå¦‚æœæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œåˆ™Listå®ç°åº”å®ç°æ­¤æ¥å£ï¼š å¯¹äºç±»çš„å…¸å‹å®ä¾‹ï¼Œæ­¤å¾ªç¯ï¼š 12for (int i=0, n=list.size(); i &lt; n; i++) list.get(i); æ¯”è¿™ä¸ªå¾ªç¯è¿è¡Œæ›´å¿«ï¼š 12for (Iterator i=list.iterator(); i.hasNext(); ) i.next(); ArrayListæ•ˆç‡æ¯”è¾ƒArrayListå®ç°äº†RandomAccessæ¥å£ï¼Œæ ¹æ®RandomAccessæ¥å£å®šä¹‰ï¼Œä½¿ç”¨foriå¾ªç¯éå†æ¯”è¿­ä»£å™¨éå†æ›´å¿«ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¿›è¡ŒéªŒè¯ã€‚ åˆ›å»ºä¸€ä¸ªArrayListé›†åˆå¹¶å¡«å……ä¸€åƒä¸‡ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«ä½¿ç”¨foriå¾ªç¯å’Œè¿­ä»£å™¨è¿›è¡Œéå†ï¼Œè®¡ç®—å…¶è¿è¡Œæ—¶é—´ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334package com.sunchaser.javase.base.randomaccess;import java.util.*;/** * éšæœºè®¿é—®å’Œè¿­ä»£å™¨è®¿é—®æ•ˆç‡æ¯”è¾ƒ * @author sunchaser * @date 2020/4/26 * @since 1.0 */public class RandomIteratorCompare { public static void main(String[] args) { // init list data List&lt;String&gt; list = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10000000; i++) { list.add(String.valueOf(i)); } // random access long randomStartTime = System.currentTimeMillis(); for (int i = 0,size = list.size(); i &lt; size; i++) { list.get(i); } long randomEndTime = System.currentTimeMillis(); System.out.println(&quot;random access:&quot; + (randomEndTime - randomStartTime)); // sequential access long sequentialStartTime = System.currentTimeMillis(); Iterator&lt;String&gt; iterator = list.iterator(); while (iterator.hasNext()) { iterator.next(); } long sequentialEndTime = System.currentTimeMillis(); System.out.println(&quot;sequential access:&quot; + (sequentialEndTime - sequentialStartTime)); }} è¿è¡Œè¾“å…¥ï¼š 12random access:6sequential access:11 ç»“æœæ˜¾è€Œæ˜“è§ï¼ŒArrayListä½¿ç”¨è¿­ä»£å™¨éå†æ•ˆç‡ç•¥ä½äºforiéå†ã€‚ LinkedListæ•ˆç‡æ¯”è¾ƒå½“åº”ç”¨äºLinkedListæ—¶ï¼Œç”¨äºæ“çºµArrayListçš„æœ€ä½³ç®—æ³•ï¼ˆforiå¾ªç¯éå†ï¼‰ä¼šäº§ç”ŸäºŒæ¬¡è¡Œä¸ºã€‚ListedListæœªå®ç°RandomAccessæ¥å£ã€‚ æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªLinkedListï¼Œå¯¹å…¶å¡«å……å…ƒç´ å¹¶åˆ†åˆ«ä½¿ç”¨foriå¾ªç¯å’Œè¿­ä»£å™¨è¿›è¡Œéå†ã€‚ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920// init LinkedList dataList&lt;String&gt; linkedList = new LinkedList&lt;&gt;();for (int i = 0; i &lt; 100000; i++) { linkedList.add(String.valueOf(i));}// random accesslong linkedListRandomStartTime = System.currentTimeMillis();for (int i = 0,size = linkedList.size(); i &lt; size; i++) { linkedList.get(i);}long linkedListRandomEndTime = System.currentTimeMillis();System.out.println(&quot;random access:&quot; + (linkedListRandomEndTime - linkedListRandomStartTime));// sequential accesslong linkedListSequentialStartTime = System.currentTimeMillis();Iterator&lt;String&gt; linkedListIterator = arrayList.iterator();while (linkedListIterator.hasNext()) { linkedListIterator.next();}long linkedListSequentialEndTime = System.currentTimeMillis();System.out.println(&quot;sequential access:&quot; + (linkedListSequentialEndTime - linkedListSequentialStartTime)); è¿è¡Œåæ§åˆ¶å°è¾“å‡ºï¼š 12random access:11031sequential access:10 å¯ä»¥çœ‹åˆ°ï¼Œforiå¾ªç¯éå†æ‰€è€—è´¹çš„æ—¶é—´å·²ç»è¿œè¿œè¶…è¿‡äº†è¿­ä»£å™¨éå†ï¼Œè¿™è¯´æ˜é€‚ç”¨äºArrayListçš„æœ€ä½³ç®—æ³•ä¸å†é€‚ç”¨äºLinkedListï¼Œè¿™ä¸é›†åˆçš„å†…éƒ¨æ•°æ®ç»“æ„å’Œgetæ–¹æ³•å®ç°æœ‰å…³ã€‚ æ€»ç»“å®ç°äº†RandomAccessæ¥å£çš„ArrayListä½¿ç”¨foriå¾ªç¯éå†æ•ˆç‡æ›´é«˜ï¼Œè€ŒLinkedListä½¿ç”¨è¿­ä»£å™¨éå†æ•ˆç‡æé«˜ã€‚","link":"/2020/04/26/javase/base/randomaccess/"},{"title":"JDKæºç è§£æä¹‹Serializable","text":"å‰è¨€ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Ÿ åºåˆ—åŒ–ï¼šå°†å¯¹è±¡çš„äºŒè¿›åˆ¶æ•°æ®æµå†™å…¥ç¡¬ç›˜ï¼ˆæˆ–ç”¨äºç½‘ç»œä¼ è¾“ï¼‰ï¼› ååºåˆ—åŒ–ï¼šä»ç¡¬ç›˜ï¼ˆç½‘ç»œï¼‰ä¸­å°†å¯¹è±¡çš„äºŒè¿›åˆ¶æ•°æ®æµè¯»å–å‡ºæ¥è½¬åŒ–æˆå¯¹è±¡ã€‚ ç®€ä»‹å®ç°äº†java.io.serializableæ ‡è®°æ€§æ¥å£çš„ç±»æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œå¯åºåˆ—åŒ–ç±»çš„æ‰€æœ‰å­ç±»å‹éƒ½æ˜¯å¯åºåˆ—åŒ–çš„ã€‚ æºç 12public interface Serializable {} åœ¨Javaä¸­åºåˆ—åŒ–æ¥å£æ˜¯ä¸€ä¸ªç©ºæ¥å£ï¼Œä»…ç”¨äºæ ‡è®°å¯åºåˆ—åŒ–çš„è¯­ä¹‰ã€‚ åºåˆ—åŒ–UIDå­—æ®µï¼šserialVersionUIDå®ç°äº†java.io.Serializableæ¥å£çš„ç±»ï¼Œå¦‚æœæœªæ˜¾å¼è¿›è¡Œå£°æ˜ï¼Œåœ¨ç¼–è¯‘æœŸJVMå°†ä½¿ç”¨è‡ªå·±çš„ç®—æ³•ç”Ÿæˆé»˜è®¤çš„serialVersionUIDå­—æ®µã€‚ é»˜è®¤çš„serialVersionUIDç”Ÿæˆç®—æ³•å¯¹ç±»çš„è¯¦ç»†ä¿¡æ¯éå¸¸æ•æ„Ÿï¼Œå› ä¸åŒçš„JVMå®ç°è€Œå¼‚ï¼Œå¹¶ä¸”åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šå¯èƒ½ä¼šå¯¼è‡´æ„å¤–çš„java.io.InvalidClassExceptionå¼‚å¸¸ã€‚ å½“è¿›è¡Œåºåˆ—åŒ–æ“ä½œæ—¶ï¼Œä¼šå°†æ­¤serialVersionUIDåºåˆ—åŒ–è¿›äºŒè¿›åˆ¶æµä¸­ï¼› å½“è¿›è¡Œååºåˆ—åŒ–æ“ä½œæ—¶ï¼Œå¦‚æœç”¨æ¥æ¥æ”¶å¯¹è±¡çš„ç±»ä¸­çš„serialVersionUIDå­—æ®µå€¼ä¸åºåˆ—åŒ–æ—¶çš„å€¼ä¸ä¸€è‡´ï¼Œä¼šå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥ã€‚ ä»£ç æ¼”ç¤ºé¦–å…ˆåˆ›å»ºä¸€ä¸ªç”¨æ¥åºåˆ—åŒ–æµ‹è¯•çš„ç±»SerializableClassï¼Œå¹¶å®ç°åºåˆ—åŒ–æ¥å£ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142package com.sunchaser.javase.base.serizlizable;import java.io.Serializable;/** * åºåˆ—åŒ–ç±» * @author sunchaser * @date 2020/3/19 * @since 1.0 */public class SerializableClass implements Serializable { private static final long serialVersionUID = 5135631042912401553L; private String name; private Integer age; public String getName() { return name; } public SerializableClass setName(String name) { this.name = name; return this; } public Integer getAge() { return age; } public SerializableClass setAge(Integer age) { this.age = age; return this; } @Override public String toString() { final StringBuilder sb = new StringBuilder(&quot;SerializableClass{&quot;); sb.append(&quot;name='&quot;).append(name).append('\\''); sb.append(&quot;, age=&quot;).append(age); sb.append('}'); return sb.toString(); }} æ¥ä¸‹æ¥åˆ›å»ºæµ‹è¯•ç±»æ¥è¿›è¡Œåºåˆ—åŒ–ã€‚é¦–å…ˆåœ¨å½“å‰ç±»æ‰€åœ¨åŒ…ä¸­åˆ›å»ºserializableClass.txtæ–‡ä»¶ã€‚ä¹‹åæˆ‘ä»¬åºåˆ—åŒ–å†™å¯¹è±¡å†™å…¥è¯¥æ–‡ä»¶ä¸­ï¼Œååºåˆ—åŒ–ä»è¯¥æ–‡ä»¶ä¸­è¯»å¯¹è±¡ã€‚ ä½¿ç”¨ä»¥ä¸‹ä»£ç å³å¯è·å–txtæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼š 123// è·å–å½“å‰ç±»æ‰€åœ¨åŒ…ä¸­çš„serializableClass.txtæ–‡ä»¶è·¯å¾„String path = SerializableTest.class.getResource(&quot;&quot;).getPath();path = path.replace(&quot;target/classes&quot;,&quot;src/main/java&quot;) + &quot;serializableClass.txt&quot;; æ¥ä¸‹æ¥åˆ›å»ºç”¨æ¥åºåˆ—åŒ–çš„å¯¹è±¡ï¼š 1SerializableClass sc = new SerializableClass().setName(&quot;åºåˆ—åŒ–&quot;).setAge(10); ç„¶åæˆ‘ä»¬åˆ›å»ºåºåˆ—åŒ–çš„æ–¹æ³•writeObjectï¼Œå°†å¯¹è±¡å’Œtxtæ–‡ä»¶ç»å¯¹è·¯å¾„ä¼ å…¥è¿›è¡Œå†™å¯¹è±¡æ“ä½œï¼š 12345678910111213141516171819202122private static void writeObject(SerializableClass sc,String path) { FileOutputStream fos = null; ObjectOutputStream ops = null; try { fos = new FileOutputStream(path); ops = new ObjectOutputStream(fos); ops.writeObject(sc); } catch (Exception e) { e.printStackTrace(); } finally { try { if (ops != null) { ops.close(); } if (fos != null) { fos.close(); } } catch (IOException e) { e.printStackTrace(); } }} åœ¨mainæ–¹æ³•ä¸­è°ƒç”¨å³å¯å°†å¯¹è±¡å†™å…¥æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œå¯æ‰“å¼€æ–‡æœ¬æ–‡ä»¶æŸ¥çœ‹ï¼ˆæœ‰ç‚¹ä¹±ç ï¼‰ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥åˆ›å»ºååºåˆ—åŒ–çš„æ–¹æ³•readObjectï¼Œå°†æ–‡æœ¬æ–‡ä»¶è·¯å¾„ä¼ å…¥è¿›è¡Œè¯»å¯¹è±¡æ“ä½œï¼š 1234567891011121314151617181920212223private static void readObject(String path) { FileInputStream fis = null; ObjectInputStream ois = null; try { fis = new FileInputStream(path); ois = new ObjectInputStream(fis); SerializableClass sc = (SerializableClass) ois.readObject(); System.out.println(sc); } catch (Exception e) { e.printStackTrace(); } finally { try { if (ois != null) { ois.close(); } if (fis != null) { fis.close(); } } catch (IOException e) { e.printStackTrace(); } }} è°ƒç”¨è¯¥æ–¹æ³•åå¯åœ¨æ§åˆ¶å°çœ‹åˆ°å¯¹è±¡æ‰“å°ï¼š 1SerializableClass{name='åºåˆ—åŒ–', age=10} ååºåˆ—åŒ–å¤±è´¥æ¼”ç¤ºå…ˆè°ƒç”¨writeObjectæ–¹æ³•å°†å¯¹è±¡åºåˆ—åŒ–å†™å…¥æ–‡æœ¬æ–‡ä»¶ï¼Œç„¶åå»ä¿®æ”¹SerializableClassçš„serialVersionUIDå­—æ®µçš„å€¼ï¼Œå†å»è°ƒç”¨readObjectæ–¹æ³•ä»æ–‡æœ¬æ–‡ä»¶ä¸­ååºåˆ—åŒ–è¯»å¯¹è±¡ã€‚è¿™æ—¶ååºåˆ—åŒ–å°±ä¼šå¤±è´¥ï¼Œå¹¶æŠ›å‡ºjava.io.InvalidClassExceptionå¼‚å¸¸ã€‚ ä¸»è¦å¼‚å¸¸å †æ ˆä¿¡æ¯å¦‚ä¸‹ï¼š 123java.io.InvalidClassException: com.sunchaser.javase.base.serizlizable.SerializableClass; local class incompatible: stream classdesc serialVersionUID = 5135632042912401553, local class serialVersionUID = 5135631042912401553 IDEAä¸­ç”ŸæˆserialVersionUIDæ‰“å¼€IDEAï¼Œé€‰æ‹©File-&gt;Settings-&gt;Editor-&gt;Inspectionsï¼Œåœ¨æœç´¢æ¡†ä¸­è¾“å…¥serialVersionUIDï¼Œæ‰¾åˆ°Serializable class without 'serialVersionUID'ï¼Œè¿›è¡Œå‹¾é€‰ï¼Œç‚¹å‡»apply-&gt;OKè¿›è¡Œä¿å­˜ã€‚ è®¾ç½®ä¹‹åå¦‚æœå®ç°äº†Serializableæ¥å£çš„ç±»æœªå®šä¹‰serialVersionUIDå­—æ®µï¼Œåˆ™ç±»åå¤„ä¼šæœ‰é»„è‰²è­¦å‘Šï¼Œè¾“å…¥å…‰æ ‡ç§»åŠ¨è‡³ç±»åå¤„æŒ‰ä¸‹å¿«æ·é”®alt+enterä¼šæœ‰ç”ŸæˆserialVersionUIDçš„å¿«æ·æ–¹å¼ã€‚ æ€»ç»“æœ¬æ–‡å®Œæ•´ä»£ç åœ°å€ï¼šä¼ é€é—¨ Serializableæ¥å£å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œå®ç°äº†è¯¥æ¥å£çš„ç±»æ‰å…è®¸è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œè€ŒserialVersionUIDå­—æ®µåˆ™åƒæ˜¯ä¸€ä¸ªâ€œç‰ˆæœ¬å·â€ï¼Œåºåˆ—åŒ–æ—¶å°†è¯¥å­—æ®µä¸€èµ·å­˜è‡³äºŒè¿›åˆ¶æµä¸­ï¼Œååºåˆ—åŒ–æ—¶ç”¨è¯¥å­—æ®µæ¥åˆ¤æ–­æ˜¯å¦æ˜¯å­˜è¿›å»æ—¶çš„çŠ¶æ€ã€‚å®ƒçš„ä½œç”¨å…¶å®å°±æ˜¯åˆ¤æ–­ååºåˆ—åŒ–å‡ºæ¥çš„å¯¹è±¡æ˜¯ä¸æ˜¯åŸæ¥åºåˆ—åŒ–çš„å¯¹è±¡ã€‚","link":"/2020/03/21/javase/base/serializable/"},{"title":"ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–å¤±è´¥ä»»åŠ¡ç®¡ç†ä¸­å¿ƒ","text":"è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æ—¶ä¸»è¦æ‰§è¡Œäº†XxlJobScheduler.init()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ‰å…­ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼Œè¿™ç¯‡æ–‡ç« æ¥åˆ†æç¬¬ä¸‰ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼šåˆå§‹åŒ–å¤±è´¥ä»»åŠ¡ç®¡ç†ä¸­å¿ƒã€‚å…¶å…³é”®è°ƒç”¨ä»£ç ä¸ºï¼šJobFailMonitorHelper.getInstance().start(); æºç åˆ†ææ¥çœ‹com.xxl.job.admin.core.thread.JobFailMonitorHelperç±»çš„æºç ã€‚ æˆå‘˜å˜é‡å…ˆçœ‹ç±»çš„ä¸»è¦æˆå‘˜å˜é‡ï¼š ç§æœ‰slf4jæ—¥å¿—å¯¹è±¡ï¼› ç§æœ‰é™æ€JobFailMonitorHelperç±»å®ä¾‹å¯¹è±¡ï¼šinstanceï¼› ç§æœ‰æˆå‘˜å˜é‡ï¼šThreadç±»å¯¹è±¡monitorThreadï¼› ç§æœ‰å¸ƒå°”å˜é‡toStopï¼Œåˆå§‹åŒ–ä¸ºfalseã€‚ æˆå‘˜æ–¹æ³• å®ä¾‹instanceçš„å…¬æœ‰é™æ€è®¿é—®å™¨getInstance()ï¼› å…¬æœ‰start()æ–¹æ³•ï¼› å…¬æœ‰toStop()æ–¹æ³•ã€‚ ç§æœ‰failAlarm()æ–¹æ³•ï¼Œç”¨äºå¤±è´¥å‘Šè­¦ã€‚ å…¶ä¸­å…¬æœ‰é™æ€è®¿é—®å™¨getInstance()å’Œç§æœ‰é™æ€JobFailMonitorHelperç±»å®ä¾‹å¯¹è±¡instanceå…±åŒå½¢æˆäº†é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ã€‚ start()æ–¹æ³•è§£æå¯ä»¥å‘ç°è¯¥ç±»çš„ä¸»è¦å®ç°æ˜¯åœ¨start()æ–¹æ³•ä¸­ï¼Œå…ˆæŠ˜å ä¸€äº›å®ç°æˆ‘ä»¬æ¥çœ‹ä¸‹æ•´ä½“ã€‚ ç»™ç§æœ‰æˆå‘˜å˜é‡Threadç±»å¯¹è±¡monitorThreadèµ‹å€¼ï¼Œå³åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼šå®ç°Runnableæ¥å£å¹¶é‡å†™å…¶runæ–¹æ³•ï¼› å°†å…¶è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼› è®¾ç½®çº¿ç¨‹åä¸ºï¼šxxl-job, admin JobFailMonitorHelperï¼› è°ƒç”¨çº¿ç¨‹çš„start()æ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚ è¿™å…¶å®æ˜¯ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ã€‚ æˆ‘ä»¬ç»§ç»­æ¥çœ‹å­çº¿ç¨‹é‡å†™çš„runæ–¹æ³•çš„å…·ä½“å®ç°ï¼š çœ‹èµ·æ¥å®ç°æœ‰ç‚¹é•¿ï¼Œæˆ‘ä»¬é€æ¸å°†å…¶æ‹†è§£æ¥åˆ†æã€‚ 1while (!toStop) { å¾ªç¯ï¼Œåˆ¤æ–­çš„æ¡ä»¶ä¸ºç§æœ‰å¸ƒå°”å˜é‡toStopçš„éï¼Œè€ŒtoStopè¢«åˆå§‹åŒ–ä¸ºäº†falseï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ã€‚ 1List&lt;Long&gt; failLogIds = XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().findFailJobLogIds(1000); ä»é…ç½®â€œå®¹å™¨â€com.xxl.job.admin.core.conf.XxlJobAdminConfigå¯¹è±¡ä¸­æ‹¿åˆ°com.xxl.job.admin.dao.XxlJobLogDaoå¯¹è±¡ï¼Œè°ƒç”¨findFailJobLogIds(1000)æ–¹æ³•ã€‚è¿™æ˜¯MybatisæŒä¹…å±‚çš„æ–¹æ³•ï¼Œæ¥çœ‹ä¸€ä¸‹å…¶å®ç°ï¼š 123456789101112131415/* Mapperæ¥å£ */public List&lt;Long&gt; findFailJobLogIds(@Param(&quot;pagesize&quot;) int pagesize);/* xmlå®ç° */&lt;select id=&quot;findFailJobLogIds&quot; resultType=&quot;long&quot; &gt; SELECT id FROM `xxl_job_log` WHERE !( (trigger_code in (0, 200) and handle_code = 0) OR (handle_code = 200) ) AND `alarm_status` = 0 ORDER BY id ASC LIMIT #{pagesize}&lt;/select&gt; ä¼ å…¥çš„å‚æ•°pagesizeä¸º1000ï¼ŒSQLçš„æŸ¥è¯¢æ¡ä»¶ï¼šéï¼ˆè°ƒåº¦æˆåŠŸ æˆ– æ‰§è¡ŒæˆåŠŸï¼‰ã€‚ æ‰€ä»¥æ­¤å¤„å®é™…ä¸Šå°±æ˜¯åˆ†é¡µæŸ¥è¯¢1000æ¡å¤±è´¥ä»»åŠ¡æ—¥å¿—è®°å½•çš„failLogIdsã€‚ å¦‚æœå­˜åœ¨å¤±è´¥çš„æ—¥å¿—è®°å½•åˆ™è¿›è¡Œéå†å¤„ç†ï¼Œæˆ‘ä»¬å¾€ä¸‹çœ‹å¤„ç†é€»è¾‘ï¼š 123456int lockRet = XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().updateAlarmStatus(failLogId, 0, -1);if (lockRet &lt; 1) { continue;}XxlJobLog log = XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().load(failLogId);XxlJobInfo info = XxlJobAdminConfig.getAdminConfig().getXxlJobInfoDao().loadById(log.getJobId()); è°ƒç”¨XxlJobLogDaoçš„updateAlarmStatusæ–¹æ³•ï¼Œæ¥çœ‹ä¸‹å…¶Mybatisçš„å®ç°ï¼š 12345678910public int updateAlarmStatus(@Param(&quot;logId&quot;) long logId, @Param(&quot;oldAlarmStatus&quot;) int oldAlarmStatus, @Param(&quot;newAlarmStatus&quot;) int newAlarmStatus);&lt;update id=&quot;updateAlarmStatus&quot; &gt; UPDATE xxl_job_log SET `alarm_status` = #{newAlarmStatus} WHERE `id`= #{logId} AND `alarm_status` = #{oldAlarmStatus}&lt;/update&gt; CASä¹è§‚é”çš„æ–¹å¼å°†alarm_statuså­—æ®µä»0æ›´æ–°ä¸º-1ã€‚ æ€è€ƒï¼šè¿™é‡Œä¸ºä»€ä¹ˆä½¿ç”¨ä¹è§‚é”ï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ çŒœæƒ³ï¼šæ”¯æŒè°ƒåº¦é›†ç¾¤éƒ¨ç½²ï¼Œé«˜å¯ç”¨ã€‚ å¦‚æœä¹è§‚é”â€œåŠ é”â€æˆåŠŸï¼Œåˆ™æ ¹æ®å¤±è´¥ä»»åŠ¡failLogIdåŠ è½½ä»»åŠ¡æ—¥å¿—ä¿¡æ¯å’Œä»»åŠ¡ä¿¡æ¯ã€‚ å¾—åˆ°äº†ä»»åŠ¡å¿…è¦ä¿¡æ¯åå°±å¯ä»¥è¿›è¡Œå¤„ç†äº†ï¼ŒåŒ…æ‹¬é‡è¯•æˆ–å‘Šè­¦ï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼š 123456if (log.getExecutorFailRetryCount() &gt; 0) { JobTriggerPoolHelper.trigger(log.getJobId(), TriggerTypeEnum.RETRY, (log.getExecutorFailRetryCount()-1), log.getExecutorShardingParam(), log.getExecutorParam()); String retryMsg = &quot;&lt;br&gt;&lt;br&gt;&lt;span style=\\&quot;color:#F39C12;\\&quot; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;+ I18nUtil.getString(&quot;jobconf_trigger_type_retry&quot;) +&quot;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; &lt;/span&gt;&lt;br&gt;&quot;; log.setTriggerMsg(log.getTriggerMsg() + retryMsg); XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().updateTriggerInfo(log);} åˆ¤æ–­æ—¥å¿—ä¿¡æ¯ä¸­æ‰§è¡Œå™¨å¤±è´¥é‡è¯•æ¬¡æ•°æ˜¯å¦ä»å¤§äºé›¶ï¼Œæ˜¯åˆ™è¿›è¡Œé‡è¯•ã€‚ é‡è¯•å³é‡æ–°è¿›è¡Œè°ƒåº¦ï¼Œè°ƒç”¨JobTriggerPoolHelperç±»çš„trigger()æ–¹æ³•ï¼Œä¼ å…¥äº†äº”ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ¥åˆ†åˆ«è§£é‡Šä¸€ä¸‹ï¼š log.getJobId()ï¼šä»»åŠ¡ä¿¡æ¯è¡¨è‡ªå¢ä¸»é”®ã€‚ TriggerTypeEnum.RETRYï¼šæ‰§è¡Œç±»å‹ï¼šé‡è¯•ã€‚ (log.getExecutorFailRetryCount()-1)ï¼šå½“å‰é‡è¯•æ¬¡æ•°å‡ä¸€ï¼Œè¿™é‡Œä¼ å…¥æ˜¯ä¸ºäº†æ‰§è¡Œæ—¶å­˜å…¥æ—¥å¿—è¡¨ï¼Œå½“å†æ¬¡å¤±è´¥æ—¶å¯ç¡®ä¿é‡è¯•æ¬¡æ•°ã€‚ log.getExecutorShardingParam()ï¼šæ‰§è¡Œå™¨åˆ†ç‰‡å‚æ•°ï¼ˆåˆ†ç‰‡ä»»åŠ¡ç”¨åˆ°ï¼‰ã€‚ log.getExecutorParam()ï¼šæ‰§è¡Œå™¨æ‰§è¡Œå‚æ•°ã€‚ å…³äºä»»åŠ¡è°ƒåº¦æ‰§è¡Œæœ¬ç¯‡æ–‡ç« ä¸åšè¯¦ç»†ä»‹ç»ï¼Œåªéœ€çŸ¥é“è¿™é‡Œè§¦å‘äº†ä»»åŠ¡æ‰§è¡Œï¼Œå¹¶å°†å‡ä¸€åçš„é‡è¯•æ¬¡æ•°å­˜å…¥äº†æ—¥å¿—ï¼Œè‹¥è¿™æ¬¡æ‰§è¡Œä»ç„¶å¤±è´¥ï¼Œåˆ™å¯è¢«é‡æ–°æŸ¥å‡ºå¹¶æ ¹æ®å‰©ä½™é‡è¯•æ¬¡æ•°è¿›è¡Œå¤„ç†ã€‚ é‡è¯•å®Œæˆåæ›´æ–°æœ¬æ¡è®°å½•çš„è°ƒåº¦æ—¥å¿—trigger_msgå­—æ®µã€‚ ç„¶åè¿›è¡Œå‘Šè­¦å¤„ç†ï¼Œæ— è®ºæ˜¯å¦æœ‰é‡è¯•éƒ½ä¼šè¿›è¡Œå‘Šè­¦å¤„ç†ã€‚ æˆ‘ä»¬æ¥çœ‹å‘Šè­¦çš„ä»£ç ï¼š 1234567891011121314int newAlarmStatus = 0; // å‘Šè­¦çŠ¶æ€ï¼š0-é»˜è®¤ã€-1=é”å®šçŠ¶æ€ã€1-æ— éœ€å‘Šè­¦ã€2-å‘Šè­¦æˆåŠŸã€3-å‘Šè­¦å¤±è´¥if (info!=null &amp;&amp; info.getAlarmEmail()!=null &amp;&amp; info.getAlarmEmail().trim().length()&gt;0) { boolean alarmResult = true; try { alarmResult = failAlarm(info, log); } catch (Exception e) { alarmResult = false; logger.error(e.getMessage(), e); } newAlarmStatus = alarmResult?2:3;} else { newAlarmStatus = 1;}XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().updateAlarmStatus(failLogId, -1, newAlarmStatus); åªæœ‰é…ç½®äº†å‘Šè­¦é‚®ç®±æ‰è¿›è¡Œå‘Šè­¦ï¼Œæ ¸å¿ƒé€»è¾‘æ˜¯è°ƒç”¨äº†ç§æœ‰æˆå‘˜æ–¹æ³•failAlarmï¼Œæ ¹æ®è°ƒç”¨æƒ…å†µå¾—åˆ°æ–°çš„å‘Šè­¦çŠ¶æ€ï¼Œæœ€åä½¿ç”¨CASçš„æ–¹å¼æ›´æ–°æ—¥å¿—è®°å½•è¡¨ï¼Œå°†alarm_statuså­—æ®µä»-1æ›´æ–°ä¸ºæ–°çš„å‘Šè­¦çŠ¶æ€ã€‚ æœ€åé˜»å¡å½“å‰å­çº¿ç¨‹10ç§’ï¼Œä¸€æ¬¡å¾ªç¯å°±ç»“æŸäº†ã€‚ è€Œç§æœ‰æˆå‘˜æ–¹æ³•failAlarmçš„ä¸»è¦é€»è¾‘æ˜¯å‘é€é‚®ä»¶ï¼Œè°ƒåº¦ä¸­å¿ƒxxl-job-adminé¡¹ç›®é…ç½®æ–‡ä»¶ä¸­å¯é…ç½®å‘Šè­¦å‘ä»¶é‚®ç®±ï¼ŒWebç®¡ç†åå°ç•Œé¢æ·»åŠ ä»»åŠ¡æ—¶å¯å¡«å†™å‘Šè­¦æ”¶ä»¶äººé‚®ç®±ã€‚è¯¥æ–¹æ³•æœ‰ä¸€è¡Œä»£ç å¦‚ä¸‹ï¼š 1Set&lt;String&gt; emailSet = new HashSet&lt;String&gt;(Arrays.asList(info.getAlarmEmail().split(&quot;,&quot;))); ä»è€Œå¾—çŸ¥åœ¨ç®¡ç†åå°ç•Œé¢æ·»åŠ ä»»åŠ¡æ—¶å¯å¡«å†™å¤šä¸ªå‘Šè­¦æ”¶ä»¶äººé‚®ç®±ï¼Œç”¨è‹±æ–‡é€—å·åˆ†éš”å³å¯ï¼Œä¼šè‡ªåŠ¨å»é‡ã€‚ æˆ‘ä»¬å¯åœ¨è¯¥æ–¹æ³•ä¸­å®ç°è‡ªå®šä¹‰çš„å‘Šè­¦æ–¹å¼ï¼Œä¾‹å¦‚é’‰é’‰æœºå™¨äººç­‰ã€‚ æ€»ç»“ç”¨ä»¥ä¸‹ä¸€å¼ å›¾æ¥å¯¹å¤±è´¥ä»»åŠ¡ç®¡ç†ä¸­å¿ƒè¿›è¡Œå½’çº³æ€»ç»“ã€‚","link":"/2020/03/03/middleware/xxl-job/job-fail-monitor/"},{"title":"ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³ç»­çº¦â€æœåŠ¡","text":"è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æ—¶ä¸»è¦æ‰§è¡Œäº†XxlJobScheduler.init()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ‰å…­ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼Œè¿™ç¯‡æ–‡ç« æ¥åˆ†æç¬¬äºŒä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼šåˆå§‹åŒ–æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³ç»­çº¦â€æœåŠ¡ã€‚å…¶å…³é”®è°ƒç”¨ä»£ç ä¸ºï¼šJobRegistryMonitorHelper.getInstance().start(); æºç åˆ†ææ¥çœ‹com.xxl.job.admin.core.thread.JobRegistryMonitorHelperç±»çš„æºç ã€‚ æˆå‘˜å˜é‡å…ˆçœ‹ç±»çš„æˆå‘˜å˜é‡ï¼š ç§æœ‰slf4jæ—¥å¿—å¯¹è±¡ï¼› ç§æœ‰é™æ€JobRegistryMonitorHelperç±»å®ä¾‹å¯¹è±¡ï¼šinstanceï¼› ç§æœ‰æˆå‘˜å˜é‡ï¼šThreadç±»å¯¹è±¡registryThreadï¼› ç§æœ‰å¸ƒå°”å˜é‡toStopï¼Œåˆå§‹åŒ–ä¸ºfalseã€‚ æˆå‘˜æ–¹æ³• å®ä¾‹instanceçš„å…¬æœ‰é™æ€è®¿é—®å™¨getInstance()ï¼› å…¬æœ‰start()æ–¹æ³•ï¼› å…¬æœ‰toStop()æ–¹æ³•ã€‚ å…¶ä¸­å…¬æœ‰é™æ€è®¿é—®å™¨getInstance()å’Œç§æœ‰é™æ€JobRegistryMonitorHelperç±»å®ä¾‹å¯¹è±¡instanceå…±åŒå½¢æˆäº†é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ã€‚ start()æ–¹æ³•è§£æå¯ä»¥å‘ç°è¯¥ç±»çš„ä¸»è¦å®ç°æ˜¯åœ¨start()æ–¹æ³•ä¸­ï¼Œå…ˆæŠ˜å ä¸€äº›å®ç°æˆ‘ä»¬æ¥çœ‹ä¸‹æ•´ä½“ã€‚ ç»™ç§æœ‰æˆå‘˜å˜é‡Threadç±»å¯¹è±¡registryThreadèµ‹å€¼ï¼Œå³åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼šå®ç°Runnableæ¥å£å¹¶é‡å†™å…¶runæ–¹æ³•ï¼› å°†å…¶è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼› è®¾ç½®çº¿ç¨‹åä¸ºï¼šxxl-job, admin JobRegistryMonitorHelperï¼› è°ƒç”¨çº¿ç¨‹çš„start()æ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚ è¿™å…¶å®æ˜¯ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ã€‚ æˆ‘ä»¬ç»§ç»­æ¥çœ‹å­çº¿ç¨‹é‡å†™çš„runæ–¹æ³•çš„å…·ä½“å®ç°ï¼š çœ‹èµ·æ¥å®ç°æœ‰ç‚¹é•¿ï¼Œæˆ‘ä»¬é€æ¸å°†å…¶æ‹†è§£æ¥åˆ†æã€‚ 1while (!toStop) { å¾ªç¯ï¼Œåˆ¤æ–­çš„æ¡ä»¶ä¸ºç§æœ‰å¸ƒå°”å˜é‡toStopçš„éï¼Œè€ŒtoStopè¢«åˆå§‹åŒ–ä¸ºäº†falseï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ã€‚ 1List&lt;XxlJobGroup&gt; groupList = XxlJobAdminConfig.getAdminConfig().getXxlJobGroupDao().findByAddressType(0); ä»é…ç½®â€œå®¹å™¨â€com.xxl.job.admin.core.conf.XxlJobAdminConfigå¯¹è±¡ä¸­æ‹¿åˆ°com.xxl.job.admin.dao.XxlJobGroupDaoå¯¹è±¡ï¼Œè°ƒç”¨findByAddressType(0)æ–¹æ³•ã€‚è¿™æ˜¯MybatisæŒä¹…å±‚çš„æ–¹æ³•ï¼Œæ¥çœ‹ä¸€ä¸‹å…¶å®ç°ï¼š 12345678910/* Mapperæ¥å£ */public List&lt;XxlJobGroup&gt; findByAddressType(@Param(&quot;addressType&quot;) int addressType);/* xmlå®ç° */&lt;select id=&quot;findByAddressType&quot; parameterType=&quot;java.lang.Integer&quot; resultMap=&quot;XxlJobGroup&quot;&gt; SELECT &lt;include refid=&quot;Base_Column_List&quot; /&gt; FROM xxl_job_group AS t WHERE t.address_type = #{addressType} ORDER BY t.order ASC&lt;/select&gt; ä¼ å…¥çš„å‚æ•°addressTypeä¸º0ï¼ŒSQLçš„å«ä¹‰ä¸ºï¼šæŸ¥è¯¢xxl_job_groupè¡¨ä¸­address_typeå­—æ®µä¸º0çš„æ•°æ®å¹¶æŒ‰orderå­—æ®µå‡åºæ’åºã€‚ æˆ‘ä»¬å¯ä»¥å»åˆå§‹åŒ–sqlè„šæœ¬ä¸­å¯»æ‰¾è¯¥å­—æ®µçš„å«ä¹‰ï¼šæ‰§è¡Œå™¨åœ°å€ç±»å‹ï¼š0=è‡ªåŠ¨æ³¨å†Œã€1=æ‰‹åŠ¨å½•å…¥ã€‚ æ‰€ä»¥æ­¤å¤„ä»£ç çš„ä½œç”¨æ˜¯ï¼šæŸ¥è¯¢åœ°å€ç±»å‹ä¸ºè‡ªåŠ¨æ³¨å†Œçš„æ‰§è¡Œå™¨ä¿¡æ¯åˆ—è¡¨ã€‚ å¦‚æœæŸ¥è¯¢å‡ºçš„æ‰§è¡Œå™¨åˆ—è¡¨ä¸ä¸ºç©ºåˆ™ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ 123456List&lt;Integer&gt; ids = XxlJobAdminConfig.getAdminConfig() .getXxlJobRegistryDao() .findDead(RegistryConfig.DEAD_TIMEOUT, new Date());if (ids!=null &amp;&amp; ids.size()&gt;0) { XxlJobAdminConfig.getAdminConfig().getXxlJobRegistryDao().removeDead(ids);} è°ƒç”¨XxlJobRegistryDaoçš„findDeadæ–¹æ³•ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºï¼š RegistryConfig.DEAD_TIMEOUTï¼šè¶…æ—¶æ—¶é—´ï¼Œå€¼ä¸º90ï¼› new Date()ï¼šå½“å‰æ—¶é—´å¯¹è±¡ã€‚ æ¥çœ‹ä¸€ä¸‹Mybatisçš„å®ç°ï¼š 12345678public List&lt;Integer&gt; findDead(@Param(&quot;timeout&quot;) int timeout, @Param(&quot;nowTime&quot;) Date nowTime); &lt;select id=&quot;findDead&quot; parameterType=&quot;java.util.HashMap&quot; resultType=&quot;java.lang.Integer&quot; &gt; SELECT t.id FROM xxl_job_registry AS t WHERE t.update_time &lt;![CDATA[ &lt; ]]&gt; DATE_ADD(#{nowTime},INTERVAL -#{timeout} SECOND)&lt;/select&gt; æŸ¥è¯¢çš„æ˜¯ä¸»é”®idåˆ—è¡¨ï¼Œå…³é”®çš„æ˜¯whereæ¡ä»¶ï¼Œxxl_job_registryè¡¨çš„update_timeå­—æ®µå°äºä¼ å…¥çš„å½“å‰æ—¶é—´å‡å»ä¼ å…¥çš„è¶…æ—¶æ—¶é—´90ç§’ã€‚ å…¶å«ä¹‰ä¸ºï¼šæŸ¥è¯¢å‡º90ç§’å†…æœªæ›´æ–°æ—¶é—´çš„ä»»åŠ¡idé›†åˆåˆ—è¡¨ã€‚ æ€è€ƒï¼šè¿™é‡ŒæŸ¥è¯¢æ—¶ä¸ºä»€ä¹ˆé€‰æ‹©ä¼ å…¥Javaæ—¶é—´è€Œä¸æ˜¯ç›´æ¥ç”¨MySQLçš„NOW()å‡½æ•°è·å–å½“å‰æ—¶é—´ï¼Ÿ è§£ç­”ï¼šé˜²æ­¢MySQLæœåŠ¡å™¨å’Œè°ƒåº¦ä¸­å¿ƒæœåŠ¡å™¨çš„æ—¶é’Ÿä¸åŒæ­¥ã€‚ å¦‚æœæŸ¥åˆ°äº†è®°å½•ï¼Œåˆ™è°ƒç”¨XxlJobRegistryDaoçš„removeDeadæ–¹æ³•ã€‚æ¥çœ‹ä¸‹å…¶Mybatiså®ç°ï¼š 123456789public int removeDead(@Param(&quot;ids&quot;) List&lt;Integer&gt; ids); &lt;delete id=&quot;removeDead&quot; parameterType=&quot;java.lang.Integer&quot; &gt; DELETE FROM xxl_job_registry WHERE id in &lt;foreach collection=&quot;ids&quot; item=&quot;item&quot; open=&quot;(&quot; close=&quot;)&quot; separator=&quot;,&quot; &gt; #{item} &lt;/foreach&gt;&lt;/delete&gt; åˆ é™¤ä»»åŠ¡idåˆ—è¡¨å¯¹åº”çš„xxl_job_registryè®°å½•ã€‚ çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åº”è¯¥ç†è§£åˆ°è¿™å®é™…ä¸Šæ˜¯â€œå¿ƒè·³â€æœºåˆ¶ã€‚â€œå¿ƒè·³â€çš„æœ€é•¿æ—¶é—´é—´éš”ä¸º90ç§’ã€‚ ç»§ç»­å¾€ä¸‹çœ‹ï¼Œåˆå§‹åŒ–äº†ä¸€ä¸ªå±€éƒ¨HashMapå¯¹è±¡ï¼š 1234HashMap&lt;String, List&lt;String&gt;&gt; appAddressMap = new HashMap&lt;String, List&lt;String&gt;&gt;();List&lt;XxlJobRegistry&gt; list = XxlJobAdminConfig.getAdminConfig() .getXxlJobRegistryDao() .findAll(RegistryConfig.DEAD_TIMEOUT, new Date()); éšå³è°ƒç”¨XxlJobRegistryDaoçš„findAllæ–¹æ³•æŸ¥è¯¢å‡ºäº†ä¸€ä¸ªList&lt;XxlJobRegistry&gt;é›†åˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹æŸ¥è¯¢æ¡ä»¶ï¼š 12345678public List&lt;XxlJobRegistry&gt; findAll(@Param(&quot;timeout&quot;) int timeout, @Param(&quot;nowTime&quot;) Date nowTime); &lt;select id=&quot;findAll&quot; parameterType=&quot;java.util.HashMap&quot; resultMap=&quot;XxlJobRegistry&quot;&gt; SELECT &lt;include refid=&quot;Base_Column_List&quot; /&gt; FROM xxl_job_registry AS t WHERE t.update_time &lt;![CDATA[ &gt; ]]&gt; DATE_ADD(#{nowTime},INTERVAL -#{timeout} SECOND)&lt;/select&gt; é‡ç‚¹æ˜¯whereæ¡ä»¶ï¼šæ›´æ–°æ—¶é—´update_timeå¤§äºå½“å‰æ—¶é—´å‡å»â€œæ­»äº¡â€è¶…æ—¶æ—¶é—´90ç§’ã€‚ å³ï¼šæŸ¥è¯¢ä¸Šæ¬¡â€œå¿ƒè·³â€æ—¶é—´åœ¨90ç§’ä»¥å†…çš„æ³¨å†Œåˆ—è¡¨ã€‚ å®é™…ä¸Šè¿™æ˜¯åœ¨åšæ‰§è¡Œå™¨â€œå¿ƒè·³â€ç»­çº¦ï¼Œç±»ä¼¼äºå¾®æœåŠ¡ä¸­çš„æœåŠ¡ç»­çº¦ã€‚ æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼š 123456789101112131415if (list != null) { for (XxlJobRegistry item: list) { if (RegistryConfig.RegistType.EXECUTOR.name().equals(item.getRegistryGroup())) { String appName = item.getRegistryKey(); List&lt;String&gt; registryList = appAddressMap.get(appName); if (registryList == null) { registryList = new ArrayList&lt;String&gt;(); } if (!registryList.contains(item.getRegistryValue())) { registryList.add(item.getRegistryValue()); } appAddressMap.put(appName, registryList); } }} å¦‚æœæŸ¥è¯¢åˆ°æœ‰æœªâ€œæ­»äº¡â€çš„æ³¨å†Œåˆ—è¡¨ï¼Œåˆ™å¯¹å…¶è¿›è¡Œâ€œç»­çº¦â€ï¼š éå†æŸ¥è¯¢å‡ºçš„æ³¨å†Œåˆ—è¡¨ã€‚ å¦‚æœæ³¨å†Œç»„ä¸ºæ‰§è¡Œå™¨ï¼ˆè¿™é‡Œæ³¨æ„åˆ°æšä¸¾RegistTypeæœ‰ä¸¤ä¸ªå€¼ï¼šEXECUTORï¼ˆæ‰§è¡Œå™¨ï¼‰å’ŒADMINï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰ï¼‰ã€‚ å–å‡ºæ³¨å†Œè¡¨çš„æ³¨å†Œé”®ï¼ˆxxl_job_registryè¡¨ä¸­çš„registry_keyå­—æ®µï¼‰ï¼šå³æ‰§è¡Œå™¨åç§°appNameã€‚ å…ˆå°è¯•ä»å±€éƒ¨mapå˜é‡ä¸­å–å‡ºè¯¥æ‰§è¡Œå™¨åç§°å¯¹åº”æ³¨å†Œåœ°å€é›†åˆï¼Œè‹¥æ²¡æœ‰åˆ™æ–°å»ºä¸€ä¸ªç©ºé›†åˆï¼ˆæ‡’åŠ è½½æ€æƒ³ï¼‰ã€‚ åˆ¤æ–­ä»mapä¸­å–å‡ºçš„æ³¨å†Œåœ°å€é›†åˆæ˜¯å¦åŒ…å«å½“å‰éå†çš„æ³¨å†Œè¡¨çš„æ³¨å†Œå€¼ï¼ˆxxl_job_registryè¡¨ä¸­çš„registry_valueå­—æ®µï¼‰ï¼Œè‹¥ä¸åŒ…å«åˆ™æ·»åŠ è‡³é›†åˆï¼ˆå»é‡ï¼‰ã€‚ å°†æ‰§è¡Œå™¨åç§°appNameå’Œæ³¨å†Œåœ°å€é›†åˆæ˜ å°„è‡³å±€éƒ¨mapå˜é‡ã€‚ æ˜ å°„è‡³å±€éƒ¨mapå˜é‡åï¼Œå¼€å§‹æ‰§è¡ŒçœŸæ­£çš„â€œç»­çº¦â€åŠ¨ä½œï¼š 1234567891011121314for (XxlJobGroup group: groupList) { List&lt;String&gt; registryList = appAddressMap.get(group.getAppName()); String addressListStr = null; if (registryList!=null &amp;&amp; !registryList.isEmpty()) { Collections.sort(registryList); addressListStr = &quot;&quot;; for (String item:registryList) { addressListStr += item + &quot;,&quot;; } addressListStr = addressListStr.substring(0, addressListStr.length()-1); } group.setAddressList(addressListStr); XxlJobAdminConfig.getAdminConfig().getXxlJobGroupDao().update(group);} éå†ä»xxl_job_groupè¡¨ä¸­æŸ¥è¯¢å‡ºçš„è‡ªåŠ¨æ³¨å†Œæ‰§è¡Œå™¨çš„ä¿¡æ¯åˆ—è¡¨ã€‚ ä»å±€éƒ¨mapå˜é‡ä¸­å–å‡ºå½“å‰éå†æ‰§è¡Œå™¨å¯¹åº”çš„â€œå¿ƒè·³ç»­çº¦â€æ³¨å†Œåœ°å€é›†åˆã€‚ ç»„è£…æ‰§è¡Œå™¨æ³¨å†Œåœ°å€åˆ—è¡¨ï¼Œå¤šåœ°å€é€—å·åˆ†éš”ï¼›å¦‚æœâ€œç»­çº¦â€çš„åœ°å€é›†åˆä¸ºç©ºï¼Œåˆ™ä»£è¡¨å½“å‰æ‰§è¡Œå™¨å·²â€œæ­»äº¡â€ã€‚ æ›´æ–°æ‰§è¡Œå™¨â€œç»­çº¦â€çš„åœ°å€ä¿¡æ¯è‡³DBï¼šæ›´æ–°xxl_job_groupè¡¨çš„address_listå­—æ®µã€‚ è‡³æ­¤ï¼Œä»»åŠ¡æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³â€æœºåˆ¶å°±å·²å®Œæˆã€‚ åˆ°è¿™é‡Œæˆ‘ä»¬æˆ–è®¸æœ‰äº†ä¸€ä¸ªç–‘é—®ï¼Ÿxxl_job_registryä»»åŠ¡æ³¨å†Œè¡¨çš„è®°å½•æ˜¯ä½•æ—¶å­˜åœ¨çš„ï¼Ÿå³ä»»åŠ¡æ˜¯ä½•æ—¶è¢«æ³¨å†Œçš„ï¼Ÿæˆ‘ä»¬ä¹Ÿè®¸ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­æœ‰æ‰€å‘ç°ã€‚ æœ€åï¼Œé˜»å¡å½“å‰å­çº¿ç¨‹30ç§’ã€‚ 1234567try { TimeUnit.SECONDS.sleep(RegistryConfig.BEAT_TIMEOUT);} catch (InterruptedException e) { if (!toStop) { logger.error(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job, job registry monitor thread error:{}&quot;, e); }} è¿™é‡Œè°ƒç”¨java.util.concurrentåŒ…ä¸‹çš„æšä¸¾TimeUnitç±»çš„sleepæ–¹æ³•è¿›è¡Œç¡çœ ï¼Œå…ˆæŒ‡å®šæ—¶é—´å•ä½ï¼Œå†æŒ‡å®šæ—¶é—´å¤§å°ï¼Œä»£ç å¯è¯»æ€§æ›´é«˜ï¼›å¦‚æœç›´æ¥ä½¿ç”¨ä¼ ç»ŸThread.sleep()æ–¹æ³•ï¼Œä¼ ç»™sleepæ–¹æ³•çš„å€¼çš„å•ä½æ˜¯æ¯«ç§’ï¼Œå³éœ€ä¼ å…¥30*1000ï¼Œä»£ç å¯è¯»æ€§ä¸é«˜ã€‚ æ€»ç»“ç”¨ä»¥ä¸‹ä¸€å‰¯å›¾æ¥å¯¹æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³ç»­çº¦â€æœåŠ¡è¿›è¡Œå½’çº³æ€»ç»“ã€‚","link":"/2020/02/29/middleware/xxl-job/registry-center-heartbeat-renewal/"},{"title":"ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–å›½é™…åŒ–ç»„ä»¶","text":"è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æ—¶ä¸»è¦æ‰§è¡Œäº†XxlJobScheduler.init()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ‰å…­ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼Œè¿™ç¯‡æ–‡ç« æ¥åˆ†æç¬¬ä¸€ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼šåˆå§‹åŒ–å›½é™…åŒ–ç»„ä»¶ã€‚å…¶å…³é”®è°ƒç”¨ä»£ç ä¸ºï¼šinitI18n(); å›½é™…åŒ–ç®€ä»‹å›½é™…åŒ–åˆç§°ä¸ºi18nï¼Œæ¥æºäºå›½é™…åŒ–çš„è‹±æ–‡å•è¯internationalizationä»iåˆ°nä¹‹é—´æœ‰18ä¸ªè‹±æ–‡å­—æ¯ã€‚ æºç åˆ†ææˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹initI18n()æ–¹æ³•çš„ä»£ç ï¼š 12345private void initI18n(){ for (ExecutorBlockStrategyEnum item:ExecutorBlockStrategyEnum.values()) { item.setTitle(I18nUtil.getString(&quot;jobconf_block_&quot;.concat(item.name()))); }} å¾ªç¯è¿­ä»£æšä¸¾com.xxl.job.core.enums.ExecutorBlockStrategyEnumï¼Œè¯¥æšä¸¾æ˜¯æ‰§è¡Œå™¨é˜»å¡ç­–ç•¥æšä¸¾ã€‚åªæœ‰ä¸€ä¸ªtitleå±æ€§ï¼Œæä¾›äº†ä¸‰ä¸ªæšä¸¾å¯¹è±¡ï¼š 12345678910public enum ExecutorBlockStrategyEnum { SERIAL_EXECUTION(&quot;Serial execution&quot;), /*CONCURRENT_EXECUTION(&quot;å¹¶è¡Œ&quot;),*/ DISCARD_LATER(&quot;Discard Later&quot;), COVER_EARLY(&quot;Cover Early&quot;); private String title;............ å¾ªç¯ä¸­è°ƒç”¨å˜å¼‚å™¨setTitle()æ–¹æ³•ç»™æ¯ä¸ªæšä¸¾å¯¹è±¡çš„titleå±æ€§é‡æ–°èµ‹å€¼ã€‚ å·¥å…·ç±»I18nUtilçš„getString()æ–¹æ³•è·å–åˆ°ä»¥jobconf_block_å¼€å¤´ï¼Œä»¥æšä¸¾å¯¹è±¡åç»“å°¾çš„å±æ€§å€¼ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å·¥å…·ç±»getString()æ–¹æ³•çš„å®ç°ï¼š 123public static String getString(String key) { return loadI18nProp().getProperty(key);} è°ƒç”¨äº†é™æ€æˆå‘˜æ–¹æ³•loadI18nProp()å¾—åˆ°ä¸€ä¸ªPropertieså¯¹è±¡ï¼Œå†è°ƒç”¨å…¶getProperty()æ–¹æ³•ä»èµ„æºæ–‡ä»¶ä¸­è·å–å¯¹åº”keyçš„å€¼ã€‚ æ¥çœ‹ä¸€ä¸‹loadI18nProp()æ–¹æ³•çš„å®ç°ï¼š è¯»å–application.propertiesé…ç½®æ–‡ä»¶çš„xxl.job.i18né…ç½®é¡¹çš„å€¼; buildç»„è£…ï¼Œå¾—åˆ°i18næ–‡ä»¶è·¯å¾„ã€‚å³resources\\i18nç›®å½•ä¸‹çš„Resource Bundle 'message'èµ„æºåŒ…æ–‡ä»¶; ä½¿ç”¨Springæä¾›çš„PropertiesLoaderUtilså·¥å…·ç±»åŠ è½½å¯¹åº”èµ„æºæ–‡ä»¶ã€‚ æˆ‘ä»¬å¯ä»¥ä»è¿™é‡ŒçŸ¥é“è°ƒåº¦ä¸­å¿ƒapplication.propertiesçš„é…ç½®é¡¹xxl.job.i18næœ‰ä¸¤ç§é…ç½®ï¼Œä¸€æ˜¯ç¼ºçœä¸å¡«ï¼Œä¸ºä¸­æ–‡ï¼›äºŒæ˜¯è®¾ç½®ä¸ºenï¼Œå³è‹±æ–‡ã€‚ å»resources\\i18nç›®å½•çœ‹ä¸‹èµ„æºåŒ…æ–‡ä»¶ï¼šmessage.propertieså’Œmessage_en.propertiesã€‚æœç´¢jobconf_block_ï¼Œå¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š message.propertiesï¼š 1234## job confjobconf_block_SERIAL_EXECUTION=å•æœºä¸²è¡Œjobconf_block_DISCARD_LATER=ä¸¢å¼ƒåç»­è°ƒåº¦jobconf_block_COVER_EARLY=è¦†ç›–ä¹‹å‰è°ƒåº¦ message_en.propertiesï¼š 1234## job confjobconf_block_SERIAL_EXECUTION=Serial executionjobconf_block_DISCARD_LATER=Discard Laterjobconf_block_COVER_EARLY=Cover Early å¯ä»¥å‘ç°é”®ä¸­jobconf_block_åæ¥çš„å†…å®¹å³ä¸ºExecutorBlockStrategyEnumæšä¸¾çš„nameå€¼ã€‚ä¸€å…±æœ‰ä¸‰ä¸ªé˜»å¡ç­–ç•¥ï¼šå•æœºä¸²è¡Œã€ä¸¢å¼ƒåç»­è°ƒåº¦å’Œè¦†ç›–ä¹‹å‰è°ƒåº¦ã€‚ initI18n()æ–¹æ³•çš„è¿­ä»£å®Œæˆåï¼Œæšä¸¾çš„titleå±æ€§å€¼å°±å˜æˆäº†å¯¹åº”çš„å›½é™…åŒ–è®¾ç½®ã€‚ æ€»ç»“è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯åˆ†æäº†è°ƒåº¦ä¸­å¿ƒå›½é™…åŒ–ç»„ä»¶çš„åˆå§‹åŒ–åŸç†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†ç»§ç»­åˆ†æè°ƒåº¦ä¸­å¿ƒå¯åŠ¨çš„å…¶å®ƒåˆå§‹åŒ–åŠ¨ä½œã€‚","link":"/2020/02/27/middleware/xxl-job/initI18n/"},{"title":"ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æµç¨‹è§£æ","text":"è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯è§£æè°ƒåº¦ä¸­å¿ƒxxl-job-adminå¯åŠ¨æµç¨‹ã€‚ å‡†å¤‡æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è°ƒåº¦ä¸­å¿ƒé¡¹ç›®çš„mavenä¾èµ–ã€‚ä¾èµ–äº†Spring Bootçš„ä¸€äº›starterä¾èµ–ï¼šwebã€testã€freemarkerã€mailã€actuatorå’Œmybatisç­‰ï¼Œæœ€åä¾èµ–äº†xxl-job-coreåŒ…ã€‚ è¿˜è®°å¾—æˆ‘ä»¬åœ¨ ä¿®ç‚¼xxl-jobä¹‹æ­å»ºæœ¬åœ°è°ƒåº¦å¹³å° æ—¶å¯åŠ¨è°ƒåº¦ä¸­å¿ƒè¿‡ç¨‹ä¸­æ§åˆ¶å°è¾“å‡ºçš„ä¸€å¥æ—¥å¿—å—ï¼Ÿ 113:01:40.001 logback [xxl-job, admin JobScheduleHelper#scheduleThread] INFO c.x.j.a.c.thread.JobScheduleHelper - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin scheduler success. JobScheduleHelperç±»æ‰“å°äº†&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin scheduler success.ã€‚è¡¨ç¤ºåˆå§‹åŒ–ä»»åŠ¡è°ƒåº¦å™¨æˆåŠŸã€‚ å¯åŠ¨åˆ†ææˆ‘ä»¬æ‰¾åˆ°com.xxl.job.admin.core.thread.JobScheduleHelperç±»ä¸­æ‰“å°å¯åŠ¨æ—¥å¿—çš„ä»£ç ï¼Œå‘ç°å…¶åœ¨è¯¥ç±»çš„startæ–¹æ³•ä¸­ï¼Œstartæ–¹æ³•åˆå§‹åŒ–äº†ä¸€ä¸ªå­çº¿ç¨‹ï¼Œåœ¨å­çº¿ç¨‹ä¸­æ‰“å°äº†æ—¥å¿—ã€‚ é‚£ä¹ˆè¯¥startæ–¹æ³•æ˜¯ä½•æ—¶è¢«æ‰§è¡Œçš„å‘¢ï¼Ÿæˆ‘ä»¬å‘ç°è¯¥ç±»å¹¶æœªäº¤ç”±Springç®¡ç†ï¼Œå€ŸåŠ©äºIDEAçš„å¿«æ·é”®Ctrl+Alt+HæŸ¥çœ‹è¯¥æ–¹æ³•çš„è°ƒç”¨å¤„ï¼Œå‘ç°å…¶åœ¨XxlJobScheduler.init()æ–¹æ³•ä¸­è¢«è°ƒç”¨äº†ï¼Œæ¥çœ‹ä¸€ä¸‹initæ–¹æ³•çš„ä»£ç ï¼š 123456789101112131415161718192021public void init() throws Exception { // init i18n initI18n(); // admin registry monitor run JobRegistryMonitorHelper.getInstance().start(); // admin monitor run JobFailMonitorHelper.getInstance().start(); // admin trigger pool start JobTriggerPoolHelper.toStart(); // admin log report start JobLogReportHelper.getInstance().start(); // start-schedule JobScheduleHelper.getInstance().start(); logger.info(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin success.&quot;);} JobScheduleHelper.getInstance().start();è¿™ä¸€è¡Œä»£ç ä½¿ç”¨â€œé¥¿æ±‰å¼â€å•ä¾‹æ¨¡å¼å¾—åˆ°JobScheduleHelperç±»å¯¹è±¡å¹¶éšä¹‹è°ƒç”¨äº†å…¶startæ–¹æ³•ï¼Œç„¶åæ‰“å°äº†ä¸€è¡Œæ—¥å¿—ï¼š&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin success.ã€‚ æ€è€ƒï¼šæ—¢ç„¶JobScheduleHelperç±»ä¸­çš„å­çº¿ç¨‹ä¸­çš„æ—¥å¿—éƒ½è¿›è¡Œäº†æ‰“å°ï¼Œé‚£ä¹ˆåœ¨å…¶ä¹‹åçš„æ—¥å¿—æ‰“å°åœ¨äº†ä½•å¤„å‘¢ï¼Ÿ æˆ‘ä»¬å¤åˆ¶ä»£ç ä¸­çš„æ—¥å¿—ä¿¡æ¯ï¼Œå‰å¾€è°ƒåº¦ä¸­å¿ƒå¯åŠ¨çš„æ§åˆ¶å°ä¸­æŒ‰ä¸‹Ctrl+Fæœç´¢ç›¸å…³ä¿¡æ¯ï¼Œå‘ç°ç¡®å®æ‰“å°äº†ï¼Œå¹¶ä¸”æ‰“å°çš„ä½ç½®éå¸¸é å‰ã€‚ å†æ¥çœ‹ä¸€ä¸‹init()æ–¹æ³•çš„å†™æ³•ï¼Œå‡ ä¹éƒ½æ˜¯è°ƒç”¨æŸä¸ªXxxxxHelperç±»çš„getInstance()æ–¹æ³•ç„¶åå†è°ƒç”¨å…¶start()æ–¹æ³•ã€‚ çŒœæƒ³ï¼šè¿™é‡Œæ‰€æœ‰çš„XxxxxHelperç±»çš„start()æ–¹æ³•éƒ½æ˜¯å¼€å¯å­çº¿ç¨‹æ‰§è¡Œç›¸å…³ä»»åŠ¡ï¼Œæ‰å¯¼è‡´init()æ–¹æ³•ä¸­çš„æ—¥å¿—æ‰“å°ä½ç½®éå¸¸é å‰ã€‚ å®é™…ä¸Šè¿™æ˜¯å…¨å¼‚æ­¥åŒ–è®¾è®¡æ€æƒ³çš„ä½“ç°ã€‚ æˆ‘ä»¬å‘ç°init()æ–¹æ³•æ‰€åœ¨çš„ç±»XxlJobSchedulerä¹Ÿæœªäº¤ç”±Springç®¡ç†ï¼Œç»§ç»­å€ŸåŠ©IDEAçš„å¿«æ·é”®Ctrl+Alt+HæŸ¥çœ‹init()æ–¹æ³•çš„è°ƒç”¨å¤„ï¼Œå‘ç°æ˜¯åœ¨XxlJobAdminConfig.afterPropertiesSet()æ–¹æ³•ä¸­è¢«è°ƒç”¨çš„ã€‚ XxlJobAdminConfigç±»ä½¿ç”¨@Componentæ³¨è§£äº¤ç”±Springè¿›è¡Œç®¡ç†ï¼Œå¹¶å®ç°äº†InitializingBeanå’ŒDisposableBeanè¿™ä¸¤ä¸ªæ¥å£ï¼Œé‡å†™çš„afterPropertiesSet()æ–¹æ³•ä¸­åªæœ‰ç®€å•çš„ä¸‰è¡Œä»£ç ï¼Œç¬¬äºŒè¡Œä½¿ç”¨newå…³é”®å­—åˆ›å»ºäº†XxlJobSchedulerå¯¹è±¡èµ‹ç»™ç§æœ‰æˆå‘˜å˜é‡xxlJobSchedulerï¼Œéšåç¬¬ä¸‰è¡Œè°ƒç”¨äº†å…¶init()æ–¹æ³•ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†å¯åŠ¨çš„èµ·ç‚¹ï¼Œä¸å¦¨å…ˆæ¥åˆ†æä¸€ä¸‹è¿™ä¸ªâ€œèµ·ç‚¹ç±»â€ã€‚ ä»ç±»åæ¥çœ‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚å…¶ç¬¬ä¸€ä¸ªé™æ€æˆå‘˜å˜é‡adminConfigæ˜¯å®ƒæœ¬èº«ï¼Œå¹¶åœ¨afterPropertiesSet()æ–¹æ³•çš„ç¬¬ä¸€è¡Œå°†thiså…³é”®å­—èµ‹ç»™äº†è¯¥å˜é‡ã€‚ è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿâ€œè‡ªèº«åŒ…å«è‡ªèº«â€å—ï¼Ÿåœ¨è¯¥é™æ€æˆå‘˜å˜é‡ä¸‹è¿˜æä¾›äº†ä¸€ä¸ªé™æ€æ–¹æ³•getAdminConfig()ç”¨æ¥è·å–è¯¥é™æ€æˆå‘˜å˜é‡çš„å¼•ç”¨ã€‚é‚£æˆ‘å¯ä»¥æ— é™é“¾å¼è°ƒç”¨é™æ€æ–¹æ³•getAdminConfig()äº†ï¼š 1XxlJobAdminConfig.getAdminConfig().getAdminConfig().getAdminConfig().......getAdminConfig(); åªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¯é€šè¿‡ç±»å.é™æ€æ–¹æ³•åï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨è¿”å›äº†ç±»çš„å®ä¾‹å¯¹è±¡adminConfigï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡ä»¥åŠä¹‹åçš„æ¯æ¬¡é“¾å¼è°ƒç”¨éƒ½æ˜¯é€šè¿‡å®ä¾‹å¯¹è±¡.é™æ€æ–¹æ³•åã€‚è¿™æ˜¯ä¸è¢«å»ºè®®å’Œè®¤å¯çš„ï¼Œç¼–è¯‘å™¨ä¹Ÿå‘å‡ºäº†é»„è‰²è­¦å‘Šã€‚æ‰€ä»¥æ¯æ¬¡ä½¿ç”¨æ—¶å»ºè®®æ˜¯åªè°ƒç”¨ä¸€æ¬¡ï¼Œè°ƒç”¨ä¸€æ¬¡å°±æ‹¿åˆ°äº†XxlJobAdminConfigç±»çš„å¯¹è±¡ï¼Œå¤šæ¬¡é“¾å¼è°ƒç”¨å¹¶æ— ä»»ä½•ä½œç”¨ã€‚ å†æ¥çœ‹ä¸€ä¸‹XxlJobAdminConfigç±»çš„å…¶å®ƒæˆå‘˜å˜é‡ï¼Œå‘ç°æ˜¯ä¸€äº›é€šè¿‡@Valueæ³¨è§£è·å–çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œè¿˜æœ‰ä¸€äº›æ˜¯é€šè¿‡@Resourceæ³¨è§£æ³¨å…¥çš„XxxxxxDaoç±»å’Œå…¶å®ƒä¸šåŠ¡ç±»ï¼ŒåŒæ—¶æä¾›äº†æ¯ä¸ªæˆå‘˜å˜é‡çš„è®¿é—®å™¨ï¼ˆgetteræ–¹æ³•ï¼‰ã€‚ ä¸ºä»€ä¹ˆè¿™ä¹ˆåšå‘¢ï¼Ÿä¸ºä»€ä¹ˆè¦å°†è¿™äº›XxxxxxDaoç­‰ç±»æ”¾åˆ°è¿™é‡Œå¹¶æä¾›è®¿é—®å™¨å‘¢ï¼Ÿ ç®€å•çŒœæƒ³ï¼šå®é™…ä¸ŠXxlJobAdminConfigå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªç®€å•çš„â€œå®¹å™¨â€ï¼Œè°ƒåº¦ä¸­å¿ƒåœ¨å¯åŠ¨æ—¶å°†æ•´ä¸ªç³»ç»Ÿéœ€è¦ç”¨åˆ°çš„é…ç½®ä¿¡æ¯å’ŒXxxxxxDaoç±»å¯¹è±¡åˆå§‹åŒ–åˆ°è¯¥â€œå®¹å™¨â€ä¸­ï¼Œåœ¨éœ€è¦ä½¿ç”¨æŸä¸ªXxxxxxDaoç±»æ—¶ï¼Œä¸ä½¿ç”¨Springçš„ä¾èµ–æ³¨å…¥ï¼Œè€Œæ˜¯ä»è¯¥â€œå®¹å™¨â€ä¸­æ‹¿ï¼Œè¿˜è®°å¾—å‰é¢åˆ†æè¿‡çš„é™æ€æ–¹æ³•getAdminConfig()ï¼Œå®ƒè¿”å›äº†XxlJobAdminConfigç±»çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥ä½¿ç”¨ï¼š 1XxlJobAdminConfig.getAdminConfig().getXxxxxxDao() è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ çŒœæƒ³ï¼šè¿™æ ·åšå¯¹ç³»ç»Ÿçš„é…ç½®ä¿¡æ¯å’Œä¾èµ–ä¿¡æ¯è¿›è¡Œäº†ç»Ÿä¸€ç®¡ç†ï¼Œæœ‰ä¸€ç§å…¨å±€é…ç½®æ„Ÿã€‚ æ€»ç»“è¿™ç¯‡æ–‡ç« ä¸»è¦åˆ†æäº†è°ƒåº¦ä¸­å¿ƒé¡¹ç›®xxl-job-adminçš„å¯åŠ¨æµç¨‹ã€‚å‘ç°ä¸»è¦æ‰§è¡Œäº†XxlJobScheduler.init()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ‰å…­ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¼šé€ä¸ªè¿›è¡Œåˆ†æã€‚ åˆå§‹åŒ–å›½é™…åŒ–ç»„ä»¶","link":"/2020/02/26/middleware/xxl-job/dispatch-center-start-process-analysis/"},{"title":"Dockerå¸¸ç”¨å‘½ä»¤","text":"å®‰è£…yum install -y yum-utils device-mapper-persistent-data lvm2 yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo yum install docker-ce docker-ce-cli containerd.io è®¾ä¸ºå¼€æœºå¯åŠ¨systemctl enable docker éå¸¸é‡è¦ï¼ï¼ï¼å¦åˆ™å¯èƒ½é‡å¯æœºå™¨åå†æ¬¡å¯åŠ¨dockeræ—¶ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š 1Failed to start docker: Unit docker is masked. æŸ¥çœ‹è¿è¡ŒçŠ¶æ€systemctl status docker åœæ­¢systemctl stop docker å¯åŠ¨systemctl start docker é‡å¯systemctl restart docker æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯docker version æŸ¥çœ‹å‘½ä»¤å¸®åŠ©docker --help åˆ—å‡ºé•œåƒdocker images æ‹‰å–é•œåƒdocker pull [OPTIONS] NAME[:tag] é…ç½®é•œåƒåŠ é€Ÿå™¨å‚è€ƒ é˜¿é‡Œäº‘å®¹å™¨é•œåƒåŠ é€Ÿå™¨æœåŠ¡ æŸ¥æ‰¾é•œåƒdocker search NAME åˆ é™¤é•œåƒdocker rmi NAME1/ID1 NAME2/ID2 æŸ¥çœ‹å®¹å™¨ æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼šdocker ps æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼šdocker ps -a æŸ¥çœ‹æœ€åä¸€æ¬¡è¿è¡Œçš„å®¹å™¨ï¼šdocker ps -l é€€å‡ºå®¹å™¨exit åˆ›å»ºäº¤äº’å¼å®¹å™¨docker run -i -t --name=[NAME] IMAGE /bin/bash -iï¼šäº¤äº’å¼æ“ä½œ -tï¼šåˆ†é…ä¸€ä¸ªå¯æ“ä½œå®¹å™¨çš„ç»ˆç«¯ --name=[NAME]ï¼šæŒ‡å®šå®¹å™¨åç§°ï¼ˆå”¯ä¸€ï¼‰ å¯é€‰å‚æ•°å¯åˆå¹¶ï¼šdocker run -it --name [NAME] IMAGE /bin/bash äº¤äº’å¼å®¹å™¨exité€€å‡ºåå®¹å™¨è‡ªåŠ¨å…³é—­ã€‚ åˆ›å»ºå®ˆæŠ¤å¼å®¹å™¨docker run -itd --name NAME IMAGE /bin/bash -dï¼šæŒ‡å®šå®¹å™¨è¿è¡Œæ¨¡å¼ è¿›å…¥å®ˆæŠ¤å¼å®¹å™¨docker exec -it [CONTAINER ID] /bin/bash å®ˆæŠ¤å¼å®¹å™¨exité€€å‡ºåå®¹å™¨ç»§ç»­è¿è¡Œã€‚ å¯åŠ¨å·²åœæ­¢è¿è¡Œçš„å®¹å™¨docker start [CONTAINER ID] åœæ­¢å®¹å™¨docker stop [CONTAINER ID] é‡å¯å®¹å™¨docker restart [CONTAINER ID] åˆ é™¤å®¹å™¨docker rm -f [CONTAINER ID] åˆ é™¤æ—¶å®¹å™¨å¿…é¡»æ˜¯åœæ­¢çŠ¶æ€ã€‚ åˆ é™¤å…¨éƒ¨å®¹å™¨ï¼ˆå…ˆæŸ¥è¯¢å‡ºæ‰€æœ‰å®¹å™¨å†åˆ é™¤ï¼‰ï¼š 1docker rm `docker ps -a -q` æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯docker inspect [CONTAINER NAME] æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯ä¸­æŸä¸ªå±æ€§çš„è¯¦ç»†ä¿¡æ¯12345`docker inspect -f='{{.[å±æ€§å]}}' [CONTAINER NAME]`æˆ–`docker inspect --format='{{.[å±æ€§å]}}' [CONTAINER NAME]` æ–‡ä»¶æ‹·è´docker cp source target å¯å°†å®¿ä¸»æœºçš„æ–‡ä»¶/ç›®å½•æ‹·è´è‡³å®¹å™¨æˆ–å°†å®¹å™¨å†…çš„æ–‡ä»¶/ç›®å½•æ‹·è´è‡³å®¿ä¸»æœºã€‚ exampleï¼š ä»å®¿ä¸»æœºï¼ˆsourceï¼‰æ‹·è´è‡³å®¹å™¨å†…ï¼ˆtargetï¼‰ï¼š 1docker cp ./1.txt container1:/root ä»å®¹å™¨å†…ï¼ˆsourceï¼‰æ‹·è´è‡³å®¿ä¸»æœºï¼ˆtargetï¼‰ï¼š 1docker cp container1:/root ./1.txt ç«¯å£æ˜ å°„åˆ›å»ºå®¹å™¨æ—¶æŒ‡å®š-på‚æ•°å°†å®¹å™¨å†…ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç«¯å£ã€‚ 1docker run -itd --name=NAME -p å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ IMAGE /bin/bash ç›®å½•æŒ‚è½½åˆ›å»ºå®¹å™¨æ—¶æŒ‡å®š-vå‚æ•°è¿›è¡Œç›®å½•æŒ‚è½½ã€‚ 1docker run -itd --name=NAME -v å®¿ä¸»æœºç›®å½•:å®¹å™¨ç›®å½• IMAGE /bin/bash é•œåƒæ‰“åŒ…docker save -o [dir/NAME.tar] IMAGE_NAME å°†æ‰“åŒ…çš„é•œåƒä¸Šä¼ è‡³å…¶å®ƒæœåŠ¡å™¨scp ./NAME.tar ip:/root/dir å¯¼å…¥æ‰“åŒ…é•œåƒdocker load -i /root/dir/NAME.tar å®¹å™¨æ‰“åŒ…docker export -o /root/CONTAINER_NAME.tar CONTAINER_NAME å¯¼å…¥æ‰“åŒ…å®¹å™¨docker import CONTAINER_NAME.tar CONTAINER_NAME","link":"/2020/02/19/ops/docker/docker-common-commands/"},{"title":"åˆ›å»ºmysql5.7çš„Dockerå®¹å™¨","text":"æ‹‰å–é•œåƒ1docker pull mysql:5.7 åˆ›å»ºæŒ‚è½½ç›®å½•å¦‚æœä¸åˆ›å»ºæŒ‚è½½ç›®å½•ï¼Œä¸€æ—¦å®¹å™¨é‡å¯ï¼Œåˆ™æ•°æ®ä¼šå…¨éƒ¨ä¸¢å¤±ã€‚ 1mkdir -p /usr/local/software/mysql/data /usr/local/software/mysql/logs /usr/local/software/mysql/conf åˆ›å»ºmysqlé…ç½®æ–‡ä»¶123cd /usr/local/software/mysqltouch my.cnfvim my.cnf é…ç½®æ–‡ä»¶å†…å®¹ï¼š 1234567891011121314[mysqld]user=mysqlcharacter-set-server=utf8default_authentication_plugin=mysql_native_passwordsecure_file_priv=/var/lib/mysqlexpire_logs_days=7sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTIONmax_connections=1000 [client]default-character-set=utf8 [mysql]default-character-set=utf8 åˆ›å»ºå®¹å™¨1docker run --restart=always -p 3306:3306 --name mysql5.7 -v /usr/local/software/mysql/conf:/etc/mysql -v /usr/local/software/mysql/logs:/var/log/mysql -v /usr/local/software/mysql/data:/var/lib/mysql -v /usr/local/software/mysql/my.cnf:/etc/mysql/my.cnf -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 --restart=alwaysï¼šå½“dockeré‡å¯æ—¶ï¼Œå®¹å™¨ä¹Ÿé‡å¯ã€‚ --nameï¼šå®¹å™¨åç§°ã€‚ -p 3306:3306ï¼šå®¿ä¸»æœºï¼šå®¹å™¨ç«¯å£æ˜ å°„ã€‚ -v source:targetï¼šç›®å½•æŒ‚è½½ã€‚ -eï¼šè®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆmysqlå¯†ç ï¼‰ã€‚ -dï¼šåå°å¯åŠ¨ã€‚","link":"/2020/02/19/ops/docker/create-mysql-container/"},{"title":"ä¿®ç‚¼xxl-jobä¹‹æ­å»ºæœ¬åœ°è°ƒåº¦å¹³å°","text":"ä¸‹è½½æºç xxl-jobç›®å‰æœ€æ–°masteråˆ†æ”¯çš„ä»£ç ä¸ºv2.2.0ï¼Œå®˜ç½‘æ˜¾ç¤ºä»åœ¨è¿­ä»£ä¸­ï¼ˆè¯¥ç‰ˆæœ¬ç›®å‰å‘å¸ƒçš„æ›´æ–°å†…å®¹ä¸»è¦æ˜¯è°ƒåº¦ä¸­å¿ƒå‡çº§SpringBootç‰ˆæœ¬ä¸º2.xï¼‰ï¼Œæ‰€ä»¥æœ¬æ¬¡ä¿®ç‚¼æˆ‘ä»¬é‡‡ç”¨æœ€è¿‘ç¨³å®šç‰ˆv2.1.2ï¼Œå‘å¸ƒæ—¥æœŸä¸º2019-12-12ã€‚ æºç åœ°å€ï¼šGitHub/Gitee å·¥ç¨‹ç®€ä»‹æºç ç»“æ„å¦‚ä¸‹ï¼š 123456789xxl-job-adminï¼šè°ƒåº¦ä¸­å¿ƒxxl-job-coreï¼šå…¬å…±ä¾èµ–xxl-job-executor-samplesï¼šæ‰§è¡Œå™¨Sampleç¤ºä¾‹ï¼ˆé€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬æ‰§è¡Œå™¨ï¼Œå¯ç›´æ¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å‚è€ƒå…¶å¹¶å°†ç°æœ‰é¡¹ç›®æ”¹é€ æˆæ‰§è¡Œå™¨ï¼‰ ï¼šxxl-job-executor-sample-springbootï¼šSpringbootç‰ˆæœ¬ï¼Œé€šè¿‡Springbootç®¡ç†æ‰§è¡Œå™¨ï¼Œæ¨èè¿™ç§æ–¹å¼ï¼› ï¼šxxl-job-executor-sample-springï¼šSpringç‰ˆæœ¬ï¼Œé€šè¿‡Springå®¹å™¨ç®¡ç†æ‰§è¡Œå™¨ï¼Œæ¯”è¾ƒé€šç”¨ï¼› ï¼šxxl-job-executor-sample-framelessï¼šæ— æ¡†æ¶ç‰ˆæœ¬ï¼› ï¼šxxl-job-executor-sample-jfinalï¼šJFinalç‰ˆæœ¬ï¼Œé€šè¿‡JFinalç®¡ç†æ‰§è¡Œå™¨ï¼› ï¼šxxl-job-executor-sample-nutzï¼šNutzç‰ˆæœ¬ï¼Œé€šè¿‡Nutzç®¡ç†æ‰§è¡Œå™¨ï¼› ï¼šxxl-job-executor-sample-jbootï¼šjbootç‰ˆæœ¬ï¼Œé€šè¿‡jbootç®¡ç†æ‰§è¡Œå™¨ï¼› ç¯å¢ƒæ­å»ºåŸºç¡€ç¯å¢ƒï¼š Maven3+ JDK7+ MySQL5.7+ æ­å»ºè°ƒåº¦ä¸­å¿ƒè°ƒåº¦ä¸­å¿ƒé¡¹ç›®ï¼šxxl-job-adminã€‚ ä½œç”¨ï¼šç»Ÿä¸€ç®¡ç†ä»»åŠ¡è°ƒåº¦å¹³å°ä¸Šè°ƒåº¦ä»»åŠ¡ï¼Œè´Ÿè´£è§¦å‘è°ƒåº¦æ‰§è¡Œï¼Œå¹¶ä¸”æä¾›ä»»åŠ¡ç®¡ç†å¹³å°ã€‚ åˆå§‹åŒ–â€œè°ƒåº¦æ•°æ®åº“â€æºç ä¸‹è½½åè·å–åˆå§‹åŒ–æ•°æ®åº“SQLè„šæœ¬å¹¶åœ¨MySQLä¸­æ‰§è¡Œã€‚ è°ƒåº¦æ•°æ®åº“åˆå§‹åŒ–SQLè„šæœ¬åœ°å€ä¸ºï¼š 1/xxl-job/doc/db/tables_xxl_job.sql ä¿®æ”¹è°ƒåº¦ä¸­å¿ƒé…ç½®å°†æ•´ä¸ªé¡¹ç›®å·¥ç¨‹å¯¼å…¥IDEAä¸­ï¼Œç­‰å¾…mavenä¾èµ–ä¸‹è½½å®Œæ¯•ï¼Œä¿®æ”¹è°ƒåº¦ä¸­å¿ƒé…ç½®ã€‚ è°ƒåº¦ä¸­å¿ƒé…ç½®æ–‡ä»¶åœ°å€ï¼š 1/xxl-job/xxl-job-admin/src/main/resources/application.properties éœ€è¦ä¿®æ”¹çš„é…ç½®é¡¹æœ‰ä»¥ä¸‹ä¸‰ä¸ªï¼š 123spring.datasource.url=spring.datasource.username=spring.datasource.password= å°†æ•°æ®æºä¿¡æ¯ä¿®æ”¹ä¸ºä¸Šä¸€æ­¥ä¸­å¯¼å…¥è„šæœ¬çš„æ•°æ®åº“ä¿¡æ¯ã€‚ å¯åŠ¨è°ƒåº¦ä¸­å¿ƒåœ¨IDEAä¸­è¿è¡Œcom.xxl.job.admin.XxlJobAdminApplication#mainæ–¹æ³•ï¼Œå¯åŠ¨è°ƒåº¦ä¸­å¿ƒã€‚ å¦‚æœä¸€åˆ‡é…ç½®æ­£å¸¸ï¼Œå¯åœ¨æ§åˆ¶å°çœ‹åˆ°ä»¥ä¸‹ä¸‰è¡Œå…³é”®æ—¥å¿—ä¿¡æ¯ï¼š 12313:01:37.678 logback [main] INFO o.s.b.c.e.t.TomcatEmbeddedServletContainer - Tomcat started on port(s): 8080 (http)13:01:37.690 logback [main] INFO c.x.job.admin.XxlJobAdminApplication - Started XxlJobAdminApplication in 6.976 seconds (JVM running for 8.944)13:01:40.001 logback [xxl-job, admin JobScheduleHelper#scheduleThread] INFO c.x.j.a.c.thread.JobScheduleHelper - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin scheduler success. Tomcatå®¹å™¨ç›‘å¬8080ç«¯å£å¯åŠ¨ï¼› JVMå¯åŠ¨ï¼› JobScheduleHelperè¿™ä¸ªç±»æ‰“å°äº†&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin scheduler success.è¿™å¥è¯ã€‚ è®¿é—®è°ƒåº¦ä¸­å¿ƒåœ°å€å¦‚å·²æ­£ç¡®è¿›è¡Œå‰è¿°æ­¥éª¤ï¼Œåˆ™å¯è®¿é—®è°ƒåº¦ä¸­å¿ƒã€‚ è°ƒåº¦ä¸­å¿ƒè®¿é—®åœ°å€ï¼šhttp://localhost:8080/xxl-job-admin è¯¥åœ°å€æ‰§è¡Œå™¨å°†ä¼šä½¿ç”¨åˆ°ï¼Œä½œä¸ºå›è°ƒåœ°å€ã€‚ é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç ä¸ºadmin/123456ã€‚ç™»å½•æˆåŠŸåå¯çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š è‡³æ­¤è°ƒåº¦ä¸­å¿ƒæ­å»ºå®Œæ¯•ã€‚ æ­å»ºæ‰§è¡Œå™¨â€œæ‰§è¡Œå™¨â€ç¤ºä¾‹é¡¹ç›®ï¼šxxl-job-executor-sampleï¼Œè¯¥æ¨¡å—ä¸‹åŒ…å«å¤šä¸ªç‰ˆæœ¬çš„æ‰§è¡Œå™¨ç¤ºä¾‹ï¼Œæˆ‘ä»¬é€‰ç”¨xxl-job-executor-sample-springbootç‰ˆæœ¬ã€‚ ä½œç”¨ï¼šè´Ÿè´£æ¥æ”¶â€œè°ƒåº¦ä¸­å¿ƒâ€çš„è°ƒåº¦å¹¶æ‰§è¡Œï¼›å¯ç›´æ¥éƒ¨ç½²æ‰§è¡Œå™¨é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥å°†æ‰§è¡Œå™¨é›†æˆåˆ°ç°æœ‰ä¸šåŠ¡é¡¹ç›®ä¸­ã€‚ å¯åŠ¨æ‰§è¡Œå™¨åœ¨IDEAä¸­è¿è¡Œcom.xxl.job.executor.XxlJobExecutorApplication#mainæ–¹æ³•ï¼Œå¯åŠ¨ç¤ºä¾‹æ‰§è¡Œå™¨ã€‚ å¦‚æœä¸€åˆ‡è¿è¡Œæ­£å¸¸ï¼Œå¯åœ¨æ§åˆ¶å°çœ‹åˆ°ä»¥ä¸‹å…³é”®æ—¥å¿—ä¿¡æ¯ï¼ˆè¿™å°†ä½œä¸ºæˆ‘ä»¬åç»­è§£ææºç çš„æ€è·¯ï¼‰ï¼š 1234567891011......16:47:51.370 logback [main] INFO c.x.j.e.core.config.XxlJobConfig - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.16:47:51.425 logback [main] INFO c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:httpJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@1c32886a[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#httpJobHandler]16:47:51.426 logback [main] INFO c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:demoJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@3a4b0e5d[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#demoJobHandler]16:47:51.426 logback [main] INFO c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:demoJobHandler2, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@10b892d5[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#demoJobHandler2]16:47:51.427 logback [main] INFO c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:commandJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@3d3f761a[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#commandJobHandler]16:47:51.427 logback [main] INFO c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:shardingJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@3546d80f[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#shardingJobHandler]......16:47:52.172 logback [main] INFO c.x.r.r.p.XxlRpcProviderFactory - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-rpc, provider factory add service success. serviceKey = com.xxl.job.core.biz.ExecutorBiz, serviceBean = class com.xxl.job.core.biz.impl.ExecutorBizImpl......16:48:02.189 logback [Thread-10] INFO com.xxl.rpc.remoting.net.Server - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-rpc remoting server start success, nettype = com.xxl.rpc.remoting.net.impl.netty_http.server.NettyHttpServer, port = 9999 å¯åŠ¨æˆåŠŸåï¼Œç‚¹å‡»ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒåå°å¯¼èˆª-æ‰§è¡Œå™¨ç®¡ç†èœå•ï¼Œå¯çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šOnLineæœºå™¨åœ°å€ä¸­å·²æ˜¾ç¤ºæˆ‘ä»¬è¿è¡Œçš„æ‰§è¡Œå™¨åœ°å€ã€‚ ç‚¹å‡»ä»»åŠ¡ç®¡ç†èœå•å¯çœ‹åˆ°ç¤ºä¾‹æ‰§è¡Œå™¨çš„æµ‹è¯•ä»»åŠ¡1ï¼› ç‚¹å‡»å³ä¾§[æ“ä½œ]-&gt;[æ‰§è¡Œä¸€æ¬¡]ï¼Œå¼¹å‡ºçš„æ¨¡æ€æ¡†ä¸­æ— éœ€è¾“å…¥ä»»åŠ¡å‚æ•°ï¼Œç›´æ¥ç‚¹å‡»[ä¿å­˜]å³å¯æ‰§è¡Œä»»åŠ¡ï¼› ç‚¹å‡»[æŸ¥è¯¢æ—¥å¿—]ï¼Œå¯è¿›å…¥è°ƒåº¦æ—¥å¿—åˆ—è¡¨é¡µï¼Œç‚¹å‡»å³ä¾§[æ‰§è¡Œæ—¥å¿—]ï¼Œå¯çœ‹åˆ°ä»»åŠ¡åœ¨æ‰§è¡Œå™¨ä¸€ä¾§è¿è¡Œè¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ä»»åŠ¡çš„è°ƒåº¦å’Œæ‰§è¡Œã€‚","link":"/2020/02/13/middleware/xxl-job/build-local-dispatch-platform/"},{"title":"ä¿®ç‚¼xxl-jobä¹‹æ‰§è¡Œå™¨é¡¹ç›®ä¸ƒå¤§é…ç½®é¡¹è§£æ","text":"è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯è§£ææ‰§è¡Œå™¨é¡¹ç›®ä¸ƒå¤§é…ç½®é¡¹ä½œç”¨å’ŒåŸç†ã€‚æˆ‘ä»¬ä»¥ç¤ºä¾‹æ‰§è¡Œå™¨xxl-job-executor-sample-springbooté¡¹ç›®ä¸ºä¾‹ã€‚ å·¥ç¨‹ç»“æ„ä»‹ç»12345678910111213141516171819202122â”œâ”€javaâ”‚ â””â”€comâ”‚ â””â”€xxlâ”‚ â””â”€jobâ”‚ â””â”€executorâ”‚ â”‚ XxlJobExecutorApplication.java ------å¯åŠ¨ç±»â”‚ â”‚â”‚ â”œâ”€coreâ”‚ â”‚ â””â”€configâ”‚ â”‚ XxlJobConfig.java ------XxlJobSpringExecutoré…ç½®ç±»â”‚ â”‚â”‚ â”œâ”€mvcâ”‚ â”‚ â””â”€controllerâ”‚ â”‚ IndexController.java ------ç©ºæ–‡ä»¶â”‚ â”‚â”‚ â””â”€serviceâ”‚ â””â”€jobhandlerâ”‚ SampleXxlJob.java ------ç¤ºä¾‹æ‰§è¡Œå™¨ç±»â”‚â””â”€resources application.properties ------é¡¹ç›®é…ç½®æ–‡ä»¶ logback.xml ------æ—¥å¿—é…ç½®æ–‡ä»¶ com.xxl.job.executor.core.config.XxlJobConfigé…ç½®ç±»è§£è¯»ç”±äºæ˜¯SpringBooté¡¹ç›®ï¼Œè¯¥ç±»é‡‡ç”¨@Configurationæ³¨è§£æ·»åŠ é…ç½®ã€‚ æˆå‘˜å˜é‡ç®€ä»‹è¯¥é…ç½®ç±»ä¸€å…±åŒ…å«å…«ä¸ªæˆå‘˜å˜é‡ã€‚ æ—¥å¿—å¯¹è±¡1private Logger logger = LoggerFactory.getLogger(XxlJobConfig.class); slf4jçš„æ—¥å¿—å¯¹è±¡ï¼Œç”¨æ¥æ‰“å°å…³é”®æ—¥å¿—ã€‚ ä¸ƒå¤§æ ¸å¿ƒå±æ€§å˜é‡1234567891011121314151617181920@Value(&quot;${xxl.job.admin.addresses}&quot;)private String adminAddresses;@Value(&quot;${xxl.job.executor.appname}&quot;)private String appName;@Value(&quot;${xxl.job.executor.ip}&quot;)private String ip;@Value(&quot;${xxl.job.executor.port}&quot;)private int port;@Value(&quot;${xxl.job.accessToken}&quot;)private String accessToken;@Value(&quot;${xxl.job.executor.logpath}&quot;)private String logPath;@Value(&quot;${xxl.job.executor.logretentiondays}&quot;)private int logRetentionDays; ä½¿ç”¨Springæä¾›çš„@Valueæ³¨è§£æ¥æ³¨å…¥é…ç½®æ–‡ä»¶application.propertiesä¸­çš„é…ç½®ä¿¡æ¯ã€‚ æˆ‘ä»¬æ‰“å¼€resourcesç›®å½•ä¸‹çš„application.propertiesæ–‡ä»¶æŸ¥çœ‹ï¼Œé»˜è®¤é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š 123456789101112131415### xxl-job admin address list, such as &quot;http://address&quot; or &quot;http://address01,http://address02&quot;xxl.job.admin.addresses=http://127.0.0.1:8080/xxl-job-admin### xxl-job executor addressxxl.job.executor.appname=xxl-job-executor-samplexxl.job.executor.ip=xxl.job.executor.port=9999### xxl-job, access tokenxxl.job.accessToken=### xxl-job log pathxxl.job.executor.logpath=/data/applogs/xxl-job/jobhandler### xxl-job log retention daysxxl.job.executor.logretentiondays=30 æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„ç›¸å…³æ³¨é‡Šæˆ‘ä»¬æ¥è§£é‡Šä¸ƒå¤§æ ¸å¿ƒå±æ€§çš„å«ä¹‰ï¼š adminAddressesï¼š é…ç½®é¡¹ï¼šxxl.job.admin.addressesï¼Œé€‰å¡«ã€‚ å«ä¹‰ï¼šè°ƒåº¦ä¸­å¿ƒéƒ¨ç½²æ ¹åœ°å€ã€‚ ä½œç”¨ï¼šæ‰§è¡Œå™¨ä¼šä½¿ç”¨è¯¥åœ°å€è¿›è¡Œâ€œæ‰§è¡Œå™¨å¿ƒè·³æ³¨å†Œâ€å’Œä»»åŠ¡ç»“æœå›è°ƒã€‚ æ³¨æ„äº‹é¡¹ï¼šå¦‚è°ƒåº¦ä¸­å¿ƒé›†ç¾¤éƒ¨ç½²ï¼Œå­˜åœ¨å¤šä¸ªæ ¹åœ°å€ï¼Œåˆ™ç”¨é€—å·åˆ†éš”ã€‚ä¸ºç©ºä¸å¡«åˆ™å…³é—­è‡ªåŠ¨æ³¨å†ŒåŠŸèƒ½ã€‚ appNameï¼š é…ç½®é¡¹ï¼šxxl.job.executor.appnameï¼Œé€‰å¡«ã€‚ å«ä¹‰ï¼šæ˜¯æ¯ä¸ªæ‰§è¡Œå™¨é›†ç¾¤çš„å”¯ä¸€æ ‡ç¤ºAppNameã€‚ ä½œç”¨ï¼šæ‰§è¡Œå™¨å¿ƒè·³æ³¨å†Œåˆ†ç»„ä¾æ®ã€‚ æ³¨æ„äº‹é¡¹ï¼šä¸ºç©ºä¸å¡«è¡¨ç¤ºå…³é—­è‡ªåŠ¨æ³¨å†ŒåŠŸèƒ½ã€‚ ipï¼š é…ç½®é¡¹ï¼šxxl.job.executor.ipï¼Œé€‰å¡«ã€‚ å«ä¹‰ï¼šæ‰§è¡Œå™¨IPã€‚ ä½œç”¨ï¼šé€‚ç”¨äºå¤šç½‘å¡æ—¶æ‰‹åŠ¨è®¾ç½®æŒ‡å®šIPï¼Œè¯¥IPä¸ä¼šç»‘å®šHostä»…ä½œä¸ºé€šè®¯ä½¿ç”¨ï¼›ç”¨äºâ€œæ‰§è¡Œå™¨æ³¨å†Œâ€å’Œâ€œè°ƒåº¦ä¸­å¿ƒè¯·æ±‚å¹¶è§¦å‘ä»»åŠ¡â€ã€‚ æ³¨æ„äº‹é¡¹ï¼šä¸ºç©ºä¸å¡«è¡¨ç¤ºè‡ªåŠ¨è·å–IPã€‚ portï¼š é…ç½®é¡¹ï¼šxxl.job.executor.portï¼Œé€‰å¡«ã€‚ å«ä¹‰ï¼šæ‰§è¡Œå™¨ç«¯å£å·ã€‚æ‰§è¡Œå™¨å®é™…æ˜¯ä¸€ä¸ªå†…åµŒçš„Serverï¼Œé»˜è®¤ç«¯å£9999ã€‚ ä½œç”¨ï¼šç”¨äºâ€œæ‰§è¡Œå™¨æ³¨å†Œâ€å’Œâ€œè°ƒåº¦ä¸­å¿ƒè¯·æ±‚å¹¶è§¦å‘ä»»åŠ¡â€æ—¶é€šè®¯ã€‚ æ³¨æ„äº‹é¡¹ï¼šå°äºç­‰äº0æ—¶è‡ªåŠ¨è·å–ã€‚å•æœºéƒ¨ç½²å¤šä¸ªæ‰§è¡Œå™¨æ—¶ï¼Œä¸åŒæ‰§è¡Œå™¨ç«¯å£ä¸èƒ½ç›¸åŒã€‚ accessTokenï¼š é…ç½®é¡¹ï¼šxxl.job.accessTokenï¼Œé€‰å¡«ã€‚ å«ä¹‰ï¼šè®¿é—®ä»¤ç‰Œã€‚ ä½œç”¨ï¼šä¸ºæå‡ç³»ç»Ÿå®‰å…¨æ€§ï¼Œè°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨è¿›è¡Œå®‰å…¨æ€§æ ¡éªŒï¼ŒåŒæ–¹accessTokenåŒ¹é…æ‰å…è®¸é€šè®¯ã€‚ æ³¨æ„äº‹é¡¹ï¼šæ­£å¸¸é€šè®¯åªæœ‰ä¸¤ç§è®¾ç½®ï¼› è®¾ç½®ä¸€ï¼šè°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨å‡ä¸è®¾ç½®accessTokenï¼Œå…³é—­è®¿é—®ä»¤ç‰Œæ ¡éªŒã€‚ è®¾ç½®äºŒï¼šè°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨è®¾ç½®ç›¸åŒçš„accessTokenã€‚ logPathï¼š é…ç½®é¡¹ï¼šxxl.job.executor.logpathï¼Œé€‰å¡«ã€‚ å«ä¹‰ï¼šæ‰§è¡Œå™¨è¿è¡Œæ—¥å¿—æ–‡ä»¶å­˜å‚¨ç£ç›˜è·¯å¾„ã€‚ ä½œç”¨ï¼šè®¾ç½®æ‰§è¡Œå™¨è¿è¡Œæ—¥å¿—æ–‡ä»¶å­˜å‚¨ç£ç›˜è·¯å¾„ã€‚ æ³¨æ„äº‹é¡¹ï¼šéœ€è¦å¯¹è®¾ç½®çš„è·¯å¾„æ‹¥æœ‰è¯»å†™æƒé™ï¼›ä¸ºç©ºåˆ™ä½¿ç”¨é»˜è®¤è·¯å¾„ï¼ˆ/data/applogs/xxl-job/jobhandlerï¼‰ã€‚ logRetentionDaysï¼š é…ç½®é¡¹ï¼šxxl.job.executor.logretentiondaysï¼Œé€‰å¡«ã€‚ å«ä¹‰ï¼šæ‰§è¡Œå™¨æ—¥å¿—æ–‡ä»¶ä¿å­˜å¤©æ•°ã€‚ ä½œç”¨ï¼šè®¾ç½®è¿‡æœŸæ—¥å¿—è‡ªåŠ¨æ¸…ç†ã€‚ æ³¨æ„äº‹é¡¹ï¼šè®¾ç½®çš„å€¼å¤§äºç­‰äº3æ—¶ç”Ÿæ•ˆï¼›å¦åˆ™æ—¥å¿—è‡ªåŠ¨æ¸…ç†åŠŸèƒ½å…³é—­ã€‚ com.xxl.job.executor.core.config.XxlJobConfig#xxlJobExecutoræ–¹æ³•ä½œç”¨1234567891011121314@Beanpublic XxlJobSpringExecutor xxlJobExecutor() { logger.info(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.&quot;); XxlJobSpringExecutor xxlJobSpringExecutor = new XxlJobSpringExecutor(); xxlJobSpringExecutor.setAdminAddresses(adminAddresses); xxlJobSpringExecutor.setAppName(appName); xxlJobSpringExecutor.setIp(ip); xxlJobSpringExecutor.setPort(port); xxlJobSpringExecutor.setAccessToken(accessToken); xxlJobSpringExecutor.setLogPath(logPath); xxlJobSpringExecutor.setLogRetentionDays(logRetentionDays); return xxlJobSpringExecutor;} ä¸Šä¸€éƒ¨åˆ†åˆ—ä¸¾å‡ºçš„ä¸ƒå¤§å±æ€§æœ€ç»ˆè®¾ç½®ç»™äº†com.xxl.job.core.executor.impl.XxlJobSpringExecutorè¿™ä¸ªç±»çš„å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨@Beanæ³¨è§£äº¤ç”±Springè¿›è¡Œç®¡ç†ã€‚è¯¥æ–¹æ³•ä¸­æ‰“å°çš„æ—¥å¿—ä¿¡æ¯ &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init. æˆ‘ä»¬åœ¨å¯åŠ¨æ‰§è¡Œå™¨æ—¶æ§åˆ¶å°æœ‰è¾“å‡ºã€‚ ä¸ƒå¤§å±æ€§é…ç½®è¯¦è§£ä¸Šä¸€éƒ¨åˆ†åˆ—ä¸¾å‡ºäº†æ¯ä¸ªå±æ€§çš„æ³¨æ„äº‹é¡¹ç­‰ï¼Œè¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å»æºç ä¸­éªŒè¯ä¸Šä¸€éƒ¨åˆ†çš„å†…å®¹ã€‚ ç›®æ ‡æˆ‘ä»¬è¦æ‰¾åˆ°ä¸Šè¿°ä¸ƒå¤§å±æ€§åœ¨è®¾ç½®ç»™com.xxl.job.core.executor.impl.XxlJobSpringExecutorè¿™ä¸ªç±»çš„å¯¹è±¡æ—¶æ˜¯å¦‚ä½•ä»¥åŠæ€æ ·è¿›è¡Œæ¡ä»¶é™åˆ¶çš„ã€‚ æ€è€ƒä»com.xxl.job.executor.core.config.XxlJobConfig#xxlJobExecutoræ–¹æ³•æ¥çœ‹ï¼Œè¿™äº›é…ç½®ä»é…ç½®æ–‡ä»¶ä¸­è¯»åˆ°å€¼åæ˜¯ç›´æ¥ä½¿ç”¨å˜å¼‚å™¨ï¼ˆsetteræ–¹æ³•ï¼‰è®¾ç½®ç»™xxlJobSpringExecutorè¿™ä¸ªå¯¹è±¡ï¼Œç„¶åå°±æŠŠè¿™ä¸ªå¯¹è±¡äº¤ç»™Springè¿›è¡Œç®¡ç†äº†ï¼Œæ‰€ä»¥åªæœ‰ä¸¤ç§å¯èƒ½ï¼Œç¬¬ä¸€æ˜¯åœ¨å˜å¼‚å™¨ä¸­è¿›è¡Œäº†é€»è¾‘å¤„ç†ï¼Œç¬¬äºŒæ˜¯åœ¨SpringåŠ è½½beançš„è¿‡ç¨‹ä¸­è¿›è¡Œäº†é€»è¾‘å¤„ç†ã€‚ å®è·µæˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹com.xxl.job.core.executor.impl.XxlJobSpringExecutorè¿™ä¸ªç±»çš„å®šä¹‰ï¼š 12public class XxlJobSpringExecutor extends XxlJobExecutor implements ApplicationContextAware, InitializingBean, DisposableBean {...... è¯¥ç±»ç»§æ‰¿äº†com.xxl.job.core.executor.XxlJobExecutorçˆ¶ç±»å¹¶å®ç°äº†Springçš„ä¸‰ä¸ªæ¥å£ï¼›æˆ‘ä»¬åœ¨è¯¥ç±»ä¸­æœªæ‰¾å±æ€§å¯¹åº”çš„å˜å¼‚å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å‡ ä¹å¯ä»¥æ–­å®šè¿™äº›å±æ€§æ˜¯å®šä¹‰åœ¨çˆ¶ç±»ä¸­ã€‚ æˆ‘ä»¬æ¥çœ‹çˆ¶ç±»çš„ä»£ç  å˜å¼‚å™¨åªæ˜¯å•çº¯çš„æŠŠä¼ å…¥çš„å€¼è®¾ç½®ç»™å¯¹è±¡ï¼Œæ‰€ä»¥æ’é™¤äº†ç¬¬ä¸€ç§å¯èƒ½ï¼Œæƒ…å†µåªèƒ½æ˜¯ç¬¬äºŒç§ï¼šåœ¨SpringåŠ è½½beançš„è¿‡ç¨‹ä¸­è¿›è¡Œäº†é€»è¾‘å¤„ç†ã€‚ æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹çˆ¶ç±»XxlJobExecutorçš„ä»£ç ï¼Œå‘ç°startæ–¹æ³•ä¸­ç”¨åˆ°äº†è¿™äº›å±æ€§ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä»”ç»†é˜…è¯»ä»¥ä¸‹è¯¥æ–¹æ³•çš„ä»£ç ï¼š 123456789101112131415161718192021// ---------------------- start + stop ----------------------public void start() throws Exception { // init logpath XxlJobFileAppender.initLogPath(logPath); // init invoker, admin-client initAdminBizList(adminAddresses, accessToken); // init JobLogFileCleanThread JobLogFileCleanThread.getInstance().start(logRetentionDays); // init TriggerCallbackThread TriggerCallbackThread.getInstance().start(); // init executor-server port = port&gt;0?port: NetUtil.findAvailablePort(9999); ip = (ip!=null&amp;&amp;ip.trim().length()&gt;0)?ip: IpUtil.getIp(); initRpcProvider(ip, port, appName, accessToken);} ä¸€å…±æœ‰ä¸ƒè¡Œæ ¸å¿ƒä»£ç ï¼Œæˆ‘ä»¬ä¸€è¡Œä¸€è¡Œçš„æ¥è§£è¯»ï¼š XxlJobFileAppender.initLogPath(logPath); ä»æ–¹æ³•åæ¥çœ‹æ˜¾ç„¶æ˜¯åˆå§‹åŒ–æ—¥å¿—å­˜å‚¨è·¯å¾„ï¼Œæˆ‘ä»¬è¿›å…¥XxlJobFileAppenderç±»æŸ¥çœ‹initLogPath(logPath)æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é™æ€æˆå‘˜å˜é‡logBasePathçš„å€¼ä¸º/data/applogs/xxl-job/jobhandlerï¼Œå½“logPathå±æ€§æœªé…ç½®æ—¶è¯¥è·¯å¾„å³ä¸ºæ—¥å¿—å­˜ç›˜çš„é»˜è®¤è·¯å¾„ã€‚ è¯¥æ–¹æ³•çš„å®ç°æ€è·¯å¦‚ä¸‹ï¼š å¦‚æœé…ç½®çš„logPathä¸ä¸ºç©ºåˆ™è¦†ç›–é™æ€æˆå‘˜å˜é‡logBasePathçš„å€¼ã€‚ ä»¥é™æ€æˆå‘˜å˜é‡logBasePathçš„å€¼è°ƒç”¨Fileç±»çš„mkdirsæ–¹æ³•åˆ›å»ºå¤šçº§æ–‡ä»¶ç›®å½•ã€‚ è°ƒç”¨Fileç±»çš„getPathæ–¹æ³•å°†åˆ›å»ºå¥½çš„æ–‡ä»¶å¤¹çš„è·¯å¾„é‡æ–°èµ‹å€¼ç»™é™æ€æˆå‘˜å˜é‡logBasePathã€‚ ä»¥ä¸Šå°±æ˜¯å±æ€§logPathçš„é…ç½®æ–¹å¼ã€‚ initAdminBizList(adminAddresses, accessToken); ä»æ–¹æ³•åæ¥çœ‹è¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯åˆå§‹åŒ–è°ƒåº¦ä¸­å¿ƒéƒ¨ç½²æ ¹åœ°å€é›†åˆï¼Œå…¶å‚æ•°æ˜¯é…ç½®é¡¹adminAddresseså’ŒaccessTokençš„å€¼ã€‚æˆ‘ä»¬æ¥çœ‹è¯¥æ–¹æ³•çš„å…·ä½“å®ç°ï¼š è¯¥æ–¹æ³•çš„å®ç°æ€è·¯å¦‚ä¸‹ï¼š åˆ¤æ–­ä¼ å…¥çš„é…ç½®é¡¹adminAddressesçš„å€¼æ˜¯å¦ä¸ºnullå¹¶ä¸”å»é™¤ä¸¤ç«¯ç©ºæ ¼åçš„é•¿åº¦æ˜¯å¦å¤§äºé›¶ã€‚ å¦‚æœä¸æ»¡è¶³ç¬¬ä¸€æ­¥çš„æ¡ä»¶åˆ™ä»€ä¹ˆä¹Ÿä¸åšï¼Œå³å…³é—­è‡ªåŠ¨æ³¨å†ŒåŠŸèƒ½ï¼›å¦‚æœæ»¡è¶³ç¬¬ä¸€æ­¥çš„æ¡ä»¶ï¼Œåˆ™å»é™¤ä¸¤ç«¯ç©ºæ ¼åè°ƒç”¨splitæ–¹æ³•ä»¥è‹±æ–‡é€—å·,åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„è¿›è¡Œéå†ï¼Œéå†çš„ç¬¬ä¸€æ­¥æ˜¯é™åˆ¶æ•°ç»„ä¸­çš„å•ä¸ªåœ°å€å€¼ä¸ä¸ºnullå¹¶ä¸”å»é™¤ä¸¤ç«¯ç©ºæ ¼åçš„é•¿åº¦å¤§äºé›¶ï¼Œè¿™ä¸€æ­¥æ˜¯ä¸ºäº†é˜²æ­¢,http://127.0.0.1:8080/xxl-job-admin,ç­‰ç±»ä¼¼è¯¯é…ç½®ã€‚ ä¸€åˆ‡é™åˆ¶æ¡ä»¶é€šè¿‡åå¼€å§‹åˆ›å»ºcom.xxl.job.core.biz.client.AdminBizClientç±»çš„å¯¹è±¡ï¼Œå¹¶æ·»åŠ è‡³é™æ€æˆå‘˜å˜é‡adminBizListé›†åˆä¸­ã€‚è¿™é‡Œæ˜¯åœ¨ç¬¬ä¸€æ¬¡å¾ªç¯æ—¶æ‰ä½¿ç”¨newå…³é”®å­—åˆ›å»ºArrayListé›†åˆå¯¹è±¡ï¼Œå…¶æ€æƒ³æ˜¯â€œæ‡’åŠ è½½â€ï¼Œç”¨æ—¶æ‰å»åˆ›å»ºå¯¹è±¡ã€‚ç”±äºSpringçš„beançš„é»˜è®¤ä½œç”¨åŸŸæ˜¯å•ä¾‹çš„ï¼Œæ‰€ä»¥ä¿è¯äº†è¯¥åˆå§‹åŒ–æ–¹æ³•åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹com.xxl.job.core.biz.client.AdminBizClientç±»çš„æ„é€ æ–¹æ³•ï¼š æ„é€ æ–¹æ³•ä¸­å¯¹ä¼ å…¥çš„addressUrlè¿›è¡Œäº†ç®€å•çš„validæ ¡éªŒï¼Œå¦‚æœä¸æ˜¯ä»¥/ç»“å°¾åˆ™å°†/æ‹¼æ¥è‡³æœ«å°¾ã€‚æ­¤å¤„å¯çœ‹å‡ºæˆ‘ä»¬çš„adminAddressesé…ç½®å®é™…ä¼šå˜æˆç±»ä¼¼http://127.0.0.1:8080/xxl-job-admin/è¿™æ ·çš„å­—ç¬¦ä¸²ã€‚è‡³äºè¯¥ç±»å¯¹è±¡ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æˆ‘ä»¬æš‚æ—¶æ²¡æœ‰çº¿ç´¢ï¼Œå¤§å¯å…ˆä¸å…³æ³¨è¿™ä¸ªã€‚ JobLogFileCleanThread.getInstance().start(logRetentionDays); è°ƒç”¨JobLogFileCleanThreadç±»çš„getInstanceæ–¹æ³•å–å¾—è¯¥ç±»å¯¹è±¡å†è°ƒç”¨å…¶start(final long logRetentionDays)æ–¹æ³•ã€‚ ä»ç±»åæ¥çœ‹æ˜¯æ¸…é™¤æ—¥å¿—æ–‡ä»¶çš„çº¿ç¨‹ã€‚ æˆ‘ä»¬å‰å¾€com.xxl.job.core.thread.JobLogFileCleanThreadç±»çœ‹ä¸€ä¸‹getInstanceæ–¹æ³•ï¼Œä¼šå‘ç°æœ‰å¦‚ä¸‹ä¸¤è¡Œå…³é”®ä»£ç ï¼š 1234private static JobLogFileCleanThread instance = new JobLogFileCleanThread();public static JobLogFileCleanThread getInstance() { return instance;} è¿™æ˜¯â€œé¥¿æ±‰å¼â€å•ä¾‹æ¨¡å¼çš„å†™æ³•ï¼Œåˆ›å»ºäº†å•ä¾‹çš„JobLogFileCleanThreadå¯¹è±¡ã€‚ æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹startæ–¹æ³•ï¼š é¦–å…ˆç¬¬ä¸€æ­¥æ£€æŸ¥è®¾ç½®çš„logRetentionDayså±æ€§æ˜¯å¦å°äº3ï¼Œå°äºåˆ™ç›´æ¥returnï¼›è¿™é‡Œè¯´æ˜äº†é…ç½®æ–‡ä»¶ä¸­çš„å€¼è®¾ç½®å°äº3æ—¶å…³é—­æ—¥å¿—è‡ªåŠ¨æ¸…ç†åŠŸèƒ½ã€‚ è¯¥æ–¹æ³•ä¸­å®ä¾‹åŒ–äº†æˆå‘˜å˜é‡private Thread localThread;ï¼Œè°ƒç”¨äº†setDaemon(true)æ–¹æ³•å°†è¯¥çº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå¹¶è°ƒç”¨setNameæ–¹æ³•å°†çº¿ç¨‹åè®¾ä¸ºäº†xxl-job, executor JobLogFileCleanThreadã€‚ çº¿ç¨‹ä¸­è¿è¡Œçš„runæ–¹æ³•é€»è¾‘å¤§è‡´å¦‚ä¸‹ï¼š è°ƒç”¨XxlJobFileAppender.getLogPath()æ–¹æ³•è·å–è®¾ç½®çš„æ—¥å¿—å­˜ç›˜è·¯å¾„ éå†è¯¥è·¯å¾„ä¸‹æ‰€æœ‰æ–‡ä»¶å¤¹ï¼Œåˆ¤æ–­å½“å‰æ—¶é—´ä¸æ–‡ä»¶å¤¹çš„åˆ›å»ºæ—¶é—´ä¹‹å·®æ˜¯å¦å¤§äºç­‰äºè®¾ç½®çš„logRetentionDayså¤©æ•°ï¼Œå¦‚æœå¤§äºåˆ™è°ƒç”¨å·¥å…·ç±»com.xxl.job.core.util.FileUtilçš„deleteRecursivelyæ–¹æ³•é€’å½’åˆ é™¤æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚ åˆ é™¤é€»è¾‘å®Œæˆåï¼Œæœ‰è¿™æ ·ä¸€è¡Œä»£ç ï¼šTimeUnit.DAYS.sleep(1);ï¼Œçº¿ç¨‹ç¡çœ ä¸€å¤©ã€‚è¿™é‡Œè°ƒç”¨å¹¶å‘åŒ…ä¸‹çš„TimeUnitç±»çš„sleepæ–¹æ³•è®©ä»£ç å¯è¯»æ€§æ›´é«˜ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨ä¼ ç»ŸThread.sleep()æ–¹æ³•ï¼Œä¼ ç»™sleepæ–¹æ³•çš„å€¼çš„å•ä½æ˜¯æ¯«ç§’ï¼Œå³éœ€ä¼ å…¥24*60*60*1000ï¼Œä»£ç å¯è¯»æ€§ä¸é«˜ã€‚ TriggerCallbackThread.getInstance().start(); ä»ç±»åTriggerCallbackThreadæ¥çœ‹ï¼Œè¿™æ˜¯æ‰§è¡Œå™¨å›è°ƒçº¿ç¨‹ï¼Œç”±äºæœªä½¿ç”¨åˆ°é…ç½®å‚æ•°ï¼Œè¿™ç¯‡æ–‡ç« ä¸å¯¹å…¶è¿›è¡Œå±•å¼€è§£è¯»ã€‚ port = port&gt;0?port: NetUtil.findAvailablePort(9999); åˆå§‹åŒ–portç«¯å£å·ã€‚ å¦‚æœé…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„ç«¯å£å·å¤§äºé›¶ï¼Œåˆ™ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„å€¼ï¼› å¦åˆ™æ‰§è¡Œä»£ç NetUtil.findAvailablePort(9999);ï¼Œæˆ‘ä»¬è¿›å…¥NetUtilç±»æŸ¥çœ‹findAvailablePortæ–¹æ³•ï¼Œå‘ç°è¿™ä¸ªç±»å±äºcom.xxl.rpc.utilåŒ…ï¼Œå¯è§ï¼Œxxl-jobä¾èµ–äº†xxl-rpcï¼ˆè¿™æ˜¯ä½œè€…è®¸é›ªé‡Œå¼€æºçš„rpcæ¡†æ¶ï¼‰ã€‚ ä»æ–¹æ³•åæ¥çœ‹ä½œç”¨æ˜¯â€œå¯»æ‰¾å¯ç”¨ç«¯å£â€ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹findAvailablePortæ–¹æ³•çš„å…·ä½“å®ç°é€»è¾‘ï¼š ä¼ å…¥çš„9999ä½œä¸ºé»˜è®¤ç«¯å£ï¼Œé¦–å…ˆå¾ªç¯9999åˆ°65534ç«¯å£ï¼Œé€ä¸ªè¿›è¡Œ!isPortUsed(portTmp)åˆ¤æ–­ï¼Œå¦‚æœè¿”å›trueåˆ™è¡¨ç¤ºå½“å‰ç«¯å£å·æœªè¢«ä½¿ç”¨ï¼Œè¿”å›èµ‹å€¼ç»™å±æ€§portã€‚ å¦‚æœä¸Šè¿°å¾ªç¯æœªæ‰¾åˆ°å¯ä½¿ç”¨çš„ç«¯å£ï¼Œåˆ™å†å¾ªç¯9999åˆ°1ç«¯å£ï¼ŒåŒæ ·é€ä¸ªè¿›è¡Œ!isPortUsed(portTmp)åˆ¤æ–­ï¼Œå¦‚æœè¿˜æœªæ‰¾åˆ°å¯ç”¨ç«¯å£ï¼Œåˆ™æŠ›å‡ºXxlRpcExceptionå¼‚å¸¸ï¼Œå¼‚å¸¸ä¿¡æ¯ä¸ºno available port.ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹isPortUsedæ–¹æ³•æ˜¯å¦‚ä½•åˆ¤æ–­ç«¯å£æ˜¯å¦è¢«ä½¿ç”¨çš„ï¼š å®é™…æ˜¯å°è¯•å»åˆ›å»ºä¸€ä¸ªServerSocketå®¢æˆ·ç«¯å¹¶ä¸ä¼ å…¥çš„ç«¯å£å·è¿›è¡Œç»‘å®šï¼Œå¦‚ç«¯å£è¢«å ç”¨åˆ™ç»‘å®šæ—¶ä¼šæŠ›å‡ºIOExceptionï¼Œç”±æ­¤æ¥ç¡®å®šç«¯å£æ˜¯å¦è¢«ä½¿ç”¨ï¼Œä»è€Œåœ¨æœªé…ç½®ç«¯å£å·æ—¶é€‰å‡ºä¸€ä¸ªå¯ç”¨ç«¯å£ã€‚æœ€ç»ˆfinallyä»£ç å—ä¸­è°ƒç”¨äº†closeæ–¹æ³•å…³é—­èµ„æºã€‚ ip = (ip!=null&amp;&amp;ip.trim().length()&gt;0)?ip: IpUtil.getIp(); ä½œç”¨ï¼šç¡®å®šipåœ°å€ã€‚ç¤ºä¾‹æ‰§è¡Œå™¨çš„é…ç½®ä¸­æ˜¯æœªè¿›è¡Œé…ç½®çš„ï¼Œæ‰€ä»¥ä¼šæ‰§è¡ŒIpUtil.getIp()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ€åä¼šè°ƒç”¨java.net.InetAddress#getHostAddressæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›nullï¼Œæ‰€ä»¥å±æ€§ipä¼šè¢«è®¾ç½®æˆnullã€‚ initRpcProvider(ip, port, appName, accessToken); ä¼ å…¥äº†å››ä¸ªå‚æ•°ï¼šipã€portã€appNameå’ŒaccessTokenç”¨æ¥åˆå§‹åŒ–RpcæœåŠ¡æä¾›è€…ã€‚è¿™éƒ¨åˆ†å±äºxxl-rpcçš„å†…å®¹ï¼Œç›®å‰æˆ‘ä»¬å¯ä»¥ç®€å•çœ‹çœ‹ï¼Œå¤§è‡´å†…å®¹æ˜¯åˆ›å»ºå‡ºXxlRpcProviderFactoryç±»çš„å¯¹è±¡ï¼Œç»™è¯¥å¯¹è±¡è®¾ç½®ç›¸å…³å±æ€§ï¼Œæ·»åŠ com.xxl.job.core.biz.impl.ExecutorBizImplæœåŠ¡è‡³rpcæœåŠ¡æä¾›è€…mapå®¹å™¨ä¸­ï¼Œæœ€åè°ƒç”¨startæ–¹æ³•å¯åŠ¨æœåŠ¡æä¾›è€…ï¼ˆè¿™é‡Œå®é™…æ˜¯ä¸€ä¸ªNettyServerï¼‰ã€‚ ç°åœ¨æˆ‘ä»¬å¤§å¯ä¸å¿…å»å…³æ³¨xxl-rpcæ˜¯æ€ä¹ˆå®ç°çš„ï¼Œè¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯ææ¸…æ¥šä¸ƒå¤§æ ¸å¿ƒé…ç½®çš„å·¥ä½œåŸç†ã€‚ çˆ¶ç±»XxlJobExecutorçš„startæ–¹æ³•æˆ‘ä»¬çœ‹å®Œäº†ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä»€ä¹ˆæ—¶æœºæ‰§è¡Œçš„å‘¢ï¼Ÿ æˆ‘ä»¬æ³¨æ„åˆ°XxlJobSpringExecutorç±»å®ç°äº†Springçš„InitializingBeanæ¥å£ï¼Œè¯¥æ¥å£æä¾›äº†afterPropertiesSetæ–¹æ³•ä¾›å­ç±»å®ç°ï¼Œåœ¨beanåŠ è½½è¿‡ç¨‹ä¸­ä¼šæ‰§è¡Œè¯¥æ–¹æ³•ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹XxlJobSpringExecutorç±»ä¸­é‡å†™çš„afterPropertiesSetæ–¹æ³•ï¼š 12345678910111213141516// start@Overridepublic void afterPropertiesSet() throws Exception { // init JobHandler Repository initJobHandlerRepository(applicationContext); // init JobHandler Repository (for method) initJobHandlerMethodRepository(applicationContext); // refresh GlueFactory GlueFactory.refreshInstance(1); // super start super.start();} å‰ä¸‰è¡Œä»£ç æ˜¯åˆå§‹åŒ–ä¸€äº›ä¸œè¥¿ï¼Œæš‚æ—¶ä¸å»å…³æ³¨ï¼›æœ€åä¸€è¡Œsuper.start()æ˜¯æˆ‘ä»¬çš„å…³é”®ï¼Œè°ƒç”¨äº†çˆ¶ç±»çš„startæ–¹æ³•ã€‚ æ€»ç»“è‡³æ­¤ï¼Œæˆ‘ä»¬çŸ¥é“äº†ä¸ƒå¤§é…ç½®é¡¹çš„åŸºæœ¬åŸç†ï¼Œå¯¹æˆ‘ä»¬ä½¿ç”¨xxl-jobæœ‰äº†ä¸€äº›å¸®åŠ©ã€‚ä¾‹å¦‚é…ç½®é¡¹logretentiondaysä¸èƒ½å°äº3ï¼Œå¦åˆ™æ—¥å¿—æ–‡ä»¶ä¸ä¼šè‡ªåŠ¨æ¸…ç†ç­‰ã€‚","link":"/2020/02/13/middleware/xxl-job/demo-executor-xxljobconfig-sourcecode-analysis/"},{"title":"Windows 10ä¸‹Gitå®‰è£…åŠSSHå…¬ç§é’¥é…ç½®","text":"ä¸‹è½½å¯ä» Gitå®˜ç½‘ ä¸‹è½½æœ€æ–°Windowså®‰è£…æ–‡ä»¶ï¼ˆä¸‹è½½é€Ÿåº¦æœ‰ç‚¹æ„Ÿäººï¼‰ã€‚ è¿™é‡Œæˆ‘æä¾›64ä½çš„Git 2.25.0ç‰ˆæœ¬çš„ ç™¾åº¦ç½‘ç›˜ ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼šuzs6ã€‚ å®‰è£…åŒå‡»å®‰è£…åŒ…æ–‡ä»¶è¿›è¡Œå®‰è£…ï¼Œè‡ªå®šä¹‰å®‰è£…ä½ç½®ï¼Œå…¶ä½™ä¿æŒé»˜è®¤ä¸€ç›´nextä¸‹å»ã€‚ æŒ‰ä¸‹win+Ré”®ï¼Œè¾“å…¥cmdï¼Œå›è½¦ï¼Œè¾“å…¥å‘½ä»¤git --versionï¼Œå‡ºç°ä¸‹å›¾æ‰€ç¤ºå†…å®¹å³è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚ å…¨å±€é…ç½®å…¨å±€é…ç½®ç”¨æˆ·åå’Œé‚®ç®±ï¼Œå¦åˆ™æ— æ³•è¿›è¡Œä¸‹ä¸€æ­¥çš„SSHå…¬ç§é’¥é…ç½®ã€‚é¼ æ ‡å³å‡»æ¡Œé¢ç©ºç™½å¤„-&gt;é€‰æ‹©Git Bash Hereæ‰“å¼€ã€‚åˆ†åˆ«è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š 12git config --global user.name &quot;ä½ çš„ç”¨æˆ·å&quot;git config --global user.email &quot;ä½ çš„é‚®ç®±&quot; ç”¨æˆ·åå¯éšæ„æŒ‡å®šï¼Œä¸€èˆ¬æ˜¯è‡ªå·±åå­—æˆ–ç®€ç§°ï¼Œgitæäº¤ä»£ç åˆ°è¿œç¨‹æ—¶ä¼šä½¿ç”¨è¯¥åç§°ã€‚é‚®ç®±å¡«è‡ªå·±å–œæ¬¢çš„é‚®ç®±å³å¯ã€‚ SSHå…¬ç§é’¥é…ç½® é¼ æ ‡å³å‡»æ¡Œé¢ç©ºç™½å¤„-&gt;é€‰æ‹©Git Bash Hereæ‰“å¼€ã€‚ ä½¿ç”¨cd ~/.sshåˆ‡æ¢åˆ°å…¬ç§é’¥ç›®å½•ã€‚ æ‰§è¡Œå‘½ä»¤ssh-keygen -t rsaç”Ÿæˆå…¬ç§é’¥ï¼Œå›è½¦3æ¬¡ï¼ˆè¿™é‡Œå›è½¦ä¼šè®©ä½ è¾“å…¥ä¸€äº›é…ç½®ï¼Œæ¯”å¦‚å¯†ç ï¼Œå¦‚æœè®¾ç½®äº†å¯†ç åˆ™æ¯æ¬¡ä½¿ç”¨gitå‘½ä»¤éƒ½ä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼Œä¸æ¨èï¼‰ï¼Œä¼šåœ¨C:\\Users\\Administrator\\.sshç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªç§é’¥id_rsaå’Œä¸€ä¸ªå…¬é’¥id_rsa.pubã€‚ Gitlabé…ç½®ä¸Šè¿°é…ç½®å®Œæˆä¹‹åå³å¯åœ¨å…¨çƒæœ€å¤§çš„å¼€æºé¡¹ç›®æ‰˜ç®¡å¹³å°Githubä¸Šè¿›è¡Œä»£ç ç‰ˆæœ¬æ§åˆ¶ã€‚ ä½†ä¸€èˆ¬ä¼ä¸šéƒ½ä¼šæœ‰è‡ªå·±çš„Gitlabä»£ç æ‰˜ç®¡å¹³å°ï¼Œè¿™æ—¶å¦‚æœæ²¡æœ‰åœ¨Gitlabä¸Šé…ç½®å…¬ç§é’¥åˆ™ä¸èƒ½ä¸Šä¼ /ä¸‹è½½ä»£ç ã€‚ ç™»å½•ä¼ä¸šçš„Gitlabå¹³å°-&gt;å³ä¸Šè§’ä¸ªäººå¤´åƒ-&gt;Settings-&gt;SSH Keys-&gt;ç²˜è´´.sshæ–‡ä»¶å¤¹ä¸‹çš„id_rsa.pubå…¬é’¥å†…å®¹-&gt;ç¡®è®¤æ·»åŠ ã€‚ é…ç½®å®Œæˆåå³å¯åœ¨ä¼ä¸šçš„Gitlabå¹³å°ä¸Šä¼ /ä¸‹è½½ä»£ç ã€‚","link":"/2020/02/07/installed/install-git/"},{"title":"Windows 10ä¸‹IntelliJ IDEA 2019.3.2å®‰è£…å’Œå¸¸ç”¨é…ç½®","text":"ä»¥ä¸‹æ•™ç¨‹åŸºäºwindows 10å’ŒIntelliJ IDEA 2019.3.2ã€‚ ä¸‹è½½å¯ä» IntelliJ IDEAå®˜ç½‘ ä¸‹è½½æœ€æ–°å®‰è£…åŒ…ã€‚ è¿™é‡Œæˆ‘æä¾› ç™¾åº¦äº‘ç›˜ ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼šv9ojã€‚ å®‰è£… åŒå‡».exeå®‰è£…æ–‡ä»¶-&gt;Next-&gt;æŒ‡å®šå®‰è£…è·¯å¾„ï¼ˆå¯ç›´æ¥å¡«å†™ï¼Œä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼‰-&gt;Next-&gt;Next-&gt;Installï¼›ç­‰å¾…å®‰è£…å®Œæˆã€‚ å‹¾é€‰Run IntelliJ IDEA-&gt;Finish Do not import settings-&gt;OK-&gt;å‹¾é€‰I confirm that...-&gt;Continue-&gt;Don't Send é€‰æ‹©ç•Œé¢ä¸»é¢˜-&gt;Next: Default plugins-&gt;Next: Featured plugins-&gt;Start using IntelliJ IDEAï¼ˆè¿™ä¸€ç³»åˆ—æ¨èæŒ‰é»˜è®¤é…ç½®ï¼‰ Evaluate for free-&gt;Evaluate-&gt;Continue æ¿€æ´»ç”±äºæ³•å¾‹å…³ç³»ï¼Œè¯·å¤§å®¶å°½é‡æ”¯æŒæ­£ç‰ˆã€‚ å¸¸ç”¨é…ç½®ç‚¹å‡»File-&gt;Close Projectï¼Œå…³é—­ä¸»ç•Œé¢è¿›å…¥é€‰æ‹©é¡¹ç›®çª—å£ï¼ˆè¿™æ ·è®¾ç½®æ˜¯å…¨å±€è®¾ç½®ï¼Œè€Œä¸æ˜¯å•å¯¹äºæŸä¸ªé¡¹ç›®è®¾ç½®ï¼‰ã€‚ ç‚¹å‡»å³ä¸‹è§’Configure-&gt;Settingsï¼Œæ‰“å¼€è®¾ç½®é¢æ¿ã€‚ è®¾ç½®æ¯æ¬¡æ‰“å¼€éƒ½æ˜¯é€‰æ‹©é¡¹ç›®ç•Œé¢ã€‚Appearance &amp; Behavior-&gt;System Settings-&gt;å–æ¶ˆå‹¾é€‰Reopen last project on startup å–æ¶ˆè‡ªåŠ¨æ£€æŸ¥æ›´æ–°ã€‚Appearance &amp; Behavior-&gt;System Settings-&gt;Updates-&gt;å–æ¶ˆå‹¾é€‰Automatically check updates for è®¾ç½®é¼ æ ‡æ”¾åˆ°ç±»æˆ–æ–¹æ³•ä¸Šè‡ªåŠ¨æ˜¾ç¤ºæ³¨é‡Šæ–‡æ¡£ã€‚Editor-&gt;General-&gt;å‹¾é€‰Show quick documentation on mouse move å¯åœ¨ä¸‹æ–¹è®¾ç½®æ˜¾ç¤ºçš„å»¶è¿Ÿæ¯«ç§’æ•°Tooltip delay è®¾ç½®å­—ä½“å’Œå­—ä½“å¤§å°Editor-&gt;Font è®¾ç½®åˆ›å»ºJavaç±»æ—¶çš„å¤´éƒ¨æ³¨é‡Šæ¨¡æ¿ã€‚Editor-&gt;File and Code Templates-&gt;Includes-&gt;File Header å³ä¾§è¾“å…¥æ³¨é‡Šæ¨¡æ¿ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š 123456/** * @author sunchaser * @date ${DATE} * @description * @since 1.0 */ è®¾ç½®æ–‡ä»¶ç¼–ç å­—ç¬¦é›†ã€‚Editor-&gt;File Encodings ç»Ÿä¸€é€‰æ‹©UTF-8/with NO BOMã€‚ è®¾ç½®GitåŠGitHubã€‚Version Control-&gt;Git/GitHub é€‰æ‹©Gitå®‰è£…ç›®å½•ä¸‹çš„bin\\git.exeæ–‡ä»¶ã€‚æœ‰å…³Gitçš„å®‰è£…é…ç½®ï¼Œå¯å‚è€ƒ è¿™ç¯‡æ–‡ç«  è¾“å…¥ç”¨æˆ·å/å¯†ç ç™»å½•GitHubã€‚ è®¾ç½®Mavenã€‚Build,Execution,Deployment-&gt;Build Tools-&gt;Maven é€‰æ‹©Maven home directoryä¸ºæˆ‘ä»¬è‡ªå·±å®‰è£…çš„Mavenç›®å½•ï¼Œç‚¹å‡»Overrideè¦†ç›–é»˜è®¤çš„User settings fileå’ŒLocal repositoryã€‚ æœ‰å…³Mavençš„å®‰è£…å’Œé…ç½®ï¼Œå¯å‚è€ƒ è¿™ç¯‡æ–‡ç«  ã€‚ Build,Execution,Deployment-&gt;Build Tools-&gt;Maven-&gt;Importing/Runner é€‰æ‹©JDK for importer/JREä¸ºUse JAVA_HOME è®¾ç½®åºåˆ—åŒ–UIDç”Ÿæˆå¿«æ·é”®è®¾ç½®å®ç°äº†Serializableåºåˆ—åŒ–æ¥å£çš„ç±»ä¸­æœªå®šä¹‰serialVersionUIDå±æ€§æ—¶ç±»åå¤„æŠ¥é»„è‰²è­¦å‘Šï¼ŒæŒ‰å¿«æ·é”®alt+enteræœ‰å¿«æ·ç”Ÿæˆåºåˆ—åŒ–UIDçš„é€‰é¡¹ã€‚ Editor-&gt;Inspections æœç´¢Serializableï¼Œæ‰¾åˆ°Serializable class without 'serialVersionUID'ï¼Œå³ä¾§è¿›è¡Œå‹¾é€‰ã€‚ æ‰€æœ‰è®¾ç½®å®Œæˆåç‚¹å‡»å³ä¸‹è§’Apply-&gt;OKï¼Œå®Œæˆè®¾ç½®ã€‚","link":"/2020/02/07/installed/install-idea/"},{"title":"Windows 10ä¸‹JDKå®‰è£…åŠç¯å¢ƒå˜é‡é…ç½®","text":"ç”±äºJDKå¼€å§‹æ”¶è´¹ï¼Œç°åœ¨å¤§å¤šæ•°ä¼ä¸šä½¿ç”¨çš„Javaç‰ˆæœ¬æ˜¯Java8æˆ–è€…ä»¥ä¸‹ï¼ŒJava8çš„ä½¿ç”¨è€…å±…å¤šã€‚æˆ‘ä»¬åœ¨å­¦ä¹ æˆ–å¼€å‘ä¸­ï¼Œä¸‹è½½Java8å°±è¶³å¤Ÿä½¿ç”¨äº†ã€‚ ä¸‹è½½JDKå®‰è£…åŒ…å¯å‰å¾€ Oracleå®˜ç½‘ ä¸‹è½½ã€‚ è¿™é‡Œæˆ‘åˆ†äº« ç™¾åº¦äº‘ç›˜ ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼š5mxhã€‚ è¿›è¡Œå®‰è£…åŒå‡»è¿è¡Œ.exeåç¼€æ–‡ä»¶ï¼Œè¿è¡Œå®‰è£…ç¨‹åºï¼Œæ³¨æ„ä¸‹å›¾æ‰€ç¤ºåœ°æ–¹ï¼Œå»é™¤å…¬å…±JREçš„å®‰è£…ï¼Œç‚¹å‡»å·¦ä¾§çš„å°å›¾æ ‡é€‰æ‹©æ­¤åŠŸèƒ½å°†ä¸å¯ç”¨ã€‚ç‚¹å‡»å¼€å‘å·¥å…·æ›´æ”¹å®‰è£…è·¯å¾„ï¼Œç»§ç»­ä¸‹ä¸€æ­¥ç›´è‡³å®Œæˆå®‰è£…å³å¯ã€‚ é…ç½®ç¯å¢ƒå˜é‡å³å‡»æˆ‘çš„ç”µè„‘-&gt;å±æ€§-&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®-&gt;é«˜çº§-&gt;ç¯å¢ƒå˜é‡ åœ¨ç³»ç»Ÿå˜é‡å¤„ç‚¹å‡»æ–°å»ºï¼Œè¾“å…¥å˜é‡åï¼šJAVA_HOMEï¼Œå˜é‡å€¼ä¸ºä¸Šè¿°JDKå®‰è£…æ­¥éª¤ä¸­æ›´æ”¹çš„å®‰è£…è·¯å¾„ï¼Œç‚¹å‡»ç¡®å®šã€‚ é€‰ä¸­ç³»ç»ŸPathå˜é‡ï¼Œç‚¹å‡»ç¼–è¾‘-&gt;æ–°å»ºï¼Œè¾“å…¥%JAVA_HOME%\\bin\\ï¼Œç‚¹å‡»ç¡®å®šã€‚ æœ€åä¸€ç›´ç¡®å®šä¸‹å»è‡³çª—å£å…³é—­å³å¯ã€‚ æ£€éªŒæŒ‰ä¸‹win+Ré”®ï¼Œè¾“å…¥cmdï¼Œå›è½¦ï¼Œè¾“å…¥å‘½ä»¤java -versionï¼Œå‡ºç°ä¸‹å›¾æ‰€ç¤ºå†…å®¹å³è¡¨ç¤ºé…ç½®æˆåŠŸã€‚ é¢˜å¤–è¯ç½‘ä¸Šå¾ˆå¤šè€çš„æ•™ç¨‹è¿˜éœ€è¦é…ç½®CLASSPATHå˜é‡ï¼Œè¿™ä¸ªæ˜¯JDKçš„å†å²åŸå› ï¼Œç°åœ¨JDKç›®å½•ä¸‹å·²åŒ…å«ä¸“ç”¨çš„JREï¼Œæ— éœ€å†è¿›è¡Œé¢å¤–é…ç½®ã€‚","link":"/2020/02/07/installed/install-jdk/"},{"title":"Windows 10ä¸‹Mavenå®‰è£…åŠé…ç½®","text":"ä¸‹è½½å¯ä» Mavenå®˜ç½‘ ä¸‹è½½Binary zip archiveæœ€æ–°å‹ç¼©åŒ…ã€‚ è¿™é‡Œæˆ‘æä¾› ç™¾åº¦äº‘ç›˜ ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼šolx2ã€‚ å®‰è£…mavenä¸ºç»¿è‰²å®‰è£…ï¼Œä¸‹è½½å®Œæˆåè§£å‹è‡³è‡ªå®šä¹‰ç›®å½•å³å¯ã€‚ æ³¨æ„ï¼šè§£å‹è·¯å¾„ä¸è¦åŒ…å«ä¸­æ–‡ã€‚ å®‰è£…æ–‡ä»¶ç®€ä»‹è§£å‹ç›®å½•åŒ…å«4ä¸ªæ–‡ä»¶å¤¹bin/boot/conf/libï¼Œå…¶å­˜æ”¾çš„æ–‡ä»¶åˆ†åˆ«ä¸ºï¼š binï¼šmavençš„ä¸€äº›å¯æ‰§è¡Œç¨‹åºã€‚ bootï¼šä¸€äº›å¯åŠ¨å¼•å¯¼ç¨‹åºï¼Œä¾‹å¦‚ç±»åŠ è½½å™¨ç­‰ã€‚ confï¼šé…ç½®æ–‡ä»¶ã€‚ libï¼šmavenè‡ªèº«è¿è¡Œä¾èµ–çš„åº“ã€‚ é…ç½®mavené…ç½®ç¯å¢ƒå˜é‡å³å‡»æˆ‘çš„ç”µè„‘-&gt;å±æ€§-&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®-&gt;é«˜çº§-&gt;ç¯å¢ƒå˜é‡ åœ¨ç³»ç»Ÿå˜é‡å¤„ç‚¹å‡»æ–°å»ºï¼Œè¾“å…¥å˜é‡åï¼šMAVEN_HOMEï¼Œå˜é‡å€¼ä¸Šè¿°mavençš„è§£å‹ç›®å½•ï¼Œç‚¹å‡»ç¡®å®šã€‚ é€‰ä¸­ç³»ç»ŸPathå˜é‡ï¼Œç‚¹å‡»ç¼–è¾‘-&gt;æ–°å»ºï¼Œè¾“å…¥%MAVEN_HOME%\\bin\\ï¼Œç‚¹å‡»ç¡®å®šã€‚ æœ€åä¸€ç›´ç¡®å®šä¸‹å»è‡³çª—å£å…³é—­å³å¯ã€‚ æŒ‰ä¸‹win+Ré”®ï¼Œè¾“å…¥cmdï¼Œå›è½¦ï¼Œè¾“å…¥å‘½ä»¤mvn -vï¼Œå‡ºç°ä¸‹å›¾æ‰€ç¤ºå†…å®¹å³è¡¨ç¤ºé…ç½®æˆåŠŸã€‚ é…ç½®æœ¬åœ°ä»“åº“æ–°å»ºä¸€ä¸ªè‡ªå®šä¹‰ç›®å½•repositoryä½œä¸ºæœ¬åœ°ä»“åº“ï¼Œä¸€èˆ¬å’ŒMavençš„è§£å‹ç›®å½•åœ¨åŒçº§ã€‚ ç„¶ååœ¨Mavençš„å®‰è£…ç›®å½•ä¸‹æ‰¾åˆ°confç›®å½•ä¸‹çš„settings.xmlé…ç½®æ–‡ä»¶ï¼Œç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ï¼Œæ‰¾åˆ°å¤§æ¦‚ç¬¬55è¡Œçš„ä½ç½®ï¼Œè¾“å…¥ä»¥ä¸‹æ ‡ç­¾æŒ‡å®šæœ¬åœ°ä»“åº“çš„ä½ç½®ï¼š 1&lt;localRepository&gt;E:\\develop\\maven\\repository&lt;/localRepository&gt; æ ¹æ®ä¸ªäººå®‰è£…ä½ç½®è¾“å…¥ä»“åº“è·¯å¾„ã€‚ é…ç½®é˜¿é‡Œäº‘é•œåƒä»“åº“ åœ¨settings.xmlæ–‡ä»¶å¤§çº¦160è¡Œçš„åœ°æ–¹ï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹é…ç½®é˜¿é‡Œäº‘Mavené•œåƒï¼š 1234567&lt;!-- è¿™ä¸ªæ˜¯é…ç½®é˜¿é‡ŒMavené•œåƒ --&gt;&lt;mirror&gt; &lt;id&gt;alimaven&lt;/id&gt; &lt;name&gt;aliyun maven&lt;/name&gt; &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;&lt;/mirror&gt; æ€»ç»“è‡³æ­¤ï¼ŒMavençš„é…ç½®å°±å®Œæˆäº†ã€‚","link":"/2020/02/07/installed/install-maven/"},{"title":"Windows 10ä¸‹Node.jså®‰è£…ä¸é…ç½®","text":"ä¸‹è½½å¯ä» Node.jsä¸­æ–‡å®˜ç½‘ ä¸‹è½½æœ€æ–°é•¿æœŸæ”¯æŒç‰ˆå®‰è£…åŒ…ã€‚ è¿™é‡Œæˆ‘æä¾›12.15.0é•¿æœŸæ”¯æŒç‰ˆ ç™¾åº¦äº‘ç›˜ ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼šitoeã€‚ å®‰è£…åŒå‡»å®‰è£…åŒ…æ–‡ä»¶è¿›è¡Œå®‰è£…ï¼Œè‡ªå®šä¹‰å®‰è£…ä½ç½®ï¼Œå…¶ä½™ä¿æŒé»˜è®¤ä¸€ç›´nextä¸‹å»ã€‚ æŒ‰ä¸‹win+Ré”®ï¼Œè¾“å…¥cmdï¼Œå›è½¦ï¼Œåˆ†åˆ«è¾“å…¥å‘½ä»¤node -vå’Œnpm -vï¼Œå‡ºç°ä¸‹å›¾æ‰€ç¤ºå†…å®¹å³è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚ è¯´æ˜ï¼šæ–°ç‰ˆæœ¬Node.jsè‡ªå¸¦npmï¼Œå®‰è£…Node.jsæ—¶ä¼šä¸€èµ·å®‰è£…ï¼Œnpmæ˜¯Node.jsçš„ä¾èµ–åŒ…ç®¡ç†å·¥å…·ï¼Œå¯å¤§è‡´ç†è§£æˆmaven/Composerç­‰ã€‚ å…¨å±€é…ç½®åœ¨æ‰§è¡Œç±»ä¼¼ï¼šnpm install express [-g] ï¼ˆåé¢çš„å¯é€‰å‚æ•°-gï¼Œgä»£è¡¨globalå…¨å±€å®‰è£…çš„æ„æ€ï¼‰çš„å®‰è£…è¯­å¥æ—¶ï¼Œé»˜è®¤ä¼šå°†å®‰è£…çš„æ¨¡å—å®‰è£…åˆ°C:\\Users\\ç”¨æˆ·å\\AppData\\Roaming\\npmè·¯å¾„ä¸­ï¼Œå ç”¨Cç›˜ç©ºé—´ã€‚ æˆ‘ä»¬å¸Œæœ›å°†å…¨å±€æ¨¡å—è·¯å¾„å’Œç¼“å­˜è·¯å¾„æ”¾ç½®åœ¨è‡ªå®šä¹‰ç›®å½•ï¼ˆéCç›˜ï¼‰ä¸­ã€‚è¿™é‡Œæˆ‘åœ¨Node.jså®‰è£…ç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹node_globalå’Œnode_cacheã€‚å¦‚ä¸‹å›¾ï¼š ç©ºæ–‡ä»¶å¤¹åˆ›å»ºå®Œæˆåï¼ŒæŒ‰ä¸‹win+Ré”®ï¼Œè¾“å…¥cmdï¼Œå›è½¦ï¼Œåˆ†åˆ«è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š 123npm config set prefix &quot;E:\\develop\\nodejs\\node_global&quot;npm config set cache &quot;E:\\develop\\nodejs\\node_cache&quot; é…ç½®ç¯å¢ƒå˜é‡é¼ æ ‡å³å‡»æˆ‘çš„ç”µè„‘-&gt;å±æ€§-&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®-&gt;é«˜çº§-&gt;ç¯å¢ƒå˜é‡ åœ¨ç³»ç»Ÿå˜é‡å¤„ç‚¹å‡»æ–°å»ºï¼Œè¾“å…¥å˜é‡åï¼šNODE_HOMEï¼Œå˜é‡å€¼ä¸ºE:\\develop\\nodejs\\node_global\\node_modulesï¼šä¸Šè¿°å…¨å±€é…ç½®ä¸­çš„node_globalè·¯å¾„åå†åŠ ä¸€ä¸ªnode_modulesæ–‡ä»¶å¤¹ï¼ˆä¸ç”¨æ‰‹åŠ¨åˆ›å»ºï¼‰ï¼Œç‚¹å‡»ç¡®å®šã€‚ é€‰ä¸­ç”¨æˆ·å˜é‡Pathï¼Œç‚¹å‡»ç¼–è¾‘ï¼Œå°†é»˜è®¤çš„C:\\Users\\ç”¨æˆ·å\\AppData\\Roaming\\npmæ”¹ä¸ºE:\\develop\\nodejs\\node_globalï¼šä¸Šè¿°å…¨å±€é…ç½®ä¸­çš„node_globalï¼Œç‚¹å‡»ç¡®å®šã€‚ æœ€åä¸€ç›´ç¡®å®šä¸‹å»è‡³æ‰€æœ‰çª—å£å…³é—­å³å¯ã€‚ æ€»ç»“æœ€åï¼Œåˆ é™¤é»˜è®¤çš„C:\\Users\\lilu\\AppData\\Roaming\\npmæ–‡ä»¶å¤¹ã€‚ è‡³æ­¤Node.jsçš„å®‰è£…å’Œé…ç½®å°±å·²å®Œæˆï¼Œå¯ä½¿ç”¨npm install -gå‘½ä»¤ä¸‹è½½ä»»æ„jsä¾èµ–æ£€éªŒæ˜¯å¦å°†åŒ…ä¸‹è½½è‡³äº†æˆ‘ä»¬æŒ‡å®šçš„è·¯å¾„ä¸‹ã€‚","link":"/2020/02/07/installed/install-nodejs/"},{"title":"é‡è£…Windows10ç³»ç»Ÿ","text":"åˆ¶ä½œé‡è£…å¯åŠ¨Uç›˜ï¼Œæ¨è å¤§ç™½èœ Uç›˜åˆ¶ä½œå·¥å…·ã€‚ ä¸‹è½½win10é•œåƒæ–‡ä»¶ï¼Œä¸€èˆ¬å» MSDNæˆ‘å‘Šè¯‰ä½  ä¸‹è½½ã€‚å¤§å®¶éƒ½æ˜¯64ä½çš„CPUï¼Œä½ åº”è¯¥ä¸‹è½½64ä½ç‰ˆæœ¬çš„é•œåƒã€‚ ç™¾åº¦æœç´¢å¯¹åº”æœºå‹Uç›˜å¯åŠ¨å¿«æ·é”®ï¼Œè¿›è¡Œé‡è£…ã€‚ é‡è£…ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹ä¸­æœ‰ä¸€äº›å¯é€‰é…ç½®é¡¹ï¼Œä¸€èˆ¬éƒ½ä¸å‹¾é€‰ï¼Œæ²¡æœ‰å¿…è¦ã€‚åœ¨åˆ›å»ºç”¨æˆ·ç•Œé¢è¯·ä½¿ç”¨è„±æœºè´¦æˆ·ç™»å½•ï¼Œè„±æœºè´¦æˆ·å¯æ‰‹åŠ¨è®¾ç½®ç”¨æˆ·åã€‚ä¸è¦ä½¿ç”¨outlooké‚®ç®±ç™»å½•ï¼ŒåŸå› æ˜¯ä½¿ç”¨outlooké‚®ç®±ç™»å½•çš„è¯ï¼Œç”±äºç”¨æˆ·åè®¾ç½®è§„åˆ™ï¼Œåªä¼šå–é‚®ç®±çš„å‰äº”ä¸ªå­—ç¬¦ï¼Œä½œä¸ºå¾®è½¯ç”¨æˆ·ç»‘å®šçš„ç³»ç»Ÿç®¡ç†å‘˜ç”¨æˆ·åã€‚å¯èƒ½ä¼šé€ æˆC:\\Usersç›®å½•ä¸‹çš„ç”¨æˆ·åä¸æ˜¯ä½ æƒ³è¦çš„ã€‚é‡è£…å®Œæˆåå†åˆ°è®¾ç½®ä¸­ä½¿ç”¨outlooké‚®ç®±ç™»å½•å³å¯ã€‚è¿™æ ·ç³»ç»Ÿç”¨æˆ·åå°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„åç§°ã€‚ é‡è£…å®Œæˆåç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œä¸€äº›åŸºæœ¬è®¾ç½®ï¼Œç„¶åè¿›å…¥æ¡Œé¢ä¼šæç¤ºç­‰å¾…ç³»ç»Ÿéƒ¨ç½²å®Œæˆã€‚è¿™æ—¶ç­‰å¾…ä¸€ä¼šå³å¯ã€‚ä¸€èˆ¬ä¼šå®‰è£…ä¸€äº›ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼Œä¾‹å¦‚360/çˆ±å¥‡è‰º/æ·˜å®ç­‰ï¼Œå¤§å¯ä¸å¿…è§‰å¾—â€œæ¶å¿ƒâ€ï¼Œç¨åæˆ‘ä»¬ä¼šè¿›è¡Œæ¸…ç†ã€‚ ä¸€èˆ¬win10ç³»ç»Ÿå®‰è£…å®Œæˆåæ¡Œé¢ä¸Šæ²¡æœ‰æˆ‘çš„ç”µè„‘/æ§åˆ¶é¢æ¿ç­‰å›¾æ ‡ï¼Œåªæœ‰ä¸€ä¸ªå›æ”¶ç«™ã€‚å¯ä»¥é¼ æ ‡å³é”®ç‚¹å‡»æ¡Œé¢ç©ºç™½å¤„-&gt;ä¸ªæ€§åŒ–è®¾ç½®-&gt;ä¸»é¢˜-&gt;ç›¸å…³çš„è®¾ç½®ï¼ˆæ¡Œé¢å›¾æ ‡è®¾ç½®ï¼‰ï¼Œå‹¾é€‰è®¡ç®—æœº/æ§åˆ¶é¢æ¿ç­‰ï¼Œç‚¹å‡»ç¡®å®šå³å¯ã€‚è¿™æ—¶å‘ç°æ¡Œé¢å›¾æ ‡æ’åˆ—é¡ºåºæœ‰ç‚¹ä¸å¥½ï¼Œå¯é¼ æ ‡å³é”®ç‚¹å‡»åˆ·æ–°æ¡Œé¢ï¼Œå¦‚æœè¿˜ä¸è¡Œåˆ™é¼ æ ‡å³é”®ç‚¹å‡»æ¡Œé¢ç©ºç™½å¤„-&gt;æ’åºæ–¹å¼-&gt;åç§°ï¼Œé‡å¤ä¸¤éå³å¯ã€‚ æ¿€æ´»Windowsï¼Œå»ºè®®åœ¨æŸå®è´­ä¹°æ”¯æŒé‡è£…çš„æ¿€æ´»ç ï¼Œä¸€æ¬¡è´­ä¹°ï¼Œå¤šæ¬¡ä½¿ç”¨ã€‚ä¸æ¨èä½¿ç”¨ç¬¬ä¸‰æ–¹æ¿€æ´»å·¥å…·æ¿€æ´»ã€‚ å¼€å§‹æ¸…ç†ç³»ç»Ÿåˆå§‹ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼Œå¯åˆ©ç”¨è‡ªåŠ¨å®‰è£…çš„360è½¯ä»¶ç®¡å®¶ï¼Œå¸è½½è¿™äº›åº”ç”¨ã€‚æœ€ååœ¨å¸è½½360ã€‚åœ¨å¸è½½åº”ç”¨æ—¶æ³¨æ„å‹¾é€‰åˆ é™¤åœ¨æœ¬æœºä¿å­˜çš„ä¸ªäººé…ç½®æ•°æ®ç­‰ç±»ä¼¼é€‰é¡¹ã€‚ ç‚¹å‡»å¼€å§‹èœå•ï¼Œåœ¨å·¦ä¾§èœå•å’ŒåŠ¨æ€ç£è´´ä¸­ä¸€èˆ¬ä¼šæœ‰ä¸€äº›æ²¡ä»€ä¹ˆç”¨çš„Windowsåº”ç”¨ï¼Œä¾‹å¦‚ä¸€äº›æ¸¸æˆç­‰ï¼Œå¦‚æœä¸éœ€è¦officeç­‰ä¹Ÿå¯ä»¥è¿›è¡Œå¸è½½ã€‚ç‚¹å‡»é¼ æ ‡å³é”®å³æœ‰å¸è½½æŒ‰é’®ã€‚ è¿™æ—¶ç³»ç»ŸåŸºæœ¬æ¸…ç†å®Œæˆï¼Œä½†è¿˜æ˜¯ä¼šæœ‰ä¸€äº›æ®‹ç•™æ–‡ä»¶å¤¹å­˜åœ¨ï¼Œè¿›å…¥C:/Program Files (x86)ç›®å½•ï¼Œå¦‚æœçœ‹åˆ°ä¸€äº›360/tencentç­‰æ–‡ä»¶å¤¹å¯ç›´æ¥åˆ é™¤ï¼Œå¦‚æœæç¤ºæ“ä½œæ— æ³•å®Œæˆï¼Œå› ä¸ºå…¶ä¸­çš„æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶å·²åœ¨å¦ä¸€ç¨‹åºä¸­æ‰“å¼€ï¼Œåˆ™å¯å…ˆæ”¾ç€ï¼Œç­‰å°†å…¶å®ƒç±»ä¼¼æ–‡ä»¶å¤¹åˆ é™¤åï¼Œç¨åé‡å¯ç”µè„‘å³å¯åˆ é™¤ã€‚ æ‰“å¼€æˆ‘çš„ç”µè„‘ï¼Œç‚¹å‡»ä¸Šæ–¹æŸ¥çœ‹ï¼Œå‹¾é€‰æ–‡ä»¶æ‰©å±•å/éšè—çš„é¡¹ç›®ã€‚é‡å¯ç”µè„‘ï¼Œé‡å¯å®Œæˆåå³å¯åˆ é™¤ä¸Šè¿°æ‰€è¯´æ— æ³•åˆ é™¤çš„æ–‡ä»¶å¤¹ã€‚ ä¸‹é¢å¼€å§‹å®‰è£…æˆ‘ä»¬çš„ä¸ªäººè½¯ä»¶ï¼Œé¦–å…ˆå®‰è£…360ã€‚ ä¸ºä»€ä¹ˆå®‰è£…360ï¼Ÿ æœ‰äº›äººè§‰å¾—360æ˜¯æµæ°“è½¯ä»¶ï¼Œå½±å“ç”µè„‘è¿è¡Œé€Ÿåº¦ï¼Œä½†æˆ‘è§‰å¾—360æœ‰äº›åŠŸèƒ½è¿˜æ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚æ¸…ç†åƒåœ¾/ç¦æ­¢å¼€æœºå¯åŠ¨é¡¹ç­‰ã€‚ ä¸ºä»€ä¹ˆå¸è½½ç³»ç»Ÿå®‰è£…å®Œæˆåè‡ªå¸¦çš„360ï¼Ÿ å› ä¸ºè‡ªå¸¦çš„360å®‰è£…åœ¨Cç›˜ï¼Œä¸å¥½ã€‚å» 360å®˜ç½‘ ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…ã€‚åŒå‡»å®‰è£…åŒ…ï¼Œé€‰æ‹©è‡ªå®šä¹‰å®‰è£…ï¼Œé€‰æ‹©å®‰è£…è·¯å¾„ä¸ºè‡ªå®šä¹‰ç›˜ï¼ˆéCç›˜ï¼‰ã€‚ è¿›è¡Œæ¸…ç†ä¼˜åŒ– å®‰è£…å®Œæˆåæ‰“å¼€360ä¸»ç•Œé¢ï¼Œç‚¹å‡»åŠŸèƒ½å¤§å…¨-&gt;æˆ‘çš„å·¥å…·ï¼Œåˆ é™¤ä¸€äº›æ²¡ç”¨çš„è‡ªå¸¦å·¥å…·ã€‚ä¸€èˆ¬åªç•™ä¸€ä¸ªè½¯ä»¶ç®¡å®¶å³å¯ã€‚ç‚¹å‡»ç”µè„‘æ¸…ç†æ¸…ç†ç³»ç»Ÿåƒåœ¾ã€‚å‹¾é€‰ä¸€äº›ç—•è¿¹ä¿¡æ¯å’ŒCookieä¿¡æ¯ç­‰ã€‚ç‚¹å‡»ä¼˜åŒ–åŠ é€Ÿç¦ç”¨ä¸€äº›å¼€æœºå¯åŠ¨é¡¹ã€‚æ‰«æå®Œæˆåå‹¾é€‰ä¸€äº›éœ€è¦ä¼˜åŒ–çš„é¡¹ï¼Œç‚¹å‡»ç«‹å³ä¼˜åŒ–ã€‚ å®‰è£…é©±åŠ¨å¤§å¸ˆæ›´æ–°é©±åŠ¨ åœ¨åŠŸèƒ½å¤§å…¨ä¸­æœç´¢æ‰¾åˆ°360é©±åŠ¨å¤§å¸ˆï¼Œç‚¹å‡»å®‰è£…ï¼Œè¿›è¡Œç³»ç»Ÿé©±åŠ¨æ›´æ–°ã€‚é©±åŠ¨å¤§å¸ˆä¼šè‡ªåŠ¨è¿›è¡Œå¤‡ä»½ä¸‹è½½æ›´æ–°ï¼Œå¤‡ä»½çš„ç›®å½•å¯åœ¨é©±åŠ¨å¤§å¸ˆçš„è®¾ç½®ä¸­æŒ‡å®šï¼Œé»˜è®¤ä¸360å®‰è£…ç›®å½•åœ¨åŒä¸€ç›˜ç¬¦ä¸‹ã€‚ é©±åŠ¨æ›´æ–°å®Œæˆåé‡å¯ç”µè„‘ï¼Œé‡å¯ååˆ é™¤é©±åŠ¨å¤§å¸ˆã€‚åœ¨360å®‰å…¨å«å£«ä¸­-&gt;åŠŸèƒ½å¤§å…¨-&gt;æˆ‘çš„å·¥å…·ä¸­åˆ é™¤é©±åŠ¨å¤§å¸ˆï¼Œå¯é€‰æ‹©å‹¾é€‰åˆ é™¤å·²å¤‡ä»½å’Œä¸‹è½½çš„é©±åŠ¨ã€‚ å®‰è£…å…¶å®ƒè½¯ä»¶ï¼ˆå¯é€‰ï¼‰ 360å‹ç¼©ï¼šè§£å‹ç¼©è½¯ä»¶æœ‰å¾ˆå¤šé€‰æ‹©ï¼Œæ¯”å¦‚WinR/7zç­‰ï¼Œè¿™é‡Œç”±äºå®‰è£…äº†360ï¼Œé€‰æ‹©360å‹ç¼©å³å¯ã€‚è¿›å…¥360å®‰å…¨å«å£«ä¸»ç•Œé¢-&gt;åŠŸèƒ½å¤§å…¨-&gt;æœç´¢é€‰æ‹©360å‹ç¼©-&gt;ç‚¹å‡»è¿›è¡Œå®‰è£…-&gt;å®‰è£…å®Œæˆåä¼šå¼¹å‡ºä¸»ç•Œé¢-&gt;ç‚¹å‡»å³ä¸Šè§’å·¥å…·-&gt;è®¾ç½®-&gt;å–æ¶ˆå‹¾é€‰å¸¸è§„ä¸­çš„å¼€å¯è‡ªåŠ¨å‡çº§/æ”¹å–„è®¡åˆ’ä¸­çš„å‚ä¸â€œ360ç”¨æˆ·ä½“éªŒæ”¹å–„è®¡åˆ’â€-&gt;ç¡®å®šã€‚å¯¹äºå³ä¸‹è§’å¯èƒ½å‡ºç°çš„å¼¹çª—ï¼Œè¯·ç‚¹å‡»å¼¹çª—å³ä¸Šè§’çš„Ã—è¿›è¡Œå…³é—­ã€‚ æœç‹—è¾“å…¥æ³•ï¼šå‰å¾€ æœç‹—è¾“å…¥æ³•å®˜ç½‘ ä¸‹è½½æœ€æ–°å®‰è£…åŒ…ï¼Œä¸‹è½½å®ŒæˆååŒå‡»è¿è¡Œ-&gt;é€‰æ‹©è‡ªå®šä¹‰å®‰è£…-&gt;é€‰æ‹©å®‰è£…ç›®å½•-&gt;ç‚¹å‡»å®‰è£…-&gt;å–æ¶ˆå‹¾é€‰å®Œæˆç•Œé¢çš„ä¸€äº›æ†ç»‘å®‰è£…çš„é€‰é¡¹ã€‚å®‰è£…å®Œæˆåè¿›è¡Œæœç‹—è¾“å…¥æ³•çš„ä¸€äº›åŸºæœ¬è®¾ç½®å³å¯ï¼Œæœç‹—è¾“å…¥æ³•æ¯å¤©ä¼šåœ¨å³ä¸‹è§’å¼¹å‡ºä¸€ä¸ªå¼¹çª—ï¼Œä¸è¦ç‚¹å‡»ä¸åœ¨æç¤ºï¼Œè¯·ç‚¹å‡»å³ä¸Šè§’çš„Ã—ï¼Œä¸ç„¶ä¼šä¸‹è½½æœç‹—æµè§ˆå™¨ã€‚ æœ‰é“äº‘ç¬”è®°ï¼šå‰å¾€ æœ‰é“äº‘ç¬”è®°å®˜ç½‘ ä¸‹è½½æœ€æ–°å®‰è£…åŒ…-&gt;åŒå‡»è¿è¡Œ-&gt;è‡ªå®šä¹‰å®‰è£…-&gt;æŒ‡å®šå®‰è£…ç›®å½•-&gt;å–æ¶ˆå‹¾é€‰æœ‰é“ç¿»è¯‘å®‰è£…ã€‚å®‰è£…å®Œæˆåè¿›è¡Œç™»å½•ï¼Œç™»å½•åç‚¹å‡»å³ä¸Šè§’-&gt;è®¾ç½®ï¼Œå–æ¶ˆå‹¾é€‰å¯åŠ¨windowsæ—¶å¯åŠ¨æœ‰é“äº‘ç¬”è®°/è‡ªåŠ¨æ£€æŸ¥å®¢æˆ·ç«¯æ›´æ–°ã€‚é»˜è®¤æƒ…å†µä¸‹æœ¬åœ°æ–‡ä»¶ä¼šä¿å­˜åœ¨C:\\Users\\ç”¨æˆ·å\\AppData\\Local\\YNoteç›¸å…³ç›®å½•ä¸‹ï¼Œåœ¨å®‰è£…æ—¶æŒ‡å®šå¯èƒ½æ²¡æœ‰æ•ˆæœã€‚å¦‚æœæƒ³è®©æœ¬åœ°æ–‡ä»¶ä¸ä¿å­˜åœ¨Cç›˜å¯åœ¨è®¾ç½®ä¸­è¿›è¡ŒæŒ‡å®šï¼Œæœ‰é“äº‘ç¬”è®°ä¼šè‡ªåŠ¨è¿›è¡Œæ•°æ®è¿ç§»ã€‚ ç™¾åº¦ç½‘ç›˜ï¼šå‰å¾€ ç™¾åº¦äº‘ç½‘ç›˜å®˜ç½‘ ä¸‹è½½æœ€æ–°å®‰è£…åŒ…-&gt;åŒå‡»è¿è¡Œ-&gt;è‡ªå®šä¹‰å®‰è£…-&gt;æŒ‡å®šå®‰è£…ç›®å½•-&gt;å®Œæˆåç™»å½•-&gt;è¿›å…¥ä¸»ç•Œé¢åç‚¹å‡»å³ä¸Šè§’è®¾ç½®-&gt;å–æ¶ˆå‹¾é€‰å¼€æœºæ—¶å¯åŠ¨ç™¾åº¦ç½‘ç›˜(æ¨è)ã€‚ è‡³æ­¤ï¼Œç”µè„‘é‡è£…ç³»ç»ŸåŸºæœ¬å®Œæˆï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œåº”ç”¨è½¯ä»¶å®‰è£…äº†ã€‚","link":"/2020/02/07/installed/install-windows10/"},{"title":"åŸºæœ¬æ•°æ®ç±»å‹charä¸ºä»€ä¹ˆä¸ä¼šè¢«éšå¼è½¬æ¢æˆbyteæˆ–shortç±»å‹ï¼Ÿ","text":"Javaçš„åŸºæœ¬æ•°æ®ç±»å‹ä¸­çš„æ•°å€¼ç±»å‹åŒ…æ‹¬ï¼šbyte/char/short/int/float/double/long å…¶æ•°å€¼èŒƒå›´å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š åŸºæœ¬ç±»å‹ å¤§å° èŒƒå›´ byte 8 bits [-128, +127] char 16 bits [â€˜\\u0000â€™, â€˜\\uFFFFâ€™] å³ [0, 2^16 - 1] short 16 bits [-2^15, +2^15 - 1] int 32 bits [-2^31, +2^31 - 1] float 32 bits IEEE754èŒƒå›´ double 64 bits IEEE754èŒƒå›´ long 64 bits [-2^63, +2^63 - 1] æ³¨ï¼šè¡¨æ ¼ä¸­çš„ â€˜[â€˜ å’Œ â€˜]â€™ è¡¨ç¤ºé—­åŒºé—´ï¼›IEEE754èŒƒå›´å‚è€ƒwiki charç±»å‹çš„è¡¨ç¤ºèŒƒå›´å¯é€šè¿‡ä»¥ä¸‹ä»£ç æŸ¥çœ‹ï¼š0-65535 12System.out.println(Character.MIN_VALUE + 1 - 1);System.out.println(Character.MAX_VALUE + 1 - 1); byteç±»å‹åªå ä¸€ä¸ªå­—èŠ‚ï¼ˆ8æ¯”ç‰¹ï¼‰ï¼Œè€Œcharå’Œshortéƒ½å ä¸¤ä¸ªå­—èŠ‚ã€‚charè½¬æˆbyteä¼šå‡ºç°è£…ä¸ä¸‹çš„æƒ…å†µï¼Œç²¾åº¦ä¸¢å¤±ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨è¿›è¡Œéšå¼è½¬æ¢ï¼› shortç±»å‹è™½ç„¶å ä¸¤ä¸ªå­—èŠ‚ï¼Œä½†å…¶æœ€å¤§å€¼æ˜¯2^15-1ï¼Œcharçš„æœ€å¤§å€¼æ˜¯2^16-1ï¼Œä¼šå‡ºç°è½¬æ¢ä¸äº†çš„æƒ…å†µï¼Œæ‰€ä»¥ç¼–è¯‘å™¨ä¹Ÿä¸ä¼šè¿›è¡Œéšå¼è½¬æ¢ã€‚ intç±»å‹æ˜¯ç¬¬ä¸€ä¸ªæ•°å€¼èŒƒå›´æ¯”charå¤§çš„ç±»å‹ï¼Œæ‰€ä»¥åœ¨æ¶‰åŠåˆ°éšå¼è½¬æ¢æ—¶ï¼ŒJavaé»˜è®¤å°†charéšå¼è½¬æ¢æˆintã€‚","link":"/2020/01/09/javase/base/why-char-cannot-be-converted-to-byte-or-short/"},{"title":"æ–¹æ³•é‡è½½Overload","text":"åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œç›¸åŒçš„è¯å¯ä»¥è¡¨è¾¾å¤šç§ä¸åŒçš„å«ä¹‰â€”â€”å®ƒä»¬è¢«â€œé‡è½½äº†â€ã€‚ä¾‹å¦‚ï¼šâ€œå†¬å¤©èƒ½ç©¿å¤šå°‘ç©¿å¤šå°‘ã€‚å¤å¤©èƒ½ç©¿å¤šå°‘ç©¿å¤šå°‘ã€‚â€ã€â€œä¸­å›½è¶³çƒè°ä¹Ÿæ‰“ä¸è¿‡ã€‚ä¸­å›½ä¹’ä¹“çƒè°ä¹Ÿæ‰“ä¸è¿‡ã€‚â€ã€‚ç›¸åŒçš„åå­—ä½†è¡¨è¾¾å‡ºäº†ä¸åŒçš„å«ä¹‰ï¼Œè¿™å°±æ˜¯æ–¹æ³•é‡è½½ã€‚ æ„é€ å™¨é‡è½½æˆ‘ä»¬çŸ¥é“ç±»çš„æ„é€ å™¨åå­—å¿…é¡»ä¸ç±»åå®Œå…¨ç›¸åŒï¼Œä¸æ¥å—ä»»ä½•å‚æ•°çš„æ„é€ å™¨å«åšé»˜è®¤æ„é€ å™¨ï¼ŒåŒå…¶å®ƒæ–¹æ³•ä¸€æ ·ï¼Œæ„é€ å™¨ä¹Ÿèƒ½å¸¦æœ‰å½¢å¼å‚æ•°ï¼Œä»¥ä¾¿æŒ‡å®šå¦‚ä½•åˆ›å»ºå¯¹è±¡ã€‚è¿™é‡Œå°±ä½“ç°äº†æ–¹æ³•é‡è½½ï¼Œå®ƒä»¬éƒ½æœ‰ç›¸åŒçš„åå­—ï¼Œå³ç±»åï¼Œä½†å½¢å¼å‚æ•°ä¸åŒã€‚ åŒºåˆ†æ–¹æ³•é‡è½½å¦‚æœæœ‰å‡ ä¸ªåå­—ç›¸åŒçš„æ–¹æ³•ï¼ŒJavaå¦‚ä½•è¿›è¡ŒåŒºåˆ†å‘¢ï¼Ÿ è¯·è®°ä½æ–¹æ³•é‡è½½çš„æ¦‚å¿µï¼šæ–¹æ³•åç›¸åŒï¼Œä½†å½¢å‚åˆ—è¡¨ä¸åŒã€‚ å³ä½¿å½¢å‚é¡ºåºä¸åŒä¹Ÿè¶³ä»¥åŒºåˆ†ä¸¤ä¸ªæ–¹æ³•ã€‚ä½†æ˜¯æœ€å¥½åˆ«è¿™æ ·åšï¼Œç»†æƒ³ä¸€ä¸‹ï¼Œå¦‚æœåªæ˜¯å‚æ•°é¡ºåºä¸åŒï¼Œæœ‰ä»€ä¹ˆå®é™…çš„æ„ä¹‰å‘¢ï¼Ÿè¿™æ ·çš„é‡è½½ä¹Ÿä¼šè®©ä»£ç éš¾ä»¥ç¢ç£¨ã€‚ åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å°äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´æˆ‘ä»¬çŸ¥é“Javaä¸­æœ‰è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆéšå¼è½¬æ¢ï¼‰çš„æ¦‚å¿µï¼ŒåŸºæœ¬æ•°æ®ç±»å‹èƒ½ä»ä¸€ä¸ªèŒƒå›´â€œè¾ƒå°â€çš„ç±»å‹è‡ªåŠ¨è½¬æ¢è‡³ä¸€ä¸ªèŒƒå›´â€œè¾ƒå¤§â€çš„ç±»å‹ï¼Œæ­¤è¿‡ç¨‹ä¸€æ—¦æ¶‰åŠåˆ°æ–¹æ³•é‡è½½ï¼Œå¯èƒ½ä¼šé€ æˆä¸€äº›æ··æ·†ã€‚ æˆ‘ä»¬æ¥è¿›è¡Œä¸€äº›æµ‹è¯•ã€‚ foo1æ–¹æ³•åŒ…å«char/byte/short/int/long/float/doubleè¿™7ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo2æ–¹æ³•åŒ…å«byte/short/int/long/float/doubleè¿™6ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo3æ–¹æ³•åŒ…å«short/int/long/float/doubleè¿™5ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo4æ–¹æ³•åŒ…å«int/long/float/doubleè¿™4ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo5æ–¹æ³•åŒ…å«long/float/doubleè¿™3ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo6æ–¹æ³•åŒ…å«float/doubleè¿™2ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo7æ–¹æ³•åªæœ‰ä¸€ä¸ªdoubleç±»å‹å‚æ•°çš„æ–¹æ³•ï¼› åˆ†åˆ«ä½¿ç”¨å¸¸é‡å€¼6ã€charç±»å‹çš„â€™xâ€™ã€byteç±»å‹çš„1ã€shortç±»å‹çš„1ã€intç±»å‹çš„1ã€longç±»å‹çš„1ã€floatç±»å‹çš„1å’Œdoubleç±»å‹çš„1åˆ†åˆ«è°ƒç”¨fooç³»åˆ—çš„æ–¹æ³•ï¼Œè§‚å¯Ÿè¾“å‡ºç»“æœã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337package com.sunchaser.javase.base.overload;import org.junit.Test;/** * @author sunchaser * @date 2020/1/8 * @description * åŸºæœ¬æ•°æ®ç±»å‹é‡è½½çš„æµ‹è¯•ï¼šåŸºæœ¬æ•°æ®ç±»å‹èŒƒå›´è¾ƒå°çš„ä¼šè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆéšå¼è½¬æ¢ï¼‰æˆèŒƒå›´è¾ƒå¤§çš„ç±»å‹ã€‚ * * åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆé™¤å»booleanï¼‰èŒƒå›´å¦‚ä¸‹ï¼š * '[' å’Œ ']' è¡¨ç¤ºé—­åŒºé—´ã€‚ * * byte | 8 bits | [-128, +127] * char | 16 bits | ['\\u0000', '\\uFFFF'] * short | 16 bits | [-2^15, +2^15 - 1] * int | 32 bits | [-2^31, +2^31 - 1] * float | 32 bits | IEEE754èŒƒå›´ * double | 64 bits | IEEE754èŒƒå›´ * long | 64 bits | [-2^63, +2^63 - 1] * * @since 1.0 */public class SmallToBigDataTypeOverloadTest { /** * print: * * const: 6 * foo1(int x) * foo2(int x) * foo3(int x) * foo4(int x) * foo5(long x) * foo6(float x) * foo7(double x) * * å¸¸é‡å€¼6è¢«å½“åšintå€¼è¿›è¡Œå¤„ç†ã€‚å¦‚æœæ²¡æœ‰intç±»å‹çš„é‡è½½æ–¹æ³•ï¼Œåˆ™è‡ªåŠ¨ç±»å‹è½¬æ¢æˆâ€œè¾ƒå¤§â€çš„ç±»å‹ã€‚ */ @Test public void testConstValue() { System.out.println(&quot;const: 6&quot;); foo1(6); foo2(6); foo3(6); foo4(6); foo5(6); foo6(6); foo7(6); } /** * print: * * char: x * foo1(char x) * foo2(int x) * foo3(int x) * foo4(int x) * foo5(long x) * foo6(float x) * foo7(double x) * * é™¤foo1å¤–ï¼Œcharç±»å‹çš„'x'è¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚ * åœ¨foo2ã€foo3å’Œfoo4ä¸­ï¼Œcharç±»å‹è¢«ç›´æ¥è½¬æ¢æˆäº†intç±»å‹ã€‚ */ @Test public void testChar() { char c = 'x'; System.out.println(&quot;char: &quot; + c); foo1(c); foo2(c); foo3(c); foo4(c); foo5(c); foo6(c); foo7(c); } /** * print: * * byte: 1 * foo1(byte x) * foo2(byte x) * foo3(short x) * foo4(int x) * foo5(long x) * foo6(float x) * foo7(double x) * * é™¤foo1å’Œfoo2å¤–ï¼Œbyteç±»å‹çš„1è¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚ */ @Test public void testByte() { byte b = 1; System.out.println(&quot;byte: &quot; + b); foo1(b); foo2(b); foo3(b); foo4(b); foo5(b); foo6(b); foo7(b); } /** * print: * * short: 1 * foo1(short x) * foo2(short x) * foo3(short x) * foo4(int x) * foo5(long x) * foo6(float x) * foo7(double x) * * é™¤foo1ã€foo2å’Œfoo3å¤–ï¼Œshortç±»å‹çš„1è¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚ */ @Test public void testShort() { short s = 1; System.out.println(&quot;short: &quot; + s); foo1(s); foo2(s); foo3(s); foo4(s); foo5(s); foo6(s); foo7(s); } /** * print: * * int: 1 * foo1(int x) * foo2(int x) * foo3(int x) * foo4(int x) * foo5(long x) * foo6(float x) * foo7(double x) * * foo5ã€foo6å’Œfoo7æ–¹æ³•ï¼Œintç±»å‹çš„1éƒ½è¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚ */ @Test public void testInt() { int i = 1; System.out.println(&quot;int: &quot; + i); foo1(i); foo2(i); foo3(i); foo4(i); foo5(i); foo6(i); foo7(i); } /** * print: * * long: 1 * foo1(long x) * foo2(long x) * foo3(long x) * foo4(long x) * foo5(long x) * foo6(float x) * foo7(double x) * * foo6å’Œfoo7æ–¹æ³•ï¼Œlongç±»å‹çš„1Lè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚ */ @Test public void testLong() { long l = 1L; System.out.println(&quot;long: &quot; + l); foo1(l); foo2(l); foo3(l); foo4(l); foo5(l); foo6(l); foo7(l); } /** * print: * * float: 1.0 * foo1(float x) * foo2(float x) * foo3(float x) * foo4(float x) * foo5(float x) * foo6(float x) * foo7(double x) * * foo7æ–¹æ³•ä¸­ï¼Œfloatç±»å‹çš„1Fè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚ */ @Test public void testFloat() { float f = 1F; System.out.println(&quot;float: &quot; + f); foo1(f); foo2(f); foo3(f); foo4(f); foo5(f); foo6(f); foo7(f); } /** * print: * * double: 1.0 * foo1(double x) * foo2(double x) * foo3(double x) * foo4(double x) * foo5(double x) * foo6(double x) * foo7(double x) */ @Test public void testDouble() { double d = 1D; System.out.println(&quot;double: &quot; + d); foo1(d); foo2(d); foo3(d); foo4(d); foo5(d); foo6(d); foo7(d); } /*==========================foo1 Overload===========================*/ void foo1(char x) { System.out.println(&quot;foo1(char x)&quot;); } void foo1(byte x) { System.out.println(&quot;foo1(byte x)&quot;); } void foo1(short x) { System.out.println(&quot;foo1(short x)&quot;); } void foo1(int x) { System.out.println(&quot;foo1(int x)&quot;); } void foo1(long x) { System.out.println(&quot;foo1(long x)&quot;); } void foo1(float x) { System.out.println(&quot;foo1(float x)&quot;); } void foo1(double x) { System.out.println(&quot;foo1(double x)&quot;); } /*==========================foo2 Overload===========================*/ void foo2(byte x) { System.out.println(&quot;foo2(byte x)&quot;); } void foo2(short x) { System.out.println(&quot;foo2(short x)&quot;); } void foo2(int x) { System.out.println(&quot;foo2(int x)&quot;); } void foo2(long x) { System.out.println(&quot;foo2(long x)&quot;); } void foo2(float x) { System.out.println(&quot;foo2(float x)&quot;); } void foo2(double x) { System.out.println(&quot;foo2(double x)&quot;); } /*==========================foo3 Overload===========================*/ void foo3(short x) { System.out.println(&quot;foo3(short x)&quot;); } void foo3(int x) { System.out.println(&quot;foo3(int x)&quot;); } void foo3(long x) { System.out.println(&quot;foo3(long x)&quot;); } void foo3(float x) { System.out.println(&quot;foo3(float x)&quot;); } void foo3(double x) { System.out.println(&quot;foo3(double x)&quot;); } /*==========================foo4 Overload===========================*/ void foo4(int x) { System.out.println(&quot;foo4(int x)&quot;); } void foo4(long x) { System.out.println(&quot;foo4(long x)&quot;); } void foo4(float x) { System.out.println(&quot;foo4(float x)&quot;); } void foo4(double x) { System.out.println(&quot;foo4(double x)&quot;); } /*==========================foo5 Overload===========================*/ void foo5(long x) { System.out.println(&quot;foo5(long x)&quot;); } void foo5(float x) { System.out.println(&quot;foo5(float x)&quot;); } void foo5(double x) { System.out.println(&quot;foo5(double x)&quot;); } /*==========================foo6 Overload===========================*/ void foo6(float x) { System.out.println(&quot;foo6(float x)&quot;); } void foo6(double x) { System.out.println(&quot;foo6(double x)&quot;); } /*==========================foo7 Overload===========================*/ void foo7(double x) { System.out.println(&quot;foo7(double x)&quot;); }} æˆ‘ä»¬ä¼šå‘ç°å¸¸é‡å€¼6è¢«foo1/foo2/foo3/foo4æ–¹æ³•å½“åšintå€¼è¿›è¡Œå¤„ç†ï¼Œfoo5/foo6/foo7æ²¡æœ‰intç±»å‹çš„é‡è½½æ–¹æ³•ï¼Œè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ï¼ˆlong/float/doubleï¼‰ã€‚ å¯¹äºcharç±»å‹çš„â€™xâ€™ï¼Œfoo1æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼Œå‰©ä½™6ç§æ–¹æ³•ä¸åŒ…å«charç±»å‹çš„é‡è½½ï¼Œä½†foo2/foo3/foo4ç›´æ¥å°†charç±»å‹è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†intç±»å‹ã€‚foo5/foo6/foo7åˆ†åˆ«å°†charç±»å‹éšå¼è½¬æ¢æˆäº†long/float/doubleç±»å‹ã€‚ charç±»å‹æ˜¯ä¸ä¼šè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆbyte/shortç±»å‹çš„ã€‚å…¶åŸå› å¯æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼šä¼ é€é—¨ å¯¹äºbyteç±»å‹çš„1ï¼Œfoo1/foo2æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼›å‰©ä½™5ç§æ–¹æ³•ä¸åŒ…å«charç±»å‹çš„é‡è½½ï¼Œè¢«åˆ†åˆ«éšå¼è½¬æ¢æˆäº†short/int/long/float/doubleç±»å‹ã€‚ å¯¹äºshortç±»å‹çš„1ï¼Œfoo1/foo2/foo3æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼›å‰©ä½™4ç§æ–¹æ³•ä¸åŒ…å«shortç±»å‹çš„é‡è½½ï¼Œè¢«åˆ†åˆ«éšå¼è½¬æ¢æˆäº†int/long/float/doubleç±»å‹ã€‚ å¯¹äºintç±»å‹çš„1ï¼Œfoo1/foo2/foo3/foo4æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼›foo5/foo6/foo7ä¸åŒ…å«intç±»å‹çš„é‡è½½ï¼Œè¢«åˆ†åˆ«éšå¼è½¬æ¢æˆäº†long/float/doubleç±»å‹ã€‚ å¯¹äºlongç±»å‹çš„1ï¼Œfoo1/foo2/foo3/foo4/foo5æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼›foo6/foo7ä¸åŒ…å«longç±»å‹çš„é‡è½½ï¼Œè¢«åˆ†åˆ«éšå¼è½¬æ¢æˆäº†float/doubleç±»å‹ã€‚ å¯¹åº”floatç±»å‹çš„1ï¼Œfoo7ä¸åŒ…å«floatç±»å‹çš„é‡è½½ï¼Œè¢«éšå¼è½¬æ¢æˆäº†doubleç±»å‹ï¼›è€Œå…¶å®ƒ6ç§æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ã€‚ å¯¹äºdoubleç±»å‹çš„1,7ç§æ–¹æ³•éƒ½æœ‰å¯¹åº”ç±»å‹çš„é‡è½½ã€‚ æ•°å€¼åŸºæœ¬ç±»å‹éšå¼è½¬æ¢å›¾å¦‚ä¸‹ï¼š å®çº¿ç®­å¤´æ— ç²¾åº¦ä¸¢å¤±ï¼Œè™šçº¿ç®­å¤´å¯èƒ½ä¸¢å¤±ç²¾åº¦ã€‚ ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å¤§äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´åè¿‡æ¥ï¼Œå¦‚æœä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å¤§äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°ï¼Œä¼šæ˜¯ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿæˆ‘ä»¬å†æ¥æµ‹è¯•ä¸€ä¸‹ã€‚ foo1æ–¹æ³•åŒ…å«char/byte/short/int/long/float/doubleè¿™7ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo2æ–¹æ³•åŒ…å«char/byte/short/int/long/floatè¿™6ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo3æ–¹æ³•åŒ…å«char/byte/short/int/longè¿™5ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo4æ–¹æ³•åŒ…å«char/byte/short/intè¿™4ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo5æ–¹æ³•åŒ…å«char/byte/shortè¿™3ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo6æ–¹æ³•åŒ…å«char/byteè¿™2ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼› foo7æ–¹æ³•åªæœ‰ä¸€ä¸ªcharç±»å‹å‚æ•°çš„æ–¹æ³•ï¼› ä½¿ç”¨doubleç±»å‹çš„3.1415926åˆ†åˆ«è°ƒç”¨fooç³»åˆ—çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¼–è¯‘å™¨æç¤ºäº†é”™è¯¯ï¼šCannot resolve method 'foo2(double)'ç­‰ã€‚é™¤äº†foo1æ–¹æ³•å¤–ï¼Œå…¶ä½™fooç³»åˆ—çš„æ–¹æ³•éƒ½ä¸åŒ…å«doubleç±»å‹çš„é‡è½½ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šéšå¼å°†doubleç±»å‹è‡ªåŠ¨è½¬æ¢æˆå…¶å®ƒåŸºæœ¬ç±»å‹ï¼Œå…¶åŸå› åœ¨äºdoubleç±»å‹çš„å–å€¼èŒƒå›´ï¼ˆäºŒè¿›åˆ¶ä½æ•°ï¼‰æ˜¯æœ€å¤§çš„ï¼Œå¦‚æœå°†doubleç±»å‹çš„æ•°æ®éšå¼è½¬æ¢æˆå…¶å®ƒåŸºæœ¬ç±»å‹ï¼Œå¯èƒ½ä¼šå‡ºç°ç²¾åº¦ä¸¢å¤±çš„é—®é¢˜ï¼Œè¿™æ˜¯æœ‰é£é™©çš„ï¼Œç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åšã€‚ æˆ‘ä»¬éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆæ˜¾å¼è½¬æ¢ï¼‰è¿›è¡Œçª„åŒ–å¤„ç†ï¼Œè¿™æ ·åšå¯èƒ½ä¼šä¸¢å¤±ç²¾åº¦ã€‚ä½†å¦‚æœä¸è¿™æ ·åšï¼Œæˆ‘ä»¬æ— æ³•æ­£å¸¸è¿›è¡Œæ–¹æ³•çš„è°ƒç”¨ã€‚ å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165package com.sunchaser.javase.base.overload;import org.junit.Test;/** * @author sunchaser * @date 2020/1/8 * @description * åŸºæœ¬æ•°æ®ç±»å‹é‡è½½çš„æµ‹è¯•ï¼šåŸºæœ¬æ•°æ®ç±»å‹èŒƒå›´è¾ƒå¤§çš„éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆæ˜¾å¼è½¬æ¢ï¼‰è¿›è¡Œçª„åŒ–å¤„ç†ï¼Œè½¬æ¢æˆèŒƒå›´è¾ƒå°çš„ç±»å‹ã€‚ * * åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆé™¤å»booleanï¼‰èŒƒå›´å¦‚ä¸‹ï¼š * '[' å’Œ ']' è¡¨ç¤ºé—­åŒºé—´ã€‚ * * byte | 8 bits | [-128, +127] * char | 16 bits | ['\\u0000', '\\uFFFF'] * short | 16 bits | [-2^15, +2^15 - 1] * int | 32 bits | [-2^31, +2^31 - 1] * float | 32 bits | IEEE754èŒƒå›´ * double | 64 bits | IEEE754èŒƒå›´ * long | 64 bits | [-2^63, +2^63 - 1] * @since 1.0 */public class BigToSmallDataTypeOverloadTest { /** * print: * * double: 3.1415926 * foo1(double x) * foo2(float x) * foo3(long x) * foo4(int x) * foo5(short x) * foo6(byte x) * foo7(char x) * (float) dï¼š3.1415925 // å¯çœ‹åˆ°ç²¾åº¦å·²ç»ä¸¢å¤± * (long) dï¼š3 * (int) dï¼š3 * (short) dï¼š3 * (byte) dï¼š3 * (char) dï¼š3 */ @Test public void testDouble() { double d = 3.1415926; System.out.println(&quot;double: &quot; + d); foo1(d); foo2((float) d); foo3((long) d); foo4((int) d); foo5((short) d); foo6((byte) d); foo7((char) d); float f = (float) d; System.out.println(&quot;(float) dï¼š&quot; + f); long l = (long) d; System.out.println(&quot;(long) dï¼š&quot; + l); int i = (int) d; System.out.println(&quot;(int) dï¼š&quot; + i); short s = (short) d; System.out.println(&quot;(short) dï¼š&quot; + s); byte b = (byte) d; System.out.println(&quot;(byte) dï¼š&quot; + b); char c = (char) d; System.out.println(&quot;(char) dï¼š&quot; + (c + 1 - 1)); // æŸ¥çœ‹charè¡¨ç¤ºçš„æ•°å€¼ } /*==========================foo1 Overload===========================*/ void foo1(char x) { System.out.println(&quot;foo1(char x)&quot;); } void foo1(byte x) { System.out.println(&quot;foo1(byte x)&quot;); } void foo1(short x) { System.out.println(&quot;foo1(short x)&quot;); } void foo1(int x) { System.out.println(&quot;foo1(int x)&quot;); } void foo1(long x) { System.out.println(&quot;foo1(long x)&quot;); } void foo1(float x) { System.out.println(&quot;foo1(float x)&quot;); } void foo1(double x) { System.out.println(&quot;foo1(double x)&quot;); } /*==========================foo2 Overload===========================*/ void foo2(char x) { System.out.println(&quot;foo2(char x)&quot;); } void foo2(byte x) { System.out.println(&quot;foo2(byte x)&quot;); } void foo2(short x) { System.out.println(&quot;foo2(short x)&quot;); } void foo2(int x) { System.out.println(&quot;foo2(int x)&quot;); } void foo2(long x) { System.out.println(&quot;foo2(long x)&quot;); } void foo2(float x) { System.out.println(&quot;foo2(float x)&quot;); } /*==========================foo3 Overload===========================*/ void foo3(char x) { System.out.println(&quot;foo3(char x)&quot;); } void foo3(byte x) { System.out.println(&quot;foo3(byte x)&quot;); } void foo3(short x) { System.out.println(&quot;foo3(short x)&quot;); } void foo3(int x) { System.out.println(&quot;foo3(int x)&quot;); } void foo3(long x) { System.out.println(&quot;foo3(long x)&quot;); } /*==========================foo4 Overload===========================*/ void foo4(char x) { System.out.println(&quot;foo4(char x)&quot;); } void foo4(byte x) { System.out.println(&quot;foo4(byte x)&quot;); } void foo4(short x) { System.out.println(&quot;foo4(short x)&quot;); } void foo4(int x) { System.out.println(&quot;foo4(int x)&quot;); } /*==========================foo5 Overload===========================*/ void foo5(char x) { System.out.println(&quot;foo5(char x)&quot;); } void foo5(byte x) { System.out.println(&quot;foo5(byte x)&quot;); } void foo5(short x) { System.out.println(&quot;foo5(short x)&quot;); } /*==========================foo6 Overload===========================*/ void foo6(char x) { System.out.println(&quot;foo6(char x)&quot;); } void foo6(byte x) { System.out.println(&quot;foo6(byte x)&quot;); } /*==========================foo7 Overload===========================*/ void foo7(char x) { System.out.println(&quot;foo7(char x)&quot;); }} ä»è¾“å‡ºç»“æœä¸­å¯çœ‹åˆ°ï¼šdoubleç±»å‹çš„3.1415926å¼ºåˆ¶è½¬æ¢æˆfloatæ—¶å˜æˆäº†3.1415925ï¼Œç²¾åº¦å·²ç»ä¸¢å¤±ï¼›è€Œå¼ºåˆ¶è½¬æ¢æˆlong/int/short/byte/charæ—¶æµ®ç‚¹éƒ¨åˆ†ç›´æ¥è¢«èˆå¼ƒã€‚ è¿”å›å€¼èƒ½åŒºåˆ†é‡è½½æ–¹æ³•å—ï¼Ÿä¾‹å¦‚æœ‰ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•ï¼š 123void foo() {}int foo() {return -1;} æˆ‘ä»¬äººç”¨è‚‰çœ¼å»çœ‹æ–¹æ³•çš„å£°æ˜å¾ˆå®¹æ˜“åˆ†è¾¨è¿™ä¸¤ä¸ªåŒåæ–¹æ³•çš„ä¸åŒä¹‹å¤„ã€‚ä½†æ˜¯å½“æˆ‘ä»¬å»è°ƒç”¨fooæ–¹æ³•æ—¶ï¼Œå¦‚æœæˆ‘ä»¬çš„è°ƒç”¨æ–¹å¼æ˜¯ï¼šint x = foo()ï¼Œé‚£ä¹ˆçš„ç¡®å¯ä»¥æ˜ç¡®æˆ‘ä»¬è°ƒç”¨çš„æ˜¯int foo() {return -1;}ï¼›ä½†æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸åœ¨æ„è¿”å›å€¼ï¼ˆåªæ˜¯è°ƒç”¨æ–¹æ³•å»æ‰§è¡ŒæŸä¸ªæ“ä½œï¼‰ï¼Œè°ƒç”¨æ–¹å¼ä¸ºï¼šfoo()ï¼Œè¿™æ—¶å€™Javaå¦‚ä½•æ‰èƒ½åˆ¤æ–­è°ƒç”¨çš„æ˜¯å“ªä¸€ä¸ªfoo()å‘¢ï¼Ÿç¨‹åºå‘˜åˆè¯¥å¦‚ä½•ç†è§£è¿™ç§ä»£ç å‘¢ï¼Ÿå› æ­¤ï¼Œè¿”å›å€¼æ˜¯ä¸èƒ½åŒºåˆ†æ–¹æ³•é‡è½½çš„ã€‚ intå’ŒIntegerçš„å½¢å‚æ˜¯é‡è½½æ–¹æ³•å—ï¼Ÿä¾‹å¦‚æœ‰ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•ï¼š 1234567void foo(int x) { System.out.println(&quot;int&quot;);}void foo(Integer y) { System.out.println(&quot;Integer&quot;);} å®ƒä»¬æ˜¯é‡è½½æ–¹æ³•å—ï¼Ÿ å³ä½¿intå’ŒIntegerä¹‹é—´å­˜åœ¨è‡ªåŠ¨è£…ç®±/æ‹†ç®±æ“ä½œï¼Œä½†å®ƒä»¬ä»æ˜¯é‡è½½çš„æ–¹æ³•ã€‚ æˆ‘ä»¬ä¼ é€’intç±»å‹çš„å˜é‡ç»™fooï¼Œç¼–è¯‘å™¨å¹¶ä¸ä¼šè¿›è¡Œè£…ç®±æ“ä½œï¼Œå› ä¸ºæœ‰å¯¹åº”çš„intç±»å‹é‡è½½æ–¹æ³•ï¼›ç›¸åº”åœ°ï¼Œæˆ‘ä»¬ä¼ é€’Integerç±»å‹çš„å˜é‡ç»™fooï¼Œç¼–è¯‘å™¨ä¸ä¼šè¿›è¡Œæ‹†ç®±æ“ä½œï¼Œè€Œæ˜¯è°ƒç”¨å¯¹åº”Integerç±»å‹çš„é‡è½½æ–¹æ³•ã€‚ æˆ‘ä»¬ä¼ é€’å­—é¢é‡1ç»™fooæ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šé»˜è®¤å½“æˆåŸºæœ¬ç±»å‹intè°ƒç”¨fooã€‚ æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819/** * print: * * int * int * Integer * * å­—é¢é‡å€¼1æ˜¯intåŸºæœ¬æ•°æ®ç±»å‹ * * æ˜¯é‡è½½æ–¹æ³• */@Testpublic void testIntInteger() { foo(1); int x = 1; foo(x); Integer y = 1; foo(y);} ä»¥ä¸Šå°±æ˜¯æ–¹æ³•é‡è½½Overloadçš„å…¨éƒ¨å†…å®¹ï¼Œå®Œæ•´ç¤ºä¾‹ä»£ç åœ°å€è§ï¼šä¼ é€é—¨","link":"/2020/01/09/javase/base/method-overload/"},{"title":"2019å¹´åº¦æ€»ç»“","text":"2019æ˜¯æ—¥æ— æš‡æ™·çš„ä¸€å¹´ã€‚ ä»å¹´åˆçš„å¤§å››å‡†æ¯•ä¸šç”Ÿåˆ°ç°åœ¨åŠå¹´ç»éªŒçš„èŒåœºå°‘å¹´ï¼Œä¸€è·¯èµ°æ¥ï¼Œä»æŠ€æœ¯èœé¸Ÿåˆ°å°æœ‰æˆå°±ï¼Œä»ç¨šå«©åˆ°æ²‰ç¨³ï¼Œè¿™æ˜¯æˆé•¿çš„å°è®°ã€‚ 2019å‰3ä¸ªæœˆæ˜¯è‰°éš¾çš„ã€‚çŠ¹è®°å¾—2018å¹´9æœˆç§‹æ‹›ç»å†è¿‡çš„ææƒ§ï¼Œå¤§ä¸‰æ—¶â€œå¬ä¿¡äº†â€å¤§å­¦è€å¸ˆçš„è°—è¨€ï¼šPHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ã€‚å¤§ä¸‰ä¸€æ•´å¹´éƒ½åœ¨å­¦ä¹ PHPï¼ŒæŸé©¬ç¨‹åºå‘˜å®˜ç½‘æ”¾å‡ºçš„PHPè§†é¢‘æ•™ç¨‹çœ‹äº†80%å¤šã€‚ä½†ç°å®ç»ˆç©¶æ˜¯æ®‹é…·çš„ï¼Œå›½å†…å¤§éƒ¨åˆ†ä¼ä¸šåç«¯éƒ½è¿˜æ˜¯ä»¥Javaè¯­è¨€ä¸ºä¸»ï¼ˆåˆ«è·Ÿæˆ‘è®²ç™¾åº¦ç”¨PHPï¼‰ã€‚ç§‹æ‹›çš„PHPå²—ä½å®åœ¨æ˜¯å¤ªå°‘äº†ï¼ŒåŠ ä¸Šæˆ‘åªæ˜¯ä¸€ä¸ªåŒéæ™®é€šä¸€æœ¬å­¦å†ï¼Œåˆæ²¡æœ‰ä»€ä¹ˆæ‹¿å¾—å‡ºæ‰‹çš„è·å¥–è¯ä¹¦ï¼Œæ ¹æœ¬å°±æ²¡æœ‰ä¸€ç‚¹ç«äº‰åŠ›ã€‚äºæ˜¯ä¿®æ”¹äº†ç®€å†ï¼Œé¡¹ç›®ç»éªŒå†™ä¸Šäº†å¤§å­¦Java Webè¯¾ç¨‹è®¾è®¡å†™çš„JSP+Servleté¡¹ç›®ï¼Œå°±å¼€å§‹è½¬å‘æŠ•é€’Javaå²—ã€‚ ç»ˆäºè¿‡äº†ä¸€å®¶æ·±åœ³äº’è”ç½‘å…¬å¸çš„ç¬”è¯•ï¼Œæ¥åˆ°é¢è¯•é˜¶æ®µï¼Œè·Ÿé¢è¯•å®˜èŠäº†ä¸€ä¸‹å¤§ä¸‰å­¦PHPçš„äº‹æƒ…ï¼Œç„¶åå¼€å§‹é—®æŠ€æœ¯æ–¹é¢çš„é—®é¢˜ï¼Œç°åœ¨å›æƒ³èµ·æ¥ï¼Œå½“æ—¶çš„é—®é¢˜ç®—å¾—ä¸Šæ˜¯éå¸¸åŸºç¡€çš„çŸ¥è¯†ç‚¹äº†ã€‚ä¾‹å¦‚ï¼šintå’ŒIntegerçš„åŒºåˆ«ï¼Ÿintå’ŒIntegerä½œä¸ºåŒåæ–¹æ³•çš„å‚æ•°ï¼Œç®—ä¸ç®—é‡è½½ï¼Ÿ è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€æ¬¡Javaé¢è¯•ï¼Œé¢è¯•è¿‡ç¨‹ä¸­æ»¡æ€€ä¿¡å¿ƒè§‰å¾—è‡ªå·±éƒ½ç­”å¯¹äº†ï¼Œé¢è¯•å‡ºæ¥åæŸ¥äº†ä¸‹ç™¾åº¦ï¼Œå‘ç°å¥½åƒä¸€ä¸ªéƒ½æ²¡ç­”å¯¹ã€‚â€œç”µå­ç«æŠ€ï¼Œèœæ˜¯åŸç½ªâ€ã€‚ å½“æ—¶æ·±åˆ»è®¤è¯†åˆ°å‡­å½“æ—¶çš„è‡ªèº«æŠ€æœ¯èƒ½åŠ›æƒ³æ‰¾Javaå¼€å‘çš„å²—ä½å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œäºæ˜¯åšäº†ä¸€ä¸ªå¾ˆæœæ–­çš„å†³å®šï¼Œåœæ­¢æŠ•é€’ç®€å†ï¼Œç³»ç»Ÿå­¦ä¹ JavaçŸ¥è¯†ä½“ç³»ï¼Œç­‰å¾…æ˜¥æ‹›ã€‚ æŸåŒ—å¤§å­¦è®¡ç®—æœºå­¦é™¢çš„å­¦ç”Ÿå®¿èˆåœ¨æ ¡å¤–ï¼ˆä¿—ç§°â€œä¸‰æœŸâ€å…¬å¯“ï¼‰ï¼Œæ²¡æœ‰ç‹¬å«ï¼Œæ²¡æœ‰ç©ºè°ƒï¼Œå…­äººé—´ã€‚è‡ªå­¦æ˜¯å¾ˆè€ƒéªŒäººçš„ï¼Œé‚£ä¸ªæ—¶å€™åˆšè½¬å‘Javaï¼Œç–¯ç‹‚çš„æ‰¾å­¦ä¹ èµ„æ–™ï¼ŒæŸé©¬ç¨‹åºå‘˜ï¼ŒæŸç¡…è°·ï¼ŒæŸå­¦å ‚ï¼ŒæŸå®¢ç½‘ï¼ŒæŸå®â€¦å‡ ä¹æ‰€æœ‰çš„å…è´¹è§†é¢‘æ•™ç¨‹æˆ‘éƒ½ä¸‹è½½äº†ã€‚é¢å¯¹å‡ åä¸ªGçš„èµ„æºï¼Œæˆ‘é™·å…¥äº†è¿·èŒ«ï¼Œè¯¥ä»ä½•å­¦èµ·å‘¢ï¼Ÿ é‚£ä¸ªæ—¶å€™æˆ‘çš„çŸ¥è¯†ä½“ç³»åŸºæœ¬æ˜¯ä¸€ç‰‡ç©ºç™½ï¼Œåªæœ‰å¤§å­¦çš„JavaåŸºç¡€è¯¾ç¨‹å’ŒJ2EEè¯¾ç¨‹å­¦çš„ä¸€ç‚¹çŸ¥è¯†å‚¨å¤‡ã€‚å¬äº†åŒå­¦çš„å»ºè®®åï¼Œå†³å®šä»æŸå®¢ç½‘é«˜çº§é¡¹ç›®è¯¾å¼€å§‹å­¦èµ·ï¼Œè·Ÿéšé¡¹ç›®éœ€æ±‚ï¼Œå¯¹é¡¹ç›®ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹ï¼ŒæŠ€æœ¯æ¡†æ¶è¿›è¡Œç»†è‡´å­¦ä¹ ã€‚ç„¶è€Œä¸€åˆ‡éƒ½æ˜¯è‰°éš¾çš„ï¼Œè¿™ä¸ªé¡¹ç›®ç”¨çš„æŠ€æœ¯æ ˆä¸»è¦æ˜¯Spring Bootã€Mybatisç­‰ï¼Œå¯¹äºå½“æ—¶è¿Springéƒ½ä¸çŸ¥é“çš„æˆ‘ï¼Œå®åœ¨æ˜¯å¤ªéš¾äº†ã€‚ äºæ˜¯æˆ‘æ‰“å¼€äº†æŸé©¬ç¨‹åºå‘˜çš„Springå…¥é—¨åˆ°ç²¾é€šè§†é¢‘ï¼Œä»ä¼ ç»Ÿçš„Java Webåˆ°å¼•å…¥DI/IOCï¼Œå¤§æ¦‚èƒ½å¬æ‡‚ä¸€ç‚¹ï¼Œæˆ‘å¼€å§‹æ‰“å¼€IDEå¯¹ç€è§†é¢‘æ•²ä»£ç ï¼Œç»å¸¸ä¸€ä¸ªè§†é¢‘é‡å¤æ’­æ”¾ä¸‰éç”šè‡³æ›´å¤šï¼Œç¬¬ä¸€éæ˜¯å¬å¤§æ¦‚çš„å†…å®¹ï¼Œç¬¬äºŒéæ˜¯ç»†å¬ï¼Œç„¶åè·Ÿç€æ•²ä»£ç ï¼Œç¬¬ä¸‰éæ˜¯æ€»ç»“æ€§çš„å¬ï¼Œåšä¸€äº›ç¬”è®°ã€‚ ä½†æ˜¯æˆ‘å‘ç°ï¼Œæˆ‘å¯¹Javaè¯­è¨€çš„ä¸€äº›åŸºç¡€æ€§çš„è¯­æ³•å’Œæ¦‚å¿µè¿˜ä¸æ˜¯å¤ªç†Ÿæ‚‰ï¼Œäºæ˜¯æˆ‘æ‰“å¼€äº†2018å¹´åŒåä¸€ä¹°çš„ã€ŠJavaç¼–ç¨‹æ€æƒ³ã€‹ï¼Œå¼€å§‹äº†è§£Javaè¯­è¨€çš„ä¸€äº›ç‰¹æ€§ã€‚åŒæ—¶è¿˜çœ‹äº†æŸé©¬ç¨‹åºå‘˜åˆ›å§‹äººå¼ è€å¸ˆçš„ã€ŠJavaé«˜æ–°æŠ€æœ¯ã€‹è§†é¢‘è¯¾ç¨‹ï¼Œå¯¹æˆ‘å½±å“ç”šå¤§ï¼Œè§†é¢‘å†…å®¹åŸºæœ¬æ˜¯JDK5çš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬é™æ€å¯¼åŒ…ã€å¯å˜å‚æ•°ã€å¢å¼ºforå¾ªç¯ã€è‡ªåŠ¨æ‹†/è£…ç®±ã€äº«å…ƒè®¾è®¡æ¨¡å¼ã€æšä¸¾ã€åå°„ã€ç±»åŠ è½½å™¨ã€åŒäº²å§”æ´¾æ¨¡å‹ã€æ³¨è§£ã€æ³›å‹å’ŒåŠ¨æ€ä»£ç†ç­‰ã€‚è¿™å¥—è§†é¢‘ç®—å¾—ä¸Šæ˜¯å½»åº•æ”¹å˜äº†æˆ‘ï¼ŒçœŸæ­£çš„è®©æˆ‘å…¥äº†Javaçš„é—¨ã€‚ æ­¤åï¼Œè¿˜çœ‹äº†å¼ è€å¸ˆçš„ã€ŠJavaå¤šçº¿ç¨‹ä¸å¹¶å‘åº“ã€‹è¿™å¥—è§†é¢‘ï¼Œè¿™å¥—è§†é¢‘å¥ å®šäº†æˆ‘çš„JavaåŸºç¡€ï¼Œè§†é¢‘ä¸»è¦è®²è§£äº†ä¼ ç»Ÿçº¿ç¨‹åŒæ­¥ä¸äº’æ–¥æŠ€æœ¯ã€ThreadLocalç±»ã€Callableå’ŒFutureç±»ã€Timerå®šæ—¶å™¨ç±»ã€çº¿ç¨‹æ± ã€è¯»å†™é”ã€é—­é”ã€æ …æ ã€è®¡æ•°å™¨ã€é˜»å¡é˜Ÿåˆ—ã€åŸå­æ“ä½œç±»å’ŒåŒæ­¥é›†åˆç­‰å†…å®¹ã€‚ å†ä¹‹åï¼Œæˆ‘æ¥è§¦åˆ°äº†Springï¼ŒSpring MVCï¼ŒMybatisï¼ŒMavenï¼ŒSpring Bootï¼ŒRedisâ€¦ç­‰ä¸€äº›æŠ€æœ¯æ ˆã€‚ åŸºæœ¬ç†Ÿæ‚‰è¿™äº›æ¡†æ¶ä¹‹åï¼Œæˆ‘ç»§ç»­äº†æŸå®¢ç½‘é«˜çº§é¡¹ç›®è¯¾ï¼Œæ˜¥èŠ‚åœ¨å®¶çš„ä¸€ä¸ªæœˆï¼Œè·Ÿç€è§†é¢‘æŠŠä»£ç å†™çš„å·®ä¸å¤šäº†ã€‚ç„¶åæŠŠè¿™ä¸ªé¡¹ç›®å½“åšé¡¹ç›®ç»éªŒå¡«å……åœ¨è‡ªå·±çš„ç®€å†ä¸Šã€‚ å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘å¹¶ä¸æ˜¯å®Œå…¨ç…§æ¬è§†é¢‘ä¸­æ‰€è®²ï¼Œè€Œæ˜¯é‡‡ç”¨æ ‡å‡†å‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼ï¼Œå‰ç«¯é€‰æ‹©äº†Vueå…¨å®¶æ¡¶æŠ€æœ¯æ ˆï¼Œåç«¯åˆ™æ˜¯è§†é¢‘ä¸­çš„Spring BootæŠ€æœ¯æ ˆï¼Œè¿™å¯¹äºæˆ‘çš„é¡¹ç›®ç»éªŒæ¥è¯´æ˜¯ä¸€ä¸ªåŠ åˆ†é¡¹ã€‚ ç»è¿‡ä¸ºæœŸäº”ä¸ªæœˆçš„å­¦ä¹ ï¼Œæˆ‘å¼€å§‹æ˜¥æ‹›çš„æ­¥ä¼ï¼Œç»è¿‡äºŒæœˆåº•ä¸‰æœˆåˆä¸€ä¸ªå¤šæœˆçš„è·‘å®£è®²ä¼šï¼Œå‚åŠ ç¬”è¯•é¢è¯•ï¼Œæœ€ç»ˆæ”¶è·äº†ä¸€å®¶æ­¦æ±‰çš„Offerï¼Œä¸€åˆ‡éƒ½æŒºå¹¸è¿çš„ï¼Œè¿™å®¶å…¬å¸çš„è–ªèµ„ï¼ŒæŠ€æœ¯æ ˆéƒ½æ¯”è¾ƒæ»¡æ„ã€‚ç»ˆäºæ˜¯åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººã€‚ 7æœˆï¼Œå…¥èŒã€‚ è¿›å…¥æ–°å…¬å¸ï¼Œæ–°ç¯å¢ƒï¼Œæˆä¸ºäº†ç¤¾ä¼šäººï¼Œå¾ˆæ¿€åŠ¨ã€‚ 9æœˆï¼Œå‚ä¸çš„ç¬¬ä¸€ä¸ªéœ€æ±‚ä¸Šçº¿ã€‚è€æ€»è¯·å–é…’ï¼Œå–åäº†ä¸€ç‰‡äººï¼Œæˆ‘ä¹Ÿåå€’åœ¨é—¨å¤–ã€‚ 10æœˆï¼Œå¼€å§‹äº†ä»Šå¹´æœ€å¤§çš„ä¸€ä¸ªé¡¹ç›®ï¼ŒåŠ ç­é€šå®µäº†ä¸¤æ¬¡ã€‚å¾ˆç´¯ã€‚ 12æœˆï¼Œå‡ºå·®æ¥åˆ°äº†åŒ—äº¬ï¼Œçœ‹äº†å¤©å®‰é—¨ï¼Œçœ‹äº†ç´«ç¦åŸï¼Œçœ‹äº†æ­ç‹åºœï¼Œçœ‹äº†æ°´ç«‹æ–¹ï¼Œçœ‹äº†é¸Ÿå·¢ã€‚ä¸è™šæ­¤è¡Œã€‚ æœ«äº†ï¼Œ12æœˆçš„æœ€åä¸€å¤©è¿›è¡Œäº†è½¬æ­£ç­”è¾©ï¼Œåº”è¯¥æ˜¯è½¬æ­£äº†ã€‚ ä¸”è¡Œä¸”çæƒœã€‚ 2020å¹´ï¼Œå¸Œæœ›å¯ä»¥é‡è§æ›´å¥½çš„è‡ªå·±ï¼Œæé«˜æ—¶é—´è§„åˆ’èƒ½åŠ›ä¸è‡ªæ§åŠ›ï¼Œå½¢æˆè‡ªå·±çš„çŸ¥è¯†ä½“ç³»ï¼Œå¹¶æ·±å…¥åˆ°æŠ€æœ¯ä¸­ã€‚","link":"/2019/12/31/annual-summary/2019/"},{"title":"è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µä¸æ„ä¹‰","text":"è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µä¸æ„ä¹‰è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µè®¾è®¡æ¨¡å¼ï¼Œæ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚å®ƒæè¿°äº†åœ¨è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­çš„ä¸€äº›ä¸æ–­é‡å¤å‘ç”Ÿçš„é—®é¢˜ï¼Œä»¥åŠè¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯è§£å†³ç‰¹å®šé—®é¢˜çš„ä¸€ç³»åˆ—å¥—è·¯ï¼Œæ˜¯å‰è¾ˆä»¬çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå…·æœ‰ä¸€å®šçš„æ™®éæ€§ï¼Œå¯ä»¥åå¤ä½¿ç”¨ã€‚å…¶ç›®çš„æ˜¯ä¸ºäº†æé«˜ä»£ç çš„å¯é‡ç”¨æ€§ã€ä»£ç çš„å¯è¯»æ€§å’Œä»£ç çš„å¯é æ€§ã€‚åœ¨å¾ˆå¤šå¼€æºæ¡†æ¶ä¸­éƒ½æœ‰è®¾è®¡æ¨¡å¼æ€æƒ³çš„ä½“ç°ï¼Œå°½ç®¡æœ‰äº›è®¾è®¡æ¨¡å¼é€æ¸è¢«ç¼–ç¨‹è¯­è¨€çš„æ–°è¯­æ³•ç‰¹æ€§ç»™é¢ è¦†ï¼Œä½†å…¶è®¾è®¡æ€æƒ³ä¾æ—§æ˜¯å€¼å¾—æˆ‘ä»¬å­¦ä¹ çš„ã€‚ è®¾è®¡æ¨¡å¼çš„æ„ä¹‰è®¾è®¡æ¨¡å¼çš„æœ¬è´¨æ˜¯é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™çš„å®é™…è¿ç”¨ï¼Œæ˜¯å¯¹ç±»çš„å°è£…æ€§ã€ç»§æ‰¿æ€§å’Œå¤šæ€æ€§ä»¥åŠç±»çš„å…³è”å…³ç³»å’Œç»„åˆå…³ç³»çš„å……åˆ†ç†è§£ã€‚ å­¦ä¹ è®¾è®¡æ¨¡å¼æœ‰ä»¥ä¸‹æ„ä¹‰ï¼š å¯ä»¥æé«˜æ€ç»´èƒ½åŠ›ã€ç¼–ç¨‹èƒ½åŠ›å’Œè®¾è®¡èƒ½åŠ›ã€‚ ä½¿ç¨‹åºè®¾è®¡æ›´åŠ æ ‡å‡†åŒ–ã€ä»£ç ç¼–åˆ¶æ›´åŠ å·¥ç¨‹åŒ–ï¼Œä½¿è½¯ä»¶å¼€å‘æ•ˆç‡å¤§å¤§æé«˜ï¼Œä»è€Œç¼©çŸ­è½¯ä»¶çš„å¼€å‘å‘¨æœŸã€‚ ä½¿è®¾è®¡çš„ä»£ç å¯é‡ç”¨æ€§é«˜ã€å¯è¯»æ€§å¼ºã€å¯é æ€§é«˜ã€çµæ´»æ€§å¥½ã€å¯ç»´æŠ¤æ€§å¼ºã€‚ æœ‰åˆ©äºé˜…è¯»ä¸€äº›å¼€æºæ¡†æ¶æºç ã€‚","link":"/2019/12/12/design-patterns/gof/Design-pattern-overview/"},{"title":"GoFçš„23ç§è®¾è®¡æ¨¡å¼","text":"GoFè®¾è®¡æ¨¡å¼ç®€ä»‹GoFæ˜¯è®¾è®¡æ¨¡å¼çš„ç»å…¸åè‘—Design Patterns: Elements of Reusable Object-Oriented Softwareï¼ˆä¸­è¯‘æœ¬åä¸ºã€Šè®¾è®¡æ¨¡å¼â€”â€”å¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ï¼‰çš„å››ä½ä½œè€…ï¼Œä»–ä»¬åˆ†ä¸ºæ˜¯ï¼šElich Gammaã€Richard Helmã€Ralph Johnsonã€ä»¥åŠJohn Vlissidesã€‚è¿™å››ä¸ªäººå¸¸è¢«ç§°ä¸ºGang of Fourï¼Œ å³å››äººç»„ï¼Œç®€ç§°GoFã€‚è¿™æœ¬ä¹¦ä¸­æ€»ç»“çš„23ç§è®¾è®¡æ¨¡å¼ç§°ä¸ºGoFè®¾è®¡æ¨¡å¼ã€‚ è®¾è®¡æ¨¡å¼åˆ†ç±»è®¾è®¡æ¨¡å¼æœ‰ä¸¤ç§åˆ†ç±»æ–¹æ³•ï¼šæ ¹æ®æ¨¡å¼çš„ç›®çš„åˆ’åˆ†å’Œæ ¹æ®æ¨¡å¼çš„ä½œç”¨èŒƒå›´åˆ’åˆ†ã€‚ æ ¹æ®ç›®çš„åˆ’åˆ†æ ¹æ®æ¨¡å¼æ˜¯ç”¨æ¥å®Œæˆä»€ä¹ˆå·¥ä½œæ¥åˆ’åˆ†ï¼Œå¯åˆ†ä¸ºåˆ›å»ºå‹æ¨¡å¼ã€ç»“æ„å‹æ¨¡å¼å’Œè¡Œä¸ºå‹æ¨¡å¼ã€‚ åˆ›å»ºå‹æ¨¡å¼ï¼šç”¨äºæè¿°â€œå¦‚ä½•åˆ›å»ºå¯¹è±¡â€ï¼Œä¸»è¦ç‰¹ç‚¹æ˜¯â€œå°†å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»â€ã€‚GoFçš„åˆ›å»ºå‹æ¨¡å¼åŒ…æ‹¬å•ä¾‹æ¨¡å¼ã€åŸå‹æ¨¡å¼ã€å·¥å‚æ–¹æ³•æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼å’Œå»ºé€ è€…æ¨¡å¼ã€‚ ç»“æ„å‹æ¨¡å¼ï¼šç”¨äºæè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡æŒ‰æŸç§å¸ƒå±€ç»„æˆæ›´å¤§çš„ç»“æ„ã€‚GoFçš„ç»“æ„å‹æ¨¡å¼åŒ…æ‹¬ä»£ç†æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€äº«å…ƒæ¨¡å¼å’Œç»„åˆæ¨¡å¼ã€‚ è¡Œä¸ºå‹æ¨¡å¼ï¼šç”¨äºæè¿°ç±»æˆ–å¯¹è±¡ä¹‹é—´æ€æ ·ç›¸äº’åä½œå…±åŒå®Œæˆå•ä¸ªå¯¹è±¡éƒ½æ— æ³•å•ç‹¬å®Œæˆçš„ä»»åŠ¡ï¼Œä»¥åŠæ€æ ·åˆ†é…èŒè´£ã€‚GoFçš„è¡Œä¸ºå‹æ¨¡å¼åŒ…æ‹¬è´£ä»»é“¾æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼å’Œè®¿é—®è€…æ¨¡å¼ã€‚ æ ¹æ®ä½œç”¨èŒƒå›´åˆ’åˆ†æ ¹æ®æ¨¡å¼æ˜¯ä¸»è¦ä½œç”¨äºç±»ä¸Šè¿˜æ˜¯ä¸»è¦ä½œç”¨äºå¯¹è±¡ä¸Šæ¥åˆ’åˆ†ï¼Œå¯åˆ†ä¸ºç±»æ¨¡å¼å’Œå¯¹è±¡æ¨¡å¼ã€‚ ç±»æ¨¡å¼ï¼šç”¨äºå¤„ç†ç±»å’Œå­ç±»ä¹‹é—´çš„å…³ç³»ï¼Œè¿™äº›å…³ç³»é€šè¿‡ç»§æ‰¿æ¥å»ºç«‹ï¼Œæ˜¯é™æ€çš„ï¼Œåœ¨ç¼–è¯‘æ—¶æœŸå°±ç¡®å®šäº†ã€‚GoFçš„ç±»æ¨¡å¼åŒ…æ‹¬å·¥å‚æ–¹æ³•æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ï¼ˆç±»ï¼‰ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼å’Œè§£é‡Šå™¨æ¨¡å¼ã€‚ å¯¹è±¡æ¨¡å¼ï¼šç”¨äºå¤„ç†å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œè¿™äº›å…³ç³»å¯ä»¥é€šè¿‡ç»„åˆå’Œèšåˆæ¥å®ç°ï¼Œåœ¨è¿è¡Œæ—¶æœŸæ˜¯å¯ä»¥åŠ¨æ€æ”¹å˜çš„ã€‚GoFä¸­é™¤äº†ç±»æ¨¡å¼ï¼Œå…¶ä½™éƒ½æ˜¯å¯¹è±¡æ¨¡å¼ã€‚ ä¸‹è¡¨æè¿°äº†è®¾è®¡æ¨¡å¼çš„åˆ†ç±»ï¼š èŒƒå›´\\ç›®çš„ åˆ›å»ºå‹ ç»“æ„å‹ è¡Œä¸ºå‹ ç±»æ¨¡å¼ å·¥å‚æ–¹æ³•æ¨¡å¼ é€‚é…å™¨æ¨¡å¼ï¼ˆç±»ï¼‰ æ¨¡æ¿æ–¹æ³•æ¨¡å¼è§£é‡Šå™¨æ¨¡å¼ å¯¹è±¡æ¨¡å¼ å•ä¾‹æ¨¡å¼åŸå‹æ¨¡å¼æŠ½è±¡å·¥å‚æ¨¡å¼å»ºé€ è€…æ¨¡å¼ ä»£ç†æ¨¡å¼é€‚é…å™¨æ¨¡å¼ï¼ˆå¯¹è±¡ï¼‰æ¡¥æ¥æ¨¡å¼è£…é¥°å™¨æ¨¡å¼å¤–è§‚æ¨¡å¼äº«å…ƒæ¨¡å¼ç»„åˆæ¨¡å¼ ç­–ç•¥æ¨¡å¼å‘½ä»¤æ¨¡å¼è´£ä»»é“¾æ¨¡å¼çŠ¶æ€æ¨¡å¼è§‚å¯Ÿè€…æ¨¡å¼ä¸­ä»‹è€…æ¨¡å¼è¿­ä»£å™¨æ¨¡å¼è®¿é—®è€…æ¨¡å¼å¤‡å¿˜å½•æ¨¡å¼ GoFçš„23ç§è®¾è®¡æ¨¡å¼ å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰ï¼šæŸä¸ªç±»åªèƒ½ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œè¯¥ç±»æä¾›äº†ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ä¾›å¤–éƒ¨è·å–è¯¥å®ä¾‹ï¼Œå…¶æ‹“å±•æ˜¯æœ‰é™å¤šä¾‹æ¨¡å¼ã€‚ åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰ï¼šå°†ä¸€ä¸ªå¯¹è±¡ä½œä¸ºåŸå‹ï¼Œé€šè¿‡å¯¹å…¶è¿›è¡Œå¤åˆ¶è€Œå…‹éš†å‡ºå¤šä¸ªå’ŒåŸå‹ç±»ä¼¼çš„æ–°å®ä¾‹ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory Methodï¼‰ï¼šå®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºäº§å“çš„æ¥å£ï¼Œç”±å­ç±»å†³å®šç”Ÿäº§ä»€ä¹ˆäº§å“ã€‚ æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstractFactoryï¼‰ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºäº§å“æ—çš„æ¥å£ï¼Œå…¶æ¯ä¸ªå­ç±»å¯ä»¥ç”Ÿäº§ä¸€ç³»åˆ—ç›¸å…³çš„äº§å“ã€‚ å»ºé€ è€…æ¨¡å¼ï¼ˆBuilderï¼‰ï¼šå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡åˆ†è§£æˆå¤šä¸ªç›¸å¯¹ç®€å•çš„éƒ¨åˆ†ï¼Œç„¶åæ ¹æ®ä¸åŒéœ€è¦åˆ†åˆ«åˆ›å»ºå®ƒä»¬ï¼Œæœ€åæ„å»ºæˆè¯¥å¤æ‚å¯¹è±¡ã€‚ ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰ï¼šä¸ºæŸå¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¯¥å¯¹è±¡çš„è®¿é—®ã€‚å³å®¢æˆ·ç«¯é€šè¿‡ä»£ç†é—´æ¥åœ°è®¿é—®è¯¥å¯¹è±¡ï¼Œä»è€Œé™åˆ¶ã€å¢å¼ºæˆ–ä¿®æ”¹è¯¥å¯¹è±¡çš„ä¸€äº›ç‰¹æ€§ã€‚ é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰ï¼šå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»èƒ½ä¸€èµ·å·¥ä½œã€‚ æ¡¥æ¥æ¨¡å¼ï¼ˆBridgeï¼‰ï¼šå°†æŠ½è±¡ä¸å®ç°åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚å®ƒæ˜¯ç”¨ç»„åˆå…³ç³»ä»£æ›¿ç»§æ‰¿å…³ç³»æ¥å®ç°ï¼Œä»è€Œé™ä½äº†æŠ½è±¡å’Œå®ç°è¿™ä¸¤ä¸ªå¯å˜ç»´åº¦çš„è€¦åˆåº¦ã€‚ è£…é¥°æ¨¡å¼ï¼ˆDecoratorï¼‰ï¼šåŠ¨æ€çš„ç»™å¯¹è±¡å¢åŠ ä¸€äº›èŒè´£ï¼Œå³å¢åŠ å…¶é¢å¤–çš„åŠŸèƒ½ã€‚ å¤–è§‚æ¨¡å¼ï¼ˆFacadeï¼‰ï¼šä¸ºå¤šä¸ªå¤æ‚çš„å­ç³»ç»Ÿæä¾›ä¸€ä¸ªä¸€è‡´çš„æ¥å£ï¼Œä½¿è¿™äº›å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“è¢«è®¿é—®ã€‚ äº«å…ƒæ¨¡å¼ï¼ˆFlyweightï¼‰ï¼šè¿ç”¨å…±äº«æŠ€æœ¯æ¥æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„å¤ç”¨ã€‚ ç»„åˆæ¨¡å¼ï¼ˆCompositeï¼‰ï¼šå°†å¯¹è±¡ç»„åˆæˆæ ‘çŠ¶å±‚æ¬¡ç»“æ„ï¼Œä½¿ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡å…·æœ‰ä¸€è‡´çš„è®¿é—®æ€§ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplateMethodï¼‰ï¼šå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•éª¨æ¶ï¼Œè€Œå°†ç®—æ³•çš„ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜è¯¥ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚ ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ï¼šå®šä¹‰äº†ä¸€ç³»åˆ—ç®—æ³•ï¼Œå¹¶å°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œä¸”ç®—æ³•çš„æ”¹å˜ä¸ä¼šå½±å“ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚ å‘½ä»¤æ¨¡å¼ï¼ˆCommandï¼‰ï¼šå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä½¿å‘å‡ºè¯·æ±‚çš„è´£ä»»å’Œæ‰§è¡Œè¯·æ±‚çš„è´£ä»»åˆ†å‰²å¼€ã€‚ èŒè´£é“¾æ¨¡å¼ï¼ˆChain of Responsibilityï¼‰ï¼šæŠŠè¯·æ±‚ä»é“¾ä¸­çš„ä¸€ä¸ªå¯¹è±¡ä¼ åˆ°ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼Œç›´åˆ°è¯·æ±‚è¢«å“åº”ä¸ºæ­¢ã€‚é€šè¿‡è¿™ç§æ–¹å¼å»é™¤å¯¹è±¡ä¹‹é—´çš„è€¦åˆã€‚ çŠ¶æ€æ¨¡å¼ï¼ˆStateï¼‰ï¼šå…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å…¶è¡Œä¸ºèƒ½åŠ›ã€‚ è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰ï¼šå¤šä¸ªå¯¹è±¡é—´å­˜åœ¨ä¸€å¯¹å¤šå…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒæŠŠè¿™ç§æ”¹å˜é€šçŸ¥ç»™å…¶ä»–å¤šä¸ªå¯¹è±¡ï¼Œä»è€Œå½±å“å…¶ä»–å¯¹è±¡çš„è¡Œä¸ºã€‚ ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediatorï¼‰ï¼šå®šä¹‰ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥ç®€åŒ–åŸæœ‰å¯¹è±¡ä¹‹é—´çš„äº¤äº’å…³ç³»ï¼Œé™ä½ç³»ç»Ÿä¸­å¯¹è±¡é—´çš„è€¦åˆåº¦ï¼Œä½¿åŸæœ‰å¯¹è±¡ä¹‹é—´ä¸å¿…ç›¸äº’äº†è§£ã€‚ è¿­ä»£å™¨æ¨¡å¼ï¼ˆIteratorï¼‰ï¼šæä¾›ä¸€ç§æ–¹æ³•æ¥é¡ºåºè®¿é—®èšåˆå¯¹è±¡ä¸­çš„ä¸€ç³»åˆ—æ•°æ®ï¼Œè€Œä¸æš´éœ²èšåˆå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚ è®¿é—®è€…æ¨¡å¼ï¼ˆVisitorï¼‰ï¼šåœ¨ä¸æ”¹å˜é›†åˆå…ƒç´ çš„å‰æä¸‹ï¼Œä¸ºä¸€ä¸ªé›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ æä¾›å¤šç§è®¿é—®æ–¹å¼ï¼Œå³æ¯ä¸ªå…ƒç´ æœ‰å¤šä¸ªè®¿é—®è€…å¯¹è±¡è®¿é—®ã€‚ å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMementoï¼‰ï¼šåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œè·å–å¹¶ä¿å­˜ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œä»¥ä¾¿ä»¥åæ¢å¤ã€‚ è§£é‡Šå™¨ï¼ˆInterpreterï¼‰æ¨¡å¼ï¼šæä¾›å¦‚ä½•å®šä¹‰è¯­è¨€çš„æ–‡æ³•ï¼Œä»¥åŠå¯¹è¯­è¨€å¥å­çš„è§£é‡Šæ–¹æ³•ï¼Œå³è§£é‡Šå™¨ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™23ç§è®¾è®¡æ¨¡å¼ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œå¾ˆå¤šæ¨¡å¼ä¹‹é—´å­˜åœ¨ä¸€å®šçš„å…³è”å…³ç³»ã€‚","link":"/2019/12/12/design-patterns/gof/GoF's-23-design-patterns/"},{"title":"ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€çŸ¥è¯†","text":"ç¬¬ä¸€ç« ï¼šä¸ºä»€ä¹ˆè¦å…³å¿ƒJava 8ç¬¬ä¸€ç« ä¸»è¦éœ€è¦äº†è§£Javaè¯­è¨€çš„å‘å±•å†å²ã€‚ Java 8çš„å‰ä¸–ä»Šç”Ÿä»ç¬¬ä¸€ä¸ªJavaç‰ˆæœ¬è¯ç”Ÿåˆ°ç°åœ¨å·²ç»æœ‰23å¹´çš„æ—¶é—´äº†ã€‚æ²§æµ·æ¡‘ç”°ä¸€ç¬é—´ï¼Œè½¬çœ¼24å¹´è¿‡å»äº†ï¼Œå¦‚ä»ŠJDK 8ä»¥ä¸Šçš„ç‰ˆæœ¬ä¹Ÿå¼€å§‹æ”¶è´¹äº†ï¼ŒJDK 11æˆä¸ºç›®å‰é•¿æœŸæ”¯æŒçš„ç‰ˆæœ¬ã€‚ç‰ˆæœ¬ä¸æ–­å˜æ›´çš„è¿™å‡ å¹´ï¼Œå¾ˆå¤šä¼ä¸šé¡¹ç›®è¿˜æ˜¯åœ¨ç”¨JDK 8æˆ–æ›´ä½çš„ç‰ˆæœ¬è¿›è¡Œç»´æŠ¤ã€‚ä½†æ˜¯å¯¹äºæˆ‘ä»¬å¼€å‘è€…æ¥è¯´ï¼Œå§‹ç»ˆè¦ä¸æ–­åœ°å­¦ä¹ äº†è§£æ–°ç‰¹æ€§å’Œæ–°æŠ€æœ¯ï¼Œå¦åˆ™å¤§æµªæ·˜æ²™ï¼Œç»ˆæœ‰ä¸€æ—¥å°†æˆä¸ºæ²™æ»©ä¸Šçš„ä¸€æ¡å’¸é±¼ã€‚ æ—¶é—´åœ¨å˜ï¼Œä½†æˆ‘ä»¬å¯¹æŠ€æœ¯çš„é‚£ä»½åˆå¿ƒæ°¸ä¸ä¼šå˜ã€‚ä½œä¸ºä¸€ä¸ªJavaå¼€å‘å·¥ç¨‹å¸ˆï¼Œå¾ˆæœ‰å¿…è¦æ¥äº†è§£ä¸€ä¸‹Javaè¯­è¨€å‘å±•å²ã€‚ 1995å¹´5æœˆ23æ—¥ï¼Œä»Oakï¼ˆæ©¡æ ‘ï¼‰åˆ°Javaï¼ŒJavaè¯­è¨€ç¬¬ä¸€æ¬¡æå‡ºäº†â€Write Once, Run Anywhereâ€çš„å£å·ã€‚ 1996å¹´1æœˆ23æ—¥ï¼ŒJavaè¯­è¨€çš„ç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬çš„è¿è¡Œç¯å¢ƒJDK 1.0å‘å¸ƒã€‚ 1998å¹´12æœˆ4æ—¥ï¼ŒJDKçš„ç¬¬ä¸€ä¸ªé‡Œç¨‹ç¢‘å¼çš„ç‰ˆæœ¬JDK 1.2å‘å¸ƒï¼Œå·¥ç¨‹ä»£å·ä¸ºPlaygroundï¼ˆç«æŠ€åœºï¼‰ã€‚sunå…¬å¸åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­æŠŠJavaæŠ€æœ¯ä½“ç³»æ‹†åˆ†ä¸ºä¸‰ä¸ªæ–¹å‘ï¼Œåˆ†åˆ«æ˜¯é¢å‘æ¡Œé¢åº”ç”¨å¼€å‘çš„J2SEï¼ˆJava 2 Platformï¼ŒStandard Editionï¼‰ã€é¢å‘ä¼ä¸šçº§å¼€å‘çš„J2EEï¼ˆJava 2 Platformï¼ŒEnterprise Editionï¼‰å’Œé¢å‘æ‰‹æœºç­‰ç§»åŠ¨ç»ˆç«¯å¼€å‘çš„J2MEï¼ˆJava 2 Platformï¼ŒMicro Editionï¼‰ã€‚ 2000å¹´5æœˆ8æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºKestrelï¼ˆç¾æ´²çº¢éš¼ [sÇ”n] ï¼‰çš„JDK 1.3å‘å¸ƒï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªä¿®æ­£ç‰ˆæœ¬JDK 1.3.1ï¼Œå·¥ç¨‹ä»£å·ä¸ºLadybirdï¼ˆç“¢è™«ï¼‰ï¼Œäº2001å¹´5æœˆ17æ—¥å‘å¸ƒã€‚ä»è¿™ä¸ªç‰ˆæœ¬å¼€å§‹ï¼ŒSunå…¬å¸ç»´æŒäº†ä¸€ä¸ªä¹ æƒ¯ï¼šå¤§çº¦æ¯éš”ä¸¤å¹´å‘å¸ƒä¸€ä¸ªJDKçš„ä¸»ç‰ˆæœ¬ï¼Œä»¥åŠ¨ç‰©å‘½åï¼ŒæœŸé—´å‘å¸ƒçš„å„ä¸ªä¿®æ­£ç‰ˆæœ¬åˆ™ä»¥æ˜†è™«ä½œä¸ºå·¥ç¨‹åç§°ã€‚ 2002å¹´2æœˆ13æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºMerlinï¼ˆç°èƒŒéš¼ï¼‰çš„JDK 1.4å‘å¸ƒã€‚åç»­è¿˜æœ‰ä¸¤ä¸ªä¿®æ­£ç‰ˆæœ¬ï¼š2002å¹´9æœˆ16æ—¥å‘å¸ƒçš„å·¥ç¨‹ä»£å·ä¸ºGrasshopperï¼ˆèš±èœ¢ï¼‰çš„JDK 1.4.1å’Œ2003å¹´6æœˆ26æ—¥å‘å¸ƒçš„å·¥ç¨‹ä»£å·ä¸ºMantisï¼ˆè³è‚ï¼‰çš„JDK 1.4.2ã€‚ 2004å¹´9æœˆ30æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºTigerï¼ˆè€è™ï¼‰çš„JDK 1.5å‘å¸ƒã€‚è¿™ä¸ªç‰ˆæœ¬çš„JDKåœ¨æˆ‘çœ‹æ¥æ˜¯Javaè¯­è¨€èƒ½å‘å±•åˆ°ä»Šå¤©çš„åŸºçŸ³ã€‚å®ƒæä¾›äº†è‡ªåŠ¨è£…ç®±ã€æ³›å‹ã€åŠ¨æ€æ³¨è§£ã€æšä¸¾ã€å¯å˜é•¿å‚æ•°ã€foreachå¾ªç¯å’Œjava.util.concurrentå¹¶å‘åŒ…ç­‰æ–°ç‰¹æ€§ï¼Œè¿™äº›æ–°ç‰¹æ€§éƒ½æ˜¯Javaè¯­è¨€çš„ç”Ÿå‘½ä¹‹æ‰€åœ¨ã€‚å®˜æ–¹ä»è¿™ä¸ªç‰ˆæœ¬å¼€å§‹ï¼Œåœ¨æ­£å¼æ–‡æ¡£ä¸å®£ä¼ ä¸Šéƒ½ä¸å†ä½¿ç”¨ç±»ä¼¼JDK 1.5çš„å‘½åï¼Œè€Œæ˜¯ä½¿ç”¨JDK 5ï¼ŒJDK 6ï¼ŒJDK 7â€¦ã€‚åªæœ‰åœ¨ç¨‹åºå‘˜å†…éƒ¨ä½¿ç”¨çš„å¼€å‘ç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚java-versionçš„è¾“å‡ºï¼‰ä¸­æ‰ç»§ç»­æ²¿ç”¨1.5ï¼Œ1.6ï¼Œ1.7çš„ç‰ˆæœ¬å·ã€‚ 2006å¹´12æœˆ11æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºMustangï¼ˆé‡é©¬ï¼‰çš„JDK 6å‘å¸ƒã€‚åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼ŒSunå…¬å¸ç»ˆç»“äº†ä»JDK 1.2å¼€å§‹å·²ç»æœ‰8å¹´å†å²çš„J2EEã€J2SEã€J2MEçš„å‘½åæ–¹å¼ï¼Œå¯ç”¨Java SEã€Java EEã€Java MEçš„å‘½åæ–¹å¼ã€‚åŒå¹´11æœˆ13æ—¥çš„JavaOneå¤§ä¼šä¸Šï¼ŒSunå…¬å¸å®£å¸ƒå°†Javaå¼€æºï¼Œå¹¶å»ºç«‹OpenJDKç»„ç»‡å¯¹å¼€æºä»£ç è¿›è¡Œç®¡ç†ã€‚ 2009å¹´2æœˆ19æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºDolphinï¼ˆæµ·è±šï¼‰çš„JDK 7çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒã€‚JDK 7æœ¬åº”æ˜¯ä¸€ä¸ªåŒ…å«è®¸å¤šé‡è¦æ”¹è¿›çš„ç‰ˆæœ¬ï¼ŒJDK 8ä¸­çš„Lambdaé¡¹ç›®åŸæœ¬è®¡åˆ’å®‰æ’åœ¨JDK 7ä¸­å‘å¸ƒï¼Œä½†ç”±äºå„ç§å•†ä¸šåŸå› ï¼ŒSunå…¬å¸æ— åŠ›è¿›è¡ŒJDK 7çš„ç ”å‘å·¥ä½œã€‚åŒå¹´4æœˆ20æ—¥ï¼ŒOracleå…¬å¸æ”¶è´­Sunå…¬å¸ï¼Œå°†å¾ˆå¤šæœªå®ç°çš„æ”¹è¿›è¿›è¡Œè£å‰ªå»¶æœŸï¼Œä»¥ä¿è¯JDK 7çš„æ­£å¼ç‰ˆèƒ½å¤Ÿåœ¨2011å¹´7æœˆ28æ—¥å‡†æ—¶å‘å¸ƒã€‚ 2011å¹´7æœˆ28æ—¥ï¼ŒOracleå…¬å¸å‘å¸ƒå·¥ç¨‹ä»£å·ä¸ºDolphinï¼ˆæµ·è±šï¼‰çš„JDK 7æ­£å¼ç‰ˆã€‚ 2014å¹´3æœˆ18æ—¥ï¼ŒOracleå…¬å¸å‘å¸ƒå·¥ç¨‹ä»£å·ä¸ºSpiderï¼ˆèœ˜è››ï¼‰çš„JDK 8ã€‚ 2017å¹´9æœˆ21æ—¥ï¼ŒOracleå…¬å¸å‘å¸ƒJDK 9ã€‚ Java 8çš„æ–°ç‰¹æ€§åˆ—è¡¨ Lambdaè¡¨è¾¾å¼å’Œæ–¹æ³•å¼•ç”¨ æµå¤„ç†StreamAPI é»˜è®¤æ–¹æ³• Optionalç±» CompletableFutureæ¥å£ æ–°çš„æ—¥æœŸæ—¶é—´API ç¬¬äºŒç« ï¼šé€šè¿‡è¡Œä¸ºå‚æ•°åŒ–ä¼ é€’ä»£ç  è¡Œä¸ºå‚æ•°åŒ–ï¼Œå°±æ˜¯ä¸€ä¸ªæ–¹æ³•æ¥å—å¤šä¸ªä¸åŒçš„è¡Œä¸ºä½œä¸ºå‚æ•°ï¼Œå¹¶åœ¨å†…éƒ¨ä½¿ç”¨å®ƒä»¬ï¼Œå®Œæˆä¸åŒè¡Œä¸ºçš„èƒ½åŠ›ã€‚ è¡Œä¸ºå‚æ•°åŒ–å¯è®©ä»£ç æ›´å¥½åœ°é€‚åº”ä¸æ–­å˜åŒ–çš„è¦æ±‚ï¼Œå‡è½»æœªæ¥çš„å·¥ä½œé‡ã€‚ ä¼ é€’ä»£ç ï¼Œå°±æ˜¯å°†æ–°è¡Œä¸ºä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•ã€‚ä½†åœ¨Java 8ä¹‹å‰è¿™å®ç°èµ·æ¥å¾ˆå•°å—¦ã€‚ä¸ºæ¥å£å£°æ˜è®¸å¤šåªç”¨ä¸€æ¬¡çš„å®ä½“ç±»è€Œé€ æˆçš„å•°å—¦ä»£ç ï¼Œåœ¨Java 8ä¹‹å‰å¯ä»¥ç”¨åŒ¿åç±»æ¥å‡å°‘ã€‚ Java APIåŒ…å«å¾ˆå¤šå¯ä»¥ç”¨ä¸åŒè¡Œä¸ºè¿›è¡Œå‚æ•°åŒ–çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬æ’åºã€çº¿ç¨‹å’ŒGUIå¤„ç†ã€‚ ç¬¬ä¸‰ç« ï¼šLambdaè¡¨è¾¾å¼å‡½æ•°å¼æ¥å£å‡½æ•°å¼æ¥å£å°±æ˜¯åªå®šä¹‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ã€‚æ¥å£ç°åœ¨è¿˜å¯ä»¥æ‹¥æœ‰é»˜è®¤æ–¹æ³•ï¼ˆå³åœ¨ç±»æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡Œå®ç°æ—¶ï¼Œå…¶ä¸»ä½“ä¸ºæ–¹æ³•æä¾›é»˜è®¤å®ç°çš„æ–¹æ³•ï¼‰ã€‚å“ªæ€•æœ‰å¾ˆå¤šé»˜è®¤æ–¹æ³•ï¼Œåªè¦æ¥å£åªå®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒå°±ä»ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚ å‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•çš„ç­¾åç§°ä¸ºå‡½æ•°æè¿°ç¬¦ã€‚ Java8 å†…ç½®å››å¤§æ ¸å¿ƒå‡½æ•°å¼æ¥å£java.util.functionåŒ…ä¸‹ï¼š æ¶ˆè´¹å‹æ¥å£ï¼šConsumer&lt;T&gt; {void accept(T t);} ä¾›ç»™å‹æ¥å£ï¼šSupplier&lt;T&gt; {T get();} å‡½æ•°å‹æ¥å£ï¼šFunction&lt;T,R&gt; {R apply(T t);} æ–­è¨€å‹æ¥å£ï¼šPredicate&lt;T&gt; {boolean test(T t);} åŸå§‹ç±»å‹ç‰¹åŒ–å‡½æ•°å¼æ¥å£ä¸ºäº†é¿å…è£…ç®±æ“ä½œï¼Œå¯¹Predicate&lt;T&gt;å’ŒFunction&lt;T, R&gt;ç­‰é€šç”¨å‡½æ•°å¼æ¥å£çš„åŸå§‹ç±»å‹ç‰¹åŒ–ï¼šIntPredicateã€IntToLongFunctionç­‰ã€‚ æ–¹æ³•å¼•ç”¨å¦‚æœä¸€ä¸ªLambdaä»£è¡¨çš„åªæ˜¯â€œç›´æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•â€ï¼Œé‚£å¥½è¿˜æ˜¯ç”¨åç§°æ¥è°ƒç”¨å®ƒï¼Œè€Œä¸æ˜¯å»æè¿°å¦‚ä½•è°ƒç”¨å®ƒã€‚ å¦‚ä½•æ„å»ºæ–¹æ³•å¼•ç”¨æ–¹æ³•å¼•ç”¨ä¸»è¦æœ‰ä¸‰ç±»ã€‚ (1) æŒ‡å‘é™æ€æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨ï¼ˆä¾‹å¦‚Integerçš„parseIntæ–¹æ³•ï¼Œå†™ä½œInteger::parseIntï¼‰ã€‚ (2) æŒ‡å‘ä»»æ„ç±»å‹å®ä¾‹æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨ï¼ˆä¾‹å¦‚String çš„ length æ–¹æ³•ï¼Œå†™ä½œString::lengthï¼‰ã€‚ (3) æŒ‡å‘ç°æœ‰å¯¹è±¡çš„å®ä¾‹æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨ï¼ˆå‡è®¾ä½ æœ‰ä¸€ä¸ªå±€éƒ¨å˜é‡expensiveTransactionç”¨äºå­˜æ”¾Transactionç±»å‹çš„å¯¹è±¡ï¼Œå®ƒæ”¯æŒå®ä¾‹æ–¹æ³•getValueï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥å†™expensive- Transaction::getValueï¼‰ã€‚ å°†Lambdaè¡¨è¾¾å¼é‡æ„ä¸ºç­‰ä»·çš„æ–¹æ³•å¼•ç”¨(1) Lambdaï¼š(args) -&gt; ClassName.staticMethod(args) ç­‰ä»·çš„æ–¹æ³•å¼•ç”¨ä¸ºï¼šClassName::staticMethodã€‚ (2) Lambdaï¼š(arg0,test) -&gt; arg0.instanceMethod(test) ç­‰ä»·çš„æ–¹æ³•å¼•ç”¨ä¸ºï¼šClassName::instanceMethodï¼Œå…¶ä¸­arg0çš„ç±»å‹æ˜¯ClassNameã€‚ (3) Lambdaï¼š(args) -&gt; expr.instanceMethod(args) ç­‰ä»·çš„æ–¹æ³•å¼•ç”¨ä¸ºï¼šexpr::instanceMethodã€‚","link":"/2019/12/12/reading-notes/java8-in-action/Part-I-Basics/"},{"title":"ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆä¸€ï¼‰ï¼šæ¥å£é‡æ„å’Œæ–°ç‰¹æ€§","text":"ç¬¬å…«ç« ï¼šé‡æ„ã€æµ‹è¯•å’Œè°ƒè¯•1. ä¸ºæ”¹å–„å¯è¯»æ€§å’Œçµæ´»æ€§é‡æ„ä»£ç å¦‚æœæ–¹å‘é”™äº†ï¼Œåœä¸‹æ¥å°±æ˜¯å‰è¿›ã€‚ çœ‹å®Œè€å‘˜å·¥ç•™ä¸‹æ¥çš„ä»£ç ï¼Œæ— åŠ›åæ§½ã€‚å¦‚æœä»¥ç³»ç»Ÿç¨³å®šå¯ç”¨ä¸ºåŸåˆ™ï¼Œä¸å»æ”¹å–„ä»£ç å¯ç»´æŠ¤æ€§ï¼Œé‚£ç­‰åˆ°å°†æ¥éœ€æ±‚å˜åŠ¨éœ€è¦ä¿®æ”¹æ—¶ï¼Œå¯¹æˆ‘ä»¬è¿™äº›åº•å±‚ç å†œæ¥è¯´ç®€ç›´æ˜¯ä¸€ç§æŠ˜ç£¨ã€‚æ¬ ä¸‹çš„æŠ€æœ¯å€ºè¿Ÿæ—©æ˜¯è¦è¿˜çš„ã€‚ 1.1 ä»åŒ¿åç±»åˆ°Lambdaè¡¨è¾¾å¼çš„è½¬æ¢åŒ¿åç±»å’ŒLambdaè¡¨è¾¾å¼ä¸­çš„thiså«ä¹‰æ˜¯ä¸åŒçš„ã€‚åœ¨åŒ¿åç±»ä¸­ï¼ŒthisæŒ‡ä»£çš„æ˜¯åŒ¿åç±»æœ¬èº«ã€‚ä½†æ˜¯åœ¨Lambdaä¸­ï¼ŒthisæŒ‡ä»£çš„æ˜¯åŒ…å«Lambdaè¡¨è¾¾å¼çš„ç±»ã€‚ åŒ¿åç±»å¯ä»¥å±è”½åŒ…å«ç±»çš„å˜é‡ï¼Œè€ŒLambdaè¡¨è¾¾å¼ä¸èƒ½ï¼ˆç¼–è¯‘éƒ½ä¸èƒ½é€šè¿‡ï¼‰ï¼Œä¾‹å¦‚ï¼š 123456789101112131415public void testAnonymityToLambda() { int a = 10; Runnable r1 = () -&gt; { // å†æ¬¡å®šä¹‰aå˜é‡ä¼šæŠ¥é”™ // int a = 1; System.out.println(a); }; Runnable r2 = new Runnable() { @Override public void run() { int a = 2; System.out.println(a); } };} 1.2 ä½¿ç”¨Lambdaé‡æ„è®¾è®¡æ¨¡å¼Lambdaè¡¨è¾¾å¼ä¸ºè§£å†³ä¼ ç»Ÿè®¾è®¡æ¨¡å¼æ‰€é¢å¯¹çš„é—®é¢˜æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆã€‚ä½¿ç”¨Lambdaè¡¨è¾¾å¼åï¼Œ å¾ˆå¤šç°å­˜çš„ç•¥æ˜¾è‡ƒè‚¿çš„é¢å‘å¯¹è±¡è®¾è®¡æ¨¡å¼èƒ½å¤Ÿç”¨æ›´ç²¾ç®€çš„æ–¹å¼å®ç°äº†ã€‚ä¾‹å¦‚ï¼š ç­–ç•¥æ¨¡å¼ æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ è´£ä»»é“¾æ¨¡å¼ å·¥å‚æ¨¡å¼ 2. æµ‹è¯•Lambdaè¡¨è¾¾å¼ä½¿ç”¨Streamæ¥å£æä¾›çš„peekæ–¹æ³•å¯æŸ¥çœ‹æµæ°´çº¿ä¸­æ¯ä¸ªæ“ä½œçš„ä¸­é—´çŠ¶æ€ï¼Œæ–¹ä¾¿è°ƒè¯•æ’é”™ã€‚ 12345678910111213public static void testPeek() { List&lt;Integer&gt; nums = Arrays.asList(1, 2, 3, 4, 5, 6, 7); nums.stream() .peek(x -&gt; System.out.println(&quot;before map&quot; + x)) .map(x -&gt; x + 17) .peek(x -&gt; System.out.println(&quot;before filter&quot; + x)) .filter(x -&gt; x % 2 == 0) .peek(x -&gt; System.out.println(&quot;before limit&quot; + x)) .limit(3) .peek(x -&gt; System.out.println(&quot;before collect&quot; + x)) .collect(Collectors.toList()) .forEach(System.out::println);} ç¬¬ä¹ç« ï¼šé»˜è®¤æ–¹æ³•å…ˆæ¥å›é¡¾ä¸€ä¸‹æ¥å£çš„ç›¸å…³çŸ¥è¯†ã€‚ æ¥å£ä½¿ç”¨interfaceå…³é”®å­—å£°æ˜ï¼Œè®¿é—®ä¿®é¥°ç¬¦å¯ä»¥ä¸ºpublicå’Œé»˜è®¤ï¼ˆä¸å†™ï¼‰ï¼›åŒæ—¶å¯ä»¥ä½¿ç”¨abstractå…³é”®å­—ä¿®é¥°ï¼Œå› ä¸ºæ¥å£å¯ä»¥ç†è§£æˆä¸€ç§å®Œå…¨æŠ½è±¡ã€‚ä½¿ç”¨abstractå…³é”®å­—ç¼–è¯‘å™¨ä¼šè®©ä½ é€šè¿‡ç¼–è¯‘ï¼Œä½†ä¸€èˆ¬æ²¡æœ‰äººè¿™æ ·åšã€‚ Java 8 å‰ æ¥å£ä¸­çš„æˆå‘˜å˜é‡çš„ä¿®é¥°ç¬¦å…¨éƒ¨é»˜è®¤ä¸ºpublic static finalï¼Œä¹Ÿå¯ä»¥ä¸æ˜¯é™æ€staticçš„ï¼Œä½†ä¸€èˆ¬æ²¡æœ‰äººè¿™æ ·åšã€‚ æ¥å£ä¸­çš„æ–¹æ³•åªèƒ½æ˜¯æŠ½è±¡æ–¹æ³•ã€‚ æ¥å£ä¸­æ–¹æ³•çš„ä¿®é¥°ç¬¦å…¨éƒ¨é»˜è®¤ä¸ºpublic abstractã€‚ Java 8 å æ¥å£ä¸­æ–°å¢é»˜è®¤æ–¹æ³•â€“ä½¿ç”¨defaultå…³é”®å­—å£°æ˜ã€‚ æ¥å£ä¸­å¯ä»¥å£°æ˜é™æ€æ–¹æ³•ã€‚ ä¸ºä»€ä¹ˆè¦æœ‰é»˜è®¤æ–¹æ³•ï¼Ÿå¦‚æœåŸæ¥çš„æ¥å£å·²ç»è¢«å¾ˆå¤šäººä½¿ç”¨äº†ï¼Œç°åœ¨è¦åœ¨åŸæ¥çš„æ¥å£ä¸­æ–°å¢ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨Java 8ä¹‹å‰ï¼Œæ‰€æœ‰çš„å®ç°ç±»éƒ½éœ€è¦å»æ˜¾å¼å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œä¼šé€ æˆå¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ï¼Œä¹Ÿè®¸æœ‰äº›å®ç°ç±»æ ¹æœ¬å°±ä¸éœ€è¦ç”¨åˆ°æ–°å¢çš„è¿™ä¸ªæ–¹æ³•ï¼Œåè€Œéœ€è¦å¼ºåˆ¶åœ¨ä»£ç ä¸­å†™ä¸€ä¸ªæ˜¾å¼çš„ç©ºå®ç°ã€‚æ­£æ˜¯ç”±äºè¿™ä¸ªåŸå› ï¼ŒJava 8æä¾›äº†é»˜è®¤æ–¹æ³•ï¼Œæ¥å£ä¸­æ–°å¢çš„æ–¹æ³•ä½¿ç”¨defaultå…³é”®å­—ä¿®é¥°ï¼Œå°±å¯ä»¥åœ¨æ¥å£ä¸­æä¾›ä¸€ä¸ªé»˜è®¤å®ç°ï¼Œå®ç°ç±»ä¸å†éœ€è¦å¼ºåˆ¶æ˜¾å¼å®ç°è¿™ä¸ªæ–°å¢æ–¹æ³•ã€‚è¿™ä¸ªæ–°ç‰¹æ€§ä¸»è¦æ˜¯é¢å‘ç±»åº“å¼€å‘è€…ã€‚ é»˜è®¤æ–¹æ³•å¼•å‘çš„å¤šå®ç°å†²çªé—®é¢˜ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚ç”±äºå‡ºç°äº†é»˜è®¤æ–¹æ³•ï¼Œå½“ä¸€ä¸ªç±»æœ‰å¤šä¸ªå®ç°æ—¶å¯èƒ½ä¼šå‡ºç°æ–¹æ³•ç»§æ‰¿å†²çªçš„é—®é¢˜ã€‚ è§£å†³é—®é¢˜çš„ä¸‰ä¸ªåŸåˆ™ ç±»ä¸­çš„æ–¹æ³•ä¼˜å…ˆçº§æœ€é«˜ã€‚ç±»æˆ–çˆ¶ç±»ä¸­å£°æ˜çš„æ–¹æ³•çš„ä¼˜å…ˆçº§é«˜äºä»»ä½•å£°æ˜ä¸ºé»˜è®¤æ–¹æ³•çš„ä¼˜å…ˆçº§ã€‚ å¦‚æœæ— æ³•ä¾æ®ç¬¬ä¸€æ¡è¿›è¡Œåˆ¤æ–­ï¼Œé‚£ä¹ˆå­æ¥å£çš„ä¼˜å…ˆçº§æ›´é«˜ï¼šå‡½æ•°ç­¾åç›¸åŒæ—¶ï¼Œä¼˜å…ˆé€‰æ‹©æ‹¥æœ‰æœ€å…·ä½“å®ç°çš„é»˜è®¤æ–¹æ³•çš„æ¥å£ï¼Œå³å¦‚æœBç»§æ‰¿äº†Aï¼Œé‚£ä¹ˆBå°±æ¯”Aæ›´åŠ å…·ä½“ã€‚ æœ€åï¼Œå¦‚æœè¿˜æ˜¯æ— æ³•åˆ¤æ–­ï¼Œç»§æ‰¿äº†å¤šä¸ªæ¥å£çš„ç±»å¿…é¡»é€šè¿‡æ˜¾å¼è¦†ç›–å’Œè°ƒç”¨æœŸæœ›çš„æ–¹æ³•ï¼Œæ˜¾å¼åœ°é€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªé»˜è®¤æ–¹æ³•çš„å®ç°ã€‚ å†²çªæƒ…å†µåˆ†ææƒ…å½¢ä¸€ æ¥å£InterfaceAä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•helloã€‚ æ¥å£InterfaceBç»§æ‰¿äº†æ¥å£InterfaceAï¼ŒåŒæ—¶æä¾›è‡ªå·±çš„é»˜è®¤helloæ–¹æ³•ã€‚ å®ç°ç±»ImplClassCå®ç°InterfaceAæ¥å£å’ŒInterfaceBæ¥å£ï¼Œæ²¡æœ‰æ˜¾å¼å®ç°helloæ–¹æ³•ã€‚ æ¥å£InterfaceBç»§æ‰¿äº†InterfaceAï¼Œæ¥å£InterfaceBä¸­çš„helloæ–¹æ³•æ›´å…·ä½“ï¼Œæ‰€ä»¥å®ç°ç±»ImplClassCæ‹¥æœ‰çš„æ˜¯InterfaceBæ¥å£ä¸­çš„helloæ–¹æ³•ã€‚ æƒ…å½¢äºŒ æ¥å£InterfaceAä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•helloã€‚ æ¥å£InterfaceBç»§æ‰¿äº†æ¥å£InterfaceAï¼ŒåŒæ—¶æä¾›è‡ªå·±çš„é»˜è®¤helloæ–¹æ³•ã€‚ å®ç°ç±»ImplClassDå®ç°InterfaceAæ¥å£ï¼Œæœªæ˜¾å¼é‡å†™æ¥å£çš„helloæ–¹æ³•ã€‚ å®ç°ç±»ImplClassCç»§æ‰¿ImplClassDç±»ï¼ŒåŒæ—¶å®ç°InterfaceAå’ŒInterfaceBæ¥å£ï¼Œæ²¡æœ‰æ˜¾å¼å®ç°helloæ–¹æ³•ã€‚ ImplClassCå’ŒImplClassDç±»ä¸­éƒ½æœªå®ç°helloæ–¹æ³•ï¼ŒInterfaceBç»§æ‰¿InterfaceAæ¥å£ï¼Œæ‰€ä»¥InterfaceBæ¥å£ä¸­çš„æ–¹æ³•æ›´å…·ä½“ï¼Œæ‰€ä»¥ImplClassCç±»å…·æœ‰çš„æ˜¯InterfaceBä¸­çš„helloæ–¹æ³•ã€‚ æƒ…å½¢ä¸‰ æ¥å£InterfaceAä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•helloã€‚ æ¥å£InterfaceBç»§æ‰¿äº†æ¥å£InterfaceAï¼ŒåŒæ—¶æä¾›è‡ªå·±çš„é»˜è®¤helloæ–¹æ³•ã€‚ å®ç°ç±»ImplClassDå®ç°äº†InterfaceAæ¥å£ï¼Œå¹¶æ˜¾å¼é‡å†™äº†æ¥å£çš„helloæ–¹æ³•ã€‚ å®ç°ç±»ImplClassCç»§æ‰¿äº†ImplClassDå®ç°ç±»ï¼Œå¹¶å®ç°äº†InterfaceAå’ŒInterfaceBæ¥å£ï¼Œæ²¡æœ‰æ˜¾å¼å®ç°helloæ–¹æ³•ã€‚ ImplClassCå’ŒImplClassDç±»ä¸­éƒ½æœªå®ç°helloæ–¹æ³•ï¼ŒInterfaceBç»§æ‰¿InterfaceAæ¥å£ï¼Œæ‰€ä»¥InterfaceBæ¥å£ä¸­çš„æ–¹æ³•æ›´å…·ä½“ï¼Œæ‰€ä»¥ImplClassCç±»å…·æœ‰çš„æ˜¯InterfaceBä¸­çš„helloæ–¹æ³•ã€‚ æƒ…å½¢å›› æ¥å£InterfaceAä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•helloã€‚ æ¥å£InterfaceBä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•helloï¼Œæœªç»§æ‰¿ã€‚ å®ç°ç±»ImplClassCå®ç°InterfaceAå’ŒInterfaceBæ¥å£ã€‚ å¦‚æœå®ç°ç±»ImplClassCä¸é‡å†™helloæ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šæŠ›å‡ºç¼–è¯‘é”™è¯¯ï¼šImplClassC inherits unrelated defaults for hello() from types InterfaceA and InterfaceBã€‚ å¯ä»¥ç›´æ¥åœ¨å®ç°ç±»ä¸­é‡æ–°å†™ä¸€ä¸ªhelloæ–¹æ³•çš„å®ç°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨superå…³é”®å­—è°ƒç”¨çˆ¶æ¥å£çš„é»˜è®¤å®ç°ã€‚ æƒ…å½¢äº” æ¥å£InterfaceAä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•helloã€‚ æ¥å£InterfaceBç»§æ‰¿äº†æ¥å£InterfaceAï¼Œæœªæä¾›ä»»ä½•æ–¹æ³•ã€‚ æ¥å£InterfaceCç»§æ‰¿äº†æ¥å£InterfaceAï¼Œæœªæä¾›ä»»ä½•æ–¹æ³•ã€‚ å®ç°ç±»ImplClassDå®ç°InterfaceBå’ŒInterfaceCæ¥å£ã€‚ InterfaceBå’ŒInterfaceCæ¥å£ä¸­éƒ½æ²¡æœ‰helloå®ç°ï¼Œå®ƒä»¬çš„çˆ¶æ¥å£InterfaceAä¸­æ‰æœ‰helloçš„é»˜è®¤å®ç°ï¼Œæ‰€ä»¥å®ç°ç±»ImplClassDæ‹¥æœ‰æ¥å£InterfaceAä¸­helloæ–¹æ³•ã€‚ æƒ…å½¢äº”æ‰©å±•å¦‚æœInterfaceBä¸­ä¹Ÿæä¾›helloé»˜è®¤å®ç°ï¼Œæ ¹æ®è§„åˆ™ç¬¬äºŒç‚¹ï¼Œç¼–è¯‘å™¨ä¼šé€‰æ‹©InterfaceBä¸­å£°æ˜çš„é»˜è®¤æ–¹æ³•ã€‚ å¦‚æœInterfaceBå’ŒInterfaceCéƒ½æä¾›helloé»˜è®¤å®ç°ï¼Œå°±ä¼šå‡ºç°å†²çªï¼ŒImplClassDå®ç°ç±»å¿…é¡»å®ç°helloæ–¹æ³•ã€‚ å¦‚æœInterfaceCæ¥å£ä¸­æ·»åŠ éé»˜è®¤æŠ½è±¡æ–¹æ³•helloï¼Œé‚£ä¹ˆå®ƒæ¯”ç»§æ‰¿InterfaceAæ¥å£è€Œæ¥çš„helloä¼˜å…ˆçº§é«˜ï¼Œæ­¤æ—¶å®ç°ç±»ImplClassDå¿…é¡»æ˜¾å¼å®ç°InterfaceCçš„helloæŠ½è±¡æ–¹æ³•ã€‚","link":"/2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(1)/"},{"title":"ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆäºŒï¼‰ï¼šä¼˜é›…çš„è§£å†³NPEé—®é¢˜","text":"ç¬¬åç« ï¼šç”¨Optionalå–ä»£nullnullå¼•ç”¨çš„æƒ³æ³•æœ€åˆç”±ä¸€ä½è‹±å›½è®¡ç®—æœºç§‘å­¦å®¶æå‡ºã€‚ä»–è®¤ä¸ºè¿™æ˜¯ä¸ºâ€ä¸å­˜åœ¨çš„å€¼â€œå»ºæ¨¡æœ€å®¹æ˜“çš„æ–¹å¼ã€‚è®¾è®¡åˆè¡·æ˜¯é€šè¿‡ç¼–è¯‘å™¨çš„è‡ªåŠ¨æ£€æµ‹æœºåˆ¶ï¼Œç¡®ä¿æ‰€æœ‰ä½¿ç”¨å¼•ç”¨çš„åœ°æ–¹éƒ½æ˜¯ç»å¯¹å®‰å…¨çš„ã€‚è¿‘äº›å¹´å‡ºç°çš„ç°ä»£ç¨‹åºè®¾è®¡è¯­è¨€åŒ…æ‹¬Javaåœ¨å†…ï¼Œéƒ½é‡‡ç”¨äº†ç›¸åŒçš„è®¾è®¡æ–¹å¼ã€‚ null å¼•ç”¨å¸¦æ¥çš„é—®é¢˜ é”™è¯¯ä¹‹æºï¼šç¨‹åºå‘˜å¯¹å¯¹è±¡çš„å­—æ®µè¿›è¡Œæ£€æŸ¥ï¼Œåˆ¤æ–­å­—æ®µçš„å€¼æ˜¯å¦ä¸ºæœŸæœ›çš„æ ¼å¼ï¼Œæœ€ç»ˆå´å‘ç°è®¿é—®çš„å¹¶ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªnullå¼•ç”¨â€“ç©ºæŒ‡é’ˆï¼Œäºæ˜¯æŠ›å‡ºä¸€ä¸ªNullPointerExceptionå¼‚å¸¸ã€‚ ä»£ç è†¨èƒ€ï¼šä¸ºäº†é˜²æ­¢nullï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå†™å‡ºè¿™æ ·ç±»ä¼¼çš„ä»£ç ï¼šif (xxx != null) { // dosomething}ã€‚è¿™æ ·ä½ çš„ä»£ç å°±ä¼šå……æ–¥ç€æ·±åº¦åµŒå¥—çš„nullæ£€æŸ¥ï¼Œä»£ç å¯è¯»æ€§æå·®ã€‚ æ¯«æ— æ„ä¹‰ï¼šnullè‡ªèº«æ²¡æœ‰ä»»ä½•çš„è¯­ä¹‰ï¼Œå°¤å…¶æ˜¯ï¼Œå®ƒä»£è¡¨çš„æ˜¯åœ¨é™æ€ç±»å‹è¯­è¨€ä¸­ä»¥ä¸€ç§é”™è¯¯çš„æ–¹å¼å¯¹ç¼ºå¤±å˜é‡å€¼çš„å»ºæ¨¡ã€‚ ç ´åå“²å­¦ï¼šJavaä¸€ç›´è¯•å›¾é¿å…è®©ç¨‹åºå‘˜æ„è¯†åˆ°æŒ‡é’ˆçš„å­˜åœ¨ï¼Œå”¯ä¸€çš„ä¾‹å¤–æ˜¯ï¼šnullæŒ‡é’ˆã€‚ ä½¿ç”¨é˜²å¾¡å¼ç¼–ç¨‹æ€æƒ³å‡å°‘NPEé—®é¢˜NullPointerExceptionç®€ç§°NPEã€‚ é‡‡ç”¨é˜²å¾¡å¼ç¼–ç¨‹â€“å¿«é€Ÿå¤±è´¥çš„æ€æƒ³å¯ä»¥æœ‰æ•ˆå‡å°‘NPEé—®é¢˜ã€‚ å¦‚ä¸‹çš„ä»£ç æ˜¯æ¨èçš„æ–¹å¼ï¼š 1234567if (param1 == null) { return false;}if (param2 == null) { return false;}// do service ä¸è¦ä½¿ç”¨try-catchçš„æ–¹å¼æ¥å¤„ç†ã€‚ä¾‹å¦‚ï¼š 12345try { param.function();} catch (NullPointerException e) { ...} ä½¿ç”¨è¿™ç§é˜²å¾¡å¼ç¼–ç¨‹çš„æ–¹æ³•èƒ½æœ‰æ•ˆè§£å†³é—®é¢˜ï¼Œä½†ä»ç„¶ææ˜“å‡ºé”™ï¼Œä¸€æ—¦å¿˜è®°æ£€æŸ¥é‚£ä¸ªå¯èƒ½ä¸ºnullçš„å±æ€§å°±ä¼šåŸ‹ä¸‹ä¸€ä¸ªéšè—çš„bugã€‚ ä¼˜é›…çš„è§£å†³æ–¹å¼Java 8ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç±»java.util.Optional&lt;T&gt;æ¥ä¼˜é›…çš„è§£å†³NPEé—®é¢˜ã€‚ å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªPersonç±»ï¼Œæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ï¼šæ±½è½¦Carç±»ï¼›æ±½è½¦Carç±»ä¸­åˆæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ï¼šä¿é™©å…¬å¸Insuranceç±»ï¼›ä¿é™©å…¬å¸Insuranceç±»ä¸­æœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ï¼šStringç±»å‹çš„å…¬å¸åã€‚ä½ å¯èƒ½ä¼šæŒ‰ä¸‹é¢çš„æ–¹å¼è®¾è®¡ã€‚Personç±»ï¼š 123456public class Person { private Car car; public Car getCar() { return car; }} Carç±»ï¼š 123456public class Car { private Insurance insurance; public Insurance getInsurance() { return insurance; }} Insuranceç±»ï¼š 123456public class Insurance { private String name; public String getName() { return name; }} ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªäººå¯èƒ½æœ‰è½¦ä¹Ÿå¯èƒ½æ²¡æœ‰è½¦ï¼Œå½“ä¸€ä¸ªäººæ²¡è½¦æ—¶éœ€è¦å°†nullå¼•ç”¨èµ‹å€¼ç»™carå˜é‡ï¼Œäºæ˜¯æˆ‘ä»¬åº”è¯¥å°†carå˜é‡å£°æ˜ä¸ºOptional&lt;Car&gt;ç±»å‹ï¼›ä¸€è¾†è½¦å¯èƒ½ä¹°äº†ä¿é™©ä¹Ÿå¯èƒ½æ²¡ä¹°ä¿é™©ï¼Œäºæ˜¯Carç±»ä¸­çš„insuranceå­—æ®µä¹Ÿåº”è¯¥å£°æ˜ä¸ºOptional&lt;Insurance&gt;ç±»å‹ï¼›ä¿é™©å…¬å¸ä¸€å®šæœ‰ä¸€ä¸ªå…¬å¸åç§°ï¼Œæ‰€ä»¥Insuranceç±»ä¸­çš„nameå­—æ®µä¸ç”¨å£°æ˜æˆOptionalç±»å‹ã€‚æ–°çš„ç±»å®šä¹‰å¦‚ä¸‹ï¼šPersonç±»ï¼š 12345678import java.util.Optional;public class Person { private Optional&lt;Car&gt; car; public Optional&lt;Car&gt; getCar() { return car; }} Carç±»ï¼š 12345678import java.util.Optional;public class Car { private Optional&lt;Insurance&gt; insurance; public Optional&lt;Insurance&gt; getInsurance() { return insurance; }} Insuranceç±»ï¼š 123456public class Insurance { private String name; public String getName() { return name; }} å½“carå˜é‡å­˜åœ¨æ—¶ï¼ŒOptionalç±»åªæ˜¯å¯¹Carç±»ç®€å•å°è£…ã€‚å½“å˜é‡ä¸å­˜åœ¨æ—¶ï¼Œç¼ºå¤±çš„å€¼ä¼šè¢«å»ºæ¨¡æˆä¸€ä¸ªâ€œç©ºâ€ çš„Optionalå¯¹è±¡ï¼Œç”±æ–¹æ³•Optional.empty()è¿”å›ã€‚Optional.empty()æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€å·¥å‚ æ–¹æ³•ï¼Œå®ƒè¿”å›Optionalç±»çš„ç‰¹å®šå•ä¸€å®ä¾‹ï¼Œä¸nullå®Œå…¨ä¸ä¸€æ ·ã€‚ ä½•æ—¶ä½¿ç”¨Optionalç±»ï¼Ÿåœ¨å®é™…ä¸šåŠ¡ç¼–ç ä¸­ï¼Œæˆ‘ä»¬åªèƒ½é è‡ªå·±å¯¹ä¸šåŠ¡æ¨¡å‹çš„ç†è§£è¿›è¡Œåˆ¤æ–­ï¼Œéœ€è¦åˆ¤æ–­å‡ºä¸€ä¸ªnullæ˜¯å¦å±äºæŸä¸ªå˜é‡çš„æœ‰æ•ˆèŒƒå›´ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä¸€ä¸ªç±»åŒ…å«äº†Optionalæˆå‘˜å˜é‡ï¼Œåˆ™è¯¥ç±»æ— æ³•è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚ åŸå› æ˜¯Optionalç±»æœªå®ç°åºåˆ—åŒ–Serializableæ¥å£ã€‚æ‰€ä»¥å¦‚æœä½ çš„ç±»æ˜¯ç±»ä¼¼DubboæœåŠ¡æä¾›è€…è¿”å›çš„æ¨¡å‹å¯¹è±¡ï¼Œåˆ™ä¸èƒ½å°†ç±»æˆå‘˜è®¾è®¡æˆOptionalç±»å‹ã€‚ Javaè¯­è¨€çš„æ¶æ„å¸ˆBrian Goetzæ›¾ç»éå¸¸æ˜ç¡®åœ°é™ˆè¿°è¿‡ï¼ŒOptionalçš„è®¾è®¡åˆè¡·ä»…ä»…æ˜¯è¦æ”¯æŒèƒ½è¿”å›Optionalå¯¹è±¡çš„è¯­æ³•ã€‚ç”±äºOptionalç±»è®¾è®¡æ—¶å°±æ²¡ç‰¹åˆ«è€ƒè™‘å°†å…¶ä½œä¸ºç±»çš„å­—æ®µä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒå¹¶æœªå®ç°Serializableæ¥å£ã€‚ åº”ç”¨Optionalçš„å‡ ç§æ¨¡å¼1. åˆ›å»ºOptionalå¯¹è±¡ å£°æ˜ä¸€ä¸ªç©ºçš„Optionalï¼šé€šè¿‡é™æ€å·¥å‚æ–¹æ³•Optional.emptyï¼Œåˆ›å»ºä¸€ä¸ªç©ºçš„Optionalå¯¹è±¡ï¼š1Optional&lt;Car&gt; optCar = Optional.empty(); ä¾æ®ä¸€ä¸ªéç©ºå€¼åˆ›å»ºOptionalï¼šä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•Optional.ofï¼Œä¾æ®ä¸€ä¸ªéç©ºå€¼åˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡ï¼š 1Optional&lt;Car&gt; optCar = Optional.of(car); å¦‚æœcarå˜é‡æ˜¯ä¸€ä¸ªnullå€¼ï¼Œåˆ™è¿™æ®µä»£ç ä¼šç«‹å³æŠ›å‡ºNullPointerExceptionï¼Œè€Œä¸æ˜¯ç­‰åˆ°è¯•å›¾è®¿é—®carçš„å±æ€§æ—¶æ‰è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ å¯æ¥å—nullçš„Optionalï¼šä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•Optional.ofNullalbeï¼Œåˆ›å»ºä¸€ä¸ªå…è®¸nullå€¼çš„Optionalå¯¹è±¡ï¼š1Optional&lt;Car&gt; optCar = Optional.ofNullable(car); å¦‚æœcarå˜é‡æ˜¯ä¸€ä¸ªnullå€¼ï¼Œé‚£ä¹ˆå¾—åˆ°çš„Optionalå¯¹è±¡å°±æ˜¯ä¸ªç©ºå¯¹è±¡ã€‚ 2. ä½¿ç”¨mapä»Optionalå¯¹è±¡ä¸­æå–å’Œè½¬æ¢å€¼Optionalç±»çš„mapæ–¹æ³•å’ŒStreamç±»çš„mapæ–¹æ³•ç›¸å·®æ— å‡ ã€‚mapæ–¹æ³•ä¼šå°†æµä¸­çš„æ¯ä¸ªå…ƒç´ é€šè¿‡æä¾›çš„å‡½æ•°è¿›è¡Œæ˜ å°„ã€‚å¯ä»¥æŠŠOptionalå¯¹è±¡çœ‹æˆä¸€ä¸ªç‰¹æ®Šçš„é›†åˆï¼Œå®ƒæœ€å¤šåŒ…å«ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœOptionalåŒ…å«ä¸€ä¸ªå€¼ï¼Œé‚£mapæ–¹æ³•å°±ä¼šæŠŠè¯¥å€¼é€šè¿‡æä¾›çš„å‡½æ•°æ˜ å°„æˆå…¶å®ƒå€¼ï¼Œå¦åˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚ 3. ä½¿ç”¨flatMapé“¾æ¥Optionalå¯¹è±¡åŒæ ·çš„ï¼ŒOptionalç±»çš„flatMapæ–¹æ³•å’Œæµçš„ç”¨æ³•ä¹Ÿç±»ä¼¼ã€‚flatMapæ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯å¦ä¸€ä¸ªæµã€‚è¿™ä¸ªå‡½æ•°ä¼šåº”ç”¨åˆ°æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œäºæ˜¯æ¯ä¸ªå…ƒç´ è¢«æ˜ å°„æˆä¸€ä¸ªå°æµï¼Œæ¯ä¸ªå°æµåˆå½¢æˆä¸€ä¸ªå¤§æµä½œä¸ºflatMapæ–¹æ³•çš„è¿”å›å€¼ã€‚ä½†æ˜¯flatMapä¼šå°†è¿™ä¸ªå¤§æµä¸­çš„å°æµæ‰å¹³åŒ–æˆä¸€ä¸ªå•ä¸€çš„æµã€‚å³æµä¸­ä¸åŒ…å«æµï¼ŒåªåŒ…å«å„ä¸ªå…ƒç´ ã€‚ 4. é»˜è®¤è¡Œä¸ºåŠè§£å¼•ç”¨Optionalå¯¹è±¡Optionalç±»æä¾›äº†å¤šç§æ–¹æ³•è¯»å–Optionalå®ä¾‹ä¸­çš„å˜é‡å€¼ã€‚ get()ï¼šå¦‚æœå˜é‡å­˜åœ¨ï¼Œç›´æ¥è¿”å›å°è£…çš„å˜é‡å€¼ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ªNoSuchElementExceptionå¼‚å¸¸ã€‚ orElse(T other)ï¼šå…è®¸åœ¨Optionalå¯¹è±¡ä¸åŒ…å«å€¼æ—¶æä¾›ä¸€ä¸ªé»˜è®¤å€¼ã€‚ orElseGet(Supplier&lt;? extends T&gt; other)ï¼šæ˜¯orElseæ–¹æ³•çš„å»¶æ—¶è°ƒç”¨ç‰ˆï¼ŒSupplieræ–¹æ³•åªæœ‰åœ¨Optionalå¯¹è±¡ä¸å«å€¼æ—¶æ‰æ‰§è¡Œè°ƒç”¨ã€‚å¦‚æœåˆ›å»ºé»˜è®¤å€¼æ˜¯ä»¶è€—æ—¶æ“ä½œï¼Œè€ƒè™‘ä½¿ç”¨è¯¥æ–¹æ³•ï¼›æˆ–è€…éå¸¸ç¡®å®šæŸä¸ªæ–¹æ³•ä»…åœ¨Optionalä¸ºç©ºæ—¶æ‰æ‰§è¡Œè°ƒç”¨ï¼Œä¹Ÿè€ƒè™‘ä½¿ç”¨è¯¥æ–¹æ³•ã€‚ orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier)ï¼šå’Œgetæ–¹æ³•ç±»ä¼¼ï¼Œå¦‚æœå–å‡ºçš„å€¼ä¸ºç©ºéƒ½ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œä½¿ç”¨orElseThrowå¯ä»¥å®šåˆ¶å¸Œæœ›æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚ ifPresent(Consumer&lt;? extends T&gt;)ï¼šåœ¨å˜é‡å€¼å­˜åœ¨æ—¶æ‰§è¡Œä¸€ä¸ªä¼ å…¥çš„Consumeræ–¹æ³•ï¼Œå¦åˆ™ä¸åšä»»ä½•å¤„ç†ã€‚ 5. ä½¿ç”¨filterå‰”é™¤ç‰¹å®šçš„å€¼æˆ‘ä»¬ç»å¸¸éœ€è¦è°ƒç”¨æŸä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼ŒæŸ¥çœ‹å®ƒçš„æŸäº›å±æ€§ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ£€æŸ¥ä¿é™©å…¬å¸çš„åç§°æ˜¯å¦ä¸ºCambridgeInsuranceï¼Œä¸ºäº†ä»¥ä¸€ç§å®‰å…¨çš„æ–¹å¼è¿›è¡Œè¿™äº›æ“ä½œï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç¡®å®šå¼•ç”¨æŒ‡å‘çš„Insuranceå¯¹è±¡æ˜¯å¦ä¸ºnullï¼Œä¹‹åå†è°ƒç”¨å®ƒçš„getNameæ–¹æ³•ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234Insurance insurance = ...;if (insurance != null &amp;&amp; &quot;CambridgeInsurance&quot;.equals(insurance.getName())) { System.out.println(&quot;ok&quot;);} å¦‚æœä½¿ç”¨Optionalå¯¹è±¡çš„filteræ–¹æ³•ï¼Œè¿™æ®µä»£ç å¯ä»¥é‡æ„å¦‚ä¸‹ï¼š 123Optional&lt;Insurance&gt; optInsurance = ...;optInsurance.filter(ins -&gt; &quot;CambridgeInsurance&quot;.equals(ins.getName())) .ifPresent(x -&gt; System.out.println(&quot;ok&quot;)); å¦‚æœOptionalå¯¹è±¡åŒ…å«çš„å€¼ä¸ºç©ºï¼Œå®ƒä¸åšä»»ä½•æ“ä½œï¼›åä¹‹ï¼Œå®ƒå¯¹Optionalå¯¹è±¡åŒ…å«çš„å€¼æ·»åŠ è°“è¯æ“ä½œï¼Œå¦‚æœè¯¥æ“ä½œçš„ç»“æœä¸ºtrueï¼Œå®ƒä¸åšä»»ä½•æ”¹å˜ï¼Œç›´æ¥è¿”å›è¯¥Optionalå¯¹è±¡ï¼Œå¦åˆ™å°±å°†è¯¥å€¼è¿‡æ»¤æ‰ï¼Œå°†Optionalçš„å€¼ç½®ä¸ºç©ºã€‚ Optionalç±»çš„æ–¹æ³• æ–¹æ³•å æè¿° empty è¿”å›ä¸€ä¸ªç©ºçš„ Optional å®ä¾‹ filter å¦‚æœå€¼å­˜åœ¨å¹¶ä¸”æ»¡è¶³æä¾›çš„è°“è¯ï¼Œå°±è¿”å›åŒ…å«è¯¥å€¼çš„ Optional å¯¹è±¡ï¼›å¦åˆ™è¿”å›ä¸€ä¸ªç©ºçš„ Optional å¯¹è±¡ flatMap å¦‚æœå€¼å­˜åœ¨ï¼Œå°±å¯¹è¯¥å€¼æ‰§è¡Œæä¾›çš„mappingæ˜ å°„å‡½æ•°è°ƒç”¨ï¼Œè¿”å›ä¸€ä¸ª Optional ç±»å‹çš„å€¼ï¼Œå¦åˆ™å°±è¿”å›ä¸€ä¸ªç©ºçš„ Optional å¯¹è±¡ get å¦‚æœè¯¥å€¼å­˜åœ¨ï¼Œå°†è¯¥å€¼ç”¨ Optional å°è£…è¿”å›ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ª NoSuchElementException å¼‚å¸¸ ifPresent å¦‚æœå€¼å­˜åœ¨ï¼Œå°±æ‰§è¡Œä½¿ç”¨è¯¥å€¼çš„æ–¹æ³•è°ƒç”¨ï¼Œå¦åˆ™ä»€ä¹ˆä¹Ÿä¸åš isPresent å¦‚æœå€¼å­˜åœ¨å°±è¿”å› trueï¼Œå¦åˆ™è¿”å› false map å¦‚æœå€¼å­˜åœ¨ï¼Œå°±å¯¹è¯¥å€¼æ‰§è¡Œæä¾›çš„ mappingæ˜ å°„å‡½æ•°è°ƒç”¨ of å°†æŒ‡å®šå€¼ç”¨ Optional å°è£…ä¹‹åè¿”å›ï¼Œå¦‚æœè¯¥å€¼ä¸º nullï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª NullPointerException å¼‚å¸¸ ofNullable å°†æŒ‡å®šå€¼ç”¨ Optional å°è£…ä¹‹åè¿”å›ï¼Œå¦‚æœè¯¥å€¼ä¸º nullï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºçš„ Optional å¯¹è±¡ orElse å¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ orElseGet å¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªç”±æŒ‡å®šçš„ Supplier æ¥å£ç”Ÿæˆçš„å€¼ orElseThrow å¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ªç”±æŒ‡å®šçš„ Supplier æ¥å£ç”Ÿæˆçš„å¼‚å¸¸ åŸºç¡€ç±»å‹çš„Optionalå¯¹è±¡ï¼Œä»¥åŠä¸ºä»€ä¹ˆåº”è¯¥é¿å…ä½¿ç”¨å®ƒä»¬ä¸Streamå¯¹è±¡ä¸€æ ·ï¼ŒOptionalä¹Ÿæä¾›äº†ç±»ä¼¼çš„åŸºç¡€ç±»å‹ï¼šOptionalIntã€OptionalLongä»¥åŠOptionalDoubleã€‚ å¦‚æœStreamå¯¹è±¡åŒ…å«äº†å¤§é‡å…ƒç´ ï¼Œå‡ºäºæ€§èƒ½çš„è€ƒé‡ï¼Œ ä½¿ç”¨åŸºç¡€ç±»å‹æ˜¯ä¸é”™çš„é€‰æ‹©ï¼Œä½†å¯¹äºOptionalå¯¹è±¡è€Œè¨€ï¼Œè¿™ä¸ªç†ç”±å°±ä¸æˆç«‹äº†ï¼Œå› ä¸ºOptionalå¯¹è±¡å¤šåªåŒ…å«ä¸€ä¸ªå€¼ã€‚ ä¸æ¨èå¤§å®¶ä½¿ç”¨åŸºç¡€ç±»å‹çš„Optionalå¯¹è±¡ï¼Œå› ä¸ºåŸºç¡€ç±»å‹çš„Optionalä¸æ”¯æŒmapã€flatMapå’Œfilterç­‰æ–¹æ³•ã€‚è€Œè¿™äº›å´æ˜¯Optionalç±»æœ€æœ‰ç”¨çš„æ–¹æ³•ã€‚","link":"/2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(2)/"},{"title":"â€œç…®ç†Ÿçš„é¸­å­ä¹Ÿä¼šé£ï¼Ÿâ€- ä½¿ç”¨ç­–ç•¥æ¨¡å¼è®©ä½ çš„â€œé¸­å­â€é£èµ·æ¥","text":"æ¨¡æ‹Ÿé¸­å­çš„é—®é¢˜é—®é¢˜æè¿°ï¼šç”¨ä»£ç æ¨¡æ‹Ÿç°å®ä¸­çš„é¸­å­ï¼Œé¸­å­æœ‰å¾ˆå¤šç§ç±»ï¼Œä¼šå‘å‡ºå„ç§å«å£°ï¼Œæœ‰çš„ä¼šæ¸¸æ³³ã€‚ ä¼ ç»Ÿè®¾è®¡æ–¹æ¡ˆä¼ ç»Ÿæ–¹æ¡ˆï¼šä½¿ç”¨æ ‡å‡†çš„é¢å‘å¯¹è±¡è®¾è®¡ã€‚è®¾è®¡ä¸€ä¸ªDuckè¶…ç±»ï¼Œè®©ä¸åŒç§ç±»çš„é¸­å­ç»§æ‰¿è¯¥è¶…ç±»ã€‚ ä¼ ç»Ÿæ–¹æ¡ˆçš„ç±»å›¾è®¾è®¡å¦‚ä¸‹ï¼š ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š Duckè¶…ç±»ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940package cn.org.lilu.strategy.traditional;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/15 * @Description: ä¼ ç»Ÿé¸­å­é—®é¢˜ * * 1. å…¶å®ƒé¸­å­éƒ½ç»§æ‰¿äº†Duckç±»ï¼Œæ‰€ä»¥flyæ–¹æ³•è®©æ‰€æœ‰çš„å­ç±»é¸­å­éƒ½ä¼šé£ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰é¸­å­éƒ½ä¼šé£ã€‚ * 2. å®é™…ä¸Šè¿™æ˜¯ç»§æ‰¿å¸¦æ¥çš„é—®é¢˜ï¼Œå¯¹çˆ¶ç±»çš„å±€éƒ¨æ”¹åŠ¨ï¼Œä¼šå½±å“æ‰€æœ‰å­ç±»ã€‚ç§°ä¸ºæº¢å‡ºæ•ˆåº”ã€‚ * 3. ä¸ºäº†è§£å†³ç»§æ‰¿å¸¦æ¥çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å­ç±»ä¸­é‡å†™å¯¹åº”çš„æ–¹æ³•æ¥è§£å†³ã€‚ * 4. ä½†æ˜¯å¦‚æœæœ‰ä¸€ä¸ªç©å…·é¸­ç±»ï¼Œå®ƒéœ€è¦é‡å†™çˆ¶ç±»æ‰€æœ‰çš„æ–¹æ³•ï¼Œè¿™æ ·åšçš„ä»£ä»·æœ‰ç‚¹å¤§ã€‚ */public abstract class Duck { /** * æ˜¾ç¤ºé¸­å­ä¿¡æ¯çš„æ–¹æ³• */ public abstract void display(); /** * é¸­å­å«çš„æ–¹æ³• */ public void quack() { System.out.println(&quot;é¸­å­å˜å˜å«&quot;); } /** * é¸­å­æ¸¸æ³³çš„æ–¹æ³• */ public void swim() { System.out.println(&quot;é¸­å­ä¼šæ¸¸æ³³&quot;); } /** * é¸­å­é£ç¿”çš„æ–¹æ³• */ public void fly() { System.out.println(&quot;é¸­å­ä¼šé£ç¿”&quot;); }} é‡é¸­WildDuckç±»ï¼š 12345678910111213package cn.org.lilu.strategy.traditional;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/15 * @Description: é‡é¸­ï¼šå˜å˜å«ã€ä¼šæ¸¸æ³³å’Œé£ç¿” */public class WildDuck extends Duck { @Override public void display() { System.out.println(&quot;è¿™æ˜¯ä¸€åªé‡é¸­&quot;); }} åŒ—äº¬é¸­PekingDuckç±»ï¼š 123456789101112131415161718package cn.org.lilu.strategy.traditional;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/15 * @Description: åŒ—äº¬é¸­ï¼šä¸ä¼šé£ç¿” */public class PekingDuck extends Duck { @Override public void display() { System.out.println(&quot;è¿™æ˜¯ä¸€åªåŒ—äº¬é¸­&quot;); } @Override public void fly() { System.out.println(&quot;åŒ—äº¬é¸­ä¸ä¼šé£ç¿”&quot;); }} ç©å…·é¸­ToyDuckç±»ï¼š 12345678910111213141516171819202122232425262728package cn.org.lilu.strategy.traditional;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/15 * @Description: ç©å…·é¸­ï¼šä¸ä¼šå˜å˜å«ã€ä¸ä¼šæ¸¸æ³³å’Œé£ç¿”ã€‚ */public class ToyDuck extends Duck { @Override public void display() { System.out.println(&quot;è¿™æ˜¯ä¸€åªç©å…·é¸­&quot;); } @Override public void quack() { System.out.println(&quot;ç©å…·é¸­ä¸èƒ½å«&quot;); } @Override public void swim() { System.out.println(&quot;ç©å…·é¸­ä¸ä¼šæ¸¸æ³³&quot;); } @Override public void fly() { System.out.println(&quot;ç©å…·é¸­ä¸ä¼šé£ç¿”&quot;); }} è¶…ç±»Duckä¸­å®šä¹‰äº†3ä¸ªå®ç°æ–¹æ³•ï¼Œä¸€ä¸ªæŠ½è±¡æ–¹æ³•ã€‚ å­ç±»é‡é¸­WildDuckç±»ä¼šâ€œå˜å˜å«â€ã€â€œæ¸¸æ³³â€å’Œâ€œé£ç¿”â€ã€‚æ‰€ä»¥é‡é¸­ç±»åªéœ€å®ç°æŠ½è±¡æ–¹æ³•displayå³å¯ã€‚ å­ç±»åŒ—äº¬é¸­PekingDuckç±»ä¸ä¼šé£ç¿”ï¼Œé™¤äº†å®ç°æŠ½è±¡æ–¹æ³•ä¹‹å¤–è¿˜éœ€é‡å†™çˆ¶ç±»çš„flyæ–¹æ³•ã€‚ å­ç±»ç©å…·é¸­ToyDuckç±»ä¸ä¼šå«ã€ä¸ä¼šæ¸¸æ³³ä¹Ÿä¸ä¼šé£ç¿”ã€‚æ‰€ä»¥ç©å…·é¸­ç±»é™¤äº†å®ç°æŠ½è±¡æ–¹æ³•ï¼Œè¿˜è¦é‡å†™çˆ¶ç±»çš„ä¸‰ä¸ªæ–¹æ³•ã€‚ è¿™ç§ç»§æ‰¿çš„è®¾è®¡æ€è·¯ä¼¼ä¹æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ä½†äº‹å®ä¸Šå­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•çš„ä»£ä»·æ˜¯å¾ˆé«˜çš„ï¼Œä¸€æ—¦å‡ºç°ä¸€ä¸ªæ–°å“ç§çš„é¸­å­ï¼Œå°±è¦å»ç»§æ‰¿Duckç±»ï¼Œå­ç±»é»˜è®¤å°±æœ‰äº†çˆ¶ç±»å®šä¹‰å¥½çš„è¡Œä¸ºï¼Œä¾‹å¦‚â€œå˜å˜å«â€ã€â€œæ¸¸æ³³â€å’Œâ€œé£ç¿”â€ã€‚å¦‚æœå­ç±»ä¸æ»¡è¶³è¿™äº›è¡Œä¸ºå°±è¦å»é‡å†™çˆ¶ç±»ä¸­å¯¹åº”çš„æ–¹æ³•ã€‚åŒæ—¶ï¼Œä¸€æ—¦å¯¹çˆ¶ç±»è¿›è¡ŒæŸäº›å±€éƒ¨æ”¹åŠ¨ï¼Œæ‰€æœ‰å­ç±»éƒ½ä¼šå—åˆ°å½±å“ã€‚ æˆ‘ä»¬çŸ¥é“Duckç±»å†…çš„fly()å’Œquack()ä¼šéšç€é¸­å­çš„ä¸åŒè€Œæ”¹å˜ã€‚äº‹å®ä¸Šæ¯æ¬¡ç»§æ‰¿éƒ½æ˜¯åœ¨æ”¹åŠ¨è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ ä¸å¦¨ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥æ”¹é€ Duckç±»ã€‚ ç­–ç•¥æ¨¡å¼å®šä¹‰äº†ç®—æ³•æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©å®ƒä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚ ç­–ç•¥æ¨¡å¼ä¸­æœ‰ä»¥ä¸‹ä¸‰æ¡è®¾è®¡åŸåˆ™ï¼š æ‰¾å‡ºåº”ç”¨ä¸­å¯èƒ½éœ€è¦å˜åŒ–ä¹‹å¤„ï¼ŒæŠŠå®ƒä»¬ç‹¬ç«‹å‡ºæ¥ï¼Œä¸è¦å’Œé‚£äº›ä¸éœ€è¦å˜åŒ–çš„ä»£ç æ··åœ¨ä¸€èµ·ã€‚ é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®ç°ç¼–ç¨‹ã€‚ å¤šç”¨ç»„åˆï¼Œå°‘ç”¨ç»§æ‰¿ã€‚ åˆ†ç¦»è¡Œä¸º â€” è®©â€œç…®ç†Ÿçš„é¸­å­â€é£èµ·æ¥æ˜¯æ—¶å€™å°†è¡Œä¸ºä»Duckç±»ä¸­åˆ†ç¦»å‡ºæ¥äº†ã€‚å°†é¸­å­çš„è¡Œä¸ºå°è£…åˆ°æ–°çš„ç±»ä¸­ï¼Œè¯¥ç±»ä¸“é—¨æä¾›æŸè¡Œä¸ºçš„å®ç°ã€‚è¿™æ ·ï¼ŒDuckç±»å°±ä¸å†éœ€è¦çŸ¥é“è¡Œä¸ºçš„å…·ä½“å®ç°ã€‚ é‚£ä¹ˆå¦‚ä½•è®¾è®¡å®ç°â€œé£ç¿”â€å’Œâ€œå˜å˜å«â€çš„è¡Œä¸ºçš„ç±»å‘¢ï¼Ÿæˆ‘ä»¬å¸Œæœ›â€œç…®ç†Ÿçš„é¸­å­é£èµ·æ¥â€ï¼Œé¸­å­éœ€è¦ç»å†ä»ç”Ÿåˆ°ç†Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯åœ¨Duckç±»ä¸­å¢åŠ è®¾å®šè¡Œä¸ºçš„æ–¹æ³•ï¼Œè¿™æ ·å°±èƒ½åœ¨â€œè¿è¡Œæ—¶æœŸâ€åŠ¨æ€æ”¹å˜é¸­å­çš„è¡Œä¸ºã€‚ ä½¿ç”¨äº†ç­–ç•¥æ¨¡å¼çš„ç±»å›¾è®¾è®¡å¦‚ä¸‹ï¼š ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š â€œé£ç¿”â€è¡Œä¸ºæ¥å£FlyBehaviorï¼š 12345678910111213package cn.org.lilu.strategy;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: é£ç¿”è¡Œä¸ºæ¥å£ */public interface FlyBehavior { /** * é£ç¿”çš„æ–¹æ³• */ void fly();} éšé£é£ç¿”çš„è¡Œä¸ºFlyWithWingsï¼š 123456789101112131415package cn.org.lilu.strategy.impl;import cn.org.lilu.strategy.FlyBehavior;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: å¯ä»¥é£çš„è¡Œä¸º */public class FlyWithWings implements FlyBehavior { @Override public void fly() { System.out.println(&quot;fly with wings&quot;); }} ä¸èƒ½é£çš„è¡Œä¸ºFlyNoWayï¼š 123456789101112131415package cn.org.lilu.strategy.impl;import cn.org.lilu.strategy.FlyBehavior;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: ä¸èƒ½é£çš„è¡Œä¸º */public class FlyNoWay implements FlyBehavior { @Override public void fly() { System.out.println(&quot;can't fly&quot;); }} åˆ©ç”¨ç«ç®­åŠ¨åŠ›é£ç¿”çš„è¡Œä¸ºFlyRocketPoweredï¼š 123456789101112131415package cn.org.lilu.strategy.impl;import cn.org.lilu.strategy.FlyBehavior;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: åˆ©ç”¨ç«ç®­åŠ¨åŠ›çš„é£ç¿”è¡Œä¸º */public class FlyRocketPowered implements FlyBehavior { @Override public void fly() { System.out.println(&quot;fly with rocket&quot;); }} â€œå«â€çš„è¡Œä¸ºæ¥å£QuackBehaviorï¼š 12345678910111213package cn.org.lilu.strategy;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: é¸­å­å«è¡Œä¸ºæ¥å£ */public interface QuackBehavior { /** * é¸­å­å«çš„æ–¹æ³• */ void quack();} å˜å˜å«çš„è¡Œä¸ºQuackï¼š 123456789101112131415package cn.org.lilu.strategy.impl;import cn.org.lilu.strategy.QuackBehavior;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: å˜å˜å«çš„è¡Œä¸º */public class Quack implements QuackBehavior { @Override public void quack() { System.out.println(&quot;Quack å˜å˜å«&quot;); }} å±å±å«çš„è¡Œä¸ºSqueakï¼š 123456789101112131415package cn.org.lilu.strategy.impl;import cn.org.lilu.strategy.QuackBehavior;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: å±å±å«çš„è¡Œä¸º */public class Squeak implements QuackBehavior { @Override public void quack() { System.out.println(&quot;Squeak å±å±å«&quot;); }} ä¸ä¼šå«çš„è¡Œä¸ºMuteQuackï¼š 123456789101112131415package cn.org.lilu.strategy.impl;import cn.org.lilu.strategy.QuackBehavior;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: ä¸ä¼šå«çš„è¡Œä¸º */public class MuteQuack implements QuackBehavior { @Override public void quack() { System.out.println(&quot;Silence ä¸ä¼šå«&quot;); }} åˆ†ç¦»è¡Œä¸ºåçš„Duckç±»ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465package cn.org.lilu.strategy;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„é¸­å­ç±» */public abstract class Duck { /** * é£ç¿”çš„è¡Œä¸º */ FlyBehavior flyBehavior; /** * å«çš„è¡Œä¸º */ QuackBehavior quackBehavior; /** * è®¾ç½®é£è¡Œè¡Œä¸º * @param flyBehavior é£è¡Œè¡Œä¸º */ public void setFlyBehavior(FlyBehavior flyBehavior) { this.flyBehavior = flyBehavior; } /** * è®¾ç½®å«çš„è¡Œä¸º * @param quackBehavior å«è¡Œä¸º */ public void setQuackBehavior(QuackBehavior quackBehavior) { this.quackBehavior = quackBehavior; } /** * ä½¿é¸­å­é£ */ public void performFly() { if (flyBehavior != null) { flyBehavior.fly(); } } /** * ä½¿é¸­å­å« */ public void performQuack() { if (quackBehavior != null) { quackBehavior.quack(); } } /** * é¸­å­æ¸¸æ³³çš„æ–¹æ³• */ public void swim() { System.out.println(&quot;é¸­å­ä¼šæ¸¸æ³³&quot;); } /** * æ˜¾ç¤ºé¸­å­ä¿¡æ¯çš„æ–¹æ³• */ public abstract void display();} é‡é¸­WildDuckç±»ï¼š 123456789101112131415161718192021222324package cn.org.lilu.strategy;import cn.org.lilu.strategy.impl.FlyWithWings;import cn.org.lilu.strategy.impl.Quack;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/15 * @Description: é‡é¸­ï¼šå…·æœ‰å¯ä»¥é£çš„è¡Œä¸ºå’Œå˜å˜å«çš„è¡Œä¸ºã€‚ */public class WildDuck extends Duck { public WildDuck() { // éšé£é£ç¿”è¡Œä¸º flyBehavior = new FlyWithWings(); // å˜å˜å«è¡Œä¸º quackBehavior = new Quack(); } @Override public void display() { System.out.println(&quot;è¿™æ˜¯ä¸€åªä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„é‡é¸­&quot;); }} åŒ—äº¬é¸­PekingDuckç±»ï¼š 123456789101112131415161718192021222324package cn.org.lilu.strategy;import cn.org.lilu.strategy.impl.FlyNoWay;import cn.org.lilu.strategy.impl.Squeak;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/15 * @Description: åŒ—äº¬é¸­ï¼šä¸èƒ½é£ç¿”ï¼Œå±å±å« */public class PekingDuck extends Duck { public PekingDuck() { // ä¸èƒ½é£çš„è¡Œä¸º flyBehavior = new FlyNoWay(); // å±å±å«çš„è¡Œä¸º quackBehavior = new Squeak(); } @Override public void display() { System.out.println(&quot;è¿™æ˜¯ä¸€åªä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„åŒ—äº¬é¸­&quot;); }} ç©å…·é¸­ToyDuckç±»ï¼š 123456789101112131415161718192021222324package cn.org.lilu.strategy;import cn.org.lilu.strategy.impl.FlyNoWay;import cn.org.lilu.strategy.impl.MuteQuack;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/15 * @Description: ç©å…·é¸­ï¼šä¸ä¼šé£ä¹Ÿä¸ä¼šå« */public class ToyDuck extends Duck { public ToyDuck() { // ä¸ä¼šé£çš„è¡Œä¸º flyBehavior = new FlyNoWay(); // ä¸ä¼šå«çš„è¡Œä¸º quackBehavior = new MuteQuack(); } @Override public void display() { System.out.println(&quot;è¿™æ˜¯ä¸€åªä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„ç©å…·é¸­&quot;); }} ä¸€åˆ‡éƒ½å‡†å¤‡å°±ç»ªï¼è®©æˆ‘ä»¬æ¥è§è¯â€œç…®ç†Ÿçš„é¸­å­â€çš„é£ç¿”å§ï¼ 1234567891011121314151617181920212223242526package cn.org.lilu.strategy;import cn.org.lilu.strategy.impl.FlyRocketPowered;/** * @Auther: Javaæˆé­”ä¹‹è·¯ * @Date: 2019/9/12 * @Description: for test */public class TestStrategy { public static void main(String[] args) { // ç”Ÿäº§ä¸€åªåŒ—äº¬é¸­ Duck duck = new PekingDuck(); // è®©é¸­å­é£ duck.performFly(); // è®©é¸­å­å« duck.performQuack(); // ç”Ÿäº§ä¸€åªç©å…·é¸­ Duck toyDuck = new ToyDuck(); // è®©é¸­å­é£ï¼šå‘ç°ä¸èƒ½é£ toyDuck.performFly(); // åŠ¨æ€æ”¹å˜è¡Œä¸ºï¼šè®©â€œç…®ç†Ÿçš„é¸­å­â€é£èµ·æ¥ toyDuck.setFlyBehavior(new FlyRocketPowered()); toyDuck.performFly(); }} ç»“æœï¼š 1234can't flySqueak å±å±å«can't flyfly with rocket ä¸ç®¡æ€æ ·ï¼Œæˆ‘ä»¬çš„ç©å…·é¸­é£èµ·æ¥äº†ï¼Œè¿™é‡Œç©å…·é¸­å’Œâ€œç…®ç†Ÿçš„é¸­å­â€æ€§è´¨ä¸Šæ˜¯ä¸€æ ·çš„ã€‚ ç°åœ¨æˆ‘ä»¬çš„Duckç±»ä¸å†æ‹…å¿ƒå‡ºç°æ–°çš„é¸­å­ç§ç±»äº†ã€‚ä¸€æ—¦æœ‰ä¸€ä¸ªä¸åŒè¡Œä¸ºçš„æ–°ç§ç±»é¸­ï¼Œåªéœ€è¦å†™ä¸€ä¸ªæ–°çš„è¡Œä¸ºæ¥å£çš„å®ç°ã€‚è€Œä¸éœ€è¦å¯¹Duckç±»è¿›è¡Œä¿®æ”¹ã€‚è¿™ä½“ç°äº†â€œå¯¹ä¿®æ”¹å…³é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾â€åŸåˆ™ï¼Œå®¢æˆ·ç«¯å¢åŠ è¡Œä¸ºä¸ç”¨ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œåªè¦æ·»åŠ ä¸€ç§ç­–ç•¥å³å¯ï¼Œé¿å…äº†ä½¿ç”¨å¤šé‡è½¬ç§»è¯­å¥(if-elseâ€¦if-else)ã€‚åŒæ—¶ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹ä¹Ÿç”±æ­¤æš´éœ²ï¼Œæ¯æ·»åŠ ä¸€ä¸ªç­–ç•¥å°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ç±»ï¼Œå½“ç­–ç•¥è¿‡å¤šæ—¶ï¼Œç±»çš„æ•°é‡ä¼šéšä¹‹è¿‡å¤šã€‚ä½†è¿™è‡³å°‘æ¯”ä½¿ç”¨ç»§æ‰¿æ—¶é‡å†™çˆ¶ç±»æ–¹æ³•è¦å¥½çš„å¤šã€‚","link":"/2019/12/12/design-patterns/gof/behavior/strategy/"},{"title":"åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶ä¹‹ShardingSphere-å…¥é—¨æ¡ˆä¾‹","text":"ShardingSphereçš„å‰å°˜å¾€äº‹ShardingSphereçš„å‰èº«æ˜¯Sharding-JDBCï¼Œèµ·æºäºå½“å½“ç½‘å†…éƒ¨åº”ç”¨æ¡†æ¶ï¼Œäº2016å¹´åˆå¼€æºã€‚ 2017å¹´ï¼ŒSharding-JDBCè¿›å…¥2.xé˜¶æ®µï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯æ•°æ®åº“æ²»ç†ã€‚ 2018å¹´æ˜¥èŠ‚å‰å¤•ï¼ŒSharding-JDBCå›¢é˜Ÿäºäº¬ä¸œæ•°ç§‘é‡æ–°ç»„å»ºï¼Œå¹¶å°†å…¶å®šä½ä¸ºé¢å‘äº‘åŸç”Ÿçš„æ•°æ®åº“ä¸­é—´ä»¶ï¼Œæ­£å¼æ›´åä¸ºShardingSphereã€‚Sharding-JDBCè¿›å…¥äº†3.xæ—¶ä»£ï¼ŒåŠŸèƒ½é‡å¿ƒè½¬å‘äº†Sharding-proxyåŠåˆ†å¸ƒå¼äº‹åŠ¡ä¸Šã€‚ ç¾å›½æ—¶é—´2018å¹´11æœˆ10æ—¥ï¼Œåˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶ç”Ÿæ€åœˆ ShardingSphereæ­£å¼è¿›å…¥ApacheåŸºé‡‘ä¼šå­µåŒ–å™¨ã€‚ é¢„ç¥ShardingSphereé¡¹ç›®æ—©æ—¥æˆåŠŸæ¯•ä¸šã€‚ Apache ShardingSphereç®€ä»‹Apache ShardingSphere (Incubator) æ˜¯ä¸€å¥—å¼€æºçš„åˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆç»„æˆçš„ç”Ÿæ€åœˆï¼Œå®ƒç”±Sharding-JDBCã€Sharding-Proxyå’ŒSharding-Sidecarï¼ˆè§„åˆ’ä¸­ï¼‰è¿™3æ¬¾ç›¸äº’ç‹¬ç«‹ï¼Œå´åˆèƒ½å¤Ÿæ··åˆéƒ¨ç½²é…åˆä½¿ç”¨çš„äº§å“ç»„æˆã€‚å®ƒä»¬å‡æä¾›æ ‡å‡†åŒ–çš„æ•°æ®åˆ†ç‰‡ã€åˆ†å¸ƒå¼äº‹åŠ¡å’Œæ•°æ®åº“æ²»ç†åŠŸèƒ½ï¼Œå¯é€‚ç”¨äºå¦‚JavaåŒæ„ã€å¼‚æ„è¯­è¨€ã€äº‘åŸç”Ÿç­‰å„ç§å¤šæ ·åŒ–çš„åº”ç”¨åœºæ™¯ã€‚ Apacheå®˜æ–¹å‘å¸ƒä»4.0.0ç‰ˆæœ¬å¼€å§‹ã€‚ Apache ShardingSphereå®˜æ–¹æ–‡æ¡£ Sharding-JDBCç®€ä»‹å®šä½ä¸ºè½»é‡çº§Javaæ¡†æ¶ï¼Œåœ¨Javaçš„JDBCå±‚æä¾›çš„é¢å¤–æœåŠ¡ã€‚ å®ƒä½¿ç”¨å®¢æˆ·ç«¯ç›´è¿æ•°æ®åº“ï¼Œä»¥jaråŒ…å½¢å¼æä¾›æœåŠ¡ï¼Œæ— éœ€é¢å¤–éƒ¨ç½²å’Œä¾èµ–ï¼Œå¯ç†è§£ä¸ºå¢å¼ºç‰ˆçš„JDBCé©±åŠ¨ï¼Œå®Œå…¨å…¼å®¹JDBCå’Œå„ç§ORMæ¡†æ¶ã€‚ Sharding-JDBCå¿«é€Ÿå…¥é—¨æˆ‘ä»¬ä»¥ä¸€åº“ä¸¤è¡¨çš„æ¡ˆä¾‹æ¥å¿«é€Ÿå…¥é—¨ã€‚ å»ºç«‹æ•°æ®è¡¨è¿™é‡Œæˆ‘ä»¬ä»¥ç®€å•çš„è®¢å•è¡¨ä¸ºä¾‹ï¼Œä½œä¸ºå…¥é—¨å­¦ä¹ ä½¿ç”¨ã€‚ é¦–å…ˆå»ºç«‹ä¸€åº“ä¸¤è¡¨çš„æ•°æ®åº“ç»“æ„ã€‚æ•°æ®åº“åä¸ºsharding_jdbc_dbï¼Œå»ºç«‹t_order_1å’Œt_order_2ä¸¤å¼ è¡¨ã€‚ å»ºè¡¨sqlè¯­å¥å¦‚ä¸‹ï¼š 123456789101112131415161718-- åˆ†è¡¨ç»“æ„DROP TABLE IF EXISTS t_order_1;DROP TABLE IF EXISTS t_order_2;CREATE TABLE `sharding_jdbc_db`.`t_order_1` ( `order_id` varchar(32) NOT NULL COMMENT 'ä¸»é”®ï¼šè®¢å•id', `price` decimal(10, 2) NOT NULL COMMENT 'è®¢å•é‡‘é¢', `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·id', `status` varchar(16) NOT NULL COMMENT 'è®¢å•çŠ¶æ€', PRIMARY KEY (`order_id`)) ENGINE = InnoDB CHARACTER SET = utf8;CREATE TABLE `sharding_jdbc_db`.`t_order_2` ( `order_id` varchar(32) NOT NULL COMMENT 'ä¸»é”®ï¼šè®¢å•id', `price` decimal(10, 2) NOT NULL COMMENT 'è®¢å•é‡‘é¢', `user_id` varchar(32) NOT NULL COMMENT 'ç”¨æˆ·id', `status` varchar(16) NOT NULL COMMENT 'è®¢å•çŠ¶æ€', PRIMARY KEY (`order_id`)) ENGINE = InnoDB CHARACTER SET = utf8; åˆ›å»ºsharding-jdbc-simpleé¡¹ç›®ä½¿ç”¨IDEAåˆ›å»ºä¸€ä¸ªmavençš„ç©ºæ¨¡æ¿é¡¹ç›®ï¼Œé¡¹ç›®åä¸ºsharding-jdbc-simpleã€‚ åœ¨pom.xmlæ–‡ä»¶ä¸­éœ€æ·»åŠ çš„sharding-jdbc-spring-boot-starterä¾èµ–å¦‚ä¸‹ï¼š 123456&lt;!-- apache sharding-jdbc --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt; &lt;artifactId&gt;sharding-jdbc-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;4.0.0-RC1&lt;/version&gt;&lt;/dependency&gt; ç”±äºæˆ‘çš„é¡¹ç›®ä½¿ç”¨äº†è‡ªå·±å®šä¹‰çš„ç»Ÿä¸€ä¾èµ–ç®¡ç†ï¼Œæ‰€ä»¥æ²¡æœ‰æŒ‡å®šå„ä¸ªjaråŒ…çš„ç‰ˆæœ¬å·ã€‚ è¯»è€…å¯ä»¥å‚è€ƒ sunchaser-boot-dependencies è¿›è¡Œå®ç°ï¼Œæˆ–è€…å•ç‹¬æŒ‡å®šå¯¹åº”ç‰ˆæœ¬å·ã€‚ å®Œæ•´çš„pom.xmlå†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;parent&gt; &lt;artifactId&gt;ä¸­é—´ä»¶&lt;/artifactId&gt; &lt;groupId&gt;com.sunchaser&lt;/groupId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;sharding-jdbc-simple&lt;/artifactId&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.sunchaser.boot&lt;/groupId&gt; &lt;artifactId&gt;sunchaser-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;dependencies&gt; &lt;!-- sharding-jdbcä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt; &lt;artifactId&gt;sharding-jdbc-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- testä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- webä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- mybatisä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- druidè¿æ¥æ±  --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- mysqlé©±åŠ¨ --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- lombok --&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; ç¼–å†™é…ç½®æ–‡ä»¶springbooté¡¹ç›®å¯ä½¿ç”¨propertiesé…ç½®æˆ–yamlé…ç½®ã€‚äºŒé€‰ä¸€å³å¯ã€‚ åŸºæœ¬é…ç½®é…ç½®tomcatç«¯å£å·ã€åº”ç”¨åå’Œå…è®¸é‡å¤å®šä¹‰çš„beanè¿›è¡Œè¦†ç›–ã€‚ propertiesé…ç½®ï¼š 1234server.port=520spring.application.name=sharding-jdbc-simple-demo# é‡å¤çš„beanå®šä¹‰è¿›è¡Œè¦†ç›–spring.main.allow-bean-definition-overriding=true yamlé…ç½®ï¼š 12345678server: port: 520spring: application: name: sharding-jdbc-simple-demo main: # é‡å¤çš„beanä¼šè¿›è¡Œè¦†ç›– allow-bean-definition-overriding: true é…ç½®mybatisä¸»è¦é…ç½®xmlæ–‡ä»¶æ˜ å°„è·¯å¾„å’Œä¸‹åˆ’çº¿è‡ªåŠ¨è½¬é©¼å³°ã€‚ propertiesé…ç½®ï¼š 123456789########################################################################## mybatisé…ç½®########################################################################### xmlæ˜ å°„æ–‡ä»¶è·¯å¾„mybatis.mapper-locations=classpath:mapper/**/*.xml# ä¸‹åˆ’çº¿è‡ªåŠ¨è½¬é©¼å³°mybatis.configuration.map-underscore-to-camel-case=true yamlé…ç½®ï¼š 123456mybatis: # xmlæ˜ å°„æ–‡ä»¶è·¯å¾„ mapper-locations: classpath:mapper/**/*.xml configuration: # è‡ªåŠ¨è½¬é©¼å³° map-underscore-to-camel-case: true é…ç½®æ•°æ®æºæ­¤å…¥é—¨æ¡ˆä¾‹æ˜¯ä¸€åº“ä¸¤è¡¨ï¼Œåªæœ‰ä¸€ä¸ªæ•°æ®æºéœ€è¦é…ç½®ã€‚ propertiesé…ç½®ï¼š 12345678910111213########################################################################## æ•°æ®æºé…ç½®########################################################################### æ•°æ®æºåç§°ï¼Œå¤šæ•°æ®æºä»¥é€—å·åˆ†éš”spring.shardingsphere.datasource.names=ds1# æ•°æ®æºds1è¯¦æƒ…é…ç½®spring.shardingsphere.datasource.ds1.type=com.alibaba.druid.pool.DruidDataSourcespring.shardingsphere.datasource.ds1.driver-class-name=com.mysql.cj.jdbc.Driverspring.shardingsphere.datasource.ds1.url=jdbc:mysql://127.0.0.1:3306/sharding_jdbc_db?useUnicode=true&amp;serverTimezone=Asia/Shanghaispring.shardingsphere.datasource.ds1.username=rootspring.shardingsphere.datasource.ds1.password=ll970722 yamlé…ç½®ï¼š 12345678910111213spring: # æ•°æ®æºé…ç½® shardingsphere: datasource: # æ•°æ®æºåç§°ï¼Œå¤šæ•°æ®æºä»¥é€—å·åˆ†éš” names: ds1 # æ•°æ®æºds1è¯¦æƒ…é…ç½® ds1: type: com.alibaba.druid.pool.DruidDataSource driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/sharding_jdbc_db?useUnicode=true&amp;serverTimezone=Asia/Shanghai username: root password: ll970722 é…ç½®åˆ†ç‰‡è§„åˆ™ä½¿ç”¨é»˜è®¤çš„inlineè¡¨è¾¾å¼é…ç½®åˆ†ç‰‡ç­–ç•¥ï¼Œåˆ†ç‰‡ç­–ç•¥åŒ…å«åˆ†ç‰‡é”®å’Œåˆ†ç‰‡ç®—æ³•ï¼Œéœ€ç¬¦åˆgroovyè¯­æ³•ã€‚ propertiesé…ç½®ï¼š 1234567891011121314# åˆ†ç‰‡è§„åˆ™é…ç½®# çœŸå®æ•°æ®èŠ‚ç‚¹ï¼Œç”±æ•°æ®æºå + è¡¨åç»„æˆï¼Œä»¥å°æ•°ç‚¹åˆ†éš”spring.shardingsphere.sharding.tables.t_order.actual-data-nodes=ds1.t_order_$-&gt;{1..2}# ä¸»é”®åˆ—åç§°ï¼Œç¼ºçœè¡¨ç¤ºä¸ä½¿ç”¨è‡ªå¢ä¸»é”®ç”Ÿæˆå™¨spring.shardingsphere.sharding.tables.t_order.key-generator.column=order_id# è‡ªå¢åˆ—å€¼ç”Ÿæˆå™¨ç±»å‹ï¼Œç¼ºçœè¡¨ç¤ºä½¿ç”¨é»˜è®¤è‡ªå¢åˆ—å€¼ç”Ÿæˆå™¨ã€‚# å¯ä½¿ç”¨è‡ªå®šä¹‰çš„åˆ—å€¼ç”Ÿæˆå™¨æˆ–é€‰æ‹©å†…ç½®ç±»å‹ï¼šSNOWFLAKE/UUID/LEAF_SEGMENT# è¿™é‡Œä½¿ç”¨SNOWFLAKEé›ªèŠ±ç®—æ³•spring.shardingsphere.sharding.tables.t_order.key-generator.type=SNOWFLAKE# åˆ†ç‰‡ç­–ç•¥ï¼ˆåˆ†ç‰‡é”®å’Œåˆ†ç‰‡ç®—æ³•ï¼‰# åˆ†ç‰‡é”®spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.sharding-column=order_id# åˆ†ç‰‡ç®—æ³• ç”Ÿæˆçš„IDä¸ºå¥‡æ•°ï¼Œæ’å…¥åˆ°t_order_2ä¸­ï¼Œå¶æ•°åˆ™æ’å…¥åˆ°t_order_1ä¸­spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.algorithm-expression=t_order_$-&gt;{order_id % 2 + 1} yamlé…ç½®ï¼š 12345678910111213141516171819spring: shardingsphere: # sharding-jdbcåˆ†ç‰‡è§„åˆ™é…ç½® sharding: tables: t_order: # æ•°æ®èŠ‚ç‚¹ actual-data-nodes: ds1.t_order_$-&gt;{1..2} # ä¸»é”®åˆ—å’Œä¸»é”®ç”Ÿæˆç­–ç•¥ï¼šé›ªèŠ±ç®—æ³• key-generator: column: order_id type: SNOWFLAKE # åˆ†ç‰‡ç­–ç•¥ table-strategy: inline: # åˆ†ç‰‡é”® sharding-column: order_id # åˆ†ç‰‡ç®—æ³•ï¼šç”Ÿæˆçš„IDä¸ºå¥‡æ•°ï¼Œæ’å…¥åˆ°t_order_2ä¸­ï¼Œå¶æ•°åˆ™æ’å…¥åˆ°t_order_1ä¸­ algorithm-expression: t_order_$-&gt;{order_id % 2 + 1} é…ç½®æ—¥å¿—ç›¸å…³é…ç½®æ‰“å°æ‰§è¡Œçš„çœŸå®sqlä¸æ—¥å¿—çº§åˆ«ã€‚ propertiesé…ç½®ï¼š 1234567# æ‰“å°sharding-jdbcçš„çœŸå®æ‰§è¡Œsqlæ—¥å¿—spring.shardingsphere.props.sql.show=true# æ—¥å¿—çº§åˆ«é…ç½®logging.level.root=infologging.level.org.springframework.web=infologging.level.com.sunchaser.shardingjdbc=debuglogging.level.druid.sql=debug yamlé…ç½®ï¼š 12345678910111213141516171819spring: shardingsphere: props: sql: # æ‰“å°sharding-jdbcçš„çœŸå®æ‰§è¡Œsqlæ—¥å¿— show: true # æ—¥å¿—çº§åˆ«logging: level: root: info org: springframework: web: info com: sunchaser: shardingjdbc: debug druid: sql: debug è‡³æ­¤ï¼Œé…ç½®éƒ¨åˆ†å®Œæˆï¼Œå¼€å§‹ç¼–å†™åç«¯ä»£ç ã€‚ åç«¯æµ‹è¯•ä»£ç ç¼–å†™é¡¹ç›®åŒ…ç»“æ„å¦‚ä¸‹ï¼š 1234567891011121314151617â””â”€src â”œâ”€main â”‚ â”œâ”€java â”‚ â”‚ â””â”€com â”‚ â”‚ â””â”€sunchaser â”‚ â”‚ â””â”€shardingjdbc ------ å­˜æ”¾å¯åŠ¨ç±» â”‚ â”‚ â”œâ”€entity -------- å­˜æ”¾å®ä½“ç±» â”‚ â”‚ â””â”€mapper -------- å­˜æ”¾mapperæ¥å£ â”‚ â””â”€resources â”‚ â”œâ”€db ----------------------- å­˜æ”¾å»ºè¡¨è¯­å¥ â”‚ â””â”€mapper ------------------- å­˜æ”¾xmlæ˜ å°„æ–‡ä»¶ â””â”€test â””â”€java â””â”€com â””â”€sunchaser â””â”€shardingjdbc â””â”€mapper ------ å­˜æ”¾å•å…ƒæµ‹è¯•ç±» å…¥é—¨æ¡ˆä¾‹ä¸»è¦æ˜¯ä½¿ç”¨Sharding-JDBCè¿›è¡Œæ–°å¢å’ŒæŸ¥è¯¢ï¼Œmybatisçš„mapperæ¥å£å’Œxmlæ˜ å°„æ–‡ä»¶ç¼–å†™æ–¹å¼ä¿æŒä¸å˜ã€‚ ç¼–å†™å¯åŠ¨ç±»1234567891011121314151617181920package com.sunchaser.shardingjdbc;import org.springframework.boot.WebApplicationType;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.boot.builder.SpringApplicationBuilder;/** * @author sunchaser * @date 2019/11/26 * @description * @since 1.0 */@SpringBootApplicationpublic class ShardingJdbcSimpleApplication { public static void main(String[] args) { new SpringApplicationBuilder(ShardingJdbcSimpleApplication.class) .web(WebApplicationType.SERVLET) .run(args); }} ç¼–å†™è®¢å•å®ä½“ç±»ä½¿ç”¨lombokå·¥å…·åŒ…çš„@Dataå’Œ@Builderæ³¨è§£ç”Ÿæˆgetterã€setterå’Œå»ºé€ è€…æ¨¡å¼ä»£ç ã€‚ 12345678910111213141516171819202122232425262728293031323334353637package com.sunchaser.shardingjdbc.entity;import lombok.Builder;import lombok.Data;import java.math.BigDecimal;/** * @author sunchaser * @date 2019/11/29 * @description * @since 1.0 */@Data@Builderpublic class OrderEntity { /** * è®¢å•idï¼šé›ªèŠ±ç®—æ³•ç”Ÿæˆçš„åˆ†å¸ƒå¼å”¯ä¸€ID */ private Long orderId; /** * è®¢å•ä»·æ ¼ */ private BigDecimal price; /** * ç”¨æˆ·id */ private String userId; /** * è®¢å•çŠ¶æ€ */ private String status;} ç¼–å†™mapperæ¥å£ æ’å…¥è®¢å•ï¼ˆæ³¨è§£å®ç°ï¼‰ æ ¹æ®è®¢å•IDçš„é›†åˆæŸ¥è¯¢è®¢å•ä¿¡æ¯é›†åˆï¼ˆæ³¨è§£å®ç°ï¼‰ æ ¹æ®è®¢å•IDçš„é›†åˆæŸ¥è¯¢è®¢å•ä¿¡æ¯é›†åˆï¼ˆXMLå®ç°ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748package com.sunchaser.shardingjdbc.mapper;import com.sunchaser.shardingjdbc.entity.OrderEntity;import org.apache.ibatis.annotations.Insert;import org.apache.ibatis.annotations.Mapper;import org.apache.ibatis.annotations.Param;import org.apache.ibatis.annotations.Select;import java.util.List;/** * @author sunchaser * @date 2019/11/28 * @description * @since 1.0 */@Mapperpublic interface OrderMapper { /** * æ’å…¥ * @param orderEntity è®¢å•å®ä½“ * @return å½±å“è®°å½•è¡Œæ•° */ @Insert(&quot;insert into t_order(price,user_id,status) values(#{price},#{userId},#{status})&quot;) Integer insert(OrderEntity orderEntity); /** * æ³¨è§£å®ç° * æ ¹æ®è®¢å•idé›†åˆæŸ¥è¯¢è®¢å•é›†åˆ * @param orderIds è®¢å•IDé›†åˆ * @return è®¢å•é›†åˆ */ @Select(&quot; &lt;script&gt; &quot; + &quot; select * from t_order t where t.order_id in &quot; + &quot; &lt;foreach collection='orderIds' open='(' separator=',' close=')' item='orderId'&gt; &quot; + &quot; #{orderId} &quot; + &quot; &lt;/foreach&gt; &quot; + &quot; &lt;/script&gt; &quot;) List&lt;OrderEntity&gt; selectByAnnotation(@Param(&quot;orderIds&quot;) List&lt;Long&gt; orderIds); /** * xml å®ç° * @param orderIds * @return */ List&lt;OrderEntity&gt; selectByXml(@Param(&quot;orderIds&quot;) List&lt;Long&gt; orderIds);} OrderMapperçš„selectByXmlæ–¹æ³•å¯¹åº”çš„XMLé…ç½®å¦‚ä¸‹ï¼š 1234567891011&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.sunchaser.shardingjdbc.mapper.OrderMapper&quot;&gt; &lt;select id=&quot;selectByXml&quot; resultType=&quot;com.sunchaser.shardingjdbc.entity.OrderEntity&quot;&gt; select * from t_order where order_id in &lt;foreach collection='orderIds' item='orderId' open='(' separator=',' close=')'&gt; #{orderId} &lt;/foreach&gt; &lt;/select&gt;&lt;/mapper&gt; ç¼–å†™å•å…ƒæµ‹è¯•ä»£ç é¦–å…ˆå¾ªç¯è°ƒç”¨OrderMapperçš„insertæ–¹æ³•æ’å…¥20æ¡è®¢å•æ•°æ®ï¼Œç„¶ååˆ†åˆ«é€‰æ‹©åŒä¸€ä¸ªè®¢å•è¡¨çš„ä¸¤ä¸ªè®¢å•orderIdå’Œé€‰æ‹©ä¸åŒè®¢å•è¡¨çš„ä¸¤ä¸ªorderIdè¿›è¡ŒinæŸ¥è¯¢ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253package com.sunchaser.shardingjdbc.mapper;import com.google.common.collect.Lists;import com.sunchaser.shardingjdbc.entity.OrderEntity;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.boot.test.context.SpringBootTest;import org.springframework.test.context.junit4.SpringRunner;import javax.annotation.Resource;import java.math.BigDecimal;import java.util.List;/** * @author sunchaser * @date 2019/11/28 * @description * @since 1.0 */@SpringBootTest@RunWith(SpringRunner.class)public class OrderMapperTest { @Resource private OrderMapper orderMapper; @Test public void insert() { for (int i = 0; i &lt; 20; i++) { OrderEntity orderEntity = OrderEntity.builder() .price(new BigDecimal(&quot;1.11&quot;)) .userId(&quot;2019xxxxxxxx&quot;) .status(&quot;SUCCESS&quot;) .build(); Integer success = orderMapper.insert(orderEntity); System.out.println(success); } } @Test public void selectByAnnotation() { List&lt;Long&gt; orderIds = Lists.newArrayList(406907714078244865L,407114454203891712L); List&lt;OrderEntity&gt; orderEntities = orderMapper.selectByAnnotation(orderIds); System.out.println(orderEntities); } @Test public void selectByXml() { List&lt;Long&gt; orderIds = Lists.newArrayList(406907714078244865L,407114454203891712L); List&lt;OrderEntity&gt; orderEntities = orderMapper.selectByXml(orderIds); System.out.println(orderEntities); }} ç”±äºå‰é¢é…ç½®äº†sqlæ—¥å¿—æ‰“å°ï¼Œæˆ‘ä»¬å¯åœ¨æ§åˆ¶å°çœ‹åˆ°æ‰§è¡Œçš„é€»è¾‘SQLå’ŒçœŸå®SQLã€‚ ä»¥æŸ¥è¯¢æ–¹æ³•selectByAnnotationä¸ºä¾‹ï¼Œæ‰§è¡Œæ—¥å¿—å¦‚ä¸‹ï¼š 1234567892019-12-12 11:05:36.399 DEBUG 17328 --- [ main] c.s.s.m.OrderMapper.selectByAnnotation : ==&gt; Preparing: select * from t_order t where t.order_id in ( ? , ? ) 2019-12-12 11:05:36.459 DEBUG 17328 --- [ main] c.s.s.m.OrderMapper.selectByAnnotation : ==&gt; Parameters: 406907714078244865(Long), 407114454203891712(Long)2019-12-12 11:05:37.778 INFO 17328 --- [ main] ShardingSphere-SQL : Rule Type: sharding2019-12-12 11:05:37.783 INFO 17328 --- [ main] ShardingSphere-SQL : Logic SQL: select * from t_order t where t.order_id in ( ? , ? )2019-12-12 11:05:37.784 INFO 17328 --- [ main] ShardingSphere-SQL : SQLStatement: SelectStatement(super=DQLStatement(super=AbstractSQLStatement(type=DQL, tables=Tables(tables=[Table(name=t_order, alias=Optional.of(t))]), routeConditions=Conditions(orCondition=OrCondition(andConditions=[AndCondition(conditions=[Condition(column=Column(name=order_id, tableName=t_order), operator=IN, compareOperator=null, positionValueMap={}, positionIndexMap={0=0, 1=1})])])), encryptConditions=Conditions(orCondition=OrCondition(andConditions=[])), sqlTokens=[TableToken(tableName=t_order, quoteCharacter=NONE, schemaNameLength=0)], parametersIndex=2, logicSQL=select * from t_order t where t.order_id in ( ? , ? ))), containStar=true, firstSelectItemStartIndex=7, selectListStopIndex=7, groupByLastIndex=0, items=[StarSelectItem(owner=Optional.absent())], groupByItems=[], orderByItems=[], limit=null, subqueryStatement=null, subqueryStatements=[], subqueryConditions=[])2019-12-12 11:05:37.786 INFO 17328 --- [ main] ShardingSphere-SQL : Actual SQL: ds1 ::: select * from t_order_1 t where t.order_id in ( ? , ? ) ::: [406907714078244865, 407114454203891712]2019-12-12 11:05:37.786 INFO 17328 --- [ main] ShardingSphere-SQL : Actual SQL: ds1 ::: select * from t_order_2 t where t.order_id in ( ? , ? ) ::: [406907714078244865, 407114454203891712]2019-12-12 11:05:38.062 DEBUG 17328 --- [ main] c.s.s.m.OrderMapper.selectByAnnotation : &lt;== Total: 2[OrderEntity(orderId=407114454203891712, price=1.11, userId=2019xxxxxxxx, status=SUCCESS), OrderEntity(orderId=406907714078244865, price=1.11, userId=2019xxxxxxxxxxxxxxx, status=SUCCESS)] å¯çœ‹åˆ°æ‰§è¡Œçš„Logic SQLä¸ºï¼š 1select * from t_order t where t.order_id in ( ? , ? ) Sharding-JDBCçš„è·¯ç”±å¼•æ“æ ¹æ®è§£æä¸Šä¸‹æ–‡åŒ¹é…æ•°æ®åº“å’Œè¡¨çš„åˆ†ç‰‡ç­–ç•¥ï¼Œè·¯ç”±åˆ°å…·ä½“çš„åº“å’Œè¡¨ã€‚å†ç»è¿‡æ”¹å†™å¼•æ“ï¼Œå°†é€»è¾‘SQLæ”¹å†™ä¸ºçœŸæ­£æ‰§è¡Œçš„SQLã€‚ ä»æ—¥å¿—ä¸­å¯çœ‹åˆ°æ”¹å†™åçš„Actual SQLä¸ºï¼š 12select * from t_order_1 t where t.order_id in ( ? , ? ) ::: [406907714078244865, 407114454203891712]select * from t_order_2 t where t.order_id in ( ? , ? ) ::: [406907714078244865, 407114454203891712] ç»“æœå½’å¹¶ï¼ŒçœŸå®çš„SQLæ‰§è¡Œåä¼šè¿”å›å¤šä¸ªç»“æœé›†ï¼Œå½’å¹¶å¼•æ“ä»å„ä¸ªæ•°æ®èŠ‚ç‚¹æ‹¿åˆ°ç»“æœé›†åç»„åˆæˆä¸€ä¸ªç»“æœé›†å¹¶è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ è‡³æ­¤ï¼Œå…¥é—¨æ¡ˆä¾‹å°±æ¼”ç¤ºç»“æŸã€‚æºç åœ°å€ï¼šä¼ é€é—¨ ä¸‹ä¸€ç¯‡æ–‡ç« å°†å¯¹Sharding-JDBCä¸­çš„ä¸€äº›æ ¸å¿ƒæ¦‚å¿µè¿›è¡Œå…·ä½“çš„è§£é‡Šã€‚ å°ç»“è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯å¯¹Apache ShardingSphere 4.xä¸Spring Boot 2.1.xè¿›è¡Œæ•´åˆï¼Œä½¿ç”¨äº†å†…ç½®çš„SNOWFLAKEé›ªèŠ±ç®—æ³•ç”Ÿæˆåˆ†å¸ƒå¼å…¨å±€å”¯ä¸€IDå’Œä½¿ç”¨é»˜è®¤çš„inlineè¡¨è¾¾å¼é…ç½®åˆ†ç‰‡ç­–ç•¥ï¼Œå®Œæˆäº†æœ€ç®€å•çš„ä¸€åº“ä¸¤è¡¨çš„åˆ†åº“åˆ†è¡¨ï¼Œå¹¶å¯¹æ–°å¢å’ŒæŸ¥è¯¢æ“ä½œè¿›è¡Œäº†æµ‹è¯•ã€‚","link":"/2019/12/12/middleware/sharding-sphere/sharding-jdbc-introduction/"},{"title":"ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬äºŒéƒ¨åˆ†ï¼šå‡½æ•°å¼æ•°æ®å¤„ç†","text":"ç¬¬å››ç« ï¼šå¼•å…¥æµæµçš„å®šä¹‰ä»æ”¯æŒæ•°æ®å¤„ç†æ“ä½œçš„æºç”Ÿæˆçš„å…ƒç´ åºåˆ—ã€‚ å…ƒç´ åºåˆ—å°±åƒé›†åˆä¸€æ ·ï¼Œæµä¹Ÿæä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥è®¿é—®ç‰¹å®šå…ƒç´ ç±»å‹çš„ä¸€ç»„æœ‰åºå€¼ã€‚ å› ä¸ºé›†åˆæ˜¯æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥å®ƒçš„ä¸»è¦ç›®çš„æ˜¯ä»¥ç‰¹å®šçš„æ—¶é—´/ç©ºé—´å¤æ‚åº¦å­˜å‚¨å’Œè®¿é—®å…ƒç´ ï¼ˆå¦‚ArrayList ä¸ LinkedListï¼‰ã€‚ ä½†æµçš„ç›®çš„åœ¨äºè¡¨è¾¾è®¡ç®—ï¼Œæ¯”å¦‚å‰é¢è§åˆ°çš„filterã€sortedå’Œmapã€‚ é›†åˆè®²çš„æ˜¯æ•°æ®ï¼Œæµè®²çš„æ˜¯è®¡ç®—ã€‚ æºæµä¼šä½¿ç”¨ä¸€ä¸ªæä¾›æ•°æ®çš„æºï¼Œå¦‚é›†åˆã€æ•°ç»„æˆ–è¾“å…¥/è¾“å‡ºèµ„æºã€‚ è¯·æ³¨æ„ï¼Œä»æœ‰åºé›†åˆç”Ÿæˆæµæ—¶ä¼šä¿ç•™åŸæœ‰çš„é¡ºåºã€‚ç”±åˆ—è¡¨ç”Ÿæˆçš„æµï¼Œå…¶å…ƒç´ é¡ºåºä¸åˆ—è¡¨ä¸€è‡´ã€‚ æ•°æ®å¤„ç†æ“ä½œæµçš„æ•°æ®å¤„ç†åŠŸèƒ½æ”¯æŒç±»ä¼¼äºæ•°æ®åº“çš„æ“ä½œï¼Œä»¥åŠå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­çš„å¸¸ç”¨æ“ä½œï¼Œ å¦‚filterã€mapã€reduceã€findã€matchã€sortç­‰ã€‚æµæ“ä½œå¯ä»¥é¡ºåºæ‰§è¡Œï¼Œä¹Ÿå¯å¹¶è¡Œæ‰§è¡Œã€‚ æµæ“ä½œçš„ç‰¹ç‚¹1. æµæ°´çº¿å¾ˆå¤šæµæ“ä½œæœ¬èº«ä¼šè¿”å›ä¸€ä¸ªæµï¼Œè¿™æ ·å¤šä¸ªæ“ä½œå°±å¯ä»¥é“¾æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå¤§çš„æµæ°´çº¿ã€‚ è¿™è®©ä¹‹åç« èŠ‚ä¸­çš„ä¸€äº›ä¼˜åŒ–æˆä¸ºå¯èƒ½ï¼Œå¦‚å»¶è¿Ÿå’ŒçŸ­è·¯ã€‚ æµæ°´çº¿çš„æ“ä½œå¯ä»¥çœ‹ä½œå¯¹æ•°æ®æºè¿›è¡Œæ•°æ®åº“å¼ï¼ˆé“¾å¼ï¼‰æŸ¥è¯¢ã€‚ 2. å†…éƒ¨è¿­ä»£ä¸ä½¿ç”¨è¿­ä»£å™¨æ˜¾å¼è¿­ä»£çš„é›†åˆä¸åŒï¼Œæµçš„è¿­ä»£æ“ä½œæ˜¯åœ¨èƒŒåè¿›è¡Œçš„ï¼ˆå†…éƒ¨è¿­ä»£ï¼‰ã€‚ 3. æµåªèƒ½è¢«æ¶ˆè´¹ä¸€æ¬¡ç»ˆæ­¢æ“ä½œåªèƒ½æœ‰ä¸€æ¬¡ï¼Œé‡å¤æ¶ˆè´¹ä¼šæŠ›å‡ºjava.lang.IllegalStateExceptionå¼‚å¸¸ã€‚ 4. å¯¹æµçš„æ“ä½œåˆ†ä¸ºä¸¤ç±»ï¼šä¸­é—´æ“ä½œå’Œç»ˆæ­¢æ“ä½œ ä¸­é—´æ“ä½œæ€»æ˜¯ä¼šæƒ°æ€§æ‰§è¡Œï¼šæ‰§è¡Œä¸€ä¸ªä¸­é—´æ“ä½œä¸ä¼šåœ¨åŸæµä¸Šåšä»»ä½•å¤„ç†ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ ‡è®°äº†è¯¥æ“ä½œçš„æ–°æµè¿”å›ã€‚ ç»ˆæ­¢æ“ä½œæ‰ä¼šè¿›è¡ŒçœŸå®çš„è®¡ç®—ï¼šè®¡ç®—å‘ç”Ÿæ—¶ä¼šæŠŠæ‰€æœ‰ä¸­é—´æ“ä½œç§¯æ”’çš„æ“ä½œä»¥Pipelineçš„æ–¹å¼æ‰§è¡Œï¼Œè¿™æ ·å¯ä»¥å‡å°‘è¿­ä»£æ¬¡æ•°ï¼Œè®¡ç®—å®Œæˆåæµå³å¤±æ•ˆã€‚ é›†åˆä¸æµçš„ä¸åŒç‚¹ï¼š æ— å­˜å‚¨ï¼šStreamä¸æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒåªæ˜¯æŸç§æ•°æ®æºçš„ä¸€ä¸ªè§†å›¾ã€‚æ•°æ®æºå¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„ã€Javaå®¹å™¨æˆ–I/Oèµ„æºç­‰ã€‚ ä¸ºå‡½æ•°å¼ç¼–ç¨‹è€Œç”Ÿï¼šå¯¹Streamçš„ä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šä¿®æ”¹èƒŒåçš„æ•°æ®æºï¼Œæ¯”å¦‚å¯¹ä¸€ä¸ªæµæ‰§è¡Œfilterè¿‡æ»¤æ“ä½œå¹¶ä¸ä¼šåˆ é™¤è¢«è¿‡æ»¤çš„å…ƒç´ ï¼Œè€Œæ˜¯ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ä¸åŒ…å«è¢«è¿‡æ»¤å…ƒç´ çš„æ–°æµã€‚ æƒ°æ€§æ‰§è¡Œï¼šå¯¹æµçš„ä¸­é—´æ“ä½œå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œåªæœ‰ç­‰ä¸€ä¸ªç»ˆæ­¢æ“ä½œæ¥ä¸´æ—¶æ‰ä¼šä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚ å¯æ¶ˆè´¹æ€§ï¼šä¸€ä¸ªæµåªèƒ½è¢«æ¶ˆè´¹ä¸€æ¬¡ï¼Œä¸€æ—¦äº§ç”Ÿç»ˆæ­¢æ“ä½œï¼Œæµå³è¢«æ¶ˆè´¹ã€‚ ç¬¬äº”ç« ï¼šä½¿ç”¨æµ1. ç­›é€‰å’Œåˆ‡ç‰‡é€‰æ‹©æµä¸­çš„å…ƒç´ ï¼šç”¨è°“è¯ç­›é€‰ï¼Œç­›é€‰å‡ºå„ä¸ç›¸åŒçš„å…ƒç´ ï¼Œå¿½ç•¥æµ ä¸­çš„å¤´å‡ ä¸ªå…ƒç´ ï¼Œæˆ–å°†æµæˆªçŸ­è‡³æŒ‡å®šé•¿åº¦ã€‚ 1.1 ç”¨è°“è¯ç­›é€‰Streamsæ¥å£æ”¯æŒfilteræ–¹æ³•ã€‚è¯¥æ“ä½œä¼šæ¥å—ä¸€ä¸ªè°“è¯ï¼ˆä¸€ä¸ªè¿”å› booleançš„å‡½æ•°ï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…æ‹¬æ‰€æœ‰ç¬¦åˆè°“è¯çš„å…ƒç´ çš„æµã€‚ 1.2 ç­›é€‰å„å¼‚çš„å…ƒç´ æµæ”¯æŒä¸€ä¸ªå«ä½œdistinctçš„æ–¹æ³•ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå…ƒç´ å„å¼‚ï¼ˆæ ¹æ®æµæ‰€ç”Ÿæˆå…ƒç´ çš„ hashCodeå’Œequalsæ–¹æ³•å®ç°ï¼‰çš„æµã€‚ 1.3 æˆªçŸ­æµæµæ”¯æŒlimit(n)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªä¸è¶…è¿‡ç»™å®šé•¿åº¦çš„æµã€‚ æ‰€éœ€çš„é•¿åº¦ä½œä¸ºå‚æ•°ä¼ é€’ç»™limitã€‚å¦‚æœæµæ˜¯æœ‰åºçš„ï¼Œåˆ™å¤šä¼šè¿”å›å‰nä¸ªå…ƒç´ ã€‚ 1.4 è·³è¿‡å…ƒç´ æµè¿˜æ”¯æŒskip(n)æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ‰”æ‰äº†å‰nä¸ªå…ƒç´ çš„æµã€‚å¦‚æœæµä¸­å…ƒç´ ä¸è¶³nä¸ªï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæµã€‚ è¯·æ³¨æ„ï¼Œlimit(n)å’Œskip(n)æ˜¯äº’è¡¥çš„ã€‚ 2. æ˜ å°„ä¸€ä¸ªéå¸¸å¸¸è§çš„æ•°æ®å¤„ç†å¥—è·¯å°±æ˜¯ä»æŸäº›å¯¹è±¡ä¸­é€‰æ‹©ä¿¡æ¯ã€‚ æ¯”å¦‚åœ¨SQLé‡Œï¼Œä½ å¯ä»¥ä»è¡¨ä¸­é€‰æ‹©ä¸€åˆ—ã€‚Stream APIä¹Ÿé€šè¿‡mapå’ŒflatMapæ–¹æ³•æä¾›äº†ç±»ä¼¼çš„å·¥å…·ã€‚ 2.1 å¯¹æµä¸­æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°æµæ”¯æŒmapæ–¹æ³•ï¼Œå®ƒä¼šæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œ å¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ ï¼ˆä½¿ç”¨æ˜ å°„ä¸€è¯ï¼Œæ˜¯å› ä¸ºå®ƒå’Œè½¬æ¢ç±»ä¼¼ï¼Œä½†å…¶ä¸­çš„ç»†å¾®å·®åˆ«åœ¨äºå®ƒæ˜¯â€œåˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬â€è€Œä¸æ˜¯å»â€œä¿®æ”¹â€ï¼‰ã€‚ 2.2 æµçš„æ‰å¹³åŒ–æµæ”¯æŒflatMapæ–¹æ³•ï¼Œå°†å„ä¸ªå•ç‹¬çš„æµåˆå¹¶èµ·æ¥ï¼Œæ‰å¹³åŒ–æˆä¸€ä¸ªæµã€‚ flatMapæ–¹æ³•è®©ä½ æŠŠä¸€ä¸ªæµä¸­çš„æ¯ä¸ªå€¼éƒ½æ¢æˆå¦ä¸€ä¸ªæµï¼Œç„¶åæŠŠæ‰€æœ‰çš„æµè¿æ¥èµ·æ¥æˆä¸ºä¸€ä¸ªæµã€‚ 3. æŸ¥æ‰¾å’ŒåŒ¹é…å¦ä¸€ä¸ªå¸¸è§çš„æ•°æ®å¤„ç†å¥—è·¯æ˜¯çœ‹çœ‹æ•°æ®é›†ä¸­çš„æŸäº›å…ƒç´ æ˜¯å¦åŒ¹é…ä¸€ä¸ªç»™å®šçš„å±æ€§ã€‚ Stream APIé€šè¿‡anyMatchã€allMatchã€noneMatchã€findAnyå’ŒfindFirstæ–¹æ³•æä¾›äº†è¿™æ ·çš„å·¥å…·ã€‚ 3.1 æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ anyMatch()ï¼šæµä¸­æ˜¯å¦æœ‰ä¸€ä¸ªå…ƒç´ èƒ½åŒ¹é…ç»™å®šçš„è°“è¯ã€‚ è¿”å›ä¸€ä¸ªbooleanï¼Œå› æ­¤æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œã€‚ 3.2 æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ allMatch()ï¼šæµä¸­çš„å…ƒç´ æ˜¯å¦éƒ½èƒ½åŒ¹é…ç»™å®šçš„è°“è¯ã€‚æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œã€‚ 3.3 æ£€æŸ¥è°“è¯æ˜¯å¦ä¸åŒ¹é…æ‰€æœ‰å…ƒç´ noneMatch()ï¼šæµä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ ä¸ç»™å®šçš„è°“è¯åŒ¹é…ã€‚ 3.4 æŸ¥æ‰¾å…ƒç´ findAny()ï¼šå°†è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ ã€‚å¦‚æœæµä¸­æ²¡æœ‰å…ƒç´ ï¼Œè¿”å›å€¼å¯èƒ½ä¸ºç©ºï¼Œäºæ˜¯Java 8å¼•å…¥äº†Optional&lt;T&gt;ç±»ã€‚ Optionalç®€ä»‹Optional&lt;T&gt;ç±»ï¼ˆjava.util.Optionalï¼‰æ˜¯ä¸€ä¸ªå®¹å™¨ç±»ï¼Œä»£è¡¨ä¸€ä¸ªå€¼å­˜åœ¨æˆ–ä¸å­˜åœ¨ã€‚ æ–¹æ³•ç®€ä»‹ï¼š 1ã€isPresent()ï¼šå°†åœ¨OptionalåŒ…å«å€¼çš„æ—¶å€™è¿”å›true, å¦åˆ™è¿”å›falseã€‚ 2ã€ifPresent(Consumer&lt;T&gt; block)ï¼šä¼šåœ¨å€¼å­˜åœ¨çš„æ—¶å€™æ‰§è¡Œç»™å®šçš„ä»£ç å—ã€‚ 3ã€T get()ï¼šä¼šåœ¨å€¼å­˜åœ¨æ—¶è¿”å›å€¼ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ªNoSuchElementå¼‚å¸¸ã€‚ 4ã€T orElse(T other)ï¼šä¼šåœ¨å€¼å­˜åœ¨æ—¶è¿”å›å€¼ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ã€‚ 3.5 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ findFirst()ï¼šè¿”å›æµä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚åŒæ ·åœ°ï¼Œå¦‚æœæµä¸­æ²¡æœ‰å…ƒç´ ï¼Œè¿”å›å€¼å¯èƒ½ä¸ºç©ºï¼Œè¿”å›ç±»å‹ä¸ºOptional&lt;T&gt;ç±»ã€‚ æœ‰äº›æµæœ‰ä¸€ä¸ªå‡ºç°é¡ºåºï¼ˆencounter orderï¼‰æ¥æŒ‡å®šæµä¸­é¡¹ç›®å‡ºç°çš„é€»è¾‘é¡ºåºï¼ˆæ¯”å¦‚ç”±Listæˆ–æ’åºå¥½çš„æ•°æ®åˆ—ç”Ÿæˆçš„æµï¼‰ã€‚å¯¹äºè¿™ç§æµï¼Œå¯èƒ½æƒ³è¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ 4. å½’çº¦reduce()ï¼šå°†æµä¸­æ‰€æœ‰å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚ reduce()æ–¹æ³•æœ‰ä¸¤ä¸ªé‡è½½çš„æ–¹æ³•ï¼š 1234567891011/** * @param identity å½’çº¦çš„åˆå§‹å€¼ * @param accumulator å½’çº¦æ“ä½œ */T reduce(T identity, BinaryOperator&lt;T&gt; accumulator);/** * @param accumulator å½’çº¦æ“ä½œ * @return Optional&lt;T&gt;å¯¹è±¡ï¼Œç”±äºæ²¡æœ‰åˆå§‹å€¼ï¼Œæµä¸­å…ƒç´ å¯èƒ½ä¸ºç©ºï¼Œæ•…è¿”å›å€¼ä¼šå­˜åœ¨ç©ºçš„æƒ…å†µã€‚ */Optional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator); mapå’Œreduceçš„è¿æ¥é€šå¸¸ç§°ä¸ºmap-reduceæ¨¡å¼ï¼Œå› Googleç”¨å®ƒæ¥è¿›è¡Œç½‘ç»œæœç´¢è€Œå‡ºåï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“å¹¶è¡ŒåŒ–ã€‚ 5. æ•°å€¼æµæµä¸­çš„å…ƒç´ æ˜¯æ•°å€¼å‹çš„ï¼Œä¾‹å¦‚intï¼Œlongï¼Œdoubleã€‚å°½ç®¡å¯ä»¥æŠŠè¿™äº›æ•°å€¼å‹å…ƒç´ æ”¾å…¥æµä¸­ï¼Œä½†å®é™…ä¸Šæ˜¯æš—å«äº†è£…ç®±æ“ä½œï¼Œå°†æ•°å€¼å‹å…ƒç´ è½¬æ¢æˆå¯¹åº”çš„åŒ…è£…ç±»å‹ï¼Œä»è€Œå½¢æˆå¯¹è±¡æµã€‚ Stream APIæä¾›äº†åŸå§‹ç±»å‹æµç‰¹åŒ–ï¼Œä¸“é—¨æ”¯æŒå¤„ç†æ•°å€¼æµçš„æ–¹æ³•ã€‚å‡å»è£…ç®±æ“ä½œçš„æŸè€—ã€‚ 5.1 åŸå§‹ç±»å‹æµç‰¹åŒ–Java 8å¼•å…¥äº†ä¸‰ä¸ªåŸå§‹ç±»å‹ç‰¹åŒ–æµæ¥å£ï¼šIntStreamã€DoubleStreamå’ŒLongStreamï¼Œåˆ†åˆ«å°†æµä¸­çš„å…ƒç´ ç‰¹åŒ–ä¸ºintã€longå’Œdoubleï¼Œä»è€Œé¿å…äº†æš—å«çš„è£…ç®±æˆæœ¬ã€‚ æ¯ä¸ªæ¥å£éƒ½å¸¦æ¥äº†è¿›è¡Œå¸¸ç”¨æ•°å€¼å½’çº¦çš„æ–°æ–¹æ³•ï¼Œæ¯”å¦‚å¯¹æ•°å€¼æµæ±‚å’Œçš„sumï¼Œæ‰¾åˆ°å¤§å…ƒç´ çš„maxã€‚æ­¤å¤–è¿˜æœ‰åœ¨å¿…è¦æ—¶å†æŠŠå®ƒä»¬è½¬æ¢å›å¯¹è±¡æµçš„æ–¹æ³•ã€‚ 5.1.1 æ˜ å°„åˆ°æ•°å€¼æµå°†æµè½¬æ¢ä¸ºç‰¹åŒ–ç‰ˆæœ¬çš„å¸¸ç”¨æ–¹æ³•æ˜¯mapToIntã€mapToDoubleå’ŒmapToLongã€‚è¿™äº›æ–¹æ³•mapæ–¹æ³•çš„å·¥ä½œæ–¹å¼ä¸€æ ·ï¼Œåªæ˜¯å®ƒä»¬è¿”å›çš„æ˜¯ä¸€ä¸ªç‰¹åŒ–æµï¼Œè€Œä¸æ˜¯Stream&lt;T&gt;ã€‚ 5.1.2 è½¬æ¢å›å¯¹è±¡æµä¸€æ—¦æœ‰äº†æ•°å€¼æµï¼Œå¯èƒ½éœ€è¦å°†å…¶è½¬æ¢å›éç‰¹åŒ–æµã€‚ 5.1.3 é»˜è®¤å€¼OptionalIntå¯¹äºåŸå§‹ç±»å‹ç‰¹åŒ–æµæ¥å£ä¸­çš„maxï¼Œminï¼Œaverageç­‰æ–¹æ³•çš„è¿”å›å€¼ã€‚å¦‚æœæµæ˜¯ç©ºçš„ï¼Œè¿™äº›æ–¹æ³•çš„è¿”å›å€¼ä¸ºç©ºï¼Œä½†ä¸èƒ½é»˜è®¤ä¸º0ã€‚å› ä¸ºå¯èƒ½çœŸå®è®¡ç®—çš„ç»“æœæ°å¥½ä¸º0ã€‚ å¯ä»¥ä½¿ç”¨Optionalç±»æ¥è§£å†³è¿”å›å€¼ä¸ºç©ºçš„æƒ…å†µã€‚ä½†Optional&lt;T&gt;åªèƒ½æ¥æ”¶åŒ…è£…ç±»å‹ã€‚ä¼ é€’åŸå§‹ç±»å‹ä¼šè§¦å‘è‡ªåŠ¨è£…ç®±æ“ä½œï¼Œäº§ç”ŸæŸè€—ã€‚ Java 8åŒæ ·å¼•å…¥äº†OptionalåŸå§‹ç±»å‹ç‰¹åŒ–ç‰ˆæœ¬ï¼šOptionalIntã€OptionalDoubleå’ŒOptionalLongï¼Œç”¨è¿™äº›Optionalç±»æ¥è§£å†³ä¼ é€’åŸå§‹ç±»å‹æ—¶è‡ªåŠ¨è£…ç®±çš„é—®é¢˜ã€‚ 5.2 æ•°å€¼èŒƒå›´å’Œæ•°å­—æ‰“äº¤é“æ—¶ï¼Œæœ‰ä¸€ä¸ªå¸¸ç”¨çš„ä¸œè¥¿å°±æ˜¯æ•°å€¼èŒƒå›´ã€‚æ¯”å¦‚ç”Ÿæˆ1å’Œ100ä¹‹é—´çš„æ‰€æœ‰æ•°å­—ã€‚ Java 8å¼•å…¥äº†ä¸¤ä¸ªå¯ä»¥ç”¨äºIntStreamå’ŒLongStreamçš„é™æ€æ–¹æ³•ï¼Œå¸®åŠ©ç”Ÿæˆè¿™ç§èŒƒå›´ï¼š rangeå’ŒrangeClosedã€‚ 12345678910111213/** * rangeæ–¹æ³•è¡¨ç¤ºçš„èŒƒå›´ä¸ºï¼š[startInclusive,endExclusive) * @param startInclusive æ•°å€¼èŒƒå›´å¼€å§‹ * @param endExclusive æ•°å€¼èŒƒå›´ç»“æŸï¼ˆä¸åŒ…å«è¯¥å€¼ï¼‰ */IntStream range(int startInclusive, int endExclusive);/** * rangeClosedæ–¹æ³•è¡¨ç¤ºçš„èŒƒå›´ä¸ºï¼š[startInclusive,endExclusive] * @param startInclusive æ•°å€¼èŒƒå›´å¼€å§‹ * @param endExclusive æ•°å€¼èŒƒå›´ç»“æŸï¼ˆåŒ…å«è¯¥å€¼ï¼‰ */IntStream rangeClosed(int startInclusive, int endInclusive); è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ¥å—èµ·å§‹å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ¥å—ç»“æŸå€¼ã€‚ä½†rangeæ˜¯ä¸åŒ…å«ç»“æŸå€¼çš„ï¼Œè€ŒrangeClosedåˆ™åŒ…å«ç»“æŸå€¼ã€‚ 6. æ„å»ºæµä»‹ç»å¦‚ä½•ä»å€¼åºåˆ—ã€æ•°ç»„ã€æ–‡ä»¶æ¥åˆ›å»ºæµï¼Œç”šè‡³ç”±ç”Ÿæˆå‡½æ•°æ¥åˆ›å»ºæ— é™æµã€‚ 6.1 ç”±å€¼åˆ›å»ºæµä½¿ç”¨é™æ€æ–¹æ³•Stream.of(T...values)ï¼Œé€šè¿‡æ˜¾å¼å€¼åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒå¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚ ä½¿ç”¨é™æ€æ–¹æ³•Stream.empty()ï¼Œåˆ›å»ºä¸€ä¸ªç©ºæµã€‚ 6.2 ç”±æ•°ç»„åˆ›å»ºæµä½¿ç”¨é™æ€æ–¹æ³•Arrays.streamä»æ•°ç»„åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ã€‚ 6.3ã€ç”±æ–‡ä»¶ç”ŸæˆæµJavaä¸­ç”¨äºå¤„ç†æ–‡ä»¶ç­‰I/Oæ“ä½œçš„NIO APIï¼ˆéé˜»å¡ I/Oï¼‰å·²æ›´æ–°ï¼Œä»¥ä¾¿åˆ©ç”¨Stream APIã€‚ java.nio.file.Filesä¸­çš„å¾ˆå¤šé™æ€æ–¹æ³•éƒ½ä¼šè¿”å›ä¸€ä¸ªæµã€‚ ä¾‹å¦‚ï¼ŒFiles.linesï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªç”±æŒ‡å®šæ–‡ä»¶ä¸­çš„å„è¡Œæ„æˆçš„å­—ç¬¦ä¸²æµã€‚ 6.4 ç”±å‡½æ•°ç”Ÿæˆæµï¼šåˆ›å»ºæ— é™æµStream APIæä¾›äº†ä¸¤ä¸ªé™æ€æ–¹æ³•æ¥ä»å‡½æ•°ç”Ÿæˆæµï¼šStream.iterateå’ŒStream.generateã€‚ è¿™ä¸¤ä¸ªæ“ä½œå¯ä»¥åˆ›å»ºæ‰€è°“çš„æ— é™æµï¼šä¸åƒä»å›ºå®šé›†åˆåˆ›å»ºçš„æµé‚£æ ·æœ‰å›ºå®šå¤§å°çš„æµã€‚ ç”±iterateå’Œgenerateäº§ç”Ÿçš„æµä¼šç”¨ç»™å®šçš„å‡½æ•°æŒ‰éœ€åˆ›å»ºå€¼ï¼Œå› æ­¤å¯ä»¥æ— ç©·æ— å°½åœ°è®¡ç®—ä¸‹å»ï¼ ä¸€èˆ¬æ¥è¯´ï¼Œåº”è¯¥ä½¿ç”¨limit(n)æ¥å¯¹è¿™ç§æµåŠ ä»¥é™åˆ¶ï¼Œä»¥é¿å…æ‰“å°æ— ç©·å¤šä¸ªå€¼ã€‚ ç¬¬å…­ç« ï¼šç”¨æµæ”¶é›†æ•°æ®1. æ±‡æ€»Collectorsç±»ä¸“é—¨ä¸ºæ±‡æ€»æä¾›äº†ä¸€ä¸ªå·¥å‚æ–¹æ³•ï¼šCollectors.summingIntã€‚ 1Collector&lt;T, ?, Integer&gt; summingInt(ToIntFunction&lt;? super T&gt; mapper); å®ƒå¯æ¥å—ä¸€ä¸ªæŠŠå¯¹è±¡æ˜ å°„ä¸ºæ±‚å’Œæ‰€éœ€intçš„å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ”¶é›†å™¨ï¼Œè¯¥æ”¶é›†å™¨åœ¨ä¼ é€’ç»™æ™®é€šçš„collectæ–¹æ³•åå³æ‰§è¡Œæˆ‘ä»¬éœ€è¦çš„æ±‡æ€»æ“ä½œã€‚ ç±»ä¼¼çš„è¿˜æœ‰Collectors.summingDoubleæ–¹æ³•å’ŒCollectors.summingLongæ–¹æ³•ï¼Œæ±‡æ€»ä¸ºdoubleå’Œlongç±»å‹ã€‚ 12Collector&lt;T, ?, Long&gt; summingLong(ToLongFunction&lt;? super T&gt; mapper);Collector&lt;T, ?, Double&gt; summingDouble(ToDoubleFunction&lt;? super T&gt; mapper); æ±‡æ€»ä¸ä»…ä»…åªæœ‰æ±‚å’Œã€‚ å¹³å‡æ•°ï¼š 123Collector&lt;T, ?, Double&gt; averagingInt(ToIntFunction&lt;? super T&gt; mapper);Collector&lt;T, ?, Double&gt; averagingDouble(ToDoubleFunction&lt;? super T&gt; mapper);Collector&lt;T, ?, Double&gt; averagingLong(ToLongFunction&lt;? super T&gt; mapper); ä¸€æ¬¡æ“ä½œå–å¾—å¤šä¸ªæ±‡æ€»ç»“æœï¼š 123Collector&lt;T, ?, IntSummaryStatistics&gt; summarizingInt(ToIntFunction&lt;? super T&gt; mapper);Collector&lt;T, ?, LongSummaryStatistics&gt; summarizingLong(ToLongFunction&lt;? super T&gt; mapper);Collector&lt;T, ?, DoubleSummaryStatistics&gt; summarizingDouble(ToDoubleFunction&lt;? super T&gt; mapper); å¯ä»¥é€šè¿‡å¯¹ç”¨getteræ–¹æ³•å–å¾—æ±‡æ€»ç»“æœã€‚ 2. è¿æ¥å­—ç¬¦ä¸²joiningå·¥å‚æ–¹æ³•è¿”å›çš„æ”¶é›†å™¨ä¼šæŠŠå¯¹æµä¸­æ¯ä¸€ä¸ªå¯¹è±¡åº”ç”¨toStringæ–¹æ³•å¾—åˆ°çš„æ‰€æœ‰å­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ joiningæ–¹æ³•æœ‰3ä¸ªé‡è½½ï¼š 12345678910111213141516/** * å†…éƒ¨ä½¿ç”¨StringBuilderæ‹¼æ¥ */Collector&lt;CharSequence, ?, String&gt; joining();/** * @param delimiter è¡¨ç¤ºæ¯ä¸ªå­—ç¬¦ä¸²è¿æ¥æ—¶çš„åˆ†éš”ç¬¦ */Collector&lt;CharSequence, ?, String&gt; joining(CharSequence delimiter);/** * @param delimiter åˆ†éš”ç¬¦ * @param prefix å­—ç¬¦ä¸²å‰ç¼€ * @param suffix å­—ç¬¦ä¸²åç¼€ */Collector&lt;CharSequence, ?, String&gt; joining(CharSequence delimiter,CharSequence prefix,CharSequence suffix); 3. åˆ†ç»„groupingByï¼šè·Ÿæ•°æ®åº“ä¸­çš„group byåˆ†ç»„æ“ä½œä¸€æ ·ã€‚åŒæ—¶æ”¯æŒå¤šçº§åˆ†ç»„ã€‚ groupingByæ–¹æ³•æœ‰å¤šä¸ªé‡è½½ï¼š 1234567891011121314151617/** * å†…éƒ¨è°ƒç”¨çš„æ˜¯å¸¦ä¸¤ä¸ªå‚æ•°çš„groupingByæ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ é€’çš„æ˜¯Collectors.toList()ã€‚ * @param classifier ä¸€ä¸ªFunctionå‡½æ•°å‹æ¥å£ã€‚ */groupingBy(Function&lt;? super T, ? extends K&gt; classifier);/** * å†…éƒ¨è°ƒç”¨çš„æ˜¯ä¸‰ä¸ªå‚æ•°çš„groupingByæ–¹æ³•ã€‚ * @param classifier ä¸€ä¸ªFunctionå‡½æ•°å‹æ¥å£ * @param downstream ä¸€ä¸ªæ”¶é›†å™¨å¯¹è±¡ */groupingBy(Function&lt;? super T, ? extends K&gt; classifier,Collector&lt;? super T, A, D&gt; downstream);/** * æœ‰ä¸‰ä¸ªå‚æ•°ï¼ŒgroupingByåˆ†ç»„çš„å…·ä½“å®ç°ã€‚ */groupingBy(Function&lt;? super T, ? extends K&gt; classifier,Supplier&lt;M&gt; mapFactory,Collector&lt;? super T, A, D&gt; downstream); å¯ä»¥æŠŠç¬¬äºŒä¸ªgroupingByæ”¶é›†å™¨ä¼ é€’ç»™å¤–å±‚æ”¶é›†å™¨æ¥å®ç°å¤šçº§åˆ†ç»„ã€‚ ä½†è¿›ä¸€æ­¥è¯´ï¼Œä¼ é€’ç»™ç¬¬ä¸€ä¸ªgroupingByçš„ç¬¬äºŒä¸ªæ”¶é›†å™¨å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œè€Œä¸ä¸€å®šæ˜¯å¦ä¸€ä¸ªgroupingByã€‚ æ”¶é›†å™¨è¿”å›çš„ç»“æœå¯èƒ½æ˜¯OptionalåŒ…è£…åçš„å¯¹è±¡ï¼Œå¯¹äºå¤šçº§åˆ†ç»„æ¥è¯´ï¼Œç¬¬äºŒä¸ªæ”¶é›†å™¨å¯¹è±¡å‚æ•°è¿”å›çš„Optionalå¯¹è±¡å¯èƒ½æ²¡ä»€ä¹ˆç”¨ã€‚ç¬¬ä¸€å±‚groupingByå·²ç»æŠŠä¸ºç©ºçš„æƒ…å†µç»™æ’é™¤æ‰äº†ã€‚ Collectorsæ”¶é›†å™¨æä¾›äº†collectingAndThenæ–¹æ³•å°†æ”¶é›†å™¨è¿›è¡Œè½¬æ¢ã€‚ 123456/** * è¿”å›è½¬æ¢åçš„å¦ä¸€ä¸ªæ”¶é›†å™¨ * @param downstream éœ€è¦è½¬æ¢çš„æ”¶é›†å™¨ * @param finisher è½¬æ¢å‡½æ•° */Collector&lt;T,A,RR&gt; Collectors.collectingAndThen(Collector&lt;T,A,R&gt; downstream,Function&lt;R,RR&gt; finisher); groupingByå¯ä»¥è”åˆå…¶å®ƒæ”¶é›†å™¨ä½¿ç”¨ï¼Œç»å¸¸ä½¿ç”¨çš„æ˜¯mappingæ–¹æ³•ã€‚å®ƒå¯ä»¥è®©æ¥å—ç‰¹å®šç±»å‹å…ƒç´ çš„æ”¶é›†å™¨é€‚åº”ä¸åŒç±»å‹çš„å¯¹è±¡ã€‚ 12345/** * @param mapper ä¸€ä¸ªå‡½æ•°å‹æ¥å£,å¯¹æµä¸­çš„å…ƒç´ åšæ˜ å°„ * @param downstream ä¸€ä¸ªæ”¶é›†å™¨ï¼Œå°†æ˜ å°„åçš„å…ƒç´ æ”¶é›†èµ·æ¥ */Collector&lt;T, ?, R&gt; mapping(Function&lt;? super T, ? extends U&gt; mapper,Collector&lt;? super U, A, R&gt; downstream); 4. åˆ†åŒºpartitioningByåˆ†åŒºæ˜¯åˆ†ç»„çš„ç‰¹æ®Šæƒ…å†µï¼šç”±ä¸€ä¸ªè°“è¯ï¼ˆè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼çš„å‡½æ•°ï¼‰ä½œä¸ºåˆ†ç±»å‡½æ•°ï¼Œå®ƒç§°åˆ†åŒºå‡½æ•°ã€‚ åˆ†åŒºå‡½æ•°è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¿™æ„å‘³ç€å¾—åˆ°çš„åˆ†ç»„Mapçš„é”®ç±»å‹æ˜¯Booleanï¼Œäºæ˜¯å®ƒå¤šå¯ä»¥åˆ†ä¸ºä¸¤ç»„â€”â€”trueæ˜¯ä¸€ç»„ï¼Œfalseæ˜¯ä¸€ç»„ã€‚ partitioningByæ”¶é›†å™¨æœ‰ä¸¤ä¸ªé‡è½½çš„æ–¹æ³•: 1234567891011/** * å†…éƒ¨è°ƒç”¨äº†ä¸¤ä¸ªå‚æ•°çš„é‡è½½æ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ é€’çš„æ˜¯ä¸€ä¸ªCollectors.toList()æ”¶é›†å™¨ã€‚ * @param predicate æ–­è¨€å‹æ¥å£ */Collector&lt;T, ?, Map&lt;Boolean, List&lt;T&gt;&gt;&gt; partitioningBy(Predicate&lt;? super T&gt; predicate);/** * @param predicate æ–­è¨€å‹æ¥å£ * @param downstream æ”¶é›†å™¨ */Collector&lt;T, ?, Map&lt;Boolean, D&gt;&gt; partitioningBy(Predicate&lt;? super T&gt; predicate,Collector&lt;? super T, A, D&gt; downstream); åˆ†åŒºä¹Ÿå¯ç”¨ç›¸åŒçš„è°“è¯ä½¿ç”¨filterç­›é€‰æ¥å®ç°ã€‚ åˆ†åŒºçš„å¥½å¤„ï¼š ä¿ç•™äº†åˆ†åŒºå‡½æ•°è¿”å›trueæˆ–falseçš„ä¸¤å¥—æµå…ƒç´ åˆ—è¡¨ã€‚ ä½¿ç”¨filterç­›é€‰éœ€è¦æ“ä½œä¸¤æ¬¡ï¼Œä¸€æ¬¡åˆ©ç”¨è°“è¯ï¼Œä¸€æ¬¡åˆ©ç”¨è°“è¯çš„éã€‚ ç¬¬ä¸ƒç« ï¼šå¹¶è¡Œæ•°æ®å¤„ç†ä¸æ€§èƒ½å¹¶è¡Œå¤„ç†æ•°æ®ä¸€å®šæ¯”ä¸²è¡Œå¤„ç†å¿«å—ï¼Ÿç­”æ¡ˆæ˜¯ä¸ä¸€å®šã€‚ å‡è®¾ä½ ç°åœ¨è¦è¿›è¡Œæ•°å­—ç´¯åŠ çš„æ“ä½œï¼Œä¾‹å¦‚è®¡ç®—1è‡³100ä¸‡ä¹‹é—´æ‰€æœ‰æ•°å­—çš„å’Œã€‚ ç°åœ¨æœ‰ä¸‰ç§æ–¹æ¡ˆå¯ä¾›é€‰æ‹©ã€‚ æ–¹æ¡ˆä¸€ï¼šåŸå§‹è¿­ä»£æ–¹å¼ã€‚ 1234567public static long iterateSum(long n) { long result = 0; for (int i = 0; i &lt;= n; i++) { result += i; } return result;} æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Streamä¸²è¡Œæµå¤„ç†ã€‚ 123456public static long streamSum(long n) { Long result = Stream.iterate(0L, i -&gt; i + 1) .limit(n) .reduce(0L, Long::sum); return result;} æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ParallelStreamå¹¶è¡Œæµå¤„ç†ã€‚ 1234567public static long parallelSum(long n) { Long result = Stream.iterate(0L, i -&gt; i + 1) .limit(n) .parallel() .reduce(0L, Long::sum); return result;} åŸå§‹è¿­ä»£æ–¹æ¡ˆä¸­ä¸éœ€è¦å¯¹åŸå§‹ç±»å‹çš„æ•°å­—è¿›è¡Œè£…ç®±æ“ä½œã€‚ ä¸²è¡Œæµæ–¹æ¡ˆä¸­åˆ©ç”¨Streamæ¥å£çš„iterateæ–¹æ³•ç”Ÿæˆ0åˆ°nçš„è‡ªç„¶æ•°æµï¼Œé»˜è®¤æ˜¯ä¸²è¡Œæµï¼Œç„¶åå½’çº¦æ±‚å’Œã€‚ å¹¶è¡Œæµæ–¹æ¡ˆä¸­åˆ©ç”¨Streamæ¥å£çš„iterateæ–¹æ³•ç”Ÿæˆ0åˆ°nçš„è‡ªç„¶æ•°æµï¼Œä½¿ç”¨parallelæ–¹æ³•å°†æµè½¬æ¢æˆå¹¶è¡Œæµï¼Œç„¶åå½’çº¦æ±‚å’Œã€‚ æµ‹è¯•æ–¹æ³•ï¼šè¿è¡Œ10æ¬¡ï¼Œå–æœ€çŸ­æ—¶é—´ã€‚ 12345678910111213141516171819202122232425public static long measureSumPerf(Function&lt;Long,Long&gt; adder,long n) { long fastest = Integer.MAX_VALUE; for (int i = 0; i &lt; 10; i++) { long start = System.nanoTime(); long sum = adder.apply(n); long duration = (System.nanoTime() - start) / 1_100_100; if (duration &lt; fastest) { fastest = duration; } } return fastest;}// testpublic static void main(String[] args) { // åŸå§‹è¿­ä»£æ–¹å¼æ›´å¿«ï¼Œå®ƒä¸éœ€è¦å¯¹åŸå§‹ç±»å‹è¿›è¡Œè£…ç®±/æ‹†ç®±æ“ä½œ System.out.println(&quot;iterate sum min time:&quot; + measureSumPerf( StreamPerformanceTest::iterateSum, 100000000)); // iterateç”Ÿæˆçš„æ˜¯è£…ç®±çš„å¯¹è±¡ï¼Œå¿…é¡»æ‹†ç®±æˆæ•°å­—æ‰èƒ½æ±‚å’Œã€‚ System.out.println(&quot;stream sum min time:&quot; + measureSumPerf( StreamPerformanceTest::streamSum, 100000000)); // æ•´ä¸ªæ•°å­—åœ¨è¿‡ç¨‹å¼€å§‹æ—¶å¹¶æ²¡æœ‰å‡†å¤‡å¥½ï¼Œæ— æ³•æœ‰æ•ˆçš„æŠŠæµåˆ’åˆ†ä¸ºå°å—æ¥å¹¶è¡Œå¤„ç†ã€‚ System.out.println(&quot;parallel stream sum min time:&quot; + measureSumPerf( StreamPerformanceTest::parallelSum, 100000000));} æµ‹è¯•ç»“æœï¼š 123åŸå§‹è¿­ä»£æ–¹æ¡ˆæœ€å¿«ï¼šiterate sum min time:11ä¸²è¡Œæµæ–¹æ¡ˆç¬¬äºŒå¿«ï¼šstream sum min time:198å¹¶è¡Œæµæ–¹æ¡ˆæœ€æ…¢ï¼šparallel stream sum min time:267 å¯è§å¹¶è¡Œæ‰§è¡Œå¹¶ä¸æ¯”ä¸²è¡Œæ‰§è¡Œå¿«ã€‚ä½†å®é™…ä¸Šè¿™æ¬¡è¯•éªŒçš„å¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´æ¶ˆè€—åœ¨å¯¹åŸå§‹æ•°æ®ç±»å‹è¿›è¡Œè£…ç®±çš„æ“ä½œä¸Šã€‚å› ä¸ºStreamæ¥å£çš„iterateæ–¹æ³•ç”Ÿæˆçš„æ˜¯åŒ…è£…å¯¹è±¡ï¼Œæ±‚å’Œæ—¶éœ€è¦æ‹†ç®±æˆæ•°å­—ã€‚åŒæ—¶ä½¿ç”¨iterateæ–¹æ³•åœ¨ç¨‹åºå¼€å§‹æ—¶å¹¶æ²¡æœ‰æŠŠæ•´ä¸ªæ•°å­—åºåˆ—å‡†å¤‡å¥½ï¼Œæ— æ³•æœ‰æ•ˆçš„æŠŠæµåˆ’åˆ†ä¸ºå°å—æ¥å¹¶è¡Œå¤„ç†ã€‚ æ¥ä¸‹æ¥ä½¿ç”¨åŸå§‹ç±»å‹ç‰¹åŒ–æµæ¥ç”Ÿæˆæ•°å­—æµã€‚ åŸå§‹ç±»å‹ç‰¹åŒ–æµä¸²è¡Œå¤„ç†ï¼š 1234public static long longStreamSum(long n) { long result = LongStream.rangeClosed(1, n).reduce(0L, Long::sum); return result;} åŸå§‹ç±»å‹ç‰¹åŒ–æµå¹¶è¡Œå¤„ç†ï¼š 1234public static long longParallelSum(long n) { long result = LongStream.rangeClosed(1, n).parallel().reduce(0L, Long::sum); return result;} æµ‹è¯•ä»£ç ï¼š 12345// LongStream.rangeClosedç›´æ¥äº§ç”ŸåŸå§‹ç±»å‹çš„longæ•°å­—ï¼Œæ²¡æœ‰è£…ç®±æ‹†ç®±çš„å¼€é”€ã€‚System.out.println(&quot;long stream sum min time:&quot; + measureSumPerf( StreamPerformanceTest::longStreamSum,100000000));// LongStream.rangeClosedåœ¨è¿‡ç¨‹å¼€å§‹æ—¶å°±ä¼šç”Ÿæˆæ•°å­—èŒƒå›´ï¼Œå¾ˆå®¹æ˜“æ‹†åˆ†ä¸ºç‹¬ç«‹çš„å°å—è¿›è¡Œå¹¶è¡Œå¤„ç†ã€‚System.out.println(&quot;long parallel stream sum min time:&quot; + measureSumPerf(StreamPerformanceTest::longParallelSum,100000000)); æµ‹è¯•ç»“æœï¼š 12åŸå§‹ç±»å‹ç‰¹åŒ–æµä¸²è¡Œå¤„ç†ï¼šlong stream sum min time:7åŸå§‹ç±»å‹ç‰¹åŒ–æµå¹¶è¡Œå¤„ç†ï¼šlong parallel stream sum min time:1 LongStream.rangeClosedç›´æ¥äº§ç”ŸåŸå§‹ç±»å‹çš„longæ•°å­—ï¼Œæ²¡æœ‰è£…ç®±æ‹†ç®±çš„å¼€é”€ã€‚ LongStream.rangeClosedåœ¨è¿‡ç¨‹å¼€å§‹æ—¶å°±ä¼šç”Ÿæˆæ•°å­—èŒƒå›´ï¼Œå¾ˆå®¹æ˜“æ‹†åˆ†ä¸ºç‹¬ç«‹çš„å°å—è¿›è¡Œå¹¶è¡Œå¤„ç†ã€‚ å¹¶è¡Œæµæœ‰æ—¶å€™æ¯”ä¸²è¡Œæµæ…¢çš„åŸå› å¹¶è¡Œæµæœ‰æ—¶å€™æ¯”ä¸²è¡Œæµæ…¢çš„åŸå› ï¼š æ²¡æœ‰ä½¿ç”¨åˆç†çš„ä½¿ç”¨æ•°æ®ç»“æ„ï¼Œå¯¼è‡´æ—¶é—´æµªè´¹åœ¨å…¶å®ƒéæµå¤„ç†çš„æ“ä½œä¸Šã€‚ å¹¶è¡Œæµçš„åº•å±‚å®ç°æ˜¯Fork/Joinæ¡†æ¶ã€‚å®ƒæ˜¯åŸºäºå¤šçº¿ç¨‹çš„ï¼Œçº¿ç¨‹ä¹‹é—´è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢éœ€è¦è€—æ—¶ã€‚åŒæ—¶çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œè°ƒåº¦çš„ã€‚çº¿ç¨‹è‡ªå·±æ— æ³•æ§åˆ¶æ—¶é—´ã€‚ Fork/Joinæ¡†æ¶Fork/Joinæ¡†æ¶æ˜¯Java 7æä¾›çš„ä¸€ä¸ªç”¨äºå¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„æ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªæŠŠå¤§ä»»åŠ¡åˆ†å‰²æˆè‹¥å¹²ä¸ªå°ä»»åŠ¡ï¼Œæœ€ç»ˆæ±‡æ€»æ¯ä¸ªå°ä»»åŠ¡ç»“æœåå¾—åˆ°å¤§ä»»åŠ¡ç»“æœçš„æ¡†æ¶ã€‚ä½“ç°äº†åˆ†æ²»æ³•çš„æ€æƒ³ã€‚Forkçš„æ„æ€æ˜¯æ‹†åˆ†ï¼ŒJoinçš„æ„æ€æ˜¯åˆå¹¶ã€‚æ¯”å¦‚è®¡ç®—1+2+â€¦+10000ï¼Œå¯ä»¥åˆ†å‰²æˆ10ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡åˆ†åˆ«å¯¹1000ä¸ªæ•°è¿›è¡Œæ±‚å’Œï¼Œ æœ€ç»ˆæ±‡æ€»è¿™10ä¸ªå­ä»»åŠ¡çš„ç»“æœã€‚Fork/Joinæ¡†æ¶çš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š Fork/Joinçš„æ‹†åˆ†é‡ç‚¹åœ¨äºä»»åŠ¡ä»€ä¹ˆæ—¶å€™è¶³å¤Ÿå°æˆ–ä¸å¯åˆ†ï¼Œä¸å¯å†æ‹†åˆ†çš„ä»»åŠ¡é¡ºåºæ‰§è¡Œï¼Œä¸åŒçš„ä»»åŠ¡ä¹‹é—´å¹¶è¡Œæ‰§è¡Œã€‚æ‰€æœ‰ä¸å¯æ‹†åˆ†çš„å­ä»»åŠ¡åˆ†é…åˆ°å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ç­‰å¾…çº¿ç¨‹å»æ‰§è¡Œï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œåˆ’åˆ†å¹¶è¡Œä»»åŠ¡æ—¶ï¼Œåº”è¯¥è®©æ¯ä¸ªä»»åŠ¡éƒ½ç”¨ç›¸åŒçš„æ—¶é—´å®Œæˆï¼Œè®©æ‰€æœ‰çš„CPUéƒ½åŒæ ·ç¹å¿™ï¼Œå……åˆ†çš„åˆ©ç”¨CPUã€‚ä½†å®é™…ä¸­ï¼Œç”±äºçº¿ç¨‹æ˜¯ç”±æ“ä½œç³»ç»Ÿæ ¹æ®æ—¶é—´ç‰‡è¿›è¡Œè°ƒåº¦çš„ï¼Œæ¯ä¸ªå­ä»»åŠ¡æ‰€èŠ±çš„æ—¶é—´å¯èƒ½å¤©å·®åœ°åˆ«ã€‚äºæ˜¯ä¼šå‡ºç°ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œäº†ï¼Œå¦ä¸€ä¸ªé˜Ÿåˆ—ä¸­è¿˜æœ‰å¾ˆå¤šä»»åŠ¡çš„æƒ…å†µã€‚è¿™ä¸ªæ—¶å€™CPUçš„åˆ©ç”¨ç‡æ²¡æœ‰æœ€å¤§åŒ–ã€‚Java 8é‡‡ç”¨å·¥ä½œçªƒå–ç®—æ³•æ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚ å·¥ä½œçªƒå–ï¼ˆwork-stealingï¼‰ç®—æ³•å·¥ä½œçªƒå–ç®—æ³•æ˜¯æŒ‡æŸä¸ªçº¿ç¨‹ä»å…¶å®ƒé˜Ÿåˆ—ä¸­çªƒå–ä»»åŠ¡æ¥æ‰§è¡Œã€‚æŸä¸ªçº¿ç¨‹ï¼Œè‡ªå·±é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼Œå°±å»åˆ«çš„è¿˜æœ‰ä»»åŠ¡çš„é˜Ÿåˆ—ä¸­çªƒå–ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œã€‚è¿™ä¸ªæ—¶å€™ä¼šå­˜åœ¨çº¿ç¨‹ç«äº‰å…³ç³»ï¼Œçªƒå–çº¿ç¨‹å’Œè¢«çªƒå–çº¿ç¨‹ä¹‹é—´åŒæ—¶è®¿é—®åŒä¸€ä¸ªé˜Ÿåˆ—ã€‚é€šå¸¸ä½¿ç”¨åŒç«¯é˜Ÿåˆ—æ¥è§£å†³ã€‚è¢«çªƒå–ä»»åŠ¡çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å¤´éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œï¼Œè€Œçªƒå–ä»»åŠ¡çš„çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å°¾éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œã€‚ å·¥ä½œçªƒå–ç®—æ³•çš„ä¼˜ç‚¹ï¼šå……åˆ†åˆ©ç”¨çº¿ç¨‹è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œå‡å°‘äº†çº¿ç¨‹é—´çš„ç«äº‰ã€‚ å·¥ä½œçªƒå–ç®—æ³•çš„ç¼ºç‚¹ï¼šåœ¨æŸäº›æƒ…å†µä¸‹è¿˜æ˜¯å­˜åœ¨ç«äº‰ï¼Œæ¯”å¦‚åŒç«¯é˜Ÿåˆ—é‡Œåªæœ‰ä¸€ä¸ªä»»åŠ¡æ—¶ã€‚å¹¶ä¸”è¯¥ç®—æ³•ä¼šæ¶ˆè€—äº†æ›´å¤šçš„ç³»ç»Ÿèµ„æºï¼Œæ¯”å¦‚åˆ›å»ºå¤šä¸ªçº¿ç¨‹å’Œå¤šä¸ªåŒç«¯é˜Ÿåˆ—ã€‚ Fork/Joinæ¡†æ¶çš„è®¾è®¡æ€è·¯ é¦–å…ˆéœ€è¦ä¸€ä¸ªForkç±»å»æŠŠå¤§ä»»åŠ¡è¿›è¡Œé€’å½’Forkæ‹†åˆ†ï¼Œç›´è‡³æ‹†åˆ†æˆä¸å¯å†åˆ†çš„å°ä»»åŠ¡ã€‚ æ‹†åˆ†å‡ºæ¥çš„å­ä»»åŠ¡å‡åŒ€åœ°åˆ†é…åˆ°nä¸ªåŒç«¯é˜Ÿåˆ—ä¸­ï¼Œå¯åŠ¨nä¸ªçº¿ç¨‹åˆ†åˆ«ä»åŒç«¯é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡æ‰§è¡Œã€‚æ¯ä¸ªå­ä»»åŠ¡æ‰§è¡Œå®Œçš„ç»“æœç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªç»“æœé˜Ÿåˆ—ä¸­ï¼Œå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä»ç»“æœé˜Ÿåˆ—ä¸­å–ç»“æœï¼Œç„¶åJoinåˆå¹¶æˆæœ€ç»ˆç»“æœã€‚","link":"/2019/12/12/reading-notes/java8-in-action/Part-II-Functional-Data-Processing/"},{"title":"ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆä¸‰ï¼‰ï¼šä»ä¸€ä¸ªç”Ÿäº§ç¯å¢ƒçš„äº‹æ•…åˆ°å¼‚æ­¥ç¼–ç¨‹æ€æƒ³","text":"ç¬¬åä¸€ç« ï¼šCompletableFutureç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹åœ¨ä»‹ç»è¿™éƒ¨åˆ†å†…å®¹ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹ç”±äºæˆ‘å’Œå¦å¤–ä¸€ä½å¼€å‘äººå‘˜çš„è€ƒè™‘ä¸å‘¨é€ æˆçš„ä¸€æ¬¡çº¿ä¸Šäº‹æ•…åœºæ™¯ï¼ˆè€ƒè™‘ä¼ä¸šéšç§ï¼Œå±è”½äº†ä¸€äº›å…³é”®è¯ï¼‰ã€‚ éœ€æ±‚èƒŒæ™¯å¡åŠµç³»ç»Ÿçš„åå°ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºå¤„ç†ç”¨æˆ·æŠ•è¯‰è¡¥å¿ä»¥åŠå‘é”™åˆ¸è¡¥å¿çš„åœºæ™¯ã€‚ éœ€æ±‚è¯´æ˜ä¸¤ç§æƒ…å†µä¼šä½¿ç”¨åˆ°è¿™æ¬¡æˆ‘ä»¬å¼€å‘çš„åŠŸèƒ½ã€‚ å¯èƒ½ä¼šå‡ºç°ç”¨æˆ·æŠ•è¯‰æœªé¢†å–åˆ°ä¼˜æƒ åˆ¸çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥ç»™ç”¨æˆ·è¡¥å‘ä¸€å¼ ã€‚é¿å…æµªè´¹äººåŠ›å»æŸ¥çº¿ä¸Šæ—¥å¿—æ‰¾åŸå› ã€‚ è¿è¥äººå‘˜æ“ä½œå¤±è¯¯å‘é”™åŠµï¼Œéœ€è¦æ‰‹åŠ¨ç»™ç”¨æˆ·è¡¥å‘åŠµã€‚ ç”±äºåŠŸèƒ½æ€¥éœ€ä¸Šçº¿ï¼Œäº§å“ç»ç†æƒ³å°½é‡ç®€åŒ–å¼€å‘ï¼Œè®¾è®¡çš„è½»é‡åŒ–ä¸€äº›ï¼Œä¸å°†è¡¥å‘è®°å½•å…¥åº“ã€‚æ¯æ¬¡è¡¥å‘å®Œæˆé¡µé¢å°±æ˜¾ç¤ºæˆåŠŸå¤šå°‘ä¸ªï¼Œå¤±è´¥å¤šå°‘ä¸ªï¼Œå¤±è´¥çš„UIDsæ˜¯å“ªäº›ã€‚ ä¸šåŠ¡æµç¨‹ ä¸€ä¸ªè¡¥å‘åŠµé¡µé¢ï¼Œè¿è¥äººå‘˜é¦–å…ˆè¾“å…¥åŠµIDæŸ¥è¯¢åŠµä¿¡æ¯ï¼ŒåŒ…å«åŠµåç§°å’Œå¯ç”¨åº“å­˜ã€‚ ä¸Šä¼ éœ€è¦è¿›è¡Œè¡¥å‘çš„UIDsåˆ°åå°è¿›è¡Œè§£æï¼ˆè§£æçš„è¿‡ç¨‹å°±æ˜¯å»æ•°æ®åº“ä¸­æŸ¥æ˜¯å¦å­˜åœ¨è¯¥UIDå¯¹åº”çš„ç”¨æˆ·ï¼‰ã€‚ ç»™æœ‰æ•ˆçš„UIDså¯¹åº”çš„ç”¨æˆ·è¿›è¡ŒåŠµè¡¥å‘æ“ä½œï¼Œè°ƒç”¨å‘åŠµæ¥å£ã€‚ ç­‰å¾…æ‰€æœ‰ç”¨æˆ·å…¨éƒ¨è°ƒç”¨å‘åŠµæ¥å£å®Œæ¯•ï¼Œè®°å½•å¤±è´¥çš„UIDsï¼Œå“åº”ç»™å‰ç«¯ã€‚ äº‹æ•…åˆ†æ äº‹æ•…æè¿°ï¼šè¿è¥äººå‘˜ä¸Šä¼ äº†250ä¸ªç”¨æˆ·UIDè¿›è¡Œè¡¥å‘åŠµï¼Œç‚¹å‡»è¡¥å‘æŒ‰é’®ï¼Œç­‰å¾…äº†çº¦2åˆ†é’Ÿé¡µé¢æ˜¾ç¤ºå¤±è´¥äº†215ä¸ªUIDã€‚ æ’æŸ¥æƒ…å†µï¼šçº¿ä¸Šç¯å¢ƒå°†åº”ç”¨éƒ¨ç½²åˆ°äº†2å°æœåŠ¡å™¨ã€‚æˆ‘ä»¬åœ¨Aå’ŒBä¸¤å°æœåŠ¡å™¨çš„æ—¥å¿—ä¸Šéƒ½æŸ¥åˆ°äº†è¡¥å‘è¯·æ±‚ç›¸å…³æ—¥å¿—ã€‚æœåŠ¡å™¨Aä¸Šçš„æ—¥å¿—æ˜¾ç¤ºè¡¥å‘å¤±è´¥35æ¡ï¼ŒæœåŠ¡å™¨Bä¸Šçš„æ—¥å¿—æ˜¾ç¤ºè¡¥å‘å¤±è´¥215æ¡ã€‚ åŸå› åˆ†æï¼š AæœåŠ¡å™¨ä¸Šçš„æ—¥å¿—æ˜¾ç¤ºæ§åˆ¶å™¨å±‚æ¥æ”¶åˆ°è¯·æ±‚çš„æ—¶åˆ»æ˜¯ï¼š2019-09-06 10:51:19.075ï¼Œå“åº”è¯·æ±‚çš„æ—¶åˆ»æ˜¯ï¼š2019-09-06 10:52:40.171ï¼› BæœåŠ¡å™¨ä¸Šçš„æ—¥å¿—æ˜¾ç¤ºæ§åˆ¶å™¨å±‚æ¥æ”¶åˆ°è¯·æ±‚çš„æ—¶åˆ»æ˜¯ï¼š2019-09-06 10:52:19.061ï¼Œå“åº”è¯·æ±‚çš„æ—¶åˆ»æ˜¯ï¼š2019-09-06 10:52:40.022ã€‚ AæœåŠ¡å™¨ä¸Šè®°å½•çš„å¤±è´¥çš„35ä¸ªUIDsåœ¨BæœåŠ¡å™¨ä¸Šå‘åŠµæˆåŠŸï¼›BæœåŠ¡å™¨ä¸Šè®°å½•çš„å¤±è´¥çš„215ä¸ªUIDsåœ¨AæœåŠ¡å™¨ä¸Šå‘åŠµæˆåŠŸã€‚å¦å¤–ä»æ—¥å¿—ä¸­å¯çœ‹å‡ºå‘åŠµæ¥å£åšäº†å¹‚ç­‰æ ¡éªŒã€‚ åˆæ­¥æ’æŸ¥ï¼šç”±äºåç«¯æœåŠ¡å™¨æ¥æ”¶åˆ°äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œåˆ¤æ–­æ˜¯å¦è¿è¥äººå‘˜ç‚¹äº†ä¸¤æ¬¡è¡¥å‘æŒ‰é’®ï¼Ÿç»è¿‡å¯¹å‰ç«¯é¡µé¢çš„æµ‹è¯•ï¼Œç‚¹äº†ä¸€æ¬¡è¡¥å‘æŒ‰é’®åï¼Œé¡µé¢å‡ºç°loadingé®ç½©å±‚ï¼Œä¸èƒ½ç¬¬äºŒæ¬¡ç‚¹å‡»è¡¥å‘æŒ‰é’®ã€‚æ’é™¤è¿è¥äººå‘˜æ“ä½œçš„é—®é¢˜ã€‚ è¿›ä¸€æ­¥åˆ†æï¼šAå’ŒBä¸¤å°æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚çš„æ—¶é—´é—´éš”æ°å¥½æ˜¯1åˆ†é’Ÿå·¦å³ï¼Œæ˜¯å¦æ˜¯å‰ç«¯Ajaxè¯·æ±‚çš„å“åº”è¶…æ—¶ä¼šè‡ªåŠ¨é‡è¯•ï¼Ÿç”±äºå‰ç«¯é¡µé¢æ˜¯ä½¿ç”¨jQueryå‘é€Ajaxè¯·æ±‚ï¼Œå¹¶ä¸”è¯·æ±‚ç±»å‹æ˜¯POSTï¼Œæµè§ˆå™¨å¹¶ä¸ä¼šè‡ªåŠ¨é‡è¯•ã€‚ æœ€ç»ˆå¾—å‡ºç»“è®ºï¼šåœ¨å‘æŒ‡å¯¼äººè¯·æ•™åï¼Œæ¨æµ‹æ˜¯çº¿ä¸Šç¯å¢ƒæœ‰Nginxè¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå½“ajaxè¯·æ±‚å¾—åˆ°å“åº”çš„æ—¶é—´è¶…è¿‡Nginxé»˜è®¤çš„60ç§’æ—¶ï¼Œè¯·æ±‚ä¼šè‡ªåŠ¨é‡å‘åˆ°å¦ä¸€å°æœåŠ¡å™¨ã€‚å‘éƒ¨é—¨ç»ç†ç¡®è®¤ç³»ç»Ÿæ¶æ„åï¼Œçº¿ä¸Šç¯å¢ƒç¡®å®å­˜åœ¨è´Ÿè½½å‡è¡¡ï¼Œä½¿ç”¨çš„æ˜¯é˜¿é‡Œçš„SLBã€‚ï¼ˆç”±äºæˆ‘ä»¬åˆšæ¥æ‰‹è¯¥é¡¹ç›®ï¼Œå¯¹çº¿ä¸Šç¯å¢ƒè¿˜ä¸å¤ªç†Ÿæ‚‰ï¼‰é˜¿é‡Œçš„SLBå¼€å¯äº†è¶…æ—¶è‡ªåŠ¨é‡å‘æœºåˆ¶ï¼Œè¶…æ—¶æ—¶é—´æ˜¯60ç§’ã€‚ äº‹æ•…ç»“è®ºä¸€ä¸ªè¡¥å‘åŠµçš„è¯·æ±‚ç»è¿‡SLBè´Ÿè½½å‡è¡¡åˆ°åç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨æ‰§è¡Œä¸šåŠ¡ä»£ç æ—¶é—´è¶…è¿‡äº†ä¸€åˆ†é’Ÿï¼Œè¿‡äº†60ç§’åï¼ŒSLBè®¤ä¸ºè¯¥è¯·æ±‚è¶…æ—¶ï¼Œè§¦å‘é‡è¯•æœºåˆ¶ï¼Œå°†åŒæ ·çš„è¯·æ±‚è´Ÿè½½åˆ°å¦å¤–ä¸€å°åç«¯æœåŠ¡å™¨ä¸Šï¼Œä¸¤å°æœåŠ¡å™¨ä¸Šçš„çº¿ç¨‹å¼€å§‹å¹¶å‘è°ƒç”¨å‘åŠµæ¥å£ï¼Œç”±äºå‘åŠµæ¥å£åšäº†æ¥å£å¹‚ç­‰æ€§æ ¡éªŒï¼Œæ‰€ä»¥å¹¶æœªå‡ºç°å‘åŠµé‡å¤çš„æƒ…å†µã€‚æœ€ç»ˆ250ä¸ªUIDséƒ½æˆåŠŸçš„å®Œæˆäº†è¡¥å‘ã€‚ è§£å†³æ–¹æ¡ˆï¼š è¿è¥äººå‘˜æ¯æ¬¡ä¸Šä¼ å°‘é‡UIDsï¼Œä¿è¯å“åº”æ—¶é—´å°äº60ç§’ã€‚ äº§å“ç»ç†æå‡ºè¿­ä»£éœ€æ±‚ï¼Œç‰ˆæœ¬å‡çº§ã€‚ å€¼å¾—æ€è€ƒçš„é—®é¢˜äº§å“ç»ç†æå‡ºéœ€æ±‚æ—¶ï¼Œè¯´è¦ç®€åŒ–å¼€å‘ï¼Œè®¾è®¡è½»é‡åŒ–ç­‰ã€‚ä½†æˆ‘ä»¬ä½œä¸ºJavaå¼€å‘å·¥ç¨‹å¸ˆï¼Œæˆ‘ä»¬ä¸èƒ½å’Œäº§å“ç»ç†æƒ³çš„ä¸€æ ·ï¼Œå°†ç³»ç»Ÿæƒ³çš„è¿‡äºç®€åŒ–ã€‚ä»ç„¶è¦ä»ä¸€ä¸ªç¨‹åºçš„è§’åº¦å‡ºå‘æ¥è€ƒè™‘é—®é¢˜ã€‚ ä»£ç å‡çº§æ–¹æ¡ˆæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨åŸç”Ÿå®‰å“é¡¹ç›®å¼€å‘ä¸­ï¼Œæ‰€æœ‰çš„ç½‘ç»œè¯·æ±‚éƒ½å¿…é¡»åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚ å®‰å“ä¸ºä»€ä¹ˆè¦è¿™æ ·é™åˆ¶å‘¢ï¼Ÿæˆ‘æƒ³ï¼Œå®‰å“ä¸€å®šæ˜¯è€ƒè™‘åˆ°æ‰€æœ‰çš„ç½‘ç»œè¯·æ±‚éƒ½æ˜¯æœ‰å¯èƒ½å‡ºç°è¶…æ—¶çš„ï¼Œå³ä½¿ç½‘ç»œè¯·æ±‚åªæ˜¯å»ç®€å•çš„è·å–ä¸€ä¸ªèµ„æºï¼Œä½†ä»å¯èƒ½ä¼šå‡ºç°ç½‘ç»œå»¶è¿Ÿçš„æƒ…å†µã€‚å¦‚æœåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä¸€æ—¦å‡ºç°å»¶è¿Ÿæˆ–è€…è¶…æ—¶ï¼Œç»™ç”¨æˆ·çš„æ„Ÿè§‰å°±æ˜¯ç•Œé¢å¡ä½ã€‚äºæ˜¯å®‰å“è¿›è¡Œäº†å¼‚æ­¥åŒ–è®¾è®¡ã€‚é™åˆ¶ç½‘ç»œè¯·æ±‚åªèƒ½åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚ å¯¹äºWebåº”ç”¨ç³»ç»Ÿï¼Œå¦‚æœæœ‰æ‰§è¡Œæ—¶é—´è¾ƒé•¿çš„è¯·æ±‚ï¼Œæˆ‘ä»¬ä¹Ÿè¦å°½é‡å°†å…¶æ”¾åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚é¿å…å› ä¸ºç­‰å¾…è¿œç¨‹æœåŠ¡çš„è¿”å›ï¼Œæˆ–è€…å¯¹æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œè€Œé˜»å¡ä¸»çº¿ç¨‹çš„æ‰§è¡Œï¼Œæµªè´¹å®è´µçš„è®¡ç®—èµ„æºï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚ è¿™æ¬¡çº¿ä¸Šäº‹æ•…çš„æ ¹æœ¬åŸå› å°±æ˜¯å¼€å‘ç»éªŒä¸è¶³ï¼Œè€ƒè™‘ä¸å‘¨ï¼Œä¸äº†è§£çº¿ä¸Šæƒ…å†µï¼Œæœªè¿›è¡Œå¼‚æ­¥åŒ–è®¾è®¡ã€‚ç”±äºä¸€æ¬¡è¯·æ±‚éœ€è¦è¡¥å‘è¾ƒå¤šçš„ç”¨æˆ·ï¼Œå¯¼è‡´ä¸€æ¬¡HTTPè¯·æ±‚è¿Ÿè¿Ÿæœªå®Œæˆä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ï¼ŒSLBæœåŠ¡å™¨è®¤ä¸ºè¯·æ±‚è¶…æ—¶ï¼Œè§¦å‘äº†é‡è¯•æœºåˆ¶ï¼Œå°†åŒæ ·çš„è¯·æ±‚æ‰“åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨ä¸Šã€‚ åœ¨Javaè¯­è¨€ä¸­ï¼ŒFutureæ¥å£ï¼Œå°¤å…¶æ˜¯å®ƒåœ¨Java 8ä¸­çš„æ–°ç‰ˆå®ç°CompletableFutureï¼Œæ˜¯è¿›è¡Œå¼‚æ­¥åŒ–è®¾è®¡çš„åˆ©å™¨ã€‚ Futureæ¥å£Futureæ¥å£åœ¨Java 5ä¸­è¢«å¼•å…¥ï¼Œè®¾è®¡åˆè¡·æ˜¯å¯¹å°†æ¥æŸä¸ªæ—¶åˆ»ä¼šå‘ç”Ÿçš„ç»“æœè¿›è¡Œå»ºæ¨¡ã€‚å®ƒå»ºæ¨¡äº†ä¸€ç§å¼‚æ­¥è®¡ç®—ï¼Œè¿”å›ä¸€ä¸ªæ‰§è¡Œè¿ç®—ç»“æœçš„å¼•ç”¨ï¼Œå½“è¿ç®—ç»“æŸåï¼Œè¿™ä¸ªå¼•ç”¨è¢«è¿”å›ç»™è°ƒç”¨æ–¹ã€‚åœ¨Futureä¸­è§¦å‘é‚£äº›æ½œåœ¨è€—æ—¶çš„æ“ä½œæŠŠè°ƒç”¨çº¿ç¨‹è§£æ”¾å‡ºæ¥ï¼Œè®©å®ƒèƒ½åŠæ—¶å“åº”å®¢æˆ·ç«¯æˆ–è€…ç»§ç»­æ‰§è¡Œå…¶å®ƒæœ‰ä»·å€¼çš„å·¥ä½œï¼Œä¸å†éœ€è¦å‘†å‘†çš„ç­‰åˆ°è€—æ—¶çš„æ“ä½œå®Œæˆã€‚ ä¸Šè¿°è¡¥å‘åŠµä¸šåŠ¡æœ€åˆçš„åŒæ­¥ä»£ç å¤§è‡´å¦‚ä¸‹ï¼ˆè€ƒè™‘ä¼ä¸šéšç§ï¼Œå±è”½å…³é”®è¯ï¼‰ï¼š ä¸šåŠ¡Serviceå±‚ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637/** * åŒæ­¥ åŠµè¡¥å‘æ“ä½œ * @param uIds ç”¨æˆ·UIDé›†åˆ * @param couponId ä¼˜æƒ åˆ¸ID * @return å¤±è´¥çš„ç”¨æˆ·UIDé›†åˆ */@Overridepublic List&lt;String&gt; syncReSupplyCoupon(List&lt;String&gt; uIds, String couponId) { List&lt;String&gt; result = new ArrayList&lt;&gt;(); List&lt;UserInfoModel&gt; userInfoModelList = new ArrayList&lt;&gt;(); // å¾ªç¯éªŒè¯UIDæœ‰æ•ˆæ€§ for (String uId : uIds) { // æŸ¥è¯¢UIDå¯¹åº”ç”¨æˆ·ä¿¡æ¯ UserInfoModel userInfoModel = reSupplyCouponService.queryUserInfo(uId); if (userInfoModel != null) { // UIDå­˜åœ¨ï¼Œæ”¾å…¥å¾…è¿›è¡Œè¡¥å‘ç”¨æˆ·é›†åˆ userInfoModelList.add(userInfoModel); } else { // UIDä¸å­˜åœ¨ï¼Œæ”¾å…¥è¿”å›ç»“æœé›†åˆ result.add(uId); } } // å¾ªç¯è¿›è¡ŒåŠµè¡¥å‘ for (UserInfoModel userInfoModel : userInfoModelList) { Boolean flag = false; try { flag = reSupplyCouponService.reSupplyCoupon(couponId,userInfoModel.getUid()); } catch (Exception e) { // å¼‚å¸¸å¤„ç† } if (!flag) { // è¡¥å‘åŠµå¤±è´¥ï¼Œæ”¾å…¥è¿”å›ç»“æœé›†åˆ result.add(userInfoModel.getUid()); } } return result;} åŸºç¡€Serviceå±‚ä»£ç ï¼š 1234567891011121314151617181920/** * æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ * @param uId ç”¨æˆ·UID * @return ç”¨æˆ·ä¿¡æ¯model */@Overridepublic UserInfoModel queryUserInfo(String uId) { return reSupplyCouponIntegration.queryUserInfo(uId);}/** * è¡¥å‘åŠµæ“ä½œ * @param couponId ä¼˜æƒ åˆ¸ID * @param uId ç”¨æˆ·ID * @return è¡¥å‘ç»“æœï¼šæˆåŠŸæˆ–å¤±è´¥ */@Overridepublic Boolean reSupplyCoupon(String couponId, String uId) { return reSupplyCouponIntegration.reSupplyCoupon(couponId,uId);} Integrationé˜²è…å±‚ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344private static List&lt;UserInfoModel&gt; users = new ArrayList&lt;&gt;();/** * åˆå§‹åŒ–æ“ä½œï¼Œæ¨¡æ‹Ÿè¿œç¨‹ç”¨æˆ·æ•°æ® */static { for (int i = 0; i &lt; 250; i++) { users.add(new UserInfoModel(String.valueOf(i))); }}/** * æ¨¡æ‹ŸæŸ¥æ‰¾ç”¨æˆ·æ“ä½œï¼Œä¸å­˜åœ¨åˆ™UIDåˆ™æ–°å¢ä¸€ä¸ªã€‚ * @param uId ç”¨æˆ·UID * @return ç”¨æˆ·ä¿¡æ¯model */@Overridepublic UserInfoModel queryUserInfo(String uId) { try { // æ¨¡æ‹Ÿè°ƒç”¨è¿œç¨‹æœåŠ¡è€—æ—¶ Thread.sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } return users.get(Integer.valueOf(uId));}/** * æ¨¡æ‹Ÿè¡¥å‘åŠµæ“ä½œ * @param couponId ä¼˜æƒ åˆ¸ID * @param uId ç”¨æˆ·id * @return è¡¥å‘åŠµç»“æœï¼šæˆåŠŸæˆ–å¤±è´¥ */@Overridepublic Boolean reSupplyCoupon(String couponId, String uId) { try { // æ¨¡æ‹Ÿè°ƒç”¨è¿œç¨‹æœåŠ¡è€—æ—¶ Thread.sleep(200); } catch (InterruptedException e) { e.printStackTrace(); } // æ¨¡æ‹ŸæˆåŠŸæˆ–å¤±è´¥æ¦‚ç‡ return new Random().nextInt(100) &lt; 90;} è¿™æ®µåŒæ­¥æ‰§è¡Œçš„ä»£ç ä¸­å­˜åœ¨çš„é—®é¢˜ï¼šåŒ…å«2ä¸ªforå¾ªç¯ä¸­é€šè¿‡RPCè°ƒç”¨è¿œç¨‹æœåŠ¡æä¾›æ–¹è¿›è¡Œæ•°æ®åº“æ“ä½œï¼Œå¦‚æœUIDé›†åˆæ•°æ®é‡è¾ƒå¤§ï¼Œè¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œæ—¶é—´æ˜¯éå¸¸é•¿çš„ï¼Œä¾‹å¦‚è¿™æ¬¡äº‹æ•…ä¸­è¿è¥äººå‘˜ä¸Šä¼ äº†250ä¸ªUIDï¼Œæ‰§è¡Œæ—¶é—´å°±èŠ±äº†2åˆ†é’Ÿå·¦å³ã€‚è€—æ—¶è¿‡é•¿ï¼ŒSLBè´Ÿè½½å‡è¡¡æœåŠ¡å™¨è®¤ä¸ºè¯·æ±‚è¶…æ—¶ï¼Œè¿›è¡Œé‡è¯•ã€‚ ä½¿ç”¨Futureæ¥å£è¿›è¡Œä»£ç å¼‚æ­¥åŒ–æ”¹é€ ï¼šå°†è€—æ—¶çš„æ“ä½œå°è£…åˆ°ä¸€ä¸ªCallableå¯¹è±¡ä¸­ï¼Œå†å°†å®ƒæäº¤ç»™ExecutorServiceçº¿ç¨‹æ± ã€‚ ä¸šåŠ¡Serviceå±‚ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364/** * åˆå§‹åŒ–çº¿ç¨‹æ±  */private static ExecutorService executorService = Executors.newCachedThreadPool();/** * å£°æ˜Future */private static Future&lt;List&lt;String&gt;&gt; future;/** * ä½¿ç”¨Callableå°è£…è€—æ—¶æ“ä½œ */class AsyncReSupplyCouponCallable implements Callable&lt;List&lt;String&gt;&gt; { // é€šè¿‡æ„é€ å‡½æ•°é—´æ¥ä¼ é€’å‚æ•°ç»™callæ–¹æ³• private List&lt;String&gt; uIds; private String couponId; public AsyncReSupplyCouponCallable(List&lt;String&gt; uIds, String couponId) { this.uIds = uIds; this.couponId = couponId; } @Override public List&lt;String&gt; call() throws Exception { // è°ƒç”¨åŒæ­¥çš„è¡¥å‘åŠµæ–¹æ³• return syncReSupplyCoupon(uIds,couponId); }}/** * å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ åŸºäºJDK 5çš„Futureæ¥å£ * @param uIds ç”¨æˆ·UIDé›†åˆ * @param couponId ä¼˜æƒ åˆ¸ID */@Overridepublic void asyncFutureReSupplyCoupon(List&lt;String&gt; uIds, String couponId) { future = executorService.submit(new AsyncReSupplyCouponCallable(uIds,couponId)); executorService.shutdown();} /** * è·å–è¡¥å‘åŠµå¤±è´¥çš„UIDsåœ¨å‰ç«¯æ˜¾ç¤º * ç”±å‰ç«¯æ§åˆ¶è°ƒç”¨è¯¥æ–¹æ³•çš„æ—¶æœº * æ ¹æ®ä¸Šä¼ çš„UIDsæ•°é‡åšè½®è¯¢ï¼Œæ—¶é—´å¯ä»¥è®¾ç½®ä¹…ä¸€ç‚¹ã€‚ * @return è¡¥å‘å¤±è´¥çš„UIDé›†åˆ */@Overridepublic List&lt;String&gt; getFailedUIDs() { List&lt;String&gt; result = new ArrayList&lt;&gt;(); try { if (future != null) { // å¦‚æœè°ƒç”¨getæ–¹æ³•æ—¶ï¼ŒCallableä¸­çš„ä»»åŠ¡è¿˜æœªæ‰§è¡Œå®Œï¼Œåˆ™çº¿ç¨‹é˜»å¡åœ¨è¿™é‡Œã€‚ // ä½¿ç”¨é‡è½½çš„getæ–¹æ³•è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º50ç§’ã€‚å¦‚æœå‘ç”Ÿé˜»å¡ï¼Œåˆ™æœ€å¤šç­‰å¾…50ç§’åé€€å‡ºã€‚ result = future.get(50, TimeUnit.SECONDS); } } catch (InterruptedException e) { // çº¿ç¨‹ç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­ } catch (ExecutionException e) { // è®¡ç®—æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ } catch (TimeoutException e) { // åœ¨Futureå¯¹è±¡å®Œæˆä¹‹å‰è¶…æ—¶å·²è¿‡æœŸ } return result;} å¼‚æ­¥åŒ–æ”¹é€ åŸºæœ¬å·²ç»å®Œæˆã€‚ä»¥ä¸Šä»£ç å·²ç»èƒ½å¤Ÿæœ‰æ•ˆé¿å…è¿™æ¬¡çº¿ä¸Šäº‹æ•…å†æ¬¡å‘ç”Ÿäº†ã€‚ æ¥å£æ€§èƒ½æå‡åŸºäºFutureæ¥å£çš„å¼‚æ­¥æ”¹é€ å·²ç»èƒ½å¤Ÿé¿å…äº‹æ•…å†æ¬¡å‘ç”Ÿï¼Œä½†æ˜¯è€—æ—¶çš„è¡¥å‘åŠµæ“ä½œåœ¨å­çº¿ç¨‹æ‰§è¡Œä»ç„¶æ˜¯åŒæ­¥çš„ã€‚å­çº¿ç¨‹ä¸­éªŒè¯åŒæ­¥æ‰§è¡ŒéªŒè¯250ä¸ªUIDsæ˜¯å¦åˆæ³•ï¼Œç»™250ä¸ªç”¨æˆ·è¡¥å‘åŠµã€‚è€—æ—¶ä»ç„¶å¾ˆé•¿ã€‚å¦‚ä½•æå‡æ¥å£çš„æ€§èƒ½å‘¢ï¼Ÿå¦‚æœè®©ä¸åŒçš„UIDä¹‹é—´çš„æ“ä½œå¹¶è¡Œï¼Œåˆ™å¯æ˜¾è‘—æå‡æ€§èƒ½ã€‚ æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Java 8çš„å¹¶è¡Œæµåˆ©ç”¨Java 8çš„å¹¶è¡Œæµé¿å…æ¯ä¸ªUIDçš„é¡ºåºæ‰§è¡Œã€‚ ä¸šåŠ¡Serviceå±‚ä»£ç ï¼š 123456789101112131415161718192021222324252627282930/** * ä½¿ç”¨å¹¶è¡Œæµ è¡¥å‘åŠµ * @param uIds ç”¨æˆ·UIDé›†åˆ * @param couponId ä¼˜æƒ åˆ¸ID * @return è¡¥å‘å¤±è´¥çš„ç”¨æˆ·UIDsé›†åˆ */@Overridepublic List&lt;String&gt; parallelReSupplyCoupon(List&lt;String&gt; uIds, String couponId) { List&lt;String&gt; failUidList = new ArrayList&lt;&gt;(); // ä½¿ç”¨å¹¶è¡ŒæµéªŒè¯UIDæ˜¯å¦åˆæ³•ï¼ŒæŒ‰æ˜¯å¦åˆæ³•è¿›è¡Œåˆ†åŒºï¼šä¸å­˜åœ¨çš„ä¸ºtrueåŒº Map&lt;Boolean, List&lt;UserInfoModel&gt;&gt; userInfoModelMap = uIds.parallelStream() .map(uId -&gt; reSupplyCouponService.queryUserInfo(uId)) .collect(Collectors.partitioningBy(Objects::isNull)); // å–å‡ºä¸åˆæ³•çš„UIDåŠ å…¥è¡¥å‘å¤±è´¥çš„é›†åˆä¸­ userInfoModelMap.get(true) .parallelStream() .map(userInfoModel -&gt; failUidList.add(userInfoModel.getUid())) .collect(Collectors.toList()); // è§¦å‘ä¸­é—´æ“ä½œ // å–å‡ºåˆæ³•çš„UIDè¿›è¡Œè¡¥å‘åŠµæ“ä½œ List&lt;Map&lt;String, Object&gt;&gt; reSupplyCouponResult = userInfoModelMap.get(false) .parallelStream() .map(userInfoModel -&gt; reSupplyCouponService.reSupplyCouponWithUid(couponId, userInfoModel.getUid())) .collect(Collectors.toList()); // ä»è¡¥å‘åŠµç»“æœä¸­å–å‡ºè¡¥å‘å¤±è´¥çš„åŠ å…¥è¡¥å‘å¤±è´¥çš„é›†åˆä¸­ reSupplyCouponResult.parallelStream() .filter(map -&gt; !(Boolean) map.get(&quot;result&quot;)) .map(map -&gt; failUidList.add(String.valueOf(map.get(&quot;uId&quot;)))) .collect(Collectors.toList()); return failUidList;} åŸºç¡€Serviceå±‚ä¸­æ–°å¢æ¥å£ï¼š 1234567891011121314/** * è¡¥å‘åŠµæ“ä½œ * @param couponId ä¼˜æƒ åˆ¸ID * @param uId ç”¨æˆ·ID * @return [UID,&quot;æˆåŠŸæˆ–å¤±è´¥&quot;]ï¼Œè¿”å›å¯¹åº”UIDã€‚ */@Overridepublic Map&lt;String, Object&gt; reSupplyCouponWithUid(String couponId, String uId) { Map&lt;String,Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;uId&quot;,uId); Boolean result = reSupplyCouponIntegration.reSupplyCoupon(couponId,uId); map.put(&quot;result&quot;,result); return map;} æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Java 8çš„CompletableFutureæ¥å£åˆ©ç”¨Java 8çš„CompletableFutureæ¥å£å¼‚æ­¥åŒ–ã€‚æ¯ä¸€ä¸ªUIDçš„æ“ä½œä¹‹é—´éƒ½æ˜¯å¼‚æ­¥çš„ã€‚ éœ€è¦å¯¹æ‰€æœ‰çš„CompletableFutureå¯¹è±¡æ‰§è¡Œjoinæ“ä½œï¼Œä¸€ä¸ªä¸€ä¸ªç­‰å¾…å®ƒä»¬æ‰§è¡Œå®Œæ¯•ã€‚CompletableFutureç±»ä¸­çš„joinæ–¹æ³•å’ŒFutureæ¥å£ä¸­çš„getæ–¹æ³•æœ‰ç›¸åŒçš„å«ä¹‰ï¼Œå¹¶ä¸”ä¹Ÿå£°æ˜åœ¨Futureæ¥å£ä¸­ï¼Œå”¯ä¸€çš„ä¸åŒæ˜¯joinæ–¹æ³•ä¸ä¼šæŠ›å‡ºä»»ä½•æ£€æµ‹åˆ°çš„å¼‚å¸¸ã€‚æ‰€ä»¥ä¸ä¼šæ˜¾å¾—Lambdaè¡¨è¾¾å¼è¿‡äºè‡ƒè‚¿ã€‚ ä¸šåŠ¡Serviceå±‚ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637/** * å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ æ¯ä¸€ä¸ªUIDä¹‹é—´éƒ½æ˜¯å¼‚æ­¥çš„ åŸºäºJDK 8çš„CompletableFutureæ¥å£ * @param uIds * @param couponId * @return */@Overridepublic List&lt;String&gt; asyncCompletableFutureReSupplyCoupon(List&lt;String&gt; uIds, String couponId) { List&lt;String&gt; failUidList = new ArrayList&lt;&gt;(); // ä½¿ç”¨CompletableFutureå¼‚æ­¥æ“ä½œï¼šéªŒè¯UIDæ˜¯å¦å­˜åœ¨ç³»ç»Ÿä¸­ List&lt;CompletableFuture&lt;UserInfoModel&gt;&gt; list = uIds.stream() .map(uId -&gt; CompletableFuture.supplyAsync( () -&gt; reSupplyCouponService.queryUserInfo(uId)) ).collect(Collectors.toList()); // ç­‰å¾…æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œç»“æŸï¼Œåˆ†åŒºç­›é€‰å‡ºå­˜åœ¨çš„UIDså’Œä¸å­˜åœ¨çš„UIDs Map&lt;Boolean, List&lt;UserInfoModel&gt;&gt; joinMap = list.stream() .map(CompletableFuture::join) .collect(Collectors.partitioningBy(Objects::isNull)); // å°†ä¸å­˜åœ¨çš„UIDsåŠ å…¥è¡¥å‘å¤±è´¥çš„é›†åˆä¸­ joinMap.get(true) .stream() .map(userInfoModel -&gt; failUidList.add(userInfoModel.getUid())) .collect(Collectors.toList()); // ä½¿ç”¨CompletableFutureå¼‚æ­¥ç»™å­˜åœ¨çš„UIDsè¡¥å‘åŠµ List&lt;CompletableFuture&lt;Map&lt;String, Object&gt;&gt;&gt; reSupplyCouponResult = joinMap.get(false) .stream() .map(userInfoModel -&gt; CompletableFuture.supplyAsync( () -&gt; reSupplyCouponService.reSupplyCouponWithUid(couponId, userInfoModel.getUid())) ).collect(Collectors.toList()); // ç­‰å¾…æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œç»“æŸï¼Œç­›é€‰å‡ºè¡¥å‘åŠµå¤±è´¥çš„UIDså­˜å…¥è¿”å›ç»“æœé›†åˆä¸­ reSupplyCouponResult.stream() .map(CompletableFuture::join) .filter(r -&gt; !(Boolean) r.get(&quot;result&quot;)) .map(r -&gt; failUidList.add(String.valueOf(r.get(&quot;uId&quot;)))) .collect(Collectors.toList()); return failUidList;} æ¯”è¾ƒå¹¶è¡Œæµå’Œå¼‚æ­¥æ¥å£çš„å¿«æ…¢åˆå§‹åŒ–8ä¸ªUIDè¿›è¡Œæµ‹è¯•ã€‚ æµ‹è¯•ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940private static List&lt;String&gt; uIds = new ArrayList&lt;&gt;();/** * åˆå§‹åŒ–8ä¸ªUIDsï¼Œæ¨¡æ‹Ÿå¾…è¡¥å‘ç”¨æˆ· */static { for (int i = 0; i &lt; 8; i++) { uIds.add(String.valueOf(i)); }}/** * æµ‹è¯•ä½¿ç”¨Java 8çš„å¹¶è¡Œæµè¿›è¡Œçš„è¡¥å‘åŠµæ“ä½œ * * 8ä¸ªUID * done in 312msecs */@Testpublic void testParallelReSupplyCoupon() { long start = System.nanoTime(); List&lt;String&gt; failedUIDs = reSupplyCouponBizService.parallelReSupplyCoupon(uIds, &quot;1&quot;); long duration = (System.nanoTime() - start) / 1_000_000; System.out.println(&quot;done in &quot; + duration + &quot;msecs&quot;); failedUIDs.stream().forEach(System.out::println);}/** * æµ‹è¯• å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ æ¯ä¸€ä¸ªUIDä¹‹é—´éƒ½æ˜¯å¼‚æ­¥çš„ åŸºäºJDK 8çš„CompletableFutureæ¥å£ * * 8ä¸ªUID * done in 610msecs */@Testpublic void testAsyncCompletableFutureReSupplyCoupon() { long start = System.nanoTime(); List&lt;String&gt; failedUIDs = reSupplyCouponBizService.asyncCompletableFutureReSupplyCoupon(uIds, &quot;1&quot;); long duration = (System.nanoTime() - start) / 1_000_000; System.out.println(&quot;done in &quot; + duration + &quot;msecs&quot;); failedUIDs.stream().forEach(System.out::println);} ç»“æœè®©äººç›¸å½“å¤±æœ›ã€‚ä½¿ç”¨CompletableFutureæ–°æ¥å£çš„è€—æ—¶å¤§çº¦æ˜¯ä½¿ç”¨å¹¶è¡Œæµç‰ˆæœ¬çš„ä¸¤å€ã€‚éš¾é“è¿™ç§åœºæ™¯ä¸‹ä½¿ç”¨CompletableFutureçœŸçš„æ˜¯æµªè´¹æ—¶é—´å—ï¼Ÿä¹Ÿè®¸æˆ‘ä»¬æ¼æ‰äº†æŸäº›å¾ˆé‡è¦çš„ä¸œè¥¿ï¼Ÿæˆ‘ä»¬è¿è¡Œæµ‹è¯•ä»£ç çš„ç”µè„‘æ˜¯å¦è¶³ä»¥ä»¥å¹¶è¡Œæ–¹å¼è¿è¡Œ8ä¸ªçº¿ç¨‹ï¼Ÿ å¹¶è¡Œæµçš„ç‰ˆæœ¬è¿è¡Œçš„è¶³å¤Ÿå¿«ï¼Œé‚£æ˜¯å› ä¸ºå®ƒèƒ½å¹¶è¡Œçš„æ‰§è¡Œçš„8ä¸ªçº¿ç¨‹ï¼Œå®ƒèƒ½ä¸ºæ¯ä¸ªUIDçš„æ“ä½œåˆ†é…ä¸€ä¸ªçº¿ç¨‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœç°åœ¨æˆ‘ä»¬åˆå§‹åŒ–9ä¸ªUIDè¿›è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç»“æœï¼š 1234567å¹¶è¡Œæµç‰ˆæœ¬9ä¸ªUIDdone in 617msecså¼‚æ­¥æ¥å£ç‰ˆæœ¬9ä¸ªUIDdone in 611msecs å¹¶è¡Œæµç‰ˆæœ¬9ä¸ªUIDçš„æµ‹è¯•ç»“æœæ¯”ä¹‹å‰å¤§æ¦‚å¤šæ¶ˆè€—äº†3ç§’ï¼Œè¿™ä¸ªæ—¶é—´é—´éš”åˆšå¥½æ˜¯ä¸€æ¬¡æ¨¡æ‹Ÿè°ƒç”¨è¿œç¨‹æœåŠ¡æ¥å£çš„è€—æ—¶ã€‚å› ä¸ºå¯ä»¥å¹¶è¡Œè¿è¡Œçš„8ä¸ªçº¿ç¨‹å¼€å§‹éƒ½å¤„äºå·¥ä½œçŠ¶æ€ï¼Œéƒ½åœ¨å¯¹å‰8ä¸ªUIDè¿›è¡Œè¡¥å‘åŠµç­‰æ“ä½œã€‚ç¬¬9ä¸ªUIDçš„æ“ä½œåªèƒ½ç­‰åˆ°å‰é¢æŸä¸ªæ“ä½œå®Œæˆé‡Šæ”¾å‡ºç©ºé—²çº¿ç¨‹æ‰èƒ½ç»§ç»­ã€‚ å¼‚æ­¥æ¥å£ç‰ˆæœ¬çš„æµ‹è¯•ç»“æœå’Œå¹¶è¡Œæµç‰ˆæœ¬ç›¸å·®æ— å‡ ã€‚ç©¶å…¶åŸå› éƒ½ä¸€æ ·ï¼šå®ƒä»¬å†…éƒ¨é‡‡ç”¨çš„æ˜¯åŒæ ·çš„é€šç”¨çº¿ç¨‹æ± ï¼Œé»˜è®¤éƒ½ä½¿ç”¨å›ºå®šæ•°é‡çš„çº¿ç¨‹ï¼Œå…·ä½“çº¿ç¨‹æ•°å–å†³äºRuntime.getRuntime().availableProcessors()çš„è¿”å›å€¼ã€‚ç„¶è€Œï¼ŒCompletableFutureå…·æœ‰ä¸€å®šä¼˜åŠ¿ï¼Œå®ƒå¯ä»¥å®šåˆ¶æ‰§è¡Œå™¨ï¼Œè‡ªå®šä¹‰çº¿ç¨‹æ± çš„å¤§å°ã€‚è¿™æ˜¯å¹¶è¡ŒæµAPIæ— æ³•å®ç°çš„ã€‚ å®šåˆ¶å¼‚æ­¥æ¥å£çš„æ‰§è¡Œå™¨åˆ›å»ºä¸€ä¸ªé…æœ‰çº¿ç¨‹æ± çš„æ‰§è¡Œå™¨å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯æˆ‘ä»¬è¯¥å¦‚ä½•é€‰æ‹©åˆé€‚çš„çº¿ç¨‹æ•°ç›®å‘¢ï¼Ÿ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ä¹¦ä¸­ä»‹ç»åˆ°ï¼ŒBrian Goetzå’Œåˆè‘—è€…ä»¬ä¸ºçº¿ç¨‹æ± å¤§å°çš„ä¼˜åŒ–æä¾›äº†ä¸å°‘ä¸­è‚¯çš„å»ºè®®ã€‚è¿™éå¸¸é‡è¦ï¼Œå¦‚æœçº¿ç¨‹æ± ä¸­çº¿ç¨‹çš„æ•°é‡è¿‡å¤šï¼Œæœ€ç»ˆå®ƒä»¬ä¼šç«äº‰ç¨€ç¼ºçš„å¤„ç†å™¨å’Œå†…å­˜èµ„æºï¼Œæµªè´¹å¤§é‡çš„æ—¶é—´åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢ä¸Šã€‚åä¹‹ï¼Œå¦‚æœçº¿ç¨‹çš„æ•°ç›®è¿‡å°‘ï¼Œæ­£å¦‚ä½ çš„åº”ç”¨æ‰€é¢ä¸´çš„æƒ…å†µï¼Œå¤„ç†å™¨çš„ä¸€äº›æ ¸å¯èƒ½å°±æ— æ³•å……åˆ†åˆ©ç”¨ã€‚Brian Goetzå»ºè®®ï¼Œçº¿ç¨‹æ± å¤§å°ä¸å¤„ç†å™¨çš„åˆ©ç”¨ç‡ä¹‹æ¯”å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å…¬å¼è¿›è¡Œä¼°ç®—ï¼šNthreads = NCPU * UCPU * (1 + W/C)å…¶ä¸­ï¼š Nthreadsæ˜¯å¤„ç†å™¨çš„æ ¸çš„æ•°ç›®ï¼Œå¯ä»¥é€šè¿‡Runtime.getRuntime().availableProcessors()å¾—åˆ°ï¼› UCPUæ˜¯æœŸæœ›çš„CPUåˆ©ç”¨ç‡ï¼ˆè¯¥å€¼åº”è¯¥ä»‹äº0å’Œ1ä¹‹é—´ï¼‰ W/Cæ˜¯ç­‰å¾…æ—¶é—´ä¸è®¡ç®—æ—¶é—´çš„æ¯”ç‡ è¡¥å‘åŠµæ¥å£99%çš„æ—¶é—´éƒ½åœ¨ç­‰å¾…è¿œç¨‹æœåŠ¡çš„å“åº”ï¼Œæ‰€ä»¥ä¼°ç®—å‡ºçš„W/Cçš„æ¯”ç‡ä¸º100ã€‚å¦‚æœæœŸæœ›çš„CPUåˆ©ç”¨ç‡ä¸º100%ï¼Œåˆ™éœ€è¦åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰800ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚ä½†å®é™…ä¸Šï¼Œçº¿ç¨‹æ± ä¸­çš„æœ‰äº›çº¿ç¨‹æ ¹æœ¬æ²¡æœºä¼šè¢«ä½¿ç”¨ï¼Œåè€Œæ˜¯ä¸€ç§æµªè´¹ã€‚æ‰€ä»¥å»ºè®®å°†æ‰§è¡Œå™¨ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼Œä¸å®é™…éœ€è¦çš„çº¿ç¨‹æ•°ï¼ˆUIDsçš„æ•°é‡ï¼‰è®¾å®šä¸ºåŒæ ·çš„å€¼ã€‚è¿™æ ·æ¯ä¸ªUIDéƒ½å¯¹åº”ä¸€ä¸ªæœåŠ¡çº¿ç¨‹ã€‚ä½†æ˜¯ï¼Œå½“UIDsæ•°é‡è¿‡å¤§æ—¶ï¼Œè¿è¡Œä»£ç çš„æœºå™¨å¿…ç„¶ä¼šå› è¶…è´Ÿè·è€Œå´©æºƒï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯æœ‰ä¸€ä¸ªä¸Šé™ã€‚ ä¸šåŠ¡Serviceå±‚ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546/** * å®šåˆ¶æ‰§è¡Œå™¨-çº¿ç¨‹æ± å¤§å°ä¸ºUIDsçš„æ•°é‡ï¼šè®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå½“ç¨‹åºé€€å‡ºæ—¶ï¼Œçº¿ç¨‹ä¹Ÿä¼šè¢«å›æ”¶ã€‚ */private final Executor executor = Executors.newFixedThreadPool(125, r -&gt; { Thread t = new Thread(r); t.setDaemon(true); return t;});/** * å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ å®šåˆ¶CompletableFutureæ¥å£çš„æ‰§è¡Œå™¨ * @param uIds ç”¨æˆ·UIDé›†åˆ * @param couponId ä¼˜æƒ åˆ¸ID * @return è¡¥å‘å¤±è´¥çš„ç”¨æˆ·UIDé›†åˆ */@Overridepublic List&lt;String&gt; asyncCompletableFutureCustomExecutorReSupplyCoupon(List&lt;String&gt; uIds, String couponId) { List&lt;String&gt; failUidList = new ArrayList&lt;&gt;(); // ä½¿ç”¨å®šåˆ¶æ‰§è¡Œå™¨çš„CompletableFutureå¼‚æ­¥æ“ä½œï¼šéªŒè¯UIDæ˜¯å¦å­˜åœ¨ç³»ç»Ÿä¸­ List&lt;CompletableFuture&lt;UserInfoModel&gt;&gt; list = uIds.stream() .map(uId -&gt; CompletableFuture.supplyAsync( () -&gt; reSupplyCouponService.queryUserInfo(uId),executor) ).collect(Collectors.toList()); // ç­‰å¾…æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œç»“æŸï¼Œåˆ†åŒºç­›é€‰å‡ºå­˜åœ¨çš„UIDså’Œä¸å­˜åœ¨çš„UIDs Map&lt;Boolean, List&lt;UserInfoModel&gt;&gt; joinMap = list.stream() .map(CompletableFuture::join) .collect(Collectors.partitioningBy(Objects::isNull)); // å°†ä¸å­˜åœ¨çš„UIDsåŠ å…¥è¡¥å‘å¤±è´¥çš„é›†åˆä¸­ joinMap.get(true) .stream() .map(userInfoModel -&gt; failUidList.add(userInfoModel.getUid())) .collect(Collectors.toList()); // ä½¿ç”¨å®šåˆ¶æ‰§è¡Œå™¨çš„CompletableFutureå¼‚æ­¥ç»™å­˜åœ¨çš„UIDsè¡¥å‘åŠµ List&lt;CompletableFuture&lt;Map&lt;String, Object&gt;&gt;&gt; reSupplyCouponResult = joinMap.get(false) .stream() .map(userInfoModel -&gt; CompletableFuture.supplyAsync( () -&gt; reSupplyCouponService.reSupplyCouponWithUid(couponId, userInfoModel.getUid()),executor) ).collect(Collectors.toList()); // ç­‰å¾…æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œç»“æŸï¼Œç­›é€‰å‡ºè¡¥å‘åŠµå¤±è´¥çš„UIDså­˜å…¥è¿”å›ç»“æœé›†åˆä¸­ reSupplyCouponResult.stream() .map(CompletableFuture::join) .filter(r -&gt; !(Boolean) r.get(&quot;result&quot;)) .map(r -&gt; failUidList.add(String.valueOf(r.get(&quot;uId&quot;)))) .collect(Collectors.toList()); return failUidList;} ä½¿ç”¨125ä¸ªUIDè¿›è¡Œæµ‹è¯•ï¼š 12345678910111213141516171819202122232425private static List&lt;String&gt; uIds = new ArrayList&lt;&gt;();/** * åˆå§‹åŒ–æ“ä½œï¼Œæ¨¡æ‹Ÿå¾…è¡¥å‘ç”¨æˆ· */static { for (int i = 0; i &lt; 125; i++) { uIds.add(String.valueOf(i)); }}/** * æµ‹è¯• å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ å®šåˆ¶CompletableFutureæ¥å£çš„æ‰§è¡Œå™¨ * * 125ä¸ªUID * done in 369msecs */@Testpublic void testAsyncCompletableFutureCustomExecutorReSupplyCoupon() { long start = System.nanoTime(); List&lt;String&gt; failedUIDs = reSupplyCouponBizService.asyncCompletableFutureCustomExecutorReSupplyCoupon(uIds, &quot;1&quot;); long duration = (System.nanoTime() - start) / 1_000_000; System.out.println(&quot;done in &quot; + duration + &quot;msecs&quot;); failedUIDs.stream().forEach(System.out::println);} æµ‹è¯•ç»“æœï¼šdone in 369msecsï¼Œæ˜¾è€Œæ˜“è§ï¼Œè€—æ—¶å’Œ8ä¸ªUIDçš„å¹¶è¡Œæµç‰ˆæœ¬å¾ˆæ¥è¿‘ã€‚æ€§èƒ½æ˜¾è‘—æå‡ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œéšç€UIDæ•°é‡ç»§ç»­å¢å¤šï¼Œè€—æ—¶ä¸ä¼šç›¸å·®å¤ªå¤šï¼Œç›´åˆ°è¾¾åˆ°ä¹‹å‰è®¡ç®—çš„é˜ˆå€¼800ï¼ˆCPUåˆ©ç”¨ç‡è¾¾åˆ°100%ï¼‰ã€‚ åœ¨å¹¶è¡Œæµå’ŒCompletableFutureä¹‹é—´è¿›è¡Œé€‰æ‹©å¹¶è¡Œæµåº•å±‚çš„Fork/Joinæ¡†æ¶ä½¿ç”¨é€šç”¨çš„çº¿ç¨‹æ± ï¼Œæ— æ³•ä¸ªæ€§åŒ–å®šåˆ¶ã€‚æ–°çš„CompletableFutureæ¥å£å¯ä»¥å®šåˆ¶æ‰§è¡Œå™¨ï¼Œè°ƒæ•´çº¿ç¨‹æ± å¤§å°ï¼Œèƒ½å¤Ÿæ›´åŠ å……åˆ†çš„åˆ©ç”¨CPUèµ„æºã€‚ å»ºè®®å¦‚ä¸‹ï¼š å¦‚æœä½ è¿›è¡Œçš„æ˜¯è®¡ç®—å¯†é›†å‹çš„æ“ä½œï¼Œå¹¶ä¸”æ²¡æœ‰I/Oï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨Streamæ¥å£ï¼Œå› ä¸ºå®ç°ç®€å•ï¼ŒåŒæ—¶æ•ˆç‡ä¹Ÿå¯èƒ½æ˜¯æœ€é«˜çš„ï¼ˆå¦‚æœæ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯è®¡ç®—å¯†é›†å‹çš„ï¼Œé‚£å°±æ²¡æœ‰å¿…è¦åˆ›å»ºæ¯”å¤„ç†å™¨æ ¸æ•°æ›´å¤šçš„çº¿ç¨‹ï¼‰ã€‚ åä¹‹ï¼Œå¦‚æœä½ å¹¶è¡Œçš„å·¥ä½œå•å…ƒè¿˜æ¶‰åŠç­‰å¾…I/Oçš„æ“ä½œï¼ˆåŒ…æ‹¬ç½‘ç»œè¿æ¥ç­‰å¾…ï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨CompletableFutureçµæ´»æ€§æ›´å¥½ï¼Œä½ å¯ä»¥åƒå‰æ–‡è®¨è®ºçš„é‚£æ ·ï¼Œä¾æ®ç­‰å¾…/è®¡ç®—ï¼Œæˆ–è€…W/Cçš„æ¯”ç‡è®¾å®šéœ€è¦ä½¿ç”¨çš„çº¿ç¨‹æ•°ã€‚è¿™ç§æƒ…å†µä¸ä½¿ç”¨å¹¶è¡Œæµçš„å¦ä¸€ä¸ªåŸå› æ˜¯ï¼Œå¤„ç†æµçš„æµæ°´çº¿ä¸­å¦‚æœå‘ç”ŸI/Oç­‰å¾…ï¼Œæµçš„å»¶è¿Ÿç‰¹æ€§ä¼šè®©æˆ‘ä»¬å¾ˆéš¾åˆ¤æ–­åˆ°åº•ä»€ä¹ˆæ—¶å€™è§¦å‘äº†ç­‰å¾…ã€‚ æ€»ç»“æ‰§è¡Œæ¯”è¾ƒè€—æ—¶çš„æ“ä½œæ—¶ï¼Œå°¤å…¶æ˜¯é‚£äº›ä¾èµ–ä¸€ä¸ªæˆ–å¤šä¸ªè¿œç¨‹æœåŠ¡çš„æ“ä½œï¼Œå»ºè®®è¿›è¡Œå¼‚æ­¥åŒ–è®¾è®¡ï¼Œä½¿ç”¨CompletableFutureç±»æä¾›çš„ç‰¹æ€§å¯è½»æ¾å®ç°å¼‚æ­¥APIã€‚","link":"/2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(3)/"},{"title":"ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆå››ï¼‰ï¼šä½¿ç”¨æ–°çš„æ—¥æœŸæ—¶é—´API","text":"ç¬¬åäºŒç« ï¼šæ–°çš„æ—¥æœŸæ—¶é—´APIåœ¨Java 8ä¹‹å‰ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ—¥æœŸæ—¶é—´APIæ˜¯java.util.Dateå’Œjava.util.Calendarè¿™ä¸¤ä¸ªç±»ã€‚ å¦‚æœæˆ‘ä»¬è¦æ„å»ºä¸€ä¸ªæŒ‡å®šå¹´æœˆæ—¥çš„æ—¥æœŸæ—¶é—´å¯¹è±¡ï¼Œæ¯”å¦‚2019-9-2ï¼Œä½¿ç”¨java.util.Dateç±»çš„æ„é€ æ–¹æ³•Date(int year, int month, int date)ï¼Œä¼ å…¥çš„å¹´ä»½yearå‚æ•°å¿…é¡»æ˜¯å¹´ä»½2019å‡å»1900ï¼Œå³ä¼ å…¥119ã€‚æ¯æ¬¡åˆ›å»ºå¯¹è±¡å‰è¿˜éœ€è¦å…ˆè¿›è¡Œè®¡ç®—ï¼Œå¾ˆä¸æ–¹ä¾¿ã€‚ JDK 1.1æä¾›çš„java.util.Calendarç±»åœ¨ä½¿ç”¨æ—¶ä¹Ÿæœ‰å¾ˆå¤šä¸æ–¹ä¾¿çš„åœ°æ–¹ï¼Œæ¯”å¦‚å¯¹ä¸€ä¸ªæ—¥æœŸåŠ ä¸¤å¤©ï¼Œä½¿ç”¨addæ–¹æ³•ï¼Œä¼ å…¥2ï¼›å¯¹ä¸€ä¸ªæ—¥æœŸå‡ä¸¤å¤©ï¼Œä¹Ÿä½¿ç”¨addæ–¹æ³•ï¼Œä¼ å…¥-2ã€‚è¿˜æœ‰ä¸€ç‚¹æ˜¯è¿™ä¸ªç±»é»˜è®¤æ¯å‘¨ç¬¬ä¸€å¤©æ˜¯å‘¨æ—¥ã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿæœ‰ç‚¹ä¸æ–¹ä¾¿ã€‚ å½’æ ¹åˆ°åº•ï¼ŒJDK1.8ä¹‹å‰çš„æ—¥æœŸæ—¶é—´APIéƒ½æ˜¯å¯å˜çš„ï¼Œæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚ å¦å¤–ï¼Œå¯¹æ—¶é—´æ—¥æœŸè¿›è¡Œæ ¼å¼åŒ–çš„ç±»SimpleDateFormatåœ¨java.textåŒ…ä¸‹ï¼Œè¯¥ç±»çš„å®šä¹‰ä½ç½®ä¸è§„èŒƒã€‚å®ƒä¹Ÿæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚ è€Œåœ¨Java 8ä¸­ï¼Œæ—¶é—´æ ¼å¼è½¬åŒ–å™¨æ˜¯java.time.format.DateTimeFormatterç±»ï¼Œå®ƒè¢«å£°æ˜ä¸ºfinalï¼Œæ˜¯ä¸å¯å˜çš„ç±»ï¼Œçº¿ç¨‹å®‰å…¨ã€‚ å¦å¤–ï¼ŒJava 8ä¸­æä¾›çš„æ–°æ—¥æœŸæ—¶é—´APIåŒ…å«ä¸¤ç±»ï¼šä¸€ä¸ªæ˜¯ä¸ºäº†ä¾¿äºäººé˜…è¯»ä½¿ç”¨ï¼ŒåŒ…å«LocalDateã€LocalTimeã€LocalDateTimeè¿™ä¸‰ä¸ªç±»ï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨finalä¿®é¥°çš„ç±»ï¼Œæ˜¯ä¸å¯å˜çš„å¯¹è±¡ï¼Œåˆ†åˆ«è¡¨ç¤ºISO-8601æ—¥å†ç³»ç»Ÿä¸­çš„æ—¥æœŸã€æ—¶é—´ã€æ—¥æœŸå’Œæ—¶é—´ã€‚å¦å¤–ä¸€ä¸ªæ˜¯ä¾¿äºæœºå™¨å¤„ç†çš„ç±»ï¼ŒInstantï¼šç”¨æ¥è¡¨ç¤ºæœºå™¨çš„æ—¥æœŸå’Œæ—¶é—´æ ¼å¼ï¼šæ—¶é—´æˆ³ã€‚ ISO-8601æ—¥å†ç³»ç»Ÿï¼šæ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡åˆ¶å®šçš„ç°ä»£å…¬æ°‘çš„æ—¥æœŸå’Œæ—¶é—´çš„è¡¨ç¤ºæ³•ã€‚æ—¶é—´æˆ³ï¼šä»UNIXå…ƒå¹´ï¼š1970å¹´1æœˆ1æ—¥ 00:00:00åˆ°æŸä¸ªæ—¶é—´ä¹‹é—´çš„æ¯«ç§’å€¼ã€‚ ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨SimpleDateFormatçº¿ç¨‹å®‰å…¨é—®é¢˜æ¼”ç¤ºå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œåŒä¸€ä¸ªSimpleDateFormatå¯¹è±¡æ—¶ï¼Œå°±ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ æ¼”ç¤ºä»£ç ï¼š 123456789101112131415161718public static void main(String[] args) { SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); // ä½¿ç”¨çº¿ç¨‹æ± æ¨¡æ‹Ÿå¤šçº¿ç¨‹ ExecutorService threadPool = Executors.newFixedThreadPool(10); // å®šä¹‰è§£ææ—¥æœŸå­—ç¬¦ä¸²ä»»åŠ¡ï¼šä½¿ç”¨SimpleDateFormatå¯¹è±¡è§£æ Callable&lt;Date&gt; task = () -&gt; sdf.parse(&quot;2019-8-29&quot;); // å­˜å‚¨ç»“æœå®¹å™¨ List&lt;Future&lt;Date&gt;&gt; result = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10; i++) { // æ‰§è¡Œå¾—åˆ°è§£æç»“æœ result.add(threadPool.submit(task)); } // éå†è¾“å‡º for (Future&lt;Date&gt; r : result) { System.out.println(r.get()); } threadPool.shutdown();} å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š 1Exception in thread &quot;main&quot; java.util.concurrent.ExecutionException: java.lang.NumberFormatException: multiple points è§£å†³æ–¹æ³•ï¼š1ã€å°†SimpleDateFormatå®šä¹‰ä¸ºæ–¹æ³•å†…çš„å±€éƒ¨å˜é‡ï¼Œä¸”æ–¹æ³•ä¸­æ²¡æœ‰å¤šçº¿ç¨‹çš„æ“ä½œã€‚2ã€ä½¿ç”¨ThreadLocalè¿›è¡Œçº¿ç¨‹å°é—­ã€‚ä¸ºæ¯ä¸ªçº¿ç¨‹ä¿å­˜ä¸€ä¸ªSimpleDateFormatå¯¹è±¡ã€‚ ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ThreadLocalè¿›è¡Œçº¿ç¨‹å°é—­çº¿ç¨‹å°é—­ç±»ä»£ç ï¼š 1234567891011121314151617181920212223package cn.org.lilu.chapter12;import java.text.DateFormat;import java.text.SimpleDateFormat;import java.util.Date;/** * @Auther: lilu * @Date: 2019/8/29 * @Description: ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ThreadLocalè¿›è¡Œçº¿ç¨‹å°é—­ */public class TraditionalSimpleDateFormatThreadLocal { private static final ThreadLocal&lt;DateFormat&gt; threadLocal = new ThreadLocal&lt;DateFormat&gt;() { @Override protected DateFormat initialValue() { return new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); } }; public static Date convert(String source) throws Exception { return threadLocal.get().parse(source); }} æ¼”ç¤ºä»£ç ï¼š 1234567891011121314151617public static void main(String[] args) throws Exception { // ä½¿ç”¨çº¿ç¨‹æ± æ¨¡æ‹Ÿå¤šçº¿ç¨‹ ExecutorService threadPool = Executors.newFixedThreadPool(10); // å®šä¹‰è§£ææ—¥æœŸå­—ç¬¦ä¸²ä»»åŠ¡ï¼šæ¯ä¸ªä»»åŠ¡éƒ½æœ‰ä¸€ä»½SimpleDateFormatå¯¹è±¡çš„å‰¯æœ¬ Callable&lt;Date&gt; task = () -&gt; TraditionalSimpleDateFormatThreadLocal.convert(&quot;2019-8-29&quot;); // è§£æç»“æœå®¹å™¨ List&lt;Future&lt;Date&gt;&gt; result = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10; i++) { // æ‰§è¡Œå¾—åˆ°è§£æç»“æœ result.add(threadPool.submit(task)); } // éå†è¾“å‡º for (Future&lt;Date&gt; r : result) { System.out.println(r.get()); } threadPool.shutdown();} è¿è¡Œç»“æœæ­£å¸¸ã€‚ Java 8æ–°çš„æ—¶é—´æ ¼å¼è½¬åŒ–å™¨DateTimeFormatterDateTimeFormatterç±»å®šä¹‰åœ¨java.time.formatåŒ…ä¸‹ï¼Œä¸”å£°æ˜ä¸ºfinalç±»ï¼Œä¸å¯å˜ï¼Œçº¿ç¨‹å®‰å…¨ã€‚ ä»£ç æ¼”ç¤ºï¼š 1234567891011121314151617public static void main(String[] args) throws Exception { // æŒ‰ç…§å“ªç§æ ¼å¼è¿›è¡Œæ ¼å¼è½¬æ¢ // DateTimeFormatter dtf = DateTimeFormatter.ISO_LOCAL_DATE; DateTimeFormatter dtf = DateTimeFormatter.ofPattern(&quot;yyyyMMdd&quot;); // LocalDate.parse(&quot;20190829&quot;,dtf)ï¼šå°†ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°æŒ‰ç…§ç¬¬äºŒä¸ªå‚æ•°å®šä¹‰çš„æ ¼å¼å™¨è§£æï¼Œè¿”å›ä¸€ä¸ªLocalDateå¯¹è±¡ Callable&lt;LocalDate&gt; task = () -&gt; LocalDate.parse(&quot;20190829&quot;,dtf); ExecutorService threadPool = Executors.newFixedThreadPool(10); List&lt;Future&lt;LocalDate&gt;&gt; result = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10; i++) { result.add(threadPool.submit(task)); } // éå†è¾“å‡º for (Future&lt;LocalDate&gt; r : result) { System.out.println(r.get()); } threadPool.shutdown();} Java 8æ—¥æœŸæ—¶é—´APIï¼šLocalDateã€LocalTimeã€LocalDateTimeè¿™ä¸‰ä¸ªç±»çš„ç”¨æ³•å‡ ä¹ä¸€æ ·ï¼ŒLocalDateè¡¨ç¤ºæ—¥æœŸï¼ŒLocalTimeè¡¨ç¤ºæ—¶é—´ï¼ŒLocalDateTimeåŒ…å«å‰ä¸¤è€…ï¼Œè¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´ã€‚ å¯ç”±å‰ä¸¤ä¸ªç±»ç»„åˆå‡ºç¬¬ä¸‰ä¸ªç±»ï¼Œä¹Ÿå¯ç”±ç¬¬ä¸‰ä¸ªç±»æå–å‡ºå‰ä¸¤ä¸ªç±»ã€‚ å¹´æœˆæ—¥å¯¹è±¡ï¼šLocalDateå¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•nowè·å–å½“å‰æ—¥æœŸï¼› å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•ofåˆ›å»ºä¸€ä¸ªLocalDateæ—¥æœŸå¯¹è±¡ï¼Œå¯ä»ä¸€ä¸ªLocalDateæ—¥æœŸå¯¹è±¡ä¸­è·å–è¯¥æ—¥æœŸçš„å¹´ä»½ã€æœˆä»½ã€è¿™ä¸ªæœˆçš„ç¬¬å‡ å¤©ã€è¿™å‘¨çš„æ˜ŸæœŸå‡ ã€ä»Šå¹´çš„ç¬¬å‡ å¤©ã€è¿™ä¸ªæœˆçš„é•¿åº¦ï¼ˆæœ‰å‡ å¤©ï¼‰å’Œæ˜¯å¦ä¸ºé—°å¹´ç­‰ä¿¡æ¯ã€‚ ä»£ç æ¼”ç¤ºï¼š 1234567891011121314151617181920212223242526272829303132/** * LocalDateï¼šå¹´æœˆæ—¥ */@Testpublic void testLocalDate() { // é™æ€å·¥å‚æ–¹æ³•nowè·å–å½“å‰æ—¥æœŸ LocalDate now = LocalDate.now(); // é™æ€å·¥å‚æ–¹æ³•ofåˆ›å»ºä¸€ä¸ªLocalDateå®ä¾‹ LocalDate date = LocalDate.of(2019,8,26); // å¹´ä»½ int year = date.getYear(); // æœˆä»½ Month month = date.getMonth(); // è¿™ä¸ªæœˆç¬¬å‡ å¤© int dayOfMonth = date.getDayOfMonth(); // è¿™å‘¨æ˜ŸæœŸå‡  DayOfWeek dayOfWeek = date.getDayOfWeek(); // ä»Šå¹´ç¬¬å‡ å¤© int dayOfYear = date.getDayOfYear(); // è¿™ä¸ªæœˆçš„é•¿åº¦ï¼ˆæœ‰å‡ å¤©ï¼‰ int lengthOfMonth = date.lengthOfMonth(); // æ˜¯å¦é—°å¹´ boolean leapYear = date.isLeapYear(); System.out.println(now); // 2019-09-02 System.out.println(year); // 2019 System.out.println(month); // AUGUST System.out.println(dayOfMonth); // 26 System.out.println(dayOfWeek); // MONDAY System.out.println(dayOfYear); // 238 System.out.println(lengthOfMonth); // 31 System.out.println(leapYear); // false} æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalTimeå¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•nowè·å–å½“å‰æ—¶é—´çš„æ—¶åˆ†ç§’ï¼ˆåŒ…å«çº³ç§’ï¼‰ã€‚ å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•ofåˆ›å»ºä¸€ä¸ªLocalTimeæ—¶é—´å¯¹è±¡ï¼Œå¯ä»ä¸€ä¸ªLocalTimeæ—¶é—´å¯¹è±¡ä¸­è·å–è¯¥æ—¶é—´çš„æ—¶ã€åˆ†ã€ç§’å’Œçº³ç§’ç­‰ä¿¡æ¯ã€‚ ofæ–¹æ³•åŒ…å«ä¸‰ä¸ªé‡è½½ï¼Œæ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š 1234567891011121314151617181920/** * @param hour the hour-of-day to represent, from 0 to 23 * @param minute the minute-of-hour to represent, from 0 to 59 */public static LocalTime of(int hour, int minute);/** * @param hour the hour-of-day to represent, from 0 to 23 * @param minute the minute-of-hour to represent, from 0 to 59 * @param second the second-of-minute to represent, from 0 to 59 */public static LocalTime of(int hour, int minute, int second);/** * @param hour the hour-of-day to represent, from 0 to 23 * @param minute the minute-of-hour to represent, from 0 to 59 * @param second the second-of-minute to represent, from 0 to 59 * @param nanoOfSecond the nano-of-second to represent, from 0 to 999,999,999 */public static LocalTime of(int hour, int minute, int second, int nanoOfSecond); ä½¿ç”¨ä»£ç ç¤ºä¾‹ï¼š 12345678910111213141516171819202122/** * LocalTimeï¼šæ—¶åˆ†ç§’ * ä¸€å¤©ä¸­çš„æ—¶é—´ï¼Œæ¯”å¦‚ï¼š13:45:20ï¼Œå¯ä»¥ä½¿ç”¨LocalTimeç±»è¡¨ç¤º * å¯ä»¥ä½¿ç”¨ofé‡è½½çš„ä¸‰ä¸ªé™æ€å·¥å‚æ–¹æ³•åˆ›å»ºLocalTimeå®ä¾‹ * ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•æ¥æ”¶å°æ—¶å’Œåˆ†é’Ÿ * ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•åŒæ—¶è¿˜æ¥æ”¶ç§’ * ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•åŒæ—¶è¿˜æ¥æ”¶çº³ç§’ */@Testpublic void testLocalTime() { LocalTime now = LocalTime.now(); LocalTime localTime = LocalTime.of(13, 45, 20,1); int hour = localTime.getHour(); int minute = localTime.getMinute(); int second = localTime.getSecond(); int nano = localTime.getNano(); System.out.println(now); // 19:47:51.212 System.out.println(hour); // 13 System.out.println(minute); // 45 System.out.println(second); // 20 System.out.println(nano); // 1} æ—¥æœŸæ—¶é—´å­—ç¬¦ä¸²è§£æLocalDateå’ŒLocalTimeéƒ½å¯ä»¥é€šè¿‡è§£æä»£è¡¨å®ƒä»¬çš„å­—ç¬¦ä¸²åˆ›å»ºã€‚ä½¿ç”¨é™æ€æ–¹æ³•parseã€‚ä¸€æ—¦ä¼ é€’çš„å­—ç¬¦ä¸²å‚æ•°æ— æ³•è¢«è§£æä¸ºåˆæ³•çš„LocalDateæˆ–LocalTimeå¯¹è±¡ï¼Œè¿™ä¸¤ä¸ªparseæ–¹æ³•éƒ½ä¼šæŠ›å‡ºä¸€ä¸ªç»§æ‰¿è‡ªRuntimeExceptionçš„DateTimeParseExceptionå¼‚å¸¸ã€‚ ä»£ç ç¤ºä¾‹ï¼š 12345678910111213/** * LocalDateå’ŒLocalTimeéƒ½å¯ä»¥é€šè¿‡è§£æä»£è¡¨å®ƒä»¬çš„å­—ç¬¦ä¸²åˆ›å»ºã€‚ä½¿ç”¨é™æ€æ–¹æ³•parseã€‚ * ä¸€æ—¦ä¼ é€’çš„å­—ç¬¦ä¸²å‚æ•°æ— æ³•è¢«è§£æä¸ºåˆæ³•çš„LocalDateæˆ–LocalTimeå¯¹è±¡ï¼Œ * è¿™ä¸¤ä¸ªparseæ–¹æ³•éƒ½ä¼šæŠ›å‡ºä¸€ä¸ªç»§æ‰¿è‡ªRuntimeExceptionçš„DateTimeParseExceptionå¼‚å¸¸ã€‚ */@Testpublic void testParse() { // å°äº10çš„å¿…é¡»åœ¨å‰é¢è¡¥0ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ LocalDate localDate = LocalDate.parse(&quot;2019-08-26&quot;); LocalTime localTime = LocalTime.parse(&quot;13:45:20&quot;); System.out.println(localDate); System.out.println(localTime);} å¹´æœˆæ—¥æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalDateTimeå¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•nowè·å–å½“å‰æ—¶é—´çš„å¹´æœˆæ—¥æ—¶åˆ†ç§’çº³ç§’ï¼› å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•ofåˆ›å»ºä¸€ä¸ªLocalDateTimeæ—¥æœŸæ—¶é—´å¯¹è±¡ï¼› å¯ç”±LocalDateå’ŒLocalTimeç»„åˆå‡ºLocalDateTimeå¯¹è±¡ï¼› å¯ä»LocalDateTimeå¯¹è±¡ä¸­æå–å‡ºLocalDateå’ŒLocalTimeã€‚ ä»£ç ç¤ºä¾‹ï¼š 123456789101112131415161718192021222324252627/** * LocalDateTimeï¼šå¹´æœˆæ—¥æ—¶åˆ†ç§’ */@Testpublic void testLocalDateTime() { LocalDateTime localDateTime = LocalDateTime.now(); LocalDateTime localDateTime1 = LocalDateTime.of(2019, Month.AUGUST, 26, 10, 47, 20); LocalDate localDate = LocalDate.now(); LocalTime localTime = LocalTime.now(); // ç”±LocalDateå’ŒLocalTimeç»„åˆå‡ºLocalDateTime LocalDateTime localDateTime2 = LocalDateTime.of(localDate,localTime); LocalDateTime localDateTime3 = localDate.atTime(10,51,32); LocalDateTime localDateTime4 = localDate.atTime(localTime); LocalDateTime localDateTime5 = localTime.atDate(localDate); // ç”±LocalDateTimeæå–å‡ºLocalDateå’ŒLocalTime LocalDate localDateFromLocalDateTime = localDateTime2.toLocalDate(); LocalTime localTimeFromLocalDateTime = localDateTime2.toLocalTime(); System.out.println(localDateTime); // 2019-09-02T19:57:16.516 System.out.println(localDateTime1); // 2019-08-26T10:47:20 System.out.println(localDateTime2); // 2019-09-02T19:57:16.517 System.out.println(localDateTime3); // 2019-09-02T10:51:32 System.out.println(localDateTime4); // 2019-09-02T19:57:16.517 System.out.println(localDateTime5); // 2019-09-02T19:57:16.517 System.out.println(localDateFromLocalDateTime); // 2019-09-02 System.out.println(localTimeFromLocalDateTime); // 19:57:16.517} æ—¶é—´æˆ³å¯¹è±¡ï¼šInstantæœºå™¨çš„æ—¥æœŸå’Œæ—¶é—´æ ¼å¼ï¼šä»UNIXå…ƒå¹´æ—¶é—´å¼€å§‹åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•°å¯¹æ—¶é—´è¿›è¡Œå»ºæ¨¡ã€‚åŒ…å«çš„æ˜¯ç”±ç§’åŠçº³ç§’ç»„æˆçš„æ•°å­—ã€‚ ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•nowè·å–å½“å‰æ—¶åˆ»çš„æ—¶é—´æˆ³ï¼Œé»˜è®¤è·å–çš„æ˜¯UTCæ—¶åŒºï¼ˆä¸–ç•Œåè°ƒæ—¶é—´ï¼‰æ‰€åœ¨çš„æ—¶åˆ»ï¼Œå¯åšæ—¶åŒºåç§»è¿ç®—è·å–å¸¦åç§»é‡çš„æ—¥æœŸæ—¶é—´å¯¹è±¡OffsetDateTimeã€‚å¯ä½¿ç”¨toEpochMilliæ–¹æ³•è·å–è¡¨ç¤ºçš„æ—¶é—´æˆ³ç§’æ•°ã€‚ å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•ofEpochSecondç­‰å¯¹æ—¶é—´æˆ³è¿›è¡Œè¿ç®—ã€‚ Instantçš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†ä¾¿äºæœºå™¨ä½¿ç”¨ã€‚å®ƒåŒ…å«çš„æ˜¯ç”±ç§’åŠçº³ç§’æ‰€æ„æˆçš„æ•°å­—ã€‚æ‰€ä»¥ï¼Œå®ƒæ— æ³•å¤„ç†é‚£äº›æˆ‘ä»¬éå¸¸å®¹æ˜“ç†è§£çš„æ—¶é—´å•ä½ã€‚æ¯”å¦‚ä¸‹é¢è¿™è¡Œä»£ç ï¼š 1int day = Instant.now().get(ChronoField.DAY_OF_MONTH); å®ƒä¼šæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸ï¼š 1java.time.temporal.UnsupportedTemporalTypeException: Unsupported field: DayOfMonth ç¤ºä¾‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233/** * Instantï¼šä»UNIXå…ƒå¹´æ—¶é—´å¼€å§‹åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•°å¯¹æ—¶é—´è¿›è¡Œå»ºæ¨¡ã€‚åŒ…å«çš„æ˜¯ç”±ç§’åŠçº³ç§’ç»„æˆçš„æ•°å­—ã€‚ * * é™æ€å·¥å‚æ–¹æ³•ï¼šofEpochSecondåŒ…å«ä¸¤ä¸ªé‡è½½ç‰ˆæœ¬ * // ä¼ å…¥ä¸€ä¸ªä»£è¡¨ç§’æ•°çš„å€¼åˆ›å»ºä¸€ä¸ªInstantå®ä¾‹ * Instant ofEpochSecond(long epochSecond) * // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šä»£è¡¨ç§’æ•°çš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼šçº³ç§’æ•°ï¼Œå¯¹ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„ç§’æ•°è¿›è¡Œè°ƒæ•´ï¼Œç¡®ä¿ä¿å­˜çš„çº³ç§’åˆ†ç‰‡åœ¨0åˆ°999 999 999ä¹‹é—´ã€‚ * Instant ofEpochSecond(long epochSecond, long nanoAdjustment) * * é™æ€å·¥å‚æ–¹æ³•ï¼šnow */@Testpublic void testInstant() { Instant instant1 = Instant.ofEpochSecond(3); Instant instant2 = Instant.ofEpochSecond(3, 0); Instant instant3 = Instant.ofEpochSecond(2, 1_000_000_000); Instant instant4 = Instant.ofEpochSecond(4, -1_000_000_000); System.out.println(instant1); System.out.println(instant2); System.out.println(instant3); System.out.println(instant4); Instant now = Instant.now(); // é»˜è®¤è·å–UTCæ—¶åŒºçš„æ—¶é—´ System.out.println(now); // æ—¶åŒºåç§»è¿ç®—ï¼šè·å–åç§»8å°æ—¶çš„æ—¶åŒºçš„æ—¶é—´ã€‚OffsetDateTimeï¼šå¸¦åç§»é‡çš„æ—¥æœŸæ—¶é—´å¯¹è±¡ OffsetDateTime offsetDateTime = now.atOffset(ZoneOffset.ofHours(8)); System.out.println(offsetDateTime); // è½¬åŒ–æˆæ—¶é—´æˆ³ System.out.println(now.toEpochMilli()); // java.time.temporal.UnsupportedTemporalTypeException: Unsupported field: DayOfMonth int day = now.get(ChronoField.DAY_OF_MONTH); System.out.println(day);} è®¡ç®—ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„é—´éš”ï¼šDuration å’Œè®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”ï¼šPeriodå¯ä»¥ä½¿ç”¨Durationç±»çš„é™æ€æ–¹æ³•betweenè®¡ç®—ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹é—´çš„é—´éš”ï¼Œbetweenæ–¹æ³•æ¥æ”¶çš„å‚æ•°æ˜¯ä¸¤ä¸ªTemporalå¯¹è±¡ï¼Œè™½ç„¶LocalDateTimeå’ŒInstantéƒ½æ˜¯Temporalæ¥å£çš„å®ç°ç±»ï¼Œä½†æ˜¯å®ƒä»¬æ˜¯ä¸ºä¸åŒçš„ç›®çš„è€Œè®¾è®¡çš„ï¼Œä¸€ä¸ªæ˜¯ä¸ºäº†ä¾¿äºäººé˜…è¯»ä½¿ç”¨ï¼Œ å¦ä¸€ä¸ªæ˜¯ä¸ºäº†ä¾¿äºæœºå™¨å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å°†å®ƒä»¬æ··ç”¨ï¼Œå³ä¸èƒ½è®¡ç®—LocalDateTimeå’ŒInstantå¯¹è±¡ä¹‹é—´çš„é—´éš”ã€‚ å¯ä»¥ä½¿ç”¨Periodç±»çš„é™æ€æ–¹æ³•betweenè®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”ã€‚ ä¹Ÿå¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•ç›´æ¥åˆ›å»ºDurationå’ŒPeriodç±»çš„å¯¹è±¡ã€‚ ç¤ºä¾‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334/** * è®¡ç®—ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„é—´éš”ï¼šDuration * è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”ï¼šPeriod */@Testpublic void testDuration() throws Exception { LocalTime localTime1 = LocalTime.parse(&quot;13:45:20&quot;); LocalTime localTime2 = LocalTime.parse(&quot;13:45:30&quot;); LocalDateTime localDateTime1 = LocalDateTime.now(); Thread.sleep(100); LocalDateTime localDateTime2 = LocalDateTime.now(); Instant instant1 = Instant.ofEpochSecond(3); Instant instant2 = Instant.ofEpochSecond(6); System.out.println(Duration.between(localTime1,localTime2)); // PT10S System.out.println(Duration.between(localDateTime1,localDateTime2)); // PT0.1S System.out.println(Duration.between(instant1,instant2)); // PT3S // è®¡ç®—ä¸¤ä¸ªLocalDateä¹‹é—´çš„æ—¶é•¿ Period periodBetween = Period.between(LocalDate.of(2019, 8, 26), LocalDate.of(2019, 8, 28)); System.out.println(periodBetween); // P1D System.out.println(periodBetween.getDays()); // 2 // Durationå’ŒPeriodçš„é™æ€å·¥å‚æ–¹æ³•ç›´æ¥åˆ›å»ºå®ä¾‹ Duration durationOfMinutes = Duration.ofMinutes(3); Duration durationOf = Duration.of(3, ChronoUnit.MINUTES); Period periodOfDays = Period.ofDays(10); Period periodOfWeeks = Period.ofWeeks(3); Period periodOf = Period.of(2, 6, 1); System.out.println(durationOfMinutes); // PT3M System.out.println(durationOf); // PT3M System.out.println(periodOfDays); // P10D System.out.println(periodOfWeeks); // P21D System.out.println(periodOf); // P2Y6M1D} æ“ä½œã€è§£æå’Œæ ¼å¼åŒ–æ—¥æœŸLocalDateã€LocalTimeã€LocalDateTimeä»¥åŠInstantè¿™æ ·è¡¨ç¤ºæ—¶é—´ç‚¹çš„æ—¥æœŸ-æ—¶é—´ç±»æä¾›äº†å¾ˆå¤šé€šç”¨çš„æ–¹æ³•ç”¨æ¥æ“ä½œæ—¥æœŸ-æ—¶é—´ã€‚æ‰€æœ‰çš„æ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªä¿®æ”¹äº†å±æ€§çš„å¯¹è±¡ã€‚å®ƒä»¬éƒ½ä¸ä¼šä¿®æ”¹åŸæ¥çš„å¯¹è±¡ã€‚ æœ€ç›´æ¥ä¹Ÿæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨â€withAttributeâ€œæ–¹æ³•ã€‚â€withAttributeâ€œæ–¹æ³•ä¼šåˆ›å»ºå¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œå¹¶æŒ‰ç…§éœ€è¦ä¿®æ”¹å®ƒçš„å±æ€§ã€‚ ä¹Ÿå¯ä½¿ç”¨é€šç”¨çš„withæ–¹æ³•ï¼Œå®ƒæ¥å—çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªTemporalFieldå¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯éœ€è¦ä¿®æ”¹çš„å€¼ã€‚ withæ–¹æ³•è¿˜æœ‰ä¸€ä¸ªé‡è½½çš„æ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ—¥æœŸè°ƒæ•´å™¨TemporalAdjusterå¯¹è±¡ï¼Œæ›´åŠ çµæ´»åœ°å¤„ç†æ—¥æœŸã€‚ ä»£ç ç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425/** * æ“çºµã€è§£æå’Œæ ¼å¼åŒ–æ—¥æœŸ * * LocalDateã€LocalTimeå’ŒLocalDateTimeç±»éƒ½ä¸ºfinalç±»ï¼Œä¸å¯å˜ï¼Œæ¯æ¬¡æ“ä½œåéƒ½è¿”å›ä¸€ä¸ªæ–°çš„å¯¹åº”å¯¹è±¡ */@Testpublic void testUpdateTime() { LocalDate date1 = LocalDate.of(2019, 8, 26); LocalDate date2 = date1.withYear(2020); LocalDate date3 = date2.withDayOfMonth(25); LocalDate date4 = date3.with(ChronoField.MONTH_OF_YEAR, 9); System.out.println(date1); // 2019-08-26 System.out.println(date2); // 2020-08-26 System.out.println(date3); // 2020-08-25 System.out.println(date4); // 2020-09-25 LocalDate date5 = LocalDate.of(2019,8,26); LocalDate date6 = date5.plusWeeks(1); // åŠ ä¸€å‘¨ LocalDate date7 = date6.minusYears(3); // å‡ä¸‰å¹´ LocalDate date8 = date7.plus(6, ChronoUnit.MONTHS); // åŠ å…­æœˆ System.out.println(date5); // 2019-08-26 System.out.println(date6); // 2019-09-02 System.out.println(date7); // 2016-09-02 System.out.println(date8); // 2017-03-02} æ—¥æœŸè°ƒæ•´å™¨ï¼šTemporalAdjusterTemporalAdjusteræ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œæ¥å£æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š 1Temporal adjustInto(Temporal temporal); æ¥æ”¶ä¸€ä¸ªTemporalå¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªTemporalå¯¹è±¡ã€‚ç”±äºæ‰€æœ‰çš„æ—¥æœŸæ—¶é—´APIéƒ½å®ç°äº†Temporalæ¥å£ï¼Œæ•…å®ƒå¯ä»¥ç”¨æ¥è‡ªå®šä¹‰æ›´åŠ å¤æ‚çš„æ—¥æœŸæ—¶é—´æ“ä½œã€‚ Java 8æä¾›äº†TemporalAdjustersç±»ï¼Œè¯¥ç±»é€šè¿‡é™æ€æ–¹æ³•æä¾›äº†å¤§é‡çš„å¸¸ç”¨TemporalAdjusterçš„å®ç°ã€‚ åŒæ—¶è¿˜æ”¯æŒå®šåˆ¶TemporalAdjusterï¼Œå®šåˆ¶çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š ä¸€ï¼šå®ç°TemporalAdjusteræ¥å£ï¼› äºŒï¼šä½¿ç”¨Lambdaè¡¨è¾¾å¼å®šåˆ¶TemporalAdjusterå¯¹è±¡ï¼Œæ¨èä½¿ç”¨TemporalAdjustersç±»çš„é™æ€å·¥å‚æ–¹æ³•ofDateAdjusterï¼Œè¯¥æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š 1public static TemporalAdjuster ofDateAdjuster(UnaryOperator&lt;LocalDate&gt; dateBasedAdjuster) æ¥æ”¶ä¸€ä¸ªUnaryOperatorå‡½æ•°å¼æ¥å£ï¼Œè¿”å›ä¸€ä¸ªTemporalAdjusterå¯¹è±¡ã€‚ UnaryOperatorå‡½æ•°å¼æ¥å£ä¸­æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼Œå®ƒæ€»æ˜¯è¿”å›å®ƒçš„è¾“å…¥ã€‚ 123static &lt;T&gt; UnaryOperator&lt;T&gt; identity() { return t -&gt; t;} ç›¸å…³ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101/** * æ—¥æœŸè°ƒæ•´å™¨ */@Testpublic void testTemporalAdjuster() { LocalDate date1 = LocalDate.of(2019,8,26); // TemporalAdjuster dayOfWeekInMonth(int ordinal, DayOfWeek dayOfWeek) // dayOfWeekè¡¨ç¤ºæ˜ŸæœŸå‡  // å¦‚æœordinalä¸º0ï¼Œåˆ™è¡¨ç¤ºæœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆçš„ä¸Šä¸€ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸå‡  // å¦‚æœordinalä¸ºæ­£æ•°ï¼Œåˆ™ä»¥æœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆä»å‰å‘åæ•°ï¼Œç¬¬ordinalä¸ªæ˜ŸæœŸå‡  // å¦‚æœordinalä¸ºè´Ÿæ•°ï¼Œåˆ™ä»¥æœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆä»åå¾€å‰æ•°ï¼Œç¬¬-ordinalä¸ªæ˜ŸæœŸå‡  LocalDate date2 = date1.with(TemporalAdjusters.dayOfWeekInMonth(1, DayOfWeek.FRIDAY)); System.out.println(&quot;date2=&quot; + date2); // TemporalAdjuster firstDayOfMonth()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºå½“æœˆçš„ç¬¬ä¸€å¤© LocalDate date3 = date1.with(TemporalAdjusters.firstDayOfMonth()); System.out.println(&quot;date3=&quot; + date3); // TemporalAdjuster firstDayOfNextMonth()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä¸‹æœˆçš„ç¬¬ä¸€å¤© LocalDate date4 = date1.with(TemporalAdjusters.firstDayOfNextMonth()); System.out.println(&quot;date4=&quot; + date4); // TemporalAdjuster firstDayOfNextYear()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºæ˜å¹´çš„ç¬¬ä¸€å¤© LocalDate date5 = date1.with(TemporalAdjusters.firstDayOfNextYear()); System.out.println(&quot;date5=&quot; + date5); // TemporalAdjuster firstDayOfYear()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä»Šå¹´çš„ç¬¬ä¸€å¤© LocalDate date6 = date1.with(TemporalAdjusters.firstDayOfYear()); System.out.println(&quot;date6=&quot; + date6); // TemporalAdjuster firstInMonth(DayOfWeek dayOfWeek)ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºåŒä¸€ä¸ªæœˆä¸­ï¼Œç¬¬ä¸€ä¸ªç¬¦åˆæ˜ŸæœŸå‡ è¦æ±‚çš„æ—¥æœŸï¼ˆè¿™ä¸ªæœˆçš„ç¬¬ä¸€ä¸ªæ˜ŸæœŸå‡ ï¼‰ LocalDate date7 = date1.with(TemporalAdjusters.firstInMonth(DayOfWeek.FRIDAY)); System.out.println(&quot;date7=&quot; + date7); // TemporalAdjuster lastDayOfMonth()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºè¿™ä¸ªæœˆçš„æœ€åä¸€å¤© LocalDate date8 = date1.with(TemporalAdjusters.lastDayOfMonth()); System.out.println(&quot;date8=&quot; + date8); // TemporalAdjuster lastDayOfYear()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä»Šå¹´çš„æœ€åä¸€å¤© LocalDate date9 = date1.with(TemporalAdjusters.lastDayOfYear()); System.out.println(&quot;date9=&quot; + date9); // TemporalAdjuster lastInMonth(DayOfWeek dayOfWeek)ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºåŒä¸€ä¸ªæœˆä¸­ï¼Œæœ€åä¸€ä¸ªç¬¦åˆæ˜ŸæœŸå‡ è¦æ±‚çš„æ—¥æœŸ LocalDate date10 = date1.with(TemporalAdjusters.lastInMonth(DayOfWeek.FRIDAY)); System.out.println(&quot;date10=&quot; + date10); // TemporalAdjuster next(DayOfWeek dayOfWeek)ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹åç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸ LocalDate date11 = date1.with(TemporalAdjusters.next(DayOfWeek.MONDAY)); System.out.println(&quot;date11=&quot; + date11); // TemporalAdjuster nextOrSame(DayOfWeek dayOfWeek)ï¼š // åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹åç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸï¼› // å¦‚æœæŒ‡å®šæ—¥æœŸå·²ç¬¦åˆè¦æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥æ—¥æœŸ LocalDate date12 = date1.with(TemporalAdjusters.nextOrSame(DayOfWeek.MONDAY)); System.out.println(&quot;date12=&quot; + date12); // TemporalAdjuster previous(DayOfWeek dayOfWeek)ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹å‰ç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸ LocalDate date13= date1.with(TemporalAdjusters.previous(DayOfWeek.MONDAY)); System.out.println(&quot;date13=&quot; + date13); // TemporalAdjuster previousOrSame(DayOfWeek dayOfWeek)ï¼š // åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹å‰ç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸï¼› // å¦‚æœæŒ‡å®šæ—¥æœŸå·²ç¬¦åˆè¦æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥æ—¥æœŸ LocalDate date14 = date1.with(TemporalAdjusters.previousOrSame(DayOfWeek.MONDAY)); System.out.println(&quot;date14=&quot; + date14); // ä½¿ç”¨Lambdaè¡¨è¾¾å¼å®šåˆ¶TemporalAdjusterå¯¹è±¡ï¼Œæ¨èä½¿ç”¨TemporalAdjustersç±»çš„é™æ€å·¥å‚æ–¹æ³•ofDateAdjuster // TemporalAdjuster ofDateAdjuster(UnaryOperator&lt;LocalDate&gt; dateBasedAdjuster) TemporalAdjuster nextWorkingDay = TemporalAdjusters.ofDateAdjuster(temporal -&gt; { DayOfWeek dayOfWeek = DayOfWeek.of(temporal.get(ChronoField.DAY_OF_WEEK)); int dayToAdd = 1; if (dayOfWeek == DayOfWeek.FRIDAY) dayToAdd = 3; else if (dayOfWeek == DayOfWeek.SATURDAY) dayToAdd = 2; return temporal.plus(dayToAdd,ChronoUnit.DAYS); });}/** * å®šåˆ¶TemporalAdjuster * * è®¡ç®—ä¸‹ä¸€ä¸ªå·¥ä½œæ—¥ */class NextWorkingDay implements TemporalAdjuster { /** * å‘¨ä¸€åˆ°å‘¨äº”ä¸ºå·¥ä½œæ—¥ * å¦‚æœæ˜¯å‘¨æ—¥åˆ°å‘¨å››ï¼Œåˆ™è¿”å›ä¸‹ä¸€å¤© * å¦‚æœæ˜¯å‘¨äº”ã€å‘¨å…­ã€è¿”å›ä¸‹å‘¨å‘¨ä¸€ * @param temporal * @return */ @Override public Temporal adjustInto(Temporal temporal) { // å¾—åˆ°ä»Šå¤©æ˜ŸæœŸå‡  DayOfWeek dayOfWeek = DayOfWeek.of(temporal.get(ChronoField.DAY_OF_WEEK)); int dayToAdd = 1; if (dayOfWeek == DayOfWeek.FRIDAY) dayToAdd = 3; else if (dayOfWeek == DayOfWeek.SATURDAY) dayToAdd = 2; return temporal.plus(dayToAdd,ChronoUnit.DAYS); }} TemporalAdjustersç±»ä¸­åŒ…å«çš„å·¥å‚æ–¹æ³•åˆ—è¡¨ï¼š æ–¹æ³•ç­¾å æè¿° TemporalAdjuster dayOfWeekInMonth(int ordinal, DayOfWeek dayOfWeek) dayOfWeekè¡¨ç¤ºæ˜ŸæœŸå‡ å¦‚æœordinalä¸º0ï¼Œåˆ™è¡¨ç¤ºæœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆçš„ä¸Šä¸€ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸå‡ å¦‚æœordinalä¸ºæ­£æ•°ï¼Œåˆ™ä»¥æœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆä»å‰å‘åæ•°ï¼Œç¬¬ordinalä¸ªæ˜ŸæœŸå‡  å¦‚æœordinalä¸ºè´Ÿæ•°ï¼Œåˆ™ä»¥æœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆä»åå¾€å‰æ•°ï¼Œç¬¬-ordinalä¸ªæ˜ŸæœŸå‡  TemporalAdjuster firstDayOfMonth() åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºå½“æœˆçš„ç¬¬ä¸€å¤© TemporalAdjuster firstDayOfNextMonth() åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä¸‹æœˆçš„ç¬¬ä¸€å¤© TemporalAdjuster firstDayOfNextYear() åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºæ˜å¹´çš„ç¬¬ä¸€å¤© TemporalAdjuster firstDayOfYear() åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä»Šå¹´çš„ç¬¬ä¸€å¤© TemporalAdjuster firstInMonth(DayOfWeek dayOfWeek) åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºåŒä¸€ä¸ªæœˆä¸­ï¼Œç¬¬ä¸€ä¸ªç¬¦åˆæ˜ŸæœŸå‡ è¦æ±‚çš„æ—¥æœŸï¼ˆè¿™ä¸ªæœˆçš„ç¬¬ä¸€ä¸ªæ˜ŸæœŸå‡ ï¼‰ TemporalAdjuster lastDayOfMonth() åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºè¿™ä¸ªæœˆçš„æœ€åä¸€å¤© TemporalAdjuster lastDayOfYear() åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä»Šå¹´çš„æœ€åä¸€å¤© TemporalAdjuster lastInMonth(DayOfWeek dayOfWeek) åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºåŒä¸€ä¸ªæœˆä¸­ï¼Œæœ€åä¸€ä¸ªç¬¦åˆæ˜ŸæœŸå‡ è¦æ±‚çš„æ—¥æœŸ TemporalAdjuster next(DayOfWeek dayOfWeek) åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹åç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸ TemporalAdjuster nextOrSame(DayOfWeek dayOfWeek) åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹åç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸï¼›å¦‚æœæŒ‡å®šæ—¥æœŸå·²ç¬¦åˆè¦æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥æ—¥æœŸ TemporalAdjuster previous(DayOfWeek dayOfWeek) åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹å‰ç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸ TemporalAdjuster previousOrSame(DayOfWeek dayOfWeek) åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹å‰ç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸï¼›å¦‚æœæŒ‡å®šæ—¥æœŸå·²ç¬¦åˆè¦æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥æ—¥æœŸ æ—¶åŒºæ—¶åŒºçš„å¤„ç†æ˜¯æ–°ç‰ˆæ—¥æœŸå’Œæ—¶é—´APIæ–°å¢åŠ çš„é‡è¦åŠŸèƒ½ï¼Œä½¿ç”¨æ–°ç‰ˆæ—¥æœŸå’Œæ—¶é—´APIæ—¶åŒºçš„å¤„ç†è¢«æå¤§åœ°ç®€åŒ–äº†ã€‚æ–°çš„java.time.ZoneIdç±»æ˜¯è€ç‰ˆjava.util.TimeZoneçš„æ›¿ä»£å“ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡å°±æ˜¯è¦è®©ä½ æ— éœ€ä¸ºæ—¶åŒºå¤„ç†çš„å¤æ‚å’Œç¹çè€Œæ“å¿ƒï¼Œè·Ÿå…¶ä»–æ—¥æœŸå’Œæ—¶é—´ç±»ä¸€ æ ·ï¼ŒZoneIdç±»ä¹Ÿæ˜¯è¢«finalä¿®é¥°è€Œæ— æ³•ä¿®æ”¹çš„ã€‚ ä»£ç ç¤ºä¾‹ï¼š 123456789101112131415161718/** * å¸¦æ—¶åŒºçš„æ—¥æœŸæ—¶é—´API */@Testpublic void testZoneLocalDateTime() { // æŸ¥çœ‹æ‰€æœ‰æ”¯æŒçš„æ—¶åŒº Set&lt;String&gt; availableZoneIds = ZoneId.getAvailableZoneIds(); for (String s: availableZoneIds) { System.out.println(s); } // é€šè¿‡æ—¶åŒºæ„å»ºLocalDateTimeå¯¹è±¡ LocalDateTime localDateTimeNow = LocalDateTime.now(ZoneId.of(&quot;Asia/Shanghai&quot;)); // æŒ‡å®šæ—¶åŒºæ„å»ºå¸¦æ—¶åŒºçš„æ—¥æœŸæ—¶é—´å¯¹è±¡ ZonedDateTime zonedDateTime = localDateTimeNow.atZone(ZoneId.of(&quot;Asia/Shanghai&quot;)); System.out.println(localDateTimeNow); // 2019-09-03T10:35:25.677 // 2019-09-03T10:35:25.677+08:00[Asia/Shanghai] ä¸UTCæ—¶é—´ç›¸å·®8å°æ—¶ System.out.println(zonedDateTime);} æ—¥æœŸæ—¶é—´APIçš„éƒ¨åˆ†UMLå›¾ä»¥ä¸Šä»‹ç»çš„æ–°çš„æ—¥æœŸæ—¶é—´APIç›¸å…³ç±»çš„UMLå›¾å¦‚ä¸‹ï¼š ä¸‹é¢è¿™å¼ å›¾èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£LocaleDateã€ LocalTimeã€LocalDateTimeä»¥åŠZoneIdä¹‹é—´çš„å·®å¼‚ã€‚","link":"/2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(4)/"}],"tags":[{"name":"å¹´åº¦æ€»ç»“","slug":"å¹´åº¦æ€»ç»“","link":"/tags/%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/"},{"name":"Git","slug":"Git","link":"/tags/Git/"},{"name":"IntelliJ IDEA","slug":"IntelliJ-IDEA","link":"/tags/IntelliJ-IDEA/"},{"name":"JDK","slug":"JDK","link":"/tags/JDK/"},{"name":"Maven","slug":"Maven","link":"/tags/Maven/"},{"name":"Node.js","slug":"Node-js","link":"/tags/Node-js/"},{"name":"Windows10","slug":"Windows10","link":"/tags/Windows10/"},{"name":"é“¾è¡¨","slug":"é“¾è¡¨","link":"/tags/%E9%93%BE%E8%A1%A8/"},{"name":"MySQL","slug":"MySQL","link":"/tags/MySQL/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"GOF","slug":"GOF","link":"/tags/GOF/"},{"name":"Lombok","slug":"Lombok","link":"/tags/Lombok/"},{"name":"String","slug":"String","link":"/tags/String/"},{"name":"éšå¼è½¬æ¢","slug":"éšå¼è½¬æ¢","link":"/tags/%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2/"},{"name":"JVM","slug":"JVM","link":"/tags/JVM/"},{"name":"xxl-job","slug":"xxl-job","link":"/tags/xxl-job/"},{"name":"Docker","slug":"Docker","link":"/tags/Docker/"},{"name":"Nginx","slug":"Nginx","link":"/tags/Nginx/"},{"name":"Java8","slug":"Java8","link":"/tags/Java8/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","link":"/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"ç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—","slug":"ç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—","link":"/tags/%E7%A8%8B%E5%BA%8F%E5%91%98%E4%BB%A3%E7%A0%81%E9%9D%A2%E8%AF%95%E6%8C%87%E5%8D%97/"},{"name":"LeetCode","slug":"LeetCode","link":"/tags/LeetCode/"},{"name":"äº‘è®¾è®¡æ¨¡å¼","slug":"äº‘è®¾è®¡æ¨¡å¼","link":"/tags/%E4%BA%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"æ–¹æ³•é‡è½½","slug":"æ–¹æ³•é‡è½½","link":"/tags/%E6%96%B9%E6%B3%95%E9%87%8D%E8%BD%BD/"},{"name":"Apache ShardingSphere","slug":"Apache-ShardingSphere","link":"/tags/Apache-ShardingSphere/"}],"categories":[{"name":"å¹´åº¦æ€»ç»“","slug":"å¹´åº¦æ€»ç»“","link":"/categories/%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/"},{"name":"å®‰è£…é…ç½®","slug":"å®‰è£…é…ç½®","link":"/categories/%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","link":"/categories/%E7%AE%97%E6%B3%95/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","link":"/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"Java EE","slug":"Java-EE","link":"/categories/Java-EE/"},{"name":"JDKæºç è§£æ","slug":"JDKæºç è§£æ","link":"/categories/JDK%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"},{"name":"MySQL","slug":"æ•°æ®åº“/MySQL","link":"/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/"},{"name":"GOFè®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼/GOFè®¾è®¡æ¨¡å¼","link":"/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/GOF%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"Java SE","slug":"Java-SE","link":"/categories/Java-SE/"},{"name":"Lombok","slug":"Java-EE/Lombok","link":"/categories/Java-EE/Lombok/"},{"name":"JVM","slug":"JVM","link":"/categories/JVM/"},{"name":"ä¸­é—´ä»¶","slug":"ä¸­é—´ä»¶","link":"/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"},{"name":"è¿ç»´","slug":"è¿ç»´","link":"/categories/%E8%BF%90%E7%BB%B4/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","link":"/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","link":"/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"ç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—-ITåä¼ç®—æ³•ä¸æ•°æ®ç»“æ„æœ€ä¼˜è§£","slug":"ç®—æ³•/ç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—-ITåä¼ç®—æ³•ä¸æ•°æ®ç»“æ„æœ€ä¼˜è§£","link":"/categories/%E7%AE%97%E6%B3%95/%E7%A8%8B%E5%BA%8F%E5%91%98%E4%BB%A3%E7%A0%81%E9%9D%A2%E8%AF%95%E6%8C%87%E5%8D%97-IT%E5%90%8D%E4%BC%81%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%9C%80%E4%BC%98%E8%A7%A3/"},{"name":"LeetCode","slug":"ç®—æ³•/LeetCode","link":"/categories/%E7%AE%97%E6%B3%95/LeetCode/"},{"name":"è¡Œä¸ºå‹","slug":"è®¾è®¡æ¨¡å¼/GOFè®¾è®¡æ¨¡å¼/è¡Œä¸ºå‹","link":"/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/GOF%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B/"},{"name":"å®šæ—¶ä»»åŠ¡","slug":"ä¸­é—´ä»¶/å®šæ—¶ä»»åŠ¡","link":"/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/"},{"name":"Docker","slug":"è¿ç»´/Docker","link":"/categories/%E8%BF%90%E7%BB%B4/Docker/"},{"name":"Nginx","slug":"è¿ç»´/Nginx","link":"/categories/%E8%BF%90%E7%BB%B4/Nginx/"},{"name":"Java 8å®æˆ˜","slug":"è¯»ä¹¦ç¬”è®°/Java-8å®æˆ˜","link":"/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Java-8%E5%AE%9E%E6%88%98/"},{"name":"ç®€å•","slug":"ç®—æ³•/LeetCode/ç®€å•","link":"/categories/%E7%AE%97%E6%B3%95/LeetCode/%E7%AE%80%E5%8D%95/"},{"name":"é“¾è¡¨","slug":"ç®—æ³•/LeetCode/é“¾è¡¨","link":"/categories/%E7%AE%97%E6%B3%95/LeetCode/%E9%93%BE%E8%A1%A8/"},{"name":"äº‘è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼/äº‘è®¾è®¡æ¨¡å¼","link":"/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BA%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"Maven","slug":"Java-EE/Maven","link":"/categories/Java-EE/Maven/"},{"name":"åˆ†åº“åˆ†è¡¨","slug":"ä¸­é—´ä»¶/åˆ†åº“åˆ†è¡¨","link":"/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/"}]}