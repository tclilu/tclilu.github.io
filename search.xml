<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ğŸ¦‹åŸºäºButterflyä¸»é¢˜çš„ç¾åŒ–æ—¥è®°</title>
      <link href="2021/01/31/butterfly/"/>
      <url>2021/01/31/butterfly/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡åŸºäº<code>butterfly</code>ä¸»é¢˜<code>3.6.0</code>ç‰ˆæœ¬ä¿®æ”¹ã€‚</p><p>éƒ¨åˆ†ä¿®æ”¹æ— æ³•ä½¿ç”¨çº¯<code>css</code>æˆ–<code>JavaScript</code>å®ç°ï¼Œéœ€è¦ä¿®æ”¹åŸä¸»é¢˜çš„æºç ã€‚å¦‚æœåç»­éœ€è¦å‡çº§åŸä¸»é¢˜ï¼Œè¯·é‡æ–°ä¿®æ”¹ä¸€éã€‚</p><div class="note red icon simple"><i class="note-icon fas fa-fan"></i><p>æœ‰äº›ä¿®æ”¹å°±ç®—èƒ½ç”¨<code>JavaScript</code>å®ç°ï¼Œä¹Ÿä¸¥é‡å½±å“åŠ è½½é€Ÿåº¦ï¼Œæ‰€ä»¥è¿˜ä¸å¦‚ä¿®æ”¹åŸä¸»é¢˜çš„æºç ã€‚</p></div><p>ä¸ºé¿å…ä¿®æ”¹åœ°æ–¹è¿‡å¤šï¼Œå¯å°†è‡ªå®šä¹‰çš„<code>css</code>æ ·å¼å’Œ<code>js</code>è„šæœ¬åˆ†åˆ«æ”¾ç½®åœ¨åŒä¸€æ–‡ä»¶ä¸­ã€‚</p><p>åœ¨<code>/themes/butterfly/source/css/_global</code>ç›®å½•ä¸‹æ–°å»ºè‡ªå·±çš„<code>styl</code>æ ·å¼æ–‡ä»¶ï¼Œå–å<code>sunchaser.styl</code>ï¼Œ<code>index.styl</code>ä¸­å·²è‡ªåŠ¨å¼•å…¥ã€‚</p><p>åœ¨<code>/themes/butterfly/source/js</code>ç›®å½•ä¸‹æ–°å»ºè‡ªå·±çš„<code>js</code>è„šæœ¬æ–‡ä»¶ï¼Œå–å<code>sunchaser.js</code>ï¼Œç„¶ååœ¨<code>_config.butterfly.yml</code>ä¸­è¿›è¡Œ<code>inject</code>å¼•å…¥ã€‚</p><p>é…ç½®é¡¹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/sunchaser.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å»æ‰é¦–é¡µçš„å…¨å±å›¾ç‰‡"><a href="#å»æ‰é¦–é¡µçš„å…¨å±å›¾ç‰‡" class="headerlink" title="å»æ‰é¦–é¡µçš„å…¨å±å›¾ç‰‡"></a>å»æ‰é¦–é¡µçš„å…¨å±å›¾ç‰‡</h2><p>é¦–é¡µçš„å…¨å±å›¾ç‰‡å’Œ<code>subtitle</code>ï¼Œçœ‹ä¼¼å¾ˆç¾ï¼Œå´æ— å®é™…ä½œç”¨ã€‚ä¸ªäººè§‰å¾—ä½œä¸ºåšå®¢ç«™ï¼Œæ‰“å¼€çš„ç¬¬ä¸€å±åº”è¯¥å±•ç°çš„æ˜¯ä¼˜è´¨çš„æ–‡ç« ã€‚</p><p>åœ¨<code>3.6.0</code>ç‰ˆæœ¬ä¹‹å‰ï¼ŒåŸä¸»é¢˜æ²¡æœ‰å…³é—­é¦–é¡µå…¨å±å›¾ç‰‡çš„é…ç½®é¡¹ã€‚è¯¥åŠŸèƒ½ä¸º<code>3.6.0</code>ç‰ˆæœ¬æ–°å¢ã€‚</p><div class="tabs" id="topimg"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#topimg-1">version<3.6.0</button></li><li class="tab active"><button type="button" data-href="#topimg-2">version=3.6.0</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="topimg-1"><p>ç‰ˆæœ¬å·å°äº<code>3.6.0</code></p><p>æ‰“å¼€<code>/themes/butterfly/layout/includes/header/index.pug</code>æ–‡ä»¶æ‰¾åˆ°ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- var isHomeClass &#x3D; is_home() ? &#39;full_page&#39; : &#39;not-index-bg&#39;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- var isHomeClass &#x3D; is_home() ? &#39;&#39; : &#39;not-index-bg&#39;</span><br></pre></td></tr></table></figure><p>å†åœ¨æ­¤æ–‡ä»¶ä¸­æ‰¾åˆ°ä»¥ä¸‹ä»£ç å¹¶å…¨éƒ¨æ³¨é‡Šæ‰ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;#site-info</span><br><span class="line">&#x2F;&#x2F;  h1#site-title&#x3D;site_title</span><br><span class="line">&#x2F;&#x2F;  #site-subtitle</span><br><span class="line">&#x2F;&#x2F;    span#subtitle</span><br><span class="line">&#x2F;&#x2F;  if(theme.social)</span><br><span class="line">&#x2F;&#x2F;    #site_social_icons</span><br><span class="line">&#x2F;&#x2F;      !&#x3D;fragment_cache(&#39;social&#39;, function()&#123;return partial(&#39;includes&#x2F;header&#x2F;social&#39;)&#125;)</span><br><span class="line">&#x2F;&#x2F;#scroll-down</span><br><span class="line">&#x2F;&#x2F;  i.fas.fa-angle-down.scroll-down-effects</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="topimg-2"><p>ç‰ˆæœ¬å·ç­‰äº<code>3.6.0</code></p><p>è‡ªå¸¦äº†é…ç½®é¡¹<code>disable_top_img</code>ï¼Œè®¾ç½®ä¸º<code>true</code>æ—¶æ— é¦–é¡µå…¨å±å¤§å›¾ã€‚</p><p>ä½†ä¼šå‘ç°å¯¼èˆªæ çš„èƒŒæ™¯é¢œè‰²å˜æˆäº†ç™½è‰²ä¸”å¸¦ä¸€ç‚¹é€æ˜ï¼Œæ–‡å­—å˜æˆäº†é»‘è‰²ã€‚è¿™ç‚¹çœ‹ä¸Šå»å¹¶ä¸æ˜¯å¾ˆç¾è§‚ã€‚æ‰€ä»¥è¿™é‡Œå¯ä»¥å°†èƒŒæ™¯é¢œè‰²ä¿®æ”¹ä¸ºé€æ˜è‰²ï¼Œæ–‡å­—ä¿®æ”¹ä¸ºç™½è‰²ã€‚</p><p>åœ¨<code>sunchaser.styl</code>æ ·å¼æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹æ ·å¼ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#page-header</span><br><span class="line">  &amp;.not-<span class="attribute">top</span>-img</span><br><span class="line">    #nav</span><br><span class="line">      <span class="attribute">background</span>: transparent !important</span><br><span class="line">      <span class="attribute">box-shadow</span>: none !important</span><br><span class="line">      a</span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#ffffff</span> !important</span><br><span class="line"></span><br><span class="line">#page-header</span><br><span class="line">  &amp;.nav-visible</span><br><span class="line">    #nav</span><br><span class="line">      background: rgba(255, 255, 255, .8) !important</span><br><span class="line">      a</span><br><span class="line">        <span class="attribute">color</span>: var(--font-color) !important</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>å…³æ‰é¦–é¡µå…¨å±å¤§å›¾åï¼Œä¼šå‘ç°æ•´ä¸ªåšå®¢å‘ˆç°ç™½è‰²èƒŒæ™¯ï¼Œå¦‚æœè§‰å¾—ä¸å¤Ÿç¾è§‚ï¼Œå¯åœ¨<code>_config.butterfly.yml</code>é…ç½®æ–‡ä»¶ä¸­å°†èƒŒæ™¯ä¿®æ”¹ä¸ºå›¾ç‰‡ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">background:</span> <span class="string">url(https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/lilu.org.cn/index_1.png)</span></span><br></pre></td></tr></table></figure><h2 id="å¯¼èˆªæ å±…å·¦ï¼Œæœç´¢æŒ‰é’®å±…å³ï¼Œä¸”åŠ ä¸Šæµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬åŒ–çš„icon"><a href="#å¯¼èˆªæ å±…å·¦ï¼Œæœç´¢æŒ‰é’®å±…å³ï¼Œä¸”åŠ ä¸Šæµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬åŒ–çš„icon" class="headerlink" title="å¯¼èˆªæ å±…å·¦ï¼Œæœç´¢æŒ‰é’®å±…å³ï¼Œä¸”åŠ ä¸Šæµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬åŒ–çš„icon"></a>å¯¼èˆªæ å±…å·¦ï¼Œæœç´¢æŒ‰é’®å±…å³ï¼Œä¸”åŠ ä¸Šæµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬åŒ–çš„<code>icon</code></h2><p>æ‰“å¼€<code>/themes/butterfly/layout/includes/header/nav.pug</code>æ–‡ä»¶ï¼Œä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">nav#nav</span><br><span class="line">  span#blog_name</span><br><span class="line">    a#site-name(href&#x3D;url_for(&#39;&#x2F;&#39;)) #[&#x3D;config.title]</span><br><span class="line">    span#menus</span><br><span class="line">      !&#x3D;fragment_cache(&#39;menus&#39;, function()&#123;return partial(&#39;includes&#x2F;header&#x2F;menu_item&#39;)&#125;)</span><br><span class="line">  .menus_items</span><br><span class="line">    if (theme.algolia_search.enable || theme.local_search.enable)</span><br><span class="line">      #search-button</span><br><span class="line">        a.site-page.social-icon.search</span><br><span class="line">          i.fas.fa-search.fa-fw</span><br><span class="line">          span&#x3D;&#39; &#39; + _p(&#39;search&#39;)</span><br><span class="line">    if theme.darkmode.enable &amp;&amp; theme.darkmode.button</span><br><span class="line">      div.button.mode-button#darkmode(type&#x3D;&quot;button&quot; title&#x3D;_p(&#39;rightside.night_mode_title&#39;))</span><br><span class="line">        a.site-page.social-icon</span><br><span class="line">          i.fas.fa-adjust.fa-fw</span><br><span class="line">        #toggle-menu</span><br><span class="line">          a.site-page</span><br><span class="line">            i.fas.fa-bars.fa-fw</span><br></pre></td></tr></table></figure><p>åœ¨<code>sunchaser.styl</code>æ ·å¼æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#nav</span><br><span class="line">  &amp;.hide-menu</span><br><span class="line">    #toggle-menu</span><br><span class="line">      <span class="attribute">float</span>: right</span><br><span class="line"></span><br><span class="line">  .mode-button</span><br><span class="line">    <span class="attribute">display</span>: inline</span><br><span class="line">    padding: 0 0 0 .7rem</span><br><span class="line"></span><br><span class="line">    <span class="comment">// iconä¸Šçš„aæ ‡ç­¾ä¸å…è®¸é€‰ä¸­</span></span><br><span class="line">    a</span><br><span class="line">      -webkit-user-select: <span class="attribute">none</span>;</span><br><span class="line">      -moz-user-select: <span class="attribute">none</span>;</span><br><span class="line">      -ms-user-select: <span class="attribute">none</span>;</span><br><span class="line">      user-select: <span class="attribute">none</span>;</span><br></pre></td></tr></table></figure><p>åœ¨<code>sunchaser.js</code>æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¯¼èˆªæ å¤œé—´æ¨¡å¼åˆ‡æ¢äº‹ä»¶</span></span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">&#x27;darkmode&#x27;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> nowMode = <span class="built_in">document</span>.documentElement.getAttribute(<span class="string">&#x27;data-theme&#x27;</span>) === <span class="string">&#x27;dark&#x27;</span> ? <span class="string">&#x27;dark&#x27;</span> : <span class="string">&#x27;light&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (nowMode === <span class="string">&#x27;light&#x27;</span>) &#123;</span><br><span class="line">            activateDarkMode();</span><br><span class="line">            saveToLocal.set(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;dark&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">            GLOBAL_CONFIG.Snackbar !== <span class="literal">undefined</span> &amp;&amp; btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            activateLightMode();</span><br><span class="line">            saveToLocal.set(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;light&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">            GLOBAL_CONFIG.Snackbar !== <span class="literal">undefined</span> &amp;&amp; btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// handle some cases</span></span><br><span class="line">        <span class="keyword">typeof</span> utterancesTheme === <span class="string">&#x27;function&#x27;</span> &amp;&amp; utterancesTheme();</span><br><span class="line">        <span class="keyword">typeof</span> FB === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="built_in">window</span>.loadFBComment();</span><br><span class="line">        <span class="built_in">window</span>.DISQUS &amp;&amp; <span class="built_in">document</span>.getElementById(<span class="string">&#x27;disqus_thread&#x27;</span>).children.length &amp;&amp; <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="built_in">window</span>.disqusReset(), <span class="number">200</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="æµè§ˆå™¨æ»šåŠ¨æ¡ç¾åŒ–"><a href="#æµè§ˆå™¨æ»šåŠ¨æ¡ç¾åŒ–" class="headerlink" title="æµè§ˆå™¨æ»šåŠ¨æ¡ç¾åŒ–"></a>æµè§ˆå™¨æ»šåŠ¨æ¡ç¾åŒ–</h2><p>åœ¨<code>sunchaser.styl</code>æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹æ ·å¼ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*::-webkit-scrollbar-thumb</span><br><span class="line">  <span class="attribute">background-image</span>: -webkit-linear-gradient( <span class="number">45deg</span>, rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span>) <span class="number">25%</span>, transparent <span class="number">25%</span>, transparent <span class="number">50%</span>, rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span>) <span class="number">50%</span>, rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span>) <span class="number">75%</span>, transparent <span class="number">75%</span>, transparent)</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">2em</span></span><br><span class="line"></span><br><span class="line">*::-webkit-scrollbar-corner</span><br><span class="line">  <span class="attribute">background-color</span>: transparent</span><br><span class="line"></span><br><span class="line">*::-moz-selection</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span></span><br><span class="line">  <span class="attribute">background-color</span>: var(--btn-bg)</span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–å³ä¾§å›ºå®šwidgetåœ¨å‘ä¸Šæ»šåŠ¨è¿‡ç¨‹ä¸­è¢«å¯¼èˆªæ é®ä½çš„æƒ…å†µ"><a href="#ä¼˜åŒ–å³ä¾§å›ºå®šwidgetåœ¨å‘ä¸Šæ»šåŠ¨è¿‡ç¨‹ä¸­è¢«å¯¼èˆªæ é®ä½çš„æƒ…å†µ" class="headerlink" title="ä¼˜åŒ–å³ä¾§å›ºå®šwidgetåœ¨å‘ä¸Šæ»šåŠ¨è¿‡ç¨‹ä¸­è¢«å¯¼èˆªæ é®ä½çš„æƒ…å†µ"></a>ä¼˜åŒ–å³ä¾§å›ºå®š<code>widget</code>åœ¨å‘ä¸Šæ»šåŠ¨è¿‡ç¨‹ä¸­è¢«å¯¼èˆªæ é®ä½çš„æƒ…å†µ</h2><p>æ­¤é—®é¢˜åœ¨<code>3.6.0</code>ç‰ˆæœ¬å·²ç»è¢«ä¿®å¤ï¼Œä½ç‰ˆæœ¬å¯æŒ‰ä»¥ä¸‹æ–¹å¼ä¿®æ”¹ã€‚</p><div class="tabs" id="widget"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#widget-1">æ–¹å¼ä¸€</button></li><li class="tab"><button type="button" data-href="#widget-2">æ–¹å¼äºŒ</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="widget-1"><p>æ‰“å¼€<code>/themes/butterfly/source/css/_layout/aside.styl</code>æ–‡ä»¶ä¸­ï¼Œæ‰¾åˆ°ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.sticky_layout</span><br><span class="line">  +minWidth900()</span><br><span class="line">    <span class="attribute">position</span>: sticky</span><br><span class="line">    <span class="attribute">position</span>: -webkit-sticky</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">20px</span></span><br></pre></td></tr></table></figure><p>å°†<code>top: 20px</code>ä¿®æ”¹ä¸º<code>top: 80px</code>ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="widget-2"><p>åœ¨<code>sunchaser.styl</code>æ ·å¼æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#aside-<span class="attribute">content</span></span><br><span class="line">  .sticky_layout</span><br><span class="line">    +minWidth900()</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">80px</span> !important</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="ä¾§è¾¹æ åŠ å…¥å¾®ä¿¡å…¬ä¼—å·å›¾ç‰‡widget"><a href="#ä¾§è¾¹æ åŠ å…¥å¾®ä¿¡å…¬ä¼—å·å›¾ç‰‡widget" class="headerlink" title="ä¾§è¾¹æ åŠ å…¥å¾®ä¿¡å…¬ä¼—å·å›¾ç‰‡widget"></a>ä¾§è¾¹æ åŠ å…¥å¾®ä¿¡å…¬ä¼—å·å›¾ç‰‡<code>widget</code></h2><p>å‚è€ƒï¼š<a href="https://butterfly.js.org/posts/ea33ab97/">https://butterfly.js.org/posts/ea33ab97/</a></p><p>é¼ æ ‡æ”¾åœ¨æœä¸€æœå›¾ç‰‡ä¸Šæ—¶å¾®å°æ”¾å¤§ç‰¹æ•ˆã€‚åœ¨<code>sunchaser.styl</code>æ ·å¼æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.aside-img</span><br><span class="line">  <span class="attribute">object-fit</span>: cover</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">7px</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span></span><br><span class="line">  transition: all .6s</span><br><span class="line"></span><br><span class="line">  &amp;:hover</span><br><span class="line">    <span class="attribute">box-shadow</span>: none</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">7px</span></span><br><span class="line">    <span class="attribute">transform</span>: scale(<span class="number">1.1</span>)</span><br></pre></td></tr></table></figure><h2 id="åœ¨æ–‡ç« è¯¦æƒ…é¡µåº•éƒ¨æ·»åŠ æ–‡ç« ç»“æŸè¯­å’Œå…¬ä¼—å·"><a href="#åœ¨æ–‡ç« è¯¦æƒ…é¡µåº•éƒ¨æ·»åŠ æ–‡ç« ç»“æŸè¯­å’Œå…¬ä¼—å·" class="headerlink" title="åœ¨æ–‡ç« è¯¦æƒ…é¡µåº•éƒ¨æ·»åŠ æ–‡ç« ç»“æŸè¯­å’Œå…¬ä¼—å·"></a>åœ¨æ–‡ç« è¯¦æƒ…é¡µåº•éƒ¨æ·»åŠ æ–‡ç« ç»“æŸè¯­å’Œå…¬ä¼—å·</h2><p>åœ¨<code>/themes/butterfly/layout/includes/post</code>ç›®å½•ä¸‹æ·»åŠ ä¸¤ä¸ªæ–‡ä»¶<code>post-end.pug</code>å’Œ<code>post-end-wechat.pug</code>ï¼Œå†…å®¹åˆ†åˆ«ä¸ºï¼š</p><p><code>post-end.pug</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">div</span><br><span class="line">  div(style&#x3D;&#39;text-align:center;color: #ccc;font-size:14px;font-family: cursive;&#39;)</span><br><span class="line">    | -------------&amp;#x6709;&amp;#x8FC7;&amp;#x7275;&amp;#x6302;</span><br><span class="line">    i(style&#x3D;&#39;margin:0 7px;&#39;).fa.fa-umbrella</span><br><span class="line">    | &amp;#x4E86;&amp;#x65E0;&amp;#x7275;&amp;#x6302;-------------</span><br></pre></td></tr></table></figure><p><code>post-end-wechat.pug</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#post-end-wechat</span><br><span class="line">  center</span><br><span class="line">    img#wechat-qrcode(src&#x3D;&#96;$&#123;theme.post_end.wechat.cdn_qrcode&#125;&#96; onerror&#x3D;&#96;onerror&#x3D;null;src&#x3D;&#39;$&#123;theme.post_end.wechat.local_default_qrcode&#125;&#39;&#96;,alt&#x3D;&#39;æ‰“å·¥è¿™ä»¶å°äº‹&#39;)</span><br><span class="line">  div&#x3D;theme.post_end.wechat.description</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>/themes/butterfly/layout/post.pug</code>æ–‡ä»¶ï¼Œåœ¨<code>include includes/post/post-copyright.pug</code>è¿™ä¸€è¡Œçš„ä¸Šæ–¹ç¼©è¿›å¯¹é½ä½ç½®æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if theme.post_end.enable</span><br><span class="line">  include includes&#x2F;post&#x2F;post-end.pug</span><br><span class="line">if theme.post_end.wechat.enable</span><br><span class="line">  include includes&#x2F;post&#x2F;post-end-wechat.pug</span><br></pre></td></tr></table></figure><p>åœ¨<code>_config.butterfly.yml</code>é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®é¡¹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_end:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">wechat:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">cdn_qrcode:</span> <span class="string">https://i.loli.net/2020/02/15/SDRF87I6ohlyVk1.jpg</span></span><br><span class="line">    <span class="attr">local_default_qrcode:</span> <span class="string">/assets/images/weixin/wechat-gzh.png</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">æ¬¢è¿å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€æ‰“å·¥è¿™ä»¶å°äº‹ã€‘ï½</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>sunchaser.styl</code>æ ·å¼æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#post-end-wechat</span><br><span class="line">  <span class="attribute">text-align</span>: center</span><br><span class="line">  <span class="attribute">display</span>: inline-block</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">36px</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto</span><br><span class="line">  </span><br><span class="line">  #wechat-qrcode</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span></span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span></span><br></pre></td></tr></table></figure><h2 id="footeråº•éƒ¨ä½œè€…åå­—å‰æ·»åŠ è·³åŠ¨çš„çº¢å¿ƒ"><a href="#footeråº•éƒ¨ä½œè€…åå­—å‰æ·»åŠ è·³åŠ¨çš„çº¢å¿ƒ" class="headerlink" title="footeråº•éƒ¨ä½œè€…åå­—å‰æ·»åŠ è·³åŠ¨çš„çº¢å¿ƒ"></a><code>footer</code>åº•éƒ¨ä½œè€…åå­—å‰æ·»åŠ è·³åŠ¨çš„çº¢å¿ƒ</h2><p>ä¿®æ”¹<code>/themes/butterfly/layout/includes/footer.pug</code>æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if theme.footer.owner.since &amp;&amp; theme.footer.owner.since !&#x3D; nowYear</span><br><span class="line">  .copyright!&#x3D; &#96;&amp;copy;$&#123;theme.footer.owner.since&#125; - $&#123;nowYear&#125;&amp;nbsp;&lt;i style&#x3D;&quot;color:#FF6A6A;animation: announ_animation 0.8s linear infinite;&quot;class&#x3D;&quot;fas fa-heart&quot;&gt;&lt;&#x2F;i&gt; By $&#123;config.author&#125;&#96;</span><br><span class="line">else</span><br><span class="line">  .copyright!&#x3D; &#96;&amp;copy;$&#123;nowYear&#125;&amp;nbsp;&lt;i style&#x3D;&quot;color:#FF6A6A;animation: announ_animation 0.8s linear infinite;&quot;class&#x3D;&quot;fas fa-heart&quot;&gt;&lt;&#x2F;i&gt; By $&#123;config.author&#125;&#96;</span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ RSSæ’ä»¶ç”Ÿæˆatom-xml"><a href="#æ·»åŠ RSSæ’ä»¶ç”Ÿæˆatom-xml" class="headerlink" title="æ·»åŠ RSSæ’ä»¶ç”Ÿæˆatom.xml"></a>æ·»åŠ RSSæ’ä»¶ç”Ÿæˆatom.xml</h2><p>åœ¨åšå®¢æ ¹ç›®å½•ä¸‹è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure><p>åœ¨åšå®¢é…ç½®æ–‡ä»¶<code>_config.yml</code>ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># RSSè®¢é˜…</span></span><br><span class="line"><span class="attr">plugin:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">hexo-generator-feed</span></span><br><span class="line"><span class="comment"># Feed Atom</span></span><br><span class="line"><span class="attr">feed:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">atom</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">atom.xml</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">20</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸»é¢˜çš„é…ç½®æ–‡ä»¶<code>_config.butterfly.yml</code>ä¸­çš„<code>social</code>å±æ€§ä¸‹æ·»åŠ <code>rss</code>çš„<code>icon</code>é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">fa fa-rss:</span> <span class="string">/atom.xml</span></span><br></pre></td></tr></table></figure><h2 id="ç”Ÿæˆç™¾åº¦sitemap"><a href="#ç”Ÿæˆç™¾åº¦sitemap" class="headerlink" title="ç”Ÿæˆç™¾åº¦sitemap"></a>ç”Ÿæˆç™¾åº¦sitemap</h2><p>åœ¨<code>hexo</code>åšå®¢æ ¹ç›®å½•ä¸‹åˆ†åˆ«æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ’ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åšå®¢æ ¹ç›®å½•ä¸‹<code>_config.yml</code>æ–‡ä»¶ä¸­çš„<code>url</code>å±æ€§ä¸ºç«™ç‚¹è‡ªå®šä¹‰åŸŸåï¼ˆä¸æ”¯æŒ<code>github.io</code>ï¼‰</p><h2 id="sitemapæäº¤"><a href="#sitemapæäº¤" class="headerlink" title="sitemapæäº¤"></a>sitemapæäº¤</h2><h2 id="é…ç½®ç™¾åº¦ä¸»åŠ¨æ¨é€"><a href="#é…ç½®ç™¾åº¦ä¸»åŠ¨æ¨é€" class="headerlink" title="é…ç½®ç™¾åº¦ä¸»åŠ¨æ¨é€"></a>é…ç½®ç™¾åº¦ä¸»åŠ¨æ¨é€</h2><p>åœ¨<code>hexo</code>åšå®¢æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ’ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-baidu-url-submit --save</span><br></pre></td></tr></table></figure><p>åœ¨åšå®¢æ ¹ç›®å½•ä¸‹<code>_config.yml</code>æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">baidu_url_submit:</span></span><br><span class="line">  <span class="attr">count:</span> <span class="number">100</span> <span class="comment"># æäº¤æœ€æ–°çš„ä¸€ä¸ªé“¾æ¥</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">lilu.org.cn</span> <span class="comment"># åœ¨ç™¾åº¦ç«™é•¿å¹³å°ä¸­æ³¨å†Œçš„åŸŸå</span></span><br><span class="line">  <span class="attr">token:</span> <span class="string">eNsEfgMEdafegvn</span> <span class="comment"># è¯·æ³¨æ„è¿™æ˜¯æ‚¨çš„ç§˜é’¥ï¼Œ æ‰€ä»¥è¯·ä¸è¦æŠŠåšå®¢æºä»£ç å‘å¸ƒåœ¨å…¬ä¼—ä»“åº“é‡Œ!</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">baidu_urls.txt</span> <span class="comment"># æ–‡æœ¬æ–‡æ¡£çš„åœ°å€ï¼Œ æ–°é“¾æ¥ä¼šä¿å­˜åœ¨æ­¤æ–‡æœ¬æ–‡æ¡£é‡Œ</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>deploy</code>å±æ€§ï¼Œæœ‰ä¸¤ä¸ª<code>type</code>æ—¶å‰é¢è¦åŠ <code>-</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">https://github.com/sunchaser-lilu/sunchaser-lilu.github.io.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">master</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">baidu_url_submitter</span></span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ PDFæ’ä»¶"><a href="#æ·»åŠ PDFæ’ä»¶" class="headerlink" title="æ·»åŠ PDFæ’ä»¶"></a>æ·»åŠ PDFæ’ä»¶</h2><p>æ­¤æ’ä»¶å¯åœ¨å•é¡µé¢ä¸­å…¨å±æ‰“å¼€PDFï¼Œæ•ˆæœä¸æ‰“å¼€æœ¬åœ°ç£ç›˜çš„PDFæ–‡ä»¶ç±»ä¼¼ã€‚</p><p>åœ¨<code>hexo</code>åšå®¢æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ’ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-pdf-plugin@0.0.1-beta --save</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">layout: false</span><br><span class="line">title: PDF</span><br><span class="line">date: 2021-01-29 16:00:00</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">&#123;% pdf https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/pdf/the-road-to-code-improvement-from-code-farmers-to-craftsmen.pdf %&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloudç‰ˆæœ¬æ¦‚è¿°</title>
      <link href="2021/01/29/microservice/springcloud/spring-cloud-version-overview/"/>
      <url>2021/01/29/microservice/springcloud/spring-cloud-version-overview/</url>
      
        <content type="html"><![CDATA[<p><code>Spring Cloud</code>æ˜¯ä¸€ç³»åˆ—å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆçš„ç»„åˆå¥—ä»¶ã€‚å®ƒåŒ…å«åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒã€æœåŠ¡æ³¨å†Œä¸å‘ç°ã€è·¯ç”±ã€æœåŠ¡è°ƒç”¨ã€è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨ã€å…¨å±€é”ã€é¢†å¯¼é€‰ä¸¾/é›†ç¾¤çŠ¶æ€å’Œåˆ†å¸ƒå¼æ¶ˆæ¯ç­‰ç»„ä»¶ã€‚åˆ©ç”¨è¿™äº›ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿåœ°æ„å»ºå‡ºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p><h2 id="Spring-Bootç‰ˆæœ¬ä»‹ç»"><a href="#Spring-Bootç‰ˆæœ¬ä»‹ç»" class="headerlink" title="Spring Bootç‰ˆæœ¬ä»‹ç»"></a><code>Spring Boot</code>ç‰ˆæœ¬ä»‹ç»</h2><p>ç”±äº<code>Spring Cloud</code>æ˜¯åŸºäº<code>Spring Boot</code>è¿›è¡Œæ„å»ºçš„ï¼Œæ‰€ä»¥åœ¨ä»‹ç»<code>Spring Cloud</code>çš„ç‰ˆæœ¬ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹<code>Spring Boot</code>çš„ç‰ˆæœ¬ã€‚</p><p>å®˜ç½‘é“¾æ¥ï¼š<a href="https://spring.io/projects/spring-boot#learn"><code>https://spring.io/projects/spring-boot#learn</code></a></p><p><code>Spring Boot</code>ç‰ˆæœ¬å·éµå¾ª<code>ä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.å¢é‡ç‰ˆæœ¬å·.é‡Œç¨‹ç¢‘ç‰ˆæœ¬å·</code>æ–¹æ¡ˆï¼š</p><ul><li>ä¸»ç‰ˆæœ¬å·ï¼šé¡¹ç›®æœ‰å¯èƒ½è¿›è¡Œé‡å¤§é‡æ„ï¼Œå„ä¸»ç‰ˆæœ¬ä¹‹é—´ä¸ä¸€å®šèƒ½å…¼å®¹ã€‚</li><li>æ¬¡ç‰ˆæœ¬å·ï¼šåœ¨ä¸»ç‰ˆæœ¬æ¶æ„ä¸å˜çš„æƒ…å†µä¸‹ï¼ŒåŠ å…¥æ–°ç‰¹æ€§ï¼Œä¿è¯å…¼å®¹ã€‚</li><li>å¢é‡ç‰ˆæœ¬å·ï¼š<code>BUG</code>çš„ä¿®å¤ã€‚</li><li>é‡Œç¨‹ç¢‘ç‰ˆæœ¬å·ï¼šå½“å‰çš„å‘å¸ƒç‰ˆæœ¬ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»ï¼š<ul><li><code>BUILD-SNAPSHOT</code>ï¼šå¼€å‘å¿«ç…§ç‰ˆã€‚</li><li><code>M</code>ï¼š<code>Milestone</code>çš„ç¼©å†™ï¼Œé‡Œç¨‹ç¢‘ç‰ˆæœ¬ã€‚è¯¥ç‰ˆæœ¬è¾ƒä¹‹å‰ç‰ˆæœ¬åœ¨åŠŸèƒ½ä¸Šæœ‰é‡å¤§æ›´æ–°ï¼Œæ˜¯å‘å¸ƒç¨³å®šç‰ˆæœ¬çš„å‰å…†ã€‚å¦‚<code>M1</code>/<code>M2</code>ã€‚</li><li><code>PRE</code>ï¼šé¢„è§ˆç‰ˆã€‚ä¸å»ºè®®ä½¿ç”¨ï¼Œå¯èƒ½å­˜åœ¨æœªçŸ¥<code>BUG</code>ã€‚</li><li><code>SNAPSHOT</code>ï¼šå¿«ç…§ç‰ˆã€‚å¯ç¨³å®šä½¿ç”¨ï¼Œä½†ä»åœ¨ç»§ç»­æ”¹è¿›åŠŸèƒ½ã€‚</li><li><code>RC</code>ï¼š<code>Release Candidate</code>çš„ç¼©å†™ã€‚å€™é€‰å‘å¸ƒç‰ˆæœ¬ã€‚æ­¤ç‰ˆæœ¬å·²ç›¸å½“æˆç†Ÿï¼ŒåŸºæœ¬ä¸å­˜åœ¨<code>BUG</code>ã€‚å¦‚<code>RC1</code>/<code>RC2</code>ã€‚</li><li><code>RELEASE</code>ï¼šæœ€ç»ˆå‘è¡Œç‰ˆæœ¬ã€‚ç¨³å®šæ­£å¼ç‰ˆæœ¬ã€‚</li><li><code>GA</code>ï¼š<code>General Availability</code>ï¼Œæ­£å¼ç‰ˆæœ¬ï¼Œå®˜æ–¹æ¨èä½¿ç”¨æ­¤ç‰ˆæœ¬ã€‚åœ¨å›½å¤–æ˜¯ç”¨<code>GA</code>æ¥æ ‡è¯†<code>RELEASE</code>ç‰ˆæœ¬ã€‚</li></ul></li></ul><p><code>Spring Boot</code>é¡¹ç›®æ‰€æœ‰ç‰ˆæœ¬ç´¢å¼•åœ°å€ï¼š<a href="https://docs.spring.io/spring-boot/docs/"><code>https://docs.spring.io/spring-boot/docs/</code></a></p><h2 id="Spring-Cloudç‰ˆæœ¬ä»‹ç»"><a href="#Spring-Cloudç‰ˆæœ¬ä»‹ç»" class="headerlink" title="Spring Cloudç‰ˆæœ¬ä»‹ç»"></a><code>Spring Cloud</code>ç‰ˆæœ¬ä»‹ç»</h2><p>å®˜ç½‘é“¾æ¥ï¼š<a href="https://spring.io/projects/spring-cloud#learn"><code>https://spring.io/projects/spring-cloud#learn</code></a></p><p>ä¸åŒäº<code>Spring Boot</code>åŠå…¶å®ƒ<code>Spring</code>é¡¹ç›®çš„ç‰ˆæœ¬å‘½åæ–¹å¼ï¼Œ<code>Spring Cloud</code>é¡¹ç›®çš„ç‰ˆæœ¬æ˜¯æ ¹æ®è‹±å›½ä¼¦æ•¦åœ°é“ç«™çš„è‹±æ–‡åç§°å¹¶æŒ‰ç…§å­—æ¯<code>A-Z</code>çš„é¡ºåºè¿›è¡Œæ§åˆ¶çš„ï¼Œä¾‹å¦‚ï¼š<code>Aï¼ˆAngelï¼‰</code>ã€<code>Bï¼ˆBrixtonï¼‰</code>ã€<code>Cï¼ˆCamdenï¼‰</code>ã€<code>Dï¼ˆDalstonï¼‰</code>ã€<code>Eï¼ˆEdgwareï¼‰</code>ã€<code>Fï¼ˆFinchleyï¼‰</code>ã€<code>Gï¼ˆGreenwichï¼‰</code>å’Œ<code>Hï¼ˆHoxtonï¼‰</code>ç­‰ã€‚ç›´åˆ°<code>2020</code>å¹´<code>4</code>æœˆ<code>16</code>æ—¥ï¼Œ<code>Spring Cloud 2020.0.0-M1</code>ç‰ˆæœ¬å‘å¸ƒï¼Œä»è¯¥ç‰ˆæœ¬å¼€å§‹ï¼Œå‘å¸ƒè‡³<code>Maven</code>ä»“åº“çš„ç‰ˆæœ¬å·å°†ä¸å†ä½¿ç”¨è‹±å›½ä¼¦æ•¦åœ°é“ç«™æ–¹å¼å‘½åï¼Œè€Œæ˜¯æ”¹ä¸ºå…¨æ–°çš„â€œæ—¥å†åŒ–â€ç‰ˆæœ¬å‘½åæ–¹å¼ã€‚</p><blockquote><p>å®˜å®£åšå®¢ï¼š<a href="https://spring.io/blog/2020/04/17/spring-cloud-2020-0-0-m1-released"><code>https://spring.io/blog/2020/04/17/spring-cloud-2020-0-0-m1-released</code></a></p></blockquote><h2 id="â€œæ—¥å†åŒ–â€ç‰ˆæœ¬å‘½åæ–¹å¼"><a href="#â€œæ—¥å†åŒ–â€ç‰ˆæœ¬å‘½åæ–¹å¼" class="headerlink" title="â€œæ—¥å†åŒ–â€ç‰ˆæœ¬å‘½åæ–¹å¼"></a>â€œæ—¥å†åŒ–â€ç‰ˆæœ¬å‘½åæ–¹å¼</h2><p>â€œæ—¥å†åŒ–â€ç‰ˆæœ¬å‘½åéµå¾ª<code>YYYY.MINOR.MICRO</code>æ–¹æ¡ˆï¼š</p><ul><li><code>YYYY</code>ï¼šä»£è¡¨å››ä½å¹´ä»½ã€‚</li><li><code>MINOR</code>ï¼šä»£è¡¨ä¸€ä¸ªé€’å¢çš„æ•°å­—ï¼Œæ¯å¹´ä»<code>0</code>å¼€å§‹é€’å¢ã€‚</li><li><code>MICRO</code>ï¼šä»£è¡¨å…ˆå‰ä½¿ç”¨çš„ç‰ˆæœ¬å·åç¼€ï¼Œä¾‹å¦‚<code>.0</code>ç±»ä¼¼äº<code>.RELEASE</code>ï¼Œ<code>.2</code>ç±»ä¼¼äº<code>.SR2</code>ã€‚</li></ul><p>é¢„å‘å¸ƒç‰ˆæœ¬çš„åç¼€åˆ†éš”ç¬¦ä»<code>.</code>å˜æ›´ä¸º<code>-</code>ï¼Œä¾‹å¦‚<code>2020.0.0-M1</code>å’Œ<code>2020.0.0-RC2</code>ï¼›åŒæ—¶å¿«ç…§ç‰ˆæœ¬å°†ä¸å†æ·»åŠ <code>BUILD-</code>å‰ç¼€ï¼Œä¾‹å¦‚<code>2020.0.0-SNAPSHOT</code>ã€‚</p><p>åœ¨<code>Spring Cloud</code>é¡¹ç›®ä¸­å‡ºç°äº†æ–°çš„é‡Œç¨‹ç¢‘ç‰ˆæœ¬å·ï¼š<code>SR</code>ï¼š<code>Service Release</code>çš„ç¼©å†™ï¼Œè¡¨ç¤ºä¿®æ­£ç‰ˆã€‚ä¿®æ­£äº†æ­£å¼ç‰ˆæœ¬æ¨å‡ºåå‘ç°çš„<code>BUG</code>ã€‚å¦‚<code>SR1</code>/<code>SR2</code>ã€‚</p><blockquote><p>è™½ç„¶å‘å¸ƒè‡³<code>Maven</code>ä»“åº“çš„ç‰ˆæœ¬å‘½åæ–¹å¼å‘ç”Ÿäº†å˜æ›´ï¼Œä½†<code>Spring Cloud</code>é¡¹ç›®ä»ç„¶ä½¿ç”¨è‹±å›½ä¼¦æ•¦åœ°é“ç«™å‘½åæ–¹å¼ä½œä¸ºä»£ç åç§°ã€‚å½“å‰ä¸º<code>Ilford</code>ã€‚</p></blockquote><h2 id="å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬"><a href="#å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬" class="headerlink" title="å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬"></a>å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬</h2><p><code>Spring Cloud</code>æ˜¯åŸºäº<code>Spring Boot</code>è¿›è¡Œæ„å»ºçš„ï¼Œä¸¤è€…çš„ç‰ˆæœ¬å¿…é¡»ç›¸åŒ¹é…ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒå®˜ç½‘çš„ç‰ˆæœ¬æ˜ å°„ã€‚</p><p>å®˜ç½‘é“¾æ¥ï¼š<a href="https://spring.io/projects/spring-cloud"><code>https://spring.io/projects/spring-cloud</code></a></p><p>ä¸‹é¢åˆ—å‡ºå¤§ç‰ˆæœ¬å·çš„å¯¹åº”é€‰æ‹©ï¼š</p><table><thead><tr><th><code>Release Train</code></th><th><code>Boot Version</code></th></tr></thead><tbody><tr><td><a href="https://github.com/spring-cloud/spring-cloud-release/wiki/Spring-Cloud-2020.0-Release-Notes"><code>2020.0.x</code></a>  <code>aka Ilford</code></td><td><code>2.4.x</code></td></tr><tr><td><a href="https://github.com/spring-cloud/spring-cloud-release/wiki/Spring-Cloud-Hoxton-Release-Notes">Hoxton</a></td><td><code>2.2.x, 2.3.x (Starting with SR5)</code></td></tr><tr><td><a href="https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Greenwich-Release-Notes">Greenwich</a></td><td><code>2.1.x</code></td></tr><tr><td><a href="https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Finchley-Release-Notes">Finchley</a></td><td><code>2.0.x</code></td></tr><tr><td><a href="https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Edgware-Release-Notes">Edgware</a></td><td><code>1.5.x</code></td></tr><tr><td><a href="https://github.com/spring-projects/spring-cloud/wiki/Spring-Cloud-Dalston-Release-Notes">Dalston</a></td><td><code>1.5.x</code></td></tr></tbody></table><p>å®˜æ–¹æä¾›äº†ä¸€ä¸ª<code>Actuator</code>ç«¯ç‚¹è¿”å›äº†è¯¦ç»†çš„å„å°ç‰ˆæœ¬å·ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚å¯æ ¹æ®è‡ªèº«éœ€è¦è¿›è¡Œæ›´åŠ ç»†ç²’åº¦çš„ç‰ˆæœ¬é€‰æ‹©ã€‚</p><p>ç«¯ç‚¹åœ°å€ä¸ºï¼š<a href="https://start.spring.io/actuator/info"><code>https://start.spring.io/actuator/info</code></a></p>]]></content>
      
      
      <categories>
          
          <category> Spring Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring Cloud </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šå›æ–‡é“¾è¡¨</title>
      <link href="2021/01/03/algorithm/leetcode/tag/linkedlist/palindrome-linked-list/"/>
      <url>2021/01/03/algorithm/leetcode/tag/linkedlist/palindrome-linked-list/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šè¯·åˆ¤æ–­ä¸€ä¸ªå•å‘é“¾è¡¨æ˜¯å¦ä¸ºå›æ–‡é“¾è¡¨ã€‚</p><p><code>Leetcode</code>åœ¨çº¿<code>OJ</code>ç³»ç»Ÿï¼š<a href="https://leetcode-cn.com/problems/palindrome-linked-list/">ä¼ é€é—¨</a></p><p>ç¤ºä¾‹<code>1</code>ï¼š</p><pre class="mermaid">graph LRA[1]-->B[2]</pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡ºï¼šfalse</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹<code>2</code>:</p><pre class="mermaid">graph LRA[1]-->B[2]B[2]-->C[2]C[2]-->D[1]</pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡ºï¼štrue</span><br></pre></td></tr></table></figure><p>æ€è·¯ï¼š</p><p>é¦–å…ˆéœ€è¦çŸ¥é“ä»€ä¹ˆæ˜¯â€œå›æ–‡â€ï¼šå›æ–‡æŒ‡çš„æ˜¯æ— è®ºæ­£å‘è¿˜æ˜¯åå‘è¯»ï¼Œå¾—åˆ°çš„ç»“æœä¸€è‡´ã€‚ç”±äºå•å‘é“¾è¡¨çš„ç‰¹ç‚¹ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥è¯»åŸé“¾è¡¨ï¼Œåˆ™åªèƒ½æ­£å‘è¯»å–ï¼Œæ— æ³•è¿›è¡Œåˆ¤æ–­ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€å®šçš„è½¬åŒ–ã€‚</p><p>è½¬æ¢æ–¹å¼ä¸€ï¼šå°†æ•´ä¸ªå•å‘é“¾è¡¨æ˜ å°„åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç„¶åä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä»æ•°ç»„ä¸¤ç«¯å¼€å§‹éå†ï¼Œå½“é‡åˆ°æ•°å€¼ä¸ç›¸ç­‰çš„èŠ‚ç‚¹æ—¶ï¼Œå¯æ–­å®šä¸ºéå›æ–‡é“¾è¡¨ï¼Œå¦‚æœéå†åˆ°ä¸¤ä¸ªèŠ‚ç‚¹ç›¸é‡æ—¶éƒ½æœªå‘ç°æ•°å€¼ä¸ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™ä¸ºå›æ–‡é“¾è¡¨ã€‚</p><blockquote><p>å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼š<a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†</a></p></blockquote><p><code>Java</code>è¯­è¨€å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(SinglyLinkedListNode head)</span> </span>&#123;</span><br><span class="line">    List&lt;SinglyLinkedListNode&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="keyword">null</span>) &#123;</span><br><span class="line">        list.add(head);</span><br><span class="line">        head = head.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>,size = list.size();i &lt; size / <span class="number">2</span>;i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!list.get(i).val.equals(list.get(size - i - <span class="number">1</span>).val)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼çš„ç©ºé—´å¤æ‚åº¦ä¸º<code>O(n)</code>ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n + n/2) = O(n)</code>ã€‚</p><p>è½¬æ¢æ–¹å¼äºŒï¼šä¸ä½¿ç”¨é¢å¤–ç©ºé—´ï¼Œæˆ‘ä»¬åœ¨åŸé“¾è¡¨ä¸Šåšæ–‡ç« ï¼Œå¦‚æœä¸€ä¸ªå•å‘é“¾è¡¨ä¸ºå›æ–‡é“¾è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†å‰åŠæ®µé“¾è¡¨è¿›è¡Œåè½¬ï¼Œç„¶åå†ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆ<code>p1</code>å’Œ<code>p2</code>ï¼Œ<code>p1</code>ä»å¤´éƒ¨å¼€å§‹ï¼Œ<code>p2</code>ä»ä¸­é—´å¼€å§‹ï¼Œéå†é“¾è¡¨ï¼Œå½“é‡åˆ°æ•°å€¼ä¸ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œå¯æ–­å®šä¸ºéå›æ–‡é“¾è¡¨ï¼›å¦‚æœ<code>p2</code>éå†åˆ°å°¾éƒ¨éƒ½è¿˜æœªé‡åˆ°æ•°å€¼ä¸ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™ä¸ºå›æ–‡é“¾è¡¨ã€‚</p><p>å¦‚ä½•å°†å‰åŠæ®µé“¾è¡¨è¿›è¡Œåè½¬ï¼Ÿå¯åˆ©ç”¨ä¸€å¿«ä¸€æ…¢ä¸¤ä¸ªæŒ‡é’ˆå…ˆæ‰¾åˆ°ä¸­é—´èŠ‚ç‚¹ï¼Œç„¶åå°†ä»å¤´èŠ‚ç‚¹å¼€å§‹åˆ°ä¸­é—´èŠ‚ç‚¹çš„è¿™ä¸€éƒ¨åˆ†è¿›è¡Œåè½¬ã€‚</p><p><code>Java</code>è¯­è¨€å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isPalindromeUseReverse</span><span class="params">(SinglyLinkedListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¿«æ…¢æŒ‡é’ˆ</span></span><br><span class="line">    SinglyLinkedListNode fast = head;</span><br><span class="line">    SinglyLinkedListNode slow = head;</span><br><span class="line">    <span class="comment">// å¿«æŒ‡é’ˆèµ°åˆ°æœ«å°¾æ—¶ï¼Œæ…¢æŒ‡é’ˆæŒ‡å‘ä¸­é—´èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">while</span> (fast != <span class="keyword">null</span> &amp;&amp; fast.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        fast = fast.next.next;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åè½¬ä»å¤´èŠ‚ç‚¹åˆ°ä¸­é—´èŠ‚ç‚¹ä¹‹é—´çš„éƒ¨åˆ†</span></span><br><span class="line">    SinglyLinkedListNode p1 = head;</span><br><span class="line">    SinglyLinkedListNode p2 = slow;</span><br><span class="line">    SinglyLinkedListNode pre = slow;</span><br><span class="line">    SinglyLinkedListNode next;</span><br><span class="line">    <span class="keyword">while</span> (p1 != p2) &#123;</span><br><span class="line">        next = p1.next;</span><br><span class="line">        p1.next = pre;</span><br><span class="line">        pre = p1;</span><br><span class="line">        p1 = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœåŸé“¾æ¥èŠ‚ç‚¹ä¸ªæ•°ä¸ºå¥‡æ•°ï¼Œåˆ™ä¸­é—´èŠ‚ç‚¹p2ï¼ˆslowï¼‰éœ€è¦å³ç§»ä¸€ä½æ‰èƒ½è¿›è¡Œå›æ–‡æ¯”è¾ƒ</span></span><br><span class="line">    <span class="comment">// ä¾‹å¦‚ï¼š1-&gt;2-&gt;3-&gt;2-&gt;1ï¼›åè½¬å‰åŠéƒ¨åˆ†åä¸ºï¼š2-&gt;1-&gt;3-&gt;2-&gt;1</span></span><br><span class="line">    <span class="comment">// p2æŒ‡å‘ä¸­é—´èŠ‚ç‚¹3ï¼Œéœ€è¦å³ç§»ä¸€ä½æŒ‡å‘2ï¼Œæ‰èƒ½è¿›è¡Œå›æ–‡æ¯”è¾ƒ</span></span><br><span class="line">    <span class="keyword">if</span> (fast != <span class="keyword">null</span>) p2 = p2.next;</span><br><span class="line">    <span class="comment">// æ­¤æ—¶preæŒ‡å‘æ–°é“¾è¡¨çš„å¤´èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">while</span> (p2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!pre.val.equals(p2.val) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        pre = pre.next;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ–¹å¼çš„æ—¶é—´å¤æ‚åº¦ä¸ºï¼š<code>O(n + n/2 + n/2) = O(n)</code>ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<code>O(1)</code>ã€‚</p><p>ç¼ºç‚¹æ˜¯æ”¹å˜äº†åŸé“¾è¡¨çš„ç»“æ„ï¼Œä½†å¯åœ¨åˆ¤æ–­å‡ºæ˜¯å¦ä¸ºå›æ–‡é“¾è¡¨åå†æ¬¡åè½¬å‰åŠéƒ¨åˆ†èŠ‚ç‚¹ï¼Œä»è€Œæ¢å¤åŸé“¾è¡¨çš„ç»“æ„ã€‚</p><p>æ–¹å¼äºŒçš„ä¼˜åŒ–ç‰ˆæœ¬ï¼šä½¿ç”¨å¿«æ…¢æŒ‡é’ˆå¯»æ‰¾ä¸­é—´èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­æ…¢æŒ‡é’ˆå·²ç»éå†äº†å‰åŠéƒ¨åˆ†é“¾è¡¨ï¼Œå¯å°±åœ¨è¿™ä¸€æ¬¡çš„éå†ä¸­è¿›è¡Œåè½¬ã€‚</p><p>ä¼˜åŒ–åçš„ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isPalindromeUseReverseOptimization</span><span class="params">(SinglyLinkedListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    SinglyLinkedListNode fast = head;</span><br><span class="line">    SinglyLinkedListNode slow = head;</span><br><span class="line">    SinglyLinkedListNode pre = <span class="keyword">null</span>;</span><br><span class="line">    SinglyLinkedListNode next;</span><br><span class="line">    <span class="comment">// æ…¢æŒ‡é’ˆç§»åŠ¨çš„åŒæ—¶è¿›è¡Œåè½¬</span></span><br><span class="line">    <span class="keyword">while</span> (fast != <span class="keyword">null</span> &amp; fast.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        fast = fast.next.next;</span><br><span class="line">        next = slow.next;</span><br><span class="line">        slow.next = pre;</span><br><span class="line">        pre = slow;</span><br><span class="line">        slow = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (fast != <span class="keyword">null</span>) slow = slow.next;</span><br><span class="line">    <span class="keyword">while</span> (slow != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!pre.val.equals(slow.val)) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        pre = pre.next;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–åçš„æ—¶é—´å¤æ‚åº¦ä¸ºï¼š<code>O(n/2 + n/2) = O(n)</code>ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<code>O(1)</code>ã€‚ä½†ä»ç„¶ç ´åäº†åŸé“¾è¡¨çš„ç»“æ„ï¼ŒåŒæ ·åœ°ï¼Œå¯å†æ¬¡åè½¬é“¾è¡¨å‰åŠéƒ¨åˆ†è¿›è¡Œæ¢å¤ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> LeetCode </category>
          
          <category> é“¾è¡¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº‘è®¾è®¡æ¨¡å¼ä¹‹ç¼“å­˜å¤‡ç”¨æ¨¡å¼ï¼ˆCache-Aside Patternï¼‰</title>
      <link href="2021/01/03/design-patterns/cloud/cache-aside-pattern/"/>
      <url>2021/01/03/design-patterns/cloud/cache-aside-pattern/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p>ä½œç”¨ï¼šå°†æ•°æ®æŒ‰éœ€ä»æ•°æ®åº“åŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚</p><p>æ­¤æ¨¡å¼å¯ä»¥æé«˜æ€§èƒ½ï¼Œå¹¶èƒ½ä¿æŒç¼“å­˜å’Œæ•°æ®åº“ä¸­æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><h2 id="é—®é¢˜èƒŒæ™¯"><a href="#é—®é¢˜èƒŒæ™¯" class="headerlink" title="é—®é¢˜èƒŒæ™¯"></a>é—®é¢˜èƒŒæ™¯</h2><p>åº”ç”¨ç¨‹åºä½¿ç”¨ç¼“å­˜æ¥ä¼˜åŒ–å¯¹æ•°æ®åº“ä¸­å­˜å‚¨ä¿¡æ¯çš„é‡å¤è®¿é—®ã€‚ä½†æ˜¯ï¼ŒæœŸæœ›ç¼“å­˜å’Œæ•°æ®åº“ä¸­çš„æ•°æ®å®Œå…¨ä¸€è‡´æ˜¯ä¸åˆ‡å®é™…çš„ã€‚</p><p>åº”ç”¨ç¨‹åºåº”è¯¥å®ç°ä¸€ç§æœ‰åŠ©äºç¡®ä¿ç¼“å­˜ä¸­çš„æ•°æ®å°½é‡ä¿æŒæœ€æ–°ï¼ŒåŒæ—¶å½“ç¼“å­˜ä¸­çš„æ•°æ®è¿‡æœŸæ—¶å¯ä»¥æ£€æµ‹å’Œå¤„ç†çš„ç­–ç•¥ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>å¾ˆå¤šå•†ä¸šç¼“å­˜ç³»ç»Ÿæä¾›<code>read-through</code>å’Œ<code>write-through/write-behind</code>æ“ä½œã€‚åœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡å¼•ç”¨ç¼“å­˜æ¥æ£€ç´¢æ•°æ®ã€‚å¦‚æœæ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ï¼Œåˆ™ä»æ•°æ®åº“ä¸­é€æ˜åœ°æŸ¥è¯¢æ•°æ®å¹¶å°†å…¶æ·»åŠ è‡³ç¼“å­˜ä¸­ï¼›å¯¹ç¼“å­˜ä¸­ä¿å­˜çš„æ•°æ®çš„ä»»ä½•ä¿®æ”¹ä¹Ÿä¼šè‡ªåŠ¨å†™å›åˆ°æ•°æ®åº“ä¸­ã€‚</p><p>å¯¹äºä¸æä¾›æ­¤åŠŸèƒ½çš„ç¼“å­˜ï¼Œç”±ä½¿ç”¨ç¼“å­˜æ¥ç»´æŠ¤æ•°æ®çš„åº”ç”¨ç¨‹åºè´Ÿè´£ã€‚</p><p>åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å®ç°ç¼“å­˜å¤‡ç”¨æ¨¡å¼æ¥æ¨¡æ‹Ÿ<code>read-through</code>ç¼“å­˜çš„åŠŸèƒ½ã€‚è¯¥æ¨¡å¼å¯æ ¹æ®éœ€è¦å°†æ•°æ®é«˜æ•ˆåœ°åŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚ä¸‹å›¾æ€»ç»“äº†æ­¤è¿‡ç¨‹ä¸­çš„æ­¥éª¤ã€‚</p><p><img src="https://docs.microsoft.com/en-us/previous-versions/msp-n-p/images/dn589799.55b56fd8930e405c5bf9580e455a16c1(en-us,pandp.10).png" alt="Cache-Aside Pattern"></p><p>é€šä¿—çš„è®²ï¼Œåˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>å…ˆæŸ¥è¯¢ç¼“å­˜ï¼Œåˆ¤æ–­ç¼“å­˜æ˜¯å¦å­˜åœ¨ã€‚</li><li>å¦‚æœç¼“å­˜ä¸å­˜åœ¨ï¼Œåˆ™ä»æ•°æ®åº“ä¸­æŸ¥è¯¢ã€‚</li><li>ç„¶åå°†æ•°æ®ä¸­æŸ¥å‡ºæ¥çš„æ•°æ®è®¾ç½®åˆ°ç¼“å­˜ä¸­ã€‚</li></ol><p>å¦‚æœåº”ç”¨ç¨‹åºéœ€è¦ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹<code>write-through</code>ç­–ç•¥ï¼š</p><ol><li>ä¿®æ”¹æ•°æ®åº“ã€‚</li><li>è®©ç¼“å­˜å¤±æ•ˆã€‚</li></ol><p>å½“ä¸‹ä¸€æ¬¡è¯·æ±‚åˆ°æ¥æ—¶ï¼Œç”±äºä½¿ç”¨äº†ç¼“å­˜å¤‡ç”¨æ¨¡å¼ï¼Œå°†ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæœ€æ–°çš„æ•°æ®å¹¶å°†å…¶è®¾ç½®å›ç¼“å­˜ä¸­ã€‚</p><h2 id="é—®é¢˜ä¸æ€è€ƒ"><a href="#é—®é¢˜ä¸æ€è€ƒ" class="headerlink" title="é—®é¢˜ä¸æ€è€ƒ"></a>é—®é¢˜ä¸æ€è€ƒ</h2><p>åœ¨å†³å®šå¦‚ä½•å®ç°æ­¤æ¨¡å¼æ—¶ï¼Œåº”è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>ç¼“å­˜æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸï¼šå¾ˆå¤šç¼“å­˜å®ç°äº†è¿‡æœŸç­–ç•¥ï¼Œå¦‚æœåœ¨æŒ‡å®šçš„æ—¶é—´å†…æœªè®¿é—®ç¼“å­˜æ•°æ®ï¼Œç¼“å­˜ä¼šè‡ªåŠ¨å¤±æ•ˆå¹¶è¿›è¡Œåˆ é™¤ã€‚ä¸ºäº†ä½¿ç¼“å­˜å¤‡ç”¨æ¨¡å¼é«˜æ•ˆï¼Œè¯·ç¡®ä¿è¿‡æœŸç­–ç•¥ä¸ä½¿ç”¨è¯¥ç¼“å­˜çš„åº”ç”¨ç¨‹åºçš„è®¿é—®æ¨¡å¼ç›¸åŒ¹é…ã€‚ä¸è¦å°†è¿‡æœŸæ—¶é—´è®¾ç½®çš„å¤ªçŸ­ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºä¸æ–­ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®å¹¶å°†å…¶æ·»åŠ è‡³ç¼“å­˜ä¸­ï¼›åŒæ ·ä¸è¦è®¾ç½®çš„å¤ªé•¿ï¼Œä»¥å…ç¼“å­˜çš„æ•°æ®ä¸æ˜¯æœ€æ–°çš„ã€‚è¯·è®°ä½ï¼Œå¯¹äºç›¸å¯¹é™æ€çš„æ•°æ®æˆ–ç»å¸¸è¯»å–çš„æ•°æ®ï¼Œä½¿ç”¨ç¼“å­˜æœ€æœ‰æ•ˆã€‚</li><li>æ·˜æ±°æ•°æ®ï¼šå³å†…å­˜æ·˜æ±°ç­–ç•¥ã€‚ä¸æ•°æ®åº“ç›¸æ¯”ï¼Œå¤§å¤šæ•°é«˜é€Ÿç¼“å­˜åªæœ‰æœ‰é™çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œåœ¨å¿…è¦çš„æ—¶å€™ä¼šè¿›è¡Œå†…å­˜æ·˜æ±°ã€‚å¤§å¤šæ•°ç¼“å­˜éƒ½ä½¿ç”¨<code>LRU</code>ï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç®—æ³•æ¥å®ç°ï¼Œä½†è¿™å¯ä»¥è¿›è¡Œè‡ªå®šä¹‰ï¼Œå¯é…ç½®ç¼“å­˜çš„å…¨å±€è¿‡æœŸå±æ€§ä»¥åŠæ¯ä¸ªç¼“å­˜<code>key</code>çš„è¿‡æœŸå±æ€§ï¼Œä»¥å¸®åŠ©ç¼“å­˜å…·æœ‰æˆæœ¬æ•ˆç›Šã€‚å°†å†…å­˜æ·˜æ±°ç­–ç•¥åº”ç”¨äºæ‰€æœ‰ç¼“å­˜<code>key</code>å¹¶ä¸æ€»æ˜¯åˆé€‚çš„ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä»æ•°æ®ä¸­æŸ¥è¯¢å¹¶æ·»åŠ è‡³ç¼“å­˜ä¸­çš„ä»£ä»·éå¸¸æ˜‚è´µï¼Œé‚£ä¹ˆå°†å…¶ä¿ç•™åœ¨ç¼“å­˜ä¸­å¯èƒ½æ˜¯æœ‰ç›Šçš„ã€‚</li><li>å¯åŠ¨ç¼“å­˜ï¼šå³ç¼“å­˜é¢„çƒ­ã€‚è®¸å¤šè§£å†³æ–¹æ¡ˆä¼šåœ¨åº”ç”¨ç¨‹åºå¯åŠ¨è¿‡ç¨‹ä¸­é¢„å…ˆåŠ è½½å¯èƒ½éœ€è¦çš„æ•°æ®è‡³ç¼“å­˜ä¸­ã€‚å¦‚æœè¿™éƒ¨åˆ†ç¼“å­˜è¿‡æœŸæˆ–è¢«æ·˜æ±°ï¼Œç¼“å­˜å¤‡ç”¨æ¨¡å¼ä»ç„¶æœ‰æ•ˆã€‚</li><li>ä¸€è‡´æ€§ï¼šå®ç°ç¼“å­˜å¤‡ç”¨æ¨¡å¼å¹¶ä¸èƒ½ä¿è¯æ•°æ®åº“å’Œç¼“å­˜ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ã€‚æ•°æ®åº“ä¸­çš„æ•°æ®å¯èƒ½åœ¨ä»»æ„æ—¶åˆ»è¢«å¤–éƒ¨ä¿®æ”¹ï¼Œå¹¶ä¸”åœ¨ä¸‹æ¬¡è¯¥æ•°æ®è¢«åŠ è½½åˆ°ç¼“å­˜ä¸­ä¹‹å‰ï¼Œæ­¤ä¿®æ”¹å¯èƒ½ä¸ä¼šåæ˜ åœ¨ç¼“å­˜ä¸­ã€‚åœ¨è·¨æ•°æ®å­˜å‚¨å¤åˆ¶æ•°æ®çš„ç³»ç»Ÿä¸­ï¼Œå¦‚æœéå¸¸é¢‘ç¹çš„å‘ç”ŸåŒæ­¥ï¼Œåˆ™æ­¤é—®é¢˜å¯èƒ½ä¼šå˜å¾—ç‰¹åˆ«ä¸¥é‡ã€‚</li><li>æœ¬åœ°ç¼“å­˜ï¼šç¼“å­˜å¯ä»¥å­˜åœ¨äºåº”ç”¨ç¨‹åºå®ä¾‹çš„æœ¬åœ°å†…å­˜ä¸­ï¼Œå¦‚æœåº”ç”¨ç¨‹åºé‡å¤è®¿é—®ç›¸åŒçš„æ•°æ®ï¼Œç¼“å­˜å¤‡ç”¨æ¨¡å¼ä¼šéå¸¸æœ‰ç”¨ã€‚ä½†æ˜¯æœ¬åœ°ç¼“å­˜æ˜¯æ¯ä¸ªåº”ç”¨ç¨‹åºå®ä¾‹ç§æœ‰çš„ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ¬åœ°ç¼“å­˜ä¹‹é—´çš„æ•°æ®å¯èƒ½å¾ˆå¿«å˜å¾—ä¸ä¸€è‡´ï¼Œæˆ‘ä»¬éœ€è¦éå¸¸é¢‘ç¹çš„åˆ·æ–°æœ¬åœ°ç¼“å­˜å¹¶ä¸”è®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥è€ƒè™‘ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜ã€‚</li></ul><h2 id="ä»€ä¹ˆåœºæ™¯ä½¿ç”¨è¯¥æ¨¡å¼ï¼Ÿ"><a href="#ä»€ä¹ˆåœºæ™¯ä½¿ç”¨è¯¥æ¨¡å¼ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆåœºæ™¯ä½¿ç”¨è¯¥æ¨¡å¼ï¼Ÿ"></a>ä»€ä¹ˆåœºæ™¯ä½¿ç”¨è¯¥æ¨¡å¼ï¼Ÿ</h2><p>é€‚ç”¨åœºæ™¯ï¼š</p><ul><li>ç¼“å­˜ç³»ç»Ÿä¸æä¾›<code>read-through</code>å’Œ<code>write-through</code>æ“ä½œã€‚</li><li>èµ„æºéœ€æ±‚æ— æ³•è¿›è¡Œé¢„æµ‹ã€‚æ­¤æ¨¡å¼å¯ä½¿åº”ç”¨ç¨‹åºæŒ‰éœ€åŠ è½½æ•°æ®è‡³ç¼“å­˜ï¼Œå®ƒä¸ä¼šé¢„å…ˆå‡è®¾åº”ç”¨ç¨‹åºéœ€è¦å“ªäº›æ•°æ®ã€‚</li></ul><p>ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯ï¼š</p><ul><li>å½“ç¼“å­˜çš„æ•°æ®ä¸ºé™æ€çš„æ—¶å€™ï¼Œå¦‚æœç¼“å­˜ç©ºé—´è¶³å¤Ÿå­˜å‚¨æ•°æ®ï¼Œè¯·åœ¨å¯åŠ¨æ—¶è¿›è¡Œç¼“å­˜é¢„çƒ­ï¼Œå¹¶è®©å…¶æ°¸ä¸è¿‡æœŸã€‚</li><li>åœ¨<code>Web</code>åº”ç”¨ç¨‹åºä¸­ç¼“å­˜ä¼šè¯çŠ¶æ€ä¿¡æ¯ã€‚æ­¤åœºæ™¯ä¸‹åº”é¿å…å¼•å…¥åŸºäºå®¢æˆ·ç«¯-æœåŠ¡ç«¯ç›¸ä¼¼æ€§çš„ä¾èµ–å…³ç³»ã€‚</li></ul><h2 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h2><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä½¿ç”¨<code>Redis</code>ä½œä¸ºå¤šä¸ªåº”ç”¨ç¨‹åºå®ä¾‹ä¹‹é—´å…±äº«çš„åˆ†å¸ƒå¼ç¼“å­˜ã€‚ä»¥ä¸‹ä»£ç ä¸­çš„<code>selectCacheOrDb</code>æ–¹æ³•å±•ç¤ºäº†åŸºäº<code>Redis</code>çš„ç¼“å­˜å¤‡ç”¨æ¨¡å¼çš„æ¨¡æ¿æ–¹æ³•å®ç°ã€‚è¯¥æ–¹æ³•ä½¿ç”¨<code>read-through</code>ä»ç¼“å­˜ä¸­è¯»å–æ•°æ®ã€‚</p><ul><li>é¦–å…ˆä»ç¼“å­˜ä¸­è¯»å–æ•°æ®ï¼›</li><li>å¦‚æœç¼“å­˜æ•°æ®ä¸å­˜åœ¨ï¼Œåˆ™ä»æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ï¼›</li><li>å¦‚æœæ•°æ®åº“ä¸­çš„æ•°æ®å­˜åœ¨ï¼Œåˆ™å°†å…¶è®¾ç½®åˆ°ç¼“å­˜ä¸­ï¼Œè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œç„¶åè¿”å›ï¼›</li><li>å¦‚æœç¼“å­˜æ•°æ®å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›ç¼“å­˜ä¸­çš„æ•°æ®ï¼›</li><li>æ•´ä¸ªè¿‡ç¨‹å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œè¿”å›é»˜è®¤å€¼è¿›è¡Œé™çº§ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.sparrow.designpatterns.cloud;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.TypeReference;</span><br><span class="line"><span class="keyword">import</span> com.sunchaser.sparrow.designpatterns.common.model.request.CacheAsideRequest;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser admin@lilu.org.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2021/1/3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor = @__(@Autowired))</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CacheAsidePattern</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RedisTemplate&lt;String,String&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">selectCacheOrDb</span><span class="params">(CacheAsideRequest&lt;T&gt; cacheAsideRequest)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String cacheKey = cacheAsideRequest.getCacheKey();</span><br><span class="line">            <span class="comment">// random é˜²æ­¢é›ªå´©</span></span><br><span class="line">            <span class="keyword">int</span> expiredTime = cacheAsideRequest.getExpiredTime() + ThreadLocalRandom.current().nextInt(<span class="number">60</span>);</span><br><span class="line">            TimeUnit timeUnit = cacheAsideRequest.getTimeUnit();</span><br><span class="line">            String cacheValueString = redisTemplate.opsForValue().get(cacheKey);</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isEmpty(cacheValueString)) &#123;</span><br><span class="line">                T dbValue = cacheAsideRequest.getDbSelector().get();</span><br><span class="line">                log.info(<span class="string">&quot;cache miss, query db and the db value is: &#123;&#125;&quot;</span>,dbValue);</span><br><span class="line">                <span class="keyword">if</span> (Objects.nonNull(dbValue)) &#123;</span><br><span class="line">                    redisTemplate.opsForValue().set(</span><br><span class="line">                            cacheKey,</span><br><span class="line">                            JSONObject.toJSONString(dbValue),</span><br><span class="line">                            expiredTime,</span><br><span class="line">                            timeUnit</span><br><span class="line">                    );</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> dbValue;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                T t = JSONObject.parseObject(cacheValueString, <span class="keyword">new</span> TypeReference&lt;T&gt;() &#123;&#125;);</span><br><span class="line">                log.info(<span class="string">&quot;hit cache, the cache value is: &#123;&#125;&quot;</span>,cacheValueString);</span><br><span class="line">                <span class="keyword">return</span> t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;query cache or db error!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> cacheAsideRequest.getDefaultValue();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ–¹æ³•å…¥å‚<code>CacheAsideRequest</code>çš„å…·ä½“å­—æ®µå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.sparrow.designpatterns.common.model.request;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Supplier;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¼“å­˜å¤‡ç”¨æ¨¡å¼è¯·æ±‚å…¥å‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser admin@lilu.org.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2021/1/3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CacheAsideRequest</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼“å­˜key</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String cacheKey;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼“å­˜è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer expiredTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿‡æœŸæ—¶é—´çš„å•ä½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> TimeUnit timeUnit;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * DBæŸ¥è¯¢å™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Supplier&lt;T&gt; dbSelector;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘ç”Ÿå¼‚å¸¸è¿›è¡Œé™çº§çš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> T defaultValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨<code>HashMap</code>æ¨¡æ‹Ÿä¸€ä¸ªæ•°æ®åº“ï¼Œå½“éœ€è¦æŸ¥è¯¢æ—¶ï¼Œä»¥ä¸‹ä»£ç ä¸­çš„<code>testSelectCacheOrDb</code>æ–¹æ³•å±•ç¤ºäº†æˆ‘ä»¬çš„ä½¿ç”¨æ–¹å¼ï¼Œ<code>testUpdate</code>æ–¹æ³•æ¨¡æ‹Ÿäº†æ•°æ®åº“çš„æ›´æ–°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.sparrow.designpatterns.cloud;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.common.collect.Maps;</span><br><span class="line"><span class="keyword">import</span> com.sunchaser.sparrow.designpatterns.common.model.request.CacheAsideRequest;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser admin@lilu.org.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2021/1/3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CacheAsidePatternTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CacheAsidePattern cacheAsidePattern;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String,String&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String,String&gt; db = Maps.newHashMap();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        db.put(<span class="string">&quot;defaultUser&quot;</span>,<span class="string">&quot;defaultValue&quot;</span>);</span><br><span class="line">        db.put(<span class="string">&quot;user1&quot;</span>,<span class="string">&quot;value1&quot;</span>);</span><br><span class="line">        db.put(<span class="string">&quot;user2&quot;</span>,<span class="string">&quot;value2&quot;</span>);</span><br><span class="line">        db.put(<span class="string">&quot;user3&quot;</span>,<span class="string">&quot;value3&quot;</span>);</span><br><span class="line">        db.put(<span class="string">&quot;user4&quot;</span>,<span class="string">&quot;value4&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectCacheOrDb</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        CacheAsideRequest&lt;String&gt; cacheAsideRequest = <span class="keyword">new</span> CacheAsideRequest&lt;&gt;();</span><br><span class="line">        cacheAsideRequest.setCacheKey(<span class="string">&quot;test-key&quot;</span>);</span><br><span class="line">        cacheAsideRequest.setExpiredTime(<span class="number">100</span>);</span><br><span class="line">        cacheAsideRequest.setTimeUnit(TimeUnit.SECONDS);</span><br><span class="line">        cacheAsideRequest.setDbSelector(() -&gt; db.get(<span class="string">&quot;user1&quot;</span>));</span><br><span class="line">        cacheAsideRequest.setDefaultValue(db.get(<span class="string">&quot;defaultUser&quot;</span>));</span><br><span class="line">        String s = cacheAsidePattern.selectCacheOrDb(cacheAsideRequest);</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        db.put(<span class="string">&quot;user1&quot;</span>,<span class="string">&quot;updateValue1&quot;</span>);</span><br><span class="line">        redisTemplate.delete(<span class="string">&quot;test-key&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨æ›´æ–°æ•°æ®æ—¶ï¼Œåº”è¯¥å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†è®©ç¼“å­˜å¤±æ•ˆã€‚è¿™æ ·å¸¦æ¥çš„æ•°æ®å»¶è¿Ÿåªæœ‰ä¸€ä¸ª<code>redis</code>æ“ä½œçš„æ—¶é—´ã€‚</p><blockquote><p>å¦‚æœå…ˆè®©ç¼“å­˜å¤±æ•ˆï¼Œåæ›´æ–°æ•°æ®åº“ã€‚åœ¨è¿™ä¸¤æ­¥æ“ä½œçš„çª—å£æœŸé—´ï¼Œæœ‰å¾ˆå°çš„å¯èƒ½å®¢æˆ·ç«¯ä¼šå…ˆè¯»å–åˆ°æ•°æ®åº“ä¸­æ—§çš„æ•°æ®å¹¶å°†å…¶é‡æ–°è®¾ç½®åˆ°ç¼“å­˜ä¸­ï¼Œç„¶åå¯¹æ•°æ®åº“çš„æ›´æ–°æ‰æ­£å¼æäº¤ã€‚è¿™ä¼šå¯¼è‡´ç¼“å­˜ä¸­çš„æ•°æ®ä¸æ˜¯æœ€æ–°ã€‚</p></blockquote><h2 id="æ‰©å±•éƒ¨åˆ†"><a href="#æ‰©å±•éƒ¨åˆ†" class="headerlink" title="æ‰©å±•éƒ¨åˆ†"></a>æ‰©å±•éƒ¨åˆ†</h2><p>æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å¯¹ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºçš„æ•°æ®è¿›è¡Œä¸€å®šçš„æ ¡éªŒåæ‰å†³å®šæ˜¯å¦å­˜å…¥ç¼“å­˜ã€‚ä¾‹å¦‚æŸ¥è¯¢å‡ºçš„æ•°æ®åŒ…å«çš„å­—æ®µå…¨éƒ¨ä¸ä¸ºé›¶å€¼æ‰è¿›è¡Œç¼“å­˜ï¼Œæˆ–è€…æŸ¥è¯¢å‡ºçš„æ•°æ®åŒ…å«çš„å­—æ®µåªè¦æœ‰ä¸€ä¸ªä¸ºé›¶å€¼å°±è¿›è¡Œç¼“å­˜ã€‚å¦å¤–ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¯èƒ½æ˜¯ä¸€ä¸ªæ•°æ®è¡¨å®ä½“å¯¹è±¡ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªåŒ…å«æ•°æ®è¡¨å®ä½“å¯¹è±¡çš„<code>ArrayList</code>é›†åˆï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œåˆ†ç±»è®¨è®ºã€‚å¯¹å¤–æˆ‘ä»¬æä¾›ä¸€ä¸ªå¯é€‰çš„ç­–ç•¥ï¼Œå¯¹å†…æˆ‘ä»¬å…¼å®¹å•ä¸ªå®ä½“ç±»å’Œé›†åˆä¸¤ç§æƒ…å†µã€‚æ ¹æ®æ•°æ®åº“æŸ¥è¯¢è¿”å›çš„æ•°æ®ç±»å‹æ‰§è¡Œä¸åŒçš„è§£ææ–¹å¼ï¼Œæˆ‘ä»¬åˆ©ç”¨åå°„æ¥è§£æå•ä¸ªå¯¹è±¡æˆ–é›†åˆä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡çš„å­—æ®µæ˜¯å¦ä¸ºé›¶å€¼ã€‚</p><blockquote><p>é›¶å€¼ï¼šä¾‹å¦‚<code>Integer</code>çš„é›¶å€¼ä¸º<code>0</code>ï¼›<code>Long</code>çš„é›¶å€¼ä¸º<code>0L</code>ï¼›<code>Double</code>çš„é›¶å€¼ä¸º<code>0.00</code>ç­‰ç­‰ï¼Œè¿˜å¯æ ¹æ®å…·ä½“çš„ä¸šåŠ¡åœºæ™¯è¿›è¡Œè‡ªå®šä¹‰ã€‚</p></blockquote><p>ä¸‹é¢ç»™å‡ºæˆ‘ä»¬çš„ç­–ç•¥æšä¸¾ç±»<code>CacheStrategyEnum</code>å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.sparrow.designpatterns.common.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.common.collect.Lists;</span><br><span class="line"><span class="keyword">import</span> com.google.common.collect.Maps;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¼“å­˜ç­–ç•¥æšä¸¾åŠç­–ç•¥å¯¹åº”çš„å®ç°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser admin@lilu.org.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2021/1/3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">CacheStrategyEnum</span> </span>&#123;</span><br><span class="line">    ALL_NO_ZERO(<span class="string">&quot;ALL_NO_ZERO&quot;</span>,<span class="string">&quot;å…¨éƒ¨å­—æ®µä¸ä¸ºé›¶åˆ™è¿›è¡Œç¼“å­˜&quot;</span>) &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">analysisList</span><span class="params">(List&lt;?&gt; list)</span> <span class="keyword">throws</span> IllegalAccessException </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (Object el : list) &#123;</span><br><span class="line">                <span class="comment">// è·å–åŒ…å«çˆ¶ç±»superçš„æ‰€æœ‰å­—æ®µ</span></span><br><span class="line">                Field[] allFields = getAllFields(el);</span><br><span class="line">                <span class="keyword">for</span> (Field field : allFields) &#123;</span><br><span class="line">                    field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                    <span class="comment">// åªè¦æœ‰ä¸€ä¸ªå­—æ®µä¸ºé›¶ï¼Œè¿”å›false</span></span><br><span class="line">                    <span class="keyword">if</span> (analysisZero(field.get(el))) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">analysisCustomObject</span><span class="params">(Object object)</span> <span class="keyword">throws</span> IllegalAccessException </span>&#123;</span><br><span class="line">            Field[] allFields = getAllFields(object);</span><br><span class="line">            <span class="keyword">for</span> (Field field : allFields) &#123;</span><br><span class="line">                field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                <span class="comment">// åªè¦æœ‰ä¸€ä¸ªå­—æ®µä¸ºé›¶ï¼Œè¿”å›false</span></span><br><span class="line">                <span class="keyword">if</span> (analysisZero(field.get(object))) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    ANY_NO_ZERO(<span class="string">&quot;ANY_NO_ZERO&quot;</span>,<span class="string">&quot;ä»»æ„ä¸€ä¸ªå­—æ®µä¸ä¸ºé›¶åˆ™è¿›è¡Œç¼“å­˜&quot;</span>) &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">analysisList</span><span class="params">(List&lt;?&gt; list)</span> <span class="keyword">throws</span> IllegalAccessException </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (Object el : list) &#123;</span><br><span class="line">                <span class="comment">// è·å–åŒ…å«çˆ¶ç±»superçš„æ‰€æœ‰å­—æ®µ</span></span><br><span class="line">                Field[] allFields = getAllFields(el);</span><br><span class="line">                <span class="keyword">for</span> (Field field : allFields) &#123;</span><br><span class="line">                    field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                    <span class="comment">// ä»»æ„ä¸€ä¸ªå­—æ®µä¸ä¸ºé›¶ï¼Œè¿”å›true</span></span><br><span class="line">                    <span class="keyword">if</span> (!analysisZero(field.get(el))) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">analysisCustomObject</span><span class="params">(Object object)</span> <span class="keyword">throws</span> IllegalAccessException </span>&#123;</span><br><span class="line">            Field[] allFields = getAllFields(object);</span><br><span class="line">            <span class="keyword">for</span> (Field field : allFields) &#123;</span><br><span class="line">                field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                <span class="comment">// ä»»æ„ä¸€ä¸ªå­—æ®µä¸ä¸ºé›¶ï¼Œè¿”å›true</span></span><br><span class="line">                <span class="keyword">if</span> (!analysisZero(field.get(object))) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼“å­˜ç­–ç•¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String strategy;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æè¿°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String desc;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * flyweight</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String,CacheStrategyEnum&gt; enumMap = Maps.newHashMap();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (CacheStrategyEnum cacheStrategyEnum : CacheStrategyEnum.values())</span><br><span class="line">            enumMap.put(cacheStrategyEnum.strategy,cacheStrategyEnum);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheStrategyEnum <span class="title">getEnumByStrategy</span><span class="params">(String strategy)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> enumMap.get(strategy);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    CacheStrategyEnum(String strategy, String desc) &#123;</span><br><span class="line">        <span class="keyword">this</span>.strategy = strategy;</span><br><span class="line">        <span class="keyword">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠ½è±¡æ–¹æ³•ï¼šè§£æListä¸­çš„è‡ªå®šä¹‰å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> list listå¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> falseï¼šä¸è¿›è¡Œç¼“å­˜ï¼›trueï¼šè¿›è¡Œç¼“å­˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalAccessException ä¸Šå±‚è¿›è¡Œå¼‚å¸¸å¤„ç†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">analysisList</span><span class="params">(List&lt;?&gt; list)</span> <span class="keyword">throws</span> IllegalAccessException </span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠ½è±¡æ–¹æ³•ï¼šè§£æè‡ªå®šä¹‰å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> object å¾…è§£æçš„è‡ªå®šä¹‰å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> falseï¼šä¸è¿›è¡Œç¼“å­˜ï¼›trueï¼šè¿›è¡Œç¼“å­˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalAccessException ä¸Šå±‚è¿›è¡Œå¼‚å¸¸å¤„ç†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">analysisCustomObject</span><span class="params">(Object object)</span> <span class="keyword">throws</span> IllegalAccessException </span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è§£æå­—æ®µæ˜¯å¦ä¸ºé›¶å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o å¾…è§£æå­—æ®µ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> trueï¼šä¸ºé›¶å€¼ï¼›falseï¼šä¸ä¸ºé›¶ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">analysisZero</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Long) &#123;</span><br><span class="line">            <span class="keyword">return</span> (Long) o == <span class="number">0L</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Integer) &#123;</span><br><span class="line">            <span class="keyword">return</span> (Integer) o == <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Double) &#123;</span><br><span class="line">            <span class="keyword">return</span> (Double) o == <span class="number">0.00</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// do other biz zero</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åŒ…å«superçˆ¶ç±»çš„æ‰€æœ‰å­—æ®µ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> object éœ€è¦è·å–å­—æ®µçš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¯¹è±¡çš„æ‰€æœ‰å­—æ®µ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Field[] getAllFields(Object object) &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = object.getClass();</span><br><span class="line">        List&lt;Field&gt; fieldList = Lists.newArrayList();</span><br><span class="line">        <span class="keyword">while</span> (clazz != <span class="keyword">null</span>) &#123;</span><br><span class="line">            fieldList.addAll(Lists.newArrayList(clazz.getDeclaredFields()));</span><br><span class="line">            clazz = clazz.getSuperclass();</span><br><span class="line">        &#125;</span><br><span class="line">        Field[] fields = <span class="keyword">new</span> Field[fieldList.size()];</span><br><span class="line">        fieldList.toArray(fields);</span><br><span class="line">        <span class="keyword">return</span> fields;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬éœ€è¦åœ¨æ¨¡æ¿æ–¹æ³•çš„å…¥å‚<code>CacheAsideRequest</code>ä¸­æ·»åŠ è¯¥æšä¸¾å­—æ®µã€‚åŒæ—¶æ¨¡æ¿æ–¹æ³•<code>selectCacheOrDb</code>çš„å®ç°ä¹Ÿè¦åšå¯¹åº”ä¿®æ”¹ï¼Œå…·ä½“å¯çœ‹ä»¥ä¸‹ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">selectCacheOrDb</span><span class="params">(CacheAsideRequest&lt;T&gt; cacheAsideRequest)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        String cacheKey = cacheAsideRequest.getCacheKey();</span><br><span class="line">        <span class="comment">// random é˜²æ­¢é›ªå´©</span></span><br><span class="line">        <span class="keyword">int</span> expiredTime = cacheAsideRequest.getExpiredTime() + ThreadLocalRandom.current().nextInt(<span class="number">60</span>);</span><br><span class="line">        TimeUnit timeUnit = cacheAsideRequest.getTimeUnit();</span><br><span class="line">        CacheStrategyEnum cacheStrategyEnum = cacheAsideRequest.getCacheStrategyEnum();</span><br><span class="line">        String cacheValueString = redisTemplate.opsForValue().get(cacheKey);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(cacheValueString)) &#123;</span><br><span class="line">            T dbValue = cacheAsideRequest.getDbSelector().get();</span><br><span class="line">            log.info(<span class="string">&quot;cache miss, query db and the db value is: &#123;&#125;&quot;</span>,dbValue);</span><br><span class="line">            <span class="keyword">if</span> (Objects.nonNull(dbValue)) &#123;</span><br><span class="line">                <span class="comment">// flagçš„å«ä¹‰ï¼šfalseï¼šä¸è¿›è¡Œç¼“å­˜ï¼›trueï¼šè¿›è¡Œç¼“å­˜ã€‚</span></span><br><span class="line">                <span class="keyword">boolean</span> flag;</span><br><span class="line">                <span class="comment">// è§£æListä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡çš„é›¶å€¼</span></span><br><span class="line">                <span class="keyword">if</span> (dbValue <span class="keyword">instanceof</span> List) flag = cacheStrategyEnum.analysisList((List&lt;?&gt;) dbValue);</span><br><span class="line">                <span class="comment">// è§£æå•ä¸ªå¯¹è±¡çš„é›¶å€¼</span></span><br><span class="line">                <span class="keyword">else</span> flag = cacheStrategyEnum.analysisCustomObject(dbValue);</span><br><span class="line">                <span class="keyword">if</span> (flag) redisTemplate.opsForValue().set(</span><br><span class="line">                        cacheKey,</span><br><span class="line">                        JSONObject.toJSONString(dbValue),</span><br><span class="line">                        expiredTime,</span><br><span class="line">                        timeUnit</span><br><span class="line">                );</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> dbValue;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            T t = JSONObject.parseObject(cacheValueString, <span class="keyword">new</span> TypeReference&lt;T&gt;() &#123;&#125;);</span><br><span class="line">            log.info(<span class="string">&quot;hit cache, the cache value is: &#123;&#125;&quot;</span>,cacheValueString);</span><br><span class="line">            <span class="keyword">return</span> t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;query cache or db error!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> cacheAsideRequest.getDefaultValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä»‹ç»äº†äº‘è®¾è®¡æ¨¡å¼ä¹‹ç¼“å­˜å¤‡ç”¨æ¨¡å¼çš„åŸºæœ¬æ¦‚å¿µå’ŒåŸç†ï¼Œç„¶åä½¿ç”¨äº†ä¸€ä¸ªè¾ƒä¸ºé€šç”¨çš„æ¨¡æ¿æ–¹æ³•å®ç°äº†ç¼“å­˜å¤‡ç”¨æ¨¡å¼ï¼Œæœ€åæˆ‘ä»¬è¿˜å¯¹æ¨¡æ¿æ–¹æ³•ä¸­ä¸€äº›å¯èƒ½å‡ºç°çš„ä¸šåŠ¡ç»†èŠ‚è¿›è¡Œäº†æ‰©å±•ï¼Œè¿™å¯¹ç°æœ‰çš„ä¸šåŠ¡ç³»ç»Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®ç°å‚è€ƒã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://docs.microsoft.com/en-us/previous-versions/msp-n-p/dn589799(v=pandp.10)">https://docs.microsoft.com/en-us/previous-versions/msp-n-p/dn589799(v=pandp.10)</a></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> äº‘è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> äº‘è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginxå®‰è£…ä¸å¸è½½</title>
      <link href="2021/01/01/ops/nginx/install-nginx/"/>
      <url>2021/01/01/ops/nginx/install-nginx/</url>
      
        <content type="html"><![CDATA[<h2 id="Nginxå®‰è£…çš„ä¸¤ç§æ–¹å¼"><a href="#Nginxå®‰è£…çš„ä¸¤ç§æ–¹å¼" class="headerlink" title="Nginxå®‰è£…çš„ä¸¤ç§æ–¹å¼"></a><code>Nginx</code>å®‰è£…çš„ä¸¤ç§æ–¹å¼</h2><h3 id="æ–¹å¼ä¸€ï¼šyumæºå®‰è£…"><a href="#æ–¹å¼ä¸€ï¼šyumæºå®‰è£…" class="headerlink" title="æ–¹å¼ä¸€ï¼šyumæºå®‰è£…"></a>æ–¹å¼ä¸€ï¼š<code>yum</code>æºå®‰è£…</h3><p>æˆ‘ä»¬ä½¿ç”¨<code>Nginx</code>å®˜æ–¹çš„<code>yum</code>æºã€‚å¯å» <a href="http://nginx.org/en/linux_packages.html">http://nginx.org/en/linux_packages.html</a> æŸ¥çœ‹ä¸»çº¿ç‰ˆå’Œç¨³å®šç‰ˆçš„<code>yum</code>æºï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šä½¿ç”¨ç¨³å®šç‰ˆæœ¬ã€‚</p><p>é¦–å…ˆéœ€è¦æ·»åŠ <code>nginx</code>å®˜æ–¹çš„<code>yum</code>æºæ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch &#x2F;etc&#x2F;yum.repos.d&#x2F;nginx.repo</span><br></pre></td></tr></table></figure><p>ç„¶å<code>vim</code>ç¼–è¾‘è¯¥<code>repo</code>æ–‡ä»¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[nginx]</span><br><span class="line">name&#x3D;nginx repo</span><br><span class="line">baseurl&#x3D;http:&#x2F;&#x2F;nginx.org&#x2F;packages&#x2F;centos&#x2F;$releasever&#x2F;$basearch&#x2F;</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">enabled&#x3D;1</span><br></pre></td></tr></table></figure><p>ä¿å­˜åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y nginx</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;bin&#x2F;systemctl start nginx.service</span><br></pre></td></tr></table></figure><h3 id="æ–¹å¼äºŒï¼šæºç ç¼–è¯‘å®‰è£…"><a href="#æ–¹å¼äºŒï¼šæºç ç¼–è¯‘å®‰è£…" class="headerlink" title="æ–¹å¼äºŒï¼šæºç ç¼–è¯‘å®‰è£…"></a>æ–¹å¼äºŒï¼šæºç ç¼–è¯‘å®‰è£…</h3><h2 id="å®‰è£…gccåº“"><a href="#å®‰è£…gccåº“" class="headerlink" title="å®‰è£…gccåº“"></a>å®‰è£…<code>gcc</code>åº“</h2><p><code>nginx</code>ä½¿ç”¨<code>c</code>è¯­è¨€ç¼–å†™ï¼Œæºç ç¼–è¯‘æ–¹å¼éœ€è¦å®‰è£…<code>gcc</code>ç¼–è¯‘å™¨ã€‚ä¸€èˆ¬é˜¿é‡Œäº‘ç­‰äº‘æœåŠ¡å™¨å•†éƒ½ä¼šè‡ªå¸¦<code>gcc</code>ï¼Œå¦‚æœç”¨çš„æ˜¯è™šæ‹Ÿæœºï¼Œå¯ä»¥å…ˆæ£€æŸ¥æ˜¯å¦å·²å®‰è£…ã€‚</p><p>ä½¿ç”¨å‘½ä»¤<code>gcc -v</code>å¯æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚æœæç¤ºå‘½ä»¤æ‰¾ä¸åˆ°ï¼Œåˆ™éœ€è¦æ‰§è¡Œ<code>yum -y install gcc</code>å®‰è£…<code>gcc</code>ã€‚</p><h2 id="pcreã€pcre-develå®‰è£…"><a href="#pcreã€pcre-develå®‰è£…" class="headerlink" title="pcreã€pcre-develå®‰è£…"></a><code>pcre</code>ã€<code>pcre-devel</code>å®‰è£…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y pcre pcre-devel</span><br></pre></td></tr></table></figure><p><code>pcre</code>æ˜¯ä¸€ä¸ª<code>perl</code>åº“ï¼ŒåŒ…æ‹¬<code>perl</code>å…¼å®¹çš„æ­£åˆ™è¡¨è¾¾å¼åº“ï¼Œ<code>nginx</code>çš„<code>http</code>æ¨¡å—ä½¿ç”¨<code>pcre</code>æ¥è§£ææ­£åˆ™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œå®‰è£…ã€‚</p><h2 id="zlibå®‰è£…"><a href="#zlibå®‰è£…" class="headerlink" title="zlibå®‰è£…"></a><code>zlib</code>å®‰è£…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y zlib zlib-devel</span><br></pre></td></tr></table></figure><p><code>zlib</code>åº“æä¾›äº†å¤šç§å‹ç¼©å’Œè§£å‹ç¼©çš„æ–¹å¼ï¼Œ<code>nginx</code>ä½¿ç”¨<code>zlib</code>å¯¹<code>http</code>åŒ…çš„å†…å®¹è¿›è¡Œ<code>gzip</code>å‹ç¼©ï¼Œæ‰€ä»¥éœ€è¦å®‰è£…ã€‚</p><h2 id="opensslå®‰è£…"><a href="#opensslå®‰è£…" class="headerlink" title="opensslå®‰è£…"></a><code>openssl</code>å®‰è£…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y openssl openssl-devel</span><br></pre></td></tr></table></figure><p>å¯ç”¨æ¥åŠ å¯†<code>https</code>åè®®ã€‚</p><h2 id="ä¸‹è½½Nginxæºç åŒ…"><a href="#ä¸‹è½½Nginxæºç åŒ…" class="headerlink" title="ä¸‹è½½Nginxæºç åŒ…"></a>ä¸‹è½½<code>Nginx</code>æºç åŒ…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;nginx.org&#x2F;download&#x2F;nginx-1.18.0.tar.gz</span><br></pre></td></tr></table></figure><p>å¯ä»¥å»<a href="http://nginx.org/download/"><code>http://nginx.org/download/</code></a>é¡µé¢æŸ¥çœ‹æ›´å¤šç‰ˆæœ¬ä¿¡æ¯ï¼Œé€‰æ‹©ç¨³å®šç‰ˆæœ¬ä¸‹è½½å³å¯ã€‚</p><h2 id="è§£å‹å¹¶ç¼–è¯‘å®‰è£…"><a href="#è§£å‹å¹¶ç¼–è¯‘å®‰è£…" class="headerlink" title="è§£å‹å¹¶ç¼–è¯‘å®‰è£…"></a>è§£å‹å¹¶ç¼–è¯‘å®‰è£…</h2><p>è§£å‹è‡³å½“å‰ç›®å½•å³å¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf nginx-1.18.0.tar.gz</span><br></pre></td></tr></table></figure><p>è§£å‹å®Œæˆåè¿›å…¥<code>nginx</code>ç›®å½•ï¼š<code>cd nginx-1.18.0</code></p><p>è®¾ç½®<code>nginx</code>çš„å®‰è£…è·¯å¾„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;opt&#x2F;nginx</span><br></pre></td></tr></table></figure><p><code>--prefix</code>è¡¨ç¤ºå°†<code>nginx</code>å®‰è£…è‡³<code>/opt/nginx</code>ç›®å½•ä¸‹ã€‚</p><p>æœ€åä¸€æ­¥ï¼Œè¿›è¡Œç¼–è¯‘å’Œå®‰è£…ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp; make install</span><br></pre></td></tr></table></figure><p>å¯åŠ¨<code>nginx</code>æœåŠ¡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;opt&#x2F;nginx&#x2F;sbin&#x2F;nginx .&#x2F;nginx</span><br></pre></td></tr></table></figure><h2 id="è®¿é—®nginxé¦–é¡µ"><a href="#è®¿é—®nginxé¦–é¡µ" class="headerlink" title="è®¿é—®nginxé¦–é¡µ"></a>è®¿é—®<code>nginx</code>é¦–é¡µ</h2><p>ç›´æ¥è®¿é—®äº‘æœåŠ¡å™¨çš„å…¬ç½‘<code>ip</code>å³å¯ã€‚</p><p>å¦‚æœæ˜¯é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œéœ€è¦å»é˜¿é‡Œäº‘æ§åˆ¶å°æ·»åŠ <code>80</code>ç«¯å£è‡³è¯¥ä¸»æœºçš„å®‰å…¨ç»„å…¥ç½‘æ–¹å‘ã€‚</p><h2 id="å¸è½½å·²å®‰è£…çš„Nginx"><a href="#å¸è½½å·²å®‰è£…çš„Nginx" class="headerlink" title="å¸è½½å·²å®‰è£…çš„Nginx"></a>å¸è½½å·²å®‰è£…çš„<code>Nginx</code></h2><p>é¦–å…ˆéœ€è¦åœæ­¢<code>Nginx</code>æœåŠ¡ï¼š<code>/bin/systemctl stop nginx.service</code></p><p>å¦‚æœæ˜¯ä½¿ç”¨<code>yum</code>æºå®‰è£…çš„ï¼Œå¯ä½¿ç”¨å‘½ä»¤<code>find / -name nginx*</code>æŸ¥çœ‹<code>nginx</code>ç›¸å…³æ–‡ä»¶ï¼Œå…ˆæ‰‹åŠ¨åˆ é™¤ä¸€äº›æºæ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf &#x2F;usr&#x2F;sbin&#x2F;nginx</span><br><span class="line">rm -rf &#x2F;etc&#x2F;nginx</span><br></pre></td></tr></table></figure><p>å†ä½¿ç”¨<code>yum remove nginx</code>æ¸…ç†ã€‚</p><p>å¦‚æœæ˜¯æºç åŒ…ç¼–è¯‘å®‰è£…çš„ï¼Œå…ˆåœæ­¢æœåŠ¡ï¼Œç„¶ååˆ é™¤æ•´ä¸ªå®‰è£…ç›®å½•å³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¿ç»´ </category>
          
          <category> Nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šåˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨</title>
      <link href="2020/12/29/algorithm/leetcode/tag/linkedlist/merge-two-sorted-lists/"/>
      <url>2020/12/29/algorithm/leetcode/tag/linkedlist/merge-two-sorted-lists/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šå°†ä¸¤ä¸ªå‡åºé“¾è¡¨åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„å‡åºé“¾è¡¨å¹¶è¿”å›ã€‚æ–°é“¾è¡¨æ˜¯é€šè¿‡æ‹¼æ¥ç»™å®šçš„ä¸¤ä¸ªé“¾è¡¨çš„æ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„ã€‚ </p><p>ç¤ºä¾‹ï¼š</p><p>è¾“å…¥ï¼š</p><pre class="mermaid">graph LRA[1]-->B[2]B[2]-->C[4]</pre><pre class="mermaid">graph LRA[1]-->B[3]B[3]-->C[4]</pre><p>è¾“å‡ºï¼š</p><pre class="mermaid">graph LRA[1]-->B[1]B[1]-->C[2]C[2]-->D[3]D[3]-->E[4]E[4]-->F[4]</pre><p>æ€è·¯ï¼š</p><p>å·²çŸ¥æ¡ä»¶ï¼šä¸¤ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹<code>l1</code>å’Œ<code>l2</code>ã€‚</p><p>å¯¹äºä¸¤ä¸ªå‡åºé“¾è¡¨ï¼Œå®ƒä»¬çš„é•¿åº¦ä¸ä¸€å®šç›¸ç­‰ï¼Œå½“æˆ‘ä»¬æŠŠè¾ƒçŸ­çš„é“¾è¡¨åˆå¹¶å®Œæˆåï¼Œç›´æ¥è¿æ¥è¾ƒé•¿é“¾è¡¨çš„å‰©ä½™éƒ¨åˆ†å³å¯ã€‚</p><p>æˆ‘ä»¬å¹¶ä¸çŸ¥é“å“ªä¸€ä¸ªçš„å¤´èŠ‚ç‚¹å€¼æ›´å°ï¼Œæ‰€ä»¥éœ€è¦åˆ†ç±»è®¨è®ºã€‚</p><p>é€’å½’æ³•ï¼š</p><p>æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹çš„å…¬å¼å®šä¹‰æˆ‘ä»¬çš„é€’å½’<code>merge</code>æ“ä½œï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/leetcode/merge-two-sorted-lists-formula.png" alt="merge-two-sorted-lists-formula.png"></p><p>åˆ¤æ–­<code>l1</code>å’Œ<code>l2</code>å“ªä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹å€¼è¾ƒå°ï¼Œå°†è¾ƒå°çš„é‚£ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸å¦ä¸€ä¸ªé“¾è¡¨è¿›è¡Œé€’å½’<code>merge</code>ã€‚</p><p>é€’å½’çš„å‡ºå£ï¼šå¦‚æœé€’å½’åˆ°<code>l1[0]</code>æˆ–<code>l2[0]</code>ä¸º<code>null</code>æ—¶ï¼Œç›´æ¥è¿”å›å¦å¤–ä¸€ä¸ªé“¾è¡¨ã€‚å¦å¤–ä¸€ä¸ªé“¾è¡¨å¯èƒ½ä¹Ÿä¸º<code>null</code>ï¼ˆå¦‚æœåŸé“¾è¡¨é•¿åº¦ç›¸ç­‰ï¼‰ï¼Œæˆ–è€…é<code>null</code>ï¼ˆåŸé“¾è¡¨é•¿åº¦ä¸ç­‰ï¼‰ã€‚</p><blockquote><p>å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼š<a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†</a></p></blockquote><p><code>Java</code>è¯­è¨€å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SinglyLinkedListNode <span class="title">mergeTwoSortedLinkedListRecursionImpl</span><span class="params">(SinglyLinkedListNode l1,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                                         SinglyLinkedListNode l2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l1 == <span class="keyword">null</span>) <span class="keyword">return</span> l2;</span><br><span class="line">    <span class="keyword">if</span> (l2 == <span class="keyword">null</span>) <span class="keyword">return</span> l1;</span><br><span class="line">    <span class="keyword">if</span> (l1.val &lt; l2.val) &#123;</span><br><span class="line">        l1.next = mergeTwoSortedLinkedListRecursionImpl(l1.next, l2);</span><br><span class="line">        <span class="keyword">return</span> l1;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        l2.next = mergeTwoSortedLinkedListRecursionImpl(l1,l2.next);</span><br><span class="line">        <span class="keyword">return</span> l2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿­ä»£æ³•ï¼š</p><p>æ­£æ‰€è°“æ‰€æœ‰çš„é€’å½’éƒ½å¯ä»¥è½¬åŒ–æˆè¿­ä»£ã€‚</p><p>ç”±äºå¾…åˆå¹¶çš„ä¸¤ä¸ªé“¾è¡¨éƒ½æœ‰åºï¼Œåˆå¹¶åçš„å¤´èŠ‚ç‚¹è¦ä¹ˆæ˜¯<code>l1</code>è¦ä¹ˆæ˜¯<code>l2</code>ã€‚å¦‚æœæˆ‘ä»¬ä¸å¸Œæœ›ä¿®æ”¹åŸæ¥çš„é“¾è¡¨ï¼Œå°±éœ€è¦æ„é€ å‡ºä¸€ä¸ªæ–°é“¾è¡¨ï¼Œé¡ºåºè¿æ¥ä¸¤ä¸ªåŸé“¾è¡¨çš„å„ä¸ªèŠ‚ç‚¹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå“¨å…µèŠ‚ç‚¹<code>hair</code>ï¼Œç„¶åç»´æŠ¤ä¸€ä¸ª<code>cur</code>æŒ‡é’ˆï¼Œæ¯æ¬¡ä½¿ç”¨<code>cur</code>æŒ‡é’ˆå»è¿æ¥å„ä¸ªèŠ‚ç‚¹ã€‚æˆ‘ä»¬ä¾æ¬¡æ¯”è¾ƒ<code>l1</code>å’Œ<code>l2</code>èŠ‚ç‚¹çš„å€¼ï¼Œå¦‚æœ<code>l1</code>çš„å€¼å°äº<code>l2</code>ï¼Œåˆ™ç”¨<code>cur</code>è¿æ¥<code>l1</code>ï¼Œç„¶å<code>l1</code>å³ç§»ï¼›å¦åˆ™ï¼Œç”¨<code>cur</code>è¿æ¥<code>l2</code>ï¼Œç„¶å<code>l2</code>å³ç§»ã€‚ç›´åˆ°<code>l1</code>æˆ–è€…<code>l2</code>ä¸º<code>null</code>ï¼Œå°†å¦ä¸€ä¸ªèŠ‚ç‚¹çš„å‰©ä½™èŠ‚ç‚¹è¿æ¥è‡³<code>cur</code>ï¼Œç„¶åå†è¿”å›<code>hair.next</code>ï¼Œå³ä¸ºåˆå¹¶åé“¾è¡¨çš„æ–°å¤´èŠ‚ç‚¹ã€‚</p><blockquote><p>å“¨å…µèŠ‚ç‚¹<code>hair</code>ï¼šæŒ‡é’ˆåŸŸ<code>next</code>æŒ‡å‘çš„èŠ‚ç‚¹å³ä¸ºåˆå¹¶åçš„é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚</p></blockquote><p><code>Java</code>è¯­è¨€å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SinglyLinkedListNode <span class="title">mergeTwoSortedLinkedList</span><span class="params">(SinglyLinkedListNode l1,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                            SinglyLinkedListNode l2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l1 == <span class="keyword">null</span>) <span class="keyword">return</span> l2;</span><br><span class="line">    <span class="keyword">if</span> (l2 == <span class="keyword">null</span>) <span class="keyword">return</span> l1;</span><br><span class="line">    SinglyLinkedListNode hair = <span class="keyword">new</span> SinglyLinkedListNode();</span><br><span class="line">    SinglyLinkedListNode cur = hair;</span><br><span class="line">    <span class="keyword">while</span> (l1 != <span class="keyword">null</span> &amp;&amp; l2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (l1.val &lt; l2.val) &#123;</span><br><span class="line">            cur.next = l1;</span><br><span class="line">            l1 = l1.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cur.next = l2;</span><br><span class="line">            l2 = l2.next;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l1 == <span class="keyword">null</span>) cur.next = l2;</span><br><span class="line">    <span class="keyword">if</span> (l2 == <span class="keyword">null</span>) cur.next = l1;</span><br><span class="line">    <span class="keyword">return</span> hair.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> LeetCode </category>
          
          <category> é“¾è¡¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šåˆ é™¤ä¸­é—´èŠ‚ç‚¹</title>
      <link href="2020/12/27/algorithm/leetcode/tag/linkedlist/delete-middle-node-lcci/"/>
      <url>2020/12/27/algorithm/leetcode/tag/linkedlist/delete-middle-node-lcci/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šå®ç°ä¸€ç§ç®—æ³•ï¼Œåˆ é™¤å•å‘é“¾è¡¨ä¸­é—´çš„æŸä¸ªèŠ‚ç‚¹ï¼ˆå³ä¸æ˜¯ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œå‡å®šä½ åªèƒ½è®¿é—®è¯¥èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre class="mermaid">graph LRA[a]-->B[b]B[b]-->C[c]C[c]-->D[d]D[d]-->E[e]</pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šèŠ‚ç‚¹c</span><br><span class="line">ç»“æœï¼šä¸è¿”å›ä»»ä½•æ•°æ®ï¼Œå°†èŠ‚ç‚¹cä»åŸé“¾è¡¨ä¸­åˆ é™¤ã€‚</span><br></pre></td></tr></table></figure><p>æ€è·¯ï¼šè¿™é¢˜çš„æ€è·¯æœ‰ç‚¹æ„æ€ã€‚é¦–å…ˆæˆ‘ä»¬åªèƒ½è®¿é—®åˆ°èŠ‚ç‚¹<code>c</code>ï¼ŒæŒ‰ç…§å¸¸è§„æ€è·¯ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ é™¤èŠ‚ç‚¹<code>c</code>ï¼Œå°±è¦å°†<code>c</code>çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹<code>b</code>æŒ‡å‘<code>c</code>çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹<code>d</code>ï¼Œä½†æˆ‘ä»¬åªèƒ½è®¿é—®èŠ‚ç‚¹<code>c</code>å’Œ<code>d</code>ï¼Œç”±äºå•å‘é“¾è¡¨çš„ç‰¹æ€§ï¼ŒèŠ‚ç‚¹<code>b</code>æˆ‘ä»¬æ˜¯æ— æ³•è®¿é—®çš„ã€‚é‚£æˆ‘ä»¬è¯¥å¦‚ä½•â€œç¥ä¸çŸ¥é¬¼ä¸è§‰â€çš„åˆ é™¤èŠ‚ç‚¹<code>c</code>å‘¢ï¼Ÿ</p><p>â€œå·å¤©æ¢æ—¥â€ï¼šæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®©<code>b</code>æŒ‡å‘<code>d</code>ï¼Œä½†æˆ‘ä»¬æ— æ³•ç›´æ¥æ“ä½œ<code>b</code>ï¼Œè€Œ<code>b</code>åˆä¸€ç›´æŒ‡å‘<code>c</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠ<code>c</code>æ›¿æ¢ä¸º<code>d</code>ï¼Œç„¶åå†æŠŠ<code>d</code>åˆ é™¤å³å¯ã€‚</p><blockquote><p>åˆ ä¸æ‰æˆ‘è‡ªå·±(<code>c</code>)ï¼Œæˆ‘å°±å˜æˆä½ (<code>d</code>)ï¼Œå†åˆ æ‰ä½ (<code>d</code>)ï¼Œå°±ç­‰äºåˆ æ‰æˆ‘è‡ªå·±(<code>c</code>)ã€‚</p></blockquote><p><code>Java</code>è¯­è¨€å®ç°å¦‚ä¸‹ï¼š</p><blockquote><p>å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼š<a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteNode</span><span class="params">(SinglyLinkedListNode node)</span> </span>&#123;</span><br><span class="line">    SinglyLinkedListNode next = node.next;</span><br><span class="line">    node.val = next.val;</span><br><span class="line">    node.next = next.next;</span><br><span class="line">    next = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> LeetCode </category>
          
          <category> é“¾è¡¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šè¿”å›å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹</title>
      <link href="2020/12/23/algorithm/leetcode/tag/linkedlist/kth-node-from-end-of-list-lcci/"/>
      <url>2020/12/23/algorithm/leetcode/tag/linkedlist/kth-node-from-end-of-list-lcci/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šå®ç°ä¸€ç§ç®—æ³•ï¼Œæ‰¾å‡ºå•å‘é“¾è¡¨ä¸­å€’æ•°ç¬¬<code>k</code>ä¸ªèŠ‚ç‚¹ã€‚è¿”å›è¯¥èŠ‚ç‚¹çš„å€¼ã€‚</p><p><code>Leetcode</code>åœ¨çº¿<code>OJ</code>ç³»ç»Ÿï¼š<a href="https://leetcode-cn.com/problems/kth-node-from-end-of-list-lcci/">ä¼ é€é—¨</a></p><p>ç¤ºä¾‹ï¼š</p><pre class="mermaid">graph LRA[1]-->B[2]B[2]-->C[3]C[3]-->D[4]D[4]-->E[5]</pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šk &#x3D; 2</span><br><span class="line">è¾“å‡ºï¼š4</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šç»™å®šçš„ k ä¿è¯æ˜¯æœ‰æ•ˆçš„ã€‚</p></blockquote><p>æ€è·¯ï¼šåŒæŒ‡é’ˆæ³•ã€‚å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆ<code>first</code>å’Œ<code>second</code>ï¼Œ<code>first</code>æŒ‡é’ˆå…ˆèµ°<code>k - 1</code>æ­¥ï¼Œç„¶å<code>second</code>æŒ‡é’ˆå’Œ<code>first</code>æŒ‡é’ˆåŒæ—¶èµ°ï¼Œæ¯æ¬¡èµ°ä¸€æ­¥ï¼Œå½“<code>first</code>æŒ‡é’ˆåˆ°è¾¾é“¾è¡¨æœ«å°¾æ—¶ï¼Œ<code>second</code>æŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹å³ä¸ºå€’æ•°ç¬¬<code>k</code>ä¸ªèŠ‚ç‚¹ã€‚</p><p><code>Java</code>è¯­è¨€å®ç°å¦‚ä¸‹ï¼š</p><blockquote><p>å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼š<a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">kthToLast</span><span class="params">(SinglyLinkedListNode head, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || k &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    SinglyLinkedListNode first = head;</span><br><span class="line">    SinglyLinkedListNode second = head;</span><br><span class="line">    <span class="keyword">while</span> (k-- &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// é•¿åº¦ä¸è¶³k</span></span><br><span class="line">        <span class="keyword">if</span> (first.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        first = first.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (first.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        first = first.next;</span><br><span class="line">        second = second.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> second.val</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> LeetCode </category>
          
          <category> é“¾è¡¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯</title>
      <link href="2020/12/22/algorithm/base/datastructure/link-has-cycle/"/>
      <url>2020/12/22/algorithm/base/datastructure/link-has-cycle/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šåˆ¤æ–­ç»™å®šçš„é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚å¦‚æœæœ‰ç¯åˆ™è¿”å›<code>true</code>ï¼Œå¦åˆ™è¿”å›<code>false</code>ã€‚ä½ èƒ½ç»™å‡ºç©ºé—´å¤æ‚åº¦<code>O(1)</code>çš„è§£æ³•ä¹ˆï¼Ÿ</p><p><code>Leetcode</code>åœ¨çº¿<code>OJ</code>ç³»ç»Ÿï¼š<a href="https://leetcode-cn.com/problems/linked-list-cycle/">ä¼ é€é—¨</a></p><p>ç¤ºä¾‹<code>1</code>ï¼š</p><pre class="mermaid">graph LRA[3]-->B[2]B[2]-->C[0]C[0]-->D[-4]D[-4]-->B[2]</pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡ºï¼štrue</span><br><span class="line">è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œç”± -4 æŒ‡å‘ 2 </span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹<code>2</code>:</p><pre class="mermaid">graph LRA[1]-->B[2]B[2]-->A[1]</pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡ºï¼š&#96;true&#96;</span><br><span class="line">è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œç”± 2 æŒ‡å‘ 1 </span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹<code>3</code>ï¼š</p><pre class="mermaid">graph LRA[1]</pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡ºï¼š&#96;false&#96;</span><br><span class="line">è§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯</span><br></pre></td></tr></table></figure><p>æ€è·¯ï¼šå°†é“¾è¡¨æƒ³è±¡æˆæ ¡å›­é‡Œçš„æ“åœºï¼Œä¸¤ä½åŒå­¦ä»åŒä¸€èµ·ç‚¹å¼€å§‹æ¯”èµ›è·‘æ­¥ï¼Œå‡ºå‘åï¼Œå¦‚æœä¸¤ä½åŒå­¦çš„è·‘æ­¥é€Ÿåº¦ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆè·‘è¿‡è‹¥å¹²åœˆåï¼Œä»–ä»¬ä¸€å®šä¼šåœ¨è·‘é“çš„æŸå¤„ç›¸é‡ï¼Œä¸”è·‘çš„å¿«çš„åŒå­¦æ°å¥½æ¯”è·‘çš„æ…¢çš„åŒå­¦å¤šè·‘ä¸€åœˆã€‚è¿™æ˜¯ç‰©ç†è¿åŠ¨å­¦ä¸Šçš„ç»å…¸è¿½å‡»é—®é¢˜ã€‚</p><p>å¯¹äºé“¾è¡¨æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€å¿«ä¸€æ…¢ä¸¤ä¸ªæŒ‡é’ˆï¼Œè®©å®ƒä»¬åŒæ—¶ä»å¤´èŠ‚ç‚¹åŒæ—¶å‡ºå‘ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡èµ°ä¸€æ­¥ï¼Œå¦‚æœå®ƒä»¬æœ€ç»ˆèƒ½åœ¨æŸå¤„â€œç›¸é‡â€ï¼Œè¯´æ˜é“¾è¡¨æœ‰ç¯ï¼Œå¦‚æœå¿«æŒ‡é’ˆèµ°åˆ°é“¾è¡¨æœ«å°¾éƒ½æ²¡æœ‰è¿½ä¸Šèµ°çš„æ…¢çš„æŒ‡é’ˆï¼Œè¯´æ˜é“¾è¡¨æ— ç¯ã€‚</p><p>ä»¥ä¸Šçš„æ€è·¯ä¿—ç§°ï¼šâ€œå¿«æ…¢æŒ‡é’ˆæ³•â€ï¼›å­¦åï¼š<code>Floyd</code>åˆ¤åœˆç®—æ³•ã€‚</p><blockquote><p><code>Floyd</code>åˆ¤åœˆç®—æ³•ï¼ˆ<code>Floyd Cycle Detection Algorithm</code>ï¼‰ï¼Œåˆç§°é¾Ÿå…”èµ›è·‘ç®—æ³•(<code>Tortoise and Hare Algorithm</code>),æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨æœ‰é™çŠ¶æ€æœºã€è¿­ä»£å‡½æ•°æˆ–è€…é“¾è¡¨ä¸Šåˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¯ï¼Œä»¥åŠåˆ¤æ–­ç¯çš„èµ·ç‚¹ä¸é•¿åº¦çš„ç®—æ³•ã€‚</p></blockquote><p><code>Java</code>è¯­è¨€å®ç°å¦‚ä¸‹ï¼š</p><blockquote><p>å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼š<a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">hasCycle</span><span class="params">(SinglyLinkedListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    SinglyLinkedListNode fast = head;</span><br><span class="line">    SinglyLinkedListNode slow = head;</span><br><span class="line">    <span class="keyword">while</span> (fast != <span class="keyword">null</span> &amp;&amp; fast.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        fast = fast.next.next;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">        <span class="keyword">if</span> (fast == slow) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ‰‹å®ç°Lombok</title>
      <link href="2020/12/19/javaee/lombok/impl-simple-lombok/"/>
      <url>2020/12/19/javaee/lombok/impl-simple-lombok/</url>
      
        <content type="html"><![CDATA[<h2 id="Javacç¼–è¯‘å™¨"><a href="#Javacç¼–è¯‘å™¨" class="headerlink" title="Javacç¼–è¯‘å™¨"></a><code>Javac</code>ç¼–è¯‘å™¨</h2><p>æåˆ°ç¼–è¯‘å™¨ï¼Œå¯èƒ½å¾ˆå¤šåç«¯ç ”å‘å·¥ç¨‹å¸ˆåªæ˜¯åœ¨è„‘æµ·ä¸­æœ‰ä¸€ä¸ªæ¨¡ç³Šçš„æ¦‚å¿µï¼Œæˆ‘ä¹Ÿæ˜¯è¿™æ ·ï¼Œå› ä¸ºä¸šåŠ¡å¼€å‘ä¸­å‡ ä¹ä½¿ç”¨ä¸åˆ°ã€‚æˆ‘ä»¬éƒ½å·¥ä½œåœ¨ç¼–è¯‘å™¨çš„ä¸Šå±‚ã€‚</p><p>å¯¹äº<code>Java</code>è¯­è¨€æ¥è¯´ï¼Œå®ƒçš„æ•´ä¸ªç¼–è¯‘æœŸæ˜¯ä¸ç¡®å®šçš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å†™çš„<code>.java</code>ç±»æ–‡ä»¶éœ€è¦è¢«ç¼–è¯‘æˆ<code>.class</code>å­—èŠ‚ç æ–‡ä»¶ç„¶ååŠ è½½è‡³è™šæ‹Ÿæœºä¸­ï¼Œ<code>.class</code>å­—èŠ‚ç æ–‡ä»¶éœ€è¦è¢«ç¼–è¯‘æˆæœºå™¨ç è¿›è¡Œæ‰§è¡Œï¼Œå½“ç„¶ä¹Ÿæœ‰ç›´æ¥å°†<code>.java</code>ç±»æ–‡ä»¶ç¼–è¯‘æˆæœºå™¨ç çš„ç¼–è¯‘å™¨ã€‚</p><p><code>Javac</code>ç¼–è¯‘å™¨æ˜¯ä¸€ä¸ªå°†<code>.java</code>æ–‡ä»¶ç¼–è¯‘æˆ<code>.class</code>å­—èŠ‚ç çš„ç¼–è¯‘å™¨ï¼Œå®ƒå¯ä»¥åœ¨ä¸æ”¹å˜åº•å±‚è™šæ‹Ÿæœºçš„æƒ…å†µä¸‹å¯¹ç¨‹åºç¼–ç è¿›è¡Œç¼–è¯‘æœŸçš„ä¼˜åŒ–ï¼Œå³ï¼šè¯­æ³•ç³–ã€‚</p><p>ä»<code>sun</code>å…¬å¸æä¾›çš„<code>Javac</code>ç¼–è¯‘å™¨ä»£ç ï¼ˆæºç åœ¨<code>JDK</code>çš„<code>tool.jar</code>åŒ…ä¸­ï¼‰å®ç°æ¥çœ‹ï¼Œç¼–è¯‘çš„è¿‡ç¨‹å¯åˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li><code>Parse and Enter</code>ï¼šè§£æä¸å¡«å……ç¬¦å·è¡¨ï¼Œç¼–è¯‘å™¨ä¼šå°†<code>Java</code>æ–‡ä»¶è§£ææˆ<code>Abstract Syntax Tree</code>ï¼ˆ<code>AST</code>ï¼‰æŠ½è±¡è¯­æ³•æ ‘ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šæ ¡éªŒè¯­æ³•çš„æ­£ç¡®æ€§ç­‰ã€‚</li><li><code>Annotation Processing</code>ï¼šæ’å…¥å¼æ³¨è§£å¤„ç†å™¨çš„æ³¨è§£å¤„ç†ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥å¯¹è¯­æ³•æ ‘è¿›è¡Œç›¸å…³æ“ä½œã€‚</li><li><code>Analyse and Generate</code>ï¼šåˆ†æè¯­æ³•æ ‘ä¸å­—èŠ‚ç ç”Ÿæˆã€‚</li></ul><p>åœ¨<code>JDK5</code>åï¼Œ<code>Java</code>è¯­è¨€å¼•å…¥äº†æ³¨è§£ï¼Œè¿™äº›æ³¨è§£ä¸æ™®é€šçš„<code>Java</code>ç±»ä¸€æ ·ï¼Œæ˜¯åœ¨è¿è¡ŒæœŸé—´å‘æŒ¥ä½œç”¨çš„ã€‚<code>JDK6</code>å®ç°äº†<code>JSR-269</code>è§„èŒƒï¼Œæä¾›å‡ºä¸€ç»„æ’å…¥å¼æ³¨è§£å¤„ç†å™¨çš„æ ‡å‡†<code>API</code>åœ¨ç¼–è¯‘æœŸé—´å¯¹æ³¨è§£è¿›è¡Œå¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ç»„ç¼–è¯‘å™¨çš„æ’ä»¶ï¼Œæˆ–è€…ç§°ä¸ºé’©å­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›<code>API</code>å¯¹ç¬¬ä¸€é˜¶æ®µäº§ç”Ÿçš„è¯­æ³•æ ‘è¿›è¡Œä¿®æ”¹ï¼Œä¸€æ—¦è¯­æ³•æ ‘è¢«ä¿®æ”¹ï¼Œç¼–è¯‘å™¨å°†ä¼šå›åˆ°ç¬¬ä¸€é˜¶æ®µé‡æ–°è§£æä¸å¡«å……ç¬¦å·è¡¨ï¼Œç›´åˆ°æ‰€æœ‰çš„æ’å…¥å¼æ³¨è§£å¤„ç†å™¨éƒ½æ²¡æœ‰å†å¯¹è¯­æ³•æ ‘è¿›è¡Œä¿®æ”¹ä¸ºæ­¢ï¼Œæ¯ä¸€æ¬¡å›åˆ°ç¬¬ä¸€é˜¶æ®µç§°ä¸ºä¸€æ¬¡<code>Round</code>ã€‚</p><p><code>Javac</code>ç¼–è¯‘å™¨çš„æºç æ˜¯<code>com.sun.tools.javac.main.JavaCompiler</code>ç±»ï¼Œç¼–è¯‘çš„æ–¹æ³•æ˜¯<code>com.sun.tools.javac.main.JavaCompiler#compile</code>ï¼Œå…¶ä¸­æ’å…¥æ³¨è§£å¤„ç†å™¨çš„åˆå§‹åŒ–è¿‡ç¨‹æ˜¯åœ¨<code>this.initProcessAnnotations(var3);</code>æ–¹æ³•ä¸­å®Œæˆçš„ï¼›æ‰§è¡Œè¿‡ç¨‹æ˜¯åœ¨<code>com.sun.tools.javac.main.JavaCompiler#processAnnotations</code>æ–¹æ³•ä¸­å®Œæˆçš„ï¼Œè¯¥æ–¹æ³•ä¸­åˆ¤æ–­æ˜¯å¦è¿˜æœ‰æ–°çš„æ³¨è§£å¤„ç†å™¨éœ€è¦æ‰§è¡Œï¼Œå¦‚æœæœ‰çš„è¯ï¼Œé€šè¿‡<code>com.sun.tools.javac.processing.JavacProcessingEnvironment#doProcessing</code>æ–¹æ³•å¾—åˆ°ä¸€ä¸ªæ–°çš„<code>JavaCompiler</code>ç±»å¯¹è±¡ç»§ç»­åç»­çš„å¤„ç†ã€‚</p><h2 id="Lombokçš„åŸç†"><a href="#Lombokçš„åŸç†" class="headerlink" title="Lombokçš„åŸç†"></a><code>Lombok</code>çš„åŸç†</h2><p><code>Lombok</code>æ­£æ˜¯åˆ©ç”¨<code>Javac</code>ç¼–è¯‘å™¨çš„ç¬¬äºŒé˜¶æ®µè¿›è¡Œå®ç°çš„ï¼Œä½¿ç”¨çš„ä¹Ÿæ­£æ˜¯<code>JDK6</code>æä¾›çš„<code>JSR-269</code>å®ç°ã€‚åœ¨ç¼–è¯‘æœŸæ“ä½œè¯­æ³•æ ‘ï¼Œå®ç°å­—èŠ‚ç çš„åŠ¨æ€ç”Ÿæˆã€‚</p><h2 id="é€ è½®å­"><a href="#é€ è½®å­" class="headerlink" title="é€ è½®å­"></a>é€ è½®å­</h2><p>æˆ‘ä»¬è¦å®ç°çš„æ˜¯ä¸€ä¸ªç®€æ˜“çš„<code>Lombok</code>ï¼Œä¸€ä¸ªæ³¨è§£åœ¨ç¼–è¯‘æœŸåŒæ—¶ç”Ÿæˆ<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•ã€‚</p><h3 id="è‡ªå®šä¹‰æ³¨è§£"><a href="#è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="è‡ªå®šä¹‰æ³¨è§£"></a>è‡ªå®šä¹‰æ³¨è§£</h3><p>é¦–å…ˆè¦å®šä¹‰ä¸€ä¸ªæ³¨è§£<code>@GetterAndSetter</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser admin@lilu.org.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2020/12/15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.SOURCE)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> GetterAndSetter &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨"><a href="#è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨" class="headerlink" title="è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨"></a>è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨</h3><p>ç„¶åå®šä¹‰ä¸€ä¸ªå¤„ç†<code>@GetterAndSetter</code>æ³¨è§£çš„å¤„ç†å™¨<code>GetterAndSetterProcessor</code>ï¼Œæ‰€æœ‰çš„å¤„ç†å™¨éƒ½å»ºè®®å»ç»§æ‰¿<code>javax.annotation.processing.AbstractProcessor</code>æŠ½è±¡ç±»ï¼Œå®ƒæä¾›äº†ä¸€äº›åŸºæœ¬å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.auto.service.AutoService;</span><br><span class="line"><span class="keyword">import</span> com.sun.source.util.Trees;</span><br><span class="line"><span class="keyword">import</span> com.sun.tools.javac.processing.JavacProcessingEnvironment;</span><br><span class="line"><span class="keyword">import</span> com.sun.tools.javac.tree.JCTree;</span><br><span class="line"><span class="keyword">import</span> com.sun.tools.javac.tree.TreeMaker;</span><br><span class="line"><span class="keyword">import</span> com.sun.tools.javac.util.Context;</span><br><span class="line"><span class="keyword">import</span> com.sun.tools.javac.util.Names;</span><br><span class="line"><span class="keyword">import</span> org.sunchaser.lombok.impl.annotation.GetterAndSetter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.processing.*;</span><br><span class="line"><span class="keyword">import</span> javax.lang.model.SourceVersion;</span><br><span class="line"><span class="keyword">import</span> javax.lang.model.element.Element;</span><br><span class="line"><span class="keyword">import</span> javax.lang.model.element.TypeElement;</span><br><span class="line"><span class="keyword">import</span> javax.tools.Diagnostic;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰<span class="doctag">@GetterAndSetter</span>æ³¨è§£çš„æ’å…¥å¤„ç†å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser admin@lilu.org.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2020/12/15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SupportedAnnotationTypes(&#123;&quot;org.sunchaser.lombok.impl.annotation.GetterAndSetter&quot;&#125;)</span></span><br><span class="line"><span class="meta">@SupportedSourceVersion(SourceVersion.RELEASE_8)</span></span><br><span class="line"><span class="meta">@AutoService(Processor.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetterAndSetterProcessor</span> <span class="keyword">extends</span> <span class="title">AbstractProcessor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯å°†Elementè½¬æ¢æˆJCTreeï¼Œç»„æˆASTè¯­æ³•æ ‘ã€‚ä½¿ç”¨Trees.instance(processingEnv);è¿›è¡Œåˆå§‹åŒ–ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Trees trees;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„é€ JCTreeçš„å·¥å…·ç±»ã€‚ä½¿ç”¨TreeMaker.instance(((JavacProcessingEnvironment) processingEnv).getContext());åˆå§‹åŒ–ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> TreeMaker treeMaker;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åå­—å¤„ç†å·¥å…·ç±»ã€‚ä½¿ç”¨Names.instance(context);è¿›è¡Œåˆå§‹åŒ–ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Names names;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼–è¯‘æœŸçš„æ—¥å¿—æ‰“å°å·¥å…·ç±»ã€‚ä½¿ç”¨processingEnv.getMessager();è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Messager messager;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * init åˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> processingEnv ç¯å¢ƒï¼šæä¾›ä¸€äº›Javacçš„æ‰§è¡Œå·¥å…·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ProcessingEnvironment processingEnv)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.init(processingEnv);</span><br><span class="line">        <span class="keyword">this</span>.messager = processingEnv.getMessager();</span><br><span class="line">        <span class="keyword">this</span>.trees = Trees.instance(processingEnv);</span><br><span class="line">        Context context = ((JavacProcessingEnvironment) processingEnv).getContext();</span><br><span class="line">        <span class="keyword">this</span>.treeMaker = TreeMaker.instance(context);</span><br><span class="line">        <span class="keyword">this</span>.names = Names.instance(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…·ä½“çš„æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> annotations   æ³¨è§£é›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> roundEnv      æ‰§è¡Œroundç¯å¢ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ‰§è¡Œç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">process</span><span class="params">(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv)</span> </span>&#123;</span><br><span class="line">        messager.printMessage(Diagnostic.Kind.NOTE,<span class="string">&quot;roundEnv ---&gt;&quot;</span> + roundEnv);</span><br><span class="line">        <span class="keyword">if</span> (!roundEnv.processingOver()) &#123;</span><br><span class="line">            <span class="comment">// æ‰€æœ‰@GetterAndSetteræ³¨è§£æ ‡æ³¨çš„ç±»</span></span><br><span class="line">            Set&lt;? extends Element&gt; annotated = roundEnv.getElementsAnnotatedWith(GetterAndSetter.class);</span><br><span class="line">            annotated.forEach(element -&gt; &#123;</span><br><span class="line">                <span class="comment">// è·å¾—å½“å‰éå†ç±»çš„è¯­æ³•æ ‘</span></span><br><span class="line">                JCTree tree = (JCTree) trees.getTree(element);</span><br><span class="line">                <span class="comment">// ä½¿ç”¨GetterAndSetterTreeTranslatorå¤„ç†</span></span><br><span class="line">                tree.accept(<span class="keyword">new</span> GetterAndSetterTreeTranslator(treeMaker, names, messager));</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿”å›trueï¼šJavacç¼–è¯‘å™¨ä¼šä»ç¼–è¯‘æœŸçš„ç¬¬äºŒé˜¶æ®µå›åˆ°ç¬¬ä¸€é˜¶æ®µ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰å¤„ç†å™¨æ”¯æŒçš„æ³¨è§£ç±»å‹é›†åˆ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * JDK7åå¯ç”¨æ³¨è§£<span class="doctag">@SupportedAnnotationTypes</span>ä»£æ›¿è¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ³¨è§£ç±»å…¨é™å®šç±»åå­—ç¬¦ä¸²çš„é›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;String&gt; <span class="title">getSupportedAnnotationTypes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getSupportedAnnotationTypes();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ”¯æŒçš„JDKç‰ˆæœ¬</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * JDK7åå¯ç”¨æ³¨è§£<span class="doctag">@SupportedSourceVersion</span>ä»£æ›¿è¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> JDKç‰ˆæœ¬</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SourceVersion <span class="title">getSupportedSourceVersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SourceVersion.latestSupported();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³¨è§£å¤„ç†å™¨çš„å®ç°ç»†èŠ‚"><a href="#æ³¨è§£å¤„ç†å™¨çš„å®ç°ç»†èŠ‚" class="headerlink" title="æ³¨è§£å¤„ç†å™¨çš„å®ç°ç»†èŠ‚"></a>æ³¨è§£å¤„ç†å™¨çš„å®ç°ç»†èŠ‚</h3><h4 id="ä¸»è¦æ–¹æ³•"><a href="#ä¸»è¦æ–¹æ³•" class="headerlink" title="ä¸»è¦æ–¹æ³•"></a>ä¸»è¦æ–¹æ³•</h4><p>æˆ‘ä»¬æ¥çœ‹ä¸‹å­ç±»ä¸­å®ç°çš„ä¸»è¦æ–¹æ³•ï¼š</p><h5 id="init-ProcessingEnvironment-processingEnv"><a href="#init-ProcessingEnvironment-processingEnv" class="headerlink" title="init(ProcessingEnvironment processingEnv)"></a><code>init(ProcessingEnvironment processingEnv)</code></h5><p>åˆå§‹åŒ–æ–¹æ³•ï¼Œåœ¨çˆ¶æŠ½è±¡ç±»ä¸­å¯¹å…¥å‚<code>ProcessingEnvironment</code>å¯¹è±¡è¿›è¡Œäº†åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡å¾—åˆ°å¾ˆå¤šå·¥å…·ç±»ï¼Œä¾‹å¦‚<code>Trees</code>ã€<code>TreeMaker</code>å’Œ<code>Names</code>ç­‰ç­‰ã€‚</p><h5 id="process"><a href="#process" class="headerlink" title="process"></a><code>process</code></h5><p>çˆ¶ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œå­ç±»è¿›è¡Œå…·ä½“çš„å¤„ç†å®ç°ã€‚è¾“å…¥å‚æ•°<code>RoundEnvironment</code>ä»£è¡¨æ¯ä¸€æ¬¡<code>Round</code>çš„ç¯å¢ƒã€‚</p><h5 id="getSupportedAnnotationTypes"><a href="#getSupportedAnnotationTypes" class="headerlink" title="getSupportedAnnotationTypes"></a><code>getSupportedAnnotationTypes</code></h5><p>æŒ‡å®šå½“å‰å¤„ç†å™¨æ˜¯ç”¨æ¥å¤„ç†å“ªä¸ªæ³¨è§£çš„ï¼Œè¿”å›å€¼æ˜¯éœ€è¦å¤„ç†çš„æ³¨è§£çš„å…¨é™å®šç±»åå­—ç¬¦ä¸²çš„é›†åˆã€‚åœ¨<code>JDK7</code>åï¼Œçˆ¶æŠ½è±¡ç±»åŸºäº<code>@SupportedAnnotationTypes</code>æ³¨è§£è¿›è¡Œäº†å®ç°ï¼Œå­ç±»ä¸­å¯ä¸é‡å†™è¯¥æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨æ³¨è§£ï¼š<code>@SupportedAnnotationTypes(&#123;&quot;org.sunchaser.lombok.impl.annotation.GetterAndSetter&quot;&#125;)</code>å³å¯ã€‚</p><h5 id="getSupportedSourceVersion"><a href="#getSupportedSourceVersion" class="headerlink" title="getSupportedSourceVersion"></a><code>getSupportedSourceVersion</code></h5><p>æŒ‡å®šæ”¯æŒçš„<code>JDK</code>ç‰ˆæœ¬ï¼Œè¿™é‡Œé€šå¸¸è¿”å›<code>SourceVersion.latestSupported()</code>æœ€æ–°ç‰ˆæœ¬ã€‚åœ¨<code>JDK7</code>åï¼Œçˆ¶æŠ½è±¡ç±»åŸºäº<code>@SupportedSourceVersion</code>æ³¨è§£è¿›è¡Œäº†å®ç°ï¼Œå­ç±»ä¸­å¯ä¸é‡æ–°è¿›è¡Œå®ç°ï¼Œç›´æ¥ä½¿ç”¨æ³¨è§£ï¼š<code>@SupportedSourceVersion(SourceVersion.RELEASE_8)</code>å³å¯ã€‚</p><h4 id="å·¥å…·ç±»ä»‹ç»"><a href="#å·¥å…·ç±»ä»‹ç»" class="headerlink" title="å·¥å…·ç±»ä»‹ç»"></a>å·¥å…·ç±»ä»‹ç»</h4><p>ä¸‹é¢ä»‹ç»ä¸€ä¸‹<code>init</code>æ–¹æ³•ä¸­åˆå§‹åŒ–çš„ä¸€äº›å·¥å…·ç±»ï¼š</p><h5 id="javax-annotation-processing-Messager"><a href="#javax-annotation-processing-Messager" class="headerlink" title="javax.annotation.processing.Messager"></a><code>javax.annotation.processing.Messager</code></h5><p>ç¼–è¯‘æœŸçš„æ—¥å¿—æ‰“å°å·¥å…·ç±»ã€‚ä½¿ç”¨<code>processingEnv.getMessager();</code>è¿›è¡Œåˆå§‹åŒ–ã€‚</p><h5 id="javax-lang-model-element-Element"><a href="#javax-lang-model-element-Element" class="headerlink" title="javax.lang.model.element.Element"></a><code>javax.lang.model.element.Element</code></h5><p>å¯¹ä¸€ä¸ª<code>.java</code>æ–‡ä»¶ç»“æ„çš„å»ºæ¨¡ã€‚ä¸€ä¸ª<code>Java</code>ç±»è¢«åˆ’åˆ†ä¸ºå„ä¸ª<code>Element</code>ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰å¯¹åº”çš„å­ç±»å®ç°ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser;                  <span class="comment">/** PackageElement      **/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;                      <span class="comment">/** TypeElement         **/</span></span><br><span class="line">    <span class="keyword">private</span> String str;                 <span class="comment">/** VariableElement     **/</span></span><br><span class="line">    <span class="keyword">private</span> Foo foo;                    <span class="comment">/** VariableElement     **/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Foo</span><span class="params">()</span> </span>&#123;&#125;                     <span class="comment">/** ExecuteableElement  **/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStr</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        String str                      <span class="comment">/** TypeElement         **/</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.str = str;                 <span class="comment">/** ExecuteableElement  **/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="com-sun-source-util-Trees"><a href="#com-sun-source-util-Trees" class="headerlink" title="com.sun.source.util.Trees"></a><code>com.sun.source.util.Trees</code></h5><p>å¯å°†<code>Element</code>è½¬æ¢æˆ<code>JCTree</code>ï¼Œç»„æˆ<code>AST</code>è¯­æ³•æ ‘ã€‚ä½¿ç”¨<code>Trees.instance(processingEnv);</code>è¿›è¡Œåˆå§‹åŒ–ã€‚</p><h5 id="com-sun-tools-javac-tree-TreeMaker"><a href="#com-sun-tools-javac-tree-TreeMaker" class="headerlink" title="com.sun.tools.javac.tree.TreeMaker"></a><code>com.sun.tools.javac.tree.TreeMaker</code></h5><p>æ„é€ <code>JCTree</code>çš„å·¥å…·ç±»ã€‚ä½¿ç”¨<code>TreeMaker.instance(((JavacProcessingEnvironment) processingEnv).getContext());</code>è¿›è¡Œåˆå§‹åŒ–ã€‚</p><h5 id="com-sun-tools-javac-util-Names"><a href="#com-sun-tools-javac-util-Names" class="headerlink" title="com.sun.tools.javac.util.Names"></a><code>com.sun.tools.javac.util.Names</code></h5><p>åå­—å¤„ç†å·¥å…·ç±»ã€‚ä½¿ç”¨<code>Names.instance(context);</code>è¿›è¡Œåˆå§‹åŒ–ã€‚æ— è®ºæ˜¯ç±»ã€æ–¹æ³•ã€å˜é‡æˆ–è€…å‚æ•°çš„åç§°éƒ½éœ€è¦æ­¤ç±»æ¥åˆ›å»ºï¼Œå¸¸ç”¨å½¢å¼ä¸º<code>names.fromString(&quot;setNameXXX&quot;)</code>ã€‚</p><h5 id="com-sun-tools-javac-util-List"><a href="#com-sun-tools-javac-util-List" class="headerlink" title="com.sun.tools.javac.util.List"></a><code>com.sun.tools.javac.util.List</code></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">List</span>&lt;<span class="title">A</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractCollection</span>&lt;<span class="title">A</span>&gt; <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">util</span>.<span class="title">List</span>&lt;<span class="title">A</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> A head;</span><br><span class="line">    <span class="keyword">public</span> List&lt;A&gt; tail;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** nil()æ–¹æ³•è¿”å›çš„ç©ºé›†åˆ **/</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;?&gt; EMPTY_LIST = <span class="keyword">new</span> List&lt;Object&gt;((Object)<span class="keyword">null</span>, (List)<span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;Object&gt; <span class="title">setTail</span><span class="params">(List&lt;Object&gt; var1)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›ç©ºé›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;A&gt; <span class="function">List&lt;A&gt; <span class="title">nil</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> EMPTY_LIST;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** ä»¥ä¸‹æ˜¯ä¸€ç³»åˆ—é‡è½½çš„ofæ–¹æ³•ï¼Œç”¨æ¥åˆ›å»ºList **/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;A&gt; <span class="function">List&lt;A&gt; <span class="title">of</span><span class="params">(A var0)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> List(var0, nil());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;A&gt; <span class="function">List&lt;A&gt; <span class="title">of</span><span class="params">(A var0, A var1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> List(var0, of(var1));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;A&gt; <span class="function">List&lt;A&gt; <span class="title">of</span><span class="params">(A var0, A var1, A var2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> List(var0, of(var1, var2));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;A&gt; <span class="function">List&lt;A&gt; <span class="title">of</span><span class="params">(A var0, A var1, A var2, A... var3)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> List(var0, <span class="keyword">new</span> List(var1, <span class="keyword">new</span> List(var2, from(var3))));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™å¥—æŠ½è±¡è¯­æ³•æ ‘çš„å®ç°ä¸­ï¼Œæ‰€æœ‰çš„<code>List</code>éƒ½ä½¿ç”¨çš„æ˜¯<code>com.sun.tools.javac.util.List</code>ï¼Œè€Œä¸æ˜¯<code>java.util.ArrayList</code>ã€‚è¿™æ˜¯ä¸€ä¸ªé“¾å¼<code>List</code>ï¼Œå°¾èŠ‚ç‚¹ä¸ºé›†åˆã€‚å¸¸ç”¨çš„æ–¹æ³•æœ‰<code>List.nil()</code>å’Œ<code>List.of()</code>ã€‚</p><h4 id="JCTreeä»‹ç»"><a href="#JCTreeä»‹ç»" class="headerlink" title="JCTreeä»‹ç»"></a><code>JCTree</code>ä»‹ç»</h4><p><code>JCTree</code>æ˜¯è¯­æ³•æ ‘å…ƒç´ çš„åŸºç±»ï¼ŒåŒ…å«ä¸€ä¸ªé‡è¦çš„å­—æ®µ<code>pos</code>ï¼Œè¯¥å­—æ®µç”¨æ¥æŒ‡æ˜å½“å‰è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCTree</code>åœ¨è¯­æ³•æ ‘ä¸­çš„ä½ç½®ã€‚<code>com.sun.tools.javac.tree.JCTree</code>æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸”å­ç±»çš„æ„é€ å‡½æ•°éƒ½æ˜¯<code>protected</code>çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»ºè¯­æ³•æ ‘å…ƒç´ èŠ‚ç‚¹ï¼Œè€Œæ˜¯ä½¿ç”¨è®¿é—®è€…è®¾è®¡æ¨¡å¼è¿›è¡Œåˆ›å»ºã€‚</p><p>ä¸‹é¢ä»‹ç»å‡ ä¸ªé‡è¦çš„å­ç±»ï¼š</p><ul><li><code>com.sun.tools.javac.tree.JCTree.JCStatement</code>ï¼šå£°æ˜è¯­æ³•æ ‘èŠ‚ç‚¹ï¼Œä»ç„¶æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸‹é¢æ˜¯å¸¸ç”¨å­ç±»ï¼š<ul><li><code>com.sun.tools.javac.tree.JCTree.JCBlock</code>ï¼šè¯­å¥å—è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚</li><li><code>com.sun.tools.javac.tree.JCTree.JCReturn</code>ï¼š<code>return</code>è¯­å¥è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚</li><li><code>com.sun.tools.javac.tree.JCTree.JCClassDecl</code>ï¼šç±»å®šä¹‰è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚</li><li><code>com.sun.tools.javac.tree.JCTree.JCVariableDecl</code>ï¼šå­—æ®µ/å˜é‡å®šä¹‰è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚</li></ul></li><li><code>com.sun.tools.javac.tree.JCTree.JCMethodDecl</code>ï¼šæ–¹æ³•å®šä¹‰è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚</li><li><code>com.sun.tools.javac.tree.JCTree.JCModifiers</code>ï¼šè®¿é—®æ ‡å¿—è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚</li><li><code>com.sun.tools.javac.tree.JCTree.JCExpression</code>ï¼šè¡¨è¾¾å¼è¯­æ³•æ ‘èŠ‚ç‚¹ï¼Œä»ç„¶æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸‹é¢æ˜¯å¸¸ç”¨å­ç±»ï¼š<ul><li><code>com.sun.tools.javac.tree.JCTree.JCAssign</code>ï¼šèµ‹å€¼è¯­å¥è¯­æ³•æ ‘èŠ‚ç‚¹ã€‚</li><li><code>com.sun.tools.javac.tree.JCTree.JCIdent</code>ï¼šæ ‡å¿—ç¬¦è¯­æ³•æ ‘èŠ‚ç‚¹ï¼Œå¯ä»¥æ˜¯å˜é‡ã€ç±»å‹å’Œå…³é”®å­—ç­‰ç­‰ã€‚</li></ul></li></ul><h4 id="TreeMakerä»‹ç»"><a href="#TreeMakerä»‹ç»" class="headerlink" title="TreeMakerä»‹ç»"></a><code>TreeMaker</code>ä»‹ç»</h4><p><code>TreeMaker</code>ç”¨äºåˆ›å»ºä¸€ç³»åˆ—çš„è¯­æ³•æ ‘èŠ‚ç‚¹ï¼Œä¸Šé¢è¯´åˆ°åˆ›å»º<code>JCTree</code>è¯­æ³•æ ‘èŠ‚ç‚¹ä¸èƒ½ç›´æ¥ä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»ºï¼Œæ‰€ä»¥æ‰æœ‰äº†<code>TreeMaker</code>å·¥å…·ç±»ï¼Œå®ƒä¼šåœ¨åˆ›å»ºæ—¶ä¸º<code>JCTree</code>å¯¹è±¡è®¾ç½®<code>pos</code>å­—æ®µï¼Œå¿…é¡»ä½¿ç”¨ä¸Šä¸‹æ–‡ç›¸å…³çš„<code>TreeMaker</code>å¯¹è±¡æ¥åˆ›å»ºè¯­æ³•æ ‘èŠ‚ç‚¹ã€‚</p><p>ä¸‹é¢ä»‹ç»å‡ ä¸ªå¸¸ç”¨æ–¹æ³•ï¼š</p><h5 id="TreeMaker-Modifiers"><a href="#TreeMaker-Modifiers" class="headerlink" title="TreeMaker.Modifiers"></a><code>TreeMaker.Modifiers</code></h5><p>ç”¨äºåˆ›å»ºè®¿é—®æ ‡å¿—çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCModifiers</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> JCModifiers <span class="title">Modifiers</span><span class="params">(<span class="keyword">long</span> flags)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.Modifiers(flags, List.nil());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºè®¿é—®æ ‡å¿—çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> flags         è®¿é—®æ ‡å¿—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> annotations   æ³¨è§£åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCModifiers <span class="title">Modifiers</span><span class="params">(<span class="keyword">long</span> flags, List&lt;JCAnnotation&gt; annotations)</span> </span>&#123;</span><br><span class="line">    JCModifiers tree = <span class="keyword">new</span> JCModifiers(flags, annotations);</span><br><span class="line">    <span class="keyword">boolean</span> noFlags = (flags &amp; <span class="number">8796093033983L</span>) == <span class="number">0L</span>;</span><br><span class="line">    tree.pos = noFlags &amp;&amp; annotations.isEmpty() ? -<span class="number">1</span> : <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>flags</code>å¯ä»¥ä½¿ç”¨æšä¸¾ç±»<code>com.sun.tools.javac.code.Flags</code>ï¼Œä¾‹å¦‚<code>treeMaker.Modifiers(Flags.PUBLIC + Flags.STATIC + Flags.FINAL)</code>åˆ›å»ºçš„è¯­æ³•æ ‘èŠ‚ç‚¹ä¸ºï¼š<code>public static final</code>ã€‚</p><h5 id="TreeMaker-ClassDef"><a href="#TreeMaker-ClassDef" class="headerlink" title="TreeMaker.ClassDef"></a><code>TreeMaker.ClassDef</code></h5><p>ç”¨äºåˆ›å»ºç±»å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCClassDecl</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºç±»å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> modifiers     è®¿é—®æ ‡è¯†ï¼Œå¯é€šè¿‡treeMaker.Modifiersåˆ›å»º</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> name          ç±»å</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> typeParameter æ³›å‹å‚æ•°åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> extending     çˆ¶ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> implementing  å®ç°çš„æ¥å£é›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> defs          ç±»å®šä¹‰çš„è¯¦ç»†è¯­å¥ï¼ŒåŒ…æ‹¬å­—æ®µã€æ–¹æ³•çš„å®šä¹‰ç­‰ç­‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCClassDecl <span class="title">ClassDef</span><span class="params">(JCModifiers modifiers,</span></span></span><br><span class="line"><span class="function"><span class="params">                            Name name,</span></span></span><br><span class="line"><span class="function"><span class="params">                            List&lt;JCTypeParameter&gt; typeParameter,</span></span></span><br><span class="line"><span class="function"><span class="params">                            JCExpression extending,</span></span></span><br><span class="line"><span class="function"><span class="params">                            List&lt;JCExpression&gt; implementing,</span></span></span><br><span class="line"><span class="function"><span class="params">                            List&lt;JCTree&gt; defs)</span> </span>&#123;</span><br><span class="line">    JCClassDecl tree = <span class="keyword">new</span> JCClassDecl(modifiers, name, typeParameter, extending, implementing, defs, (ClassSymbol)<span class="keyword">null</span>);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="TreeMaker-VarDef"><a href="#TreeMaker-VarDef" class="headerlink" title="TreeMaker.VarDef"></a><code>TreeMaker.VarDef</code></h5><p>ç”¨äºåˆ›å»ºå­—æ®µ/å˜é‡å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCVariableDecl</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºå­—æ®µ/å˜é‡å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> modifiers è®¿é—®æ ‡å¿—ï¼Œå¯é€šè¿‡treeMaker.Modifiersåˆ›å»º</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> name      å­—æ®µ/å˜é‡åç§°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> varType   å­—æ®µ/å˜é‡ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> init      å­—æ®µ/å˜é‡åˆå§‹åŒ–è¯­å¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCVariableDecl <span class="title">VarDef</span><span class="params">(JCModifiers modifiers,</span></span></span><br><span class="line"><span class="function"><span class="params">                            Name name,</span></span></span><br><span class="line"><span class="function"><span class="params">                            JCExpression varType,</span></span></span><br><span class="line"><span class="function"><span class="params">                            JCExpression init)</span> </span>&#123;</span><br><span class="line">    JCVariableDecl tree = <span class="keyword">new</span> JCVariableDecl(modifiers, name, varType, init, (VarSymbol)<span class="keyword">null</span>);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="TreeMaker-Ident"><a href="#TreeMaker-Ident" class="headerlink" title="TreeMaker.Ident"></a><code>TreeMaker.Ident</code></h5><p>ç”¨äºåˆ›å»ºæ ‡è¯†ç¬¦çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCIdent</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºæ ‡è¯†ç¬¦çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> name  æ ‡è¯†ç¬¦åç§°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCIdent <span class="title">Ident</span><span class="params">(Name name)</span> </span>&#123;</span><br><span class="line">    JCIdent tree = <span class="keyword">new</span> JCIdent(name, (Symbol)<span class="keyword">null</span>);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="TreeMaker-Return"><a href="#TreeMaker-Return" class="headerlink" title="TreeMaker.Return"></a><code>TreeMaker.Return</code></h5><p>ç”¨äºåˆ›å»º<code>return</code>è¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCReturn</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»º`return`è¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCReturn <span class="title">Return</span><span class="params">(JCExpression ex)</span> </span>&#123;</span><br><span class="line">    JCReturn tree = <span class="keyword">new</span> JCReturn(ex);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="TreeMaker-Apply"><a href="#TreeMaker-Apply" class="headerlink" title="TreeMaker.Apply"></a><code>TreeMaker.Apply</code></h5><p>ç”¨äºåˆ›å»ºæ–¹æ³•è°ƒç”¨çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCMethodInvocation</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºæ–¹æ³•è°ƒç”¨çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> argsTypes å‚æ•°ç±»å‹åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fn        æ–¹æ³•è°ƒç”¨è¯­å¥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> args      æ–¹æ³•å‚æ•°åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCMethodInvocation <span class="title">Apply</span><span class="params">(List&lt;JCExpression&gt; argsTypes, JCExpression fn, List&lt;JCExpression&gt; args)</span> </span>&#123;</span><br><span class="line">    JCMethodInvocation tree = <span class="keyword">new</span> JCMethodInvocation(argsTypes, fn, args);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="TreeMaker-Select"><a href="#TreeMaker-Select" class="headerlink" title="TreeMaker.Select"></a><code>TreeMaker.Select</code></h5><p>ç”¨äºåˆ›å»ºåŸŸè®¿é—®/æ–¹æ³•è®¿é—®çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCFieldAccess</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºåŸŸè®¿é—®/æ–¹æ³•è®¿é—®çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> selected  . è¿ç®—ç¬¦å·¦è¾¹çš„è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> selector  . è¿ç®—ç¬¦å³è¾¹çš„è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCFieldAccess <span class="title">Select</span><span class="params">(JCExpression selected, Name selector)</span> </span>&#123;</span><br><span class="line">    JCFieldAccess tree = <span class="keyword">new</span> JCFieldAccess(selected, selector, (Symbol)<span class="keyword">null</span>);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="TreeMaker-Assign"><a href="#TreeMaker-Assign" class="headerlink" title="TreeMaker.Assign"></a><code>TreeMaker.Assign</code></h5><p>ç”¨äºåˆ›å»ºèµ‹å€¼è¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCAssign</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºèµ‹å€¼è¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> leftEx    èµ‹å€¼è¯­å¥å·¦è¾¹çš„è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> rightEx   èµ‹å€¼è¯­å¥å³è¾¹çš„è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCAssign <span class="title">Assign</span><span class="params">(JCExpression leftEx, JCExpression rightEx)</span> </span>&#123;</span><br><span class="line">    JCAssign tree = <span class="keyword">new</span> JCAssign(leftEx, rightEx);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="TreeMaker-Exec"><a href="#TreeMaker-Exec" class="headerlink" title="TreeMaker.Exec"></a><code>TreeMaker.Exec</code></h5><p>ç”¨äºåˆ›å»ºå¯æ‰§è¡Œè¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCExpressionStatement</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºå¯æ‰§è¡Œè¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCExpressionStatement <span class="title">Exec</span><span class="params">(JCExpression ex)</span> </span>&#123;</span><br><span class="line">    JCExpressionStatement tree = <span class="keyword">new</span> JCExpressionStatement(ex);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>TreeMaker.Apply</code>å’Œ<code>TreeMaker.Assign</code>éœ€è¦åœ¨å¤–é¢åŒ…ä¸€å±‚<code>TreeMaker.Exec</code>æ¥è·å–ä¸€ä¸ªå¯æ‰§è¡Œè¯­å¥<code>JCExpressionStatement</code>ã€‚</p></blockquote><h5 id="TreeMaker-Block"><a href="#TreeMaker-Block" class="headerlink" title="TreeMaker.Block"></a><code>TreeMaker.Block</code></h5><p>ç”¨äºåˆ›å»ºç»„åˆè¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCExpressionStatement</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºç»„åˆè¯­å¥çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> flags         è®¿é—®æ ‡å¿—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> statements    è¯­å¥åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCBlock <span class="title">Block</span><span class="params">(<span class="keyword">long</span> flags, List&lt;JCStatement&gt; statements)</span> </span>&#123;</span><br><span class="line">    JCBlock tree = <span class="keyword">new</span> JCBlock(flags, statements);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="TreeMaker-MethodDef"><a href="#TreeMaker-MethodDef" class="headerlink" title="TreeMaker.MethodDef"></a><code>TreeMaker.MethodDef</code></h5><p>ç”¨äºåˆ›å»ºæ–¹æ³•å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹<code>JCMethodDecl</code>ï¼Œä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºæ–¹æ³•å®šä¹‰çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> modifiers         è®¿é—®æ ‡å¿—ï¼Œå¯é€šè¿‡treeMaker.Modifiersåˆ›å»º</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> name              æ–¹æ³•å</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> returnType        è¿”å›ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> typeParameters    æ³›å‹å‚æ•°åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> params            å‚æ•°åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> throwns           å¼‚å¸¸å£°æ˜åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> methodBody        æ–¹æ³•ä½“</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> defaultValue      é»˜è®¤æ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCMethodDecl <span class="title">MethodDef</span><span class="params">(JCModifiers modifiers,</span></span></span><br><span class="line"><span class="function"><span class="params">                              Name name,</span></span></span><br><span class="line"><span class="function"><span class="params">                              JCExpression returnType,</span></span></span><br><span class="line"><span class="function"><span class="params">                              List&lt;JCTypeParameter&gt; typeParameters,</span></span></span><br><span class="line"><span class="function"><span class="params">                              List&lt;JCVariableDecl&gt; params,</span></span></span><br><span class="line"><span class="function"><span class="params">                              List&lt;JCExpression&gt; throwns,</span></span></span><br><span class="line"><span class="function"><span class="params">                              JCBlock methodBody,</span></span></span><br><span class="line"><span class="function"><span class="params">                              JCExpression defaultValue)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.MethodDef(modifiers, name, returnType, typeParameters, (JCVariableDecl)<span class="keyword">null</span>, params, throwns, methodBody, defaultValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> JCMethodDecl <span class="title">MethodDef</span><span class="params">(JCModifiers modifiers,</span></span></span><br><span class="line"><span class="function"><span class="params">                              Name name,</span></span></span><br><span class="line"><span class="function"><span class="params">                              JCExpression returnType,</span></span></span><br><span class="line"><span class="function"><span class="params">                              List&lt;JCTypeParameter&gt; typeParameters,</span></span></span><br><span class="line"><span class="function"><span class="params">                              JCVariableDecl variable,</span></span></span><br><span class="line"><span class="function"><span class="params">                              List&lt;JCVariableDecl&gt; params,</span></span></span><br><span class="line"><span class="function"><span class="params">                              List&lt;JCExpression&gt; throwns,</span></span></span><br><span class="line"><span class="function"><span class="params">                              JCBlock methodBody,</span></span></span><br><span class="line"><span class="function"><span class="params">                              JCExpression defaultValue)</span> </span>&#123;</span><br><span class="line">    JCMethodDecl tree = <span class="keyword">new</span> JCMethodDecl(modifiers, name, returnType, typeParameters, variable, params, throwns, methodBody, defaultValue, (MethodSymbol)<span class="keyword">null</span>);</span><br><span class="line">    tree.pos = <span class="keyword">this</span>.pos;</span><br><span class="line">    <span class="keyword">return</span> tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="processæ‰§è¡Œ"><a href="#processæ‰§è¡Œ" class="headerlink" title="processæ‰§è¡Œ"></a><code>process</code>æ‰§è¡Œ</h4><p>ä¸‹é¢è¯¦ç»†ä»‹ç»<code>process</code>æ–¹æ³•ä¸­çš„å…·ä½“å¤„ç†é€»è¾‘ï¼š</p><p>é¦–å…ˆè¦çŸ¥é“<code>process</code>æ–¹æ³•å¦‚æœè¿”å›äº†<code>true</code>ï¼Œé‚£ä¹ˆ<code>Javac</code>ç¼–è¯‘å™¨ä¼šä»ç¼–è¯‘æœŸçš„ç¬¬äºŒé˜¶æ®µå›åˆ°ç¬¬ä¸€é˜¶æ®µï¼šå³é‡æ–°å›åˆ°è§£æä¸å¡«å……ç¬¦å·è¡¨é˜¶æ®µã€‚</p><p>å¤„ç†é€»è¾‘ï¼šå¦‚æœ<code>!roundEnv.processingOver()</code>è¿˜æœª<code>process</code>å®Œæˆï¼Œåˆ™æ‰¾åˆ°æ‰€æœ‰<code>@GetterAndSetter</code>æ³¨è§£æ ‡æ³¨çš„ç±»ï¼Œä¾æ¬¡éå†è·å¾—æ¯ä¸ªç±»çš„è¯­æ³•æ ‘ï¼Œç„¶åäº¤ç»™è‡ªå®šä¹‰çš„<code>org.sunchaser.lombok.impl.process.GetterAndSetterTreeTranslator</code>ç±»è¿›è¡Œå¤„ç†ï¼Œå…¨éƒ¨å¤„ç†å®Œæˆåè¿”å›<code>true</code>ä»¥ä¾¿å›åˆ°ç¼–è¯‘çš„ç¬¬ä¸€é˜¶æ®µã€‚</p><p>ä¸‹é¢æ˜¯<code>GetterAndSetterTreeTranslator</code>ç±»ä¸­å…·ä½“æ“ä½œè¯­æ³•æ ‘æ’å…¥<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•çš„é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.sun.tools.javac.tree.JCTree.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ASTæ ‘è®¿é—®å¤„ç†å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaserlilu@didiglobal.com</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2020/12/17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetterAndSetterTreeTranslator</span> <span class="keyword">extends</span> <span class="title">TreeTranslator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„é€ JCTreeçš„å·¥å…·ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> TreeMaker treeMaker;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åå­—å¤„ç†å·¥å…·ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Names names;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼–è¯‘æœŸçš„æ—¥å¿—æ‰“å°å·¥å…·ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Messager messager;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GetterAndSetterTreeTranslator</span><span class="params">(TreeMaker treeMaker, Names names, Messager messager)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.treeMaker = treeMaker;</span><br><span class="line">        <span class="keyword">this</span>.names = names;</span><br><span class="line">        <span class="keyword">this</span>.messager = messager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¿é—®åˆ°ç±»å®šä¹‰æ—¶çš„å¤„ç†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jcClassDecl ç±»å®šä¹‰çš„æŠ½è±¡è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visitClassDef</span><span class="params">(JCClassDecl jcClassDecl)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.visitClassDef(jcClassDecl);</span><br><span class="line">        jcClassDecl.defs.forEach(def -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (def.getKind().equals(Kind.VARIABLE)) &#123;</span><br><span class="line">                messager.printMessage(Diagnostic.Kind.NOTE,def + <span class="string">&quot;----processed&quot;</span>);</span><br><span class="line">                <span class="comment">// æ’å…¥getteræ–¹æ³•</span></span><br><span class="line">                jcClassDecl.defs = jcClassDecl.defs.prepend(createGetterMethod((JCVariableDecl) def));</span><br><span class="line">                <span class="comment">// æ’å…¥setteræ–¹æ³•</span></span><br><span class="line">                jcClassDecl.defs = jcClassDecl.defs.prepend(createSetterMethod((JCVariableDecl) def));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºgetteræ–¹æ³•çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> def å˜é‡èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> getteræ–¹æ³•çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> JCTree <span class="title">createGetterMethod</span><span class="params">(JCVariableDecl def)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> treeMaker.MethodDef(</span><br><span class="line">                <span class="comment">// è®¿é—®ä¿®é¥°ç¬¦</span></span><br><span class="line">                treeMaker.Modifiers(Flags.PUBLIC),</span><br><span class="line">                <span class="comment">// æ–¹æ³•å</span></span><br><span class="line">                names.fromString(<span class="string">&quot;get&quot;</span> + <span class="keyword">this</span>.toFirstUpperCase(def.getName().toString())),</span><br><span class="line">                <span class="comment">// æ–¹æ³•è¿”å›ç±»å‹</span></span><br><span class="line">                (JCExpression) def.getType(),</span><br><span class="line">                <span class="comment">// æ³›å‹å‚æ•°</span></span><br><span class="line">                List.nil(),</span><br><span class="line">                <span class="comment">// æ–¹æ³•å‚æ•°åˆ—è¡¨</span></span><br><span class="line">                List.nil(),</span><br><span class="line">                <span class="comment">// throwè¡¨è¾¾å¼</span></span><br><span class="line">                List.nil(),</span><br><span class="line">                <span class="comment">// æ–¹æ³•ä½“</span></span><br><span class="line">                treeMaker.Block(<span class="number">0L</span>,List.of(</span><br><span class="line">                        treeMaker.Return(</span><br><span class="line">                                treeMaker.Select(</span><br><span class="line">                                        treeMaker.Ident(names.fromString(<span class="string">&quot;this&quot;</span>)),</span><br><span class="line">                                        names.fromString(def.getName().toString())</span><br><span class="line">                                )</span><br><span class="line">                        )</span><br><span class="line">                )),</span><br><span class="line">                <span class="keyword">null</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºsetteræ–¹æ³•çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> def å˜é‡èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> setteræ–¹æ³•çš„è¯­æ³•æ ‘èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> JCTree <span class="title">createSetterMethod</span><span class="params">(JCVariableDecl def)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ„é€ æ–¹æ³•å…¥å‚</span></span><br><span class="line">        JCVariableDecl param = treeMaker.VarDef(treeMaker.Modifiers(Flags.PARAMETER), def.getName(), def.vartype, <span class="keyword">null</span>);</span><br><span class="line">        <span class="comment">// æ„é€  this.def = def</span></span><br><span class="line">        JCFieldAccess thisX = treeMaker.Select(treeMaker.Ident(names.fromString(<span class="string">&quot;this&quot;</span>)), def.getName());</span><br><span class="line">        JCAssign assign = treeMaker.Assign(thisX, treeMaker.Ident(def.getName()));</span><br><span class="line">        <span class="comment">// æ„é€ æ–¹æ³•ä½“</span></span><br><span class="line">        JCBlock methodBody = treeMaker.Block(<span class="number">0L</span>, List.of(treeMaker.Exec(assign)));</span><br><span class="line">        <span class="comment">// æ„é€ æ–¹æ³•è¿”å›ç±»å‹</span></span><br><span class="line">        JCExpression returnType = treeMaker.Type(<span class="keyword">new</span> Type.JCVoidType());</span><br><span class="line">        <span class="comment">// æ„é€ setteræ–¹æ³•</span></span><br><span class="line">        <span class="keyword">return</span> treeMaker.MethodDef(</span><br><span class="line">                <span class="comment">// è®¿é—®ä¿®é¥°ç¬¦</span></span><br><span class="line">                treeMaker.Modifiers(Flags.PUBLIC),</span><br><span class="line">                <span class="comment">// æ–¹æ³•å</span></span><br><span class="line">                names.fromString(<span class="string">&quot;set&quot;</span> + <span class="keyword">this</span>.toFirstUpperCase(def.getName().toString())),</span><br><span class="line">                <span class="comment">// æ–¹æ³•è¿”å›ç±»å‹</span></span><br><span class="line">                returnType,</span><br><span class="line">                <span class="comment">// æ³›å‹å‚æ•°</span></span><br><span class="line">                List.nil(),</span><br><span class="line">                <span class="comment">// æ–¹æ³•å‚æ•°åˆ—è¡¨</span></span><br><span class="line">                List.of(param),</span><br><span class="line">                <span class="comment">// throwè¡¨è¾¾å¼</span></span><br><span class="line">                List.nil(),</span><br><span class="line">                <span class="comment">// æ–¹æ³•ä½“</span></span><br><span class="line">                methodBody,</span><br><span class="line">                <span class="comment">// é»˜è®¤å€¼</span></span><br><span class="line">                <span class="keyword">null</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å·¥å…·æ–¹æ³•ï¼šå°†å­—ç¬¦ä¸²é¦–ä½è½¬ä¸ºå¤§å†™</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> str æºå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> é¦–ä½å¤§å†™çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">toFirstUpperCase</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] charArray = str.toCharArray();</span><br><span class="line">        charArray[<span class="number">0</span>] -= <span class="number">32</span>;</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(charArray);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œä¸€ä¸ªç®€æ˜“<code>Lombok</code>çš„åŠŸèƒ½å°±å®ç°äº†ï¼Œä½†æ˜¯è¿˜æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„æ’å…¥æ³¨è§£å¤„ç†å™¨ç±»<code>GetterAndSetterProcessor</code>ä½¿ç”¨<code>SPI</code>çš„å½¢å¼æä¾›ç»™å¤–éƒ¨ä½¿ç”¨ã€‚</p><h3 id="SPIå®ç°"><a href="#SPIå®ç°" class="headerlink" title="SPIå®ç°"></a><code>SPI</code>å®ç°</h3><p>å®ç°æ–¹å¼ä¸€ï¼š</p><p>æ‰‹åŠ¨åœ¨<code>resources</code>ç›®å½•ä¸‹åˆ›å»º<code>META-INF/services</code>ç›®å½•ï¼Œç„¶ååœ¨<code>services</code>ç›®å½•ä¸‹åˆ›å»º<code>javax.annotation.processing.Processor</code>æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºæ’å…¥æ³¨è§£å¤„ç†å™¨ç±»<code>GetterAndSetterProcessor</code>çš„å…¨é™å®šç±»åã€‚</p><p>å®ç°æ–¹å¼äºŒï¼š</p><p>ä½¿ç”¨<code>google</code>æä¾›çš„<code>auto-service</code>æ¡†æ¶ï¼Œè¯¥æ¡†æ¶ä¹Ÿæ˜¯åŸºäºæ’å…¥æ³¨è§£å¤„ç†å™¨å®ç°çš„ã€‚å…¶<code>maven</code>åæ ‡ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.google.auto.service&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;auto-service&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.0-rc7&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ’å…¥æ³¨è§£å¤„ç†å™¨ç±»<code>GetterAndSetterProcessor</code>ä¸Šæ‰“ä¸Š<code>auto-service</code>æ¡†æ¶æä¾›çš„<code>@AutoService(Processor.class)</code>æ³¨è§£ï¼Œåœ¨ç¼–è¯‘åå³è‡ªåŠ¨ç”Ÿæˆ<code>target/classes/META-INF/services/javax.annotation.processing.Processor</code>æ–‡ä»¶ã€‚</p><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>æˆ‘ä»¬æ— æ³•åœ¨æ’å…¥æ³¨è§£å¤„ç†å™¨ç±»<code>GetterAndSetterProcessor</code>æ‰€åœ¨çš„<code>maven</code>æ¨¡å—è¿›è¡Œæµ‹è¯•ï¼Œå› ä¸ºè¯¥å¤„ç†å™¨æ˜¯ä½¿ç”¨<code>SPI</code>å¯¹å¤–æä¾›æœåŠ¡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ª<code>maven</code>å­æ¨¡å—ï¼Œç„¶åå¼•å…¥æ’å…¥æ³¨è§£å¤„ç†å™¨<code>GetterAndSetterProcessor</code>ç±»æ‰€åœ¨çš„<code>maven</code>æ¨¡å—çš„åæ ‡ï¼Œç„¶åæ‰å¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨è§£ï¼Œç®€å•æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.sunchaser.lombok.impl.annotation.GetterAndSetter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ³¨æ„æ­¤ç±»è·ŸGetterAndSetterProcessorä¸åœ¨åŒä¸€ä¸ªmavenæ¨¡å—ä¸­</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser admin@lilu.org.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2020/12/18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetterAndSetter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChainSetterTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œ<code>main</code>æ–¹æ³•å³å¯ã€‚</p><p>å¯çœ‹åˆ°<code>Build Output</code>ä¸­æœ‰å¦‚ä¸‹è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java: roundEnv ---&gt;[errorRaised&#x3D;false, rootElements&#x3D;[com.sunchaser.lomboktest.ChainSetterTest], processingOver&#x3D;false]</span><br><span class="line">java: private String name----processed</span><br><span class="line">java: roundEnv ---&gt;[errorRaised&#x3D;false, rootElements&#x3D;[], processingOver&#x3D;true]</span><br></pre></td></tr></table></figure><p>æ‰“å¼€<code>target/classes/com/sunchaser/lomboktest/ChainSetterTest.class</code>å­—èŠ‚ç æ–‡ä»¶ï¼Œå¯çœ‹åˆ°å·²ç”Ÿæˆå­—æ®µ<code>name</code>çš„<code>getName</code>å’Œ<code>setName</code>æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Source code recreated from a .class file by IntelliJ IDEA</span></span><br><span class="line"><span class="comment">// (powered by FernFlower decompiler)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.sunchaser.lomboktest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChainSetterTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ChainSetterTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±åŸºæœ¬å®ç°äº†ä¸€ä¸ªç®€æ˜“çš„<code>Lombok</code>ã€‚</p><p>ä½†æ˜¯æˆ‘ç•™ä¸‹äº†ä¸€ä¸ªç–‘é—®ï¼Œ<code>setter</code>æ–¹æ³•å¦‚ä½•ç”Ÿæˆé“¾å¼çš„ï¼Œè²Œä¼¼æˆ‘æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„<code>API</code>ï¼Œ<code>Lombok</code>æ˜¯é€šè¿‡å¦ä¸€ä¸ªæ³¨è§£<code>@Accessors(chain = true)</code>æ¥å®ç°é“¾å¼<code>setter</code>æ–¹æ³•çš„ï¼Œä¸ºä»€ä¹ˆå®ƒä¸ç›´æ¥åœ¨<code>@Setter</code>æ³¨è§£ä¸­è®¾ç½®ä¸€ä¸ªå±æ€§ç”¨æ¥æ§åˆ¶ç”Ÿæˆçš„<code>setter</code>æ–¹æ³•æ˜¯å¦ä¸ºé“¾å¼çš„ï¼Ÿçœ‹<code>Lombok</code>çš„æºç å¹¶æœªçœ‹æ‡‚è¿™éƒ¨åˆ†çš„å®ç°ï¼Œç½‘ä¸Šä¹Ÿæ²¡æœ‰æ‰¾åˆ°å¯¹åº”èµ„æ–™ï¼Œå¦‚æœæœ‰åŒè¡Œç ”ç©¶è¿‡è¿™ä¸ªé—®é¢˜å¯ç•™è¨€è¿›è¡Œäº¤æµï¼Œååˆ†æ„Ÿè°¢ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Java EE </category>
          
          <category> Lombok </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lombok </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ä¸ªå†·é—¨Lombokæ³¨è§£ä¸Springçš„ç»“åˆ</title>
      <link href="2020/12/14/javaee/lombok/lombok-combine-spring-di/"/>
      <url>2020/12/14/javaee/lombok/lombok-combine-spring-di/</url>
      
        <content type="html"><![CDATA[<h2 id="åº"><a href="#åº" class="headerlink" title="åº"></a>åº</h2><p>è¯´åˆ°<code>Lombok</code>ï¼Œå¤§éƒ¨åˆ†äººå¯èƒ½éƒ½åœç•™åœ¨<code>@Data</code>æ³¨è§£å¯ä»¥åŒæ—¶ç”Ÿæˆ<code>getter/setter</code>ã€<code>toString</code>ã€<code>equals</code>å’Œ<code>hashCode</code>ç­‰æ–¹æ³•ï¼›<code>@NoArgsConstructor/@AllArgsConstructor</code>å¯ä»¥ç”Ÿæˆæ— å‚å’Œå…¨å‚æ„é€ å™¨ã€‚ç¡®å®<code>Lombok</code>çš„è®¾è®¡åˆè¡·ä¹Ÿæ˜¯ä¸ºäº†ç”Ÿæˆä»£ç ã€‚</p><p>æœ‰äº›äººå› ä¸ºéœ€è¦å®‰è£…æ’ä»¶è€Œæ‹’ç»äº†<code>Lombok</code>ï¼Œè§‰å¾—è¿™æ ·ä¼šè¦æ±‚å›¢é˜Ÿå†…æ‰€æœ‰æˆå‘˜éƒ½å®‰è£…æ’ä»¶ã€‚è¯šç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªè¿˜è¯´å¾—è¿‡å»çš„ç†ç”±ã€‚ä½†æ˜¯è¿™å¹¶ä¸è¶³ä»¥è®©æˆ‘ä»¬æ‹’ç»<code>Lombok</code>ã€‚<code>Lombok</code>æ‰€åšçš„äº‹æƒ…æ˜¯åœ¨æ”¹å˜<code>Java</code>ï¼Œæœ‰äº›äººè§‰å¾—å®ƒæ”¹å˜äº†<code>Java</code>è¯­æ³•æ˜¯ç ´åäº†<code>Java</code>ï¼Œé‚£æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œä¹Ÿè®¸<code>Java</code>ä¸€ç›´ä»¥æ¥çš„è®¾è®¡å°±æ˜¯ä¸å¥½çš„å­˜åœ¨å‘¢ï¼Ÿä¸šåŠ¡ç³»ç»Ÿä¸­å‡ºç°çš„æ— æ•°<code>getter/setter</code>æ–¹æ³•ï¼ŒåŠ¨è¾„å‡ ç™¾è¡Œçš„å®ä½“ç±»ï¼Œé˜…è¯»ä½“éªŒçœŸçš„å¥½å—ï¼Ÿ<code>Lombok</code>æ˜¯åœ¨æ”¹å˜<code>Java</code>ï¼Œæˆ‘ä»¬åªä¸è¿‡æ˜¯åœ¨æ‹¥æŠ±å˜åŒ–ã€‚<code>Spring Boot</code>å·²ç»æŠŠ<code>Lombok</code>åŠ å…¥é¢„å®šä¹‰ä¾èµ–ä¸­äº†ï¼›<code>Apache ShardingSphere</code>çš„å¼€å‘è§„èŒƒä¸­æ˜ç¡®è¦æ±‚ä¼˜å…ˆä½¿ç”¨<code>Lombok</code>ä»£æ›¿æ„é€ å™¨ã€<code>getter/setter</code>æ–¹æ³•å’Œ<code>log</code>å˜é‡ï¼›å°±è¿<code>Java14</code>ä¹Ÿå€Ÿé‰´äº†<code>Lombok</code>æ€æƒ³æå‡ºäº†<code>record</code>è¯­æ³•ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜è¦å»æ‹’ç»<code>Lombok</code>å‘¢ï¼Ÿ</p><p>æ‰€ä»¥ï¼Œä»ä»Šå¤©èµ·ï¼Œå¼€å§‹æ‹¥æŠ±<code>Lombok</code>å§ï¼</p><h2 id="ä¸€ä¸ªå†·é—¨æ³¨è§£ï¼š-RequiredArgsConstructor"><a href="#ä¸€ä¸ªå†·é—¨æ³¨è§£ï¼š-RequiredArgsConstructor" class="headerlink" title="ä¸€ä¸ªå†·é—¨æ³¨è§£ï¼š@RequiredArgsConstructor"></a>ä¸€ä¸ªå†·é—¨æ³¨è§£ï¼š<code>@RequiredArgsConstructor</code></h2><p>å¾ˆå¤šäººéƒ½çŸ¥é“<code>@RequiredArgsConstructor</code>è¿™ä¸ªæ³¨è§£ï¼Œä½†æ˜¯å´ä»æœªä½¿ç”¨è¿‡ã€‚å¦‚æœä½ ä¹Ÿä¸€æ ·ï¼Œé‚£å°±å¾—å¥½å¥½çœ‹çœ‹æˆ‘è¿™ç¯‡æ–‡ç« äº†ï¼Œçœ‹å®Œä¹‹åä¹Ÿè®¸ä½ å°±ä¼šå‘ç°æ–°çš„å¤§é™†ï¼</p><h2 id="Springçš„ä¾èµ–æ³¨å…¥"><a href="#Springçš„ä¾èµ–æ³¨å…¥" class="headerlink" title="Springçš„ä¾èµ–æ³¨å…¥"></a><code>Spring</code>çš„ä¾èµ–æ³¨å…¥</h2><p>æ•…äº‹è¿˜å¾—ä»<code>Spring</code>çš„ä¾èµ–æ³¨å…¥å¼€å§‹è¯´èµ·â€¦</p><p>ä¾èµ–æ³¨å…¥çš„ä¸¤å¤§å˜ä½“ï¼š</p><ul><li>æ„é€ å‡½æ•°æ³¨å…¥</li><li><code>setter</code>æ–¹æ³•æ³¨å…¥</li></ul><p>ä½†æ˜¯ç°åœ¨ä¸šåŠ¡å¼€å‘ä¸­å´å¾ˆå°‘ä½¿ç”¨è¿™ä¸¤ç§ä¾èµ–æ³¨å…¥æ–¹å¼ï¼Œè€Œæ˜¯ä½¿ç”¨<code>@Autowired</code>æ³¨è§£è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚ä¸ç®¡æ˜¯ä¸šåŠ¡å±‚<code>Service</code>è¿˜æ˜¯ä»“å‚¨å±‚<code>MyBatis</code>æ¡†æ¶çš„<code>Mapper</code>æˆ–è€…å…¶å®ƒç­‰ç­‰ï¼Œä¸šåŠ¡ä»£ç å†™èµ·æ¥å¤§æ¦‚æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AutowiredService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IAService iaService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IBService ibService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ICService icService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AMapper aMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BMapper bMapper;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// do business</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„<code>@Autowired</code>å­—æ®µå°‘åˆ™ä¸‰äº”ä¸ªï¼Œå¤šåˆ™ä¸€äºŒåä¸ªã€‚è€Œä¸”åœ¨<code>IDEA</code>ä¸­ï¼Œ<code>XXXService</code>ä¸Šé¢çš„<code>@Autowired</code>æ³¨è§£ä¼šæœ‰ä¸€æ¡é»„è‰²çš„ä¸‹åˆ’çº¿ï¼š<code>Field injection is not recommended </code>ï¼›å¯¹äº<code>XXXMapper</code>ç±»æ¥è¯´ï¼Œå˜é‡åè¿˜ä¼šæœ‰ä¸€æ¡çº¢è‰²çš„ä¸‹åˆ’çº¿ï¼š<code>Could not autowire. No beans of &#39;XXXMapper&#39; type found.</code>ï¼Œè™½ç„¶è¿è¡Œèµ·æ¥ä¸ä¼šæŠ¥é”™ï¼Œä½†è¿™æ ·çš„è­¦å‘Šå’ŒæŠ¥é”™ç€å®è®©äººçœ‹èµ·æ¥å¾ˆä¸èˆ’æœã€‚</p><p>æœ‰äººè¯´å¯ä»¥ç”¨<code>@Resource</code>æ³¨è§£æ¥ä»£æ›¿<code>@Autowired</code>ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°è­¦å‘Šå’ŒæŠ¥é”™äº†ã€‚è¯šç„¶ï¼Œè¿™æ ·åšå¯ä»¥è§£å†³é—®é¢˜ï¼Œ<code>@Resource</code>é»˜è®¤ä¼˜å…ˆæŒ‰<code>beanName</code>è‡ªåŠ¨æ³¨å…¥ï¼Œ<code>@Autowired</code>é»˜è®¤ä¼˜å…ˆæŒ‰<code>beanType</code>è‡ªåŠ¨æ³¨å…¥ã€‚è¿™æ˜¯è§£å†³é—®é¢˜çš„ä¸€ç§æ–¹å¼ã€‚</p><blockquote><p><code>@Resource</code>æ³¨è§£æ˜¯<code>JSR-250</code>è§„èŒƒæä¾›çš„æ³¨è§£ï¼Œè€Œ<code>@Autowired</code>æ³¨è§£æ˜¯<code>Spring</code>æä¾›çš„ã€‚è¿™ç‚¹ä¸è¶³ä»¥ç§°ä¸ºæš‡ç–µã€‚</p></blockquote><h2 id="Lombokçš„ä¼˜é›…"><a href="#Lombokçš„ä¼˜é›…" class="headerlink" title="Lombokçš„ä¼˜é›…"></a><code>Lombok</code>çš„ä¼˜é›…</h2><p>å¦‚ä½•ä½¿ç”¨<code>Lombok</code>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ</p><p>æˆ‘ä»¬å…³æ³¨ä¸€ä¸‹æ„é€ å‡½æ•°æ³¨å…¥çš„å†™æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConstructorService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IAService iaService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IBService ibService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ICService icService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AMapper aMapper;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BMapper bMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConstructorService</span><span class="params">(IAService iaService, IBService ibService, ICService icService, AMapper aMapper, BMapper bMapper)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.iaService = iaService;</span><br><span class="line">        <span class="keyword">this</span>.ibService = ibService;</span><br><span class="line">        <span class="keyword">this</span>.icService = icService;</span><br><span class="line">        <span class="keyword">this</span>.aMapper = aMapper;</span><br><span class="line">        <span class="keyword">this</span>.bMapper = bMapper;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒè¦æ±‚æˆå‘˜å˜é‡æ˜¯<code>final</code>ç±»å‹ï¼ŒåŒæ—¶æ„é€ å‡½æ•°ä¸Šçš„<code>@Autowired</code>æ˜¯å¯é€‰çš„ã€‚</p><p>è€Œ<code>@RequiredArgsConstructor</code>åˆšå¥½æ˜¯ä¸ºè¢«å£°æ˜ä¸ºfinalçš„å­—æ®µç”Ÿæˆæ„é€ å™¨çš„æ³¨è§£ã€‚</p><p>äºæ˜¯æˆ‘ä»¬çš„å†™æ³•å°±å˜å¾—ä¼˜ï¼ˆ<code>zhuang</code>ï¼‰é›…ï¼ˆ<code>bi</code>ï¼‰èµ·æ¥ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LombokService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IAService iaService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IBService ibService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ICService icService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AMapper aMapper;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BMapper bMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// do business</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ç¼–è¯‘åçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LombokService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IAService iaService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IBService ibService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ICService icService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AMapper aMapper;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BMapper bMapper;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LombokService</span><span class="params">(IAService iaService, IBService ibService, ICService icService, AMapper aMapper, BMapper bMapper)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.iaService = iaService;</span><br><span class="line">        <span class="keyword">this</span>.ibService = ibService;</span><br><span class="line">        <span class="keyword">this</span>.icService = icService;</span><br><span class="line">        <span class="keyword">this</span>.aMapper = aMapper;</span><br><span class="line">        <span class="keyword">this</span>.bMapper = bMapper;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸å°±æ˜¯æ ‡å‡†çš„<code>Spring</code>æ„é€ å‡½æ•°æ³¨å…¥æ–¹å¼å—ï¼Ÿç”šè‡³æˆ‘ä»¬è¿˜å¯ä»¥æŠŠ<code>@Autowired</code>æ³¨è§£ç»™åŠ ä¸Šï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor = @_(@Autowired))</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LombokService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IAService iaService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IBService ibService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ICService icService;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AMapper aMapper;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BMapper bMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// do business</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ç¼–è¯‘åçš„æ„é€ å‡½æ•°ä¸Šå°±ä¼šåŠ ä¸Š<code>@Autowired</code>æ³¨è§£ã€‚</p><p><code>onConstructor = @_(@Autowired)</code>ä¸­é—´çš„<code>@_</code>è¿˜å¯ä»¥ç»§ç»­åŠ ä¸‹åˆ’çº¿<code>_</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor = @______________________________(@Autowired))</span></span><br></pre></td></tr></table></figure><p>å³ä½¿ä½ åƒä¸Šé¢è¿™æ ·å†™ï¼Œä»£ç ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œèƒ½æ­£å¸¸è¿è¡Œã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±åªç”¨å†™ä¸€ä¸ªæ³¨è§£å°±å¯ä»¥å®Œæˆä»»æ„å¤šä¸ªå±æ€§çš„æ³¨å…¥ï¼Œ<code>Lombok</code>å°±æ˜¯è¿™ä¹ˆä¼˜ï¼ˆ<code>zhuang</code>ï¼‰é›…ï¼ˆ<code>bi</code>ï¼‰ï¼æ‰€ä»¥è¯·å°½æƒ…åœ°æ‹¥æŠ±<code>Lombok</code>å§ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Java EE </category>
          
          <category> Lombok </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lombok </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lombokå¿…çŸ¥å¿…ä¼š</title>
      <link href="2020/12/13/javaee/lombok/lombok-base/"/>
      <url>2020/12/13/javaee/lombok/lombok-base/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><blockquote><p><a href="https://www.projectlombok.org/"><code>ProjectLombok</code>å®˜ç½‘</a> ä»‹ç»ï¼š<code>Project Lombok is a java library that automatically plugs into your editor and build tools, spicing up your java. Never write another getter or equals method again, with one annotation your class has a fully featured builder, Automate your logging variables, and much more.</code></p></blockquote><p>æ°¸è¿œä¸è¦å†å†™å¦ä¸€ä¸ª<code>getter</code>æˆ–è€…<code>equals</code>æ–¹æ³•ï¼Œä¸€ä¸ªæ³¨è§£å°±å¯ä»¥è®©ä½ çš„ç±»æœ‰ä¸€ä¸ªåŠŸèƒ½å…¨é¢çš„ç”Ÿæˆå™¨ï¼Œè‡ªåŠ¨åŒ–ä½ çš„æ—¥å¿—å˜é‡ç­‰ç­‰ã€‚</p><p>åœ¨ä¸šåŠ¡å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸å¯é¿å…çš„éœ€è¦å»å®šä¹‰æ•°æ®åº“è¡¨çš„å®ä½“<code>Entity</code>ç±»ã€ä¸­é—´æ•°æ®ä¼ è¾“å¯¹è±¡<code>DTO</code>ç±»ã€å‰ç«¯è§†å›¾å¯¹è±¡<code>VO</code>ç±»ç­‰ï¼Œè¿™äº›ç±»æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹å°±æ˜¯éƒ½ä¼šæœ‰å¾ˆå¤šå¾ˆå¤šçš„ä¸šåŠ¡å­—æ®µï¼Œæ‰¿è½½ç€ç³»ç»Ÿçš„ä¸šåŠ¡æ•°æ®ã€‚åŸºäºé¢å‘å¯¹è±¡çš„å°è£…æ€§ï¼Œç±»ä¸­çš„å­—æ®µä¼šè¢«å®šä¹‰æˆ<code>private</code>ï¼Œç„¶åæä¾›å‡º<code>public</code>çš„<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•æš´éœ²ç»™å¤–éƒ¨æ“ä½œã€‚äºæ˜¯ä»£ç ä¸­å°±å‡ºç°äº†ä¸€å¤§ç‰‡ä¸€å¤§ç‰‡çš„ä½¿ç”¨<code>IDE</code>ç”Ÿæˆçš„<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•ã€‚</p><p><code>Lombok</code>è¦è§£å†³çš„é—®é¢˜å°±æ˜¯å»æ¶ˆé™¤è¿™äº›æ¨¡ç‰ˆå¼çš„<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•ã€‚å½“ç„¶è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„æ¨¡ç‰ˆå¼çš„ä»£ç ä¹Ÿå¯ä»¥ä½¿ç”¨<code>Lombok</code>æ¥æ¶ˆé™¤ã€‚</p><h2 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h2><h3 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h3><p>å¼•å…¥<code>Maven</code>ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨<code>Lombok</code>ï¼Œè¿˜éœ€è¦åœ¨<code>IDE</code>ä¸Šå®‰è£…<code>Lombok</code>çš„æ’ä»¶ã€‚ï¼ˆæ’ä»¶çš„å®‰è£…æ–¹å¼è¯·è‡ªè¡Œè°·æ­Œï¼‰</p><blockquote><p>å¦‚æœæ˜¯<code>Spring Boot</code>é¡¹ç›®ï¼Œ<code>Spring Boot 2.1.x</code>ç‰ˆæœ¬çš„<code>parent</code>ä¸­é»˜è®¤å·²ç»é¢„å®šä¹‰äº†<code>Lombok</code>çš„ä¾èµ–ï¼Œç›´æ¥å¼•å…¥<code>Maven</code>åæ ‡å³å¯ã€‚</p></blockquote><h3 id="Getterå’Œ-Setter"><a href="#Getterå’Œ-Setter" class="headerlink" title="@Getterå’Œ@Setter"></a><code>@Getter</code>å’Œ<code>@Setter</code></h3><p>è¿™ä¸¤ä¸ªæ³¨è§£å¯ä»¥å•ç‹¬å†™åœ¨æŸäº›å­—æ®µä¸Šï¼Œä¹Ÿå¯ä»¥å†™åœ¨ç±»ä¸Šã€‚ç¼–è¯‘åä¼šåœ¨å­—èŠ‚ç æ–‡ä»¶ä¸­åŠ å…¥ç›¸åº”å­—æ®µçš„<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•ã€‚</p><p>å•ç‹¬å†™åœ¨ç±»ä¸Šçš„ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetterAndSetterTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Getter</span></span><br><span class="line">    <span class="keyword">private</span> String getField;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Setter</span></span><br><span class="line">    <span class="keyword">private</span> String setField;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Getter</span></span><br><span class="line">    <span class="meta">@Setter(AccessLevel.PROTECTED)</span></span><br><span class="line">    <span class="keyword">private</span> String otherField;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Getter</span></span><br><span class="line">    <span class="meta">@Setter</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String fs = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@Getter</code>æ³¨è§£ä¼šç”Ÿæˆå¯¹åº”å­—æ®µçš„<code>getter</code>æ–¹æ³•ï¼Œ<code>@Setter</code>æ³¨è§£ä¼šç”Ÿæˆå¯¹åº”å­—æ®µçš„<code>setter</code>æ–¹æ³•ï¼Œå¯åŒæ—¶ä½œç”¨äºåŒä¸€ä¸ªå­—æ®µï¼Œè¿˜å¯ä»¥å®šä¹‰ç”Ÿæˆçš„æ–¹æ³•çš„è®¿é—®ä¿®é¥°ç¬¦ï¼Œä¾‹å¦‚<code>@Setter(AccessLevel.PROTECTED)</code>ç”Ÿæˆçš„<code>setter</code>æ–¹æ³•å°±æ˜¯<code>protected</code>çº§åˆ«çš„ã€‚</p><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå­—æ®µè¢«å£°æ˜æˆ<code>final</code>ç±»å‹ï¼Œ<code>@Setter</code>æ³¨è§£ä¸ä¼šä¸ºå…¶ç”Ÿæˆå¯¹åº”çš„<code>setter</code>æ–¹æ³•ã€‚</p></blockquote><p>ç¼–è¯‘åçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetterAndSetterTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String getField;</span><br><span class="line">    <span class="keyword">private</span> String setField;</span><br><span class="line">    <span class="keyword">private</span> String otherField;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GetterAndSetterTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getGetField</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.getField;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSetField</span><span class="params">(String setField)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setField = setField;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getOtherField</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.otherField;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setOtherField</span><span class="params">(String otherField)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.otherField = otherField;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.fs;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸æƒ³ç»†ç²’åº¦çš„æ§åˆ¶åˆ°æ¯ä¸ªå­—æ®µï¼Œå¯ä»¥ç›´æ¥åœ¨ç±»ä¸Šæ·»åŠ <code>@Getter</code>å’Œ<code>Setter</code>æ³¨è§£ï¼Œä¼šä¸ºæ‰€æœ‰çš„å­—æ®µç”Ÿæˆ<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•ã€‚</p><h3 id="ToString"><a href="#ToString" class="headerlink" title="@ToString"></a><code>@ToString</code></h3><p>æˆ‘ä»¬ç»å¸¸ä¼šå»é‡å†™<code>Object#toString()</code>æ–¹æ³•ä»¥ä¾¿åœ¨æ§åˆ¶å°è¾“å‡ºæ—¶æ‰“å°çš„æ˜¯ç±»çš„åŸºæœ¬ä¿¡æ¯è€Œä¸æ˜¯åå…­è¿›åˆ¶çš„åœ°å€å€¼ã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ToString(exclude = &#123;&quot;id&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToStringTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> UserInfo userInfo;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ToString</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseInfo</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String username;</span><br><span class="line">        <span class="keyword">private</span> String password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ToString(callSuper = true,includeFieldNames = false)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span> <span class="keyword">extends</span> <span class="title">BaseInfo</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Integer age;</span><br><span class="line">        <span class="keyword">private</span> Integer gender;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@ToString</code>æ³¨è§£ä¼šç”Ÿæˆä¸€ä¸ª<code>toString()</code>æ–¹æ³•ï¼Œé»˜è®¤è¾“å‡ºç±»åï¼Œæ‰€æœ‰å­—æ®µçš„åç§°å’Œå€¼ã€‚å¯ä»¥ä½¿ç”¨æ³¨è§£çš„<code>exclude</code>å±æ€§æ¥æ’é™¤æŸäº›å­—æ®µï¼›è¿˜å¯ä»¥è®¾ç½®<code>includeFieldNames = false</code>å±è”½æ‰€æœ‰å­—æ®µåç§°çš„è¾“å‡ºï¼›å¦‚æœå­—æ®µå­˜åœ¨åŸºç±»ï¼Œå¯ä»¥è®¾ç½®<code>callSuper = true</code>æ¥è¾“å‡ºåŸºç±»ä¸­çš„å­—æ®µã€‚</p><p>ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToStringTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> ToStringTest.UserInfo userInfo;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ToStringTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ToStringTest(address=&quot;</span> + <span class="keyword">this</span>.address + <span class="string">&quot;, userInfo=&quot;</span> + <span class="keyword">this</span>.userInfo + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span> <span class="keyword">extends</span> <span class="title">ToStringTest</span>.<span class="title">BaseInfo</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Integer age;</span><br><span class="line">        <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UserInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;ToStringTest.UserInfo(super=&quot;</span> + <span class="keyword">super</span>.toString() + <span class="string">&quot;, &quot;</span> + <span class="keyword">this</span>.age + <span class="string">&quot;, &quot;</span> + <span class="keyword">this</span>.gender + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseInfo</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String username;</span><br><span class="line">        <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">BaseInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;ToStringTest.BaseInfo(username=&quot;</span> + <span class="keyword">this</span>.username + <span class="string">&quot;, password=&quot;</span> + <span class="keyword">this</span>.password + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="EqualsAndHashCode"><a href="#EqualsAndHashCode" class="headerlink" title="@EqualsAndHashCode"></a><code>@EqualsAndHashCode</code></h3><p>è‡ªå®šä¹‰ç±»å¯¹è±¡è¿›è¡Œç›¸ç­‰æ¯”è¾ƒæ—¶ä¸€èˆ¬éœ€è¦é‡å†™<code>equals()</code>æ–¹æ³•ï¼ŒåŒæ—¶æœ€å¥½ä¹Ÿé‡å†™<code>hashCode()</code>æ–¹æ³•ã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EqualsAndHashCode(exclude = &#123;&quot;ex&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EqualsAndHashCodeTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String equal;</span><br><span class="line">    <span class="keyword">private</span> String hc;</span><br><span class="line">    <span class="keyword">transient</span> String tr;</span><br><span class="line">    <span class="keyword">private</span> String ex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨æ‰€æœ‰éé™æ€<code>non-static</code>å’Œéç¬æ€<code>non-transient</code>çš„å­—æ®µæ¥ç”Ÿæˆ<code>equals()</code>å’Œ<code>hashCode()</code>æ–¹æ³•ã€‚ç±»ä¼¼åœ°ï¼Œå¯ä»¥ä½¿ç”¨<code>exclude</code>å±æ€§æ¥æ’é™¤æŸäº›å­—æ®µï¼›å¦‚æœå­˜åœ¨åŸºç±»ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>callSuper = true</code>æ¥å›Šæ‹¬åŸºç±»ä¸­çš„å­—æ®µã€‚</p><p>ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EqualsAndHashCodeTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String equal;</span><br><span class="line">    <span class="keyword">private</span> String hc;</span><br><span class="line">    <span class="keyword">transient</span> String tr;</span><br><span class="line">    <span class="keyword">private</span> String ex;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EqualsAndHashCodeTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> EqualsAndHashCodeTest)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            EqualsAndHashCodeTest other = (EqualsAndHashCodeTest)o;</span><br><span class="line">            <span class="keyword">if</span> (!other.canEqual(<span class="keyword">this</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Object <span class="keyword">this</span>$equal = <span class="keyword">this</span>.equal;</span><br><span class="line">                Object other$equal = other.equal;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>$equal == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (other$equal != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">this</span>$equal.equals(other$equal)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                Object <span class="keyword">this</span>$hc = <span class="keyword">this</span>.hc;</span><br><span class="line">                Object other$hc = other.hc;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>$hc == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (other$hc != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">this</span>$hc.equals(other$hc)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">canEqual</span><span class="params">(Object other)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> other <span class="keyword">instanceof</span> EqualsAndHashCodeTest;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> PRIME = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">        Object $equal = <span class="keyword">this</span>.equal;</span><br><span class="line">        <span class="keyword">int</span> result = result * <span class="number">59</span> + ($equal == <span class="keyword">null</span> ? <span class="number">43</span> : $equal.hashCode());</span><br><span class="line">        Object $hc = <span class="keyword">this</span>.hc;</span><br><span class="line">        result = result * <span class="number">59</span> + ($hc == <span class="keyword">null</span> ? <span class="number">43</span> : $hc.hashCode());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿˜åŠ å…¥äº†ä¸€ä¸ª<code>canEqual</code>æ–¹æ³•ç”¨æ¥é¢„å…ˆåˆ¤æ–­æ˜¯å¦èƒ½å’Œå½“å‰ç±»å¯¹è±¡è¿›è¡Œ<code>equals</code>æ¯”è¾ƒã€‚</p><h3 id="Data"><a href="#Data" class="headerlink" title="@Data"></a><code>@Data</code></h3><p>åŸºæœ¬ä¸Šæ¯ä¸€ä¸ªå®ä½“ç±»éƒ½ä¼šä½¿ç”¨åˆ°ä¸Šé¢å››ä¸ªæ³¨è§£ï¼š<code>@Getter</code>ã€<code>@Setter</code>ã€<code>@ToString</code>å’Œ<code>@EqualsAndHashCode</code>ï¼Œä½†æ˜¯å¦‚æœåœ¨æ¯ä¸€ä¸ªç±»ä¸Šéƒ½é‡å¤çš„å†™ä¸Šè¿™å››ä¸ªæ³¨è§£ï¼Œå°±åˆæ˜¾å¾—ç´¯èµ˜äº†ã€‚äºæ˜¯<code>Lombok</code>æä¾›äº†<code>@Data</code>æ³¨è§£ï¼Œå®ƒç­‰ä»·äºè¿™å››ä¸ªæ³¨è§£çš„ç»„åˆï¼Œä¼šåŒæ—¶ç”Ÿæˆ<code>getter</code>ã€<code>setter</code>ã€<code>toString</code>ã€<code>equals</code>ã€<code>canEqual</code>å’Œ<code>hashCode</code>è¿™å…­ä¸ªæ–¹æ³•ã€‚åŒæ—¶è¿˜æä¾›äº†ä¸€ä¸ªå±æ€§<code>staticConstructor</code>ï¼Œä¾‹å¦‚ï¼š<code>staticConstructor=&quot;of&quot;</code>ï¼Œè¿™æ ·ä½¿ç”¨åï¼Œä¼šå°†æ— å‚æ„é€ å‡½æ•°ç§æœ‰åŒ–ï¼ŒåŒæ—¶ä¼šæä¾›ä¸€ä¸ªé™æ€æˆå‘˜æ–¹æ³•<code>of()</code>ç”¨æ¥åˆ›å»ºå½“å‰ç±»å¯¹è±¡ï¼Œåœ¨ç±»å¤–éƒ¨æ— æ³•ä½¿ç”¨<code>new</code>å…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡ã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data(staticConstructor = &quot;of&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String s;</span><br><span class="line">    <span class="keyword">private</span> String c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String s;</span><br><span class="line">    <span class="keyword">private</span> String c;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">DataTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataTest <span class="title">of</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataTest();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setS</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.s = s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setC</span><span class="params">(String c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.c = c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> DataTest)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            DataTest other = (DataTest)o;</span><br><span class="line">            <span class="keyword">if</span> (!other.canEqual(<span class="keyword">this</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Object <span class="keyword">this</span>$s = <span class="keyword">this</span>.getS();</span><br><span class="line">                Object other$s = other.getS();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>$s == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (other$s != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">this</span>$s.equals(other$s)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                Object <span class="keyword">this</span>$c = <span class="keyword">this</span>.getC();</span><br><span class="line">                Object other$c = other.getC();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>$c == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (other$c != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">this</span>$c.equals(other$c)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">canEqual</span><span class="params">(Object other)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> other <span class="keyword">instanceof</span> DataTest;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> PRIME = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">        Object $s = <span class="keyword">this</span>.getS();</span><br><span class="line">        <span class="keyword">int</span> result = result * <span class="number">59</span> + ($s == <span class="keyword">null</span> ? <span class="number">43</span> : $s.hashCode());</span><br><span class="line">        Object $c = <span class="keyword">this</span>.getC();</span><br><span class="line">        result = result * <span class="number">59</span> + ($c == <span class="keyword">null</span> ? <span class="number">43</span> : $c.hashCode());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;DataTest(s=&quot;</span> + <span class="keyword">this</span>.getS() + <span class="string">&quot;, c=&quot;</span> + <span class="keyword">this</span>.getC() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="NoArgsConstructorã€-AllArgsConstructorå’ŒRequiredArgsConstructor"><a href="#NoArgsConstructorã€-AllArgsConstructorå’ŒRequiredArgsConstructor" class="headerlink" title="@NoArgsConstructorã€@AllArgsConstructorå’ŒRequiredArgsConstructor"></a><code>@NoArgsConstructor</code>ã€<code>@AllArgsConstructor</code>å’Œ<code>RequiredArgsConstructor</code></h3><ul><li><code>@NoArgsConstructor</code>ï¼šæ— å‚æ„é€ å™¨ï¼›</li><li><code>@AllArgsConstructor</code>ï¼šå…¨å‚æ„é€ å™¨ï¼›</li><li><code>@RequiredArgsConstructor</code>ï¼šéƒ¨åˆ†å‚æ•°æ„é€ å™¨ï¼Œé’ˆå¯¹è¢«å£°æ˜ä¸º<code>final</code>çš„å­—æ®µç”Ÿæˆæ„é€ å™¨ã€‚</li></ul><p><code>Java</code>ç±»çš„æ„é€ å™¨æœºåˆ¶æ˜¯ï¼šå¦‚æœç±»ä¸­æœªå£°æ˜ä»»ä½•ä¸€ä¸ªæ„é€ å™¨ï¼Œåˆ™ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æœŸè‡ªåŠ¨åŠ ä¸Šä¸€ä¸ªæ— å‚æ„é€ å™¨ï¼›å¦‚æœå£°æ˜äº†ä»»æ„ä¸€ä¸ªæ„é€ å™¨ï¼Œåˆ™ä¸ä¼šè‡ªåŠ¨åŠ ä¸Šæ— å‚æ„é€ å™¨ã€‚</p><p>æ‰€ä»¥ä¸€èˆ¬ä¼šå°†æ— å‚å’Œå…¨å‚æ„é€ å™¨è¿›è¡Œæ­é…ä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArgsConstructor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String ac;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArgsConstructor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String ac;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArgsConstructor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArgsConstructor</span><span class="params">(String ac)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ac = ac;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œ<code>@RequiredArgsConstructor</code>æ³¨è§£è·Ÿå‰ä¸¤ä¸ªæ˜¯äº’æ–¥çš„ï¼Œè¯¥æ³¨è§£æ˜¯é’ˆå¯¹<code>final</code>å­—æ®µæ¥ç”Ÿæˆæ„é€ å™¨ï¼Œå¯ä¸<code>Spring</code>çš„<code>DI</code>ä¾èµ–æ³¨å…¥æ­é…ä½¿ç”¨ã€‚</p><h3 id="Slf4j"><a href="#Slf4j" class="headerlink" title="@Slf4j"></a><code>@Slf4j</code></h3><p>ä½œä¸ºç ”å‘æˆ‘ä»¬é¿å…ä¸äº†æ—¥å¿—æ‰“å°ï¼Œä½†æˆ‘ä»¬å´è¦åœ¨æ¯ä¸€ä¸ªéœ€è¦æ‰“å°æ—¥å¿—çš„ç±»ä¸­å®šä¹‰è¿™æ ·ä¸€ä¸ªé™æ€æ—¥å¿—å¸¸é‡ï¼š<code>private static final Logger log = LoggerFactory.getLogger(XXXService.class);</code>ï¼Œå…¶ä¸­<code>XXXService</code>çš„åç§°è¿˜éƒ½ä¸ç›¸åŒï¼Œè¿™å¤ªå½±å“åƒæˆ‘è¿™æ ·çš„<code>CV</code>å·¥ç¨‹å¸ˆçš„æ•ˆç‡äº†ã€‚<code>Lombok</code>æä¾›äº†<code>@Slf4j</code>æ³¨è§£æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä½¿ç”¨å‰æï¼šå¼•å…¥æ—¥å¿—æ¡†æ¶<code>slf4j</code>çš„<code>Maven</code>ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogTest</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(LogTest.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LogTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªç”¨ä¸€ä¸ªç›¸åŒçš„æ³¨è§£<code>@Slf4j</code>å°±å¯ä»¥ä¸ºæ¯ä¸ªç±»åˆ†åˆ«ç”Ÿæˆå¯¹åº”çš„æ—¥å¿—å¸¸é‡<code>log</code>å¯¹è±¡ã€‚<code>CV</code>å·¥ç¨‹å¸ˆçš„æ•ˆç‡åˆæé«˜äº†ï¼</p><h2 id="åŸç†åˆ†æ"><a href="#åŸç†åˆ†æ" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h2><p><code>Lombok</code>çš„ä½¿ç”¨å¾ˆç®€å•ï¼Œåªéœ€æ·»åŠ å¯¹åº”æ³¨è§£ï¼Œå°±å¯ä»¥åœ¨å­—èŠ‚ç ä¸­ç”Ÿæˆå¯¹åº”çš„ä»£ç ã€‚ä»æºæ–‡ä»¶åˆ°å­—èŠ‚ç ä¹‹é—´åªç»è¿‡äº†ç¼–è¯‘é˜¶æ®µï¼Œæ‰€ä»¥<code>Lombok</code>ä¸€å®šæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå¯¹æ³¨è§£è¿›è¡Œè§£æç„¶åæ³¨å…¥å¯¹åº”çš„å­—èŠ‚ç ã€‚</p><p>è€Œç¼–è¯‘é˜¶æ®µå¯¹æ³¨è§£çš„è§£ææœ‰ä¸¤ç§æœºåˆ¶ï¼š</p><ol><li><code>Annotation Processing Tool</code>ï¼šç®€ç§°<code>apt</code></li></ol><p><code>apt</code>éšç€<code>JDK5</code>å¼•å…¥æ³¨è§£æ—¶äº§ç”Ÿï¼Œåœ¨<code>JDK7</code>ä¸­è¢«æ ‡è®°ä¸ºè¿‡æœŸï¼Œä¸æ¨èä½¿ç”¨ï¼Œ<code>JDK8</code>å·²å½»åº•å°†å…¶åˆ é™¤ã€‚</p><p>ä»<code>JDK6</code>å¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨<code>Pluggable Annotation Processing API</code>æ¥æ›¿æ¢å®ƒï¼Œ<code>apt</code>è¢«æ›¿æ¢çš„ä¸»è¦åŸå› æ˜¯ï¼š</p><ul><li><code>api</code>éƒ½åœ¨<code>com.sun.mirror</code>éæ ‡å‡†åŒ…ä¸‹ï¼›</li><li>æ²¡æœ‰é›†æˆåˆ°<code>javac</code>ä¸­ï¼Œéœ€è¦é¢å¤–è¿è¡Œã€‚</li></ul><ol start="2"><li><code>Pluggable Annotation Processing API</code></li></ol><p>è¿™å…¶å®æ˜¯<a href="https://jcp.org/en/jsr/detail?id=269">JSR 269</a>è§„èŒƒï¼Œåœ¨<code>JDK6</code>ä¸­è¢«å¼•å…¥ä½œä¸º<code>apt</code>çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒè§£å†³äº†<code>apt</code>çš„é‚£ä¸¤ä¸ªé—®é¢˜ï¼Œåœ¨<code>javac</code>æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šè°ƒç”¨å®ç°äº†è¯¥è§„èŒƒçš„ç¨‹åºï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¯¹<code>javac</code>ç¼–è¯‘å™¨åšä¸€äº›å¢å¼ºã€‚</p><blockquote><p><code>JSR</code>æ˜¯<code>Java Specification Requests</code>çš„ç¼©å†™ï¼Œæ„æ€æ˜¯<code>Java</code>è§„èŒƒææ¡ˆã€‚</p></blockquote><p><code>Lombok</code>å°±æ˜¯ä¸€ä¸ªå®ç°äº†<code>JSR 269</code>è§„èŒƒçš„ç¨‹åºï¼Œåœ¨<code>javac</code>ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šè°ƒç”¨<code>Lombok</code>ï¼Œä»è€Œå®ç°ä»£ç çš„è‡ªåŠ¨åŠ å…¥ã€‚</p><p>æ•´ä¸ªç¼–è¯‘çš„è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><ul><li><code>javac</code>å¯¹æºä»£ç è¿›è¡Œåˆ†æï¼Œç”Ÿæˆä¸€é¢—æŠ½è±¡è¯­æ³•æ ‘ï¼ˆ<code>AST</code>ï¼‰ï¼›</li><li>è°ƒç”¨<code>JSR 269</code>çš„å®ç°ï¼š<code>Lombok</code>ï¼›</li><li><code>Lombok</code>å¯¹æŠ½è±¡è¯­æ³•æ ‘è¿›è¡Œè§£æï¼Œæ‰¾åˆ°<code>Lombok</code>å®šä¹‰çš„æ³¨è§£æ‰€åœ¨çš„è¯­æ³•æ ‘ï¼Œç„¶åè¿›è¡Œä¿®æ”¹ï¼Œæ·»åŠ <code>getter</code>å’Œ<code>setter</code>ç­‰æ–¹æ³•å®šä¹‰çš„æ ‘èŠ‚ç‚¹ï¼›</li><li>ä½¿ç”¨ä¿®æ”¹åçš„è¯­æ³•æ ‘ç”Ÿæˆå­—èŠ‚ç <code>class</code>æ–‡ä»¶ã€‚</li></ul><h2 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>ä»£ç ç®€æ´ä¼˜é›…ï¼Œé€šè¿‡æ³¨è§£çš„å½¢å¼è‡ªåŠ¨ç”Ÿæˆä¸€äº›æ¨¡ç‰ˆå¼çš„ä»£ç ã€‚</li><li>å½“ç±»å­—æ®µå‘ç”Ÿä¿®æ”¹æ—¶ï¼Œä¸ç”¨å»ä¿®æ”¹å¯¹åº”çš„<code>getter</code>å’Œ<code>setter</code>ç­‰æ–¹æ³•ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li><code>IDE</code>ä¸­éœ€è¦å®‰è£…æ’ä»¶ï¼Œå¦åˆ™é¡¹ç›®æŠ¥é”™ã€‚</li><li>ä¸æ”¯æŒä»»æ„ä¸ªå‚æ•°çš„æ„é€ å™¨é‡è½½ã€‚</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…³äº<code>Lombok</code>ï¼Œç½‘ä¸Šä¸€éƒ¨åˆ†äººæ”¯æŒï¼Œä¸€éƒ¨åˆ†äººåå¯¹ã€‚åå¯¹çš„ç†ç”±è¿˜å¾ˆå¤šï¼šå¼ºä¾èµ–æ’ä»¶ï¼›ç»„å†…æœ‰ä¸€äººç”¨åˆ™æ‰€æœ‰äººç”¨ï¼›æ“ä½œè¯­æ³•æ ‘ç­‰äºæ”¹å˜<code>Java</code>è¯­æ³•ç­‰ç­‰ã€‚æš‚ä¸”è®¤ä¸ºè¿™äº›éƒ½æœ‰é“ç†ï¼Œä½†æœ‰å¥è¯æ€ä¹ˆè¯´æ¥ç€ï¼šæ‹¥æŠ±å˜åŒ–ï¼<code>Java</code>è¯­è¨€èµ°è¿‡è¿™ä¹ˆå¤šå¹´ä¹Ÿç»è¿‡äº†å¾ˆå¤šå˜åŒ–ï¼Œæ¯ä¸ªå¤§ç‰ˆæœ¬ä¹Ÿæˆ–å¤šæˆ–å°‘ä¼šå‡ºç°ä¸€äº›æ–°è¯­æ³•ã€‚<code>Lombok</code>çš„å‡ºç°ä¹Ÿé¢„ç¤ºç€<code>Java</code>éœ€è¦å‘ç”Ÿå˜åŒ–ï¼Œè€Œä¸æ˜¯å±€é™äºå½“ä¸‹çš„å®‰ç¨³ã€‚æ‰€ä»¥ï¼Œæˆ‘è®¤ä¸º<code>Lombok</code>æ˜¯å€¼å¾—å»æ‹¥æŠ±çš„ï¼</p><blockquote><p>ä»å¦ä¸€ä¸ªè§’åº¦è¯´ï¼Œé‚£äº›åå¯¹<code>Lombok</code>çš„äººå¯èƒ½æ˜¯æ²¡å†™è¿‡ä¸šåŠ¡ç³»ç»Ÿï¼Œä¸šåŠ¡ä»£ç ä¸­ç»å¸¸å‡ºç°ä¸€ä¸ªç±»æœ‰äºŒä¸‰åä¸ªå­—æ®µï¼Œç”šè‡³æ›´å¤šï¼Œè¿™æ—¶å¦‚æœæ‰‹åŠ¨å»ç»´æŠ¤å„ä¸ªç±»çš„<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•ï¼Œæ•ˆç‡å¯æƒ³è€ŒçŸ¥ï¼Œè€Œä¸”ä¹Ÿæ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡ã€‚æ‰“å·¥äººè®²ç©¶çš„æ˜¯å¦‚ä½•é«˜æ•ˆæ‰“å·¥ï¼</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Java EE </category>
          
          <category> Lombok </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lombok </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†</title>
      <link href="2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/"/>
      <url>2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/</url>
      
        <content type="html"><![CDATA[<h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>é“¾è¡¨ï¼šå„ä¸ªå…ƒç´ ç‰©ç†å†…å­˜ç©ºé—´ä¸è¿ç»­ï¼Œé€šè¿‡â€œæŒ‡é’ˆâ€å°†ä¸€ç»„é›¶æ•£çš„å†…å­˜ç©ºé—´ä¸²è”èµ·æ¥ã€‚æŒ‡é’ˆçš„é“¾æ¥é¡ºåºä¸ºé“¾è¡¨ä¸­å…ƒç´ çš„é€»è¾‘é¡ºåºã€‚</p><h2 id="åŸºæœ¬ç‰¹ç‚¹"><a href="#åŸºæœ¬ç‰¹ç‚¹" class="headerlink" title="åŸºæœ¬ç‰¹ç‚¹"></a>åŸºæœ¬ç‰¹ç‚¹</h2><p>é“¾è¡¨ç”±ä¸€ç»„èŠ‚ç‚¹ç»„æˆï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ªæ˜¯å­˜å‚¨å…ƒç´ çš„æ•°æ®åŸŸï¼Œå¦ä¸€ä¸ªæ˜¯å­˜å‚¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹åœ°å€çš„æŒ‡é’ˆåŸŸã€‚å¤©ç„¶æ”¯æŒåŠ¨æ€æ‰©å®¹ã€‚</p><h2 id="é“¾è¡¨åˆ†ç±»"><a href="#é“¾è¡¨åˆ†ç±»" class="headerlink" title="é“¾è¡¨åˆ†ç±»"></a>é“¾è¡¨åˆ†ç±»</h2><ul><li>å•é“¾è¡¨ï¼šç¬¬ä¸€ä¸ªèŠ‚ç‚¹ç§°ä¸ºå¤´èŠ‚ç‚¹ï¼Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ç§°ä¸ºå°¾èŠ‚ç‚¹ã€‚å¤´èŠ‚ç‚¹ç”¨æ¥è®°å½•é“¾è¡¨çš„åŸºåœ°å€ï¼Œå¯ä»¥é€šè¿‡å¤´èŠ‚ç‚¹éå†æ•´ä¸ªé“¾è¡¨ã€‚å°¾èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘<code>null</code>ã€‚</li><li>å¾ªç¯é“¾è¡¨ï¼šç‰¹æ®Šçš„å•é“¾è¡¨ï¼Œä¸å•é“¾è¡¨å”¯ä¸€ä¸åŒçš„æ˜¯ï¼šå°¾èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘äº†å¤´èŠ‚ç‚¹ã€‚</li><li>åŒå‘é“¾è¡¨ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸ä»…å­˜å‚¨æ•°æ®åŸŸå’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸï¼Œå®ƒè¿˜ä¼šæœ‰ä¸€ä¸ªæŒ‡é’ˆåŸŸæŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚é€šå¸¸ç§°ä¸ºå‰é©±èŠ‚ç‚¹å’Œåç»§èŠ‚ç‚¹ã€‚</li><li>åŒå‘å¾ªç¯é“¾è¡¨ï¼šç»¼åˆäº†å¾ªç¯é“¾è¡¨å’ŒåŒå‘é“¾è¡¨ã€‚å¤´èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘å°¾èŠ‚ç‚¹ï¼Œå°¾èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘å¤´èŠ‚ç‚¹ã€‚</li></ul><p><code>JDK</code>çš„<code>java.util.LinkedList</code>å°±æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚</p><h2 id="å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰"><a href="#å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰" class="headerlink" title="å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰"></a>å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰</h2><p>æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªå•é“¾è¡¨çš„èŠ‚ç‚¹ç±»<code>SinglyLinkedListNode</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.sparrow.algorithm.base.linkedlist;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•å‘é“¾è¡¨èŠ‚ç‚¹ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser admin@lilu.org.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2020/6/3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SinglyLinkedListNode</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å€¼åŸŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Integer val;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‡é’ˆåŸŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> SinglyLinkedListNode next;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SinglyLinkedListNode</span><span class="params">(Integer val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.val = val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ„é€ å•é“¾è¡¨åŠå…¶æ‰“å°"><a href="#æ„é€ å•é“¾è¡¨åŠå…¶æ‰“å°" class="headerlink" title="æ„é€ å•é“¾è¡¨åŠå…¶æ‰“å°"></a>æ„é€ å•é“¾è¡¨åŠå…¶æ‰“å°</h2><p>æ„é€ ä¸€ä¸ªå•é“¾è¡¨ï¼Œå¹¶æŒ‰é¡ºåºæ‰“å°åœ¨æ§åˆ¶å°ã€‚æˆ‘ä»¬æä¾›ä¸€ä¸ªå·¥å…·ç±»<code>LinkedListUtils</code>æ¥å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.sparrow.algorithm.base.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sunchaser.sparrow.algorithm.base.linkedlist.SinglyLinkedListNode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é“¾è¡¨å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser admin@lilu.org.cn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> JDK8 2020/12/11</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedListUtils</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">LinkedListUtils</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„é€ ä¸€ä¸ªå•é“¾è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å•é“¾è¡¨å¤´èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SinglyLinkedListNode <span class="title">generateSinglyLinkedList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SinglyLinkedListNode node4 = <span class="keyword">new</span> SinglyLinkedListNode(<span class="number">5</span>,<span class="keyword">null</span>);</span><br><span class="line">        SinglyLinkedListNode node3 = <span class="keyword">new</span> SinglyLinkedListNode(<span class="number">4</span>,node4);</span><br><span class="line">        SinglyLinkedListNode node2 = <span class="keyword">new</span> SinglyLinkedListNode(<span class="number">3</span>,node3);</span><br><span class="line">        SinglyLinkedListNode node1 = <span class="keyword">new</span> SinglyLinkedListNode(<span class="number">2</span>,node2);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SinglyLinkedListNode(<span class="number">1</span>,node1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰é¡ºåºæ‰“å°å•é“¾è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> head è¦æ‰“å°çš„å•é“¾è¡¨å¤´èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printLink</span><span class="params">(SinglyLinkedListNode head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-&gt;&quot;</span> + head.val + <span class="string">&quot;-&gt;null&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.print(<span class="string">&quot;-&gt;&quot;</span> + head.val);</span><br><span class="line">        printLink(head.next);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ’å…¥å’Œåˆ é™¤æ“ä½œ"><a href="#æ’å…¥å’Œåˆ é™¤æ“ä½œ" class="headerlink" title="æ’å…¥å’Œåˆ é™¤æ“ä½œ"></a>æ’å…¥å’Œåˆ é™¤æ“ä½œ</h2><p>å•é“¾è¡¨çš„æ’å…¥æ“ä½œï¼šä¾‹å¦‚ï¼š<code>1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; null</code>ã€‚</p><p>ç°åœ¨è¦å°†å…ƒç´ <code>0</code>æ’å…¥åˆ°<code>3</code>å’Œ<code>4</code>ä¹‹é—´ã€‚åšæ³•å¾ˆç®€å•ï¼Œåªéœ€è¦å…ˆå°†<code>0</code>æŒ‡å‘<code>4</code>ï¼Œå†å°†<code>3</code>æŒ‡å‘<code>0</code>å³å¯ã€‚æ³¨æ„å…ˆåé¡ºåºï¼Œè¦å…ˆå°†<code>0</code>æŒ‡å‘<code>4</code>ï¼Œåå°†<code>3</code>æŒ‡å‘<code>0</code>ã€‚å› ä¸ºå¦‚æœé¡ºåºå¯¹è°ƒï¼Œå°†<code>3</code>å…ˆæŒ‡å‘<code>0</code>ä¹‹åå°±æ‰¾ä¸åˆ°èŠ‚ç‚¹<code>4</code>äº†ã€‚</p><p>ç°åœ¨è¦å°†<code>0</code>ä»é“¾è¡¨ä¸­åˆ é™¤ã€‚éœ€è¦å°†èŠ‚ç‚¹<code>0</code>å‰é¢çš„èŠ‚ç‚¹<code>3</code>æŒ‡å‘èŠ‚ç‚¹<code>0</code>åé¢çš„<code>4</code>ï¼Œç„¶åå°†èŠ‚ç‚¹<code>0</code>çš„æŒ‡é’ˆåŸŸç½®ä¸ºç©ºã€‚æ³¨æ„ï¼šå°†èŠ‚ç‚¹<code>3</code>æŒ‡å‘èŠ‚ç‚¹<code>4</code>åï¼Œä¸­é—´çš„èŠ‚ç‚¹<code>0</code>å°±ä¼šæ‰¾ä¸åˆ°äº†ï¼Œæ‰€ä»¥éœ€è¦ç”¨ä¸€ä¸ªä¸­é—´å˜é‡æ¥ä¿å­˜èŠ‚ç‚¹<code>0</code>ï¼Œå¾…æŒ‡å‘å®Œæˆåå†å°†èŠ‚ç‚¹<code>0</code>çš„æŒ‡é’ˆåŸŸæŒ‡å‘<code>null</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// generate singly linked list</span></span><br><span class="line">    SinglyLinkedListNode head = LinkedListUtils.generateSinglyLinkedList();</span><br><span class="line">    LinkedListUtils.printLink(head); <span class="comment">// -&gt;1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;null</span></span><br><span class="line">    <span class="comment">// ä»3å’Œ4ä¹‹é—´æ’å…¥0</span></span><br><span class="line">    SinglyLinkedListNode c = <span class="keyword">new</span> SinglyLinkedListNode(<span class="number">0</span>);</span><br><span class="line">    SinglyLinkedListNode cHead = head;</span><br><span class="line">    <span class="keyword">while</span> (cHead.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cHead.val == <span class="number">3</span>) &#123;</span><br><span class="line">            c.next = cHead.next;</span><br><span class="line">            cHead.next = c;</span><br><span class="line">        &#125;</span><br><span class="line">        cHead = cHead.next;</span><br><span class="line">    &#125;</span><br><span class="line">    LinkedListUtils.printLink(head); <span class="comment">// -&gt;1-&gt;2-&gt;3-&gt;0-&gt;4-&gt;5-&gt;null</span></span><br><span class="line">    <span class="comment">// å°†0ä»3å’Œ4ä¹‹é—´åˆ é™¤</span></span><br><span class="line">    SinglyLinkedListNode dHead = head;</span><br><span class="line">    <span class="keyword">while</span> (dHead.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dHead.val == <span class="number">3</span>) &#123;</span><br><span class="line">            SinglyLinkedListNode temp = dHead.next;</span><br><span class="line">            dHead.next = dHead.next.next;</span><br><span class="line">            temp.next = <span class="keyword">null</span>; <span class="comment">// help gc</span></span><br><span class="line">        &#125;</span><br><span class="line">        dHead = dHead.next;</span><br><span class="line">    &#125;</span><br><span class="line">    LinkedListUtils.printLink(head); <span class="comment">// -&gt;1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-å¥‡æ•°ä¸ªå…ƒç´ çš„é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹</title>
      <link href="2020/12/12/algorithm/base/datastructure/middle-linknode/"/>
      <url>2020/12/12/algorithm/base/datastructure/middle-linknode/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªå¥‡æ•°ä¸ªå…ƒç´ çš„é“¾è¡¨ï¼ŒæŸ¥æ‰¾å‡ºè¿™ä¸ªé“¾è¡¨ä¸­é—´ä½ç½®çš„èŠ‚ç‚¹çš„æ•°å€¼ã€‚</p><p>ç¤ºä¾‹ï¼šå•é“¾è¡¨ï¼š<code>1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; null</code>ï¼Œä¸­é—´ä½ç½®çš„èŠ‚ç‚¹çš„æ•°å€¼ä¸º<code>3</code>ã€‚</p><p>æ€è·¯ï¼šç”±äºå•é“¾è¡¨ç‰¹æ€§ï¼Œæˆ‘ä»¬åªèƒ½å…ˆéå†ä¸€æ¬¡æ‰èƒ½å¾—åˆ°å…¶é•¿åº¦ï¼Œå¾—åˆ°æ€»é•¿åº¦ä¹‹åæˆ‘ä»¬å°±çŸ¥é“å…¶ä¸­é—´ä½ç½®æ˜¯ç¬¬å‡ ä¸ªï¼Œå†æ¬¡è¿›è¡Œéå†å³å¯å¾—åˆ°ã€‚è¿™ç§æš´åŠ›è§£æ³•æ—¶é—´å¤æ‚åº¦æ˜¯ï¼š<code>O(n) + O(2/n)</code>ã€‚</p><p>ä¸‹é¢ä»‹ç»ä¸€ç§æ—¶é—´å¤æ‚åº¦æ›´ä½çš„è§£æ³•ï¼šå¿«æ…¢æŒ‡é’ˆæ³•ã€‚</p><p>å®šä¹‰ä¸€å¿«ä¸€æ…¢ä¸¤ä¸ªæŒ‡é’ˆï¼š<code>fast</code>å’Œ<code>slow</code>ï¼Œä¸¤ä¸ªæŒ‡é’ˆåŒæ—¶èµ°ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡èµ°ä¸€æ­¥ï¼Œå½“å¿«æŒ‡é’ˆèµ°åˆ°é“¾è¡¨æœ«å°¾çš„æ—¶å€™ï¼Œæ…¢æŒ‡é’ˆå°±æ°å¥½åœ¨é“¾è¡¨ä¸­é—´ä½ç½®ï¼Œå³æˆ‘ä»¬éœ€è¦çš„ä¸­é—´èŠ‚ç‚¹ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹å¿«æ…¢æŒ‡é’ˆçš„<code>Java</code>è¯­è¨€å®ç°ï¼š</p><blockquote><p>å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼š<a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SinglyLinkedListNode <span class="title">middleNode</span><span class="params">(SinglyLinkedListNode head)</span> </span>&#123;</span><br><span class="line">    SinglyLinkedListNode fast = head;</span><br><span class="line">    SinglyLinkedListNode slow = head;</span><br><span class="line">    <span class="keyword">while</span> (fast.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        fast = fast.next.next;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> slow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-ä½¿ç”¨éé€’å½’æ³•å®ç°å•é“¾è¡¨çš„åè½¬</title>
      <link href="2020/12/12/algorithm/base/datastructure/non-recursive-reverse-link/"/>
      <url>2020/12/12/algorithm/base/datastructure/non-recursive-reverse-link/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šä½¿ç”¨éé€’å½’æ³•å®ç°å•é“¾è¡¨çš„åè½¬</p><p>ç¤ºä¾‹ï¼šå•é“¾è¡¨ï¼š<code>1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; null</code>ï¼Œåè½¬ä¹‹åçš„ç»“æœä¸ºï¼š<code>5 -&gt; 4 -&gt; 3 -&gt; 2 -&gt; 1 -&gt; null</code>ã€‚</p><p>ä¹‹å‰å·²ç»å†™è¿‡ä¸€ç¯‡æ–‡ç« ä½¿ç”¨é€’å½’æ³•æ¥å®ç°ï¼Œå¯æŸ¥çœ‹ï¼š<a href="https://lilu.org.cn/2020/06/04/algorithm/base/recursive-reverse-link/">å‹‡é—¯ç®—æ³•-é€’å½’æ³•æ‹¿ä¸‹åè½¬é“¾è¡¨çš„ä¸‰æ€</a></p><p>ç°åœ¨æˆ‘ä»¬ä½¿ç”¨éé€’å½’æ³•æ¥è¿›è¡Œå®ç°ã€‚</p><p>æ€è·¯ï¼šç”±äºå•é“¾è¡¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬åªèƒ½ä»å‰å¾€åä¾æ¬¡éå†å„ä¸ªé“¾è¡¨èŠ‚ç‚¹ï¼Œå¯¹äºç¤ºä¾‹ä¸­çš„å•é“¾è¡¨ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥å°†<code>1</code>å’Œ<code>2</code>è¿›è¡Œåè½¬ï¼Œå°†<code>2</code>æŒ‡å‘<code>1</code>ï¼Œæˆ‘ä»¬ä¼šå‘ç°<code>2</code>åé¢çš„èŠ‚ç‚¹å·²ç»æ— æ³•è®¿é—®åˆ°äº†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æå‰å°†<code>2</code>åé¢çš„<code>3</code>è®°å½•ä¸‹æ¥ï¼Œç„¶åå†å°†<code>2</code>æŒ‡å‘<code>1</code>ï¼Œç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬æå‰å°†<code>3</code>åé¢çš„<code>4</code>è®°å½•ä¸‹æ¥ï¼Œå†å°†<code>3</code>æŒ‡å‘<code>2</code>â€¦ç›´è‡³åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚</p><p>å®šä¹‰ä¸‰ä¸ªæŒ‡é’ˆå˜é‡ï¼š<code>pre</code>ã€<code>current</code>ã€<code>next</code>ã€‚</p><p>åˆå§‹çŠ¶æ€ï¼š<code>pre = null,current = 1,next = null</code>ã€‚</p><p>åè½¬è¿‡ç¨‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">next = current.next;</span><br><span class="line">current.next = pre;</span><br></pre></td></tr></table></figure><p>æŒ‡é’ˆå³ç§»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pre = current;</span><br><span class="line">current = next;</span><br></pre></td></tr></table></figure><p>ç»ˆæ­¢æ¡ä»¶ï¼š<code>current.next == null</code>ã€‚</p><p><code>Java</code>è¯­è¨€å®Œæ•´å®ç°ï¼š</p><blockquote><p>å•é“¾è¡¨èŠ‚ç‚¹ç±»å®šä¹‰å¯æŸ¥çœ‹æ–‡ç« ï¼š<a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SinglyLinkedListNode <span class="title">reverse</span><span class="params">(SinglyLinkedListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸‰ä¸ªæŒ‡é’ˆï¼špreã€currentã€next</span></span><br><span class="line">    SinglyLinkedListNode pre = <span class="keyword">null</span>;</span><br><span class="line">    SinglyLinkedListNode current = head;</span><br><span class="line">    SinglyLinkedListNode next = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (current.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// è®°å½•currentçš„next</span></span><br><span class="line">        next = current.next;</span><br><span class="line">        <span class="comment">// currentåè½¬</span></span><br><span class="line">        current.next = pre;</span><br><span class="line">        <span class="comment">// preå³ç§»</span></span><br><span class="line">        pre = current;</span><br><span class="line">        <span class="comment">// currentå³ç§»</span></span><br><span class="line">        current = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> current;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache Mavenå¿…çŸ¥å¿…ä¼š</title>
      <link href="2020/12/11/javaee/maven/maven-must-know-and-know/"/>
      <url>2020/12/11/javaee/maven/maven-must-know-and-know/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨æ²¡æœ‰ä½¿ç”¨<code>Maven</code>ä¹‹å‰ï¼Œæˆ‘ä»¬å¼€å‘ä¸€ä¸ª<code>JavaWeb</code>é¡¹ç›®ï¼Œå¦‚æœä½¿ç”¨åˆ°é<code>JDK</code>æä¾›çš„ç±»åº“ï¼Œéœ€è¦å»ç½‘ä¸Šä¸‹è½½å¯¹åº”çš„<code>jar</code>åŒ…ï¼Œç„¶åå°†<code>jar</code>åŒ…å¤åˆ¶ç²˜è´´æ”¾åˆ°é¡¹ç›®çš„<code>lib</code>ç›®å½•ä¸‹æ‰èƒ½å¤Ÿä½¿ç”¨ã€‚è¿™æ ·çš„åšæ³•æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œæ¯å¼€å‘ä¸€ä¸ª<code>JavaWeb</code>é¡¹ç›®éƒ½éœ€è¦å»å°†<code>jar</code>åŒ…æ–‡ä»¶æ”¾ç½®åœ¨<code>lib</code>ç›®å½•ä¸‹ï¼Œä¸”åªèƒ½ä»¥æ–‡ä»¶çš„å½¢å¼è¿›è¡Œç®¡ç†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Maven</code>çš„ä¾èµ–ç®¡ç†åŠŸèƒ½æ¥å‡å°‘å¤åˆ¶<code>jar</code>åŒ…è¿™æ ·é‡å¤çš„å·¥ä½œã€‚</p><h2 id="ä»€ä¹ˆæ˜¯Mavenï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Mavenï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Mavenï¼Ÿ"></a>ä»€ä¹ˆæ˜¯<code>Maven</code>ï¼Ÿ</h2><p><code>Maven</code>æ˜¯ä¸€ä¸ªé¡¹ç›®ç®¡ç†å·¥å…·ï¼Œå¯ä»¥å¯¹é¡¹ç›®ï¼ˆä¸ä»…é™äº<code>Java</code>è¯­è¨€ï¼‰è¿›è¡Œæ„å»ºå’Œä¾èµ–ç®¡ç†ã€‚ç®€å•æ¥è¯´ï¼šä½¿ç”¨äº†<code>Maven</code>ä¹‹åæˆ‘ä»¬å°±ä¸éœ€è¦å†å»ä¸‹è½½å¤åˆ¶ç²˜è´´<code>jar</code>åŒ…äº†ã€‚</p><h2 id="Mavenå®‰è£…"><a href="#Mavenå®‰è£…" class="headerlink" title="Mavenå®‰è£…"></a><code>Maven</code>å®‰è£…</h2><p><a href="https://lilu.org.cn/2020/02/07/installed/install-maven/">Windows 10ä¸‹Mavençš„å®‰è£…åŠé…ç½®</a></p><h2 id="Mavençš„çº¦å®šé…ç½®"><a href="#Mavençš„çº¦å®šé…ç½®" class="headerlink" title="Mavençš„çº¦å®šé…ç½®"></a><code>Maven</code>çš„çº¦å®šé…ç½®</h2><p><code>Maven</code>æä¾›çº¦å®šä¼˜äºé…ç½®çš„åŸåˆ™ï¼Œå¯¹äºä¸€ä¸ªä½¿ç”¨<code>Maven</code>æ„å»ºå’Œä¾èµ–ç®¡ç†çš„é¡¹ç›®ï¼Œåº”è¯¥éµå¾ªä»¥ä¸‹çš„ç›®å½•ç»“æ„ï¼š</p><table><thead><tr><th>ç›®å½•</th><th>ç›®å½•å­˜æ”¾å†…å®¹</th></tr></thead><tbody><tr><td><code>$&#123;basedir&#125;</code></td><td><code>Maven</code>é¡¹ç›®æ ¹è·¯å¾„ï¼Œå­˜æ”¾<code>pom.xml</code>å’Œæ‰€æœ‰çš„å­ç›®å½•</td></tr><tr><td><code>$&#123;basedir&#125;/src/main/java</code></td><td>é¡¹ç›®çš„<code>java</code>ç±»æ–‡ä»¶</td></tr><tr><td><code>$&#123;basedir&#125;/src/main/resources</code></td><td>é¡¹ç›®çš„èµ„æºæ–‡ä»¶ï¼Œä¾‹å¦‚<code>properties</code>é…ç½®æ–‡ä»¶ï¼Œå‰ç«¯é™æ€èµ„æºæ–‡ä»¶ç­‰</td></tr><tr><td><code>$&#123;basedir&#125;/src/test/java</code></td><td>é¡¹ç›®çš„å•å…ƒæµ‹è¯•ç±»æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸º<code>Junit</code>çš„å•å…ƒæµ‹è¯•ç±»</td></tr><tr><td><code>$&#123;basedir&#125;/src/test/resources</code></td><td>æä¾›ç»™æµ‹è¯•ç±»ä½¿ç”¨çš„èµ„æºæ–‡ä»¶</td></tr><tr><td><code>$&#123;basedir&#125;/src/main/webapp/WEB-INF</code></td><td><code>JavaWeb</code>é¡¹ç›®çš„<code>web</code>åº”ç”¨æ–‡ä»¶ç›®å½•ï¼Œå­˜æ”¾<code>web.xml</code>ã€<code>.jsp</code>å’Œå‰ç«¯é™æ€èµ„æºç­‰æ–‡ä»¶ã€‚</td></tr><tr><td><code>$&#123;basedir&#125;/target</code></td><td>æ‰“åŒ…è¾“å‡ºç›®å½•</td></tr><tr><td><code>$&#123;basedir&#125;/target/classes</code></td><td>ç¼–è¯‘è¾“å‡ºç›®å½•ï¼Œ<code>java</code>ç±»ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ç›®å½•</td></tr><tr><td><code>$&#123;basedir&#125;/target/test-classes</code></td><td>æµ‹è¯•ç±»ç¼–è¯‘è¾“å‡ºç›®å½•</td></tr><tr><td><code>XXXTest.java</code></td><td><code>Maven</code>åªä¼šè‡ªåŠ¨è¿è¡Œç±»åä»¥<code>Test</code>ç»“å°¾çš„æµ‹è¯•ç±»</td></tr><tr><td><code>~/.m2/repository</code></td><td><code>Maven</code>çš„é»˜è®¤æœ¬åœ°ä»“åº“è·¯å¾„</td></tr></tbody></table><h2 id="pom-xmlå¸¸ç”¨æ ‡ç­¾"><a href="#pom-xmlå¸¸ç”¨æ ‡ç­¾" class="headerlink" title="pom.xmlå¸¸ç”¨æ ‡ç­¾"></a><code>pom.xml</code>å¸¸ç”¨æ ‡ç­¾</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹<code>Spring Boot</code>é¡¹ç›®çš„<code>pom.xml</code>æ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å£°æ˜é¡¹ç›®æè¿°ç¬¦éµå¾ªå“ªä¸€ä¸ªPOMæ¨¡å‹ç‰ˆæœ¬ã€‚æ¨¡å‹æœ¬èº«çš„ç‰ˆæœ¬å¾ˆå°‘æ”¹å˜ï¼Œè™½ç„¶å¦‚æ­¤ï¼Œä½†å®ƒä»ç„¶æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œè¿™æ˜¯ä¸ºäº†å½“Mavenå¼•å…¥äº†æ–°çš„ç‰¹æ€§æˆ–è€…å…¶ä»–æ¨¡å‹å˜æ›´çš„æ—¶å€™ï¼Œç¡®ä¿ç¨³å®šæ€§ã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- çˆ¶é¡¹ç›®çš„åæ ‡ã€‚å¦‚æœé¡¹ç›®ä¸­æ²¡æœ‰è§„å®šæŸä¸ªå…ƒç´ çš„å€¼ï¼Œé‚£ä¹ˆçˆ¶é¡¹ç›®ä¸­çš„å¯¹åº”å€¼å³ä¸ºé¡¹ç›®çš„é»˜è®¤å€¼ï¼ˆç»§æ‰¿ï¼‰ã€‚ åæ ‡åŒ…æ‹¬group IDï¼Œartifact IDå’Œversionã€‚--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- çˆ¶é¡¹ç›®çš„å”¯ä¸€ç»„ç»‡å --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- çˆ¶é¡¹ç›®çš„å”¯ä¸€æ„å»ºæ ‡è¯†ç¬¦ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- çˆ¶é¡¹ç›®çš„ç‰ˆæœ¬å· --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- çˆ¶é¡¹ç›®çš„pom.xmlæ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚ç›¸å¯¹è·¯å¾„å…è®¸ä½ é€‰æ‹©ä¸€ä¸ªä¸åŒçš„è·¯å¾„ã€‚é»˜è®¤å€¼æ˜¯../pom.xmlã€‚Mavené¦–å…ˆåœ¨æ„å»ºå½“å‰é¡¹ç›®çš„åœ°æ–¹å¯»æ‰¾çˆ¶é¡¹ç›®çš„pomï¼Œå…¶æ¬¡åœ¨æ–‡ä»¶ç³»ç»Ÿçš„è¿™ä¸ªä½ç½®ï¼ˆrelativePathä½ç½®ï¼‰ï¼Œç„¶ååœ¨æœ¬åœ°ä»“åº“ï¼Œæœ€ååœ¨è¿œç¨‹ä»“åº“å¯»æ‰¾çˆ¶é¡¹ç›®çš„pomã€‚ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å½“å‰é¡¹ç›®çš„å”¯ä¸€ç»„ç»‡å --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sunchaser.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å½“å‰é¡¹ç›®çš„å”¯ä¸€æ„å»ºæ ‡è¯†ç¬¦ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å½“å‰é¡¹ç›®çš„ç‰ˆæœ¬å·ï¼Œæ ¼å¼ä¸º:ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.å¢é‡ç‰ˆæœ¬-é™å®šç‰ˆæœ¬å· --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å½“å‰é¡¹ç›®çš„åç§° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å½“å‰é¡¹ç›®çš„æè¿°ç®€ä»‹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ä»¥å€¼ï¼ˆvalueï¼‰ä»£æ›¿åç§°ï¼ˆnameï¼‰ï¼Œå¯åœ¨æ•´ä¸ªpom.xmlä¸­ä½¿ç”¨ï¼Œæ ¼å¼ï¼š&lt;name&gt;value&lt;name/&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å‘ç°ä¾èµ–å’Œæ‰©å±•çš„è¿œç¨‹ä»“åº“åˆ—è¡¨ã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åŒ…å«éœ€è¦è¿æ¥åˆ°è¿œç¨‹ä»“åº“çš„ä¿¡æ¯ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- å¦‚ä½•å¤„ç†è¿œç¨‹ä»“åº“é‡Œå‘å¸ƒç‰ˆæœ¬çš„ä¸‹è½½ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- trueæˆ–è€…falseè¡¨ç¤ºè¯¥ä»“åº“æ˜¯å¦ä¸ºä¸‹è½½æŸç§ç±»å‹æ„ä»¶ï¼ˆå‘å¸ƒç‰ˆï¼Œå¿«ç…§ç‰ˆï¼‰å¼€å¯ã€‚ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span> /&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- è¯¥å…ƒç´ æŒ‡å®šæ›´æ–°å‘ç”Ÿçš„é¢‘ç‡ã€‚Mavenä¼šæ¯”è¾ƒæœ¬åœ°POMå’Œè¿œç¨‹POMçš„æ—¶é—´æˆ³ã€‚è¿™é‡Œçš„é€‰é¡¹æ˜¯ï¼šalwaysï¼ˆä¸€ç›´ï¼‰ï¼Œdailyï¼ˆé»˜è®¤ï¼Œæ¯æ—¥ï¼‰ï¼Œintervalï¼šXï¼ˆè¿™é‡ŒXæ˜¯ä»¥åˆ†é’Ÿä¸ºå•ä½çš„æ—¶é—´é—´éš”ï¼‰ï¼Œæˆ–è€…neverï¼ˆä»ä¸ï¼‰ã€‚ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">updatePolicy</span> /&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- å½“MavenéªŒè¯æ„ä»¶æ ¡éªŒæ–‡ä»¶å¤±è´¥æ—¶è¯¥æ€ä¹ˆåšï¼šignoreï¼ˆå¿½ç•¥ï¼‰ï¼Œfailï¼ˆå¤±è´¥ï¼‰ï¼Œæˆ–è€…warnï¼ˆè­¦å‘Šï¼‰ã€‚ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">checksumPolicy</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- å¦‚ä½•å¤„ç†è¿œç¨‹ä»“åº“é‡Œå¿«ç…§ç‰ˆæœ¬çš„ä¸‹è½½ã€‚æœ‰äº†releaseså’Œsnapshotsè¿™ä¸¤ç»„é…ç½®ï¼ŒPOMå°±å¯ä»¥åœ¨æ¯ä¸ªå•ç‹¬çš„ä»“åº“ä¸­ï¼Œä¸ºæ¯ç§ç±»å‹çš„æ„ä»¶é‡‡å–ä¸åŒçš„ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œå¯èƒ½æœ‰äººä¼šå†³å®šåªä¸ºå¼€å‘ç›®çš„å¼€å¯å¯¹å¿«ç…§ç‰ˆæœ¬ä¸‹è½½çš„æ”¯æŒã€‚å‚è§repositories/repository/releaseså…ƒç´  --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">enabled</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">updatePolicy</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">checksumPolicy</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--è¿œç¨‹ä»“åº“å”¯ä¸€æ ‡è¯†ç¬¦ã€‚å¯ä»¥ç”¨æ¥åŒ¹é…åœ¨settings.xmlæ–‡ä»¶é‡Œé…ç½®çš„è¿œç¨‹ä»“åº“ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--è¿œç¨‹ä»“åº“åç§° --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--è¿œç¨‹ä»“åº“URLï¼ŒæŒ‰protocol://hostname/pathå½¢å¼ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/repositories/central/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- ç”¨äºå®šä½å’Œæ’åºæ„ä»¶çš„ä»“åº“å¸ƒå±€ç±»å‹-å¯ä»¥æ˜¯defaultï¼ˆé»˜è®¤ï¼‰æˆ–è€…legacyï¼ˆé—ç•™ï¼‰ã€‚Maven2ä¸ºå…¶ä»“åº“æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„å¸ƒå±€ï¼›ç„¶è€Œï¼ŒMaven 1.xæœ‰ä¸€ç§ä¸åŒçš„å¸ƒå±€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥å…ƒç´ æŒ‡å®šå¸ƒå±€æ˜¯defaultï¼ˆé»˜è®¤ï¼‰è¿˜æ˜¯legacyï¼ˆé—ç•™ï¼‰ã€‚ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">layout</span>&gt;</span>default<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- è¯¥å…ƒç´ æè¿°äº†é¡¹ç›®ç›¸å…³çš„æ‰€æœ‰ä¾èµ–ã€‚è¿™äº›ä¾èµ–ç»„æˆäº†é¡¹ç›®æ„å»ºè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªä¸ªç¯èŠ‚ã€‚å®ƒä»¬è‡ªåŠ¨ä»é¡¹ç›®å®šä¹‰çš„ä»“åº“ä¸­ä¸‹è½½ã€‚è¦è·å–æ›´å¤šä¿¡æ¯ï¼Œè¯·çœ‹é¡¹ç›®ä¾èµ–æœºåˆ¶ã€‚ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ç”±äºparentçš„å­˜åœ¨ï¼Œä»¥ä¸‹ä¾èµ–ç»§æ‰¿äº†parentä¸­ç”³æ˜çš„ç‰ˆæœ¬å· --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- å¯é€‰ä¾èµ–ï¼Œå¦‚æœä½ åœ¨é¡¹ç›®Bä¸­æŠŠCä¾èµ–å£°æ˜ä¸ºå¯é€‰ï¼Œä½ å°±éœ€è¦åœ¨ä¾èµ–äºBçš„é¡¹ç›®ï¼ˆä¾‹å¦‚é¡¹ç›®Aï¼‰ä¸­æ˜¾å¼çš„å¼•ç”¨å¯¹Cçš„ä¾èµ–ã€‚å¯é€‰ä¾èµ–é˜»æ–­ä¾èµ–çš„ä¼ é€’æ€§ã€‚ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- ä¾èµ–èŒƒå›´ã€‚åœ¨é¡¹ç›®å‘å¸ƒè¿‡ç¨‹ä¸­ï¼Œå¸®åŠ©å†³å®šå“ªäº›æ„ä»¶è¢«åŒ…æ‹¬è¿›æ¥ã€‚æ¬²çŸ¥è¯¦æƒ…è¯·å‚è€ƒä¾èµ–æœºåˆ¶ã€‚</span></span><br><span class="line"><span class="comment">                - compile ï¼šé»˜è®¤èŒƒå›´ï¼Œç”¨äºç¼–è¯‘</span></span><br><span class="line"><span class="comment">                - providedï¼šç±»ä¼¼äºç¼–è¯‘ï¼Œä½†æ”¯æŒä½ æœŸå¾…jdkæˆ–è€…å®¹å™¨æä¾›ï¼Œç±»ä¼¼äºclasspath </span></span><br><span class="line"><span class="comment">                - runtime: åœ¨æ‰§è¡Œæ—¶éœ€è¦ä½¿ç”¨</span></span><br><span class="line"><span class="comment">                - test: ç”¨äºtestä»»åŠ¡æ—¶ä½¿ç”¨</span></span><br><span class="line"><span class="comment">                - system: éœ€è¦å¤–åœ¨æä¾›ç›¸åº”çš„å…ƒç´ ã€‚é€šè¿‡systemPathæ¥å–å¾— </span></span><br><span class="line"><span class="comment">                - systemPath: ä»…ç”¨äºèŒƒå›´ä¸ºsystemã€‚æä¾›ç›¸åº”çš„è·¯å¾„</span></span><br><span class="line"><span class="comment">                - optional: å½“é¡¹ç›®è‡ªèº«è¢«ä¾èµ–æ—¶ï¼Œæ ‡æ³¨ä¾èµ–æ˜¯å¦ä¼ é€’ã€‚ç”¨äºè¿ç»­ä¾èµ–æ—¶ä½¿ç”¨</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ„å»ºé¡¹ç›®éœ€è¦çš„ä¿¡æ¯ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ä½¿ç”¨çš„æ’ä»¶åˆ—è¡¨ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯å°†<code>Spring Boot</code>ä½œä¸º<code>parent</code>çš„<code>pom.xml</code>ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯<code>parent</code>å¯ä»¥èšåˆä¾èµ–çš„ç‰ˆæœ¬ç­‰ä¸€äº›ä¿¡æ¯ï¼Œåœ¨åé¢æ·»åŠ ä¾èµ–æ—¶åªéœ€è¦å¡«å†™<code>groupId</code>å’Œ<code>artifactId</code>åæ ‡ï¼Œç‰ˆæœ¬å·é»˜è®¤ç»§æ‰¿<code>parent</code>ä¸­å®šä¹‰çš„ç‰ˆæœ¬å·ã€‚ä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„é¡¹ç›®æ˜¯<code>Maven</code>å¤šæ¨¡å—é¡¹ç›®ï¼Œæˆ–è€…ç”±äºä¸€äº›å…¶å®ƒåŸå› å¯¼è‡´æˆ‘ä»¬æ— æ³•ä½¿ç”¨<code>Spring Boot</code>ä½œä¸º<code>parent</code>ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°<code>dependencyManagement</code>æ ‡ç­¾æ¥è¿›è¡Œä¾èµ–é¢„å®šä¹‰äº†ï¼Œ<code>Spring Boot</code>æä¾›äº†<code>BOM</code>ç”¨æ¥è¿›è¡Œé¢„å®šä¹‰ä¾èµ–çš„å¼•å…¥ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sunchaser.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é¢„å®šä¹‰ä¾èµ–å¼•å…¥ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Mavençš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Mavençš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Mavençš„ç”Ÿå‘½å‘¨æœŸ"></a><code>Maven</code>çš„ç”Ÿå‘½å‘¨æœŸ</h2><p><code>Maven</code>æœ‰ä¸‰ä¸ªæ ‡å‡†çš„ç”Ÿå‘½å‘¨æœŸï¼š</p><ul><li><code>clean</code>ï¼šé¡¹ç›®æ¸…ç†çš„å¤„ç†ã€‚</li><li><code>default(build)</code>ï¼šé¡¹ç›®éƒ¨ç½²çš„å¤„ç†ã€‚</li><li><code>site</code>ï¼šé¡¹ç›®ç«™ç‚¹æ–‡æ¡£åˆ›å»ºçš„å¤„ç†ã€‚</li></ul><h3 id="Cleanç”Ÿå‘½å‘¨æœŸ"><a href="#Cleanç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Cleanç”Ÿå‘½å‘¨æœŸ"></a><code>Clean</code>ç”Ÿå‘½å‘¨æœŸ</h3><p>åŒ…å«ä»¥ä¸‹é˜¶æ®µï¼š</p><ul><li><code>pre-clean</code>ï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨<code>clean</code>ä¹‹å‰å®Œæˆçš„å·¥ä½œã€‚</li><li><code>clean</code>ï¼šç§»é™¤æ‰€æœ‰ä¸Šä¸€æ¬¡æ„å»ºç”Ÿæˆçš„æ–‡ä»¶ã€‚</li><li><code>post-clean</code>ï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨<code>clean</code>ä¹‹åç«‹å³å®Œæˆçš„å·¥ä½œã€‚</li></ul><p>æˆ‘ä»¬æ‰€ç”¨çš„<code>mvn clean</code>å‘½ä»¤å°±æ˜¯ä¸Šé¢çš„<code>clean</code>é˜¶æ®µã€‚åœ¨ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œè¿è¡ŒæŸä¸ªé˜¶æ®µçš„æ—¶å€™ï¼Œåœ¨å®ƒä¹‹å‰çš„æ‰€æœ‰é˜¶æ®µéƒ½ä¼šè¢«è¿è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ‰§è¡Œ<code>maven clean</code>å‘½ä»¤å°†è¿è¡Œ<code>pre-clean</code>å’Œ<code>clean</code>è¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸé˜¶æ®µã€‚</p><h3 id="Default-build-ç”Ÿå‘½å‘¨æœŸ"><a href="#Default-build-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Default(build)ç”Ÿå‘½å‘¨æœŸ"></a><code>Default(build)</code>ç”Ÿå‘½å‘¨æœŸ</h3><p>åŒ…å«ä»¥ä¸‹<code>23</code>ä¸ªé˜¶æ®µï¼š</p><ul><li><code>validate</code>æ ¡éªŒï¼šæ ¡éªŒé¡¹ç›®æ˜¯å¦æ­£ç¡®å¹¶ä¸”æ‰€æœ‰å¿…è¦çš„ä¿¡æ¯å¯ä»¥å®Œæˆé¡¹ç›®çš„æ„å»ºè¿‡ç¨‹ã€‚</li><li><code>initialize</code>åˆå§‹åŒ–ï¼šåˆå§‹åŒ–æ„å»ºé˜¶æ®µï¼Œæ¯”å¦‚è®¾ç½®å±æ€§å€¼ã€‚</li><li><code>generate-sources</code>ç”Ÿæˆæºä»£ç ï¼šç”ŸæˆåŒ…å«åœ¨ç¼–è¯‘é˜¶æ®µä¸­çš„ä»»ä½•æºä»£ç ã€‚</li><li><code>process-sources</code>å¤„ç†æºä»£ç ï¼šå¤„ç†æºä»£ç ï¼Œæ¯”å¦‚è¿‡æ»¤ä»»æ„å€¼ã€‚</li><li><code>generate-resources</code>ç”Ÿæˆèµ„æºæ–‡ä»¶ï¼šç”Ÿæˆå°†ä¼šåŒ…å«åœ¨é¡¹ç›®åŒ…ä¸­çš„èµ„æºæ–‡ä»¶ã€‚</li><li><code>process-resources</code>å¤„ç†èµ„æºæ–‡ä»¶ï¼šå¤åˆ¶å’Œå¤„ç†èµ„æºåˆ°ç›®æ ‡ç›®å½•ï¼Œä¸ºæ‰“åŒ…é˜¶æ®µåšå¥½å‡†å¤‡ã€‚</li><li><code>compile</code>ç¼–è¯‘ï¼šç¼–è¯‘é¡¹ç›®çš„æºä»£ç ã€‚</li><li><code>process-classes</code>å¤„ç†ç±»æ–‡ä»¶ï¼šå¤„ç†ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ¯”å¦‚è¯´å¯¹<code>Java class</code>æ–‡ä»¶åšå­—èŠ‚ç æ”¹å–„ä¼˜åŒ–ã€‚</li><li><code>generate-test-sources</code>ç”Ÿæˆæµ‹è¯•æºä»£ç ï¼šç”ŸæˆåŒ…å«åœ¨ç¼–è¯‘é˜¶æ®µä¸­çš„ä»»ä½•æµ‹è¯•æºä»£ç ã€‚</li><li><code>process-test-sources</code>å¤„ç†æµ‹è¯•æºä»£ç ï¼šå¤„ç†æµ‹è¯•æºä»£ç ï¼Œæ¯”å¦‚è¯´ï¼Œè¿‡æ»¤ä»»æ„å€¼ã€‚</li><li><code>generate-test-resources</code>ç”Ÿæˆæµ‹è¯•èµ„æºæ–‡ä»¶ï¼šä¸ºæµ‹è¯•åˆ›å»ºèµ„æºæ–‡ä»¶ã€‚</li><li><code>process-test-resources</code>å¤„ç†æµ‹è¯•èµ„æºæ–‡ä»¶ï¼šå¤åˆ¶å’Œå¤„ç†æµ‹è¯•èµ„æºåˆ°ç›®æ ‡ç›®å½•ã€‚</li><li><code>test-compile</code>ç¼–è¯‘æµ‹è¯•æºç ï¼šç¼–è¯‘æµ‹è¯•æºä»£ç åˆ°æµ‹è¯•ç›®æ ‡ç›®å½•ã€‚</li><li><code>process-test-class</code>å¤„ç†æµ‹è¯•ç±»æ–‡ä»¶ï¼šå¤„ç†æµ‹è¯•æºç ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ã€‚</li><li><code>test</code>æµ‹è¯•ï¼šä½¿ç”¨åˆé€‚çš„å•å…ƒæµ‹è¯•æ¡†æ¶è¿è¡Œæµ‹è¯•ï¼ˆ<code>Junit</code>æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼‰ã€‚</li><li><code>prepare-package</code>å‡†å¤‡æ‰“åŒ…ï¼šåœ¨å®é™…æ‰“åŒ…ä¹‹å‰ï¼Œæ‰§è¡Œä»»ä½•çš„å¿…è¦çš„æ“ä½œä¸ºæ‰“åŒ…åšå‡†å¤‡ã€‚</li><li><code>package</code>æ‰“åŒ…ï¼šå°†ç¼–è¯‘åçš„ä»£ç æ‰“åŒ…æˆå¯åˆ†å‘æ ¼å¼çš„æ–‡ä»¶ï¼Œæ¯”å¦‚<code>JAR</code>ã€<code>WAR</code>æˆ–è€…<code>EAR</code>æ–‡ä»¶ã€‚</li><li><code>pre-integration-test</code>é›†æˆæµ‹è¯•å‰ï¼šåœ¨æ‰§è¡Œé›†æˆæµ‹è¯•å‰è¿›è¡Œå¿…è¦çš„åŠ¨ä½œã€‚æ¯”å¦‚è¯´ï¼Œæ­å»ºéœ€è¦çš„ç¯å¢ƒã€‚</li><li><code>integration-test</code>é›†æˆæµ‹è¯•ï¼šå¤„ç†å’Œéƒ¨ç½²é¡¹ç›®åˆ°å¯ä»¥è¿è¡Œé›†æˆæµ‹è¯•ç¯å¢ƒä¸­ã€‚</li><li><code>post-integration-test</code>é›†æˆæµ‹è¯•åï¼šåœ¨æ‰§è¡Œé›†æˆæµ‹è¯•å®Œæˆåè¿›è¡Œå¿…è¦çš„åŠ¨ä½œã€‚æ¯”å¦‚è¯´ï¼Œæ¸…ç†é›†æˆæµ‹è¯•ç¯å¢ƒã€‚</li><li><code>verify</code>éªŒè¯ï¼šè¿è¡Œä»»æ„çš„æ£€æŸ¥æ¥éªŒè¯é¡¹ç›®åŒ…æœ‰æ•ˆä¸”è¾¾åˆ°è´¨é‡æ ‡å‡†ã€‚</li><li><code>install</code>å®‰è£…ï¼šå®‰è£…é¡¹ç›®åŒ…åˆ°æœ¬åœ°ä»“åº“ï¼Œè¿™æ ·é¡¹ç›®åŒ…å¯ä»¥ç”¨ä½œå…¶ä»–æœ¬åœ°é¡¹ç›®çš„ä¾èµ–ã€‚</li><li><code>deploy</code>éƒ¨ç½²ï¼šå°†æœ€ç»ˆçš„é¡¹ç›®åŒ…å‘å¸ƒåˆ°è¿œç¨‹ä»“åº“ä¸­ä¸å…¶ä»–å¼€å‘è€…å’Œé¡¹ç›®å…±äº«ã€‚</li></ul><p>æˆ‘ä»¬å¸¸ç”¨çš„<code>mvn install</code>å‘½ä»¤ï¼Œåœ¨æ‰§è¡Œ<code>install</code>ä¹‹å‰ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œäº†ä¹‹å‰çš„<code>21</code>ä¸ªé˜¶æ®µã€‚å¦‚æœç”¨äºå¤šæ¨¡å—é¡¹ç›®ï¼Œæ¯ä¸€ä¸ªå­é¡¹ç›®éƒ½ä¼šæ‰§è¡Œ<code>mvn install</code>å‘½ä»¤ã€‚</p><p>è¿˜å¯ä»¥ä¸€æ¬¡æŒ‡å®šä¸¤ä¸ªé˜¶æ®µï¼Œä¾‹å¦‚<code>mvn clean deploy</code>ï¼Œè¿™å¯ä»¥ç”¨æ¥çº¯å‡€çš„æ„å»ºå’Œéƒ¨ç½²é¡¹ç›®åˆ°è¿œç¨‹ä»“åº“ä¸­ã€‚<code>Maven</code>ä¼šå…ˆæ‰§è¡Œ<code>clean</code>å‘½ä»¤ï¼Œå†æ‰§è¡Œ<code>deploy</code>å‘½ä»¤ï¼Œå¯¹å¤šæ¨¡å—é¡¹ç›®ä¹Ÿé€‚ç”¨ã€‚</p><h3 id="Siteç”Ÿå‘½å‘¨æœŸ"><a href="#Siteç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Siteç”Ÿå‘½å‘¨æœŸ"></a><code>Site</code>ç”Ÿå‘½å‘¨æœŸ</h3><p><code>Maven Site</code>æ’ä»¶ä¸€èˆ¬ç”¨æ¥åˆ›å»ºæ–°çš„æŠ¥å‘Šæ–‡æ¡£å’Œéƒ¨ç½²ç«™ç‚¹ç­‰ã€‚è¿™ä¸ªåœ¨æˆ‘ä»¬çš„å¼€å‘å·¥ä½œä¸­ä¸€èˆ¬ä¸ä¼šç”¨åˆ°ï¼Œäº†è§£å³å¯ã€‚</p><p>åŒ…å«ä»¥ä¸‹<code>4</code>ä¸ªé˜¶æ®µï¼š</p><ul><li><code>pre-site</code>ï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨ç”Ÿæˆç«™ç‚¹æ–‡æ¡£ä¹‹å‰å®Œæˆçš„å·¥ä½œã€‚</li><li><code>site</code>ï¼šç”Ÿæˆé¡¹ç›®çš„ç«™ç‚¹æ–‡æ¡£ã€‚</li><li><code>post-site</code>ï¼šæ‰§è¡Œä¸€äº›éœ€è¦åœ¨ç”Ÿæˆç«™ç‚¹æ–‡æ¡£ä¹‹åå®Œæˆçš„å·¥ä½œï¼Œå¹¶ä¸”ä¸ºéƒ¨ç½²åšå‡†å¤‡ã€‚</li><li><code>site-deploy</code>ï¼šå°†ç”Ÿæˆçš„ç«™ç‚¹æ–‡æ¡£éƒ¨ç½²åˆ°ç‰¹å®šçš„æœåŠ¡å™¨ä¸Šã€‚</li></ul><h2 id="Mavenä»“åº“"><a href="#Mavenä»“åº“" class="headerlink" title="Mavenä»“åº“"></a><code>Maven</code>ä»“åº“</h2><p><code>Maven</code>ä»“åº“ç®€å•çš„ç†è§£å°±æ˜¯å­˜å‚¨<code>JAR</code>åŒ…çš„åœ°æ–¹ã€‚æœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹ï¼š</p><ul><li>æœ¬åœ°ä»“åº“ï¼ˆ<code>local</code>ï¼‰</li><li>ä¸­å¤®ä»“åº“ï¼ˆ<code>central</code>ï¼‰</li><li>è¿œç¨‹ä»“åº“ï¼ˆ<code>remote</code>ï¼‰</li></ul><h3 id="æœ¬åœ°ä»“åº“ï¼ˆlocalï¼‰"><a href="#æœ¬åœ°ä»“åº“ï¼ˆlocalï¼‰" class="headerlink" title="æœ¬åœ°ä»“åº“ï¼ˆlocalï¼‰"></a>æœ¬åœ°ä»“åº“ï¼ˆ<code>local</code>ï¼‰</h3><p>è¿è¡Œ<code>Maven</code>é¡¹ç›®æ—¶ï¼Œä»»ä½•ä¾èµ–çš„æ„å»ºæˆ–ç¬¬ä¸‰æ–¹<code>JAR</code>åŒ…éƒ½æ˜¯ç›´æ¥ä»æœ¬åœ°ä»“åº“è·å–çš„ã€‚å¦‚æœæœ¬åœ°ä»“åº“æ²¡æœ‰ï¼Œå®ƒä¼šé¦–å…ˆå°è¯•ä»è¿œç¨‹ä»“åº“ä¸‹è½½æ„å»ºè‡³æœ¬åœ°ä»“åº“ï¼Œç„¶åå†ä½¿ç”¨æœ¬åœ°ä»“åº“çš„æ„å»ºã€‚</p><p>é»˜è®¤çš„æœ¬åœ°ä»“åº“è·¯å¾„ä¸º<code>~/.m2/repository</code>ï¼Œè¦ä¿®æ”¹è¯¥é»˜è®¤ä½ç½®ï¼Œå¯åœ¨<code>Maven</code>çš„<code>setting.xml</code>æ–‡ä»¶ä¸­æŒ‡å®šæœ¬åœ°ä»“åº“è·¯å¾„ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>/Library/maven/repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ä¸­å¤®ä»“åº“ï¼ˆcentralï¼‰"><a href="#ä¸­å¤®ä»“åº“ï¼ˆcentralï¼‰" class="headerlink" title="ä¸­å¤®ä»“åº“ï¼ˆcentralï¼‰"></a>ä¸­å¤®ä»“åº“ï¼ˆ<code>central</code>ï¼‰</h3><p>ä¸­å¤®ä»“åº“æ˜¯ç”±<code>Maven</code>ç¤¾åŒºæä¾›çš„ä»“åº“ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œè¿›è¡Œè®¿é—®ã€‚å›½å†…å¸¸ç”¨çš„æ˜¯é˜¿é‡Œäº‘ä¸­å¤®ä»“åº“ã€‚å¯åœ¨<code>Maven</code>çš„<code>setting.xml</code>æ–‡ä»¶ä¸­é…ç½®é˜¿é‡Œäº‘çš„ä¸­å¤®ä»“åº“æºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>/Library/maven/repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/repositories/central/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>Maven</code>ç¤¾åŒºæä¾›äº†ä¸€ä¸ªç½‘ç«™ï¼š<a href="https://search.maven.org/">https://search.maven.org</a>ï¼Œå¯æœç´¢åˆ°æ‰€æœ‰å¯ä»¥è·å–çš„æ„å»ºåº“å’Œ<code>JAR</code>åŒ…ã€‚</p><h3 id="è¿œç¨‹ä»“åº“ï¼ˆremoteï¼‰"><a href="#è¿œç¨‹ä»“åº“ï¼ˆremoteï¼‰" class="headerlink" title="è¿œç¨‹ä»“åº“ï¼ˆremoteï¼‰"></a>è¿œç¨‹ä»“åº“ï¼ˆ<code>remote</code>ï¼‰</h3><p>å¦‚æœ<code>Maven</code>åœ¨ä¸­å¤®ä»“åº“ä¹Ÿæ‰¾ä¸åˆ°ä¾èµ–çš„æ„å»ºï¼Œå®ƒä¼šåœæ­¢æ„å»ºè¿‡ç¨‹å¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œ<code>Maven</code>æä¾›äº†è¿œç¨‹ä»“åº“çš„æ¦‚å¿µï¼Œå®ƒæ˜¯å¼€å‘äººå‘˜è‡ªå·±å®šåˆ¶çš„ä»“åº“ï¼ŒåŒ…å«äº†æ‰€éœ€è¦çš„ä»£ç åº“æˆ–è€…å…¶å®ƒå·¥ç¨‹ä¸­ç”¨åˆ°çš„<code>JAR</code>æ–‡ä»¶ã€‚</p><h2 id="Mavenä¾èµ–æœç´¢é¡ºåº"><a href="#Mavenä¾èµ–æœç´¢é¡ºåº" class="headerlink" title="Mavenä¾èµ–æœç´¢é¡ºåº"></a><code>Maven</code>ä¾èµ–æœç´¢é¡ºåº</h2><p>é¦–å…ˆä»æœ¬åœ°ä»“åº“ï¼ˆ<code>local</code>ï¼‰ä¸­æœç´¢ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™å»ä¸­å¤®ä»“åº“ï¼ˆ<code>central</code>ï¼‰ä¸­æœç´¢ï¼›</p><p>å¦‚æœåœ¨ä¸­å¤®ä»“åº“ï¼ˆ<code>central</code>ï¼‰ä¸­æ‰¾ä¸åˆ°ï¼Œåˆ™æŸ¥çœ‹æ˜¯å¦è®¾ç½®äº†è¿œç¨‹ä»“åº“ï¼ˆ<code>remote</code>ï¼‰ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™åœæ­¢æœç´¢å¹¶æŠ›å‡ºé”™è¯¯ï¼ˆæ— æ³•æ‰¾åˆ°ä¾èµ–ï¼‰ã€‚</p><p>å¦‚æœåœ¨è¿œç¨‹ä»“åº“ï¼ˆ<code>remote</code>ï¼‰ä¸­æ‰¾ä¸åˆ°ï¼Œåˆ™åœæ­¢æœç´¢å¹¶æŠ›å‡ºé”™è¯¯ï¼ˆæ— æ³•æ‰¾åˆ°ä¾èµ–ï¼‰ï¼›å¦‚æœåœ¨è¿œç¨‹ä»“åº“ï¼ˆ<code>remote</code>ï¼‰ä¸­æ‰¾åˆ°äº†ï¼Œåˆ™ä¸‹è½½è‡³æœ¬åœ°ä»“åº“å¹¶å¼•ç”¨ã€‚</p><h2 id="Mavenæ’ä»¶"><a href="#Mavenæ’ä»¶" class="headerlink" title="Mavenæ’ä»¶"></a><code>Maven</code>æ’ä»¶</h2><p><code>Maven</code>çš„ä¸‰ä¸ªæ ‡å‡†ç”Ÿå‘½å‘¨æœŸä¸­éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é˜¶æ®µï¼Œæ¯ä¸€ä¸ªé˜¶æ®µçš„å…·ä½“å®ç°éƒ½æ˜¯ç”±<code>Maven</code>çš„æ’ä»¶å®Œæˆã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬ä½¿ç”¨çš„<code>mvn clean</code>å‘½ä»¤ï¼Œ<code>clean</code>å¯¹åº”ç€<code>Clean</code>ç”Ÿå‘½å‘¨æœŸä¸­çš„<code>clean</code>é˜¶æ®µï¼Œ<code>clean</code>çš„å…·ä½“æ“ä½œæ˜¯ç”±<code>maven-clean-plugin</code>å®Œæˆçš„ã€‚</p><h3 id="æ’ä»¶ç±»å‹"><a href="#æ’ä»¶ç±»å‹" class="headerlink" title="æ’ä»¶ç±»å‹"></a>æ’ä»¶ç±»å‹</h3><p><code>Maven</code>æä¾›äº†ä»¥ä¸‹ä¸¤ç§ç±»å‹çš„æ’ä»¶ï¼š</p><ul><li><code>Build Plugins</code>ï¼šåœ¨æ„å»ºæ—¶æ‰§è¡Œï¼Œå¹¶åœ¨<code>pom.xml</code>çš„å…ƒç´ ä¸­é…ç½®ã€‚</li><li><code>Reporting Plugins</code>ï¼šåœ¨ç½‘ç«™ç”Ÿæˆè¿‡ç¨‹ä¸­æ‰§è¡Œï¼Œå¹¶åœ¨<code>pom.xml</code>çš„å…ƒç´ ä¸­é…ç½®ã€‚</li></ul><h3 id="å¸¸ç”¨æ’ä»¶"><a href="#å¸¸ç”¨æ’ä»¶" class="headerlink" title="å¸¸ç”¨æ’ä»¶"></a>å¸¸ç”¨æ’ä»¶</h3><p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„æ’ä»¶ï¼š</p><ul><li><code>clean</code>ï¼šæ„å»ºä¹‹åæ¸…ç†ç›®æ ‡æ–‡ä»¶ã€‚åˆ é™¤ç›®æ ‡ç›®å½•ã€‚</li><li><code>compiler</code>ï¼šç¼–è¯‘<code>Java</code>æºæ–‡ä»¶ã€‚</li><li><code>surefile</code>ï¼šè¿è¡Œ<code>Junit</code>å•å…ƒæµ‹è¯•ã€‚åˆ›å»ºæµ‹è¯•æŠ¥å‘Šã€‚</li><li><code>jar</code>ï¼šä»å½“å‰å·¥ç¨‹ä¸­æ„å»º<code>jar</code>æ–‡ä»¶ã€‚</li><li><code>war</code>ï¼šä»å½“å‰å·¥ç¨‹ä¸­æ„å»º<code>war</code>æ–‡ä»¶ã€‚</li><li><code>javadoc</code>ï¼šä¸ºå·¥ç¨‹ç”Ÿæˆ<code>javadoc</code>ã€‚</li><li><code>antrun</code>ï¼šä»æ„å»ºè¿‡ç¨‹çš„ä»»æ„ä¸€ä¸ªé˜¶æ®µä¸­è¿è¡Œä¸€ä¸ª<code>ant</code>ä»»åŠ¡çš„é›†åˆã€‚</li></ul><h2 id="å¼•å…¥å¤–éƒ¨ä¾èµ–"><a href="#å¼•å…¥å¤–éƒ¨ä¾èµ–" class="headerlink" title="å¼•å…¥å¤–éƒ¨ä¾èµ–"></a>å¼•å…¥å¤–éƒ¨ä¾èµ–</h2><p>æœ‰äº›æ—¶å€™æˆ‘ä»¬éœ€è¦å»å¯¹æ¥ä¸€äº›ç¬¬ä¸‰æ–¹çš„<code>SDK</code>åŒ…ï¼Œä¸€èˆ¬ç¬¬ä¸‰æ–¹ä¼šæä¾›<code>SDK</code>çš„ä¸‹è½½åœ°å€ï¼Œä½†æ˜¯å¾ˆå¯èƒ½æœªå‘å¸ƒè‡³ä¸­å¤®ä»“åº“ï¼Œå°±å¯¼è‡´æ— æ³•é€šè¿‡<code>Maven</code>åæ ‡ç›´æ¥å¼•å…¥ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å°†<code>SDK</code>åŒ…ä¸‹è½½å¹¶å¤åˆ¶ç²˜è´´åˆ°é¡¹ç›®ä¸­ï¼Œå¯åœ¨<code>$&#123;basedir&#125;/src/main/resources</code>ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>lib</code>ç›®å½•ï¼Œä¸“é—¨ç”¨æ¥å­˜æ”¾æœªå‘å¸ƒè‡³ä¸­å¤®ä»“åº“çš„<code>JAR</code>åŒ…ã€‚å¼•å…¥æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åœ¨è¿™é‡Œæ·»åŠ ä½ çš„ä¾èµ– --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åº“åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>xxx-sdk-1.0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åº“åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ç‰ˆæœ¬å· --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ä½œç”¨åŸŸ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>system<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- resourceç›®å½•ä¸‹çš„libæ–‡ä»¶å¤¹ä¸‹ï¼Œæ–‡ä»¶åä¸ºï¼šxxx-sdk.jar --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">systemPath</span>&gt;</span>$&#123;basedir&#125;\src\main\resources\lib\xxx-sdk.jar<span class="tag">&lt;/<span class="name">systemPath</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å¿«ç…§ï¼ˆSNAPSHOTï¼‰"><a href="#å¿«ç…§ï¼ˆSNAPSHOTï¼‰" class="headerlink" title="å¿«ç…§ï¼ˆSNAPSHOTï¼‰"></a>å¿«ç…§ï¼ˆ<code>SNAPSHOT</code>ï¼‰</h2><p>åœ¨<code>Apache Dubbo</code>å¾®æœåŠ¡é¡¹ç›®å¼€å‘ä¸­ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹éœ€è¦å»å¼•å…¥æœåŠ¡æä¾›æ–¹å¯¹å¤–æš´éœ²çš„<code>API</code>æ¥å£<code>jar</code>åŒ…ã€‚æœåŠ¡æä¾›æ–¹å¾ˆæœ‰å¯èƒ½åœ¨çŸ­æœŸå†…å¤šæ¬¡ä¿®æ”¹å¯¹å¤–æš´éœ²çš„æ¥å£ï¼Œå¦‚æœæŒ‰ç…§æ­£å¸¸çš„ç‰ˆæœ¬å·ï¼š<code>producer-service.jar:1.0.0</code>ï¼Œé‚£æ¯ä¿®æ”¹ä¸€æ¬¡æ¥å£éƒ½éœ€è¦å‡çº§ä¸€ä¸ªå°ç‰ˆæœ¬ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹ä¸å¾—ä¸å»æ›´æ–°<code>pom.xml</code>æ¥å¼•ç”¨æœ€æ–°çš„<code>jar</code>åŒ…ã€‚å¦‚æœä¿®æ”¹æ¥å£è€Œä¸å‡çº§ç‰ˆæœ¬å·å°±å‘å¸ƒè‡³ä»“åº“ä¸­ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹åœ¨å¼•ç”¨æ—¶ä¸ä¼šå»ä»“åº“ä¸‹è½½ç›¸åŒç‰ˆæœ¬å·çš„æœ€æ–°<code>jar</code>åŒ…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹åªä¼šä¸‹è½½ä¸€æ¬¡æŒ‡å®šç‰ˆæœ¬å·çš„<code>jar</code>åŒ…ã€‚ä¸ºäº†é¿å…è¿™ç§ç¹ççš„æ›´æ–°ï¼Œ<code>Maven</code>æä¾›äº†å¿«ç…§ç‰ˆæœ¬ã€‚</p><p>å¿«ç…§ç‰ˆæœ¬æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç‰ˆæœ¬ï¼ŒæŒ‡å®šäº†å½“å‰çš„å¼€å‘è¿›åº¦çš„å‰¯æœ¬ã€‚ä¸åŒäºå¸¸è§„çš„ç‰ˆæœ¬ï¼Œ<code>Maven</code>æ¯æ¬¡æ„å»ºéƒ½ä¼šåœ¨è¿œç¨‹ä»“åº“ä¸­æ£€æŸ¥æ–°çš„å¿«ç…§ï¼ŒæœåŠ¡æä¾›æ–¹åªéœ€å‘å¸ƒåŒ…å«æœ€æ–°ä»£ç çš„å¿«ç…§ç‰ˆæœ¬ï¼ˆ<code>producer-service.jar:1.0.0-SNAPSHOT</code>ï¼‰è‡³ä»“åº“ä¸­ï¼ŒæœåŠ¡æ¶ˆè´¹æ–¹æ¯æ¬¡éƒ½ä¼šè‡ªåŠ¨å»è·å–åŒ…å«æœ€æ–°ä»£ç çš„å¿«ç…§ï¼ˆ<code>producer-service.jar:1.0.0-SNAPSHOT</code>ï¼‰ã€‚</p><h2 id="ä¾èµ–ç®¡ç†"><a href="#ä¾èµ–ç®¡ç†" class="headerlink" title="ä¾èµ–ç®¡ç†"></a>ä¾èµ–ç®¡ç†</h2><p><code>Maven</code>è§£æ<code>jar</code>åŒ…çš„æ–¹å¼æ˜¯ä¾èµ–ä¼ é€’ã€‚ä¾‹å¦‚æˆ‘ä»¬å¼•å…¥<code>spring-boot-starter-web</code>ï¼Œå½“<code>Maven</code>è§£æè¯¥ä¾èµ–æ—¶ï¼Œä¸ä»…ä»…ä¼šå¼•å…¥å…¶å†…éƒ¨ä¾èµ–çš„<code>spring-web</code>ã€<code>spring-webmvc</code>å’Œ<code>spring-boot-starter-tomcat</code>ç­‰ï¼Œè¿˜ä¼šå¼•å…¥è¿™äº›å†…éƒ¨ä¾èµ–æ‰€ä¾èµ–çš„<code>jar</code>åŒ…ï¼Œä¾‹å¦‚<code>spring-web</code>ä¾èµ–çš„<code>spring-bean</code>ç­‰ï¼Œä¾èµ–å…³ç³»ä¸æ–­å‘ä¸‹ä¼ é€’ï¼Œç›´è‡³æ²¡æœ‰ä¾èµ–ï¼Œæœ€ç»ˆå½¢æˆäº†ä¸€é¢—ä¾èµ–æ ‘ã€‚</p><h3 id="ä¾èµ–å†²çªçš„é—®é¢˜"><a href="#ä¾èµ–å†²çªçš„é—®é¢˜" class="headerlink" title="ä¾èµ–å†²çªçš„é—®é¢˜"></a>ä¾èµ–å†²çªçš„é—®é¢˜</h3><p>ä¸¾ä¸ªæ —å­ï¼šå‡è®¾æœ‰ä¾èµ–<code>A</code>ï¼Œå®ƒå†…éƒ¨çš„ä¾èµ–ä¼ é€’å…³ç³»ä¸ºï¼š<code>A</code>-&gt;<code>B</code>-&gt;<code>C</code>-&gt;<code>D</code>-&gt;<code>E1</code>ï¼›æœ‰å¦ä¸€ä¸ªä¾èµ–<code>F</code>ï¼Œå®ƒå†…éƒ¨çš„ä¾èµ–ä¼ é€’å…³ç³»ä¸ºï¼š<code>F</code>-&gt;<code>G</code>-&gt;<code>E2</code>ã€‚<code>E1</code>å’Œ<code>E2</code>ä¸º<code>E</code>çš„ä¸åŒç‰ˆæœ¬ã€‚</p><p>å¦‚æœ<code>pom.xml</code>åŒæ—¶å¼•å…¥<code>A</code>å’Œ<code>F</code>ä¾èµ–ï¼ŒæŒ‰ç…§<code>Maven</code>ä¾èµ–ä¼ é€’åŸåˆ™ï¼Œå®é™…å¼•å…¥çš„ä¾èµ–å°†åŒ…æ‹¬ï¼š<code>A</code>ã€<code>B</code>ã€<code>C</code>ã€<code>D</code>ã€<code>E1</code>ã€<code>F</code>ã€<code>G</code>å’Œ<code>E2</code>ï¼Œå› æ­¤<code>E1</code>å’Œ<code>E2</code>å°†ä¼šäº§ç”ŸåŒ…å†²çªã€‚</p><h3 id="è§£å†³ä¾èµ–å†²çª"><a href="#è§£å†³ä¾èµ–å†²çª" class="headerlink" title="è§£å†³ä¾èµ–å†²çª"></a>è§£å†³ä¾èµ–å†²çª</h3><p><code>Maven</code>è§£æ<code>pom.xml</code>æ—¶ï¼ŒåŒä¸€ä¸ª<code>groupId</code>å’Œ<code>artifactId</code>çš„ä¾èµ–åªä¼šä¿ç•™ä¸€ä¸ªï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆé¿å…å› å¼•å…¥ä¸åŒç‰ˆæœ¬çš„ä¾èµ–æ‰€å¸¦æ¥çš„é—®é¢˜ã€‚</p><p><code>Maven</code>é»˜è®¤å¤„ç†ç­–ç•¥ï¼š</p><ul><li>æœ€çŸ­è·¯å¾„ä¼˜å…ˆåŸåˆ™ï¼šå› ä¸ºä»<code>F</code>åˆ°<code>E2</code>çš„è·¯å¾„æ¯”ä»<code>A</code>åˆ°<code>E1</code>çš„è·¯å¾„çŸ­ï¼Œæ‰€ä»¥<code>Maven</code>åœ¨é¢å¯¹<code>E1</code>å’Œ<code>E2</code>æ—¶ä¼šé€‰æ‹©<code>E2</code>ã€‚</li><li>æœ€å…ˆå£°æ˜ä¼˜å…ˆåŸåˆ™ï¼šä¸¾ä¸ªæ —å­ï¼š<code>A</code>-&gt;<code>B</code>-&gt;<code>C1</code>ï¼›<code>D</code>-&gt;<code>E</code>-&gt;<code>C2</code>ã€‚è¿™ä¸¤ä¸ªä¾èµ–ä¼ é€’çš„è·¯å¾„é•¿åº¦æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è°åœ¨<code>pom.xml</code>å…ˆè¢«å£°æ˜å°±å¼•å…¥è°ã€‚</li></ul><p>æ’é™¤ä¾èµ–ï¼šé»˜è®¤å¤„ç†ç­–ç•¥å·²ç»èƒ½è§£å†³åŒ…çš„ä¾èµ–é—®é¢˜ï¼Œä½†è¿˜æ˜¯ä¼šæ˜¾ç¤ºä¾èµ–å†²çªï¼Œç°è±¡å°±æ˜¯<code>IDEA</code>ä¸­ä¼šæŠ¥çº¢ï¼›åŒæ—¶é»˜è®¤å¤„ç†å¼•å…¥çš„ä¾èµ–ç‰ˆæœ¬å·å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¼•å…¥æŒ‡å®šç‰ˆæœ¬å·çš„ä¾èµ–ï¼Œå¯ä»¥ä½¿ç”¨<code>&lt;exclusions /&gt;</code>å’Œ<code>&lt;exclusion&gt;</code>æ ‡ç­¾å…ˆæ’é™¤å†²çªçš„ä¾èµ–ï¼Œå†å¦å¤–å•ç‹¬åœ¨<code>pom.xml</code>ä¸­å¼•å…¥æŒ‡å®šç‰ˆæœ¬å·çš„ä¾èµ–ã€‚</p><p>æ£€æµ‹åŒ…å†²çªçš„<code>Maven</code>å‘½ä»¤å¦‚ä¸‹ï¼š</p><ul><li><code>mvn dependency:help</code></li><li><code>mvn dependency:analyze</code></li><li><code>mvn dependency:tree</code></li><li><code>mvn dependency:tree -Dverbose</code></li></ul><h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><p>å½“å¼€å‘å¤šæ¨¡å—é¡¹ç›®æ—¶ï¼Œåœ¨æœ€å¤–å±‚çš„çˆ¶<code>pom.xml</code>ä¸­ä½¿ç”¨<code>dependencyManagement</code>æ ‡ç­¾è¿›è¡Œä¾èµ–åŠç‰ˆæœ¬å·çš„é¢„å®šä¹‰ï¼Œä¾¿äºç»Ÿä¸€ç®¡ç†é¡¹ç›®ä¾èµ–åŠç‰ˆæœ¬å·ã€‚åœ¨å­æ¨¡å—å¼•å…¥ä¾èµ–æ—¶ï¼Œåªéœ€æŒ‡å®š<code>groupId</code>å’Œ<code>artifactId</code>å³å¯å¼•å…¥å¯¹åº”ä¾èµ–ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>èœé¸Ÿæ•™ç¨‹ - <code>Maven</code>æ•™ç¨‹</li></ul>]]></content>
      
      
      <categories>
          
          <category> Java EE </category>
          
          <category> Maven </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeé¢˜è§£-ç¬¬7é¢˜ï¼šæ•´æ•°åè½¬</title>
      <link href="2020/12/04/algorithm/leetcode/easy/7/"/>
      <url>2020/12/04/algorithm/leetcode/easy/7/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šç»™å‡ºä¸€ä¸ª <code>32</code> ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œä½ éœ€è¦å°†è¿™ä¸ªæ•´æ•°ä¸­æ¯ä½ä¸Šçš„æ•°å­—è¿›è¡Œåè½¬ã€‚</p><p>ç¤ºä¾‹Â <code>1</code>:<br>è¾“å…¥: <code>123</code><br>è¾“å‡º: <code>321</code></p><p>ç¤ºä¾‹ <code>2</code>:<br>è¾“å…¥: <code>-123</code><br>è¾“å‡º: <code>-321</code></p><p>ç¤ºä¾‹ <code>3</code>:<br>è¾“å…¥: <code>120</code><br>è¾“å‡º: <code>21</code></p><p>æ³¨æ„:<br>å‡è®¾æˆ‘ä»¬çš„ç¯å¢ƒåªèƒ½å­˜å‚¨å¾—ä¸‹ <code>32</code> ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œåˆ™å…¶æ•°å€¼èŒƒå›´ä¸º <code>[âˆ’2^31,2^31 âˆ’ 1]</code>ã€‚è¯·æ ¹æ®è¿™ä¸ªå‡è®¾ï¼Œå¦‚æœåè½¬åæ•´æ•°æº¢å‡ºé‚£ä¹ˆå°±è¿”å› <code>0</code>ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆ<code>LeetCode</code>ï¼‰<br>é“¾æ¥ï¼š<code>https://leetcode-cn.com/problems/reverse-integer</code><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><p>æ€è·¯ï¼š</p><p>é¦–å…ˆæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ™®é€šçš„æ­£æ•´æ•°å¦‚ä½•è¿›è¡Œåè½¬ã€‚</p><p>ä¾‹å¦‚ <code>1234</code>ã€‚</p><p>æœ€ç›´æ¥æš´åŠ›çš„ï¼šå­—ç¬¦ä¸²å¼‚å¸¸æ³•ã€‚å…ˆå°†å…¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åå¯¹å­—ç¬¦ä¸²éå†ï¼Œåˆ©ç”¨æ ˆç»“æ„è¿›è¡Œåè½¬ï¼Œåè½¬ä¹‹åçš„å­—ç¬¦ä¸²ç±»å‹å¼ºåˆ¶è½¬æ¢æˆæ•´æ•°ï¼ŒæŠ›å‡ºå¼‚å¸¸åˆ™æº¢å‡ºã€‚è¿™æ ·å¯ä»¥å¤„ç†<code>1234</code>è¿™æ ·çš„æ­£æ•´æ•°ã€‚ä½†æ˜¯é‡åˆ°è´Ÿæ•°å°±è¡Œä¸é€šäº†ã€‚</p><p>æˆ‘ä»¬å¾—è€ƒè™‘å¦‚ä½•å¯¹è´Ÿæ•°è¿›è¡Œåè½¬ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å…ˆåˆ¤æ–­è¾“å…¥æ•°çš„æ­£è´Ÿæ€§ï¼Œç„¶åè®°ä¸€ä¸ªæ ‡è®°ï¼ŒåŒæ ·çš„æ–¹å¼åè½¬å®Œæˆåï¼Œå¦‚æœæ˜¯è´Ÿæ•°ï¼Œåˆ™æ‹¼æ¥ä¸Šè´Ÿå·<code>-</code>å†è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³äº†ã€‚</p><p>æ¥çœ‹ä¸‹è¿™ç§â€œæš´åŠ›å­—ç¬¦ä¸²å¼‚å¸¸æ³•â€çš„ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">convertStringToReverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ˜¯å¦å°äº0</span></span><br><span class="line">    <span class="keyword">boolean</span> flag = x &lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å–ç»å¯¹å€¼è½¬å­—ç¬¦ä¸²</span></span><br><span class="line">    String s = String.valueOf(Math.abs(x));</span><br><span class="line">    <span class="comment">// è½¬æ¢æˆcharæ•°ç»„è¿›è¡Œéå†</span></span><br><span class="line">    <span class="keyword">char</span>[] chars = s.toCharArray();</span><br><span class="line">    <span class="comment">// å£°æ˜æ ˆ</span></span><br><span class="line">    Deque&lt;Character&gt; stack = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    <span class="comment">// å…¥æ ˆ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> aChar : chars) &#123;</span><br><span class="line">        stack.push(aChar);</span><br><span class="line">    &#125;</span><br><span class="line">    StringBuilder res = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">        <span class="comment">// xå€¼å°äº0ï¼Œå‰é¢æ‹¼æ¥ä¸Šè´Ÿå·</span></span><br><span class="line">        res.append(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å‡ºæ ˆ</span></span><br><span class="line">    <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">        res.append(stack.pop());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å¼ºåˆ¶ç±»å‹è½¬æ¢</span></span><br><span class="line">        <span class="keyword">return</span> Integer.parseInt(res.toString());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// å¼‚å¸¸è¡¨ç¤ºæº¢å‡º</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§åšæ³•ï¼Œå…¥æ ˆéå†çš„æ—¶é—´å¤æ‚åº¦<code>O(n)</code>ï¼Œæ ˆç»“æ„çš„ç©ºé—´å¤æ‚åº¦<code>O(n)</code>ï¼Œå‡ºæ ˆéå†çš„æ—¶é—´å¤æ‚åº¦<code>O(n)</code>ã€‚æ•´ä½“çš„æ—¶é—´å¤æ‚åº¦æ˜¯<code>O(n)</code>ï¼Œç©ºé—´å¤æ‚åº¦<code>O(n)</code>ã€‚</p><p>æ˜¾ç„¶ï¼Œè¿™ç§è§£æ³•å¹¶ä¸æ˜¯æœ€ä¼˜è§£ã€‚</p><p>ä¸åšç±»å‹è½¬æ¢ï¼Œåªæ“ä½œæ•´æ•°è¿›è¡Œåè½¬ã€‚å¦‚ä½•æ“ä½œï¼Ÿå…¶å®å¯ä»¥å¥—ç”¨ç”Ÿäº§è€…æ¶ˆè´¹è€…çš„æ€æƒ³ã€‚</p><p>å¯¹äºè¾“å…¥æ•´æ•°<code>x</code>ï¼š</p><p>ç”Ÿäº§è€…é€»è¾‘ï¼š</p><p>è·å–æ•´æ•°çš„ä¸ªä½æ•°å­—ï¼š<code>n = x % 10</code>ã€‚</p><p>æ¶ˆè´¹è€…é€»è¾‘ï¼š</p><p>æ•´ä¸ªè¿‡ç¨‹å¼€å§‹ä¹‹å‰ï¼Œåè½¬ç»“æœ<code>res</code>çš„åˆå§‹å€¼ç­‰äº<code>0</code>ã€‚</p><p>å°†ç”Ÿäº§è€…äº§å‡ºçš„ä¸ªä½æ•°åŠ åˆ°<code>res</code>åé¢ï¼š<code>res = res * 10 + n</code>ã€‚</p><p>å°†è¾“å…¥æ•´æ•°çš„ä¸ªä½æ•°å»é™¤ï¼š<code>x /= 10</code>ã€‚</p><p>å½“æ¶ˆè´¹åˆ°<code>x = 0</code>æ—¶ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸï¼Œæœ€ç»ˆçš„<code>res</code>å³ä¸ºåè½¬ç»“æœã€‚</p><p>çœ‹ä¼¼å®Œç¾ï¼Œä½†é¢˜æ„ä¸­è¯´åˆ°äº†æ•´æ•°æº¢å‡ºã€‚åè½¬ä¹‹åçš„èŒƒå›´ä¸ºï¼š<code>[-2^31,2^31 - 1]</code>ï¼Œæˆ‘ä»¬éœ€è¦å»è€ƒè™‘æº¢å‡ºçš„è¾¹ç•Œã€‚</p><p>åè½¬ç»“æœ<code>res</code>æ¯æ¬¡æ¶ˆè´¹éƒ½ä¼šå¢å¤§ä¸€ä¸ªæ•°é‡çº§ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é™åˆ¶çš„æ•°å€¼èŒƒå›´ï¼š<code>[-2147483648,2147483647]</code></p><p>å¯¹äºåè½¬ç»“æœ<code>res</code>ï¼š</p><p>é¦–å…ˆåˆ†ææ­£æ•°åŒºé—´ï¼Œè€ƒè™‘å€’æ•°ç¬¬äºŒä½ï¼Œå¦‚æœæœ¬æ¬¡æ¶ˆè´¹å‰<code>res &gt; 214748364</code>ï¼ˆå³å»æ‰æ­£åŒºé—´æœ€å¤§å€¼çš„æœ€åä¸€ä½ï¼‰ï¼Œæ— è®ºæ­¤æ¬¡æ¶ˆè´¹åˆ°çš„ä¸ªä½æ•°<code>n</code>ä¸ºå¤šå°‘éƒ½æº¢å‡ºäº†ï¼›å¦ä¸€ç§æƒ…å†µï¼Œè€ƒè™‘æœ€åä¸€ä½ï¼Œå¦‚æœæœ¬æ¬¡æ¶ˆè´¹å‰<code>res = 214748364</code>ï¼Œé‚£æœ¬æ¬¡æ¶ˆè´¹æ—¶<code>n</code>å€¼åªè¦å¤§äº<code>7</code>ï¼Œå°±æº¢å‡ºäº†ã€‚</p><p>å†æ¥çœ‹è´Ÿæ•°åŒºé—´ï¼ŒåŒæ ·è€ƒè™‘å€’æ•°ç¬¬äºŒä½ï¼Œå¦‚æœæœ¬æ¬¡æ¶ˆè´¹å‰<code>res &lt; -214748364</code>æˆç«‹ï¼Œæ— è®ºæ­¤æ¬¡æ¶ˆè´¹åˆ°çš„ä¸ªä½æ•°<code>n</code>ä¸ºå¤šå°‘éƒ½æº¢å‡ºäº†ï¼›å¦ä¸€ç§æƒ…å†µï¼Œè€ƒè™‘æœ€åä¸€ä½ï¼Œå¦‚æœæœ¬æ¬¡æ¶ˆè´¹å‰<code>res = -214748364</code>ï¼Œé‚£æœ¬æ¬¡æ¶ˆè´¹æ—¶<code>n</code>å€¼åªè¦å°äº<code>-8</code>ï¼Œå°±æº¢å‡ºäº†ã€‚</p><p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åè½¬ç»“æœåˆå§‹å€¼</span></span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// ç”Ÿäº§ï¼šè·å–ä¸ªä½æ•°</span></span><br><span class="line">        <span class="keyword">int</span> x = n % <span class="number">10</span>;</span><br><span class="line">        <span class="comment">// æº¢å‡ºè¾¹ç•Œ</span></span><br><span class="line">        <span class="keyword">if</span> ((res &gt; Integer.MAX_VALUE / <span class="number">10</span> || (res == Integer.MAX_VALUE / <span class="number">10</span> &amp;&amp; x &gt; Integer.MAX_VALUE % <span class="number">10</span>))</span><br><span class="line">                || (res &lt; Integer.MIN_VALUE / <span class="number">10</span> || (res == Integer.MIN_VALUE / <span class="number">10</span> &amp;&amp; x &lt; Integer.MIN_VALUE % <span class="number">10</span>))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ¶ˆè´¹ï¼šåŠ åˆ°åè½¬ç»“æœåé¢</span></span><br><span class="line">        res = res * <span class="number">10</span> + x;</span><br><span class="line">        n /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> LeetCode </category>
          
          <category> ç®€å• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•å¿…é—®HashMap</title>
      <link href="2020/11/17/javase/base/hashmap/"/>
      <url>2020/11/17/javase/base/hashmap/</url>
      
        <content type="html"><![CDATA[<p>æ— è®ºæ˜¯å°å‚è¿˜æ˜¯å¤§å‚é¢è¯•ï¼Œ<code>HashMap</code>çš„å‡ºåœºç‡ä¸€ç›´å±…é«˜ä¸ä¸‹ã€‚ä½œä¸º<code>Java</code>è¯­è¨€ä¸­<code>Map</code>æ•°æ®ç»“æ„çš„ç»å…¸å®ç°ï¼Œå¯¹å…¶å†…éƒ¨åŸç†çš„æŒæ¡å’Œç†è§£ç¨‹åº¦åœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½åæ˜ å‡ºä¸€ä¸ªå¼€å‘äººå‘˜çš„æ°´å¹³ä¸å®åŠ›ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æä¾›å‡ºä¸€äº›å¸¸è§é¢è¯•é—®æ³•ä»¥åŠå¯¹åº”çš„å®˜æ–¹å›ç­”ï¼ˆå»ºè®®ç†Ÿè¯»å¹¶èƒŒè¯µï¼‰ï¼š</p><ol><li><code>HashMap</code>åº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ<code>JDK7</code>å’Œ<code>JDK8</code>çš„å®ç°æœ‰ä½•åŒºåˆ«ï¼Ÿ</li></ol><p>ç­”ï¼š<code>HashMap</code>åº•å±‚å­˜å‚¨å…ƒç´ çš„æ•°æ®ç»“æ„æ˜¯æ•°ç»„ã€‚åœ¨å­˜å‚¨å…ƒç´ æ—¶å¦‚æœå‘ç”Ÿäº†å“ˆå¸Œå†²çªï¼Œ<code>JDK7</code>ä½¿ç”¨â€œé“¾åœ°å€æ³•â€ï¼ˆä¿—ç§°â€œæ‹‰é“¾æ³•â€ï¼‰æ¥è§£å†³ï¼Œé‡‡ç”¨â€œå¤´æ’æ³•â€è¿›è¡Œå…ƒç´ æ’å…¥ã€‚åœ¨<code>JDK8</code>ä¸­ï¼Œå½“å“ˆå¸Œå†²çªä¸æ˜¯å¾ˆä¸¥é‡æ—¶ï¼Œä»ç„¶ä½¿ç”¨â€œé“¾åœ°å€æ³•â€è§£å†³ï¼Œä½†é‡‡ç”¨çš„æ˜¯â€œå°¾æ’æ³•â€ï¼›è€Œå½“å“ˆå¸Œå†²çªç‰¹åˆ«ä¸¥é‡ï¼Œå³é“¾è¡¨çš„é•¿åº¦å¤§äº<code>8</code>å¹¶ä¸”æ•°ç»„çš„å®¹é‡å¤§äº<code>64</code>æ—¶ï¼Œä¼šå°†é“¾è¡¨ç»“æ„è½¬åŒ–æˆçº¢é»‘æ ‘ç»“æ„ç”¨ä»¥è§£å†³é“¾è¡¨è¿‡é•¿å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚</p><ol start="2"><li>åŠ è½½å› å­<code>loadFactor</code>ä¸ºä»€ä¹ˆæ˜¯<code>0.75</code>ï¼Ÿ</li></ol><p>ç­”ï¼šè¿™æ˜¯ä¸€ä¸ªåŸºäºå®¹é‡å’Œæ€§èƒ½è€ƒè™‘çš„æŠ˜è¡·å€¼ã€‚å¦‚æœåŠ è½½å› å­è®¾ç½®è¿‡å¤§ï¼Œå¸¦æ¥çš„å¥½å¤„æ˜¯æ‰©å®¹çš„é—¨æ§›æé«˜ï¼ŒèŠ‚çº¦äº†å†…å­˜ç©ºé—´ï¼Œä½†å‡ºç°å“ˆå¸Œå†²çªçš„å‡ ç‡ä¼šå˜å¤§ï¼Œä»è€Œå¯¼è‡´å¯¹å…ƒç´ çš„æ“ä½œæ€§èƒ½ä¸‹é™ï¼›å¦‚æœåŠ è½½å› å­è®¾ç½®è¿‡å°ï¼Œå¸¦æ¥çš„å¥½å¤„æ˜¯æ‰©å®¹é—¨æ§›é™ä½ï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„å…ƒç´ ä¼šæ¯”è¾ƒç¨€ç–ï¼Œä¸æ˜“å‡ºç°å“ˆå¸Œå†²çªï¼Œå¯¹å…ƒç´ çš„æ“ä½œæ€§èƒ½è¾ƒé«˜ã€‚ä½†ä¼šå­˜åœ¨ä¸€å®šçš„ç©ºé—´æµªè´¹ã€‚äºæ˜¯æŠ˜è¡·è€ƒè™‘é€‰æ‹©äº†<code>0.75</code>ã€‚</p><ol start="3"><li>ä»€ä¹ˆæ—¶æœºä¼šè§¦å‘æ‰©å®¹ï¼Ÿ<code>JDK8</code>åœ¨æ‰©å®¹æ—¶åšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿ</li></ol><p>ç­”ï¼šå½“å­˜å‚¨å…ƒç´ æ•°é‡å¤§äºç­‰äºé˜ˆå€¼æ—¶è§¦å‘æ‰©å®¹ã€‚<code>JDK7</code>åœ¨æ‰©å®¹æ—¶ä¼šå¯¹æ‰€æœ‰å…ƒç´ è¿›è¡Œ<code>rehash</code>é‡æ–°å“ˆå¸Œè®¡ç®—æ•°ç»„ä¸‹æ ‡ï¼›è€Œ<code>JDK8</code>åœ¨æ‰©å®¹æ—¶é€šè¿‡é«˜ä½è¿ç®—ï¼ˆå“ˆå¸Œç  &amp; æ—§å®¹é‡ï¼‰æ¥åˆ¤æ–­å…ƒç´ æ˜¯å¦éœ€è¦ç§»åŠ¨ï¼Œå¦‚æœé«˜ä½è¿ç®—ç»“æœé«˜ä¸€ä½ä¸º<code>0</code>ï¼Œé‚£ä¹ˆæ‰©å®¹åè¯¥å…ƒç´ çš„ä½ç½®ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœé«˜ä½è¿ç®—ç»“æœé«˜ä¸€ä½ä¸º<code>1</code>ï¼Œé‚£ä¹ˆæ‰©å®¹åè¯¥å…ƒç´ çš„ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼Œæ–°çš„æ•°ç»„ä¸‹æ ‡ä½ç½®ä¸ºåŸä¸‹æ ‡ä½ç½®åŠ ä¸ŠåŸæ•°ç»„é•¿åº¦ã€‚</p><ol start="4"><li>æè¿°æ’å…¥ä¸€ä¸ªå…ƒç´ çš„å®Œæ•´è¿‡ç¨‹ã€‚</li></ol><p>ç­”ï¼šé¦–å…ˆåˆ¤æ–­å“ˆå¸Œè¡¨æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºåˆ™è¡¨ç¤ºç¬¬ä¸€æ¬¡æ’å…¥ï¼Œè¿›è¡Œæ‰©å®¹ï¼›å¦åˆ™æ ¹æ®é”®è®¡ç®—å‡ºæ•°ç»„ä¸‹æ ‡ï¼Œç„¶ååˆ¤æ–­è¯¥ä¸‹æ ‡ä½ç½®çš„å…ƒç´ æ˜¯å¦ä¸º<code>null</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼›å¦åˆ™åˆ¤æ–­é”®æ˜¯å¦ç›¸ç­‰ï¼ˆå…ˆæ¯”è¾ƒ<code>hashCode</code>ï¼Œå“ˆå¸Œç ä¸ç›¸ç­‰å†è¿›è¡Œ<code>equals</code>æ¯”è¾ƒï¼‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™ç›´æ¥è¦†ç›–å€¼ï¼›å¦åˆ™åˆ¤æ–­æ˜¯çº¢é»‘æ ‘è¿˜æ˜¯é“¾è¡¨ï¼Œåˆ†åˆ«æ‰§è¡Œå¯¹åº”æ•°æ®ç»“æ„çš„æ’å…¥é€»è¾‘ã€‚å…¶ä¸­é“¾è¡¨æ•°æ®ç»“æ„åœ¨<code>JDK7</code>ä¸­ä½¿ç”¨å¤´æ’æ³•è¿›è¡Œæ’å…¥ï¼Œåœ¨<code>JDK8</code>ä¸­ä½¿ç”¨å°¾æ’æ³•ã€‚è€Œçº¢é»‘æ ‘åœ¨<code>JDK8</code>æ‰å¼•å…¥ï¼Œå¦‚æœå·²ç»æ˜¯çº¢é»‘æ ‘äº†ï¼Œåˆ™æ‰§è¡Œçº¢é»‘æ ‘çš„æ’å…¥é€»è¾‘ï¼Œå¦‚æœæ˜¯é“¾è¡¨ï¼Œåœ¨ä½¿ç”¨å°¾æ’æ³•éå†èŠ‚ç‚¹æ—¶å¦‚æœå‘ç°é“¾è¡¨é•¿åº¦å¤§äº<code>8</code>äº†ä¸”æ•°ç»„å®¹é‡å°äº<code>64</code>æ—¶ï¼Œå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘ååœ¨æ‰§è¡Œæ’å…¥ï¼Œå¦åˆ™æ‰§è¡Œé“¾è¡¨çš„å°¾éƒ¨æ’å…¥ã€‚å…ƒç´ æ’å…¥å®Œæˆåï¼Œåˆ¤æ–­å“ˆå¸Œè¡¨å®¹é‡æ˜¯å¦è¶…è¿‡é˜ˆå€¼ï¼Œè¶…è¿‡åˆ™è¿›è¡Œæ‰©å®¹ã€‚</p><ol start="5"><li><code>HashMap</code>çš„çº¿ç¨‹ä¸å®‰å…¨ä½“ç°åœ¨å“ªï¼Ÿå¦‚ä½•å»åº”å¯¹ï¼Ÿ</li></ol><p>ç­”ï¼šåœ¨å¤šçº¿ç¨‹æ¡ä»¶ä¸‹ï¼Œ<code>JDK7</code>çš„<code>HashMap</code>åœ¨æ‰©å®¹æ—¶ä¼šå‡ºç°æ­»å¾ªç¯çš„é—®é¢˜ï¼Œ<code>JDK8</code>çš„<code>HashMap</code>åœ¨æ’å…¥æ—¶ä¼šå‡ºç°å€¼è¢«è¦†ç›–çš„é—®é¢˜ã€‚åº”å¯¹è¿™ç§çº¿ç¨‹ä¸å®‰å…¨ï¼Œå¯ä»¥ä½¿ç”¨åŒæ­¥å®¹å™¨<code>HashTable</code>æˆ–å¹¶å‘å®¹å™¨<code>ConcurrentHashMap</code>ã€‚æ¨èä½¿ç”¨<code>ConcurrentHashMap</code>ã€‚</p><p>ä»¥ä¸Šé¢è¯•é¢˜åŠç­”æ¡ˆåŸºæœ¬å¯ä»¥åº”å¯¹é‚£äº›æ™®é€šå…¬å¸çš„ä¸€é—®ä¸€ç­”å¼çš„é¢è¯•äº†ï¼ŒèƒŒè¯µå°±å®Œäº‹äº†ã€‚</p><p>ä½†æœ‰äº›é¢è¯•å®˜å¯èƒ½ä¼šè¿½ç€å…¶ä¸­æŸä¸ªç‚¹ä¸€ç›´å¾€ä¸‹ç»†é—®ï¼Œè¿™ä¸ªæ—¶å€™å…‰é ä¸Šé¢èƒŒè¯µçš„è¿™ç‚¹ä¸œè¥¿å°±æœ‰ç‚¹åŠ›ä¸ä»å¿ƒäº†ï¼Œä½ å¿…é¡»å¯¹æ•´ä¸ª<code>HashMap</code>çš„åŸç†çœŸæ­£çš„æœ‰ä¸€å®šäº†è§£æ‰èƒ½å¤Ÿä»å®¹å»åº”å¯¹ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬é’ˆå¯¹ä¸Šé¢çš„é¢è¯•é¢˜ï¼Œé˜…è¯»<code>JDK8</code>çš„<code>HashMap</code>æºç ï¼ŒçœŸæ­£çš„å»ææ‡‚åŸç†ã€‚</p><h2 id="å¦‚ä½•å­˜å‚¨å…ƒç´ ï¼Ÿ"><a href="#å¦‚ä½•å­˜å‚¨å…ƒç´ ï¼Ÿ" class="headerlink" title="å¦‚ä½•å­˜å‚¨å…ƒç´ ï¼Ÿ"></a>å¦‚ä½•å­˜å‚¨å…ƒç´ ï¼Ÿ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br></pre></td></tr></table></figure><p>å…ƒç´ éƒ½å­˜å‚¨åœ¨è¿™ä¸ª<code>Node</code>æ•°ç»„é‡Œé¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹<code>Node</code>ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Basic hash bin node, used for most entries.  (See below for</span></span><br><span class="line"><span class="comment"> * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// hashå€¼</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;</span><br><span class="line">    <span class="comment">// é”®</span></span><br><span class="line">    <span class="keyword">final</span> K key;</span><br><span class="line">    <span class="comment">// å€¼</span></span><br><span class="line">    V value;</span><br><span class="line">    <span class="comment">// ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    Node&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line">    Node(<span class="keyword">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// getter/setter/toString/equals/hashCode</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> K <span class="title">getKey</span><span class="params">()</span>        </span>&#123; <span class="keyword">return</span> key; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">getValue</span><span class="params">()</span>      </span>&#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> key + <span class="string">&quot;=&quot;</span> + value; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">setValue</span><span class="params">(V newValue)</span> </span>&#123;</span><br><span class="line">        V oldValue = value;</span><br><span class="line">        value = newValue;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">this</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map.Entry) &#123;</span><br><span class="line">            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;</span><br><span class="line">            <span class="keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;</span><br><span class="line">                Objects.equals(value, e.getValue()))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªå•é“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå°±æ˜¯è¯´<code>table</code>æ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„<code>Node</code>èŠ‚ç‚¹ï¼Œè€Œè¿™æ¯ä¸€ä¸ª<code>Node</code>èŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œå½“æ²¡æœ‰å‘ç”Ÿå“ˆå¸Œå†²çªæ—¶ï¼Œé“¾è¡¨é•¿åº¦ä¸º<code>1</code>ã€‚</p><h2 id="é™æ€å˜é‡"><a href="#é™æ€å˜é‡" class="headerlink" title="é™æ€å˜é‡"></a>é™æ€å˜é‡</h2><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€äº›ä¸»è¦çš„é™æ€å˜é‡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é»˜è®¤çš„åˆå§‹å®¹é‡-å¿…é¡»ä¸º2çš„æ•´æ•°å¹‚</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">4</span>; <span class="comment">// aka 16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€å¤§å®¹é‡</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAXIMUM_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤åŠ è½½å› å­</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="number">0.75f</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»é“¾è¡¨è½¬åŒ–æˆçº¢é»‘æ ‘çš„é˜€å€¼</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TREEIFY_THRESHOLD = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»çº¢é»‘æ ‘é€€åŒ–æˆé“¾è¡¨çš„é˜€å€¼</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> UNTREEIFY_THRESHOLD = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¦æ‰§è¡Œçº¢é»‘æ ‘åŒ–çš„æœ€å°æ•°ç»„å®¹é‡</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MIN_TREEIFY_CAPACITY = <span class="number">64</span>;</span><br></pre></td></tr></table></figure><h2 id="æœ‰å…³åŠ è½½å› å­loadFactorä¸ºä»€ä¹ˆæ˜¯0-75ï¼Ÿ"><a href="#æœ‰å…³åŠ è½½å› å­loadFactorä¸ºä»€ä¹ˆæ˜¯0-75ï¼Ÿ" class="headerlink" title="æœ‰å…³åŠ è½½å› å­loadFactorä¸ºä»€ä¹ˆæ˜¯0.75ï¼Ÿ"></a>æœ‰å…³åŠ è½½å› å­<code>loadFactor</code>ä¸ºä»€ä¹ˆæ˜¯<code>0.75</code>ï¼Ÿ</h2><p>è¿˜è®°å¾—æ–‡ç« å¼€å¤´çš„è§£ç­”å—ï¼Ÿè¿™æ˜¯ä¸€ä¸ªåŸºäºå®¹é‡å’Œæ€§èƒ½è€ƒè™‘çš„æŠ˜è¡·å€¼ã€‚å¦‚æœåŠ è½½å› å­è®¾ç½®è¿‡å¤§ï¼Œå¸¦æ¥çš„å¥½å¤„æ˜¯æ‰©å®¹çš„é—¨æ§›æé«˜ï¼ŒèŠ‚çº¦äº†å†…å­˜ç©ºé—´ï¼Œä½†å‡ºç°å“ˆå¸Œå†²çªçš„å‡ ç‡ä¼šå˜å¤§ï¼Œä»è€Œå¯¼è‡´å¯¹å…ƒç´ çš„æ“ä½œæ€§èƒ½ä¸‹é™ï¼›å¦‚æœåŠ è½½å› å­è®¾ç½®è¿‡å°ï¼Œå¸¦æ¥çš„å¥½å¤„æ˜¯æ‰©å®¹é—¨æ§›é™ä½ï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„å…ƒç´ ä¼šæ¯”è¾ƒç¨€ç–ï¼Œä¸æ˜“å‡ºç°å“ˆå¸Œå†²çªï¼Œå¯¹å…ƒç´ çš„æ“ä½œæ€§èƒ½è¾ƒé«˜ã€‚ä½†ä¼šå­˜åœ¨ä¸€å®šçš„ç©ºé—´æµªè´¹ã€‚äºæ˜¯æŠ˜è¡·è€ƒè™‘é€‰æ‹©äº†<code>0.75</code>ã€‚</p><p>å…¶å®è¿™ä¸ªç­”æ¡ˆå·²ç»å¾ˆèƒ½è¯´æ˜åŸå› äº†ï¼Œä½†æœ‰äº›é¢è¯•å®˜å°±æ˜¯çº ç»“è¿™ä¸ªæ•°å€¼ä¸ºä»€ä¹ˆæ˜¯<code>0.75</code>ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯<code>0.74</code>æˆ–è€…<code>0.76</code>ç­‰ã€‚ä¸‹é¢æˆ‘ä»¬å°è¯•ç”¨ä¸€ç§å…«è‚¡æ–‡æ¥å¯¹æŠ—é¢è¯•å®˜ï¼š</p><p>ä¸ºä»€ä¹ˆåŠ è½½å› å­æ˜¯<code>0.75</code>å‘¢ï¼Ÿ</p><p>ç†è®ºï¼šé€šè¿‡é¢„æµ‹å­˜å‚¨æ¡¶æ˜¯å¦ä¸ºç©ºï¼Œå¯ä»¥é¿å…é“¾æ¥å¹¶åˆ©ç”¨åˆ†æ”¯é¢„æµ‹ã€‚å¦‚æœå­˜å‚¨æ¡¶ä¸ºç©ºçš„å¯èƒ½æ€§è¶…è¿‡<code>0.5</code>ï¼Œåˆ™è¯¥å­˜å‚¨æ¡¶å¯èƒ½ä¸ºç©ºã€‚</p><p>è¯æ˜ï¼š<code>s</code>ä»£è¡¨å¤§å°ï¼Œ<code>n</code>ä»£è¡¨å¢åŠ çš„é”®æ•°ã€‚æ ¹æ®ç‰›é¡¿äºŒé¡¹å¼å®šç†ï¼Œå­˜å‚¨æ¡¶ä¸ºç©ºçš„æ¦‚ç‡ä¸ºï¼š</p><p><code>P(0) = C(n, 0) * (1/s)^0 * (1 - 1/s)^(n - 0)</code></p><p>å› æ­¤ï¼Œå¦‚æœå°‘äº<code>log(2)/log(s/(s - 1))</code>ä¸ªé”®ï¼Œå½“<code>s</code>è¾¾åˆ°æ— ç©·å¤§æ—¶å¹¶ä¸”å¦‚æœæ·»åŠ çš„é”®æ•°ä½¿å¾—<code>P(0) = 0.5</code>æ—¶ï¼Œåˆ™<code>n/s</code>è¿…é€Ÿæ¥è¿‘<code>log(2)</code>ã€‚</p><p><code>log(2)</code>çº¦ç­‰äº<code>0.693</code>ã€‚</p><p>ç»“è®ºï¼š<code>log(2)</code>ä¸æ˜¯çº¦ç­‰äº<code>0.693</code>å—ï¼Ÿä¸ºä»€ä¹ˆä¼šé€‰æ‹©<code>0.75</code>å‘¢ï¼Ÿå› ä¸ºé˜€å€¼éœ€è¦ä¸€ä¸ªæ•´æ•°ï¼Œé»˜è®¤åˆå§‹å®¹é‡æ˜¯<code>16</code>ï¼Œå½“åŠ è½½å› å­ç­‰äº<code>0.75</code>æ—¶ä¹˜ç§¯æ‰ä¸ºæ•´æ•°ã€‚<code>0.70/0.71/0.72/0.73/0.74...</code>ç­‰ç­‰ï¼Œåªæœ‰<code>0.75</code>çš„ä¹˜ç§¯æ‰æ˜¯æ•´æ•°ã€‚</p><p>ä»¥ä¸Šç†è®ºåŠè¯æ˜è¿‡ç¨‹æ¥è‡ª <a href="https://stackoverflow.com/questions/10901752/what-is-the-significance-of-load-factor-in-hashmap">stackoverflow.com</a></p><p>æ‰€ä»¥é—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆé»˜è®¤åˆå§‹å®¹é‡æ˜¯<code>16</code>å‘¢ï¼Ÿè¿™â€¦ï¼Œå»ºè®®å‡†å¤‡é¢ä¸‹ä¸€å®¶å…¬å¸äº†â€¦</p><h2 id="æˆå‘˜å˜é‡"><a href="#æˆå‘˜å˜é‡" class="headerlink" title="æˆå‘˜å˜é‡"></a>æˆå‘˜å˜é‡</h2><p>é™¤äº†å­˜å‚¨å…ƒç´ çš„<code>table</code>æ•°ç»„ï¼Œè¿˜æœ‰ä»¥ä¸‹å…¶å®ƒæˆå‘˜å˜é‡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Setç¼“å­˜ï¼Œå¯ç”¨äºè¿­ä»£å™¨</span></span><br><span class="line"><span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span><br><span class="line"></span><br><span class="line"><span class="comment">// mapå…ƒç´ ä¸ªæ•°</span></span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line"><span class="comment">// mapä¿®æ”¹æ¬¡æ•°ï¼Œç”¨æ¥å®ç°fail-fastæœºåˆ¶</span></span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> modCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é˜€å€¼ï¼Œå½“size&gt;thresholdæ—¶ä¼šè§¦å‘æ‰©å®¹</span></span><br><span class="line"><span class="keyword">int</span> threshold;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ è½½å› å­</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">float</span> loadFactor;</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•æ„é€ HashMapå¯¹è±¡ï¼Ÿ"><a href="#å¦‚ä½•æ„é€ HashMapå¯¹è±¡ï¼Ÿ" class="headerlink" title="å¦‚ä½•æ„é€ HashMapå¯¹è±¡ï¼Ÿ"></a>å¦‚ä½•æ„é€ <code>HashMap</code>å¯¹è±¡ï¼Ÿ</h2><p>ä¸€å…±æœ‰å››ä¸ªæ„é€ å™¨ï¼Œä½†æˆ‘ä»¬å¸¸ç”¨çš„åªæœ‰ä¸¤ä¸ªï¼šæ— å‚æ„é€ å™¨å’ŒæŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å™¨ï¼Œå†…éƒ¨è°ƒç”¨å¸¦ä¸¤ä¸ªå‚æ•°çš„æ„é€ å™¨ï¼Œä¼ å…¥é»˜è®¤åŠ è½½å› å­DEFAULT_LOAD_FACTOR=0.75f</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ— å‚æ„é€ å™¨ï¼Œä½¿ç”¨é»˜è®¤çš„åˆå§‹å®¹é‡ï¼š16ï¼Œé»˜è®¤çš„åŠ è½½å› å­ï¼š0.75f</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// all other fields defaulted</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬åœ¨å¼€å‘æ—¶ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æå‰é¢„ä¼°å‡ºæ•°æ®é‡ï¼Œå»ºè®®è°ƒç”¨æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å™¨æ¥åˆ›å»ºä¸€ä¸ªåˆé€‚å®¹é‡çš„<code>HashMap</code>ï¼›å¦‚æœæ— æ³•é¢„ä¼°ï¼Œæœ€å¥½ä½¿ç”¨æ— å‚æ„é€ å™¨ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹æŒ‡å®šåˆå§‹å®¹é‡å’ŒæŒ‡å®šåŠ è½½å› å­çš„æ„é€ å™¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®¹é‡è´Ÿå€¼æ ¡éªŒ</span></span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Illegal initial capacity: &quot;</span> +</span><br><span class="line">                                           initialCapacity);</span><br><span class="line">    <span class="comment">// å®¹é‡æœ€å¤§å€¼æ ¡éªŒ</span></span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">        initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">    <span class="comment">// åŠ è½½å› å­åˆæ³•æ€§æ ¡éªŒ</span></span><br><span class="line">    <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Illegal load factor: &quot;</span> +</span><br><span class="line">                                           loadFactor);</span><br><span class="line">    <span class="comment">// èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">this</span>.loadFactor = loadFactor;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–é˜€å€¼ä¸ºåˆè¯†å®¹é‡ï¼ˆæ­¤å¤„åªæ˜¯è¿›è¡Œé¢„åˆå§‹åŒ–ï¼Œåç»­è°ƒç”¨resizeæ–¹æ³•æ—¶ä¼šè¿›è¡Œå‡†ç¡®èµ‹å€¼ï¼‰</span></span><br><span class="line">    <span class="keyword">this</span>.threshold = tableSizeFor(initialCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–èµ‹å€¼çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šå°†é˜€å€¼<code>threshold</code>è®¾ç½®ä¸º<code>initialCapacity * loadFactor</code>ï¼Œè€Œæ˜¯é¢„åˆå§‹åŒ–æˆåˆå§‹å®¹é‡ï¼Œæ­¤å¤„ä¼šè°ƒç”¨<code>tableSizeFor</code>æ–¹æ³•å¾—åˆ°ä¸€ä¸ªå¤§äºç­‰äº<code>initialCapacity</code>ä¸”æœ€è¿‘çš„<code>2</code>çš„æ•´æ•°æ¬¡å¹‚çš„æ•°ï¼Œç„¶åèµ‹å€¼ç»™<code>threshold</code>ï¼Œåç»­ç¬¬ä¸€æ¬¡è°ƒç”¨<code>put</code>æ–¹æ³•è¿›è¡Œæ’å…¥æ—¶ä¼šè¿›è¡Œé¦–æ¬¡æ‰©å®¹ï¼Œè°ƒç”¨<code>resize</code>æ–¹æ³•å¯¹<code>threshold</code>è¿›è¡Œå‡†ç¡®èµ‹å€¼ã€‚</p><h2 id="tableSizeForæ–¹æ³•åŸç†"><a href="#tableSizeForæ–¹æ³•åŸç†" class="headerlink" title="tableSizeForæ–¹æ³•åŸç†"></a><code>tableSizeFor</code>æ–¹æ³•åŸç†</h2><p><code>tableSizeFor</code>æ–¹æ³•æ˜¯å¾—åˆ°ä¸€ä¸ªå¤§äºç­‰äº<code>initialCapacity</code>ä¸”æœ€è¿‘çš„<code>2</code>çš„æ•´æ•°æ¬¡å¹‚çš„æ•°ã€‚æˆ‘ä»¬æ¥çœ‹<code>JDK8</code>æ˜¯å¦‚ä½•è¿›è¡Œå·§å¦™å®ç°çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">tableSizeFor</span><span class="params">(<span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = cap - <span class="number">1</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">2</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">4</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">8</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> (n &lt; <span class="number">0</span>) ? <span class="number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ä½è¿ç®—ç¬¦å·<code>&gt;&gt;&gt;</code>è¡¨ç¤ºæ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥<code>0</code>è¡¥é½ã€‚</p><p>å‡è®¾<code>cap = 10</code>ï¼Œé‚£ä¹ˆ<code>n = 9</code>ã€‚</p><p>æ‰§è¡Œ<code>n != n &gt;&gt;&gt; 1</code>å³<code>n = 9 | (9 &gt;&gt;&gt; 1)</code>çš„æ­¥éª¤æ˜¯ï¼š</p><ul><li><code>9</code>çš„äºŒè¿›åˆ¶æ˜¯<code>1001</code>ï¼›</li><li><code>9 &gt;&gt;&gt; 1</code>å³ï¼š<code>1001 &gt;&gt;&gt; 1 = 0100</code>ï¼›</li><li><code>9 | (9 &gt;&gt;&gt; 1) = 1001 | 0100 = 1101</code>ã€‚</li></ul><p>æ¥ä¸‹æ¥ä¾æ¬¡æ‰§è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n |&#x3D; n &gt;&gt;&gt; 2;</span><br><span class="line">n |&#x3D; n &gt;&gt;&gt; 4;</span><br><span class="line">n |&#x3D; n &gt;&gt;&gt; 8;</span><br><span class="line">n |&#x3D; n &gt;&gt;&gt; 16;</span><br></pre></td></tr></table></figure><p>è¿‡ç¨‹åˆ†åˆ«ä¸ºï¼š</p><p><code>n |= n &gt;&gt;&gt; 2;</code>ï¼Œæ­¤æ—¶<code>n = 1101</code>ï¼Œå³ï¼š<code>n = 1101 | (1101 &gt;&gt;&gt; 2) = 1101 | 0011 = 1111</code>ï¼›</p><p><code>n |= n &gt;&gt;&gt; 4;</code>ï¼Œæ­¤æ—¶<code>n = 1111</code>ï¼Œå³ï¼š<code>n = 1111 | (1111 &gt;&gt;&gt; 4) = 1111 | 0000 = 1111</code>ï¼›</p><p><code>n |= n &gt;&gt;&gt; 8;</code>ï¼Œæ­¤æ—¶<code>n = 1111</code>ï¼Œå³ï¼š<code>n = 1111 | (1111 &gt;&gt;&gt; 8) = 1111 | 0000 = 1111</code>ï¼›</p><p><code>n |= n &gt;&gt;&gt; 16;</code>ï¼Œæ­¤æ—¶<code>n = 1111</code>ï¼Œå³ï¼š<code>n = 1111 | (1111 &gt;&gt;&gt; 16) = 1111 | 0000 = 1111</code>ï¼›</p><p>æœ€åçš„ç»“æœä¸ºï¼š<code>n = 1111</code>ï¼Œè½¬æ¢æˆåè¿›åˆ¶ç­‰äº<code>15</code>ï¼Œ<code>return</code>è¯­å¥ä¸­è¿›è¡Œä¸‰ç›®åˆ¤æ–­ï¼Œæœ€åè¿”å›çš„å€¼ä¸ºï¼š<code>n + 1 = 16</code>ã€‚</p><h2 id="å¦‚ä½•æ’å…¥å…ƒç´ ï¼Ÿ"><a href="#å¦‚ä½•æ’å…¥å…ƒç´ ï¼Ÿ" class="headerlink" title="å¦‚ä½•æ’å…¥å…ƒç´ ï¼Ÿ"></a>å¦‚ä½•æ’å…¥å…ƒç´ ï¼Ÿ</h2><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹<code>put</code>æ–¹æ³•çš„å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è®¡ç®—hashå€¼ï¼Œè°ƒç”¨putValæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent, <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å±€éƒ¨å˜é‡tabç”¨äºæ¥æ”¶æˆå‘˜å˜é‡table</span></span><br><span class="line">    Node&lt;K,V&gt;[] tab;</span><br><span class="line">    Node&lt;K,V&gt; p;</span><br><span class="line">    <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// å¦‚æœtableæ•°ç»„ä¸­æ— å…ƒç´ ï¼Œåˆ™è°ƒç”¨resize()æ‰©å®¹å¾—åˆ°ä¸€ä¸ªæ–°çš„Node&lt;K,V&gt;[]æ•°ç»„å¹¶èµ‹å€¼ç»™tabï¼Œç„¶åå¾—åˆ°æ–°æ•°ç»„çš„é•¿åº¦ä¸ºnã€‚</span></span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    <span class="comment">// æ ¹æ®hashå€¼è®¡ç®—å¾…æ’å…¥å…ƒç´ çš„æ•°ç»„ä¸‹æ ‡ç´¢å¼•iï¼ˆå¯¹2å–æ¨¡å¯è½¬åŒ–æˆä½è¿ç®—ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">// å¦‚æœiä½ç½®æ— å…ƒç´ ï¼Œåˆ™ç›´æ¥åˆ›å»ºNodeèŠ‚ç‚¹è¿›è¡Œèµ‹å€¼æ’å…¥</span></span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// iä½ç½®æœ‰å…ƒç´ ï¼Œè¯´æ˜å‡ºç°äº†å“ˆå¸Œå†²çª</span></span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">            ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="comment">// é”®keyç›¸ç­‰åˆ™ç›´æ¥è¿›è¡Œå€¼è¦†ç›–</span></span><br><span class="line">            e = p;</span><br><span class="line">        <span class="comment">// å¾…æ’å…¥çš„é”®ä¸ç­‰äºä¸‹æ ‡iå¤„å­˜å‚¨çš„å¤´èŠ‚ç‚¹çš„é”®</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            <span class="comment">// åˆ¤æ–­ä¸ºçº¢é»‘æ ‘èŠ‚ç‚¹ï¼Œåˆ™æ‰§è¡Œçº¢é»‘æ ‘çš„æ’å…¥é€»è¾‘</span></span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦åˆ™ä¸ºé“¾è¡¨ç»“æ„ï¼Œè¿›è¡Œéå†ï¼ŒbinCountç”¨æ¥ç»Ÿè®¡é“¾è¡¨é•¿åº¦</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                <span class="comment">// å¯¹eè¿›è¡Œèµ‹å€¼</span></span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// éå†åˆ°å°¾èŠ‚ç‚¹äº†ï¼Œe = null</span></span><br><span class="line">                    <span class="comment">// å°¾æ’æ³•æ’å…¥æ–°å…ƒç´ </span></span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                    <span class="comment">// åˆ¤æ–­é“¾è¡¨é•¿åº¦binCount &gt;= 7</span></span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        <span class="comment">// æ­¤æ¬¡å¾ªç¯æ˜¯ç¬¬8æ¬¡ï¼ŒbinCount=7ï¼Œå°¾æ’æ³•æ’å…¥æ–°å…ƒç´ åé“¾è¡¨é•¿åº¦ä¸º8ï¼Œè°ƒç”¨treeifyBinå°è¯•è½¬æ¢æˆçº¢é»‘æ ‘</span></span><br><span class="line">                        <span class="comment">// åœ¨treeifyBinæ–¹æ³•ä¸­ï¼Œä¼šé¦–å…ˆåˆ¤æ–­tabæ•°ç»„çš„é•¿åº¦æ˜¯å¦å°äºMIN_TREEIFY_CAPACITY=64ï¼Œå¦‚æœå°äºï¼Œåˆ™è¿›è¡Œresizeæ‰©å®¹ç»“æŸï¼›å¦åˆ™æ‰§è¡Œæ ‘åŒ–é€»è¾‘ã€‚</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="comment">// æ‰¾åˆ°äº†é”®keyç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œç»“æŸå¾ªç¯ã€‚e = p.next</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">// æœªæ‰¾åˆ°keyç›¸ç­‰çš„èŠ‚ç‚¹æˆ–æœªéå†åˆ°å°¾éƒ¨ï¼Œæ­¤æ—¶e = p.nextï¼Œæ¨åŠ¨é“¾è¡¨çš„éå†ã€‚</span></span><br><span class="line">                p = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä¸Šé¢çš„åˆ¤æ–­ä¸­eçš„å€¼ä¸ä¸ºnullçš„æƒ…å†µï¼šå³é“¾è¡¨ä¸­æ‰¾åˆ°äº†keyç›¸ç­‰çš„èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">            <span class="comment">// è¿›è¡Œå€¼valueçš„è¦†ç›–</span></span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                e.value = value;</span><br><span class="line">            <span class="comment">// å›è°ƒé’©å­ï¼Œå­ç±»LinkedHashMapè¿›è¡Œäº†é‡å†™</span></span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="comment">// è¿”å›æ—§å€¼</span></span><br><span class="line">            <span class="keyword">return</span> oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°åŠ ä¸€</span></span><br><span class="line">    ++modCount;</span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">        <span class="comment">// å®¹é‡è¾¾åˆ°é˜€å€¼è¿›è¡Œæ‰©å®¹</span></span><br><span class="line">        resize();</span><br><span class="line">    <span class="comment">// å›è°ƒé’©å­</span></span><br><span class="line">    afterNodeInsertion(evict);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•´ä¸ª<code>put</code>æ–¹æ³•çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/jdk/hashmap_put.png" alt="HashMapçš„putè¿‡ç¨‹"></p><h2 id="å¦‚ä½•ä¼˜é›…åœ°è¿›è¡Œæ‰©å®¹ï¼Ÿ"><a href="#å¦‚ä½•ä¼˜é›…åœ°è¿›è¡Œæ‰©å®¹ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¼˜é›…åœ°è¿›è¡Œæ‰©å®¹ï¼Ÿ"></a>å¦‚ä½•ä¼˜é›…åœ°è¿›è¡Œæ‰©å®¹ï¼Ÿ</h2><p>å‡ºç°æ‰©å®¹çš„æƒ…å†µæœ‰ä¸‰ç§ï¼š</p><ol><li>å“ˆå¸Œè¡¨ä¸ºç©ºä¸”ç¬¬ä¸€æ¬¡æ‰§è¡Œ<code>put</code>æ–¹æ³•æ—¶ï¼Œä¼šå…ˆè¿›è¡Œæ‰©å®¹å†å­˜å‚¨å…ƒç´ ã€‚</li><li>å½“å‡ºç°å“ˆå¸Œå†²çªï¼Œæ‰§è¡Œå°¾æ’æ³•æ’å…¥å…ƒç´ åï¼Œå¦‚æœé“¾è¡¨é•¿åº¦å¤§äº<code>8</code>ï¼Œä¸”æ•°ç»„é•¿åº¦å°äº<code>MIN_TREEIFY_CAPACITY=64</code>ï¼Œæ‰§è¡Œæ‰©å®¹é€»è¾‘ã€‚</li><li>æ–°æ’å…¥ä¸€ä¸ªé”®åï¼ˆå…ƒç´ ç›´æ¥æ’å…¥ã€å“ˆå¸Œå†²çªé“¾è¡¨å°¾æ’ã€çº¢é»‘æ ‘æ’å…¥ï¼‰ï¼Œ<code>++size &gt; threshold</code>å®¹é‡è¾¾åˆ°é˜€å€¼ï¼Œæ‰§è¡Œæ‰©å®¹é€»è¾‘ã€‚</li></ol><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹æ‰©å®¹<code>resize</code>çš„é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨oldTabæ¥æ”¶æ—§çš„æ•°ç»„table</span></span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">    <span class="comment">// å¦‚æœoldTabä¸ºnullå¼•ç”¨ï¼Œè¯´æ˜æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨putæ–¹æ³•æ—¶è¿›è¡Œçš„æ‰©å®¹ï¼Œåˆ™oldCapæ—§å®¹é‡ä¸º0ï¼›å¦åˆ™ä¸ºæ—§æ•°ç»„é•¿åº¦ã€‚</span></span><br><span class="line">    <span class="keyword">int</span> oldCap = (oldTab == <span class="keyword">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">    <span class="comment">// æ—§é˜€å€¼</span></span><br><span class="line">    <span class="keyword">int</span> oldThr = threshold;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ–°å®¹é‡å’Œæ–°é˜€å€¼ï¼ˆæ‰©å®¹ä¹‹åçš„ï¼‰</span></span><br><span class="line">    <span class="keyword">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// æ—§å®¹é‡å¤§äº0ï¼Œåˆ™åŸæ•°ç»„æœ‰å…ƒç´ ï¼Œä¸æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨put</span></span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            <span class="comment">// æ—§å®¹é‡è¶…è¿‡æœ€å¤§å®¹é‡ï¼Œå·²æ— æ³•è¿›è¡Œæ‰©å®¹</span></span><br><span class="line">            <span class="comment">// è®¾ç½®é˜€å€¼ä¸ºæœ€å¤§æ•´å‹æ•°å€¼</span></span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="comment">// è¿”å›æ—§æ•°ç»„</span></span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è®¡ç®—æ–°å®¹é‡ï¼šoldCapçš„ä¸¤å€</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            <span class="comment">// æ–°å®¹é‡å°äºæœ€å¤§å®¹é‡ï¼Œä¸”æ—§å®¹é‡å¤§äºç­‰äºé»˜è®¤åˆå§‹å®¹é‡ï¼Œåˆ™é˜€å€¼ä¹Ÿä¸ºåŸæ¥çš„ä¸¤å€</span></span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ—§é˜€å€¼å¤§äº0ï¼Œè¯´æ˜æ˜¯è°ƒç”¨å¸¦å‚æ„é€ å™¨åˆ›å»ºçš„HashMapï¼Œä¸”æ­¤æ—¶æ—§é˜€å€¼ç­‰äºå¸¦å‚æ„é€ å™¨ä¸­æŒ‡å®šçš„åˆå§‹å®¹é‡</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">        <span class="comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨putæ‰ä¼šèµ°åˆ°è¿™ä¸ªifåˆ†æ”¯</span></span><br><span class="line">        <span class="comment">// æ–°å®¹é‡ç­‰äºå¸¦å‚æ„é€ å™¨ä¸­æŒ‡å®šçš„å®¹é‡</span></span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">        <span class="comment">// å…¶å®ƒæƒ…å†µï¼šè°ƒç”¨æ— å‚æ„é€ å™¨åˆ›å»ºçš„HashMap</span></span><br><span class="line">        <span class="comment">// æ–°å®¹é‡ä¸ºï¼šé»˜è®¤åˆå§‹å®¹é‡</span></span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">        <span class="comment">// æ–°é˜€å€¼ä¸ºï¼šé»˜è®¤åŠ è½½å› å­ * é»˜è®¤åˆå§‹å®¹é‡</span></span><br><span class="line">        newThr = (<span class="keyword">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨putæ—¶ï¼Œèµ°çš„ä¸Šé¢çš„else if (oldThr &gt; 0)åˆ†æ”¯ï¼Œæ–°é˜€å€¼æœªè¿›è¡Œèµ‹å€¼ï¼Œæ‰€ä»¥ç­‰äº0</span></span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// è®¡ç®—æ–°é˜€å€¼ï¼šæ–°å®¹é‡ * åŠ è½½å› å­</span></span><br><span class="line">        <span class="keyword">float</span> ft = (<span class="keyword">float</span>)newCap * loadFactor;</span><br><span class="line">        <span class="comment">// èŒƒå›´æ§åˆ¶ï¼Œè½¬æ¢æˆint</span></span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="keyword">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è®¾ç½®é˜€å€¼</span></span><br><span class="line">    threshold = newThr;</span><br><span class="line">    <span class="comment">// å¼€è¾Ÿæ–°å®¹é‡é•¿åº¦çš„æ•°ç»„ç©ºé—´</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> Node[newCap];</span><br><span class="line">    <span class="comment">// tableå¼•ç”¨æŒ‡å‘æ–°æ•°ç»„</span></span><br><span class="line">    table = newTab;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨putæ—¶æ‰§è¡Œï¼ŒoldTabä¸ºnullã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (oldTab != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// éé¦–æ¬¡putæ–¹æ³•ï¼ŒåŸtableæ•°ç»„ä¸­å­˜åœ¨å…ƒç´ ï¼Œæ‰§è¡Œrehash</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            <span class="comment">// éå†æ—§tableæ•°ç»„</span></span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            <span class="keyword">if</span> ((e = oldTab[j]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// é‡Šæ”¾æ—§tableçš„å¼•ç”¨ help gc</span></span><br><span class="line">                oldTab[j] = <span class="keyword">null</span>;</span><br><span class="line">                <span class="comment">// æ— å“ˆå¸Œå†²çª</span></span><br><span class="line">                <span class="keyword">if</span> (e.next == <span class="keyword">null</span>)</span><br><span class="line">                    <span class="comment">// æ–°æ•°ç»„newTabèµ‹å€¼</span></span><br><span class="line">                    <span class="comment">// newCapä¸º2çš„æ•´æ•°å¹‚ï¼Œhash &amp; 2^n - 1 å³å¯¹2å–æ¨¡ï¼Œæ±‚å‡ºæ•°ç»„ä¸‹æ ‡ã€‚</span></span><br><span class="line">                    newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    <span class="comment">// çº¢é»‘æ ‘é€»è¾‘</span></span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(<span class="keyword">this</span>, newTab, j, oldCap);</span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="comment">// preserve order</span></span><br><span class="line">                    <span class="comment">// å“ˆå¸Œå†²çªï¼Œæœ‰é“¾è¡¨ï¼Œå°†æ•´ä¸ªé“¾è¡¨åˆ†éš”æˆä¸¤ä¸ªéƒ¨åˆ†</span></span><br><span class="line">                    <span class="comment">// loHead/loTailé“¾æ¥å‡ºä¸€ä¸ªä¸éœ€è¦ç§»åŠ¨ä½ç½®çš„é“¾è¡¨</span></span><br><span class="line">                    Node&lt;K,V&gt; loHead = <span class="keyword">null</span>, loTail = <span class="keyword">null</span>;</span><br><span class="line">                    <span class="comment">// hiHead/hiTailé“¾æ¥å‡ºä¸€ä¸ªéœ€è¦ç§»åŠ¨ä½ç½®çš„é“¾è¡¨</span></span><br><span class="line">                    Node&lt;K,V&gt; hiHead = <span class="keyword">null</span>, hiTail = <span class="keyword">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        next = e.next;</span><br><span class="line">                        <span class="comment">// å“ˆå¸Œç  &amp; æ—§å®¹é‡</span></span><br><span class="line">                        <span class="comment">// ç»“æœä¸º0ï¼Œè¡¨ç¤ºè¯¥å…ƒç´ çš„ä¸‹æ ‡ç´¢å¼•å€¼åœ¨æ‰©å®¹åä¸ä¼šå‘ç”Ÿå˜åŒ–</span></span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="comment">// é“¾æ¥åŸé“¾è¡¨æ¯ä¸€ä¸ªå…ƒç´ è‡³loHeadå¤´èŠ‚ç‚¹</span></span><br><span class="line">                            <span class="comment">// ç¬¬ä¸€æ¬¡æ‰§è¡Œdo-whileå¾ªç¯</span></span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="keyword">null</span>)</span><br><span class="line">                                <span class="comment">// èµ‹å€¼loHeadå¤´èŠ‚ç‚¹</span></span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                <span class="comment">// éç¬¬ä¸€æ¬¡æ‰§è¡Œdo-while</span></span><br><span class="line">                                <span class="comment">// é“¾æ¥è‡³loTail</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            <span class="comment">// å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æ‰§è¡Œdo-whileï¼Œåˆ™loTail=loHeadæŒ‡å‘å¤´èŠ‚ç‚¹</span></span><br><span class="line">                            <span class="comment">// å¦åˆ™è¡¨ç¤ºloTailå³ç§»ä¸€ä½</span></span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// å¦åˆ™ï¼Œç»“æœä¸ä¸º0ï¼Œåˆ™è¯¥å…ƒç´ çš„ä¸‹æ ‡ç´¢å¼•å€¼åœ¨æ‰©å®¹åä¼šæ”¹å˜</span></span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="comment">// åŒæ ·åœ°é“¾æ¥é€»è¾‘</span></span><br><span class="line">                            <span class="comment">// ç¬¬ä¸€æ¬¡æ‰§è¡Œdo-whileå¾ªç¯</span></span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="keyword">null</span>)</span><br><span class="line">                                <span class="comment">// èµ‹å€¼hiHeadå¤´èŠ‚ç‚¹</span></span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                <span class="comment">// éç¬¬ä¸€æ¬¡æ‰§è¡Œdo-while</span></span><br><span class="line">                                <span class="comment">// é“¾æ¥è‡³hiTail</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            <span class="comment">// å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æ‰§è¡Œdo-whileï¼Œåˆ™hiTail=hiHeadæŒ‡å‘å¤´èŠ‚ç‚¹</span></span><br><span class="line">                            <span class="comment">// å¦åˆ™è¡¨ç¤ºhiTailå³ç§»ä¸€ä½</span></span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="keyword">null</span>);</span><br><span class="line">                    <span class="comment">// æ‰§è¡Œå®Œdo-whileå¾ªç¯åï¼ŒloTailå’ŒhiTailéƒ½æŒ‡å‘å‡ºç°å“ˆå¸Œå†²çªçš„åŸé“¾è¡¨çš„å°¾éƒ¨</span></span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        loTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        <span class="comment">// ä¸‹æ ‡ç´¢å¼•ä¸éœ€è¦ç§»åŠ¨ï¼Œé“¾è¡¨loHeadæ•´ä½“ç§»åŠ¨</span></span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        hiTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        <span class="comment">// ä¸‹æ ‡ç´¢å¼•éœ€è¦ç§»åŠ¨åˆ°j + oldCapä½ç½®ï¼Œé“¾è¡¨hiHeadæ•´ä½“ç§»åŠ¨</span></span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›æ‰©å®¹åçš„æ–°tableæ•°ç»„</span></span><br><span class="line">    <span class="keyword">return</span> newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åœ¨æœ‰å“ˆå¸Œå†²çªæ—¶ï¼Œå¯¹é“¾è¡¨ä¸­çš„å…ƒç´ å¹¶æ²¡æœ‰è¿›è¡Œ<code>rehash</code>æ“ä½œï¼Œè€Œæ˜¯å°†å†²çªçš„é“¾è¡¨åˆ†éš”ä¸ºä¸¤ä¸ªé“¾è¡¨ï¼Œé€šè¿‡è®¡ç®—<code>e.hash &amp; oldCap</code>ï¼Œå¦‚æœç»“æœçš„é«˜ä¸€ä½ä¸º<code>0</code>ï¼Œåˆ™è¡¨ç¤ºè¯¥é“¾è¡¨èŠ‚ç‚¹ä¸éœ€è¦ç§»åŠ¨ä½ç½®ï¼Œé“¾æ¥è‡³<code>loHead</code>èŠ‚ç‚¹ï¼›å¦‚æœç»“æœçš„é«˜ä¸€ä½ä¸º<code>1</code>ï¼Œåˆ™è¡¨ç¤ºè¯¥é“¾è¡¨èŠ‚ç‚¹éœ€è¦ç§»åŠ¨ä½ç½®ï¼Œé“¾æ¥è‡³<code>hiHead</code>èŠ‚ç‚¹ã€‚<code>do-while</code>å¾ªç¯ç»“æŸåï¼Œä»¥<code>loHead</code>èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹çš„é“¾è¡¨ä¸éœ€è¦ç§»åŠ¨æ•°ç»„ä¸‹æ ‡ï¼›è€Œä»¥<code>hiHead</code>èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹çš„é“¾è¡¨éœ€è¦å‘å³ç§»åŠ¨æ—§å®¹é‡<code>oldCap</code>ä¸ªä½ç½®ã€‚åŸé“¾è¡¨å„èŠ‚ç‚¹ä¹‹é—´çš„ç›¸å¯¹ä½ç½®æœªå‘ç”Ÿæ”¹å˜ã€‚</p><h2 id="å¦‚ä½•è·å–å…ƒç´ ï¼Ÿ"><a href="#å¦‚ä½•è·å–å…ƒç´ ï¼Ÿ" class="headerlink" title="å¦‚ä½•è·å–å…ƒç´ ï¼Ÿ"></a>å¦‚ä½•è·å–å…ƒç´ ï¼Ÿ</h2><p>ç›¸æ¯”äº<code>put</code>æ’å…¥ï¼Œ<code>get</code>è·å–å…ƒç´ çš„é€»è¾‘å°±ç›¸å¯¹ç®€å•äº†ã€‚æ­£å¸¸ä»<code>HashMap</code>ä¸­è·å–å…ƒç´ çš„æœ€å¥½æ—¶é—´å¤æ‚åº¦æ˜¯å¸¸æ•°<code>O(1)</code>ã€‚åœ¨å“ˆå¸Œå†²çªçš„æƒ…å†µä¸‹ï¼šæœ€åæ—¶é—´å¤æ‚åº¦æ˜¯<code>O(n)</code>ï¼Œæœ€å¥½æ—¶é—´å¤æ‚åº¦æ˜¯<code>O(log n)</code>ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹<code>get</code>æ–¹æ³•çš„é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = getNode(hash(key), key)) == <span class="keyword">null</span> ? <span class="keyword">null</span> : e.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab;</span><br><span class="line">    Node&lt;K,V&gt; first, e;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    K k;</span><br><span class="line">    <span class="comment">//  tableæ•°ç»„å·²ç»åˆå§‹åŒ–ï¼Œä¸”æ•°ç»„ä¸­æœ‰å…ƒç´ ï¼Œä¸”keyæ‰€åœ¨ä¸‹æ ‡ç´¢å¼•ä½ç½®æœ‰å…ƒç´ </span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash &amp;&amp; <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="comment">// ç¬¬ä¸€ä¸ªkeyç›¸ç­‰ï¼Œç›´æ¥è¿”å›è¯¥èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="comment">// keyåœ¨åé¢çš„é“¾è¡¨ï¼ˆçº¢é»‘æ ‘ï¼‰èŠ‚ç‚¹ä¸­</span></span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="comment">// æ‰§è¡Œçº¢é»‘æ ‘çš„æŸ¥è¯¢é€»è¾‘ï¼Œæ—¶é—´å¤æ‚åº¦O(log n)</span></span><br><span class="line">                <span class="keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="comment">// éå†é“¾è¡¨æ‰¾åˆ°ç›¸ç­‰çš„keyï¼Œè¿”å›å¯¹åº”èŠ‚ç‚¹ã€‚</span></span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºåœ¨<code>put</code>æ’å…¥çš„æ—¶å€™è®¡ç®—ä¸‹æ ‡çš„æ–¹å¼ä¸º<code>(n - 1) &amp; hash</code>ï¼Œæ‰€ä»¥<code>get</code>æŸ¥è¯¢çš„æ—¶å€™ä»¥åŒæ ·æ–¹å¼è®¡ç®—ä¸‹æ ‡ï¼Œå¦‚æœè¯¥ä¸‹æ ‡ä½ç½®æ— å…ƒç´ ï¼Œé‚£ä¹ˆå¾…æŸ¥è¯¢çš„<code>key</code>ä¸€å®šä¸åœ¨<code>HashMap</code>ä¸­ï¼Œç›´æ¥è¿”å›<code>null</code>ï¼›åä¹‹ï¼Œå¦‚æœè¯¥ä¸‹æ ‡ä½ç½®æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆåˆ™å¯»æ‰¾ä¸å¾…æŸ¥è¯¢çš„<code>key</code>ç›¸ç­‰çš„é”®ã€‚</p><p>å¦‚ä½•åˆ¤æ–­<code>key</code>ç›¸ç­‰ï¼Ÿ</p><p>åœ¨<code>HashMap</code>ä¸­ï¼Œæ‰€æœ‰åˆ¤æ–­<code>key</code>æ˜¯å¦ç›¸ç­‰çš„é€»è¾‘éƒ½æ˜¯ï¼šå…ˆæ¯”è¾ƒ<code>hashCode</code>æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ<code>equals</code>æ˜¯å¦ç›¸ç­‰ã€‚</p><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå»ºè®®åœ¨é‡å†™<code>equals</code>æ–¹æ³•çš„åŒæ—¶æœ€å¥½å»é‡å†™<code>hashCode</code>æ–¹æ³•çš„ä¸€ä¸ªåŸå› ã€‚</p><p>ä¸¤ä¸ª<code>key</code>å¦‚æœ<code>hashCode</code>ç›¸ç­‰ï¼Œ<code>equals</code>ä¸ä¸€å®šä¸ç­‰ã€‚</p><h2 id="çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ"><a href="#çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ" class="headerlink" title="çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ"></a>çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿ</h2><p>å¯¹äº<code>JDK7</code>ï¼Œåœ¨å¤šçº¿ç¨‹è¿›è¡Œæ‰©å®¹æ—¶ä¼šäº§ç”Ÿæ­»å¾ªç¯é—®é¢˜ï¼Œç”±äº<code>JDK7</code>å·²æˆä¸ºå†å²ï¼Œæœ¬æ–‡ä¸å†èµ˜è¿°ï¼Œå¯ä»¥å‚è€ƒç½‘ä¸Šçš„ä¸€äº›è§£é‡Šã€‚</p><p>è€Œå¯¹äº<code>JDK8</code>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¸Šæ–‡ä¸­åˆ†æçš„<code>put</code>æ’å…¥æ–¹æ³•ï¼Œé’ˆå¯¹ç¬¬äºŒä¸ª<code>if</code>æ¡ä»¶åˆ†æ”¯ï¼Œå¦‚æœæœªå‘ç”Ÿå“ˆå¸Œå†²çªï¼Œåˆ™åˆ›å»ºæ–°èŠ‚ç‚¹ç›´æ¥è¿›è¡Œèµ‹å€¼æ’å…¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">    tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç åœ¨<code>JDK8#HashMap.java</code>æºç ä¸­åˆ†åˆ«æ˜¯ç¬¬<code>630</code>è¡Œå’Œç¬¬<code>631</code>è¡Œã€‚</p><p>æ­¤å¤„å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹åŒä¸€ä¸ª<code>HashMap</code>æ‰§è¡Œ<code>put</code>æ–¹æ³•ï¼Œæ ¹æ®<code>hash</code>è®¡ç®—å‡ºçš„ä¸‹æ ‡<code>i</code>ç›¸åŒä¸”<code>i</code>ä¸‹æ ‡å¤„æ°å¥½ä¸º<code>null</code>æ²¡æœ‰å…ƒç´ ï¼ŒåŒæ—¶å¤šä¸ªçº¿ç¨‹æ°å¥½åˆšæ‰§è¡Œå®Œç¬¬<code>630</code>è¡Œçš„<code>if</code>æ¡ä»¶åˆ¤æ–­ä½†è¿˜æœªæ‰§è¡Œç¬¬<code>631</code>è¡Œçš„èµ‹å€¼æ’å…¥ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹æŒ‰å…ˆåé¡ºåºå¾€ä¸‹æ‰§è¡Œï¼Œé‚£ä¹ˆåæ‰§è¡Œçš„çº¿ç¨‹å°±ä¼šè¦†ç›–å…ˆæ‰§è¡Œçš„çº¿ç¨‹åœ¨<code>i</code>ä¸‹æ ‡å¤„æ’å…¥çš„å€¼ã€‚</p><p>å½“ç„¶åœ¨æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼ŒåŸºæœ¬ä¸Šä¸ä¼šä½¿ç”¨åˆ°<code>HashMap</code>ä½œä¸ºæˆå‘˜å˜é‡ï¼Œæ›´å¤šçš„æ˜¯ç”¨ä½œå±€éƒ¨å˜é‡è¿›è¡Œä¼ å‚ï¼Œè€Œä¸”ç°åœ¨å·²ç»ä¸æ¨èä½¿ç”¨<code>HashMap</code>è¿›è¡Œä¼ å‚äº†ï¼Œé™¤äº†ä¸€äº›æ—©æœŸé¡¹ç›®ï¼Œæˆ–è€…ä½¿ç”¨äº†<code>MyBatis</code>çš„æ—©æœŸç‰ˆæœ¬<code>ibatis</code>çš„é¡¹ç›®ï¼ŒåŸºæœ¬ä¸Šå¾ˆå°‘ä¼šç”¨åˆ°<code>HashMap</code>ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ‰å…³<code>HashMap</code>ï¼Œå…¶å®åˆ°è¿™é‡Œå°±å·²ç»è¶³å¤Ÿäº†ï¼Œå†å¾€ä¸‹æ·±å…¥ï¼Œå°±æ˜¯çº¢é»‘æ ‘çš„æŸ¥è¯¢å’Œæ’å…¥é€»è¾‘äº†ï¼Œæ¶‰åŠåˆ°çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„å’Œç®—æ³•ï¼Œæ¯”è¾ƒå¤æ‚ã€‚é¢è¯•å¦‚æœé‡åˆ°é—®çº¢é»‘æ ‘çš„å®ç°ç»†èŠ‚çš„ï¼Œå¤§å¯ä»¥å»åé—®é¢è¯•å®˜ä¼šä¸ä¼šã€‚</p><p>åé¢æœ‰ç©ºä¼šä¸“é—¨å†™ä¸€ç¯‡æ–‡ç« è®²è®²çº¢é»‘æ ‘ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åƒåœ¾æ”¶é›†ç®—æ³•</title>
      <link href="2020/07/23/javase/jvm/gc-algorithm/"/>
      <url>2020/07/23/javase/jvm/gc-algorithm/</url>
      
        <content type="html"><![CDATA[<p>ç°ä»£è™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†å™¨å¤§å¤šåŸºäºåˆ†ä»£æ”¶é›†ç†è®ºï¼ŒåŸºäºè¯¥ç†è®ºï¼Œå †å†…å­˜è¢«åˆ’åˆ†å‡ºå„ç§ä¸åŒçš„åŒºåŸŸï¼Œä¸åŒçš„åŒºåŸŸæœ‰ç€ä¸åŒçš„åƒåœ¾æ”¶é›†ç®—æ³•ã€‚</p><h2 id="åˆ†ä»£æ”¶é›†ç†è®º"><a href="#åˆ†ä»£æ”¶é›†ç†è®º" class="headerlink" title="åˆ†ä»£æ”¶é›†ç†è®º"></a>åˆ†ä»£æ”¶é›†ç†è®º</h2><p>åˆ†ä»£æ”¶é›†ç†è®ºå»ºç«‹åœ¨ä¸¤ä¸ªåˆ†ä»£å‡è¯´ä¹‹ä¸Šï¼š</p><ul><li>å¼±åˆ†ä»£å‡è¯´ï¼šç»å¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•ç­çš„ã€‚</li><li>å¼ºåˆ†ä»£å‡è¯´ï¼šç†¬è¿‡è¶Šå¤šæ¬¡åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„å¯¹è±¡å°±è¶Šéš¾ä»¥æ¶ˆäº¡ã€‚</li></ul><p>è¿™ä¸¤ä¸ªåˆ†ä»£å‡è¯´å…±åŒå¥ å®šäº†å¤šæ¬¾å¸¸ç”¨çš„åƒåœ¾æ”¶é›†å™¨çš„ä¸€è‡´çš„è®¾è®¡åŸåˆ™ï¼šæ”¶é›†å™¨åº”è¯¥å°†å †å†…å­˜åˆ’åˆ†å‡ºä¸åŒçš„åŒºåŸŸï¼Œç„¶åå°†å›æ”¶å¯¹è±¡ä¾æ®å…¶å¹´é¾„ï¼ˆä¸€æ¬¡åƒåœ¾å›æ”¶ï¼Œå¦‚æœå¯¹è±¡æœªè¢«å›æ”¶ï¼Œåˆ™å…¶å¹´é¾„åŠ ä¸€ï¼‰åˆ†é…åˆ°ä¸åŒçš„åŒºåŸŸè¿›è¡Œå­˜å‚¨ã€‚</p><p>æ˜¾ç„¶ï¼Œåº”è¯¥å°†å¤§å¤šæ•°æœç”Ÿå¤•æ­»çš„å¯¹è±¡é›†ä¸­åœ¨ä¸€èµ·ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶åªéœ€å…³æ³¨å¦‚ä½•ä¿ç•™å°‘é‡å­˜æ´»çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å»æ ‡è®°é‚£äº›å¤§é‡å°†è¢«å›æ”¶çš„å¯¹è±¡ï¼›å°†é‚£äº›éš¾ä»¥æ¶ˆäº¡çš„å¯¹è±¡ä¹Ÿé›†ä¸­åœ¨ä¸€èµ·ï¼Œå‡å°‘å¯¹å®ƒä»¬å›æ”¶çš„é¢‘ç‡ã€‚è¿™æ ·å°±æœ‰æ•ˆçš„åœ¨æ—¶é—´å’Œç©ºé—´å¼€é”€ä¸Šåšäº†æƒè¡¡ã€‚</p><p>åœ¨å †å†…å­˜åˆ’åˆ†å‡ºä¸åŒçš„åŒºåŸŸä¹‹åï¼Œåƒåœ¾æ”¶é›†å™¨æ‰å¯ä»¥æ¯æ¬¡åªå›æ”¶å…¶ä¸­æŸä¸ªåŒºåŸŸçš„å†…å­˜â€”â€”å› è€Œæ‰æœ‰äº†<code>Minor GC</code>ã€<code>Major GC</code>å’Œ<code>Full GC</code>å›æ”¶ç±»å‹çš„åŒºåˆ†ï¼›é’ˆå¯¹ä¸åŒåŒºåŸŸä¹Ÿé‡‡ç”¨äº†é€‚å½“çš„åƒåœ¾æ”¶é›†ç®—æ³•ã€‚</p><p>ä¸€åˆ‡çœ‹ä¼¼ç¾å¥½ï¼Œä½†åŒºåŸŸåˆ’åˆ†åä¼šå­˜åœ¨ä¸€ä¸ªæ˜æ˜¾çš„é—®é¢˜ï¼šå¯¹è±¡éƒ½ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œå¾ˆå¯èƒ½å­˜åœ¨è·¨ä»£å¼•ç”¨ã€‚</p><p>ç°ä»£è™šæ‹Ÿæœºä¸€èˆ¬éƒ½ä¼šå°†å †å†…å­˜åˆ’åˆ†å‡ºæ–°ç”Ÿä»£ï¼ˆ<code>Young Generation</code>ï¼‰å’Œè€å¹´ä»£ï¼ˆ<code>Old Generation</code>ï¼‰ä¸¤ä¸ªåŸºæœ¬åŒºåŸŸï¼Œå¯¹äºæ–°ç”Ÿä»£çš„å›æ”¶ç§°ä¸º<code>Minor GC</code>ï¼Œä½†æ–°ç”Ÿä»£çš„å¯¹è±¡å®Œå…¨æœ‰å¯èƒ½è¢«è€å¹´ä»£æ‰€å¼•ç”¨ï¼ŒåŒæ ·ï¼Œè€å¹´ä»£çš„å¯¹è±¡ä¹Ÿå®Œå…¨æœ‰å¯èƒ½è¢«æ–°ç”Ÿä»£æ‰€å¼•ç”¨ï¼Œä¸ºäº†æ‰¾å‡ºå¯¹åº”åŒºåŸŸä¸­çš„å­˜æ´»å¯¹è±¡ï¼Œä¸å¾—ä¸åœ¨å›ºå®šçš„<code>GC Roots</code>ä¹‹å¤–ï¼Œé¢å¤–éå†è€å¹´ä»£æˆ–æ–°ç”Ÿä»£æ¥ç¡®ä¿å¯è¾¾æ€§åˆ†æçš„æ­£ç¡®æ€§ã€‚éå†æ•´ä¸ªè€å¹´ä»£æ‰€æœ‰å¯¹è±¡çš„æ–¹æ¡ˆè™½ç„¶ç†è®ºä¸Šå¯è¡Œï¼Œä½†æ— ç–‘ä¼šå¯¹å†…å­˜å›æ”¶å¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½è´Ÿæ‹…ã€‚äºæ˜¯æœ‰äº†ç¬¬ä¸‰ä¸ªåˆ†ä»£å‡è¯´ï¼š</p><ul><li>è·¨ä»£å¼•ç”¨å‡è¯´ï¼šè·¨ä»£å¼•ç”¨ç›¸å¯¹äºåŒä»£å¼•ç”¨æ¥è¯´ä»…å æå°‘æ•°ã€‚</li></ul><p>è¿™ä¸ªå‡è¯´å¯ä»¥è®¤ä¸ºæ˜¯å‰ä¸¤ä¸ªåˆ†ä»£å‡è¯´çš„æ¨è®ºï¼šå­˜åœ¨äº’ç›¸å¼•ç”¨å…³ç³»çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œå€¾å‘äºåŒæ—¶ç”Ÿå­˜æˆ–åŒæ—¶æ­»äº¡çš„ã€‚å¦‚æœæŸä¸ªæ–°ç”Ÿä»£å¯¹è±¡å­˜åœ¨è·¨ä»£å¼•ç”¨ï¼Œç”±äºè€å¹´ä»£å¯¹è±¡æ˜¯éš¾ä»¥æ¶ˆäº¡çš„ï¼Œè¯¥å¼•ç”¨ä¼šä½¿æ–°ç”Ÿä»£å¯¹è±¡åœ¨è¢«å›æ”¶æ—¶å­˜æ´»ä¸‹æ¥ï¼Œéšåæ…¢æ…¢æ™‹å‡è‡³è€å¹´ä»£ï¼Œè¿™æ—¶è·¨ä»£å¼•ç”¨å°±ä¸å­˜åœ¨äº†ã€‚</p><p>ä¾æ®è¿™æ¡å‡è¯´ï¼Œæˆ‘ä»¬å°±ä¸åº”è¯¥å†ä¸ºäº†å°‘é‡çš„è·¨ä»£å¼•ç”¨å»æ‰«ææ•´ä¸ªè€å¹´ä»£ï¼Œä¹Ÿä¸å¿…æµªè´¹ç©ºé—´å»è®°å½•æ¯ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜åœ¨ä»¥åŠå­˜åœ¨å“ªäº›è·¨ä»£å¼•ç”¨ï¼Œåªéœ€åœ¨æ–°ç”Ÿä»£ä¸Šå»ºç«‹ä¸€ä¸ªå…¨å±€çš„ç§°ä¸ºè®°å¿†é›†ï¼ˆ<code>Reference Set</code>ï¼‰çš„æ•°æ®ç»“æ„ï¼Œè¿™ä¸ªç»“æ„æŠŠè€å¹´ä»£åˆ’åˆ†ä¸ºè‹¥å¹²å°å—ï¼Œæ­¤åå½“å‘ç”Ÿ<code>Minor GC</code>æ—¶ï¼Œåªæœ‰åŒ…å«äº†è·¨ä»£å¼•ç”¨çš„å°å—å†…å­˜é‡Œçš„å¯¹è±¡æ‰ä¼šè¢«åŠ å…¥åˆ°<code>GC Roots</code>è¿›è¡Œæ‰«æã€‚è™½ç„¶è¿™ç§æ–¹æ³•éœ€è¦åœ¨å¯¹è±¡æ”¹å˜å¼•ç”¨å…³ç³»æ—¶ç»´æŠ¤è®°å½•æ•°æ®çš„æ­£ç¡®æ€§ï¼Œå¢åŠ äº†ä¸€å®šçš„è¿è¡Œæ—¶å¼€é”€ï¼Œä½†è·Ÿåœ¨æ”¶é›†æ—¶æ‰«ææ•´ä¸ªè€å¹´ä»£ç›¸æ¯”æ˜¯åˆ’ç®—çš„ã€‚</p><h2 id="GCåˆ†ç±»"><a href="#GCåˆ†ç±»" class="headerlink" title="GCåˆ†ç±»"></a><code>GC</code>åˆ†ç±»</h2><ul><li>æ–°ç”Ÿä»£æ”¶é›†ï¼ˆ<code>Minor GC/Young GC</code>ï¼‰ï¼šå¯¹æ–°ç”Ÿä»£æ”¶é›†ã€‚</li><li>è€å¹´ä»£æ”¶é›†ï¼ˆ<code>Major GC/Old GC</code>ï¼‰ï¼šå¯¹è€å¹´ä»£æ”¶é›†ã€‚ç›®å‰åªæœ‰<code>CMS</code>æ”¶é›†å™¨ä¼šæœ‰å•ç‹¬æ”¶é›†è€å¹´ä»£çš„è¡Œä¸ºã€‚</li><li>æ··åˆæ”¶é›†ï¼ˆ<code>Mixed GC</code>ï¼‰ï¼šå¯¹æ•´ä¸ªæ–°ç”Ÿä»£ä»¥åŠéƒ¨åˆ†è€å¹´ä»£æ”¶é›†ã€‚ç›®å‰åªæœ‰<code>G1</code>æ”¶é›†å™¨ä¼šæœ‰è¿™ç§è¡Œä¸ºã€‚</li><li>æ•´å †æ”¶é›†ï¼ˆ<code>Full GC</code>ï¼‰ï¼šå¯¹æ•´ä¸ªå †å†…å­˜å’Œæ–¹æ³•åŒºæ”¶é›†ã€‚</li></ul><h2 id="åƒåœ¾æ”¶é›†ç®—æ³•"><a href="#åƒåœ¾æ”¶é›†ç®—æ³•" class="headerlink" title="åƒåœ¾æ”¶é›†ç®—æ³•"></a>åƒåœ¾æ”¶é›†ç®—æ³•</h2><ol><li>æ ‡è®°-æ¸…é™¤ç®—æ³•</li></ol><p>è¯¥ç®—æ³•åˆ†ä¸ºâ€œæ ‡è®°â€å’Œâ€œæ¸…é™¤â€ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆä½¿ç”¨å¯è¾¾æ€§åˆ†æç®—æ³•æ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œæ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ï¼›ä¹Ÿå¯ä»¥åè¿‡æ¥ï¼Œæ ‡è®°æ‰€æœ‰å­˜æ´»å¯¹è±¡ï¼Œç»Ÿä¸€å›æ”¶æœªè¢«æ ‡è®°çš„å¯¹è±¡ã€‚</p><p>ç¼ºç‚¹ï¼šæ‰§è¡Œæ•ˆç‡ä¸ç¨³å®šï¼Œå¦‚æœå †ä¸­å­˜åœ¨å¤§é‡å¯¹è±¡éœ€è¦è¿›è¡Œå›æ”¶ï¼Œåˆ™éœ€è¦è¿›è¡Œå¤§é‡æ ‡è®°å’Œæ¸…é™¤çš„åŠ¨ä½œï¼Œæ‰§è¡Œæ•ˆç‡éšå¯¹è±¡æ•°é‡å¢é•¿è€Œé™ä½ï¼›ç¬¬äºŒä¸ªæ˜¯å†…å­˜ç©ºé—´çš„ç¢ç‰‡åŒ–é—®é¢˜ï¼Œæ ‡è®°æ¸…é™¤åä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ã€‚å†…å­˜ç¢ç‰‡å¤ªå¤šä¼šå¯¼è‡´å½“éœ€è¦åˆ†é…å¤§å¯¹è±¡æ—¶æ— æ³•æ‰¾åˆ°è¿ç»­çš„å†…å­˜ç©ºé—´è€Œä¸å¾—ä¸æå‰è§¦å‘å†ä¸€æ¬¡çš„åƒåœ¾å›æ”¶ã€‚</p><ol start="2"><li>æ ‡è®°-å¤åˆ¶ç®—æ³•</li></ol><p>ä¸ºäº†è§£å†³æ ‡è®°-æ¸…é™¤ç®—æ³•åœ¨é¢å¯¹å¤§é‡å¯å›æ”¶å¯¹è±¡æ—¶æ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ï¼Œæœ‰â€œå¤§ä½¬â€æå‡ºäº†ä¸€ç§ç§°ä¸ºâ€œåŠåŒºå¤åˆ¶â€çš„åƒåœ¾æ”¶é›†ç®—æ³•ï¼šå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ï¼Œå½“è¿™ä¸€å—å†…å­˜ç”¨å®Œçš„æ—¶å€™æ‰å°†å…¶å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—å†…å­˜ä¸Šï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ä¸€æ¬¡æ€§æ¸…é™¤ã€‚å¦‚æœç¬¬ä¸€åŠå†…å­˜ä¸­å¤šæ•°å¯¹è±¡æ˜¯å­˜æ´»çš„ï¼Œé‚£è¿™ç§ç®—æ³•å°†ä¼šäº§ç”Ÿå¤§é‡çš„å†…å­˜é—´å¤åˆ¶çš„å¼€é”€ï¼Œä½†å¯¹äºå¤šæ•°å¯¹è±¡æ˜¯å¯å›æ”¶çŠ¶æ€æ—¶ï¼Œç®—æ³•å°±åªéœ€å¤åˆ¶å°‘é‡çš„å­˜æ´»å¯¹è±¡ï¼Œè€Œä¸”æ¯æ¬¡éƒ½æ˜¯é’ˆå¯¹ä¸€åŠå†…å­˜è¿›è¡Œå›æ”¶ï¼Œå†…å­˜ç¢ç‰‡é—®é¢˜å‡ ä¹ä¸ä¼šå‡ºç°ã€‚è¿™ç§ç®—æ³•å®ç°å®¹æ˜“ï¼Œæ‰§è¡Œæ•ˆç‡ä¹Ÿéå¸¸é«˜ï¼Œä½†å…¶ä»£ä»·æ˜¯å¯ç”¨å†…å­˜ç¼©å°ä¸ºäº†åŸæ¥çš„ä¸€åŠã€‚ç©ºé—´åˆ©ç”¨ç‡å¤ªä½ã€‚</p><p>ç°ä»£è™šæ‹Ÿæœºå¤§å¤šé‡‡ç”¨äº†è¯¥ç®—æ³•å»å›æ”¶æ–°ç”Ÿä»£ï¼Œæœ‰ç ”ç©¶è¡¨æ˜ï¼šæ–°ç”Ÿä»£ä¸­æœç”Ÿå¤•æ­»çš„å¯¹è±¡æœ‰<code>98%</code>éƒ½ç†¬ä¸è¿‡ç¬¬ä¸€è½®åƒåœ¾æ”¶é›†ã€‚å› æ­¤å¹¶ä¸éœ€è¦å°†æ–°ç”Ÿä»£åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ›´å¥½çš„åšæ³•æ˜¯å°†æ–°ç”Ÿä»£åˆ’åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„<code>Eden</code>åŒºåŸŸå’Œä¸¤å—è¾ƒå°çš„<code>Survivor</code>ç©ºé—´ï¼Œæ¯æ¬¡å†…å­˜åˆ†é…æ—¶åªä½¿ç”¨<code>Eden</code>åŒºåŸŸå’Œå…¶ä¸­ä¸€å—<code>Survivor</code>åŒºåŸŸã€‚å½“å‘ç”Ÿåƒåœ¾å›æ”¶æ—¶ï¼Œå°†<code>Eden</code>åŒºå’Œ<code>Survivor</code>åŒºå­˜æ´»çš„å¯¹è±¡ä¸€æ¬¡æ€§å¤åˆ¶åˆ°å¦ä¸€å—<code>Survivor</code>åŒºåŸŸä¸Šï¼Œç„¶åç›´æ¥å›æ”¶æ‰<code>Eden</code>åŒºå’Œé‚£å—ä½¿ç”¨è¿‡çš„<code>Survivor</code>åŒºã€‚<code>HotSpot</code>è™šæ‹Ÿæœºé»˜è®¤<code>Eden</code>å’Œ<code>Survivor</code>åŒºåŸŸçš„å¤§å°æ¯”ä¾‹æ˜¯<code>8 : 1</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ–°ç”Ÿä»£ä¸­å¯ç”¨çš„å†…å­˜ç©ºé—´ä¸ºæ•´ä¸ªæ–°ç”Ÿä»£çš„<code>90%</code>ï¼Œè¿™æ ·ç©ºé—´åˆ©ç”¨ç‡å°±è¾¾åˆ°äº†<code>90%</code>ï¼Œè™½ç„¶è¿˜æœ‰<code>10%</code>çš„å¦ä¸€å—<code>Survivor</code>åŒºåŸŸè¢«æµªè´¹ï¼Œä½†å·²ç»æ¯”è¾ƒç†æƒ³äº†ã€‚å½“ç„¶ï¼Œä»»ä½•äººéƒ½ä¸èƒ½ä¿è¯ç ”ç©¶åœ¨å®é™…æƒ…å†µä¸­çš„æ­£ç¡®æ€§ï¼Œæ— æ³•ä¿è¯æ¯æ¬¡å¯¹æ–°ç”Ÿä»£çš„å›æ”¶éƒ½åªæœ‰ä¸å¤šäº<code>10%</code>çš„å¯¹è±¡å­˜æ´»ï¼Œäºæ˜¯å­˜åœ¨ä¸€ä¸ªå…œåº•çš„å®‰å…¨è®¾è®¡ï¼šå½“å¦ä¸€å—<code>Survivor</code>åŒºåŸŸç©ºé—´ä¸è¶³ä»¥å®¹çº³ä¸€æ¬¡<code>Young GC</code>ä¹‹åå­˜æ´»çš„å¯¹è±¡æ—¶ï¼Œå°±éœ€è¦å…¶å®ƒå†…å­˜åŒºåŸŸï¼ˆå¤§å¤šæŒ‡è€å¹´ä»£ï¼‰è¿›è¡Œå†…å­˜åˆ†é…æ‹…ä¿ï¼Œå°†å¤šä½™çš„å­˜æ´»å¯¹è±¡ç›´æ¥å¤åˆ¶åˆ°è€å¹´ä»£ã€‚</p><ol start="3"><li>æ ‡è®°æ•´ç†</li></ol><p>æ ‡è®°-å¤åˆ¶ç®—æ³•åœ¨å¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜æ—¶å°±ä¼šäº§ç”Ÿå¤§é‡çš„å†…å­˜é—´å¤åˆ¶å¼€é”€ï¼Œä¼˜åŒ–è¿‡åçš„ç®—æ³•ä¹Ÿéœ€è¦æµªè´¹<code>10%</code>çš„ç©ºé—´ï¼Œä¸”éœ€è¦å…¶å®ƒç©ºé—´è¿›è¡Œå†…å­˜åˆ†é…æ‹…ä¿ã€‚å¯¹äºè€å¹´ä»£æ¥è¯´ï¼Œå¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ˜¯éš¾ä»¥æ¶ˆäº¡çš„ï¼Œæ‰€ä»¥è¯¥ç®—æ³•å¹¶ä¸é€‚ç”¨äºè€å¹´ä»£ã€‚</p><p>é’ˆå¯¹è€å¹´ä»£å¯¹è±¡éš¾ä»¥æ¶ˆäº¡çš„ç‰¹å¾ï¼Œæœ‰äººæå‡ºäº†å¦ä¸€ç§æœ‰é’ˆå¯¹æ€§çš„â€œæ ‡è®°-æ•´ç†â€ç®—æ³•ï¼Œæ ‡è®°è¿‡ç¨‹ä»ç„¶é‡‡ç”¨çš„æ˜¯å¯è¾¾æ€§åˆ†æç®—æ³•ï¼Œä½†æ ‡è®°å®Œæˆåå¹¶ä¸æ˜¯ç«‹åˆ»è¿›è¡Œå›æ”¶ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»å¯¹è±¡éƒ½å‘å†…å­˜ç©ºé—´ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åå»æ¸…ç†è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚</p><p>æ ‡è®°æ•´ç†ç®—æ³•å’Œæ ‡è®°æ¸…é™¤ç®—æ³•çš„æœ¬è´¨å·®å¼‚åœ¨äºæ˜¯å¦ç§»åŠ¨å­˜æ´»çš„å¯¹è±¡ï¼Œæ ‡è®°æ¸…é™¤ç®—æ³•æ˜¯ä¸ç§»åŠ¨çš„ï¼Œè€Œæ ‡è®°æ•´ç†ç®—æ³•æ˜¯ç§»åŠ¨çš„ã€‚</p><p>æ˜¯å¦ç§»åŠ¨å­˜æ´»å¯¹è±¡æ˜¯ä¸€ä¸ªä¼˜ç¼ºç‚¹å¹¶å­˜çš„é£é™©å†³ç­–ã€‚å¦‚æœç§»åŠ¨å¯¹è±¡ï¼Œå°¤å…¶æ˜¯åœ¨è€å¹´ä»£è¿™ç§æ¯æ¬¡å›æ”¶éƒ½æœ‰å¤§é‡å¯¹è±¡å­˜æ´»çš„åŒºåŸŸï¼Œç§»åŠ¨å­˜æ´»å¯¹è±¡å¹¶æ›´æ–°æ‰€æœ‰å¼•ç”¨æ˜¯ä¸€ä¸ªæä¸ºè´Ÿé‡çš„æ“ä½œï¼Œè€Œä¸”è¿™ç§ç§»åŠ¨å¯¹è±¡æ“ä½œå¿…é¡»å…¨ç¨‹æš‚åœç”¨æˆ·çº¿ç¨‹æ‰èƒ½æ‰§è¡Œï¼Œè¿™ä¸ªæš‚åœè¢«ç§°ä¸º<code>Stop The World</code>ã€‚å¦‚æœä¸ç§»åŠ¨å¯¹è±¡ï¼Œé‚£å¿…ç„¶ä¼šé€ æˆå†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œè€Œè¦è§£å†³å†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œå°±éœ€è¦ä¾èµ–æ›´ä¸ºå¤æ‚çš„å†…å­˜åˆ†é…å™¨å’Œå†…å­˜è®¿é—®å™¨æ¥è§£å†³ï¼Œæ— ç–‘åŠ é‡äº†å†…å­˜è®¿é—®çš„è´Ÿæ‹…ï¼Œä½¿ç¨‹åºçš„ååé‡é™ä½ã€‚æ‰€ä»¥ï¼Œæ— è®ºæ˜¯å¦ç§»åŠ¨å¯¹è±¡éƒ½å­˜åœ¨å¼Šç«¯ï¼Œç§»åŠ¨åˆ™å‡ºç°<code>Stop The World</code>ï¼›ä¸ç§»åŠ¨åˆ™å¯ä»¥å¿½ç•¥<code>Stop The World</code>çš„æ—¶é—´ï¼Œä½†ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œä¸”ç¨‹åºååé‡é™ä½ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>ã€Šæ·±å…¥ç†è§£<code>Java</code>è™šæ‹Ÿæœºï¼š<code>JVM</code>é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬<code>3</code>ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜</li></ul>]]></content>
      
      
      <categories>
          
          <category> JVM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åƒåœ¾æ”¶é›†å™¨</title>
      <link href="2020/07/23/javase/jvm/gcer/"/>
      <url>2020/07/23/javase/jvm/gcer/</url>
      
        <content type="html"><![CDATA[<p>å¦‚æœè¯´åƒåœ¾æ”¶é›†ç®—æ³•æ˜¯å†…å­˜å›æ”¶çš„æ–¹æ³•è®ºï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±æ˜¯å†…å­˜å›æ”¶çš„å®è·µè€…ã€‚æ ¹æ®åˆ†ä»£æ”¶é›†ç†è®ºï¼Œ<code>HotSpot</code>è™šæ‹Ÿæœºæä¾›äº†å¤šç§ä½œç”¨äºä¸åŒåˆ†ä»£çš„åƒåœ¾æ”¶é›†å™¨ï¼Œå®ƒä»¬æ˜¯ä¸åŒæ—¶ä»£çš„æ€æƒ³æ±‡èšã€‚</p><h2 id="Serialæ–°ç”Ÿä»£æ”¶é›†å™¨"><a href="#Serialæ–°ç”Ÿä»£æ”¶é›†å™¨" class="headerlink" title="Serialæ–°ç”Ÿä»£æ”¶é›†å™¨"></a><code>Serial</code>æ–°ç”Ÿä»£æ”¶é›†å™¨</h2><p>æœ€åŸºç¡€ä¸”å†å²æœ€æ‚ ä¹…çš„æ”¶é›†å™¨ï¼Œæ›¾æ˜¯<code>HotSpot</code>è™šæ‹Ÿæœºæ–°ç”Ÿä»£åŒºåŸŸçš„å”¯ä¸€é€‰æ‹©ã€‚å®ƒé€‰ç”¨çš„æ˜¯æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œå•çº¿ç¨‹æ”¶é›†ï¼Œå½“å®ƒå¼€å§‹å·¥ä½œæ—¶ï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹å¿…é¡»æŒ‚èµ·ï¼Œç›´åˆ°å®ƒå›æ”¶å†…å­˜å®Œæ¯•ã€‚<code>Stop The World</code>æ— æ³•é¿å…ã€‚ä½†å¥½å¤„æ˜¯å•çº¿ç¨‹å·¥ä½œï¼Œå¯¹äºæ ¸æ•°è¾ƒå°‘çš„å¤„ç†å™¨æ¥è¯´ï¼Œæ²¡æœ‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼Œæ”¶é›†æ•ˆç‡é«˜ï¼Œé€‚ç”¨äºå®¢æˆ·ç«¯æ¨¡å¼çš„è™šæ‹Ÿæœºã€‚</p><h2 id="Serial-Oldè€å¹´ä»£æ”¶é›†å™¨"><a href="#Serial-Oldè€å¹´ä»£æ”¶é›†å™¨" class="headerlink" title="Serial Oldè€å¹´ä»£æ”¶é›†å™¨"></a><code>Serial Old</code>è€å¹´ä»£æ”¶é›†å™¨</h2><p>ä¸<code>Serial</code>æ–°ç”Ÿä»£æ”¶é›†å™¨é…åˆä½¿ç”¨ï¼Œå›æ”¶è€å¹´ä»£ï¼ŒåŒæ ·ä½¿ç”¨å•çº¿ç¨‹æ”¶é›†ï¼Œé€‰ç”¨çš„æ˜¯æ ‡è®°-æ•´ç†ç®—æ³•ï¼Œé€‚ç”¨äºå®¢æˆ·ç«¯æ¨¡å¼çš„è™šæ‹Ÿæœºã€‚</p><h2 id="ParNewæ–°ç”Ÿä»£æ”¶é›†å™¨"><a href="#ParNewæ–°ç”Ÿä»£æ”¶é›†å™¨" class="headerlink" title="ParNewæ–°ç”Ÿä»£æ”¶é›†å™¨"></a><code>ParNew</code>æ–°ç”Ÿä»£æ”¶é›†å™¨</h2><p><code>ParNew</code>æ–°ç”Ÿä»£æ”¶é›†å™¨å®è´¨æ˜¯<code>Serial</code>æ”¶é›†å™¨çš„å¤šçº¿ç¨‹å¹¶è¡Œç‰ˆæœ¬ï¼Œåœ¨å¤šæ ¸å¤„ç†å™¨çš„è™šæ‹Ÿæœºä¸Šæ•ˆç‡ä¼šå¤§å¹…æé«˜ã€‚é€‰ç”¨çš„åŒæ ·æ˜¯æ ‡è®°-å¤åˆ¶ç®—æ³•ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šé™¤äº†<code>Serial</code>æ”¶é›†å™¨å¤–ï¼Œç›®å‰åªæœ‰å®ƒèƒ½ä¸<code>CMS</code>æ”¶é›†å™¨é…åˆå·¥ä½œã€‚å¤§éƒ¨åˆ†æœåŠ¡ç«¯æ¨¡å¼çš„è™šæ‹Ÿæœºé€‰ç”¨è¯¥æ”¶é›†å™¨å›æ”¶æ–°ç”Ÿä»£ã€‚</p><h2 id="CMSè€å¹´ä»£æ”¶é›†å™¨"><a href="#CMSè€å¹´ä»£æ”¶é›†å™¨" class="headerlink" title="CMSè€å¹´ä»£æ”¶é›†å™¨"></a><code>CMS</code>è€å¹´ä»£æ”¶é›†å™¨</h2><p><code>CMS (Concurrent Mark Sweepï¼šå¹¶å‘æ ‡è®°-æ¸…é™¤)</code>æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ï¼ˆ<code>Stop The World</code>ï¼‰ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚å®ƒçš„å›æ”¶è¿‡ç¨‹åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š</p><ul><li>åˆå§‹æ ‡è®°ï¼ˆ<code>CMS initial mark</code>ï¼‰</li><li>å¹¶å‘æ ‡è®°ï¼ˆ<code>CMS concurrent mark</code>ï¼‰</li><li>é‡æ–°æ ‡è®°ï¼ˆ<code>CMS remark</code>ï¼‰</li><li>å¹¶å‘æ¸…é™¤ï¼ˆ<code>CMS concurrent sweep</code>ï¼‰</li></ul><ol><li>åˆå§‹æ ‡è®°ï¼šæ ‡è®°<code>GC Roots</code>èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œä½†å­˜åœ¨<code>Stop The World</code>åœé¡¿ã€‚</li><li>å¹¶å‘æ ‡è®°ï¼šä»<code>GC Roots</code>çš„ç›´æ¥å…³è”å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾ï¼Œè€—æ—¶è¾ƒé•¿ï¼Œä½†éå†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹å¯å¹¶å‘æ‰§è¡Œã€‚æ— <code>Stop The World</code>åœé¡¿ã€‚</li><li>é‡æ–°æ ‡è®°ï¼šä¿®æ­£å¹¶å‘æ ‡è®°é˜¶æ®µï¼Œç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œæ—¶å¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼ˆå¢é‡æ›´æ–°ï¼‰ï¼Œå­˜åœ¨<code>Stop The World</code>åœé¡¿ï¼Œä¸”ä¸€èˆ¬æ¯”åˆå§‹æ ‡è®°é˜¶æ®µåœé¡¿æ—¶é—´é•¿ã€‚</li><li>å¹¶å‘æ¸…é™¤ï¼šæ¸…ç†åˆ é™¤æ‰æ ‡è®°é˜¶æ®µåˆ¤æ–­ä¸ºä¸å¯è¾¾çš„å¯¹è±¡ï¼Œæ¸…ç†çº¿ç¨‹å¯ä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œã€‚</li></ol><p>ç”±äºå­˜åœ¨å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤é˜¶æ®µï¼Œç”¨æˆ·çº¿ç¨‹åœ¨å¹¶å‘æ‰§è¡ŒæœŸé—´å®Œå…¨æœ‰å¯èƒ½äº§ç”Ÿæ–°çš„åƒåœ¾å¯¹è±¡ï¼Œä½†è¿™éƒ¨åˆ†å¯¹è±¡å‡ºç°åœ¨æ ‡è®°è¿‡ç¨‹ç»“æŸä¹‹åï¼Œæœ¬æ¬¡å›æ”¶æ— æ³•è¿›è¡Œå¤„ç†ï¼Œåªèƒ½ç­‰åˆ°ä¸‹ä¸€æ¬¡è€å¹´ä»£å†…å­˜å›æ”¶æ—¶æ‰èƒ½è¢«æ¸…ç†æ‰ï¼Œè¿™éƒ¨åˆ†åƒåœ¾è¢«ç§°ä¸ºâ€œæµ®åŠ¨åƒåœ¾â€ã€‚</p><p>åœ¨ç”¨æˆ·çº¿ç¨‹å’Œæ”¶é›†å™¨çº¿ç¨‹å¹¶å‘æ‰§è¡ŒæœŸé—´ï¼Œæ˜¯å¯èƒ½ä¼šæœ‰å¯¹è±¡éœ€è¦è¿›å…¥è€å¹´ä»£çš„ï¼Œè¿™æ—¶å°±éœ€è¦è€å¹´ä»£é¢„ç•™ä¸€å®šçš„å†…å­˜ç©ºé—´ã€‚åœ¨<code>Java5</code>çš„è™šæ‹Ÿæœºä¸­ï¼Œé»˜è®¤è®¾ç½®æ˜¯è€å¹´ä»£å†…å­˜ä½¿ç”¨äº†<code>68%</code>åå°±ä¼šè§¦å‘<code>CMS</code>æ”¶é›†å™¨å›æ”¶è€å¹´ä»£ã€‚è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¿å®ˆçš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨å‚æ•°<code>-XX: CMSInitiatingOccu-pancyFraction</code>æ¥è°ƒæ•´è¿™ä¸ªé»˜è®¤å€¼ã€‚åˆ°äº†<code>Java6</code>æ—¶ï¼Œé»˜è®¤è®¾ç½®æé«˜åˆ°äº†<code>92%</code>ï¼Œä½†è¿™åˆä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœ<code>CMS</code>æ”¶é›†å™¨åœ¨å¹¶å‘æœŸé—´ï¼Œé¢„ç•™çš„å†…å­˜æ— æ³•æ»¡è¶³ç”¨æˆ·çº¿ç¨‹çš„éœ€è¦ï¼Œå°±ä¼šå‡ºç°ä¸€æ¬¡â€œå¹¶å‘å¤±è´¥â€ï¼Œè¿™æ—¶ï¼Œè™šæ‹Ÿæœºé‡‡ç”¨é™çº§ä¿æŠ¤æ–¹æ¡ˆï¼ŒæŒ‚èµ·ç”¨æˆ·çº¿ç¨‹ï¼ˆ<code>Stop The World</code>ï¼‰ï¼Œä¸´æ—¶å¯ç”¨<code>Serial Old</code>è€å¹´ä»£æ”¶é›†å™¨é‡æ–°è¿›è¡Œè€å¹´ä»£çš„å›æ”¶ã€‚æ€»çš„æ¥è¯´ï¼Œ<code>-XX: CMSInitiatingOccu-pancyFraction</code>è¿™ä¸ªå‚æ•°è®¾ç½®çš„å¤ªé«˜ä¼šå®¹æ˜“å‡ºç°â€œå¹¶å‘å¤±è´¥â€é—®é¢˜ï¼Œæ€§èƒ½ä¸å¢åé™ï¼›å¤ªä½åˆä¼šå¯¼è‡´å†…å­˜åˆ©ç”¨ç‡ä¸é«˜ï¼Œä¸”å›æ”¶é¢‘ç‡ä¼šä¸Šå‡ã€‚æ‰€ä»¥ï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒæ—¶åº”è°¨æ…è°ƒæ•´ã€‚</p><p>æ ‡è®°-æ¸…é™¤ç®—æ³•ä¸å¯é¿å…çš„é—®é¢˜å°±æ˜¯å†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œå½“è€å¹´ä»£å†…å­˜ç¢ç‰‡è¿‡å¤šæ—¶ï¼Œæ²¡æœ‰è¿ç»­ç©ºé—´æ¥å®¹çº³å¤§å¯¹è±¡ï¼Œå³ä½¿è¿˜æœ‰å¾ˆå¤šå†…å­˜æ²¡æœ‰ä½¿ç”¨ï¼Œè¿˜æ˜¯ä¼šè§¦å‘<code>Full GC</code>ã€‚<code>CMS</code>æ”¶é›†å™¨æä¾›äº†ä¸€ä¸ª<code>-XX: +UseCMS-CompactAtFullCollection</code>å¼€å…³å‚æ•°ï¼ˆé»˜è®¤å¼€å¯ï¼Œ<code>Java9</code>åºŸå¼ƒï¼‰ç”¨äºåœ¨<code>CMS</code>æ”¶é›†å™¨ä¸å¾—ä¸è¿›è¡Œ<code>Full GC</code>æ—¶å¼€å¯å†…å­˜ç¢ç‰‡çš„æ•´ç†è¿‡ç¨‹ï¼Œæ­¤è¿‡ç¨‹éœ€è¦ç§»åŠ¨å¯¹è±¡ï¼Œæ— æ³•è¿›è¡Œå¹¶å‘ï¼Œå‡ºç°<code>Stop The World</code>åœé¡¿ã€‚åŒæ—¶<code>CMS</code>æ”¶é›†å™¨è¿˜æä¾›äº†<code>-XX: CMSFullGCsBefore-Compaction</code>å‚æ•°ï¼ˆé»˜è®¤å€¼ä¸º<code>0</code>ï¼šæ¯æ¬¡<code>Full GC</code>éƒ½è¿›è¡Œç¢ç‰‡æ•´ç†ï¼‰è¦æ±‚æ”¶é›†å™¨åœ¨æ‰§è¡Œè¿‡æŒ‡å®šæ¬¡æ•°ä¸æ•´ç†ç¢ç‰‡çš„<code>Full GC</code>åï¼Œä¸‹ä¸€æ¬¡è¿›å…¥<code>Full GC</code>å‰å…ˆè¿›è¡Œç¢ç‰‡æ•´ç†ã€‚</p><h2 id="Parallel-Scavengeæ–°ç”Ÿä»£æ”¶é›†å™¨"><a href="#Parallel-Scavengeæ–°ç”Ÿä»£æ”¶é›†å™¨" class="headerlink" title="Parallel Scavengeæ–°ç”Ÿä»£æ”¶é›†å™¨"></a><code>Parallel Scavenge</code>æ–°ç”Ÿä»£æ”¶é›†å™¨</h2><p>ååé‡ä¼˜å…ˆæ”¶é›†å™¨ã€‚é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ã€‚æä¾›å¼€å…³å‚æ•°<code>-XX: +UseAdaptiveSizePolicy</code>è®©è™šæ‹Ÿæœºæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒæ•´æ–°ç”Ÿä»£å¤§å°ã€<code>Eden</code>å’Œ<code>Survivor</code>åŒºåŸŸæ¯”ä¾‹ç­‰å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–æœ€å¤§ååé‡ã€‚</p><h2 id="Parallel-Oldè€å¹´ä»£æ”¶é›†å™¨"><a href="#Parallel-Oldè€å¹´ä»£æ”¶é›†å™¨" class="headerlink" title="Parallel Oldè€å¹´ä»£æ”¶é›†å™¨"></a><code>Parallel Old</code>è€å¹´ä»£æ”¶é›†å™¨</h2><p>ååé‡ä¼˜å…ˆæ”¶é›†å™¨ã€‚é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ï¼Œå¤šçº¿ç¨‹å¹¶å‘æ”¶é›†ã€‚ä¸<code>Parallel Scavenge</code>æ–°ç”Ÿä»£æ”¶é›†å™¨æ­é…ä½¿ç”¨ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>ã€Šæ·±å…¥ç†è§£<code>Java</code>è™šæ‹Ÿæœºï¼š<code>JVM</code>é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬<code>3</code>ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜</li></ul>]]></content>
      
      
      <categories>
          
          <category> JVM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›æ”¶å‰çš„è‡ªæ•‘</title>
      <link href="2020/07/20/javase/jvm/finalize-before-gc/"/>
      <url>2020/07/20/javase/jvm/finalize-before-gc/</url>
      
        <content type="html"><![CDATA[<p>å³ä½¿åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­è¢«åˆ¤å®šä¸ºä¸å¯è¾¾çš„å¯¹è±¡ï¼Œä¹Ÿä¸æ˜¯â€œéæ­»ä¸å¯â€çš„ï¼Œè¿˜æœ‰ä¸€ç§è‡ªæ•‘çš„æ–¹æ³•ã€‚</p><p>è¦å®£å‘Šä¸€ä¸ªå¯¹è±¡å·²æ­»ï¼Œè‡³å°‘è¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ï¼šåœ¨è¢«å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤å®šä¸ºä¸å¯è¾¾åä¼šè¢«æ ‡è®°ä¸€æ¬¡ï¼›éšåä¼šå¯¹ä¸å¯è¾¾å¯¹è±¡è¿›è¡Œç­›é€‰ï¼Œç­›é€‰æ¡ä»¶æ˜¯è¯¥å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œ<code>finalize()</code>æ–¹æ³•ï¼Œå¦‚æœå¯¹è±¡æ²¡æœ‰é‡å†™<code>finalize()</code>æ–¹æ³•ï¼Œæˆ–è€…<code>finalize()</code>åœ¨ä¸Šä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶è¢«è°ƒç”¨è¿‡ï¼Œåˆ™è¯¥å¯¹è±¡æ²¡æœ‰å¿…è¦æ‰§è¡Œ<code>finalize()</code>æ–¹æ³•ï¼Œä¼šè¢«ç¬¬äºŒæ¬¡æ ‡è®°ã€‚å¯¹è±¡å³è¢«åˆ¤å®šä¸ºäº†â€œæ­»äº¡â€ã€‚</p><p>å¦‚æœå¯¹è±¡è¢«åˆ¤å®šä¸ºæœ‰å¿…è¦æ‰§è¡Œ<code>finalize()</code>æ–¹æ³•ï¼Œè™šæ‹Ÿæœºä¼šå°†è¯¥å¯¹è±¡æ”¾ç½®åœ¨ä¸€ä¸ªåä¸º<code>F-Queue</code>çš„é˜Ÿåˆ—ä¹‹ä¸­ï¼Œå¹¶åœ¨ç¨åç”±ä¸€ä¸ªç”±è™šæ‹Ÿæœºè‡ªåŠ¨åˆ›å»ºçš„ã€ä½è°ƒåº¦ä¼˜å…ˆçº§çš„<code>Finalizer</code>çº¿ç¨‹å»æ‰§è¡Œå®ƒä»¬çš„<code>finalize()</code>æ–¹æ³•ã€‚è¿™é‡Œçš„æ‰§è¡Œæ˜¯è™šæ‹Ÿæœºä¼šè§¦å‘è¯¥æ–¹æ³•çš„å¼€å§‹æ‰§è¡Œï¼Œä½†ä¸ä¼šç­‰å¾…å®ƒä»¬æ‰§è¡Œç»“æŸã€‚åŸå› æ˜¯è¯¥æ–¹æ³•çš„æ–¹æ³•ä½“æ˜¯ç»è¿‡é‡å†™çš„ï¼Œæ— æ³•ä¿è¯ç«‹åˆ»æ‰§è¡Œç»“æŸï¼ˆç­‰å¾…æˆ–æ­»å¾ªç¯çš„æƒ…å†µï¼‰ï¼Œå¾ˆå¯èƒ½é€ æˆ<code>F-Queue</code>é˜Ÿåˆ—ä¸­çš„å…¶å®ƒå¯¹è±¡æ°¸è¿œå¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¯¼è‡´æ•´ä¸ªåƒåœ¾å›æ”¶ç³»ç»Ÿå´©æºƒã€‚</p><p><code>finalize()</code>æ–¹æ³•æ˜¯å¯¹è±¡é€ƒç¦»æ­»äº¡çš„æœ€åä¸€æ¬¡æœºä¼šï¼Œè§¦å‘æ‰§è¡Œåï¼Œåƒåœ¾æ”¶é›†å™¨å°†å¯¹<code>F-Queue</code>é˜Ÿåˆ—ä¸­çš„å¯¹è±¡è¿›è¡Œç¬¬äºŒæ¬¡å°è§„æ¨¡æ ‡è®°ï¼Œå¦‚æœå¯¹è±¡è¦åœ¨<code>finalize()</code>æ–¹æ³•ä¸­æ‹¯æ•‘è‡ªå·±â€”â€”åªéœ€é‡æ–°ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”å³å¯ï¼Œä¾‹å¦‚å°†è‡ªèº«ï¼ˆ<code>this</code>ï¼‰èµ‹å€¼ç»™æŸä¸ªç±»å˜é‡æˆ–è€…æŸä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œé‚£åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶è¯¥å¯¹è±¡å°†è¢«ç§»å‡ºâ€œå³å°†å›æ”¶â€çš„é›†åˆï¼›å¦‚æœè¯¥å¯¹è±¡æ­¤æ—¶è¿˜æœªé€ƒè„±ï¼Œé‚£åŸºæœ¬å¯ä»¥è¯´å®ƒå·²ç»â€œæ­»äº†â€ã€‚</p><p>å¯¹è±¡è‡ªæ•‘ä»£ç æ¼”ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FinalizeEscapeGc</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> FinalizeEscapeGc SAVE_HOOK = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">isAlive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;alive&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.finalize();</span><br><span class="line">        System.out.println(<span class="string">&quot;finalize&quot;</span>);</span><br><span class="line">        <span class="comment">// å°†thisèµ‹å€¼ç»™å½“å‰ç±»çš„é™æ€å˜é‡è¿›è¡Œè‡ªæ•‘</span></span><br><span class="line">        FinalizeEscapeGc.SAVE_HOOK = <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        SAVE_HOOK = <span class="keyword">new</span> FinalizeEscapeGc();</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€æ¬¡ä¼šè¿›è¡Œè‡ªæ•‘</span></span><br><span class="line">        SAVE_HOOK = <span class="keyword">null</span>;</span><br><span class="line">        System.gc();</span><br><span class="line">        <span class="comment">// Finalizerçº¿ç¨‹ä¼˜å…ˆçº§è¾ƒä½ï¼Œæš‚åœ0.5ç§’ä»¥ç­‰å¾…å®ƒ</span></span><br><span class="line">        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">        <span class="keyword">if</span> (SAVE_HOOK != <span class="keyword">null</span>) &#123;</span><br><span class="line">            SAVE_HOOK.isAlive();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;dead&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬äºŒæ¬¡è¢«åˆ¤å®šä¸ºâ€œæ­»äº¡â€</span></span><br><span class="line">        SAVE_HOOK = <span class="keyword">null</span>;</span><br><span class="line">        System.gc();</span><br><span class="line">        <span class="comment">// Finalizerçº¿ç¨‹ä¼˜å…ˆçº§è¾ƒä½ï¼Œæš‚åœ0.5ç§’ä»¥ç­‰å¾…å®ƒ</span></span><br><span class="line">        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">        <span class="keyword">if</span> (SAVE_HOOK != <span class="keyword">null</span>) &#123;</span><br><span class="line">            SAVE_HOOK.isAlive();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;dead&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">finalize</span><br><span class="line">alive</span><br><span class="line">dead</span><br></pre></td></tr></table></figure><p>å¯çœ‹åˆ°<code>finalize()</code>æ–¹æ³•è¢«æ‰§è¡Œäº†ï¼Œä¸”ç¬¬ä¸€æ¬¡â€œè‡ªæ•‘æˆåŠŸâ€ï¼Œç¬¬äºŒæ¬¡åˆ™å½»åº•â€œæ­»äº¡â€ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>ã€Šæ·±å…¥ç†è§£<code>Java</code>è™šæ‹Ÿæœºï¼š<code>JVM</code>é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬<code>3</code>ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜</li></ul>]]></content>
      
      
      <categories>
          
          <category> JVM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯¹è±¡æ˜¯â€œç”Ÿâ€æ˜¯â€œæ­»â€</title>
      <link href="2020/07/20/javase/jvm/object-is-alive-or-dead/"/>
      <url>2020/07/20/javase/jvm/object-is-alive-or-dead/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>åƒåœ¾æ”¶é›†å™¨å¯¹å †å†…å­˜è¿›è¡Œå›æ”¶æ—¶ï¼Œé¦–å…ˆè¦åˆ¤æ–­å †ä¸­çš„å¯¹è±¡æ˜¯å¦è¿˜å­˜æ´»ã€‚</p><p>å¯¹è±¡æ˜¯â€œç”Ÿå­˜â€è¿˜æ˜¯â€œæ­»äº¡â€ï¼Ÿè¿™æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ç»å…¸çš„åˆ¤æ–­ç®—æ³•æ˜¯å¼•ç”¨è®¡æ•°æ³•ï¼Œä½†å­˜åœ¨ä¸€å®šç¼ºé™·ã€‚ç°ä»£è™šæ‹Ÿæœºæ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»ã€‚</p><h2 id="å¼•ç”¨è®¡æ•°ç®—æ³•"><a href="#å¼•ç”¨è®¡æ•°ç®—æ³•" class="headerlink" title="å¼•ç”¨è®¡æ•°ç®—æ³•"></a>å¼•ç”¨è®¡æ•°ç®—æ³•</h2><p>å¼•ç”¨è®¡æ•°æ³•æ˜¯ä¸€ä¸ªå¾ˆå¥½ç†è§£çš„ç®—æ³•ã€‚åœ¨å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡æ—¶ï¼Œå°±å°†è®¡æ•°å™¨å€¼åŠ ä¸€ï¼›å½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨å€¼å‡ä¸€ã€‚ä»»ä½•æ—¶åˆ»è®¡æ•°å™¨å€¼ä¸ºé›¶çš„å¯¹è±¡å¯è®¤ä¸ºæ˜¯â€œæ­»äº¡â€çš„ã€‚</p><p>ä¸€åˆ‡éƒ½çœ‹ä¼¼å¾ˆæ­£å¸¸ï¼Œä½†å®é™…ä¸Šå­˜åœ¨å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚è¯·çœ‹ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReferenceCountingGc</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> Object instance;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] bigSize = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2</span> * <span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testGc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ReferenceCountingGc objA = <span class="keyword">new</span> ReferenceCountingGc();</span><br><span class="line">        ReferenceCountingGc objB = <span class="keyword">new</span> ReferenceCountingGc();</span><br><span class="line">        objA.instance = objB;</span><br><span class="line">        objB.instance = objA;</span><br><span class="line">        objA = <span class="keyword">null</span>;</span><br><span class="line">        objB = <span class="keyword">null</span>;</span><br><span class="line">        System.gc();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        testGc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æï¼š<code>testGc()</code>æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œ<code>JVM</code>åŒæ­¥åˆ›å»ºä¸€ä¸ªæ ˆå¸§å‹å…¥å½“å‰æ‰§è¡Œçº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆä¸­ï¼Œéšåï¼Œè™šæ‹Ÿæœºæ ˆä¸­å­˜åœ¨ä¸¤ä¸ªå¼•ç”¨<code>objA</code>å’Œ<code>objB</code>åˆ†åˆ«æŒ‡å‘å †å†…çš„ä¸¤ä¸ª<code>new ReferenceCountingGc()</code>å¯¹è±¡ï¼Œç„¶åï¼Œå †å†…ä¸¤ä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡<code>instance</code>äº’ç›¸æŒ‡å‘å¯¹æ–¹ï¼Œå†ç„¶åï¼Œå°†è™šæ‹Ÿæœºæ ˆå†…çš„å¼•ç”¨æŒ‡å‘<code>null</code>ï¼Œæœ€åè§¦å‘<code>gc</code>ã€‚æ­¤æ—¶ï¼Œå †å†…çš„è¿™ä¸¤ä¸ªå¯¹è±¡äº’ç›¸å¼•ç”¨ç€å¯¹æ–¹ï¼Œå¼•ç”¨è®¡æ•°å™¨çš„å€¼ä¸ä¸ºé›¶ï¼Œä½†å®ƒä»¬å·²ç»æ— æ³•å†ç”±ç¨‹åºè¿›è¡Œè®¿é—®äº†ï¼Œæ‰€ä»¥å¦‚æœé‡‡ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡å°†æ— æ³•è¢«å›æ”¶ï¼Œå³ä¼šå‡ºç°å†…å­˜æ³„éœ²é—®é¢˜ã€‚</p><h2 id="å¯è¾¾æ€§åˆ†æç®—æ³•"><a href="#å¯è¾¾æ€§åˆ†æç®—æ³•" class="headerlink" title="å¯è¾¾æ€§åˆ†æç®—æ³•"></a>å¯è¾¾æ€§åˆ†æç®—æ³•</h2><p>ç°ä»£æ ‡å‡†è™šæ‹Ÿæœºéƒ½æ˜¯é‡‡ç”¨å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»ã€‚åŸºæœ¬æ€è·¯æ˜¯é€šè¿‡ä¸€ç³»åˆ—ç§°ä¸º<code>GC Roots</code>çš„æ ¹å¯¹è±¡ä½œä¸ºèµ·å§‹èŠ‚ç‚¹é›†ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹ï¼Œæ ¹æ®å¼•ç”¨å…³ç³»å‘ä¸‹æœç´¢ï¼Œæœç´¢è¿‡ç¨‹æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºâ€œå¼•ç”¨é“¾â€ï¼Œå¦‚æœæŸä¸ªå¯¹è±¡åˆ°<code>GC Roots</code>é—´æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼Œåˆ™ç§°è¯¥å¯¹è±¡æ˜¯ä¸å¯è¾¾çš„ï¼Œå³éœ€è¦è¢«å›æ”¶ã€‚</p><p>åœ¨<code>Java</code>æŠ€æœ¯ä½“ç³»é‡Œï¼Œå›ºå®šå¯ä½œä¸º<code>GC Roots</code>çš„å¯¹è±¡åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li>åœ¨è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ï¼Œä¾‹å¦‚å„ä¸ªçº¿ç¨‹è¢«è°ƒç”¨çš„æ–¹æ³•å †æ ˆä¸­ä½¿ç”¨åˆ°çš„å‚æ•°ã€å±€éƒ¨å˜é‡ã€ä¸´æ—¶å˜é‡ç­‰ã€‚</li><li>åœ¨æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ï¼Œå³ä¸€ä¸ª<code>Java</code>ç±»çš„å¼•ç”¨ç±»å‹é™æ€å˜é‡ã€‚</li><li>åœ¨æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å¼•ç”¨ã€‚</li><li>åœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­æœ¬åœ°<code>Native</code>æ–¹æ³•å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li>è™šæ‹Ÿæœºå†…éƒ¨çš„å¼•ç”¨ï¼Œä¾‹å¦‚åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„<code>Class</code>å¯¹è±¡ï¼›ä¸€äº›å¸¸é©»çš„å¼‚å¸¸ç±»å¯¹è±¡ï¼Œä¾‹å¦‚<code>NullPointException</code>å’Œ<code>OutOfMemoryError</code>ç­‰ï¼Œå¦å¤–è¿˜æœ‰ç³»ç»Ÿç±»åŠ è½½å™¨ç±»å¯¹è±¡ã€‚</li><li>æ‰€æœ‰è¢«åŒæ­¥é”ï¼ˆ<code>synchronized</code>ï¼‰æŒæœ‰çš„å¯¹è±¡ã€‚</li><li>ååº”è™šæ‹Ÿæœºå†…éƒ¨æƒ…å†µçš„<code>JMXBean</code>ã€<code>JVMTI</code>ä¸­æ³¨å†Œçš„å›è°ƒå’Œæœ¬åœ°ä»£ç ç¼“å­˜ç­‰ã€‚</li></ul><p>ä»¥ä¸Šæ˜¯å›ºå®šä½œä¸º<code>GC Roots</code>èŠ‚ç‚¹é›†çš„å¯¹è±¡ï¼Œä½†è™šæ‹Ÿæœºè¿˜ä¼šæ ¹æ®æ‰€é€‰åƒåœ¾æ”¶é›†å™¨å’Œå½“å‰è¿›è¡Œåƒåœ¾å›æ”¶çš„å†…å­˜åŒºåŸŸï¼Œå¯ä»¥å°†ä¸€äº›å…¶å®ƒå¯¹è±¡â€œä¸´æ—¶æ€§â€åœ°åŠ å…¥èŠ‚ç‚¹é›†ï¼Œå…±åŒç»„æˆå®Œæ•´çš„<code>GC Roots</code>é›†åˆï¼Œç¡®ä¿å¯è¾¾æ€§åˆ†æçš„æ­£ç¡®æ€§ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>ã€Šæ·±å…¥ç†è§£<code>Java</code>è™šæ‹Ÿæœºï¼š<code>JVM</code>é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬<code>3</code>ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜</li></ul>]]></content>
      
      
      <categories>
          
          <category> JVM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaè™šæ‹Ÿæœºæ˜¯å¦‚ä½•è¿è¡Œå­—èŠ‚ç çš„</title>
      <link href="2020/07/20/javase/jvm/run-class/"/>
      <url>2020/07/20/javase/jvm/run-class/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸ºä»€ä¹ˆJavaç¨‹åºè¦åœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆJavaç¨‹åºè¦åœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆJavaç¨‹åºè¦åœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼Ÿ"></a>ä¸ºä»€ä¹ˆ<code>Java</code>ç¨‹åºè¦åœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼Ÿ</h2><p><code>Java</code>ç¨‹åºçš„è¿è¡Œç¦»ä¸å¼€<code>Java</code>è¿è¡Œæ—¶ç¯å¢ƒï¼Œåˆç§°ä¸º<code>JRE</code>ï¼Œå®ƒæ˜¯<code>Java</code>ç¨‹åºçš„æœ€å°å¯è¿è¡Œç¯å¢ƒï¼ŒåŒ…å«<code>Java</code>è™šæ‹Ÿæœºå’Œ<code>Java</code>çš„æ ¸å¿ƒç±»åº“ã€‚æˆ‘ä»¬æ¯å¤©éƒ½åœ¨æ¥è§¦çš„<code>JDK</code>å®é™…ä¸Šå°±åŒ…å«äº†<code>JRE</code>ï¼ŒåŒæ—¶åœ¨<code>/bin</code>ç›®å½•ä¸‹è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„å°å·¥å…·ç­‰ã€‚</p><p>å®ƒä»¬çš„èŒƒå›´å¤§å°æ¯”è¾ƒå…³ç³»æ˜¯ï¼š<code>JDK</code> &gt; <code>JRE</code> &gt; <code>JVM</code>ã€‚</p><p>å¯¹äºè™šæ‹Ÿæœºæ¥è¯´ï¼Œå®ƒæ‰€èƒ½è¿è¡Œçš„æ˜¯ä»¥<code>.class</code>ç»“å°¾çš„å­—èŠ‚ç æ–‡ä»¶ï¼Œæˆ‘ä»¬å¹³æ—¶å†™çš„<code>.java</code>æºæ–‡ä»¶éƒ½éœ€è¦ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘æˆå­—èŠ‚ç ã€‚</p><p>é€šä¿—ä¸€ç‚¹è¯´ï¼Œè™šæ‹Ÿæœºåªè®¤å­—èŠ‚ç ï¼Œä¸ç®¡ä½ æ˜¯ä¸æ˜¯<code>Java</code>è¯­è¨€ï¼Œåªè¦ä½ èƒ½ç¼–è¯‘æˆå­—èŠ‚ç å°±èƒ½åœ¨æˆ‘çš„è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼Œä¾‹å¦‚Scalaè¯­è¨€ï¼Œå®ƒå¯ä»¥è¢«ç¼–è¯‘æˆå­—èŠ‚ç è¿è¡Œåœ¨<code>Java</code>è™šæ‹Ÿæœºä¸Šï¼Œä¸”å¯ä»¥è°ƒç”¨<code>Java</code>çš„æ‰€æœ‰ç±»åº“ã€‚</p><p>å­—èŠ‚ç çš„æ„ä¹‰åœ¨äºä»€ä¹ˆå‘¢ï¼Ÿåœ¨äºåªè¦æœ‰äº†å­—èŠ‚ç ï¼Œå°±å¯ä»¥åœ¨ä¸åŒå¹³å°çš„è™šæ‹Ÿæœºå®ç°ä¸Šè¿è¡Œï¼Œå³ï¼šâ€œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚</p><p>è™šæ‹Ÿæœºçš„å¦ä¸€ä¸ªç‰¹ç‚¹æ˜¯å®ƒèƒ½å¤Ÿè¿›è¡Œè‡ªåŠ¨å†…å­˜ç®¡ç†å’Œåƒåœ¾å›æ”¶ï¼Œä¸åƒ<code>C++</code>è¯­è¨€é‚£æ ·éœ€è¦å¼€å‘è€…æ‰‹åŠ¨è¿›è¡Œå†…å­˜çš„åˆ†é…ä¸å›æ”¶ï¼Œè¿™ä¸€ç‚¹æœ‰åˆ©ä¹Ÿæœ‰å¼Šï¼Œâ€œåˆ©â€æ˜¯æ–¹ä¾¿äº†å¼€å‘è€…ï¼Œæ— éœ€è¿‡å¤šå…³æ³¨å†…å­˜ï¼Œå°†ç²¾åŠ›æ”¾åœ¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘ä¸Šï¼›â€œå¼Šâ€æ˜¯å¯èƒ½ä¼šç”±äºå¼€å‘è€…çš„å°å¤±è¯¯ï¼Œå¯¼è‡´å†…å­˜æº¢å‡ºï¼Œä»è€Œä½¿ç¨‹åºå´©æºƒã€‚äºæ˜¯å†…å­˜ç®¡ç†å’Œåƒåœ¾å›æ”¶å‡ºç°äº†ä¸€äº›å¯ä»¥è°ƒä¼˜çš„åœ°æ–¹ã€‚</p><h2 id="è™šæ‹Ÿæœºæ˜¯å¦‚ä½•è¿è¡Œå­—èŠ‚ç çš„ï¼Ÿ"><a href="#è™šæ‹Ÿæœºæ˜¯å¦‚ä½•è¿è¡Œå­—èŠ‚ç çš„ï¼Ÿ" class="headerlink" title="è™šæ‹Ÿæœºæ˜¯å¦‚ä½•è¿è¡Œå­—èŠ‚ç çš„ï¼Ÿ"></a>è™šæ‹Ÿæœºæ˜¯å¦‚ä½•è¿è¡Œå­—èŠ‚ç çš„ï¼Ÿ</h2><p>ä»è™šæ‹Ÿæœºè§†è§’çœ‹ï¼Œæ‰§è¡Œ<code>Java</code>ä»£ç é¦–å…ˆéœ€è¦å°†å®ƒè¢«ç¼–è¯‘è€Œæˆçš„<code>.class</code>å­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°<code>Java</code>è™šæ‹Ÿæœºä¸­ï¼ŒåŠ è½½åçš„<code>Java</code>ç±»ä¼šè¢«å­˜æ”¾è‡³æ–¹æ³•åŒºä¸­ï¼Œå®é™…è¿è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºä¼šæ‰§è¡Œæ–¹æ³•åŒºå†…çš„ä»£ç ã€‚</p><p>å¯¹äºè™šæ‹Ÿæœºæ¥è¯´ï¼Œåœ¨å®é™…è¿è¡Œæ—¶ä¼šæŠŠå®ƒæ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚è¿™äº›åŒºåŸŸæœ‰å„è‡ªçš„ç”¨é€”ï¼Œä»¥åŠåˆ›å»ºå’Œé”€æ¯çš„æ—¶é—´ï¼Œæœ‰äº›åŒºåŸŸçš„ç”Ÿå‘½å‘¨æœŸå’Œè™šæ‹Ÿæœºè¿›ç¨‹ä¸€è‡´ï¼Œè€Œæœ‰äº›åŒºåŸŸçš„ç”Ÿå‘½å‘¨æœŸå’Œç”¨æˆ·çº¿ç¨‹ä¿æŒä¸€è‡´ã€‚</p><h3 id="è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ"><a href="#è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ" class="headerlink" title="è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ"></a>è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ</h3><p>æ ¹æ®ã€Š<code>Java</code>è™šæ‹Ÿæœºè§„èŒƒã€‹çš„è§„å®šï¼Œè¿è¡Œæ—¶æœŸè™šæ‹Ÿæœºå†…éƒ¨åŒºåŸŸåˆ’åˆ†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/jvm/runtime-data-area.png" alt="è¿è¡Œæ—¶æ•°æ®åŒº"></p><p>è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸è¯´çš„<code>JVM</code>å†…å­˜æ¨¡å‹ã€‚ä¸‹é¢æˆ‘ä»¬å¯¹æ¯ä¸ªåŒºåŸŸè¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚</p><ol><li>ç¨‹åºè®¡æ•°å™¨</li></ol><p>è¿™æ˜¯ä¸€å—æ¯”è¾ƒå°çš„å†…å­˜åŒºåŸŸï¼Œç®€å•çš„ç†è§£å°±æ˜¯è®°å½•äº†å½“å‰çº¿ç¨‹æ­£åœ¨è¿è¡Œçš„å­—èŠ‚ç çš„è¡Œæ•°ã€‚å¯¹äºå•æ ¸<code>CPU</code>æ¥è¯´ï¼Œå®ç°å¤šçº¿ç¨‹çš„æ–¹å¼æ˜¯è¿›è¡Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œçº¿ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­è¢«æŒ‚èµ·ï¼Œå½“å†æ¬¡åˆ‡æ¢å›æ¥æ—¶éœ€è¦å›åˆ°ä¹‹å‰è¿è¡Œçš„ä½ç½®ï¼Œç¨‹åºè®¡æ•°å™¨å°±æ˜¯æ¥è®°å½•è¯¥ä½ç½®çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œæ¯ä¸ªçº¿ç¨‹å„è‡ªè®°å½•å„è‡ªçš„ï¼Œä¸ä¼šå‡ºç°<code>OutOfMemoryError</code>é”™è¯¯ï¼Œå®ƒæ˜¯çº¿ç¨‹éš”ç¦»çš„æ•°æ®åŒºã€‚</p><ol start="2"><li>è™šæ‹Ÿæœºæ ˆ</li></ol><p>è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯<code>Java</code>æ–¹æ³•æ‰§è¡Œçš„çº¿ç¨‹å†…å­˜æ¨¡å‹ï¼Œåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¯å½“è°ƒç”¨ä¸€ä¸ª<code>Java</code>æ–¹æ³•ï¼Œè™šæ‹Ÿæœºä¼šåœ¨å½“å‰çº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆä¸­åŒæ­¥åˆ›å»ºä¸€ä¸ªæ ˆå¸§ç”¨æ¥å­˜å‚¨è¯¥æ–¹æ³•çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€è¿æ¥å’Œæ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚å½“é€€å‡ºå½“å‰è°ƒç”¨çš„æ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºæ ˆä¼šå¼¹å‡ºè¯¥æ ˆå¸§ï¼Œæ— è®ºæ˜¯æ­£å¸¸è¿”å›è¿˜æ˜¯å¼‚å¸¸é€€å‡ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€ä¸ª<code>Java</code>æ–¹æ³•çš„è°ƒç”¨åˆ°ç»“æŸéƒ½å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨å½“å‰çº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ã€‚</p><p>å±€éƒ¨å˜é‡è¡¨å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„<code>Java</code>åŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å¼•ç”¨å’Œ<code>returnAddress</code>ç±»å‹ï¼ˆæŒ‡å‘æ–¹æ³•<code>return</code>è¿”å›åå°†è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼‰ã€‚å…¶ä¸­åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆ<code>boolean</code>/<code>byte</code>/<code>char</code>/<code>short</code>/<code>int</code>/<code>float</code>/<code>long</code>/<code>double</code>ï¼‰åœ¨å±€éƒ¨å˜é‡è¡¨ä¸­ä»¥å±€éƒ¨å˜é‡æ§½çš„å½¢å¼è¡¨ç¤ºï¼Œé•¿åº¦ä¸º<code>64</code>çš„<code>double</code>å’Œ<code>long</code>ç±»å‹ä¼šå ç”¨ä¸¤ä¸ªå˜é‡æ§½ï¼Œå…¶ä½™çš„éƒ½åªä¼šå ç”¨ä¸€ä¸ªå˜é‡æ§½ã€‚å½“ä¸€ä¸ªæ–¹æ³•å¼€å§‹æ‰§è¡Œæ—¶ï¼Œæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨å†…å­˜å¤§å°å°±å·²ç»ç¡®å®šäº†ï¼Œä¸ä¼šåœ¨è¿è¡ŒæœŸé—´åŠ¨æ€æ”¹å˜ã€‚</p><p>å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ ˆæ‰€å…è®¸çš„æ·±åº¦ï¼ˆé€’å½’è°ƒç”¨ï¼‰ï¼Œå°†æŠ›å‡º<code>StackOverflowError</code>å¼‚å¸¸ï¼›å¦‚æœçº¿ç¨‹ç”³è¯·æ ˆç©ºé—´æ—¶ç©ºé—´ä¸è¶³ï¼Œåˆ™ä¼šæŠ›å‡º<code>OutOfMemoryError</code>å¼‚å¸¸ã€‚</p><ol start="3"><li>æœ¬åœ°æ–¹æ³•æ ˆ</li></ol><p>æœ¬åœ°æ–¹æ³•æ ˆæè¿°çš„æ˜¯æœ¬åœ°<code>Native</code>æ–¹æ³•æ‰§è¡Œçš„çº¿ç¨‹æ¨¡å‹ï¼Œå…¶ä½œç”¨ä¸è™šæ‹Ÿæœºæ ˆä¸€è‡´ã€‚</p><ol start="4"><li>å †</li></ol><p>å †å†…å­˜æ˜¯è™šæ‹Ÿæœºç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸå’Œè™šæ‹Ÿæœºè¿›ç¨‹ä¿æŒä¸€è‡´ã€‚æœ‰ä¸€å¥è¯æ˜¯è¿™æ ·è¯´çš„ï¼šâ€œ<code>new</code>å‡ºæ¥çš„å¯¹è±¡éƒ½åœ¨å †ä¸Šâ€ã€‚å †å†…å­˜æ˜¯åƒåœ¾æ”¶é›†å™¨æ‰€ç®¡ç†çš„å†…å­˜åŒºåŸŸï¼Œç°ä»£åƒåœ¾æ”¶é›†å™¨å¤§éƒ¨åˆ†æ˜¯åŸºäºåˆ†ä»£æ”¶é›†ç†è®ºè®¾è®¡çš„ï¼Œæ‰€ä»¥å †å†…å­˜åˆè¢«ç»†åˆ†ä¸ºâ€œæ–°ç”Ÿä»£â€ã€â€œè€å¹´ä»£â€ã€â€œæ°¸ä¹…ä»£â€ã€â€œEdenåŒºâ€ã€â€œFrom SurvivoråŒºâ€å’Œâ€œTo SurvivoråŒºâ€ã€‚å†æ¬¡ç»†åˆ’å‡ºè¿™äº›åŒºåŸŸçš„åŸå› åªæ˜¯ä¸ºäº†æ›´å¥½çš„çš„åˆ†é…å’Œå›æ”¶å†…å­˜ã€‚</p><p>å †å†…å­˜æ˜¯æ”¯æŒæ‰©å±•çš„ï¼Œå¯é€šè¿‡å‚æ•°<code>-Xmx</code>ï¼ˆæœ€å¤§å †å†…å­˜ï¼‰å’Œ<code>-Xms</code>ï¼ˆæœ€å°å †å†…å­˜ï¼‰è®¾ç½®ã€‚ä¸ºäº†é¿å…<code>GC</code>åå †å†…å­˜é‡æ–°åˆ†é…ï¼Œé€šå¸¸å°†ä¸¤è€…çš„å€¼è®¾ä¸ºä¸€æ ·ã€‚</p><ol start="5"><li>æ–¹æ³•åŒº</li></ol><p>æ–¹æ³•åŒºæ˜¯å­˜æ”¾å­—èŠ‚ç çš„å†…å­˜åŒºåŸŸï¼Œå½“ä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶è¢«åŠ è½½åï¼Œä¼šå°†å…¶å¯¹åº”ç±»å‹ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡å’Œå³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç¼“å­˜ç­‰æ•°æ®ä¿å­˜è‡³æ–¹æ³•åŒºã€‚</p><p>è¯´åˆ°æ–¹æ³•åŒºï¼Œä¸å¾—ä¸è¯´åˆ°æ°¸ä¹…ä»£çš„æ¦‚å¿µï¼Œåœ¨è™šæ‹Ÿæœºçš„æ—©æœŸå®ç°ä¸­ï¼Œæ ‡å‡†<code>HotSpot</code>è™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†å™¨æ‰€ç®¡ç†çš„å†…å­˜åŒºåŸŸåŒ…å«äº†æ–¹æ³•åŒºï¼Œæ‰€ä»¥æ–¹æ³•åŒºåˆè¢«ç§°ä¸ºæ°¸ä¹…ä»£ï¼Œä½†å®é™…ä¸Š<code>HotSpot</code>è™šæ‹Ÿæœºåªæ˜¯ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºï¼Œä¸ºäº†çœå»ä¸“é—¨ä¸ºæ–¹æ³•åŒºæä¾›å†…å­˜ç®¡ç†çš„å·¥ä½œã€‚åœ¨<code>Java6</code>æ—¶ä»£ï¼Œæ°¸ä¹…ä»£å°±è¢«æ”¾å¼ƒäº†ï¼Œæ”¹ä¸ºä½¿ç”¨æœ¬åœ°å†…å­˜æ¥å®ç°æ–¹æ³•åŒºã€‚åˆ°<code>Java7</code>æ—¶ï¼ŒåŸæœ¬å­˜æ”¾åœ¨æ°¸ä¹…ä»£çš„å­—ç¬¦ä¸²å¸¸é‡æ± å’Œé™æ€å˜é‡è¢«ç§»åŠ¨åˆ°å †å†…å­˜ä¸­ã€‚è€Œåˆ°äº†<code>Java8</code>æ—¶ï¼Œæ°¸ä¹…ä»£å®Œå…¨è¢«æŠ›å¼ƒï¼Œå–è€Œä»£ä¹‹çš„æ˜¯æœ¬åœ°å†…å­˜ä¸­çš„å…ƒç©ºé—´ï¼ŒåŸæœ¬å­˜åœ¨äºæ°¸ä¹…ä»£ä¸­çš„ç±»å‹ä¿¡æ¯å’Œä»£ç ç¼“å­˜ç­‰æ•°æ®è¢«ç§»åˆ°äº†å…ƒç©ºé—´ä¸­ã€‚</p><ol start="6"><li>è¿è¡Œæ—¶å¸¸é‡æ± </li></ol><p>è¿è¡Œæ—¶å¸¸é‡æ± å±äºæ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå­˜æ”¾çš„æ˜¯å¸¸é‡æ± è¡¨ï¼ŒåŒ…å«å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚è¯¥å†…å­˜åŒºåŸŸå¯ä»¥åœ¨è¿è¡ŒæœŸåŠ¨æ€æ”¹å˜ï¼Œå¸¸ç”¨çš„æ˜¯<code>String</code>ç±»çš„<code>intern()</code>æ–¹æ³•ï¼Œå—æ–¹æ³•åŒºå†…å­˜å¤§å°é™åˆ¶ï¼Œè¯¥åŒºåŸŸä¹Ÿä¼šæŠ›å‡º<code>OutOfMemoryError</code>å¼‚å¸¸ã€‚</p><h3 id="å­—èŠ‚ç å¦‚ä½•è¢«æ‰§è¡Œï¼Ÿ"><a href="#å­—èŠ‚ç å¦‚ä½•è¢«æ‰§è¡Œï¼Ÿ" class="headerlink" title="å­—èŠ‚ç å¦‚ä½•è¢«æ‰§è¡Œï¼Ÿ"></a>å­—èŠ‚ç å¦‚ä½•è¢«æ‰§è¡Œï¼Ÿ</h3><p>å¯¹äº<code>HotSpot</code>è™šæ‹Ÿæœºæ¥è¯´ï¼Œå®ƒæ‰€åšçš„å·¥ä½œæ˜¯å°†å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç ã€‚è€Œç¿»è¯‘æœ‰ä¸¤ç§å½¢å¼ï¼šç¬¬ä¸€ç§æ˜¯è§£é‡Šæ‰§è¡Œï¼Œé€æ¡å°†å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç å¹¶æ‰§è¡Œï¼›ç¬¬äºŒç§æ˜¯å³æ—¶ç¼–è¯‘ï¼Œå°†ä¸€ä¸ªæ–¹æ³•æ‰€åŒ…å«çš„æ‰€æœ‰å­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨ç åå†æ‰§è¡Œã€‚</p><p>å‰è€…çš„ä¼˜ç‚¹æ˜¯æ— éœ€ç­‰å¾…ç¼–è¯‘ï¼Œè€Œåè€…çš„ä¼˜ç‚¹æ˜¯å®é™…è¿è¡Œé€Ÿåº¦æ›´å¿«ã€‚<code>HotSpot</code>è™šæ‹Ÿæœºé‡‡ç”¨äº†æ··åˆæ¨¡å¼ï¼Œç»¼åˆä¸¤ç§å½¢å¼ï¼Œå…ˆè§£é‡Šæ‰§è¡Œå­—èŠ‚ç ï¼Œé€šè¿‡çƒ­ç‚¹ä»£ç æ¢æµ‹æŠ€æœ¯å‘ç°çƒ­ç‚¹ä»£ç åï¼Œä»¥æ–¹æ³•ä¸ºå•ä½è¿›è¡Œå³æ—¶ç¼–è¯‘ã€‚</p><p><code>HotSpot</code>è™šæ‹ŸæœºåŒ…å«å¤šä¸ªå³æ—¶ç¼–è¯‘å™¨ï¼š<code>C1</code>å’Œ<code>C2</code>ç­‰ã€‚</p><p><code>C1</code>åˆå«åš<code>Client</code>ç¼–è¯‘å™¨ï¼Œé¢å‘çš„æ˜¯å¯¹å¯åŠ¨æ€§èƒ½æœ‰è¦æ±‚çš„å®¢æˆ·ç«¯<code>GUI</code>ç¨‹åºï¼Œé‡‡ç”¨çš„ä¼˜åŒ–æ‰‹æ®µç›¸å¯¹ç®€å•ï¼Œå› æ­¤ç¼–è¯‘æ—¶é—´è¾ƒçŸ­ã€‚</p><p><code>C2</code>åˆå«åš<code>Server</code>ç¼–è¯‘å™¨ï¼Œé¢å‘çš„æ˜¯å¯¹å³°å€¼æ€§èƒ½æœ‰è¦æ±‚çš„æœåŠ¡ç«¯ç¨‹åºï¼Œé‡‡ç”¨çš„ä¼˜åŒ–æ‰‹æ®µç›¸å¯¹å¤æ‚ï¼Œå› æ­¤ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œä½†ç”Ÿæˆçš„æœºå™¨ç çš„æ‰§è¡Œæ•ˆç‡æ›´é«˜ã€‚</p><p>ä»<code>Java7</code>å¼€å§‹ï¼Œ<code>HotSpot</code>é‡‡ç”¨åˆ†å±‚ç¼–è¯‘ï¼šçƒ­ç‚¹æ–¹æ³•é¦–å…ˆä¼šè¢«<code>C1</code>ç¼–è¯‘ï¼Œç„¶åçƒ­ç‚¹æ–¹æ³•ä¸­çš„çƒ­ç‚¹ä¼šè¿›ä¸€æ­¥è¢«<code>C2</code>ç¼–è¯‘ã€‚ä¸ºäº†ä¸å½±å“ç¨‹åºçš„æ­£å¸¸è¿è¡Œï¼Œçƒ­ç‚¹æ–¹æ³•çš„ç¼–è¯‘æ˜¯æ”¾åœ¨å­çº¿ç¨‹ä¸­è¿›è¡Œçš„ã€‚<code>HotSpot</code>ä¼šæ ¹æ®<code>CPU</code>çš„æ ¸æ•°è®¾ç½®å³æ—¶ç¼–è¯‘çš„çº¿ç¨‹æ•°ï¼Œå¹¶æŒ‰ç…§<code>1:2</code>çš„æ¯”ä¾‹åˆ†é…ç»™<code>C1</code>å’Œ<code>C2</code>ç¼–è¯‘å™¨ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>ã€Šæ·±å…¥ç†è§£<code>Java</code>è™šæ‹Ÿæœºï¼š<code>JVM</code>é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬<code>3</code>ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜</li><li>ã€Šæ·±å…¥æ‹†è§£<code>Java</code>è™šæ‹Ÿæœºã€‹ - æå®¢æ—¶é—´</li></ul>]]></content>
      
      
      <categories>
          
          <category> JVM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½•ä¸ºå¼•ç”¨</title>
      <link href="2020/07/20/javase/jvm/what-is-quote/"/>
      <url>2020/07/20/javase/jvm/what-is-quote/</url>
      
        <content type="html"><![CDATA[<p>æ— è®ºæ˜¯é€šè¿‡å¼•ç”¨è®¡æ•°ç®—æ³•è¿˜æ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»éƒ½ç¦»ä¸å¼€â€œå¼•ç”¨â€è¿™ä¸ªæ¦‚å¿µï¼Œé‚£åˆ°åº•ä»€ä¹ˆæ˜¯â€œå¼•ç”¨â€å‘¢ï¼Ÿ</p><p><code>Java</code>è¯­è¨€ä¸­ç‹­éš˜çš„â€œå¼•ç”¨â€å®šä¹‰æ˜¯ï¼šå¦‚æœ<code>Reference</code>ç±»å‹çš„æ•°æ®ä¸­å­˜å‚¨çš„æ•°å€¼ä»£è¡¨çš„æ˜¯å¦ä¸€å—å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€ï¼Œå°±ç§°è¯¥<code>Reference</code>æ•°æ®æ˜¯ä»£è¡¨æŸå—å†…å­˜ï¼ˆæŸä¸ªå¯¹è±¡ï¼‰çš„å¼•ç”¨ã€‚åœ¨è¿™ç§å®šä¹‰ä¸‹ï¼Œä¸€ä¸ªå¯¹è±¡åªå­˜åœ¨ä¸¤ç§çŠ¶æ€ï¼šâ€œè¢«å¼•ç”¨â€/â€œæœªè¢«å¼•ç”¨â€ã€‚è¿™æ ·çš„å®šä¹‰å¾ˆä¸¥è°¨ï¼Œä½†å´ç¼ºå°‘äº†ä¸€ç‚¹çµæ´»çš„ç©ºé—´ï¼Œå°±åƒè¿™ä¸ªç¤¾ä¼šä¸€æ ·ï¼Œä¸æ˜¯æ‰€æœ‰äººéƒ½å€¼å¾—æ´»ç€ï¼Œé‚£äº›äººæ°‘å­å¼Ÿå…µå€¼å¾—æ°¸è¿œå­˜åœ¨ï¼Œä½†é‚£äº›çŠ¯ç½ªçš„æ¶å¾’å¤šæ´»ä¸€ç§’éƒ½æ˜¯å¯¹ç¤¾ä¼šçš„æ±¡æŸ“ã€‚åœ¨<code>Java</code>ä¸­ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå †ä¸Šçš„å¯¹è±¡ä¸æ˜¯æ‰€æœ‰çš„éƒ½æ˜¯å¿…é¡»çš„ï¼Œå½“å†…å­˜ç©ºé—´å‡ºç°ç´§å¼ æ—¶ï¼Œä¸€äº›å¯¹è±¡å°†ä¼šè¢«æŠ›å¼ƒã€‚</p><p>åœ¨<code>JDK 1.2</code>ç‰ˆæœ¬åï¼Œ<code>Java</code>ä¸­çš„å¼•ç”¨åˆ†ä¸ºå››ç§ç±»å‹ï¼šå¼ºå¼•ç”¨ï¼ˆ<code>Strongly Reference</code>ï¼‰ã€è½¯å¼•ç”¨ï¼ˆ<code>Soft Reference</code>ï¼‰ã€å¼±å¼•ç”¨ï¼ˆ<code>Weak Reference</code>ï¼‰å’Œè™šå¼•ç”¨ï¼ˆ<code>Phantom Reference</code>ï¼‰ï¼Œè¿™å››ç§å¼•ç”¨å¼ºåº¦ä¾æ¬¡å‡å¼±ã€‚</p><ol><li>å¼ºå¼•ç”¨ï¼ˆ<code>Strongly Reference</code>ï¼‰</li></ol><p>å¼ºå¼•ç”¨æ˜¯ç‹­éš˜çš„å¼•ç”¨å®šä¹‰ï¼Œè¢«å¼•ç”¨çš„å¯¹è±¡åªä¼šå‡ºç°ä¸¤ç§çŠ¶æ€ï¼šâ€œè¢«å¼•ç”¨â€å’Œâ€œæœªè¢«å¼•ç”¨â€ã€‚è¿™ç§å¼•ç”¨å…³ç³»å¾ˆå¸¸è§ï¼Œå³ç±»ä¼¼äº<code>Object obj = new Object()</code>è¿™ç§ç›´æ¥èµ‹å€¼çš„ï¼Œåªè¦å¼ºå¼•ç”¨å…³ç³»è¿˜åœ¨ï¼Œå †å†…çš„å¯¹è±¡å°±æ°¸è¿œä¸ä¼šè¢«å›æ”¶ã€‚</p><ol start="2"><li>è½¯å¼•ç”¨ï¼ˆ<code>Soft Reference</code>ï¼‰</li></ol><p>è½¯å¼•ç”¨æè¿°çš„æ˜¯è¿˜æœ‰ç”¨ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„ä¸€ç±»å¯¹è±¡ã€‚åªè¢«è½¯å¼•ç”¨å…³è”ç€çš„å¯¹è±¡åœ¨è™šæ‹Ÿæœºå°†è¦å‘ç”Ÿå†…å­˜æº¢å‡ºå‰ï¼Œä¼šå°†è¿™ç±»å¯¹è±¡åˆ—è¿›å›æ”¶èŒƒå›´ä¹‹ä¸­è¿›è¡ŒäºŒæ¬¡å›æ”¶ï¼Œå¦‚æœå°†å®ƒä»¬å›æ”¶å®Œæˆåå†…å­˜è¿˜æ˜¯ä¸è¶³ï¼Œæ‰ä¼šæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚<code>Java</code>ä¸­æä¾›<code>SoftReference</code>ç±»å®ç°è½¯å¼•ç”¨ã€‚</p><ol start="3"><li>å¼±å¼•ç”¨ï¼ˆ<code>Weak Reference</code>ï¼‰</li></ol><p>å¼±å¼•ç”¨æè¿°çš„ä¹Ÿæ˜¯é‚£äº›éå¿…é¡»å¯¹è±¡ï¼Œä½†å®ƒçš„å¼ºåº¦æ¯”è½¯å¼•ç”¨è¦å¼±ä¸€ç‚¹ï¼Œè¢«å¼±å¼•ç”¨å…³è”ç€çš„å¯¹è±¡åªèƒ½æ´»åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶å‘ç”Ÿçš„æ—¶åˆ»ã€‚å½“åƒåœ¾å›æ”¶å¼€å§‹å·¥ä½œæ—¶ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶æ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚<code>Java</code>ä¸­æä¾›äº†<code>WeakReference</code>ç±»å®ç°å¼±å¼•ç”¨ã€‚</p><ol start="4"><li>è™šå¼•ç”¨ï¼ˆ<code>Phantom Reference</code>ï¼‰</li></ol><p>è™šå¼•ç”¨æ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨çš„å­˜åœ¨ï¼Œå®Œå…¨ä¸ä¼šå½±å“è¯¥å¯¹è±¡çš„ç”Ÿå­˜å‘¨æœŸï¼Œä¹Ÿæ— æ³•é€šè¿‡è™šå¼•ç”¨å¾—åˆ°ä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„åªæ˜¯ä¸ºäº†èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚<code>Java</code>ä¸­æä¾›äº†<code>PhantomReference</code>ç±»å®ç°è™šå¼•ç”¨ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>ã€Šæ·±å…¥ç†è§£<code>Java</code>è™šæ‹Ÿæœºï¼š<code>JVM</code>é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬<code>3</code>ç‰ˆï¼‰ã€‹ - å‘¨å¿—æ˜</li></ul>]]></content>
      
      
      <categories>
          
          <category> JVM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‹‡é—¯ç®—æ³•-åœ¨è¡Œåˆ—éƒ½æ’å¥½åºçš„çŸ©é˜µä¸­æ‰¾æŒ‡å®šçš„æ•°</title>
      <link href="2020/07/14/algorithm/coding-interview-guide/arraysandmatrices/solution01/"/>
      <url>2020/07/14/algorithm/coding-interview-guide/arraysandmatrices/solution01/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®æ¥æºï¼šã€Šç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—-ITåä¼ç®—æ³•ä¸æ•°æ®ç»“æ„æœ€ä¼˜è§£ã€‹-å·¦ç¨‹äº‘è‘—</p><p>ç‰›å®¢ç½‘åœ¨çº¿<code>OJ</code>ç³»ç»Ÿåœ°å€ï¼š<a href="https://www.nowcoder.com/practice/b929be9dbbaa489a91afa3fec195c228?tpId=101&tqId=33069&tPage=1&rp=1&ru=/ta/programmer-code-interview-guide&qru=/ta/programmer-code-interview-guide/question-ranking">ä¼ é€é—¨</a></p><h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>ç»™å®šä¸€ä¸ª<code>N Ã— M</code>çš„æ•´å‹çŸ©é˜µ<code>matrix</code>å’Œä¸€ä¸ªæ•´æ•°<code>K</code>ï¼Œ<code>matrix</code>çš„æ¯ä¸€è¡Œæ¯ä¸€åˆ—éƒ½æ˜¯æ’å¥½åºçš„ã€‚å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­<code>K</code>æ˜¯å¦åœ¨<code>matrix</code>ä¸­ã€‚</p><blockquote><p>è¦æ±‚ï¼š</p><p>æ—¶é—´å¤æ‚åº¦ä¸º<code>O(N + M)</code>ï¼Œé¢å¤–ç©ºé—´å¤æ‚åº¦ä¸º<code>O(1)</code>ã€‚</p></blockquote><p>å¤‡æ³¨ï¼š</p><p>1 â©½ N, M â©½1000</p><p>0 â©½ K, çŸ©é˜µä¸­çš„æ•° â©½ 10^9^</p><h2 id="è¾“å…¥æè¿°"><a href="#è¾“å…¥æè¿°" class="headerlink" title="è¾“å…¥æè¿°"></a>è¾“å…¥æè¿°</h2><p>ç¬¬ä¸€è¡Œæœ‰ä¸‰ä¸ªæ•´æ•°<code>N</code>ï¼Œ<code>M</code>ï¼Œ<code>K</code>ï¼›</p><p>æ¥ä¸‹æ¥<code>N</code>è¡Œï¼Œæ¯è¡Œ<code>M</code>ä¸ªæ•´æ•°ä¸ºè¾“å…¥çš„çŸ©é˜µã€‚</p><h2 id="è¾“å‡ºæè¿°"><a href="#è¾“å‡ºæè¿°" class="headerlink" title="è¾“å‡ºæè¿°"></a>è¾“å‡ºæè¿°</h2><p>è‹¥<code>K</code>å­˜åœ¨äºçŸ©é˜µä¸­è¾“å‡º<code>&quot;Yes&quot;</code>ï¼Œå¦åˆ™è¾“å‡º<code>&quot;No&quot;</code>ã€‚</p><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><h3 id="ç¤ºä¾‹ä¸€"><a href="#ç¤ºä¾‹ä¸€" class="headerlink" title="ç¤ºä¾‹ä¸€"></a>ç¤ºä¾‹ä¸€</h3><p>è¾“å…¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2 4 5</span><br><span class="line">1 2 3 4</span><br><span class="line">2 4 5 6</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes</span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹äºŒ"><a href="#ç¤ºä¾‹äºŒ" class="headerlink" title="ç¤ºä¾‹äºŒ"></a>ç¤ºä¾‹äºŒ</h3><p>è¾“å…¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2 4 233</span><br><span class="line">1 2 3 4</span><br><span class="line">2 4 5 6</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">No</span><br></pre></td></tr></table></figure><h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>ç”±äºçŸ©é˜µä¸­çš„è¡Œå’Œåˆ—éƒ½æ˜¯æ’å¥½åºçš„ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æœ€åä¸€åˆ—æ˜¯æ¯ä¸€è¡Œçš„æœ€å¤§å€¼ï¼Œæœ€åä¸€è¡Œæ˜¯æ¯ä¸€åˆ—çš„æœ€å¤§å€¼ã€‚æ•´ä¸ªçŸ©é˜µçš„æœ€å¤§å€¼åœ¨å³ä¸‹è§’ã€‚</p><p>è¦æƒ³å‡å°‘æ—¶é—´å¤æ‚åº¦ï¼Œæˆ‘ä»¬å¿…é¡»èƒ½å¤Ÿå¿«é€Ÿæ’é™¤æŸäº›è¡Œæˆ–åˆ—ï¼ŒåŸºäºæœ€åä¸€åˆ—æˆ–è¡Œæ˜¯æ¯ä¸€è¡Œæˆ–åˆ—çš„æœ€å¤§å€¼çš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä»çŸ©é˜µå³ä¸Šè§’æˆ–å·¦ä¸‹è§’å¼€å§‹æŸ¥æ‰¾ï¼Œå¦‚æœä¸æ˜¯æŒ‡å®šçš„æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ’é™¤æ‰ä¸€è¡Œæˆ–ä¸€åˆ—äº†ã€‚</p><h2 id="ç®—æ³•æ€è·¯"><a href="#ç®—æ³•æ€è·¯" class="headerlink" title="ç®—æ³•æ€è·¯"></a>ç®—æ³•æ€è·¯</h2><h3 id="æ€è·¯ä¸€ï¼šä»çŸ©é˜µå³ä¸Šè§’å¼€å§‹æŸ¥æ‰¾"><a href="#æ€è·¯ä¸€ï¼šä»çŸ©é˜µå³ä¸Šè§’å¼€å§‹æŸ¥æ‰¾" class="headerlink" title="æ€è·¯ä¸€ï¼šä»çŸ©é˜µå³ä¸Šè§’å¼€å§‹æŸ¥æ‰¾"></a>æ€è·¯ä¸€ï¼šä»çŸ©é˜µå³ä¸Šè§’å¼€å§‹æŸ¥æ‰¾</h3><ol><li>ä»çŸ©é˜µæœ€å³ä¸Šè§’çš„æ•°å¼€å§‹æŸ¥æ‰¾ï¼ˆ<code>row=0,col=M-1</code>ï¼šç¬¬<code>0</code>è¡Œï¼Œç¬¬<code>M-1</code>åˆ—ï¼‰ã€‚</li><li>æ¯”è¾ƒå½“å‰æ•°<code>matrix[row][col]</code>ä¸<code>K</code>çš„å…³ç³»ï¼š</li></ol><ul><li>å¦‚æœç­‰äº<code>K</code>ï¼Œåˆ™æ‰¾åˆ°äº†ï¼Œè¿”å›<code>&quot;Yes&quot;</code>ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚</li><li>å¦‚æœå¤§äº<code>K</code>ï¼Œåˆ™è¯¥åˆ—è¢«æ’é™¤ï¼Œä»¤<code>col=col-1</code>ï¼Œé‡å¤æ­¥éª¤<code>2</code>ã€‚</li><li>å¦‚æœå°äº<code>K</code>ï¼Œåˆ™è¯¥è¡Œè¢«æ’é™¤ï¼Œä»¤<code>row=row+1</code>ï¼Œé‡å¤æ­¥éª¤<code>2</code>ã€‚</li></ul><ol start="3"><li>å¦‚æœæ‰¾åˆ°è¶Šç•Œéƒ½æ²¡æœ‰æ‰¾åˆ°ä¸<code>K</code>ç›¸ç­‰çš„æ•°ï¼Œåˆ™è¿”å›<code>&quot;No&quot;</code>ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚</li></ol><h3 id="æ€è·¯äºŒï¼šä»çŸ©é˜µå·¦ä¸‹è§’å¼€å§‹æŸ¥æ‰¾"><a href="#æ€è·¯äºŒï¼šä»çŸ©é˜µå·¦ä¸‹è§’å¼€å§‹æŸ¥æ‰¾" class="headerlink" title="æ€è·¯äºŒï¼šä»çŸ©é˜µå·¦ä¸‹è§’å¼€å§‹æŸ¥æ‰¾"></a>æ€è·¯äºŒï¼šä»çŸ©é˜µå·¦ä¸‹è§’å¼€å§‹æŸ¥æ‰¾</h3><ol><li>ä»çŸ©é˜µæœ€å·¦ä¸Šè§’çš„æ•°å¼€å§‹æŸ¥æ‰¾ï¼ˆ<code>row=N-1,col=0</code>ï¼šç¬¬<code>N-1</code>è¡Œï¼Œç¬¬<code>0</code>åˆ—ï¼‰ã€‚</li><li>æ¯”è¾ƒå½“å‰æ•°<code>matrix[row][col]</code>ä¸<code>K</code>çš„å…³ç³»ï¼š</li></ol><ul><li>å¦‚æœç­‰äº<code>K</code>ï¼Œåˆ™æ‰¾åˆ°äº†ï¼Œè¿”å›<code>&quot;Yes&quot;</code>ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚</li><li>å¦‚æœå¤§äº<code>K</code>ï¼Œåˆ™è¯¥è¡Œè¢«æ’é™¤ï¼Œä»¤<code>row=row-1</code>ï¼Œé‡å¤æ­¥éª¤<code>2</code>ã€‚</li><li>å¦‚æœå°äº<code>K</code>ï¼Œåˆ™è¯¥åˆ—è¢«æ’é™¤ï¼Œä»¤<code>col=col+1</code>ï¼Œé‡å¤æ­¥éª¤<code>2</code>ã€‚</li></ul><ol start="3"><li>å¦‚æœæ‰¾åˆ°è¶Šç•Œéƒ½æ²¡æœ‰æ‰¾åˆ°ä¸<code>K</code>ç›¸ç­‰çš„æ•°ï¼Œåˆ™è¿”å›<code>&quot;No&quot;</code>ï¼Œæ•´ä¸ªè¿‡ç¨‹ç»“æŸã€‚</li></ol><h2 id="ä»£ç å®ç°ï¼ˆJavaï¼‰"><a href="#ä»£ç å®ç°ï¼ˆJavaï¼‰" class="headerlink" title="ä»£ç å®ç°ï¼ˆJavaï¼‰"></a>ä»£ç å®ç°ï¼ˆ<code>Java</code>ï¼‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// receive input params</span></span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">int</span> n = scanner.nextInt();</span><br><span class="line">        <span class="keyword">int</span> m = scanner.nextInt();</span><br><span class="line">        <span class="keyword">int</span> k = scanner.nextInt();</span><br><span class="line">        <span class="comment">// build matrix</span></span><br><span class="line">        <span class="keyword">int</span>[][] matrix = <span class="keyword">new</span> <span class="keyword">int</span>[n][m];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">                matrix[i][j] = scanner.nextInt();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// do check</span></span><br><span class="line">        <span class="keyword">boolean</span> containsOne = isContainsOne(matrix, k);</span><br><span class="line">        System.out.println(containsOne ? <span class="string">&quot;Yes&quot;</span> : <span class="string">&quot;No&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// boolean containsTwo = isContainsTwo(matrix, k);</span></span><br><span class="line">        <span class="comment">// System.out.println(containsTwo ? &quot;Yes&quot; : &quot;No&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­æ–¹å¼ä¸€ï¼šåŒé‡forå¾ªç¯</span></span><br><span class="line"><span class="comment">     * å¤–å±‚å¾ªç¯çŸ©é˜µæ¯ä¸€è¡Œ</span></span><br><span class="line"><span class="comment">     * å†…å±‚å¾ªç¯çŸ©é˜µæ¯ä¸€åˆ—</span></span><br><span class="line"><span class="comment">     * ç›¸ç­‰ç›´æ¥è¿”å›trueï¼›</span></span><br><span class="line"><span class="comment">     * è‹¥å°äºkï¼Œåˆ™æ’é™¤å½“å‰è¡Œï¼Œç»“æŸå†…å±‚å¾ªç¯ï¼Œéå†ä¸‹ä¸€è¡Œã€‚</span></span><br><span class="line"><span class="comment">     * è‹¥å¤§äºkï¼Œåˆ™æ’é™¤å½“å‰åˆ—ï¼Œj--ï¼Œå†…å­˜å¾ªç¯è¿›å…¥ä¸‹ä¸€æ¬¡ã€‚</span></span><br><span class="line"><span class="comment">     * è‹¥åŒé‡å¾ªç¯å®Œæˆéƒ½æœªæ‰¾åˆ°kï¼Œåˆ™è¿”å›falseã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> matrix</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> k</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isContainsOne</span><span class="params">(<span class="keyword">int</span>[][] matrix,<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> col = matrix[<span class="number">0</span>].length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] ints : matrix) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = col - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">                <span class="keyword">int</span> value = ints[j];</span><br><span class="line">                <span class="keyword">if</span> (value == k) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value &lt; k) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­æ–¹å¼äºŒï¼šwhileå¾ªç¯</span></span><br><span class="line"><span class="comment">     * è¶Šç•Œæ¡ä»¶ï¼šè¡Œéå†å®Œæˆ–åˆ—éå†å®Œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> matrix</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> k</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isContainsTwo</span><span class="params">(<span class="keyword">int</span>[][] matrix,<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> row = matrix.length;</span><br><span class="line">        <span class="keyword">int</span> col = matrix[<span class="number">0</span>].length;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> j = col - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; row &amp;&amp; j &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> value = matrix[i][j];</span><br><span class="line">            <span class="keyword">if</span> (value == k) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value &lt; k) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> ç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—-ITåä¼ç®—æ³•ä¸æ•°æ®ç»“æ„æœ€ä¼˜è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeé¢˜è§£-ç¬¬242é¢˜ï¼šæœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯</title>
      <link href="2020/07/14/algorithm/leetcode/easy/242/"/>
      <url>2020/07/14/algorithm/leetcode/easy/242/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²<code>s</code>å’Œ<code>t</code> ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥åˆ¤æ–­<code>t</code>æ˜¯å¦æ˜¯<code>s</code>çš„å­—æ¯å¼‚ä½è¯ã€‚</p><p>ç¤ºä¾‹<code>1</code>:</p><p>è¾“å…¥: <code>s = &quot;anagram&quot;, t = &quot;nagaram&quot;</code><br>è¾“å‡º: <code>true</code></p><p>ç¤ºä¾‹<code>2</code>:</p><p>è¾“å…¥: <code>s = &quot;rat&quot;, t = &quot;car&quot;</code><br>è¾“å‡º: <code>false</code></p><p>è¯´æ˜: ä½ å¯ä»¥å‡è®¾å­—ç¬¦ä¸²åªåŒ…å«å°å†™å­—æ¯ã€‚</p><p>è¿›é˜¶: å¦‚æœè¾“å…¥å­—ç¬¦ä¸²åŒ…å«<code>Unicode</code>å­—ç¬¦æ€ä¹ˆåŠï¼Ÿä½ èƒ½å¦è°ƒæ•´ä½ çš„è§£æ³•æ¥åº”å¯¹è¿™ç§æƒ…å†µï¼Ÿ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆ<code>LeetCode</code>ï¼‰<br>é“¾æ¥ï¼š<code>https://leetcode-cn.com/problems/valid-anagram</code><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><p>æ€è·¯ï¼šé¦–å…ˆè€ƒè™‘ç‰¹æ®Šæƒ…å†µï¼Œå¦‚æœå­—ç¬¦ä¸²<code>s</code>å’Œ<code>t</code>éƒ½ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ™å¯è®¤ä¸ºå®ƒä»¬äº’ä¸ºå­—æ¯å¼‚ä½è¯ï¼›å¦‚æœå­—ç¬¦ä¸²<code>s</code>å’Œ<code>t</code>è¿é•¿åº¦éƒ½ä¸ç›¸ç­‰ï¼Œåˆ™ä¸€å®šä¸ä¸ºå­—æ¯å¼‚ä½è¯ã€‚ç„¶åå†è€ƒè™‘å¦‚ä½•è¿›è¡Œåˆ¤æ–­ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­éƒ½åªåŒ…å«<code>26</code>ä¸ªå°å†™çš„è‹±æ–‡å­—æ¯ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å­—æ¯å¼‚ä½è¯ï¼Œé‚£ä¹ˆä¸€å®šæ»¡è¶³ï¼šæ¯ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯åœ¨å­—ç¬¦ä¸²<code>s</code>ä¸­å‡ºç°çš„æ¬¡æ•°ç­‰äºåœ¨å­—ç¬¦ä¸²<code>t</code>ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬åªéœ€åˆ†åˆ«å¯¹æ¯ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯åœ¨ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­å‡ºç°çš„æ¬¡æ•°è¿›è¡Œè®¡æ•°ï¼Œç„¶åæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰å³å¯ã€‚</p><p>å…·ä½“åˆ°ä»£ç å®ç°å±‚é¢ï¼Œç”±äºä¸¤ä¸ªå­—ç¬¦ä¸²äº’ä¸ºå­—æ¯å¼‚ä½è¯çš„å‰ææ¡ä»¶æ˜¯å…¶é•¿åº¦ç›¸ç­‰ï¼Œæ‰€ä»¥åœ¨è®¡æ•°æ—¶æˆ‘ä»¬å¯ä»¥åŒæ—¶å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œéå†ï¼›å¦ä¸€æ–¹é¢ï¼Œåˆ†åˆ«è®¡æ•°å¯ä»¥è½¬æ¢æˆå¯¹ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²<code>s</code>è¿›è¡Œè®¡æ•°ç´¯åŠ ï¼Œè€Œå¯¹å¦ä¸€ä¸ªå­—ç¬¦ä¸²<code>t</code>è¿›è¡Œè®¡æ•°é€’å‡ï¼Œæœ€ç»ˆå¦‚æœæ¯ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯çš„ç´¯è®¡ç»“æœä¸º<code>0</code>ï¼Œåˆ™å¯æ˜ç¡®è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²äº’ä¸ºå­—æ¯å¼‚ä½è¯ï¼Œåªè¦å‡ºç°ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯çš„ç´¯è®¡ç»“æœä¸ä¸º<code>0</code>ï¼Œåˆ™ä¸æ»¡è¶³æ¡ä»¶ã€‚</p><p>å¦‚ä½•å¯¹æ¯ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯è¿›è¡Œè®¡æ•°ï¼Ÿå¯å®šä¹‰ä¸€ä¸ªé•¿åº¦ä¸º<code>26</code>çš„<code>int</code>æ•°ç»„ï¼Œå­—æ¯<code>a</code>åˆ°<code>z</code>ä¾æ¬¡å¯¹åº”ä¸‹æ ‡ç´¢å¼•<code>0</code>åˆ°<code>25</code>ã€‚åœ¨éå†å­—ç¬¦ä¸²<code>s</code>æ—¶ï¼Œæ¯æ¬¡é‡åˆ°<code>a</code>åˆ™å°†ç´¢å¼•<code>0</code>ä½ç½®çš„å€¼åŠ ä¸€ï¼Œä»¥æ­¤ç±»æ¨ï¼›è€Œå½“éå†å­—ç¬¦ä¸²<code>t</code>æ—¶ï¼Œæ¯æ¬¡é‡åˆ°<code>a</code>åˆ™å°†ç´¢å¼•<code>0</code>ä½ç½®çš„å€¼å‡ä¸€ã€‚ç›´åˆ°éå†å®Œæˆï¼Œåˆ¤æ–­æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½ä¸º<code>0</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™<code>s</code>å’Œ<code>t</code>äº’ä¸ºå­—æ¯å¼‚ä½è¯ï¼Œå¦åˆ™ä¸æ˜¯ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAnagram</span><span class="params">(String s, String t)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. ç©ºå­—ç¬¦ä¸²æƒ…å†µ</span></span><br><span class="line">    <span class="keyword">if</span> (s.length() == <span class="number">0</span> &amp;&amp; t.length() == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2. é•¿åº¦ä¸ç›¸ç­‰æƒ…å†µ</span></span><br><span class="line">    <span class="keyword">if</span> (s.length() != t.length()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å­—ç¬¦ä¸²è½¬å­—ç¬¦æ•°ç»„</span></span><br><span class="line">    <span class="keyword">char</span>[] sc = s.toCharArray();</span><br><span class="line">    <span class="keyword">char</span>[] tc = t.toCharArray();</span><br><span class="line">    <span class="comment">// å®šä¹‰å­—æ¯è®¡æ•°å™¨</span></span><br><span class="line">    <span class="keyword">int</span>[] counter = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="comment">// åŒæ—¶éå†ä¸¤ä¸ªå­—ç¬¦æ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>,length = sc.length;i &lt; length;i++) &#123;</span><br><span class="line">        <span class="comment">// å­—æ¯å¯¹åº”ä¸‹æ ‡ä½ç½®çš„å€¼åŠ ä¸€</span></span><br><span class="line">        counter[sc[i] - <span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">        <span class="comment">// å­—æ¯å¯¹åº”ä¸‹æ ‡ä½ç½®çš„å€¼å‡ä¸€</span></span><br><span class="line">        counter[tc[i] - <span class="string">&#x27;a&#x27;</span>]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†è®¡æ•°å™¨</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> c : counter) &#123;</span><br><span class="line">        <span class="comment">// å­˜åœ¨ä¸€ä¸ªè®¡æ•°ä¸ä¸º0çš„åˆ™å¯ç¡®å®šä¸æ˜¯å­—æ¯å¼‚ä½è¯</span></span><br><span class="line">        <span class="keyword">if</span> (c != <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›é˜¶é—®é¢˜ï¼š</p><p>å¦‚æœè¾“å…¥å­—ç¬¦ä¸²åŒ…å«<code>Unicode</code>å­—ç¬¦æ€ä¹ˆåŠï¼Ÿ</p><p>æ€è·¯ï¼š<code>Unicode</code>å­—ç¬¦å¯å®šä¹‰<code>100</code>ä¸‡ä¸ªä»¥ä¸Šçš„å”¯ä¸€å­—ç¬¦ï¼Œå¦‚æœè¿˜é€‰æ‹©ä½¿ç”¨æ•°ç»„æ¥è®¡æ•°ï¼Œé‚£ä¹ˆéœ€è¦å¼€è¾Ÿå‡ºä¸€å—éå¸¸å¤§çš„å†…å­˜ç©ºé—´ï¼Œè€Œä¸”æœ€åéå†æ•°ç»„ä¹Ÿæ˜¯éå¸¸è€—æ—¶çš„ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨å“ˆå¸Œè¡¨æ¥è®¡æ•°ï¼Œå¯ä»¥é€‚åº”ä»»æ„çš„å­—ç¬¦èŒƒå›´ï¼Œå¦å¤–æœ€åéå†å“ˆå¸Œè¡¨åˆ¤æ–­è®¡æ•°ç»“æœæ—¶ï¼Œå¯å°†å“ˆå¸Œè¡¨ä¸­çš„æ•°æ®å»é‡ï¼Œå³è½¬æ¢æˆä¸€ä¸ªæ— åºä¸é‡å¤çš„<code>Set</code>é›†åˆï¼Œåˆ©ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œå¦‚æœè¯¥é›†åˆä¸­åªå­˜åœ¨ä¸€ä¸ªå…ƒç´ ä¸”å€¼ä¸º<code>0</code>ï¼Œåˆ™å­—ç¬¦ä¸²<code>s</code>å’Œ<code>t</code>äº’ä¸ºå­—æ¯å¼‚ä½è¯ï¼Œå¦åˆ™ä¸æ˜¯ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAnagram</span><span class="params">(String s, String t)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. ç©ºå­—ç¬¦ä¸²æƒ…å†µ</span></span><br><span class="line">    <span class="keyword">if</span> (s.length() == <span class="number">0</span> &amp;&amp; t.length() == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2. å­—ç¬¦ä¸²é•¿åº¦ä¸ç›¸ç­‰</span></span><br><span class="line">    <span class="keyword">if</span> (s.length() != t.length()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å­—ç¬¦ä¸²è½¬å­—ç¬¦æ•°ç»„</span></span><br><span class="line">    <span class="keyword">char</span>[] sc = s.toCharArray();</span><br><span class="line">    <span class="keyword">char</span>[] tc = t.toCharArray();</span><br><span class="line">    <span class="comment">// å“ˆå¸Œè¡¨è®¡æ•°å™¨</span></span><br><span class="line">    Map&lt;Character,Integer&gt; counter = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">// éå†ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²s</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>,sLength = s.length();i &lt; sLength;i++) &#123;</span><br><span class="line">        Integer val = counter.get(sc[i]);</span><br><span class="line">        <span class="keyword">if</span> (val != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœå½“å‰å­—ç¬¦å·²å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œåˆ™è®¡æ•°åŠ ä¸€</span></span><br><span class="line">            val += <span class="number">1</span>;</span><br><span class="line">            counter.put(sc[i],val);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å½“å‰å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œåˆ™è®¡æ•°ä¸º1</span></span><br><span class="line">            counter.put(sc[i],<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†ç¬¬äºŒä¸ªå­—ç¬¦ä¸²t</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>,tLength = t.length();j &lt; tLength;j++) &#123;</span><br><span class="line">        Integer val = counter.get(tc[j]);</span><br><span class="line">        <span class="keyword">if</span> (val != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœå½“å‰å­—ç¬¦å·²å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œåˆ™è®¡æ•°å‡ä¸€</span></span><br><span class="line">            val -= <span class="number">1</span>;</span><br><span class="line">            counter.put(tc[j],val);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å½“å‰å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œå·²ç»å¯ä»¥æ–­å®šä¸æ˜¯å­—æ¯å¼‚ä½è¯</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ–¹æ¡ˆä¸€ï¼šéå†å“ˆå¸Œè¡¨è®¡æ•°å™¨</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    Iterator&lt;Map.Entry&lt;Character,Integer&gt;&gt; iterator = counter.entrySet().iterator();</span></span><br><span class="line"><span class="comment">    while (iterator.hasNext()) &#123;</span></span><br><span class="line"><span class="comment">        Map.Entry&lt;Character,Integer&gt; entry = iterator.next();</span></span><br><span class="line"><span class="comment">        // å¦‚æœè®¡æ•°ç»“æœä¸ç­‰äº0ï¼Œåˆ™ä¸æ˜¯å­—æ¯å¼‚ä½è¯</span></span><br><span class="line"><span class="comment">        if (entry.getValue() != 0) &#123;</span></span><br><span class="line"><span class="comment">            return false;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    **/</span></span><br><span class="line">    <span class="comment">// æ–¹æ¡ˆäºŒï¼šå°†å“ˆå¸Œè¡¨è½¬æˆæ— åºä¸é‡å¤çš„Seté›†åˆ</span></span><br><span class="line">    Set&lt;Integer&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;(counter.values());</span><br><span class="line">    <span class="comment">// å¦‚æœSeté›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°ä¸ä¸º1ï¼Œæˆ–è€…å”¯ä¸€ä¸€ä¸ªå…ƒç´ çš„å€¼ä¸ä¸º0ï¼Œåˆ™å¯ç¡®å®šä¸æ˜¯å­—æ¯å¼‚ä½è¯ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (set.size() != <span class="number">1</span> || !set.contains(<span class="number">0</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> LeetCode </category>
          
          <category> ç®€å• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeé¢˜è§£-é“¾è¡¨æ ‡ç­¾ï¼šé“¾è¡¨ç›¸äº¤</title>
      <link href="2020/07/14/algorithm/leetcode/tag/linkedlist/intersection-of-two-linked-lists-lcci/"/>
      <url>2020/07/14/algorithm/leetcode/tag/linkedlist/intersection-of-two-linked-lists-lcci/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šç»™å®šä¸¤ä¸ªï¼ˆå•å‘ï¼‰é“¾è¡¨ï¼Œåˆ¤å®šå®ƒä»¬æ˜¯å¦ç›¸äº¤å¹¶è¿”å›äº¤ç‚¹ã€‚è¯·æ³¨æ„ç›¸äº¤çš„å®šä¹‰åŸºäºèŠ‚ç‚¹çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯åŸºäºèŠ‚ç‚¹çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€ä¸ªé“¾è¡¨çš„ç¬¬<code>k</code>ä¸ªèŠ‚ç‚¹ä¸å¦ä¸€ä¸ªé“¾è¡¨çš„ç¬¬<code>j</code>ä¸ªèŠ‚ç‚¹æ˜¯åŒä¸€èŠ‚ç‚¹ï¼ˆå¼•ç”¨å®Œå…¨ç›¸åŒï¼‰ï¼Œåˆ™è¿™ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ã€‚</p><p>ç¤ºä¾‹ <code>1</code>ï¼š</p><p>è¾“å…¥ï¼š<code>intersectVal = 8, listA = [4,1,8,4,5], listB = [5,0,1,8,4,5], skipA = 2, skipB = 3</code></p><p>è¾“å‡ºï¼š<code>Reference of the node with value = 8</code></p><p>è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º <code>8</code> ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º <code>0</code>ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ <code>A</code> ä¸º <code>[4,1,8,4,5]</code>ï¼Œé“¾è¡¨ <code>B</code> ä¸º <code>[5,0,1,8,4,5]</code>ã€‚åœ¨ <code>A</code> ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <code>2</code> ä¸ªèŠ‚ç‚¹ï¼›åœ¨ <code>B</code> ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <code>3</code> ä¸ªèŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ <code>2</code>ï¼š</p><p>è¾“å…¥ï¼š<code>intersectVal = 2, listA = [0,9,1,2,4], listB = [3,2,4], skipA = 3, skipB = 1</code></p><p>è¾“å‡ºï¼š<code>Reference of the node with value = 2</code></p><p>è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º <code>2</code> ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º <code>0</code>ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ <code>A</code> ä¸º <code>[0,9,1,2,4]</code>ï¼Œé“¾è¡¨ <code>B</code> ä¸º <code>[3,2,4]</code>ã€‚åœ¨ <code>A</code> ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <code>3</code> ä¸ªèŠ‚ç‚¹ï¼›åœ¨ <code>B</code> ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ <code>1</code> ä¸ªèŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ <code>3</code>ï¼š</p><p>è¾“å…¥ï¼š<code>intersectVal = 0, listA = [2,6,4], listB = [1,5], skipA = 3, skipB = 2</code></p><p>è¾“å‡ºï¼š<code>null</code></p><p>è¾“å…¥è§£é‡Šï¼šä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ <code>A</code> ä¸º <code>[2,6,4]</code>ï¼Œé“¾è¡¨ <code>B</code> ä¸º <code>[1,5]</code>ã€‚ç”±äºè¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œæ‰€ä»¥ <code>intersectVal</code> å¿…é¡»ä¸º <code>0</code>ï¼Œè€Œ <code>skipA</code> å’Œ <code>skipB</code> å¯ä»¥æ˜¯ä»»æ„å€¼ã€‚<br>è§£é‡Šï¼šè¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œå› æ­¤è¿”å› <code>null</code>ã€‚</p><p>æ³¨æ„ï¼š</p><p>å¦‚æœä¸¤ä¸ªé“¾è¡¨æ²¡æœ‰äº¤ç‚¹ï¼Œè¿”å› <code>null</code> ã€‚</p><p>åœ¨è¿”å›ç»“æœåï¼Œä¸¤ä¸ªé“¾è¡¨ä»é¡»ä¿æŒåŸæœ‰çš„ç»“æ„ã€‚</p><p>å¯å‡å®šæ•´ä¸ªé“¾è¡¨ç»“æ„ä¸­æ²¡æœ‰å¾ªç¯ã€‚</p><p>ç¨‹åºå°½é‡æ»¡è¶³ <code>O(n)</code> æ—¶é—´å¤æ‚åº¦ï¼Œä¸”ä»…ç”¨ <code>O(1)</code> å†…å­˜ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆ<code>LeetCode</code>ï¼‰</p><p>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/intersection-of-two-linked-lists-lcci">https://leetcode-cn.com/problems/intersection-of-two-linked-lists-lcci</a></p><p>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><p>æ€è·¯ï¼šè‹¥ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ï¼Œé‚£ä¹ˆæƒ…å†µä¸€å®šæ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/algorithm/leetcode/intersection-of-two-linked-lists-lcci-01.png" alt="intersection-of-two-linked-lists-lcci-01.png"></p><p>ç›¸äº¤çš„èŠ‚ç‚¹åé¢ï¼Œä¸¤ä¸ªé“¾è¡¨å®Œå…¨é‡åˆï¼Œé‚£ä¹ˆå¦‚ä½•æ‰¾åˆ°ç›¸äº¤çš„èŠ‚ç‚¹å‘¢ï¼Ÿå¦‚æœä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸€æ ·ï¼Œé‚£ä¹ˆåŒæ—¶éå†ä¸¤ä¸ªé“¾è¡¨ï¼Œå½“é‡åˆ°å¼•ç”¨ç›¸ç­‰çš„èŠ‚ç‚¹æ—¶å°±æ˜¯ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤çš„èŠ‚ç‚¹ã€‚ä½†å¦‚æœä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸ä¸€æ ·å‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬èƒ½å¤ŸåŸºäºä¸¤ä¸ªé•¿åº¦ä¸åŒçš„é“¾è¡¨æ„é€ å‡ºé•¿åº¦ä¸€æ ·çš„ä¸¤ä¸ªé“¾è¡¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ‰¾åˆ°ç›¸äº¤çš„èŠ‚ç‚¹ã€‚é‚£é—®é¢˜è½¬æ¢æˆå¦‚ä½•æ„é€ é•¿åº¦ä¸€æ ·çš„é“¾è¡¨ï¼Ÿå¦‚æœä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ç›¸å·®<code>x</code>ä¸ªèŠ‚ç‚¹ï¼Œå…ˆç”¨ä¸€ä¸ªæŒ‡é’ˆéå†è¾ƒé•¿çš„é“¾è¡¨<code>x</code>æ¬¡ï¼Œè¿™æ—¶å¦‚æœå°†è¯¥æŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ä½œä¸ºå¤´èŠ‚ç‚¹ï¼Œè·Ÿå¦ä¸€ä¸ªè¾ƒçŸ­é•¿åº¦çš„é“¾è¡¨å°±æ„æˆäº†é•¿åº¦ä¸€æ ·çš„ä¸¤ä¸ªé“¾è¡¨ã€‚ç„¶ååŒæ—¶è¿›è¡Œéå†ï¼Œç›´åˆ°é‡åˆ°å¼•ç”¨ç›¸ç­‰çš„èŠ‚ç‚¹å³ä¸ºå¤´èŠ‚ç‚¹ã€‚å¦‚æœæ•´ä¸ªè¿‡ç¨‹éƒ½æœªé‡åˆ°å¼•ç”¨ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™å¯æ–­å®šä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">getIntersectionNode</span><span class="params">(ListNode headA, ListNode headB)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ†åˆ«è®¡ç®—ä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">int</span> lenA = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> lenB = <span class="number">0</span>;</span><br><span class="line">    ListNode a = headA;</span><br><span class="line">    ListNode b = headB;</span><br><span class="line">    <span class="keyword">while</span> (a != <span class="keyword">null</span>) &#123;</span><br><span class="line">        lenA++;</span><br><span class="line">        a = a.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (b != <span class="keyword">null</span>) &#123;</span><br><span class="line">        lenB++;</span><br><span class="line">        b = b.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¾ƒé•¿é“¾è¡¨å…ˆéå†é•¿åº¦ä¹‹å·®æ­¥</span></span><br><span class="line">    ListNode x = headA;</span><br><span class="line">    ListNode y = headB;</span><br><span class="line">    <span class="keyword">if</span> (lenA &gt; lenB) &#123;</span><br><span class="line">        <span class="keyword">int</span> diff = lenA - lenB;</span><br><span class="line">        <span class="keyword">while</span> (diff &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            x = x.next;</span><br><span class="line">            diff--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> diff = lenB - lenA;</span><br><span class="line">        <span class="keyword">while</span> (diff &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            y = y.next;</span><br><span class="line">            diff--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ­¤æ—¶ä»¥xã€yä¸ºå¤´èŠ‚ç‚¹çš„ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸€æ ·ï¼ŒåŒæ—¶è¿›è¡Œéå†ï¼Œå¦‚æœé‡åˆ°å¼•ç”¨ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™ä¸€å®šæ˜¯ç›¸äº¤çš„èŠ‚ç‚¹ã€‚</span></span><br><span class="line">    <span class="keyword">while</span> (x != <span class="keyword">null</span> &amp;&amp; y != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x == y) &#123;</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        &#125;</span><br><span class="line">        x = x.next;</span><br><span class="line">        y = y.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†ç»“æŸï¼Œå¯æ–­å®šä¸¤ä¸ªä¸ç›¸äº¤ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> LeetCode </category>
          
          <category> é“¾è¡¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº‹åŠ¡çš„ç‰¹æ€§å’Œéš”ç¦»çº§åˆ«</title>
      <link href="2020/07/12/database/mysql/transaction-characteristics-and-isolation-levels/"/>
      <url>2020/07/12/database/mysql/transaction-characteristics-and-isolation-levels/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æèµ·æ•°æ®åº“ï¼Œé‚£ä¸å¾—ä¸è¯´åˆ°äº‹åŠ¡ï¼Œä½†äº‹åŠ¡å¹¶ä¸æ˜¯<code>MySQL</code>æ•°æ®åº“çš„ä¸“å±ï¼Œè€Œæ˜¯<code>SQL</code>è¯­è¨€çš„ç‰¹æ€§ï¼Œäº‹åŠ¡å°±æ˜¯ä¸€ç»„åŸå­æ€§çš„<code>SQL</code>æŸ¥è¯¢ã€‚è¯¥ç»„æŸ¥è¯¢è¯­å¥è¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚å¦‚æœå…¶ä¸­æœ‰ä»»ä½•ä¸€æ¡è¯­å¥æ‰§è¡Œå¤±è´¥æˆ–å› ä¸ºæ•°æ®åº“å¥”æºƒç­‰å…¶å®ƒåŸå› æ— æ³•æ‰§è¡Œï¼Œé‚£ä¹ˆæ‰€æœ‰è¯­å¥éƒ½ä¸ä¼šæ‰§è¡Œã€‚</p><h2 id="äº‹åŠ¡ç‰¹æ€§"><a href="#äº‹åŠ¡ç‰¹æ€§" class="headerlink" title="äº‹åŠ¡ç‰¹æ€§"></a>äº‹åŠ¡ç‰¹æ€§</h2><p>äº‹åŠ¡çš„ç‰¹æ€§å°±æ˜¯æˆ‘ä»¬ä¿—ç§°çš„<code>ACID</code>ï¼Œä¸‹é¢ä¾æ¬¡è¿›è¡Œè§£é‡Šï¼š</p><ol><li><code>A</code>ï¼šåŸå­æ€§ï¼ˆ<code>Atomicity</code>ï¼‰</li></ol><p>ä¸€ä¸ªäº‹åŠ¡å¿…é¡»æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„æœ€å°æ‰§è¡Œå•å…ƒï¼Œæ•´ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥åå›æ»šï¼Œå¯¹äºä¸€ä¸ªäº‹åŠ¡è€Œè¨€ï¼Œä¸å¯èƒ½å‡ºç°å…¶ä¸­ä¸€éƒ¨åˆ†æ“ä½œæ‰§è¡ŒæˆåŠŸï¼Œå¦ä¸€éƒ¨åˆ†æ“ä½œæ‰§è¡Œå¤±è´¥çš„æƒ…å†µï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„åŸå­æ€§ã€‚</p><ol start="2"><li><code>C</code>ï¼šä¸€è‡´æ€§ï¼ˆ<code>consistency</code>ï¼‰</li></ol><p>æ•°æ®åº“æ€»æ˜¯ä»ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€ã€‚ä¾‹å¦‚é“¶è¡Œè½¬è´¦ï¼Œç”¨æˆ·<code>A</code>çš„è´¦æˆ·å‘ç”¨æˆ·<code>B</code>çš„è´¦æˆ·è½¬è´¦<code>100</code>å…ƒäººæ°‘å¸ï¼Œåœ¨è¿™ä¸ªäº‹åŠ¡ä¸­ï¼Œé¦–å…ˆä¼šä»ç”¨æˆ·<code>A</code>çš„è´¦æˆ·ä¸­æ‰£å‡<code>100</code>å…ƒï¼Œç„¶åç»™ç”¨æˆ·<code>B</code>çš„è´¦æˆ·å¢åŠ <code>100</code>å…ƒï¼Œç”±äºäº‹åŠ¡çš„åŸå­æ€§çš„ä¿è¯ï¼Œå³ä½¿åœ¨ä»ç”¨æˆ·<code>A</code>çš„è´¦æˆ·ä¸­æ‰£å‡<code>100</code>å…ƒåæ•°æ®åº“ç³»ç»Ÿå¥”æºƒï¼Œç”¨æˆ·<code>A</code>çš„è´¦æˆ·ä¸Šä¹Ÿä¸ä¼šæŸå¤±<code>100</code>å…ƒï¼Œå› ä¸ºäº‹åŠ¡æ²¡æœ‰æœ€ç»ˆè¿›è¡Œæäº¤ï¼Œç”¨æˆ·<code>A</code>çš„è´¦æˆ·æ‰£å‡ä¸ä¼šä¿å­˜è‡³æ•°æ®åº“ä¸­ï¼ŒåŒæ—¶ç”±äºç³»ç»Ÿå¥”æºƒï¼Œç”¨æˆ·<code>B</code>çš„è´¦æˆ·ä¹Ÿä¸ä¼šå¢åŠ é‡‘é¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç»è¿‡ä¸€æ¬¡äº‹åŠ¡ï¼Œæ•´ä¸ªè´¦æˆ·ç³»ç»Ÿä¸­çš„é‡‘é¢æ€»æ•°ä¸ä¼šæ”¹å˜ï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„ä¸€è‡´æ€§ã€‚</p><ol start="3"><li><code>I</code>ï¼šéš”ç¦»æ€§ï¼ˆ<code>isolation</code>ï¼‰</li></ol><p>éš”ç¦»æ€§æ˜¯æŒ‡å¤šä¸ªå®¢æˆ·ç«¯å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯çš„äº‹åŠ¡ä¸èƒ½è¢«å…¶å®ƒå®¢æˆ·ç«¯çš„äº‹åŠ¡æ‰€å¹²æ‰°ï¼Œå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦åšåˆ°äº‹åŠ¡éš”ç¦»ã€‚</p><p>éš”ç¦»æ€§éœ€è¦ç»“åˆäº‹åŠ¡çš„éš”ç¦»çº§åˆ«æ¥è¯´ï¼Œä¸‹æ–‡ä¼šå¯¹äº‹åŠ¡çš„éš”ç¦»çº§åˆ«è¿›è¡Œå±•å¼€è¯´æ˜ã€‚</p><p>é€šå¸¸çš„éš”ç¦»æ€§æ˜¯ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­çš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤äº‹åŠ¡ä¹‹å‰ï¼Œå¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚è¿˜æ˜¯é“¶è¡Œè½¬è´¦çš„ä¾‹å­ï¼Œåœ¨ç”¨æˆ·<code>A</code>ç»™ç”¨æˆ·<code>B</code>è½¬è´¦çš„äº‹åŠ¡æäº¤ä¹‹å‰ï¼Œå¦‚æœç”¨æˆ·<code>A</code>è¿˜å‘å¦ä¸€ä¸ªç”¨æˆ·<code>C</code>è½¬è´¦ï¼Œè¿™æ—¶å€™çœ‹ç”¨æˆ·<code>A</code>çš„è´¦æˆ·æ˜¯è¿˜æœªæ‰£å‡<code>100</code>å…ƒçš„ï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„éš”ç¦»æ€§ã€‚</p><ol start="4"><li><code>D</code>ï¼šæŒä¹…æ€§ï¼ˆ<code>durability</code>ï¼‰</li></ol><p>ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œåˆ™è¯¥äº‹åŠ¡ä¸­æ‰€åšçš„æ‰€æœ‰ä¿®æ”¹éƒ½å°†æ°¸ä¹…ä¿å­˜è‡³æ•°æ®åº“ä¸­ï¼Œä¼šè¢«æŒä¹…åŒ–è‡³ç£ç›˜ä¸Šï¼Œå³ä½¿æ­¤æ—¶ç³»ç»Ÿå‘ç”Ÿå¥”æºƒï¼Œäº‹åŠ¡ä¸­å‘ç”Ÿä¿®æ”¹çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p><p>åœ¨<code>MySQL</code>ä¸­ï¼Œäº‹åŠ¡çš„å®ç°åœ¨å¼•æ“å±‚ã€‚<code>MySQL</code>æ˜¯ä¸€ä¸ªæ”¯æŒå¤šå¼•æ“çš„ç³»ç»Ÿï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰å¼•æ“éƒ½æ”¯æŒäº‹åŠ¡ï¼Œä¾‹å¦‚<code>MySQL</code>åŸç”Ÿçš„<code>MyISAM</code>å¼•æ“å°±ä¸æ”¯æŒäº‹åŠ¡ï¼Œè€Œæˆ‘ä»¬ç†ŸçŸ¥çš„<code>InnoDB</code>å¼•æ“åˆ™æ˜¯æ”¯æŒäº‹åŠ¡çš„ã€‚</p><h2 id="å¹¶å‘è®¿é—®çš„é—®é¢˜"><a href="#å¹¶å‘è®¿é—®çš„é—®é¢˜" class="headerlink" title="å¹¶å‘è®¿é—®çš„é—®é¢˜"></a>å¹¶å‘è®¿é—®çš„é—®é¢˜</h2><p>å½“å¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°å¹¶å‘é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæå‡ºäº†éš”ç¦»çº§åˆ«çš„æ¦‚å¿µï¼Œæ¯ä¸€ç§éš”ç¦»çº§åˆ«éƒ½å¯ä»¥è§£å†³ä¸€ä¸ªå¹¶å‘é—®é¢˜ã€‚</p><p>äº‹åŠ¡çš„å¹¶å‘æ‰§è¡Œå­˜åœ¨ä»¥ä¸‹ä¸‰ç§é—®é¢˜ï¼š</p><ol><li>è„è¯»</li></ol><p>ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡ä¸­æœªæäº¤çš„æ•°æ®ã€‚</p><ol start="2"><li>ä¸å¯é‡å¤è¯»</li></ol><p>å‡è®¾å­˜åœ¨è¿™æ ·ä¸€ä¸ªäº‹åŠ¡ï¼Œé¦–å…ˆæŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œç„¶åä¿®æ”¹è¯¥æ¡è®°å½•çš„å€¼ï¼Œå†æ¬¡æŸ¥è¯¢è¯¥æ¡è®°å½•ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªäº‹åŠ¡è€Œè¨€ï¼Œä¸¤æ¬¡æŸ¥è¯¢åˆ°çš„è®°å½•çš„å€¼ä¸ä¸€è‡´ï¼Œè¿™è¢«ç§°ä¸ºä¸å¯é‡å¤è¯»ã€‚</p><ol start="3"><li>å¹»è¯»</li></ol><p>å‡è®¾å­˜åœ¨è¿™æ ·ä¸€ä¸ªäº‹åŠ¡ï¼Œé¦–å…ˆæ¡ä»¶æŸ¥è¯¢æŸä¸ªèŒƒå›´å†…çš„è®°å½•ï¼Œæ­¤æ—¶æŸä¸ªå¹¶å‘æ‰§è¡Œçš„å…¶å®ƒäº‹åŠ¡åœ¨è¯¥èŒƒå›´å†…æ’å…¥äº†æ–°çš„è®°å½•ï¼Œå½“ä¹‹å‰çš„äº‹åŠ¡å†æ¬¡ä»¥ç›¸åŒçš„æ¡ä»¶èŒƒå›´æŸ¥è¯¢æ—¶ï¼Œå°±ä¼šæŸ¥è¯¢åˆ°æ–°æ’å…¥çš„è¡Œï¼ˆç§°ä¸ºå¹»è¡Œï¼‰ã€‚<code>InnoDB</code>å¼•æ“é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆ<code>MVCC</code>ï¼‰æ¥è§£å†³å¹»è¯»çš„é—®é¢˜ã€‚</p><h2 id="äº‹åŠ¡çš„éš”ç¦»çº§åˆ«"><a href="#äº‹åŠ¡çš„éš”ç¦»çº§åˆ«" class="headerlink" title="äº‹åŠ¡çš„éš”ç¦»çº§åˆ«"></a>äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</h2><p>æ¯ä¸€ç§éš”ç¦»çº§åˆ«éƒ½è§£å†³äº†ä¸€ä¸ªå¹¶å‘é—®é¢˜ï¼Œä½†å¿…é¡»æ˜ç™½ï¼Œé—®é¢˜è§£å†³çš„è¶Šå¤šï¼Œæ•ˆç‡å°±ä¼šè¶Šä½ã€‚å› æ­¤å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯æ¥é€‰æ‹©åˆé€‚çš„éš”ç¦»çº§åˆ«ã€‚</p><p><code>SQL</code>æ ‡å‡†çš„äº‹åŠ¡éš”ç¦»çº§åˆ«åŒ…æ‹¬ï¼šè¯»æœªæäº¤ï¼ˆ<code>read uncommitted</code>ï¼‰ã€è¯»å·²æäº¤ï¼ˆ<code>read committed</code>ï¼‰ã€å¯é‡å¤è¯»ï¼ˆ<code>repeatable read</code>ï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆ<code>serializable</code>ï¼‰ã€‚</p><ol><li>è¯»æœªæäº¤ï¼ˆ<code>read uncommitted</code>ï¼‰</li></ol><p>å¯è¯»å–å…¶å®ƒäº‹åŠ¡ä¸­æœªæäº¤çš„æ•°æ®ï¼Œä¸èƒ½è§£å†³ä»»ä½•å¹¶å‘é—®é¢˜ã€‚</p><ol start="2"><li>è¯»å·²æäº¤ï¼ˆ<code>read committed</code>ï¼‰</li></ol><p>åªèƒ½è¯»å–å…¶å®ƒäº‹åŠ¡ä¸­å·²æäº¤çš„æ•°æ®ï¼Œå¯ä»¥è§£å†³è„è¯»é—®é¢˜ã€‚</p><ol start="3"><li>å¯é‡å¤è¯»ï¼ˆ<code>repeatable read</code>ï¼‰</li></ol><p>ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­èƒ½è¯»å–åˆ°çš„æ•°æ®ï¼Œæ€»æ˜¯è·Ÿè¿™ä¸ªäº‹åŠ¡åœ¨å¯åŠ¨æ—¶è¯»åˆ°çš„æ•°æ®ä¿æŒä¸€è‡´ã€‚å¯ä»¥è§£å†³è„è¯»å’Œä¸å¯é‡å¤è¯»é—®é¢˜ã€‚</p><p>å®ç°åŸç†æ˜¯åœ¨äº‹åŠ¡å¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œæ•´ä¸ªäº‹åŠ¡å­˜åœ¨æœŸé—´éƒ½ä¼šæŸ¥è¯¢è¯¥è§†å›¾ã€‚</p><ol start="4"><li>ä¸²è¡ŒåŒ–ï¼ˆ<code>serializable</code>ï¼‰</li></ol><p>æœ€é«˜çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œä½¿ç”¨è¯»å†™é”å¼ºåˆ¶æ‰€æœ‰æ“ä½œä¸²è¡Œæ’é˜Ÿæ‰§è¡Œï¼Œè§£å†³äº†æ‰€æœ‰çš„å¹¶å‘é—®é¢˜ã€‚ä½†å…¶æ•ˆç‡ä¹Ÿæœ€ä¸ºä½ä¸‹ã€‚å¯¹äºåŒä¸€è¡Œè®°å½•ï¼Œâ€œå†™â€ä¼šåŠ â€œå†™é”â€ï¼Œâ€œè¯»â€ä¼šåŠ â€œè¯»é”â€ã€‚å½“å‡ºç°è¯»å†™é”å†²çªæ—¶ï¼Œåå¯åŠ¨çš„äº‹åŠ¡å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œå¹¶æäº¤åï¼Œæ‰èƒ½æ‰§è¡Œã€‚</p><p>ä¸åŒéš”ç¦»çº§åˆ«ä¹‹é—´çš„æ€§èƒ½æ¯”è¾ƒï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼šè¯»æœªæäº¤ &gt; è¯»å·²æäº¤ &gt; å¯é‡å¤è¯» &gt; ä¸²è¡ŒåŒ–ã€‚</p><p>æ€§èƒ½è¶Šé«˜ï¼Œå¹¶å‘å®‰å…¨æ€§è¶Šä½ã€‚<code>MySQL</code>åœ¨<code>5.0</code>ç‰ˆæœ¬ä¹‹åå¼€å§‹ï¼Œé€‰æ‹©å¯é‡å¤è¯»åšä¸ºé»˜è®¤çš„éš”ç¦»çº§åˆ«ã€‚</p><blockquote><p><code>MySQL</code>ä¸ºä»€ä¹ˆé€‰æ‹©å¯é‡å¤è¯»ä½œä¸ºé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Ÿ</p><p><a href="/2020/07/12/database/mysql/why-does-mysql-choose-repeatable-read-as-the-default-isolation-level/">ä¼ é€é—¨</a></p></blockquote><h2 id="æ·±å…¥ç†è§£äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#æ·±å…¥ç†è§£äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="æ·±å…¥ç†è§£äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>æ·±å…¥ç†è§£äº‹åŠ¡éš”ç¦»çº§åˆ«</h2><p>è¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥å°è¯•ç†è§£äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚</p><p>åˆå§‹åŒ–è¡¨<code>T</code>ï¼Œæ’å…¥ä¸€æ¡è®°å½•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `T` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `num` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `T` (`num`) <span class="keyword">values</span> (<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>å‡è®¾æœ‰ä¸¤ä¸ªäº‹åŠ¡çš„æ‰§è¡Œé¡ºåºå¦‚ä»¥ä¸‹è¡¨æ ¼æ‰€ç¤ºï¼š</p><table><thead><tr><th align="center">æ—¶é—´è½´</th><th align="center">äº‹åŠ¡1</th><th align="center">äº‹åŠ¡2</th></tr></thead><tbody><tr><td align="center">t0</td><td align="center">begin</td><td align="center">begin</td></tr><tr><td align="center">t1</td><td align="center">select num from <code>T</code> where id = 1;</td><td align="center"></td></tr><tr><td align="center">t2</td><td align="center"></td><td align="center">select num from <code>T</code> where id = 1;</td></tr><tr><td align="center">t3</td><td align="center"></td><td align="center">update <code>T</code> set num = 2 where id = 1;</td></tr><tr><td align="center">t4</td><td align="center">select num from <code>T</code> where id = 1;</td><td align="center"></td></tr><tr><td align="center">t5</td><td align="center"></td><td align="center">commit;</td></tr><tr><td align="center">t6</td><td align="center">select num from <code>T</code> where id = 1;</td><td align="center"></td></tr><tr><td align="center">t7</td><td align="center">commit;</td><td align="center"></td></tr><tr><td align="center">t8</td><td align="center">select num from <code>T</code> where id = 1;</td><td align="center"></td></tr></tbody></table><p><code>t1</code>æ—¶åˆ»äº‹åŠ¡<code>1</code>æŸ¥è¯¢å¾—åˆ°çš„<code>num</code>å€¼ä¸º<code>1</code>ã€‚</p><p>è®¾<code>t4</code>æ—¶åˆ»äº‹åŠ¡<code>1</code>æŸ¥è¯¢å¾—åˆ°çš„<code>num</code>å€¼ä¸º<code>N1</code>ï¼Œ<code>t6</code>æ—¶åˆ»äº‹åŠ¡<code>1</code>æŸ¥è¯¢å¾—åˆ°çš„<code>num</code>å€¼ä¸º<code>N2</code>ï¼Œ<code>t8</code>æ—¶åˆ»äº‹åŠ¡<code>1</code>æŸ¥è¯¢å¾—åˆ°çš„<code>num</code>å€¼ä¸º<code>N3</code>ã€‚</p><p>åœ¨ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼Œ<code>N1</code>ã€<code>N2</code>å’Œ<code>N3</code>çš„å€¼ä¼šä¸€æ ·å—ï¼Ÿåˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ</p><ol><li>è¯»æœªæäº¤éš”ç¦»çº§åˆ«ä¸‹ï¼š</li></ol><p>äº‹åŠ¡<code>1</code>å¯è¯»åˆ°äº‹åŠ¡<code>2</code>ä¸­æœªæäº¤æ•°æ®ï¼Œäºæ˜¯<code>N1=N2=N3=2</code>ã€‚</p><ol start="2"><li>è¯»å·²æäº¤éš”ç¦»çº§åˆ«ä¸‹ï¼š</li></ol><p>äº‹åŠ¡<code>1</code>åªèƒ½è¯»åˆ°äº‹åŠ¡<code>2</code>ä¸­å·²æäº¤çš„æ•°æ®ï¼Œäºæ˜¯<code>N1=1, N2=2, N3=2</code>ã€‚</p><ol start="3"><li>å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹ï¼š</li></ol><p>äº‹åŠ¡<code>1</code>ä¸­è¯»åˆ°çš„æ•°æ®æ€»æ˜¯è·Ÿè¯¥äº‹åŠ¡åˆšå¯åŠ¨æ—¶è¯»åˆ°çš„æ•°æ®ä¿æŒä¸€è‡´ï¼Œäºæ˜¯<code>N1=1, N2=1, N3=2</code>ã€‚</p><ol start="4"><li>ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ä¸‹ï¼š</li></ol><p>å¯¹åŒä¸€è¡Œæ•°æ®çš„æ“ä½œå¼ºåˆ¶æ’é˜Ÿæ‰§è¡Œã€‚<code>t1</code>æ—¶åˆ»äº‹åŠ¡<code>1</code>åŠ è¯»é”ï¼›<code>t2</code>æ—¶åˆ»äº‹åŠ¡<code>2</code>åŠ è¯»é”ï¼›<code>t3</code>æ—¶åˆ»äº‹åŠ¡<code>2</code>å°è¯•åŠ å†™é”ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç­‰å¾…äº‹åŠ¡<code>1</code>æäº¤åæ‰ä¼šæ‰§è¡Œ<code>update</code>ï¼›<code>t8</code>æ—¶åˆ»äº‹åŠ¡<code>2</code>å·²æäº¤ã€‚äºæ˜¯<code>N1=1, N2=1, N3=2</code>ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>äº‹åŠ¡çš„å››å¤§ç‰¹æ€§ï¼š<code>ACID</code>ï¼›</p><p>äº‹åŠ¡çš„å¹¶å‘é—®é¢˜ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚</p><p>äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼šè¯»æœªæäº¤ã€è¯»å·²æäº¤ï¼ˆè§£å†³äº†è„è¯»ï¼‰ã€å¯é‡å¤è¯»ï¼ˆè§£å†³äº†ä¸å¯é‡å¤è¯»ï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆè§£å†³äº†å¹»è¯»ï¼Œæ— å¹¶å‘é—®é¢˜ï¼‰ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>ã€ŠMySQLå®æˆ˜45è®²ã€‹ - æå®¢æ—¶é—´</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLä¸ºä»€ä¹ˆé€‰æ‹©å¯é‡å¤è¯»ä½œä¸ºé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Ÿ</title>
      <link href="2020/07/12/database/mysql/why-does-mysql-choose-repeatable-read-as-the-default-isolation-level/"/>
      <url>2020/07/12/database/mysql/why-does-mysql-choose-repeatable-read-as-the-default-isolation-level/</url>
      
        <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>åœ¨<code>Oracle</code>å’Œ<code>SqlServer</code>å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œé»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯è¯»å·²æäº¤ã€‚ä¸ºä»€ä¹ˆ<code>MySQL</code>çš„é»˜è®¤éš”ç¦»çº§åˆ«é€‰æ‹©å¯é‡å¤è¯»å‘¢ï¼Ÿ</p><h2 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h2><p>è¿™ä¸ªé—®é¢˜å¾—ä»ä¸»ä»å¤åˆ¶è¯´èµ·ï¼Œ<code>MySQL</code>çš„ä¸»ä»å¤åˆ¶æ˜¯åŸºäº<code>binlog</code>å¤åˆ¶çš„ã€‚</p><p><code>binlog</code>æœ‰ä»¥ä¸‹ä¸‰ç§æ ¼å¼ï¼š</p><ul><li><code>Statement</code>ï¼šè®°å½•ä¿®æ”¹çš„<code>SQL</code>è¯­å¥ã€‚</li><li><code>Row</code>ï¼šè®°å½•æ¯ä¸€è¡Œæ•°æ®çš„å˜æ›´ã€‚</li><li><code>Mixed</code>ï¼š<code>Statement</code>å’Œ<code>Row</code>æ¨¡å¼çš„æ··åˆã€‚</li></ul><p><code>MySQL</code>åœ¨<code>5.0</code>ç‰ˆæœ¬ä¹‹å‰ï¼Œ<code>binlog</code>åªæ”¯æŒ<code>Statement</code>æ ¼å¼ï¼Œåœ¨è¯»å·²æäº¤éš”ç¦»çº§åˆ«ä¸‹ï¼Œè¿™ç§æ ¼å¼çš„ä¸»ä»å¤åˆ¶æ˜¯å­˜åœ¨é—®é¢˜çš„ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><p>åˆ›å»ºä¸€å¼ <code>S</code>è¡¨ï¼Œå¹¶åˆå§‹åŒ–ä¸€æ¡æ•°æ®ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `S` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `val` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `S` (`val`) <span class="keyword">values</span> (<span class="string">&#x27;hello&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å‡è®¾æ­¤æ—¶æˆ‘ä»¬çš„<code>MySQL</code>æ˜¯<code>5.0</code>ç‰ˆæœ¬ï¼Œ<code>binlog</code>ä¸º<code>Statement</code>æ ¼å¼ï¼Œä¸”éš”ç¦»çº§åˆ«ä¸ºè¯»å·²æäº¤ã€‚åœ¨ä¸»ä»æ¶æ„ä¸‹ï¼Œä¸»åº“ä¸Šæ‰§è¡Œä»¥ä¸‹äº‹åŠ¡ï¼š</p><table><thead><tr><th align="center">Statement1</th><th align="center">Statement2</th></tr></thead><tbody><tr><td align="center">begin</td><td align="center">begin</td></tr><tr><td align="center">delete from <code>S</code> where id &lt; 5;</td><td align="center"></td></tr><tr><td align="center"></td><td align="center">insert into <code>S</code> (<code>val</code>) values (â€˜javaâ€™);</td></tr><tr><td align="center"></td><td align="center">commit;</td></tr><tr><td align="center">commit;</td><td align="center"></td></tr></tbody></table><p>æ­¤æ—¶åœ¨ä¸»åº“ä¸Šæ‰§è¡Œ<code>select * from S</code>ï¼Œä¼šè¾“å‡ºä¸€æ¡è®°å½•<code>java</code>ï¼›è€Œåœ¨ä»åº“æ‰§è¡Œè¯¥è¯­å¥ä¼šè¾“å‡º<code>Empty Set</code>ã€‚</p><p>ä¸»ä»åº“æ•°æ®å‡ºç°äº†ä¸ä¸€è‡´ã€‚é‚£åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>åœ¨ä¸»åº“ä¸Šï¼Œ<code>Statement1</code>çš„åˆ é™¤å…ˆæ‰§è¡Œï¼Œåœ¨å…¶æäº¤äº‹åŠ¡ä¹‹å‰<code>Statement2</code>æ’å…¥æ•°æ®å¹¶æäº¤ï¼Œ<code>Statement2</code>æ’å…¥çš„æ•°æ®ä¸ä¼šè¢«åˆ é™¤ï¼Œæœ€å<code>Statement1</code>äº‹åŠ¡æäº¤ï¼Œä¹Ÿå°±æ˜¯å…ˆåˆ é™¤åæ’å…¥ï¼Œè¡¨ä¸­ç•™ä¸‹äº†<code>Statement2</code>äº‹åŠ¡ä¸­æ’å…¥çš„æ•°æ®ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç”±äº<code>Statement2</code>å…ˆæäº¤ï¼Œ<code>binlog</code>å…ˆå°†æ’å…¥è®°å½•ä¸‹æ¥ï¼Œç„¶åè®°å½•åæäº¤çš„åˆ é™¤ã€‚åŒæ­¥åˆ°ä»åº“ä¸Šæ—¶ï¼Œå°±æ˜¯å…ˆæ’å…¥ååˆ é™¤ã€‚æ‰€ä»¥å¯¼è‡´äº†ä¸»ä»æ•°æ®ä¸ä¸€è‡´ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•è§£å†³è¯¥é—®é¢˜å‘¢ï¼Ÿ</p><p>æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼Œè¯¥çº§åˆ«ä¸‹å¼•å…¥é—´éš™é”ï¼Œåœ¨<code>Statement1</code>æ‰§è¡Œåˆ é™¤æ—¶ï¼Œé—´éš™é”ä¼šé”ä½ä¸€ä¸ª<code>id</code>åŒºé—´ï¼ˆè¿™ä¸ªåŒºé—´èŒƒå›´æœ‰ä¸€å®šçš„è§„åˆ™ï¼‰ï¼Œåœ¨è¿™ä¸ªåŒºé—´å†…çš„æ“ä½œéƒ½ä¼šé˜»å¡ï¼Œæ‰€ä»¥<code>Statement2</code>æ‰§è¡Œæ’å…¥ä¼šè¢«é˜»å¡ä½ï¼Œç›´åˆ°<code>Statement1</code>äº‹åŠ¡æäº¤æ‰æ‰§è¡Œã€‚</p><p>æ–¹æ¡ˆäºŒï¼šå°†<code>binlog</code>çš„æ ¼å¼ä¿®æ”¹ä¸º<code>Row</code>æ ¼å¼ï¼ŒåŸºäºè¡Œçš„å¤åˆ¶ï¼Œè¿™æ ·å°±ä¿è¯äº†åˆ é™¤å’Œæ’å…¥çš„æ‰§è¡Œé¡ºåºã€‚ä½†è¯¥ç‰¹æ€§åœ¨<code>5.0</code>ç‰ˆæœ¬ä¹‹åæ‰å¼•å…¥ï¼Œæ‰€ä»¥ï¼Œ<code>MySQL</code>ä¸ºäº†ä¿è¯ä¸»ä»åŒæ­¥æ•°æ®ä¸€è‡´æ€§ï¼Œå°†é»˜è®¤éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºå¯é‡å¤è¯»ã€‚</p><p>é—´éš™é”çš„å­˜åœ¨ï¼Œå¯¼è‡´å¯é‡å¤è¯»éš”ç¦»çº§åˆ«å‡ºç°æ­»é”çš„å‡ ç‡å˜å¤§ï¼Œä¸€æ—¦å‡ºç°æ­»é”ï¼Œå¯¹ä¸šåŠ¡çš„å½±å“å°†æ˜¯ä¸å¯é¢„æ–™çš„ï¼Œæ‰€ä»¥ï¼Œå®é™…ä¸šåŠ¡å¼€å‘ä¸­ï¼Œå¹¶ä¸æ¨èä½¿ç”¨é»˜è®¤çš„å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼Œè€Œæ˜¯æ¨èä½¿ç”¨è¯»å·²æäº¤éš”ç¦»çº§åˆ«ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…³äºé—´éš™é”ï¼Œæˆ‘å°†å•ç‹¬å†™ä¸€ç¯‡åšå®¢è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚è¿™é‡Œåªéœ€ç†è§£åˆ°ä¼šé”ä½ä¸€ä¸ªåŒºé—´å³å¯ï¼Œåœ¨è¿™ä¸ªåŒºé—´å†…çš„æ“ä½œéƒ½ä¼šé˜»å¡ã€‚</p><p><code>MySQL</code>çš„æ—©æœŸç‰ˆæœ¬æ²¡æœ‰é—´éš™é”ï¼Œåœ¨è¯»å·²æäº¤éš”ç¦»çº§åˆ«ä¸‹ä¸»ä»åŒæ­¥ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µï¼Œæ‰€ä»¥å°†é»˜è®¤çš„éš”ç¦»çº§åˆ«è®¾ä¸ºäº†è¯»å·²æäº¤ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.cnblogs.com/rjzheng/p/10510174.html">https://www.cnblogs.com/rjzheng/p/10510174.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºJavaï¼Œä½ ä¸å¾—ä¸å­¦çš„java.lang.Stringç±»</title>
      <link href="2020/06/29/javase/base/string/"/>
      <url>2020/06/29/javase/base/string/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨<code>Java</code>å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä»å¤´è‡³å°¾éƒ½åœ¨ä¸<code>String</code>æ‰“äº¤é“ã€‚è¿˜è®°å¾—æˆ‘ä»¬æ•²ä¸‹çš„ç¬¬ä¸€è¡Œä»£ç å—ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">&quot;Hello World!&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>è¿™æ˜¯æˆ‘ä»¬æ‰€æœ‰å¼€å‘äººå‘˜æ¢¦å¼€å§‹çš„åœ°æ–¹ã€‚é‚£å¹´ï¼Œé’æ¶©çš„æˆ‘ä»¬åœ¨è¯¾å ‚ä¸Šæ•²ä¸‹è¿™ç¬¬ä¸€è¡Œä»£ç ï¼Œæ®Šä¸çŸ¥ï¼Œå®ƒç«Ÿä¼šå½±å“æˆ‘ä»¬æ¯ä¸ªäººçš„ä¸€ç”Ÿã€‚</p></blockquote><h2 id="java-lang-Stringç±»ç®€ä»‹"><a href="#java-lang-Stringç±»ç®€ä»‹" class="headerlink" title="java.lang.Stringç±»ç®€ä»‹"></a><code>java.lang.String</code>ç±»ç®€ä»‹</h2><p>å¯¹äºéƒ¨åˆ†åˆšå­¦ä¹ <code>Java</code>çš„åˆå­¦è€…æ¥è¯´ï¼Œå½“é—®åˆ°<code>Java</code>ä¸­æœ‰å“ªäº›åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œå¯èƒ½ä¼šå›ç­”å‡º<code>String</code>å­—ç¬¦ä¸²ã€‚</p><p>ä½†äº‹å®ä¸Šï¼Œ<code>String</code>æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ã€‚</p><blockquote><p><code>Java</code>ä¸­çš„åŸºæœ¬ç±»å‹æœ‰ä»¥ä¸‹å…«ç§ï¼š<code>byte</code>ã€<code>short</code>ã€<code>int</code>ã€<code>long</code>ã€<code>char</code>ã€<code>float</code>ã€<code>double</code>å’Œ<code>boolean</code>ã€‚</p></blockquote><h2 id="å’Œequals-åŒºåˆ«"><a href="#å’Œequals-åŒºåˆ«" class="headerlink" title="==å’Œequals()åŒºåˆ«"></a><code>==</code>å’Œ<code>equals()</code>åŒºåˆ«</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹è¿™æ ·ä¸€æ®µä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">String a = <span class="string">&quot;Hello&quot;</span> + <span class="string">&quot; World&quot;</span> + <span class="string">&quot;!&quot;</span>;</span><br><span class="line">String b = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">System.out.println(a == b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>èªæ˜çš„ä½ æ˜¯å¦å·²ç»çŸ¥é“äº†è¿™æ®µä»£ç çš„è¿è¡Œç»“æœå‘¢ï¼Ÿ</p><p>è¿è¡Œç»“æœï¼š<code>true</code>ã€‚</p><p>å¦‚æœä½ ç«‹åˆ»çŸ¥é“äº†ç»“æœä¸”æ‡‚å…¶åŸç†ï¼Œé‚£ä¹ˆè¿™ä¸€ä¸ªçŸ¥è¯†ç‚¹å¯ä»¥è·³è¿‡ï¼›å¦‚æœè¿˜æœ‰ä¸€ç‚¹å«ç³Šï¼Œé‚£å°±è¯·ä»”ç»†å¾€ä¸‹çœ‹ã€‚</p><p>è¦è§£é‡Šè¿™ä¸ªè¿è¡Œç»“æœçš„åŸç†ï¼Œéœ€è¦çŸ¥é“ä¸‹é¢ä¸‰ä¸ªé—®é¢˜ï¼š</p><ul><li><code>==</code>å’Œ<code>equals()</code>æ˜¯å¦‚ä½•è¿›è¡Œæ¯”è¾ƒçš„ï¼Ÿ</li><li>ä¸Šè¿°ä»£ç ä¸­çš„å˜é‡<code>a</code>å’Œ<code>b</code>åœ¨å†…å­˜ä¸­æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</li><li>ç¼–è¯‘æ—¶çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚</li></ul><h3 id="çš„æ¯”è¾ƒæ–¹æ¡ˆ"><a href="#çš„æ¯”è¾ƒæ–¹æ¡ˆ" class="headerlink" title="==çš„æ¯”è¾ƒæ–¹æ¡ˆ"></a><code>==</code>çš„æ¯”è¾ƒæ–¹æ¡ˆ</h3><p>åœ¨<code>Java</code>è¯­è¨€ä¸­ï¼Œ<code>==</code>è¿ç®—ç¬¦ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå†…å­˜å•å…ƒä¸Šçš„å†…å®¹æ˜¯å¦ä¸€æ ·ï¼Œå®é™…æ˜¯æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œåœ¨è®¡ç®—æœºå†…éƒ¨å°±æ˜¯<code>0</code>å’Œ<code>1</code>ã€‚</p><p>å¯¹äºä¸ƒç§åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆ<code>boolean</code>é™¤å¤–ï¼‰ï¼Œå°±æ˜¯ç›´æ¥æ¯”è¾ƒä¸¤è€…çš„æ•°å€¼æ˜¯å¦ç›¸ç­‰ã€‚</p><p>è€Œå¯¹äºå¼•ç”¨ç±»å‹ï¼Œä¾‹å¦‚ç¤ºä¾‹ä¸­çš„<code>String</code>å¼•ç”¨ç±»å‹ï¼Œæ¯”è¾ƒçš„æ˜¯â€œå¼•ç”¨çš„å€¼â€ï¼Œå®é™…å°±æ˜¯ä¸¤è€…çš„å†…å­˜åœ°å€å€¼ã€‚</p><p>å¦‚æœä¸¤ä¸ªå¼•ç”¨è¿›è¡Œ<code>==</code>æ¯”è¾ƒï¼Œæ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¼•ç”¨å¯¹è±¡çš„å†…å­˜åœ°å€å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå®é™…ä¸Šå°±æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¼•ç”¨æ‰€æŒ‡å‘çš„å¯¹è±¡æ˜¯å¦å­˜å‚¨åœ¨åŒä¸€ä¸ªå†…å­˜åŒºåŸŸä¸Šã€‚å¦‚æœæ˜¯ï¼Œåˆ™è¿”å›<code>true</code>ï¼›å¦åˆ™è¿”å›<code>false</code>ã€‚</p><blockquote><p>ä¸¾ä¸€ä¸ªä¸å¤ªæ°å½“çš„æ¯”å–»ï¼šå¤§å®¶éƒ½è€ƒä¸Šäº†å¿ƒä»ªçš„å¤§å­¦ï¼Œç°åœ¨æ¯”è¾ƒå“ªäº›äººè€ƒä¸Šäº†åŒä¸€æ‰€å¤§å­¦ã€‚</p></blockquote><h3 id="equals-æ–¹æ³•çš„æ¯”è¾ƒæ–¹æ¡ˆ"><a href="#equals-æ–¹æ³•çš„æ¯”è¾ƒæ–¹æ¡ˆ" class="headerlink" title="equals()æ–¹æ³•çš„æ¯”è¾ƒæ–¹æ¡ˆ"></a><code>equals()</code>æ–¹æ³•çš„æ¯”è¾ƒæ–¹æ¡ˆ</h3><p>å¯¹äº<code>equals()</code>æ–¹æ³•ï¼Œå®ƒçš„æºå¤´æ¥è‡ªäº<code>Object</code>ç±»ã€‚åœ¨<code>Java</code>ä¸­ï¼Œä»»ä½•å¯¹è±¡éƒ½éšå¼çš„ç»§æ‰¿äº†<code>java.lang.Object</code>ç±»ã€‚æ‰€ä»¥ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨<code>equals()</code>æ–¹æ³•è¿›è¡Œæ¯”è¾ƒã€‚</p><p>è€Œåœ¨<code>java.lang.Object</code>ç±»ä¸­ï¼Œ<code>equals()</code>æ–¹æ³•çš„å®ç°æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span> == obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä½¿ç”¨äº†<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒã€‚è¿™æ„å‘³ç€ï¼šå¦‚æœè°ƒç”¨<code>equals()</code>æ–¹æ³•è¿›è¡Œæ¯”è¾ƒçš„ç±»åŠå…¶æ˜¾å¼ä½¿ç”¨<code>extends</code>å…³é”®å­—ç»§æ‰¿çš„çˆ¶ç±»åˆ—è¡¨ä¸­éƒ½æ²¡æœ‰é‡å†™è¿‡<code>equals()</code>æ–¹æ³•ï¼Œé‚£ä¹ˆè°ƒç”¨<code>equals()</code>æ–¹æ³•å°±ç­‰åŒäºä½¿ç”¨<code>==</code>è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒã€‚</p><p><code>equals()</code>æ–¹æ³•ä¹‹æ‰€ä»¥å­˜åœ¨äº<code>Object</code>ç±»ä¸­ï¼Œå°±æ˜¯å¸Œæœ›å­ç±»å»é‡å†™ï¼Œä»¥å®ç°æ¯”è¾ƒå¯¹è±¡ç›¸ç­‰çš„åŠŸèƒ½ã€‚</p><p><code>java.lang.String</code>ç±»å°±é‡å†™äº†<code>equals()</code>æ–¹æ³•ï¼Œå› ä¸ºå¯¹äºå­—ç¬¦ä¸²æ¥è¯´ï¼Œåªè¦å­—ç¬¦ä¸²å†…å®¹ç›¸åŒï¼Œåˆ™å¯è®¤ä¸ºè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯â€œç›¸ç­‰â€çš„ã€‚</p><blockquote><p>ä¸¤ä¸ªå¯¹è±¡â€œç›¸ç­‰â€å¹¶ä¸æ„å‘³ç€å¯¹è±¡çš„æ‰€æœ‰å±æ€§éƒ½è¦ç›¸ç­‰ï¼Œéœ€è¦æ ¹æ®å¯¹è±¡çš„å…·ä½“ä¸šåŠ¡åœºæ™¯è¿›è¡Œå…·ä½“åˆ†æã€‚</p><p>ä¾‹å¦‚ï¼Œä¸¤ä¸ªç½—æŠ€ç‰Œé¼ æ ‡ï¼Œå®ƒä»¬çš„å±æ€§é™¤äº†å“ç‰Œã€å‹å·ã€å°ºå¯¸å’Œä»·æ ¼å¤–ï¼Œè¿˜æœ‰å¦‚ç”Ÿäº§åœ°åŒºã€å”®å–æ–¹å¼ç­‰å±æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬å¯èƒ½åªéœ€è¦å¯¹æ¯”å®ƒä»¬çš„å“ç‰Œã€å‹å·å’Œå°ºå¯¸ç­‰å±æ€§ï¼Œåœ¨è¿™ä¸ªèŒƒå›´å†…å…¶ä½™çš„å±æ€§ä¸éœ€å…³å¿ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸¤ä¸ªå¯¹è±¡çš„å€¼æ˜¯å¦ç›¸ç­‰éœ€è¦æ ¹æ®å¯¹è±¡çš„ä¸šåŠ¡åœºæ™¯å†³å®šï¼Œè€Œä¸æ˜¯æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡å‡†æ¥æ¯”è¾ƒã€‚</p><p>æ‰€ä»¥ï¼Œ<code>Object</code>ç±»æä¾›äº†<code>equals()</code>æ–¹æ³•æ¥è®©å„ä¸ªç±»é€‰æ‹©é‡å†™ï¼Œç”¨ä»¥å®ç°ç¬¦åˆè‡ªèº«ä¸šåŠ¡åœºæ™¯çš„å¯¹è±¡ç›¸ç­‰æ¯”è¾ƒã€‚</p></blockquote><h3 id="ä¸Šè¿°ä»£ç ä¸­çš„å˜é‡aå’Œbåœ¨å†…å­˜ä¸­çš„ç»“æ„"><a href="#ä¸Šè¿°ä»£ç ä¸­çš„å˜é‡aå’Œbåœ¨å†…å­˜ä¸­çš„ç»“æ„" class="headerlink" title="ä¸Šè¿°ä»£ç ä¸­çš„å˜é‡aå’Œbåœ¨å†…å­˜ä¸­çš„ç»“æ„"></a>ä¸Šè¿°ä»£ç ä¸­çš„å˜é‡<code>a</code>å’Œ<code>b</code>åœ¨å†…å­˜ä¸­çš„ç»“æ„</h3><p>åœ¨<code>Java</code>ä¸­ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨é€šå¸¸æ˜¯ï¼šæ ˆä¸­çš„å¼•ç”¨æŒ‡å‘å †å†…çš„å¯¹è±¡ã€‚å¯¹äºå­—ç¬¦ä¸²å¯¹è±¡æ¥è¯´ï¼Œè¿˜æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡æ± ç”¨æ¥å­˜å‚¨å­—ç¬¦ä¸²å¯¹è±¡ï¼ˆå®ƒæ˜¯ä¸€ä¸ª<code>JVM</code>çº§åˆ«çš„å­—ç¬¦ä¸²ç¼“å­˜ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¼šå‡ºç°æ ˆä¸­çš„å¼•ç”¨æŒ‡å‘å¸¸é‡æ± ä¸­çš„å¯¹è±¡ã€‚</p><blockquote><p>åœ¨<code>Java6</code>ä¹‹å‰ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä½äºæ–¹æ³•åŒºå†…ï¼›</p><p>è€Œåœ¨<code>Java7</code>ä¸­ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± è¢«ç§»åˆ°äº†å †å†…å­˜ä¸­ï¼›</p><p>åœ¨<code>Java8</code>ä¸­ï¼Œæå‡ºäº†å…ƒç©ºé—´çš„æ¦‚å¿µï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä¹Ÿéšä¹‹ç§»åŠ¨åˆ°äº†å…ƒç©ºé—´ã€‚</p></blockquote><h3 id="ç¼–è¯‘æ—¶çš„ä¼˜åŒ–"><a href="#ç¼–è¯‘æ—¶çš„ä¼˜åŒ–" class="headerlink" title="ç¼–è¯‘æ—¶çš„ä¼˜åŒ–"></a>ç¼–è¯‘æ—¶çš„ä¼˜åŒ–</h3><p>å˜é‡<code>a</code>æ˜¯é€šè¿‡<code>+</code>æ‹¼æ¥å­—é¢é‡è¿›è¡Œèµ‹å€¼çš„ï¼Œåœ¨ç¼–è¯‘æœŸï¼Œ<code>String a = &quot;Hello&quot; + &quot; World&quot; + &quot;!&quot;;</code>å°±å·²ç»è¢«ç¼–è¯‘æˆ<code>String a = &quot;Hello World!&quot;;</code>äº†ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿå› ä¸ºå­—é¢é‡çš„å€¼æ˜¯ç¡®å®šçš„ï¼Œè¿è¡Œæ—¶ä¸å†éœ€è¦ä»»ä½•è®¡ç®—ï¼Œä¹Ÿå°±æ²¡æœ‰ä½¿ç”¨<code>+</code>è¿ç®—ç¬¦çš„å¿…è¦äº†ï¼Œç¼–è¯‘å™¨ä¹Ÿè¿™ä¹ˆè§‰å¾—ï¼šâ€œè¿™ä¸æ˜¯åœ¨è„±è£¤å­æ”¾å±å—â€ï¼Ÿæ‰€ä»¥åœ¨ç¼–è¯‘æœŸè¿ç®—ç¬¦å°±è¢«å»é™¤äº†ã€‚äºæ˜¯<code>a</code>å’Œ<code>b</code>çš„èµ‹å€¼æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚</p><h3 id="è¿è¡ŒåŸç†"><a href="#è¿è¡ŒåŸç†" class="headerlink" title="è¿è¡ŒåŸç†"></a>è¿è¡ŒåŸç†</h3><p>å¯¹äºå˜é‡<code>a</code>å’Œ<code>b</code>è¿™ç§ä½¿ç”¨å­—é¢é‡åˆ›å»ºå­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œåœ¨åˆ›å»ºå˜é‡<code>a</code>æ—¶ï¼Œ<code>JVM</code>é¦–å…ˆä¼šå»å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æŸ¥æ‰¾<code>&quot;Hello World!&quot;</code>è¿™ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­åˆ›å»ºä¸€ä¸ª<code>&quot;Hello World!&quot;</code>å¯¹è±¡ï¼Œç„¶åå°†å¸¸é‡æ± ä¸­<code>&quot;Hello World!&quot;</code>è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨åœ°å€èµ‹ç»™æ ˆä¸­çš„å¼•ç”¨<code>a</code>ï¼Œè¿™æ ·æ ˆä¸­çš„å¼•ç”¨<code>a</code>å°±æŒ‡å‘äº†å¸¸é‡æ± ä¸­çš„<code>&quot;Hello World!&quot;</code>å¯¹è±¡ï¼›å¦‚æœå·²ç»å­˜åœ¨ï¼Œåˆ™ä¸ä¼šå†æ¬¡åˆ›å»ºæ–°å¯¹è±¡ï¼Œç›´æ¥å°†å·²æœ‰çš„<code>&quot;Hello World!&quot;</code>å¯¹è±¡çš„åœ°å€è¿”å›ï¼Œèµ‹ç»™æ ˆä¸­çš„å¼•ç”¨<code>b</code>ï¼Œäºæ˜¯ï¼Œæ ˆä¸­çš„å¼•ç”¨<code>b</code>ä¹ŸæŒ‡å‘äº†å¸¸é‡æ± ä¸­çš„<code>&quot;Hello World!&quot;</code>å¯¹è±¡ã€‚</p><p>å¸¸é‡æ± ä¸­çš„<code>&quot;Hello World!&quot;</code>å¯¹è±¡åªæœ‰ä¸€ä»½ï¼Œäºæ˜¯ä½¿ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒå˜é‡<code>a</code>å’Œ<code>b</code>ä¼šè¿”å›<code>true</code>ã€‚</p><h2 id="ç¼–è¯‘å™¨çš„ä¼˜åŒ–"><a href="#ç¼–è¯‘å™¨çš„ä¼˜åŒ–" class="headerlink" title="ç¼–è¯‘å™¨çš„ä¼˜åŒ–"></a>ç¼–è¯‘å™¨çš„ä¼˜åŒ–</h2><p>æˆ‘ä»¬å†æ¥çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String m = <span class="string">&quot;a&quot;</span>;</span><br><span class="line">    <span class="keyword">final</span> String n = <span class="string">&quot;a&quot;</span>;</span><br><span class="line">    String x = m + <span class="string">&quot;b&quot;</span>;</span><br><span class="line">    String y = n + <span class="string">&quot;b&quot;</span>;</span><br><span class="line">    String z = getA() + <span class="string">&quot;b&quot;</span>;</span><br><span class="line">    String compare = <span class="string">&quot;ab&quot;</span>;</span><br><span class="line">    System.out.println(x == compare);</span><br><span class="line">    System.out.println(y == compare);</span><br><span class="line">    System.out.println(z == compare);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;a&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ å¿ƒä¸­æœ‰ç­”æ¡ˆå—ï¼ŸçŸ¥é“æ¯ä¸ªç­”æ¡ˆçš„åŸç†å—ï¼Ÿ</p><p>å¦‚æœè¿˜æ²¡æœ‰ï¼Œä¸‹é¢çš„å†…å®¹ä½ åº”è¯¥ä»”ç»†é˜…è¯»ã€‚</p><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">false</span><br><span class="line">true</span><br><span class="line">false</span><br></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œç¬¬ä¸€ä¸ªè¾“å‡ºï¼Œå˜é‡<code>x</code>ä¸<code>compare</code>æ¯”è¾ƒï¼Œå˜é‡<code>x</code>ç­‰äºå±€éƒ¨å˜é‡<code>m</code>åŠ ä¸Šå­—ç¬¦ä¸²<code>&quot;b&quot;</code>ï¼Œè™½ç„¶å±€éƒ¨å˜é‡<code>m</code>ä¹ŸæŒ‡å‘äº†ä¸€ä¸ªå­—é¢é‡<code>&quot;a&quot;</code>ï¼Œä½†æ˜¯è¿™ä¸ªå¼•ç”¨å…³ç³»å¹¶æœªè¿›è¡Œâ€œå¼ºåˆ¶çº¦æŸâ€ï¼Œåœ¨è¿è¡ŒæœŸï¼Œå¯é€šè¿‡å­—èŠ‚ç å¢å¼ºæŠ€æœ¯æ¥åŠ¨æ€æ”¹å˜è¯¥å¼•ç”¨çš„æŒ‡å‘ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å¹¶æœªç›´æ¥å°†å…¶ä¼˜åŒ–æˆ<code>&quot;ab&quot;</code>ã€‚è€Œæ˜¯å°†å…¶ä¼˜åŒ–æˆäº†<code>StringBuilder</code>çš„å½¢å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">StringBuilder temp = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">temp.append(m).append(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">String x = temp.toString();</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»ºçš„<code>StringBuilder</code>å¯¹è±¡ä½äºå †å†…å­˜ä¸­ï¼Œäºæ˜¯å˜é‡<code>x</code>æŒ‡å‘äº†å †ä¸­çš„å¯¹è±¡ã€‚è€Œå±€éƒ¨å˜é‡<code>compare</code>æŒ‡å‘å­—é¢é‡<code>&quot;ab&quot;</code>ï¼ŒæŒ‰ç…§å‰æ–‡çš„å™è¿°ï¼Œ<code>JVM</code>å°†ä¼šå…ˆå»å­—ç¬¦ä¸²å¸¸é‡æ± å¯»æ‰¾<code>&quot;ab&quot;</code>å­—ç¬¦ä¸²å¯¹è±¡ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™ä¼šç›´æ¥è¿”å›å¸¸é‡æ± ä¸­åœ°å€è¿”å›ï¼Œèµ‹ç»™å¼•ç”¨<code>compare</code>ã€‚</p><p>å˜é‡<code>x</code>æŒ‡å‘å †å†…å­˜ï¼Œè€Œå˜é‡<code>compare</code>æŒ‡å‘å¸¸é‡æ± å†…å­˜ï¼Œæ‰€ä»¥ä½¿ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒçš„ç»“æœä¸º<code>false</code>ã€‚</p><p>ç¬¬äºŒä¸ªè¾“å‡ºï¼Œå˜é‡<code>y</code>ä¸<code>compare</code>æ¯”è¾ƒï¼Œå˜é‡<code>y</code>ç­‰äºå±€éƒ¨å˜é‡<code>n</code>åŠ ä¸Šå­—ç¬¦ä¸²<code>&quot;b&quot;</code>ï¼Œè™½ç„¶ä¸å˜é‡<code>x</code>ååˆ†ç±»ä¼¼ï¼Œä½†æ˜¯ï¼Œè¯·æ³¨æ„å±€éƒ¨å˜é‡<code>n</code>å‰é¢å£°æ˜çš„<code>final</code>å…³é”®å­—ï¼Œå®ƒå…·æœ‰ä¸å¯å˜æ€§ï¼Œå³<code>n</code>åªä¼šè¢«èµ‹å€¼ä¸€æ¬¡ã€‚ä¿è¯äº†å±€éƒ¨å˜é‡<code>n</code>å§‹ç»ˆæŒ‡å‘å­—é¢é‡<code>&quot;a&quot;</code>æ‰€åœ¨çš„å†…å­˜åœ°å€ï¼ŒæŒ‰ç…§ç¨‹åºçš„é€»è¾‘é¡ºåºï¼Œå­—é¢é‡<code>&quot;a&quot;</code>æ­¤æ—¶å·²ç»å­˜åœ¨äºå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­äº†ï¼Œæ‰€ä»¥å±€éƒ¨å˜é‡<code>n</code>å§‹ç»ˆæŒ‡å‘å¸¸é‡æ± ä¸­<code>&quot;a&quot;</code>æ‰€åœ¨çš„å†…å­˜åœ°å€ã€‚è¿™ä¸ªå¼•ç”¨å…³ç³»æ˜¯æ— æ³•è¿›è¡Œä¿®æ”¹çš„ã€‚æ‰€ä»¥ç¼–è¯‘å™¨å°†å˜é‡<code>y</code>ç›´æ¥ä¼˜åŒ–æˆäº†<code>&quot;ab&quot;</code>ã€‚</p><p>ç¬¬ä¸‰ä¸ªè¾“å‡ºï¼Œå˜é‡<code>z</code>ä¸<code>compare</code>æ¯”è¾ƒï¼Œå˜é‡<code>z</code>ç”±ä¸€ä¸ªæ–¹æ³•çš„è¿”å›å€¼åŠ ä¸Šå­—ç¬¦ä¸²<code>&quot;b&quot;</code>ç»„æˆï¼Œè™½ç„¶æ–¹æ³•å†…è¿”å›ä¸€ä¸ªå¸¸é‡çš„å¼•ç”¨ï¼Œä½†æ˜¯ç¼–è¯‘å™¨å¹¶ä¸ä¼šçœ‹æ–¹æ³•å†…è¿”å›äº†ä»€ä¹ˆï¼Œå› ä¸ºæ–¹æ³•å†…éƒ¨çš„è¡Œä¸ºæ˜¯æœªçŸ¥çš„ï¼Œå¯èƒ½ä¼šå‡ºç°å¤šé‡é€’å½’ï¼Œè€Œä¸”é€’å½’è¿‡åä¹Ÿä¸ä¸€å®šä¼šè¿”å›å›ºå®šçš„å¸¸é‡å€¼ã€‚æ‰€ä»¥ç¼–è¯‘å™¨ä¸ä¼šå°†å˜é‡<code>z</code>ä¼˜åŒ–æˆ<code>&quot;ab&quot;</code>ã€‚</p><p>ç¼–è¯‘å™¨çš„ä»£ç ä¼˜åŒ–ä¸€å®šæ˜¯åœ¨ç¼–è¯‘æœŸå°±èƒ½ç¡®å®šä¼˜åŒ–åä¸ä¼šæ”¹å˜åŸæœ‰åŠŸèƒ½ï¼Œç±»ä¼¼äº<code>final</code>å¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨åªä¼šè¢«èµ‹å€¼ä¸€æ¬¡ã€‚åªæœ‰åœ¨ç¼–è¯‘é˜¶æ®µèƒ½ç¡®å®šè¿™ä¸ªå¼•ç”¨è¢«èµ‹å€¼çš„å†…å®¹ï¼Œç¼–è¯‘å™¨æ‰å¯èƒ½è¿›è¡Œç¼–è¯‘æœŸä¼˜åŒ–ï¼Œä¸è¦å’Œè¿è¡ŒæœŸçš„åŠ¨ä½œå…³è”åˆ°ä¸€èµ·ï¼Œç¼–è¯‘æœŸèƒ½ç¡®å®šçš„å†…å®¹åªæ¥æºäºå¸¸é‡æ± ï¼Œä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»ºå¯¹è±¡å±äºè¿è¡ŒæœŸçš„åŠ¨ä½œã€‚åŒæ ·åœ°ï¼Œæ–¹æ³•çš„è¿”å›å€¼ä¹Ÿæ˜¯ä¸èƒ½ç¡®å®šçš„ï¼Œè¿è¡ŒæœŸçš„æ–¹æ³•å¯èƒ½ä¼šè¿”å›ä¸åŒçš„å€¼ã€‚</p><h2 id="String-intern-æ–¹æ³•"><a href="#String-intern-æ–¹æ³•" class="headerlink" title="String#intern()æ–¹æ³•"></a><code>String#intern()</code>æ–¹æ³•</h2><p>æœ‰äº†ä¸Šé¢çš„çŸ¥è¯†åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String a = <span class="string">&quot;a&quot;</span>;</span><br><span class="line">    String b = a + <span class="string">&quot;b&quot;</span>;</span><br><span class="line">    String c = <span class="string">&quot;ab&quot;</span>;</span><br><span class="line">    String d = <span class="keyword">new</span> String(b);</span><br><span class="line">    System.out.println(b == c);</span><br><span class="line">    System.out.println(c == d);</span><br><span class="line">    System.out.println(c == d.intern());</span><br><span class="line">    System.out.println(b.intern() == d.intern());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç å¢åŠ äº†<code>intern()</code>æ–¹æ³•çš„è°ƒç”¨ï¼Œå…¶è¾“å‡ºç»“æœä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">false</span><br><span class="line">false</span><br><span class="line">true</span><br><span class="line">true</span><br></pre></td></tr></table></figure><p>å¯¹äºå‰ä¸¤ä¸ªè¾“å‡ºï¼Œä½ åº”è¯¥èƒ½çŸ¥é“ç­”æ¡ˆã€‚ç¬¬ä¸€ä¸ªè¾“å‡ºåœ¨ä¸Šä¸€ä¸ªä¾‹å­ä¸­è®²è¿‡äº†ï¼Œè¾“å‡ºä¸º<code>false</code>ï¼›ç¬¬äºŒä¸ªè¾“å‡ºï¼Œå˜é‡<code>c</code>åœ¨å¸¸é‡æ± ä¸­ï¼Œå˜é‡<code>d</code>åœ¨å †ä¸­ï¼Œè¾“å‡ºä¸º<code>false</code>ã€‚</p><p>å¯¹äºåä¸¤ä¸ªè¾“å‡ºï¼Œå¦‚æœä½ ä¸äº†è§£<code>intern()</code>æ–¹æ³•çš„ä½œç”¨ï¼Œææ€•ä¸èƒ½ç»™å‡ºåˆç†çš„è§£é‡Šã€‚</p><p>å½“è°ƒç”¨<code>String</code>ç±»çš„<code>intern()</code>æ–¹æ³•æ—¶ï¼Œ<code>JVM</code>ä¼šåœ¨å¸¸é‡æ± ä¸­é€šè¿‡<code>equals()</code>æ–¹æ³•æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›å¸¸é‡æ± ä¸­çš„åœ°å€ï¼›å¦åˆ™ï¼Œåˆ™ä¼šå°†è¯¥å­—ç¬¦ä¸²åŠ å…¥å¸¸é‡æ± ï¼ˆå¼€è¾Ÿæ–°çš„å†…å­˜ç©ºé—´ï¼‰ï¼Œç„¶åè¿”å›å¸¸é‡æ± ä¸­æ–°å¼€è¾Ÿçš„è¿™å—å†…å­˜ç©ºé—´åœ°å€ã€‚æ‰€ä»¥ï¼Œåªè¦æ˜¯å€¼ç›¸ç­‰ï¼ˆ<code>equals()</code>æ–¹æ³•æ¯”è¾ƒç›¸ç­‰ï¼‰çš„å­—ç¬¦ä¸²ï¼Œå½“è°ƒç”¨<code>intern()</code>æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šå¾—åˆ°å¸¸é‡æ± ä¸­å¯¹åº”å­—ç¬¦ä¸²çš„å¼•ç”¨åœ°å€ï¼Œæ‰€ä»¥ä½¿ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒä¼šè¿”å›<code>true</code>ã€‚</p><p>å¯¹äºç¬¬ä¸‰ä¸ªè¾“å‡ºï¼Œå˜é‡<code>c</code>ä½¿ç”¨å­—é¢é‡èµ‹å€¼ï¼Œå¾—åˆ°çš„æ˜¯å¸¸é‡æ± ä¸­çš„å¼•ç”¨ï¼›è€Œå˜é‡<code>d</code>ä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªå †ä¸­å¯¹è±¡ï¼Œä½†è°ƒç”¨<code>intern()</code>æ–¹æ³•åå‘ç°å¸¸é‡æ± ä¸­å·²ç»å­˜åœ¨äº†<code>&quot;ab&quot;</code>ï¼Œæ‰€ä»¥è¿”å›å¸¸é‡æ± çš„å¼•ç”¨åœ°å€ï¼Œäºæ˜¯ä½¿ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒè¿”å›<code>true</code>ã€‚</p><p>å¯¹äºç¬¬å››ä¸ªè¾“å‡ºï¼Œå˜é‡<code>b</code>å’Œ<code>d</code>éƒ½è°ƒç”¨äº†<code>intern()</code>æ–¹æ³•ï¼Œå¾—åˆ°çš„éƒ½æ˜¯å¸¸é‡æ± ä¸­çš„å¼•ç”¨åœ°å€ï¼Œè‡ªç„¶ä½¿ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒè¿”å›<code>true</code>ã€‚</p><h2 id="StringBuilderå¯¹è±¡"><a href="#StringBuilderå¯¹è±¡" class="headerlink" title="StringBuilderå¯¹è±¡"></a><code>StringBuilder</code>å¯¹è±¡</h2><p>åœ¨é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œä¸­ï¼Œæ¨èåœ¨<code>for</code>å¾ªç¯ä½“å†…ä½¿ç”¨<code>StringBuilder</code>å¯¹è±¡çš„<code>append()</code>æ–¹æ³•è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œè€Œä¸æ˜¯<code>+</code>å·ã€‚</p><p>æ‰‹å†Œä¸­ç»™å‡ºçš„åä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="string">&quot;start&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">100</span>;i++) &#123;</span><br><span class="line">str = str + <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºæ²¡æœ‰ç»™å‡ºæ­£ä¾‹ï¼Œæœ‰äº›äººåœ¨ç†è§£ä¸Šå¯èƒ½å‡ºç°äº†ä¸€äº›åå·®ï¼Œäºæ˜¯å‡ºç°äº†ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="string">&quot;start&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">100</span>;i++) &#123;</span><br><span class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    sb.append(str)</span><br><span class="line">      .append(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">str = sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šè¿™ä¹Ÿæ˜¯åä¾‹ï¼Œåªä¸è¿‡æ˜¯æ‰‹å†Œä¸­ç»™å‡ºçš„åä¾‹ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘ä¹‹åçš„ã€‚</p><p>é˜¿é‡Œå·´å·´çš„è¿™ä¸ªæ¨èçš„åˆè¡·æ˜¯ä¸è¦åœ¨å¾ªç¯ä½“å†…ä½¿ç”¨<code>+</code>å·ï¼Œå› ä¸º<code>+</code>å·ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–æˆ<code>StringBuilder</code>å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒçš„å»ºè®®å®é™…æ˜¯ä¸è¦åœ¨å¾ªç¯ä½“å†…åˆ›å»º<code>StringBuilder</code>å¯¹è±¡ã€‚</p><p>æ­£ç¡®çš„å†™æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">String str = <span class="string">&quot;start&quot;</span>;</span><br><span class="line">sb.append(str);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">100</span>;i++) &#123;</span><br><span class="line">sb.append(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">str = sb.toString();</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¿™æ ·å»ºè®®ï¼Ÿä½¿ç”¨<code>+</code>æœ‰ä»€ä¹ˆä¸å¥½çš„åœ°æ–¹ï¼Ÿ</p><p>ä½¿ç”¨<code>+</code>å·å®é™…æ˜¯åœ¨å¾ªç¯ä½“å†…åˆ›å»ºäº†<code>StringBuilder</code>å¯¹è±¡ï¼Œè°ƒç”¨<code>append()</code>æ–¹æ³•æ‹¼æ¥åé‡æ–°ç»™å¼•ç”¨<code>str</code>èµ‹å€¼ï¼Œè¿™ä¼šå¯¼è‡´<code>str</code>æŒ‡å‘çš„å­—ç¬¦ä¸²è¶Šæ¥è¶Šå¤§ï¼Œåˆ°è¾¾ä¸€å®šç¨‹åº¦åä¼šè¿›å…¥è€å¹´ä»£ï¼Œç”šè‡³å‡ºç°<code>OOM</code>ã€‚åŒæ—¶æ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ª<code>StringBuilder</code>å¯¹è±¡ï¼Œåœ¨ä¸€æ¬¡å¾ªç¯ç»“æŸåï¼Œè¯¥å¯¹è±¡å°±ä¼šå˜æˆåƒåœ¾ç­‰å¾…å›æ”¶ï¼Œå¯¼è‡´å†…å­˜å¼€é”€å¢å¤§ã€‚</p><p>è€Œæ­£ç¡®çš„å†™æ³•ä¼šåœ¨å¾ªç¯ä½“å¤–é¢„å…ˆåˆ›å»ºä¸€ä¸ª<code>StringBuilder</code>å¯¹è±¡ï¼Œæ¯æ¬¡å¾ªç¯ä¸­éƒ½è°ƒç”¨è¯¥å¯¹è±¡çš„<code>append()</code>æ–¹æ³•æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œé¿å…äº†å†…å­˜å¼€é”€å¤§çš„æƒ…å†µã€‚</p><p>å°ç»“ï¼šè¦æ˜ç¡®çš„ä¸€ç‚¹æ˜¯ï¼Œä¸æ˜¯<code>+</code>å·æ“ä½œæœ¬èº«æ…¢ï¼Œè€Œæ˜¯åœ¨å¾ªç¯ä½“ä¸­æ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºå¯¹è±¡å¯¼è‡´å†…å­˜å¼€é”€å˜å¤§ï¼Œæ¯ä¸€æ¬¡å¾ªç¯åï¼Œåˆ›å»ºçš„å¯¹è±¡å˜æˆäº†åƒåœ¾å¼•å‘<code>GC</code>è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå¯¼è‡´ç¨‹åºå˜æ…¢ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…³äº<code>String</code>ç±»ï¼Œæœ¬æ–‡åªæ˜¯æŠ›ç –å¼•ç‰ï¼Œå¾ˆå¤šç»†èŠ‚å¹¶æœªæåŠï¼Œä¾‹å¦‚<code>StringBuilder</code>åœ¨è¿›è¡Œ<code>append</code>æ—¶çš„æ‰©å®¹ï¼Œåœ¨æ‹¼æ¥å¤§å­—ç¬¦ä¸²å’Œå°å­—ç¬¦ä¸²æ—¶å¦‚ä½•åˆç†ä½¿ç”¨è®©å†…å­˜åˆ©ç”¨ç‡æ›´é«˜ï¼Œè¿˜åŒ…æ‹¬<code>StringBuffer</code>åŒæ­¥ç±»ç­‰å…¶å®ƒå­—ç¬¦ä¸²ç›¸å…³çš„å†…å®¹ã€‚æ€»ä¹‹ï¼Œå­—ç¬¦ä¸²æ˜¯å¼€å‘ä¸­å¿…å®šä¼šä½¿ç”¨åˆ°çš„æ•°æ®ç±»å‹ï¼Œå¦‚æœæ¶‰åŠåˆ°å­—ç¬¦ä¸²æ“ä½œï¼Œè¯·ä¸€å®šè¦è€ƒè™‘åˆ°æ•ˆç‡é—®é¢˜ï¼Œä»å°çš„ç»†èŠ‚å…¥æ‰‹ç²¾å¿ƒé›•ç¢ä»£ç ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java SE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> String </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‹‡é—¯ç®—æ³•-é€’å½’æ³•æ‹¿ä¸‹åè½¬é“¾è¡¨çš„ä¸‰æ€</title>
      <link href="2020/06/04/algorithm/base/recursive-reverse-link/"/>
      <url>2020/06/04/algorithm/base/recursive-reverse-link/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¼–ç¨‹è¯­è¨€ï¼š<code>Javaï¼ˆJDK8ï¼‰</code></p><p>å•é“¾è¡¨èŠ‚ç‚¹ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    ListNode next;</span><br><span class="line">    ListNode(<span class="keyword">int</span> x) &#123; val = x; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äºåè½¬é“¾è¡¨ï¼Œæœ‰è¿­ä»£å’Œé€’å½’ä¸¤ç§å®ç°æ–¹å¼ï¼Œæœ¬æ–‡ä½¿ç”¨é€’å½’å®ç°åè½¬ã€‚</p><p>é¦–å…ˆä»‹ç»é€’å½’çš„æ€æƒ³ï¼Œç„¶åä»æœ€åŸºæœ¬çš„åè½¬æ•´ä¸ªå•é“¾è¡¨å¼€å§‹ï¼Œç”±æµ…å…¥æ·±ï¼Œæœ€ç»ˆæ‹¿ä¸‹åè½¬é“¾è¡¨çš„â€œä¸‰æ€â€ï¼</p><h2 id="é€’å½’æ€æƒ³"><a href="#é€’å½’æ€æƒ³" class="headerlink" title="é€’å½’æ€æƒ³"></a>é€’å½’æ€æƒ³</h2><blockquote><p>ä»»ä½•ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœèƒ½å¤Ÿç”¨è¿­ä»£è§£å†³ï¼Œé‚£ä¹ˆä¸€å®šå¯ä»¥è½¬æ¢æˆé€’å½’ã€‚  â€”â€” æŸç®—æ³•å¤§ç¥</p></blockquote><p>æˆ‘ä»¬å¾ˆéš¾å»è¯æ˜å¤§ç¥çš„è¯´æ³•ä¸æ­£ç¡®ï¼Œä½†æˆ‘ä»¬å¯ä»¥å…ˆå‡è®¾ä»–çš„ç†è®ºæˆç«‹ã€‚å…ˆå¼ºè¡Œè®©è‡ªå·±æ¥å—ã€‚</p><p>æ©ï¼æ²¡é”™ï¼èƒ½å¤Ÿç”¨è¿­ä»£è§£å†³å°±ä¸€å®šèƒ½ç”¨é€’å½’è§£å†³ï¼</p><p>æ˜¯ä¸æ˜¯æœ‰é€’å½’â€œå†…å‘³â€äº†ï¼Ÿå…ˆå‡è®¾æ¡ä»¶æˆç«‹ï¼ŒæŠŠä¸»è¦é€»è¾‘èµ°é€šã€‚</p><p>é‚£ä¹ˆåˆ°åº•å¦‚ä½•å°†è¿­ä»£è½¬æ¢æˆé€’å½’å‘¢ï¼Ÿ</p><p>è¿­ä»£æ˜¯éå†ï¼Œä¸€ä¸ªä¸€ä¸ªåœ°è¿›è¡Œè¿­ä»£å¤„ç†ï¼›</p><p>è€Œé€’å½’å‘¢ï¼Ÿåœ¨å¤„ç†ç¬¬ä¸€ä¸ªçš„æ—¶å€™è¦å…ˆå‡è®¾åé¢çš„å…¨éƒ¨éƒ½å¤„ç†å®Œäº†ï¼Œåªéœ€å¤„ç†ç¬¬ä¸€ä¸ªï¼Œæ‰€ä»¥ï¼Œåªè¦ç¬¬ä¸€ä¸ªå¤„ç†å®Œäº†ï¼Œæ•´ä¸ªå°±å¤„ç†å®Œäº†ï¼ˆæ„Ÿè§‰å®Œå…¨æ— æ³•æ¥å—å•Šï¼‰ã€‚</p><p>â€œå‡è®¾â€å§‹ç»ˆæ˜¯å‡è®¾ï¼Œä½†æ˜¯å®ƒèƒ½è®©æˆ‘ä»¬çš„å½“å‰é€»è¾‘èµ°é€šã€‚åœ¨ç¬¬ä¸€æ¬¡çš„å‡è®¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œç¬¬äºŒæ¬¡åœ°å‡è®¾ï¼Œå‡è®¾åé¢çš„æ•°æ®çš„ç¬¬ä¸€ä¸ªä¹‹åçš„æ•°æ®å…¨éƒ½å¤„ç†å®Œäº†ï¼Œåˆ™åªéœ€å¤„ç†æ­¤æ—¶çš„ç¬¬ä¸€ä¸ªã€‚è¿™æ ·ä¸åœåœ°å‡è®¾ä¸‹å»ï¼Œç›´åˆ°å‡è®¾åˆ°æ•´ä½“çš„æœ€åä¸€ä¸ªæ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™æ²¡æœ‰æ•°æ®è®©æˆ‘ä»¬å‡è®¾äº†ï¼Œä¸èƒ½å†â€œéª—è‡ªå·±â€äº†ï¼è¦æ‹¿å‡ºç‚¹çœŸæœ¬äº‹æ¥ï¼æˆ‘ä»¬å¯¹æ•´ä½“çš„æœ€åä¸€ä¸ªæ•°æ®è¿›è¡ŒçœŸå®çš„å¤„ç†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°ï¼Œå€’æ•°ç¬¬äºŒä¸ªæ•°æ®çš„å‡è®¾æˆç«‹äº†ï¼å¤šç±³åŒéª¨ç‰Œæ•ˆåº”ï¼ä¹‹å‰æ‰€æœ‰çš„å‡è®¾éƒ½æˆç«‹äº†ï¼é—®é¢˜è§£å†³äº†ï¼</p><h2 id="First-Bloodï¼šåè½¬æ•´ä¸ªå•é“¾è¡¨"><a href="#First-Bloodï¼šåè½¬æ•´ä¸ªå•é“¾è¡¨" class="headerlink" title="First Bloodï¼šåè½¬æ•´ä¸ªå•é“¾è¡¨"></a><code>First Blood</code>ï¼šåè½¬æ•´ä¸ªå•é“¾è¡¨</h2><p>é¦–å…ˆç”¨é€’å½’æ¥è§£å†³æœ€åŸºæœ¬çš„æ•´ä¸ªå•é“¾è¡¨çš„åè½¬ã€‚ï¼ˆâ€œå¯¹é¢è¾…åŠ©å¼€å§‹æäº‹æƒ…äº†â€ï¼‰</p><p>ä¾‹å¦‚ï¼šå•é“¾è¡¨ä¸ºï¼š<code>1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; null</code>ï¼Œé‚£ä¹ˆåè½¬ä¹‹åçš„å•é“¾è¡¨ä¸ºï¼š<code>null &lt;- 1 &lt;- 2 &lt;- 3 &lt;- 4 &lt;- 5</code>ã€‚</p><p>å¯¹åº”ä¸Šé¢çš„é€’å½’æ€æƒ³ï¼šåœ¨åè½¬ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå…ˆå‡è®¾åé¢çš„èŠ‚ç‚¹å…¨éƒ½åè½¬å®Œäº†ï¼Œè¿”å›äº†åè½¬åçš„å¤´èŠ‚ç‚¹ï¼Œå®ƒå°±æ˜¯æ•´ä¸ªå•é“¾è¡¨åè½¬å®Œæˆåçš„å¤´èŠ‚ç‚¹ï¼Œäºæ˜¯æˆ‘ä»¬åªéœ€å°†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œåè½¬ï¼Œæ•´ä¸ªé“¾è¡¨çš„åè½¬å°±å®Œæˆäº†ã€‚åœ¨ç¬¬ä¸€æ¬¡å‡è®¾ä¸­ï¼ŒåŒæ ·è¿›è¡Œå‡è®¾ï¼Œä¸åœåœ°å‡è®¾ï¼Œç›´åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œåé¢æ²¡æœ‰èŠ‚ç‚¹è®©æˆ‘ä»¬è¿›è¡Œå‡è®¾äº†ï¼Œæˆ‘ä»¬è¿›è¡ŒçœŸå®çš„åè½¬ã€‚è¿™æ—¶ä¹‹å‰æ‰€æœ‰çš„å‡è®¾åƒå¤šç±³åŒéª¨ç‰Œä¸€æ ·åœ°æˆç«‹äº†ï¼Œæ•´ä¸ªå•é“¾è¡¨åè½¬å®Œæˆï¼</p><p>å¥½åƒæ— æ³•ç†è§£ï¼Ÿæ²¡å…³ç³»ï¼ŒæŒ‰é€’å½’çš„æ€æƒ³ï¼Œå…ˆå‡è®¾è‡ªå·±ç†è§£äº†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title">reverse</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> (head.next == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">// ä¸èƒ½å†â€œéª—è‡ªå·±â€äº†</span></span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    <span class="comment">// å‡è®¾åé¢çš„èŠ‚ç‚¹å…¨éƒ½åè½¬å®Œæˆï¼Œè¿”å›äº†åè½¬åçš„å¤´èŠ‚ç‚¹ï¼Œå³ä¸ºæ•´ä¸ªå•é“¾è¡¨åè½¬åçš„å¤´èŠ‚ç‚¹</span></span><br><span class="line">    ListNode reverseHead = reverse(head.next);</span><br><span class="line">    <span class="comment">// åè½¬ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    head.next.next = head;</span><br><span class="line">    head.next = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// è¿”å›åè½¬åçš„å¤´èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> reverseHead;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>reverse</code>å‡½æ•°çš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼šè¾“å…¥ä¸€ä¸ªèŠ‚ç‚¹<code>head</code>ï¼Œå°†ä»¥<code>head</code>ä¸ºå¤´èŠ‚ç‚¹çš„é“¾è¡¨åè½¬ï¼Œè¿”å›åè½¬åçš„å¤´èŠ‚ç‚¹ã€‚</p><p>æˆ‘ä»¬è¦åè½¬çš„é“¾è¡¨ä¸ºï¼š<code>1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; null</code>ï¼š</p><p><code>reverse(1)</code>ï¼šè¾“å…¥ç¬¬ä¸€ä¸ªèŠ‚ç‚¹<code>1</code>æ—¶ï¼›</p><p>å‡è®¾åé¢çš„èŠ‚ç‚¹å·²ç»åè½¬å®Œæˆå¹¶è¿”å›äº†åè½¬åçš„å¤´èŠ‚ç‚¹ï¼š<code>ListNode reverseHead = reverse(head.next);</code></p><p>åé¢çš„èŠ‚ç‚¹åè½¬åçš„ç»“æœä¸ºï¼š<code>null &lt;- 2 &lt;- 3 &lt;- 4 &lt;- 5</code>ï¼Œè¿”å›çš„å¤´èŠ‚ç‚¹<code>reverseHead</code>ä¸º<code>5</code>ï¼›</p><p>æ­¤æ—¶æˆ‘ä»¬åªéœ€è¦å¯¹èŠ‚ç‚¹<code>1</code>è¿›è¡Œåè½¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å°†èŠ‚ç‚¹1çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹2çš„æŒ‡é’ˆåŸŸæŒ‡å‘èŠ‚ç‚¹1</span><br><span class="line">head.next.next &#x3D; head;</span><br><span class="line">&#x2F;&#x2F; å°†èŠ‚ç‚¹1çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘null</span><br><span class="line">head.next &#x3D; null;</span><br></pre></td></tr></table></figure><p>æ•´ä¸ªé“¾è¡¨çš„åè½¬å°±å®Œæˆäº†ï¼</p><p>ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½â€œéª—è‡ªå·±â€ï¼<code>reverse</code>å‡½æ•°ä¸åœåœ°è¿›è¡Œå‡è®¾ï¼Œå½“å®ƒæ¥æ”¶åˆ°åŸé“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œæ²¡æœ‰èŠ‚ç‚¹è¿›è¡Œå‡è®¾äº†ï¼Œå¿…é¡»å»åè½¬ï¼</p><p>ç”±äºåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåè½¬åè¿˜æ˜¯è‡ªèº«ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¿”å›è¯¥èŠ‚ç‚¹ï¼Œå³ä¸ºåè½¬åçš„å¤´èŠ‚ç‚¹ã€‚è¿™æ—¶æˆ‘ä»¬æƒŠå¥‡çš„å‘ç°å‰é¢æ‰€æœ‰çš„å‡è®¾éƒ½æˆç«‹äº†ï¼</p><p>è¿™å°±æ˜¯æ‰€è°“çš„é€’å½’çš„å‡ºå£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if (head.next &#x3D;&#x3D; null)</span><br><span class="line">    return head;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç”»å¼ å›¾æ¥çœ‹ä¸‹æ•´ä¸ªæµç¨‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/algorithm/base/reverselink-01.png" alt="reverselink-01.png"></p><p>æˆ‘ä»¬çš„é€’å½’ç®—æ³•åªéœ€è¦å…³æ³¨åŸé“¾è¡¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå¤´èŠ‚ç‚¹ï¼‰å’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå°¾èŠ‚ç‚¹ï¼‰ï¼Œä¹Ÿå°±æ˜¯é€’å½’å¼€å§‹çš„èŠ‚ç‚¹å’Œæ— æ³•å†è¿›è¡Œå‡è®¾çš„èŠ‚ç‚¹ã€‚åœ¨é€’å½’å‡½æ•°ä¸­ï¼Œé¦–å…ˆè¦å¤„ç†å°¾èŠ‚ç‚¹ï¼Œå› ä¸ºè¿™æ˜¯ä¸å¯å†å‡è®¾çš„èŠ‚ç‚¹ï¼›å½“å¤„ç†å¤´èŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬è¿›è¡Œå‡è®¾ï¼Œå‡è®¾å¤´èŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å·²å®Œæˆåè½¬åŒæ—¶è¿”å›äº†åè½¬åçš„æ–°å¤´èŠ‚ç‚¹ï¼Œç„¶åå¯¹å¤´èŠ‚ç‚¹è¿›è¡Œåè½¬ï¼Œæ­¤æ—¶å°±å®Œæˆäº†æ•´ä¸ªå•é“¾è¡¨çš„åè½¬ã€‚</p><p>å­¦ä¼šäº†é€’å½’æ€æƒ³åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„å¼€å§‹â€œä¸‰æ€â€ä¹‹æ—…äº†ï¼</p><h2 id="Double-Killï¼šåè½¬å•é“¾è¡¨çš„å‰Nä¸ªèŠ‚ç‚¹"><a href="#Double-Killï¼šåè½¬å•é“¾è¡¨çš„å‰Nä¸ªèŠ‚ç‚¹" class="headerlink" title="Double Killï¼šåè½¬å•é“¾è¡¨çš„å‰Nä¸ªèŠ‚ç‚¹"></a><code>Double Kill</code>ï¼šåè½¬å•é“¾è¡¨çš„å‰<code>N</code>ä¸ªèŠ‚ç‚¹</h2><p>æœ‰äº†ä¸Šé¢çš„â€œä¸€è¡€â€ï¼Œâ€œåŒæ€â€ç®€ç›´å°±æ˜¯ç™½é€ï¼ï¼ˆâ€œè¾…åŠ©æ­»äº†ï¼Œ<code>ADC</code>å¼€å§‹é€äº†â€ï¼‰</p><p>æˆ‘ä»¬è¦å®ç°çš„å‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * å°†å•é“¾è¡¨çš„å‰nä¸ªèŠ‚ç‚¹è¿›è¡Œåè½¬ã€‚ï¼ˆn &lt;&#x3D; å•é“¾è¡¨é•¿åº¦ï¼‰</span><br><span class="line"> * @param head å•é“¾è¡¨å¤´èŠ‚ç‚¹</span><br><span class="line"> * @param n å‰nä¸ªèŠ‚ç‚¹</span><br><span class="line"> *&#x2F;</span><br><span class="line">public ListNode reverseN(ListNode head,int n) &#123;...&#125;</span><br></pre></td></tr></table></figure><p>å‡è®¾æˆ‘ä»¬è¦åè½¬å•é“¾è¡¨çš„å‰<code>3</code>ä¸ªå…ƒç´ ï¼Œé‚£æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/algorithm/base/reverselink-02.png" alt="reverselink-02.png"></p><p>æŒ‰ç…§é€’å½’æ€æƒ³ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨é€’å½’å¼€å§‹çš„èŠ‚ç‚¹å’Œæ— æ³•å†è¿›è¡Œå‡è®¾çš„èŠ‚ç‚¹ï¼šå³å¤´èŠ‚ç‚¹å’Œç¬¬<code>N</code>ä¸ªèŠ‚ç‚¹ã€‚</p><p>å¯¹äºåŸå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œå…ˆå‡è®¾å…¶åé¢çš„<code>N - 1</code>ä¸ªèŠ‚ç‚¹å·²ç»åè½¬å®Œæˆå¹¶è¿”å›äº†åè½¬åçš„æ–°å¤´èŠ‚ç‚¹ï¼Œæ­¤æ—¶æˆ‘ä»¬åªéœ€è¦åè½¬å¤´èŠ‚ç‚¹ï¼Œå°†å¤´èŠ‚ç‚¹æŒ‡å‘ç¬¬<code>N + 1</code>ä¸ªèŠ‚ç‚¹ï¼Œé“¾è¡¨å‰<code>N</code>ä¸ªèŠ‚ç‚¹çš„åè½¬å°±å®Œæˆäº†ã€‚ä½†æ˜¯æ­¤æ—¶ç¬¬<code>N + 1</code>ä¸ªèŠ‚ç‚¹æˆ‘ä»¬æ— æ³•å¾—çŸ¥ã€‚</p><p>ç”±äºå•é“¾è¡¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬åªæœ‰éå†åˆ°ç¬¬<code>N</code>ä¸ªèŠ‚ç‚¹æ—¶æ‰èƒ½å¾—åˆ°ç¬¬<code>N + 1</code>ä¸ªèŠ‚ç‚¹ï¼Œé‚£æˆ‘ä»¬æœ‰å¿…è¦å•ç‹¬å¯¹é“¾è¡¨è¿›è¡Œéå†è·å–ç¬¬<code>N + 1</code>ä¸ªèŠ‚ç‚¹å—ï¼Ÿ</p><p>å®Œå…¨æ²¡å¿…è¦ï¼å› ä¸ºæˆ‘ä»¬çš„é€’å½’ç®—æ³•æœ¬èº«ä¸€å¼€å§‹å°±è¦å¤„ç†ç¬¬â€œ<code>N</code>â€ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒæ˜¯æ— æ³•å†è¿›è¡Œå‡è®¾çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥ï¼Œé€’å½’å‡½æ•°ä¸­ç¬¬ä¸€æ­¥å¤„ç†ç¬¬â€œ<code>N</code>â€ä¸ªèŠ‚ç‚¹æ—¶è¦è®°å½•ä¸‹ç¬¬<code>N + 1</code>ä¸ªèŠ‚ç‚¹ï¼ˆä½¿ç”¨å…¨å±€å˜é‡ï¼‰ã€‚æ³¨æ„ï¼šè¿™é‡Œçš„ç¬¬<code>N</code>ä¸ªèŠ‚ç‚¹æ˜¯é’ˆå¯¹åŸå•é“¾è¡¨è€Œè¨€çš„ï¼›å¯¹äºæœ€åä¸€ä¸ªæ— æ³•å†è¿›è¡Œå‡è®¾çš„å‡è®¾æ¥è¯´ï¼š<code>N = 1</code>ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥å®Œæˆå¯¹åŸé“¾è¡¨å¤´èŠ‚ç‚¹çš„åè½¬ã€‚ä»è€Œå®Œæˆæ•´ä¸ªå•é“¾è¡¨çš„å‰<code>N</code>ä¸ªèŠ‚ç‚¹åè½¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * è®°å½•åŸé“¾è¡¨çš„ç¬¬N+1ä¸ªèŠ‚ç‚¹</span><br><span class="line"> *&#x2F;</span><br><span class="line">static ListNode nNext;</span><br><span class="line"></span><br><span class="line">public static ListNode reverseN(ListNode head,int n) &#123;</span><br><span class="line">    if (n &#x3D;&#x3D; 1) &#123;</span><br><span class="line">        &#x2F;&#x2F; è®°å½•åŸé“¾è¡¨çš„ç¬¬ n + 1 ä¸ªèŠ‚ç‚¹</span><br><span class="line">        nNext &#x3D; head.next;</span><br><span class="line">        &#x2F;&#x2F; æ— æ³•å†è¿›è¡Œå‡è®¾äº†ï¼Œè¿”å›åè½¬åçš„å¤´èŠ‚ç‚¹</span><br><span class="line">        return head;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; å‡è®¾åé¢èŠ‚ç‚¹çš„å‰ N - 1 ä¸ªèŠ‚ç‚¹å·²ç»å®Œæˆäº†åè½¬ï¼Œå¹¶è¿”å›äº†åè½¬åçš„æ–°å¤´èŠ‚ç‚¹</span><br><span class="line">    ListNode reverseHead &#x3D; reverseN(head.next,n - 1);</span><br><span class="line">    &#x2F;&#x2F; åè½¬åŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹</span><br><span class="line">    head.next.next &#x3D; head;</span><br><span class="line">    head.next &#x3D; nNext;</span><br><span class="line">    &#x2F;&#x2F; è¿”å›åè½¬åçš„æ–°å¤´èŠ‚ç‚¹</span><br><span class="line">    return reverseHead;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€œåŒæ€â€æ‹¿ä¸‹ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æŒæ¡åˆ°é€’å½’çš„å¥—è·¯ï¼Ÿï¼ˆâ€œæ­¤æ—¶å¯¹é¢æ‰“é‡èµ¶åˆ°ä¸‹è·¯ï¼Œå³å°†é€å‡ºä¸‰æ€â€ï¼‰</p><h2 id="Triple-Killï¼šåè½¬å•é“¾è¡¨çš„ç¬¬mä¸ªåˆ°ç¬¬nä¸ªèŠ‚ç‚¹"><a href="#Triple-Killï¼šåè½¬å•é“¾è¡¨çš„ç¬¬mä¸ªåˆ°ç¬¬nä¸ªèŠ‚ç‚¹" class="headerlink" title="Triple Killï¼šåè½¬å•é“¾è¡¨çš„ç¬¬mä¸ªåˆ°ç¬¬nä¸ªèŠ‚ç‚¹"></a><code>Triple Kill</code>ï¼šåè½¬å•é“¾è¡¨çš„ç¬¬<code>m</code>ä¸ªåˆ°ç¬¬<code>n</code>ä¸ªèŠ‚ç‚¹</h2><p>ç»™å®šå•é“¾è¡¨çš„ç´¢å¼•åŒºé—´<code>[m,n]</code>ï¼ˆçº¦å®šä¸è¶Šç•Œï¼‰ï¼Œåè½¬æ­¤åŒºé—´å†…çš„èŠ‚ç‚¹ã€‚ï¼ˆâ€œæ•Œæ–¹æ‰“é‡æ­£åœ¨è·¯ä¸Šâ€ï¼‰</p><p>å·²çŸ¥æ¡ä»¶ä¸ºï¼šå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹å’ŒåŒºé—´<code>m</code>ã€<code>n</code>çš„å€¼ï¼Œæˆ‘ä»¬è¦å®ç°çš„å‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åè½¬ä»måˆ°nä¹‹é—´çš„èŠ‚ç‚¹ã€‚1 &lt;= m &lt; n &lt;= é“¾è¡¨é•¿åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head åŸé“¾è¡¨å¤´èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> m åè½¬å¼€å§‹èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> n åè½¬ç»“æŸèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title">reverseBetweenMToN</span><span class="params">(ListNode head,<span class="keyword">int</span> m,<span class="keyword">int</span> n)</span></span>;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼šå•é“¾è¡¨ä¸ºï¼š<code>1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; null</code>ï¼Œ<code>m = 2, n = 4</code>ï¼Œé‚£ä¹ˆåè½¬ä¹‹åçš„å•é“¾è¡¨ä¸ºï¼š<code>1 -&gt; 4 -&gt; 3 -&gt; 2 -&gt; 5 -&gt; null</code>ã€‚</p><p>æŒ‰ç…§é€’å½’çš„æ€æƒ³ï¼Œæˆ‘ä»¬åœ¨å¤„ç†å¤´èŠ‚ç‚¹<code>head</code>æ—¶ï¼Œå…ˆå‡è®¾åé¢çš„èŠ‚ç‚¹å·²ç»åè½¬å®Œæˆå¹¶è¿”å›äº†åè½¬åçš„æ–°å¤´èŠ‚ç‚¹ï¼Œé‚£ä¹ˆåªéœ€å°†å¤´èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘åè½¬åçš„æ–°å¤´èŠ‚ç‚¹å°±å®Œæˆäº†éœ€æ±‚ã€‚</p><p>å¯¹äºå»é™¤å¤´èŠ‚ç‚¹<code>head</code>ä¹‹åçš„é“¾è¡¨ï¼Œæˆ‘ä»¬éœ€è¦åè½¬çš„æ˜¯ä»<code>m - 1</code>åˆ°<code>n - 1</code>åŒºé—´å†…çš„èŠ‚ç‚¹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">head.next = reverseBetweenMToN(head.next,m - <span class="number">1</span>,n - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">return</span> head;</span><br></pre></td></tr></table></figure><p>é‚£æŒ‰ç…§é€’å½’æ€æƒ³ï¼Œæˆ‘ä»¬ä»€ä¹ˆæ—¶å€™ä¸èƒ½å†â€œéª—è‡ªå·±â€äº†å‘¢ï¼Ÿå½“å‡è®¾åˆ°åŸé“¾è¡¨çš„ç¬¬<code>m</code>ä¸ªèŠ‚ç‚¹æ—¶ï¼Œå¯¹äºè¿™ä¸ªå‡è®¾æ¥è¯´ï¼Œæ˜¯è¿™ä¸ªå‡è®¾çš„ç¬¬<code>1</code>ä¸ªèŠ‚ç‚¹ï¼Œæ­¤æ—¶è¿™ä¸ªå‡è®¾éœ€è¦åè½¬ä»ç¬¬<code>1</code>ä¸ªåˆ°ç¬¬<code>n - m + 1 = n</code>ä¸ªèŠ‚ç‚¹ï¼Œè¿™ä¸æ­£æ˜¯<code>Double Kill</code>ä¸­çš„åè½¬å•é“¾è¡¨çš„å‰<code>N</code>ä¸ªèŠ‚ç‚¹å—ï¼Ÿ</p><p>äºæ˜¯é€’å½’å‡½æ•°å®Œæ•´å®ç°ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title">reverseBetweenMToN</span><span class="params">(ListNode head,<span class="keyword">int</span> m,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> reverseN(head,n);</span><br><span class="line">    &#125;</span><br><span class="line">    head.next = reverseBetweenMToN(head.next,m - <span class="number">1</span>,n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€œä¸‰æ€â€æ‹¿ä¸‹ï¼</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æŒæ¡é€’å½’çš„æ€æƒ³å¾ˆé‡è¦ï¼šå¤„ç†ç¬¬ä¸€ä¸ªæ—¶ï¼Œå…ˆå‡è®¾åé¢çš„å…¨éƒ¨éƒ½å¤„ç†å®Œäº†ï¼Œåªéœ€å¤„ç†ç¬¬ä¸€ä¸ªï¼›ä¸åœåœ°å‡è®¾ï¼Œç›´åˆ°ä¸èƒ½å†å‡è®¾çš„æ—¶å€™ï¼Œå¼€å§‹çœŸæ­£è¿›è¡Œå¤„ç†ï¼›è¿™æ ·å‰é¢æ‰€æœ‰çš„å‡è®¾å°±åƒå¤šç±³åŒéª¨ç‰Œæ•ˆåº”ä¸€æ ·å…¨éƒ½æˆç«‹äº†ï¼Œæœ€ç»ˆï¼Œé—®é¢˜å°±è§£å†³äº†ã€‚</p><p>é€’å½’è™½å¥½ï¼Œä½†å´ä¸å¦‚è¿­ä»£æ³•é«˜æ•ˆï¼Œè™½ç„¶æ—¶é—´å¤æ‚åº¦éƒ½ä¸º<code>O(N)</code>ï¼Œä½†å› ä¸ºé€’å½’éœ€è¦ç”³è¯·é¢å¤–çš„æ ˆç©ºé—´ï¼Œæ‰€ä»¥å…¶ç©ºé—´å¤æ‚åº¦ä¸º<code>O(N)</code>ï¼Œè€Œè¿­ä»£æ³•çš„ç©ºé—´å¤æ‚åº¦ä»…ä¸º<code>O(1)</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹ArrayList</title>
      <link href="2020/06/01/javase/base/arraylist/"/>
      <url>2020/06/01/javase/base/arraylist/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>ArrayList</code>åº•å±‚æ•°æ®ç»“æ„æ˜¯åŠ¨æ€æ•°ç»„ï¼Œä¸æ™®é€šçš„æ•°ç»„ç›¸æ¯”ï¼Œå®ƒçš„å®¹é‡å¯ä»¥åŠ¨æ€å¢é•¿ã€‚åœ¨æ·»åŠ çš„å…ƒç´ æ•°é‡è¾¾åˆ°ä¸€å®šå€¼æ—¶ï¼Œä¼šè§¦å‘è‡ªåŠ¨æ‰©å®¹æœºåˆ¶ï¼Œä¿è¯é›†åˆçš„å¯ç”¨æ€§ã€‚</p><p>å®ƒç»§æ‰¿äº†<code>AbstractList</code>æŠ½è±¡ç±»ï¼Œå¹¶å®ç°äº†<code>List</code>ã€<a href="/2020/04/26/javase/base/randomaccess/"><code>RandomAccess</code></a>ã€<a href="/2020/04/26/javase/base/cloneable/"><code>Cloneable</code></a> å’Œ <a href="/2020/03/21/javase/base/serializable/"><code>java.io.Serializable</code></a>æ¥å£ã€‚</p><blockquote><p><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/tree/master/java-se/src/main/java/com/sunchaser/javase/collect/reimpllist"><code>AbstractList</code>æŠ½è±¡ç±»å·²ç»å®ç°äº†<code>List</code>æ¥å£ï¼Œä¸ºä»€ä¹ˆ<code>ArrayList</code>è¿˜è¦å»å®ç°<code>List</code>æ¥å£ï¼Ÿ</a></p></blockquote><p>ç”±äºåº•å±‚ç”±æ•°ç»„å­˜å‚¨å…ƒç´ ï¼Œå…¶å–æŒ‡å®šä¸‹æ ‡ä½ç½®å…ƒç´ ã€åœ¨é›†åˆå°¾éƒ¨æ’å…¥å…ƒç´ å’Œæ±‚æ•°ç»„é•¿åº¦çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(1)</code>ï¼›è€Œåœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ã€‚</p><h2 id="ä½¿ç”¨åˆ†æ"><a href="#ä½¿ç”¨åˆ†æ" class="headerlink" title="ä½¿ç”¨åˆ†æ"></a><span id="useAnalysis">ä½¿ç”¨åˆ†æ</span></h2><p>åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šç»å¸¸ä½¿ç”¨<code>ArrayList</code>æ¥å­˜å‚¨å¯¹è±¡ï¼Œä¾‹å¦‚å¯¹æ•°æ®åº“æ‰¹é‡æ’å…¥/ä¿®æ”¹çš„å…¥å‚å®ä½“é›†åˆã€æ•°æ®åº“çš„åˆ—è¡¨æŸ¥è¯¢ç»“æœé›†è½¬æ¢æˆå‰ç«¯è§†å›¾æ¨¡å‹å¯¹è±¡ç­‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬çš„ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ— å‚æ„é€ </span></span><br><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="comment">// è¿ç»­æ·»åŠ 10ä¸ªå…ƒç´ </span></span><br><span class="line">list.add(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;d&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;e&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;f&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;g&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;h&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;i&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;j&quot;</span>);</span><br><span class="line"><span class="comment">// æ·»åŠ ç¬¬11ä¸ªå…ƒç´ </span></span><br><span class="line">list.add(<span class="string">&quot;k&quot;</span>);</span><br><span class="line"><span class="comment">// do other</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ä½¿ç”¨ä¼¼ä¹æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†è¿™å´ä¸æ˜¯ä¸€ä¸ªåŒ å¿ƒç¨‹åºå‘˜è¯¥å†™å‡ºæ¥çš„ä»£ç ã€‚</p><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“<code>ArrayList</code>åº•å±‚æ˜¯åŠ¨æ€æ•°ç»„ï¼Œé‚£è¿™ä¸ªæ•°ç»„ä»€ä¹ˆæ—¶å€™è¿›è¡ŒåŠ¨æ€å‘¢ï¼Ÿæ¢å¥è¯è¯´ï¼Œæ•°ç»„ä»€ä¹ˆæ—¶å€™ä¼šè¿›è¡Œæ‰©å®¹ï¼Ÿåˆæ‰©å®¹åˆ°å¤šå°‘å‘¢ï¼Ÿ</p><p>ä»¥ä¸Šä»£ç æ‰§è¡Œå®Œååˆ°åº•æœ‰æ²¡æœ‰è¿›è¡Œæ‰©å®¹ï¼Ÿè¿™äº›éƒ½æ˜¯é—®é¢˜ï¼Œè®©æˆ‘ä»¬å¸¦ç€è¿™äº›é—®é¢˜æ¥çœ‹ä¸‹é¢çš„æºç ã€‚</p><h2 id="æºç è¯¦è§£"><a href="#æºç è¯¦è§£" class="headerlink" title="æºç è¯¦è§£"></a>æºç è¯¦è§£</h2><h3 id="æˆå‘˜å˜é‡"><a href="#æˆå‘˜å˜é‡" class="headerlink" title="æˆå‘˜å˜é‡"></a>æˆå‘˜å˜é‡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åºåˆ—åŒ–ID</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">8683452581122892189L</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é»˜è®¤åˆå§‹å®¹é‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CAPACITY = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºç©ºArrayListå®ä¾‹çš„å…±äº«ç©ºæ•°ç»„å®ä¾‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…±äº«çš„ç©ºæ•°ç»„å®ä¾‹ï¼Œç”¨äºé»˜è®¤å¤§å°çš„ç©ºå®ä¾‹ã€‚</span></span><br><span class="line"><span class="comment"> * å°†è¯¥æˆå‘˜å˜é‡ä¸EMPTY_ELEMENTDATAåŒºåˆ†å¼€æ¥ï¼Œä»¥äº†è§£æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶éœ€è¦å¡«å……å¤šå°‘ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å­˜å‚¨ArrayListçš„å…ƒç´ çš„æ•°ç»„ç¼“å†²åŒºã€‚ArrayListçš„å®¹é‡æ˜¯æ­¤æ•°ç»„ç¼“å†²åŒºçš„é•¿åº¦ã€‚</span></span><br><span class="line"><span class="comment"> * æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œä»»ä½•å…·æœ‰elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATAçš„ç©ºArrayListéƒ½å°†æ‰©å±•ä¸ºDEFAULT_CAPACITYã€‚</span></span><br><span class="line"><span class="comment"> * éç§æœ‰æˆå‘˜ä»¥ç®€åŒ–åµŒå¥—ç±»è®¿é—®ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Object[] elementData;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ArrayListçš„å¤§å°ï¼ˆå®ƒåŒ…å«çš„å…ƒç´ ä¸ªæ•°ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°ã€‚æŸäº›VMåœ¨æ•°ç»„ä¸­ä¿ç•™ä¸€äº›æ ‡å¤´å­—ã€‚</span></span><br><span class="line"><span class="comment"> * å°è¯•åˆ†é…æ›´å¤§çš„æ•°ç»„å¯èƒ½ä¼šå¯¼è‡´OutOfMemoryErrorï¼šè¯·æ±‚çš„æ•°ç»„å¤§å°è¶…å‡ºVMé™åˆ¶ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_ARRAY_SIZE = Integer.MAX_VALUE - <span class="number">8</span>;</span><br></pre></td></tr></table></figure><h3 id="æ„é€ å™¨"><a href="#æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨"></a>æ„é€ å™¨</h3><h4 id="æ— å‚æ„é€ "><a href="#æ— å‚æ„é€ " class="headerlink" title="æ— å‚æ„é€ "></a>æ— å‚æ„é€ </h4><p>æ„é€ ä¸€ä¸ªåˆå§‹å®¹é‡ä¸º<code>10</code>çš„ç©ºåˆ—è¡¨ã€‚å°†<code>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>ç©ºåˆ—è¡¨èµ‹ç»™å­˜å‚¨å…ƒç´ çš„<code>elementData</code>æ•°ç»„ç¼“å†²åŒºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æœ‰å‚æ„é€ "><a href="#æœ‰å‚æ„é€ " class="headerlink" title="æœ‰å‚æ„é€ "></a>æœ‰å‚æ„é€ </h4><p><code>1</code>ã€ æ„é€ ä¸€ä¸ªå…·æœ‰æŒ‡å®šåˆå§‹å®¹é‡çš„ç©ºåˆ—è¡¨ã€‚å…¥å‚<code>initialCapacity</code>ä¸ºåˆ—è¡¨çš„æŒ‡å®šåˆå§‹å®¹é‡ï¼Œå¦‚æœä¸ºè´Ÿæ•°åˆ™æŠ›å‡º<code>IllegalArgumentException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºinitialCapacityå¤§å°çš„Objectç±»æ•°ç»„ã€‚</span></span><br><span class="line">        <span class="keyword">this</span>.elementData = <span class="keyword">new</span> Object[initialCapacity];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (initialCapacity == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå®¹é‡ä¸º0ï¼Œèµ‹å€¼é™æ€ç©ºæ•°ç»„æˆå‘˜å˜é‡ã€‚</span></span><br><span class="line">        <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// è´Ÿæ•°æŠ›å‡ºå¼‚å¸¸ã€‚</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Illegal Capacity: &quot;</span> + initialCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>2</code>ã€ æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆå…ƒç´ çš„åˆ—è¡¨ï¼Œå…¶é¡ºåºç”±é›†åˆçš„è¿­ä»£å™¨è¿”å›ã€‚å…¥å‚<code>c</code>é›†åˆä¸­çš„å…ƒç´ å°†è¢«æ”¾å…¥æ­¤åˆ—è¡¨ï¼Œå¦‚æœé›†åˆä¸º<code>null</code>åˆ™æŠ›å‡º<code>NullPointerException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é›†åˆè½¬æ•°ç»„èµ‹å€¼ç»™elementData</span></span><br><span class="line">    elementData = c.toArray();</span><br><span class="line">    <span class="comment">// é›†åˆå…ƒç´ ä¸ªæ•°ä¸ä¸º0ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> ((size = elementData.length) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// c.toArrayæ–¹æ³•è¿”å›çš„å¯èƒ½ä¸æ˜¯Object[]æ•°ç»„ï¼Œæ­¤å¤„åˆ¤æ–­å¦‚æœä¸ä¸ºObject[]ç±»å‹åˆ™è½¬æ¢æˆObject[]ç±»å‹ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (elementData.getClass() != Object[].class)</span><br><span class="line">            elementData = Arrays.copyOf(elementData, size, Object[].class);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// èµ‹å€¼é™æ€ç©ºæ•°ç»„æˆå‘˜å˜é‡ã€‚</span></span><br><span class="line">        <span class="keyword">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ•°ç»„æ‹·è´æ–¹æ³•"><a href="#æ•°ç»„æ‹·è´æ–¹æ³•" class="headerlink" title="æ•°ç»„æ‹·è´æ–¹æ³•"></a>æ•°ç»„æ‹·è´æ–¹æ³•</h3><p>ç”±äº<code>ArrayList</code>åº•å±‚ä½¿ç”¨æ•°ç»„è¿›è¡Œå…ƒç´ å­˜å‚¨ï¼Œå…¶å¾ˆå¤šå®ç°éƒ½æ˜¯å¯¹æ•°ç»„è¿›è¡Œç›´æ¥æ“ä½œã€‚æ‰€ä»¥åœ¨çœ‹å…¶å®ƒæ–¹æ³•ä¹‹å‰ï¼Œå¾ˆæœ‰å¿…è¦å…ˆå¼„æ‡‚ä¸€äº›æ•°ç»„çš„æ–¹æ³•ã€‚</p><p><code>java.util.Arrays</code>æ˜¯<code>JDK</code>æä¾›çš„ä¸€ä¸ªæ•°ç»„å·¥å…·ç±»ï¼Œåœ¨<code>ArrayList</code>ä¸­å¤§é‡ä½¿ç”¨äº†å®ƒçš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•°ç»„æ‹·è´</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> original å¾…æ‹·è´æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> newLength æ‹·è´åæ–°æ•°ç»„çš„é•¿åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T[] copyOf(T[] original, <span class="keyword">int</span> newLength) &#123;</span><br><span class="line">    <span class="keyword">return</span> (T[]) copyOf(original, newLength, original.getClass());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> original å¾…æ‹·è´æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> newLength æ‹·è´åæ–°æ•°ç»„çš„é•¿åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> newType æ•°ç»„å…ƒç´ ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T,U&gt; T[] copyOf(U[] original, <span class="keyword">int</span> newLength, Class&lt;? extends T[]&gt; newType) &#123;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="comment">// ä¼ å…¥çš„newTypeç±»å‹æ˜¯å¦æ˜¯Objectç±»å‹ï¼Œæ˜¯åˆ™åˆ›å»ºObjectæ•°ç»„ï¼Œå¦åˆ™åˆ›å»ºæŒ‡å®šç±»å‹æ•°ç»„ã€‚</span></span><br><span class="line">    T[] copy = ((Object)newType == (Object)Object[].class)</span><br><span class="line">        ? (T[]) <span class="keyword">new</span> Object[newLength]</span><br><span class="line">        : (T[]) Array.newInstance(newType.getComponentType(), newLength);</span><br><span class="line">    <span class="comment">// nativeæ–¹æ³•</span></span><br><span class="line">    System.arraycopy(original, <span class="number">0</span>, copy, <span class="number">0</span>,</span><br><span class="line">                     Math.min(original.length, newLength));</span><br><span class="line">    <span class="comment">// è¿”å›åˆ›å»ºçš„æ–°é•¿åº¦çš„æ•°ç»„</span></span><br><span class="line">    <span class="keyword">return</span> copy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å°†srcæ•°ç»„ä¸­srcPosç´¢å¼•åŠå…¶ä¹‹åçš„lengthä¸ªå…ƒç´ åˆ†åˆ«æ‹·è´è‡³destæ•°ç»„ä¸­destPosç´¢å¼•åŠå…¶ä¹‹åçš„lengthä¸ªä½ç½®ä¸Šã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> src æºæ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> srcPos æºæ•°ç»„æ‹·è´å¼€å§‹ä½ç½®ç´¢å¼•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dest ç›®æ ‡æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> destPos ç›®æ ‡æ•°ç»„æ‹·è´å¼€å§‹ä½ç½®ç´¢å¼•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> length æ‹·è´çš„é•¿åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">arraycopy</span><span class="params">(Object src,  <span class="keyword">int</span>  srcPos,</span></span></span><br><span class="line"><span class="function"><span class="params">                                    Object dest, <span class="keyword">int</span> destPos,</span></span></span><br><span class="line"><span class="function"><span class="params">                                    <span class="keyword">int</span> length)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="æ’å…¥å…ƒç´ "><a href="#æ’å…¥å…ƒç´ " class="headerlink" title="æ’å…¥å…ƒç´ "></a>æ’å…¥å…ƒç´ </h3><p><code>ArrayList</code>æä¾›äº†ä¸¤ä¸ªé‡è½½çš„<code>add</code>æ’å…¥æ–¹æ³•ã€‚ç¬¬ä¸€ä¸ªæ˜¯å°†æŒ‡å®šå…ƒç´ æ·»åŠ è‡³åˆ—è¡¨æœ«å°¾ï¼›ç¬¬äºŒä¸ªæ˜¯å°†æŒ‡å®šå…ƒç´ æ·»åŠ è‡³æŒ‡å®šä½ç½®ï¼›åŒæ—¶è¿˜æä¾›äº†ä¸¤ä¸ªé‡è½½çš„<code>addAll</code>æ–¹æ³•ï¼Œç”¨æ¥æ‰¹é‡æ’å…¥ã€‚</p><h4 id="æ’å…¥è‡³åˆ—è¡¨æœ«å°¾"><a href="#æ’å…¥è‡³åˆ—è¡¨æœ«å°¾" class="headerlink" title="æ’å…¥è‡³åˆ—è¡¨æœ«å°¾"></a>æ’å…¥è‡³åˆ—è¡¨æœ«å°¾</h4><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    elementData[size++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¯¹<a href="#useAnalysis"><code>ä½¿ç”¨åˆ†æ</code></a>ä¸­çš„ç¤ºä¾‹ä»£ç è¿›è¡Œåˆ†æäº†ï¼š</p><p>é¦–å…ˆä½¿ç”¨<code>new</code>å…³é”®å­—è°ƒç”¨æ— å‚æ„é€ å™¨åˆå§‹åŒ–ä¸€ä¸ª<code>ArrayList</code>é›†åˆå¯¹è±¡ï¼Œæˆ‘ä»¬çŸ¥é“å…¶å®è´¨æ˜¯å°†<code>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>ç©ºåˆ—è¡¨èµ‹ç»™å­˜å‚¨å…ƒç´ çš„<code>elementData</code>æ•°ç»„ç¼“å†²åŒºã€‚åˆ›å»ºå‡ºçš„<code>list</code>å¯¹è±¡çš„<code>size</code>æˆå‘˜å˜é‡åˆå§‹åŒ–ä¸º<code>0</code>ï¼Œç„¶åè°ƒç”¨<code>list</code>å¯¹è±¡çš„<code>add</code>æ–¹æ³•æ·»åŠ å…ƒç´ ã€‚</p><p>ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼š<code>list.add(&quot;a&quot;);</code></p><p>åœ¨<code>add</code>æ–¹æ³•ä¸­é¦–å…ˆè°ƒç”¨<code>ensureCapacityInternal</code>æ–¹æ³•ï¼Œç¡®ä¿å†…éƒ¨å®¹é‡ï¼Œç„¶åå°†ä¼ å…¥çš„å…ƒç´ èµ‹å€¼ç»™<code>elementData</code>æ•°æ®åŸŸæœ«å°¾ã€‚æœ€åè¿”å›<code>true</code>ã€‚</p><p>ç¡®ä¿å†…éƒ¨å®¹é‡<code>ensureCapacityInternal</code>æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡è°ƒç”¨<code>add</code>æ–¹æ³•æ—¶ï¼š<code>elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>ï¼ˆæ„é€ å™¨ä¸­åˆå§‹åŒ–ï¼‰ï¼Œ<code>minCapacity = size + 1</code>ï¼ˆå…¶å€¼ä¸º<code>1</code>ï¼‰ã€‚</p><p>è°ƒç”¨<code>calculateCapacity(elementData, minCapacity)</code>æ–¹æ³•è®¡ç®—å®¹é‡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateCapacity</span><span class="params">(Object[] elementData, <span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// new ArrayList&lt;&gt;() æ—¶ï¼Œåˆå§‹åŒ–ä¸º elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA</span></span><br><span class="line">    <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> minCapacity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶<code>elementData</code>ç­‰äº<code>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>ï¼Œè¿”å›<code>DEFAULT_CAPACITY</code>ï¼ˆå…¶å€¼ä¸º<code>10</code>ï¼‰å’Œ<code>minCapacity</code>ï¼ˆå…¶å€¼ä¸º<code>1</code>ï¼‰ä¸­è¾ƒå¤§çš„å€¼ï¼Œå³è¿”å›<code>10</code>ã€‚</p><p>éšå³è°ƒç”¨äº†<code>ensureExplicitCapacity(10)</code>æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    modCount++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">        grow(minCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå¢åŠ å½“å‰é›†åˆçš„ä¿®æ”¹æ¬¡æ•°ã€‚ç„¶ååˆ¤æ–­è®¡ç®—å‡ºçš„å®¹é‡æ˜¯å¦è¶…å‡ºäº†å½“å‰<code>elementData</code>æ•°ç»„é•¿åº¦ï¼Œå¦‚æœè¶…è¿‡åˆ™è¿›è¡Œ<code>grow</code>æ‰©å®¹ã€‚</p><p>åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨<code>add</code>æ–¹æ³•æ—¶æ˜¾ç„¶è¶…è¿‡äº†ï¼Œè¿›è¡Œæ‰©å®¹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="comment">// æ—§çš„å®¹é‡</span></span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="comment">// æ–°å®¹é‡ä¸ºåŸæ¥çš„1.5å€</span></span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// æ–°å®¹é‡å°äºä¼ å…¥çš„è®¡ç®—å‡ºçš„å®¹é‡ï¼Œåˆ™æ–°å®¹é‡ä¸ºä¼ å…¥å®¹é‡ã€‚</span></span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// æ–°å®¹é‡è¶…è¿‡äº†æœ€å¤§å€¼ï¼Œåˆ™è®¡ç®—æœ€å¤§å®¹é‡</span></span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">    <span class="comment">// æ•°ç»„å†…å®¹æ‹·è´</span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰©å®¹æµç¨‹ä¸ºï¼š</p><ul><li>è·å–æ—§å®¹é‡<code>oldCapacity</code>ï¼›</li><li>è®¡ç®—æ–°å®¹é‡ï¼Œåˆ©ç”¨ä½è¿ç®—ï¼ˆé€Ÿåº¦è¿œè¶…æ•´é™¤è¿ç®—ï¼‰å¾—åˆ°æ—§å®¹é‡çš„ä¸€åŠå†åŠ ä¸Šæ—§å®¹é‡ï¼Œå³æ‰©å®¹<code>1.5</code>å€ï¼›</li><li>æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å°äºä¼ å…¥çš„è®¡ç®—å®¹é‡<code>minCapacity</code>ï¼Œå¦‚æœå°äºï¼Œåˆ™å°†ä¼ å…¥çš„å®¹é‡ä½œä¸ºæ–°å®¹é‡ï¼›</li><li>æ£€æŸ¥å¾—åˆ°çš„æ–°å®¹é‡æ˜¯å¦å¤§äº<code>ArrayList</code>å®šä¹‰çš„æ‰€èƒ½å®¹çº³çš„æœ€å¤§å®¹é‡ï¼š<code>Integer,MAX_VALUE - 8</code>ï¼›</li><li>å¦‚æœå¤§äºï¼Œåˆ™è°ƒç”¨<code>hugeCapacity(minCapacity)</code>è®¡ç®—æœ€å¤§å®¹é‡ï¼šå¦‚æœ<code>minCapacity</code>å¤§äº<code>Integer.MAX_VALUE - 8</code>ï¼Œåˆ™æœ€å¤§å®¹é‡ä¸º<code>Integer.MAX_VALUE</code>ï¼Œå¦åˆ™ä¸º<code>Integer.MAX_VALUE - 8</code>ã€‚</li><li>æœ€åè°ƒç”¨<code>Arrays.copyOf(elementData, newCapacity)</code>è¿›è¡Œæ•°ç»„æ‹·è´ï¼Œå¾—åˆ°ä¸€ä¸ªä»¥æ–°å®¹é‡ä¸ºé•¿åº¦çš„æ•°ç»„å¯¹è±¡å¹¶èµ‹å€¼ç»™<code>elementData</code>ã€‚</li></ul><p>ç¬¬ä¸€æ¬¡è°ƒç”¨<code>add</code>æ–¹æ³•æ—¶ï¼Œæ—§å®¹é‡<code>oldCapacity = 0</code>ï¼Œé€šè¿‡ä½è¿ç®—è®¡ç®—å‡ºçš„æ–°å®¹é‡ä¹Ÿä¸º<code>0</code>ï¼Œæ‰€ä»¥æœ€åæ–°å®¹é‡<code>newCapacity = minCapacity</code>ï¼Œç­‰äº<code>10</code>ã€‚</p><blockquote><p>æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨<code>new</code>å…³é”®å­—è°ƒç”¨æ— å‚æ„é€ å™¨åˆ›å»º<code>ArrayList</code>å¯¹è±¡æ—¶ï¼Œå®é™…ä¸Šåªåˆå§‹åŒ–äº†ä¸€ä¸ªç©ºæ•°ç»„ï¼Œåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨<code>add</code>æ–¹æ³•æ—¶æ‰ä¼šè¿›è¡Œç©ºæ•°ç»„çš„æ‰©å®¹ã€‚</p></blockquote><p>æ‰©å®¹å®Œæˆåï¼Œ<code>elementData</code>æ•°ç»„å®¹é‡å……è¶³ï¼Œå¯ä»¥å¾€å…¶æœ«å°¾æ·»åŠ å…ƒç´ ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elementData[size++] = e;</span><br></pre></td></tr></table></figure><p>åƒ<a href="#useAnalysis"><code>ä½¿ç”¨åˆ†æ</code></a>ä¸­çš„ç¤ºä¾‹ä»£ç ä¸€æ ·ï¼Œæˆ‘ä»¬ä¸æ–­åœ°å‘å…¶ä¸­æ·»åŠ å…ƒç´ ï¼Œå½“æ·»åŠ çš„å…ƒç´ ä¸ªæ•°ä¸è¶…è¿‡<code>10</code>æ—¶ï¼Œ<code>ensureExplicitCapacity(int minCapacity)</code>æ–¹æ³•åˆ¤æ–­<code>minCapacity - elementData.length</code>å§‹ç»ˆå°äº<code>0</code>ï¼ˆç»è¿‡ç¬¬ä¸€æ¬¡æ‰©å®¹å<code>elementData.length</code>çš„å€¼ä¸º<code>10</code>ï¼‰ï¼Œä¸ä¼šè¿›è¡Œ<code>grow</code>æ‰©å®¹; è€Œå½“æ·»åŠ è‡³ç¬¬<code>11</code>ä¸ªå…ƒç´ <code>k</code>æ—¶ï¼Œæƒ…å†µå‘ç”Ÿå˜åŒ–ï¼š</p><ul><li><code>calculateCapacity(elementData, minCapacity)</code>æ–¹æ³•ç›´æ¥è¿”å›<code>minCapacity = 11</code>ï¼›</li><li>ç„¶åè°ƒç”¨<code>ensureExplicitCapacity(int minCapacity)</code>æ–¹æ³•ï¼Œæ­¤æ—¶<code>elementData</code>æ•°ç»„é•¿åº¦ä¸º<code>10</code>ï¼Œ<code>minCapacity - elementData.length</code>å¤§äº<code>0</code>ï¼Œå°†å†æ¬¡è¿›è¡Œ<code>grow</code>æ‰©å®¹ã€‚</li></ul><p>è€Œæ‰©å®¹çš„æµç¨‹æˆ‘ä»¬çŸ¥é“ï¼Œä¼šè°ƒç”¨<code>Arrays.copyOf(elementData, newCapacity)</code>æ–¹æ³•è¿›è¡Œæ•°ç»„æ‹·è´ï¼Œä¼šæœ‰æ€§èƒ½æŸè€—ã€‚</p><p>æ‰€ä»¥ï¼Œå…·æœ‰åŒ å¿ƒçš„ä»£ç åº”è¯¥åƒä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ </span></span><br><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="number">11</span>);</span><br><span class="line"><span class="comment">// è¿ç»­æ·»åŠ 10ä¸ªå…ƒç´ </span></span><br><span class="line">list.add(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;d&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;e&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;f&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;g&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;h&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;i&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;j&quot;</span>);</span><br><span class="line"><span class="comment">// æ·»åŠ ç¬¬11ä¸ªå…ƒç´ </span></span><br><span class="line">list.add(<span class="string">&quot;k&quot;</span>);</span><br><span class="line"><span class="comment">// do other</span></span><br></pre></td></tr></table></figure><p>è°ƒç”¨æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å™¨ï¼Œåœ¨åˆ›å»º<code>list</code>å¯¹è±¡æ—¶å°±ä¼šå¯¹<code>elementData</code>æ•°ç»„è¿›è¡Œåˆå§‹åŒ–ï¼Œè€Œä¸æ˜¯åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨<code>add</code>æ–¹æ³•æ—¶ã€‚</p><p>æ‰€ä»¥å¦‚æœèƒ½æå‰é¢„ä¼°åˆ°é›†åˆå®¹é‡ï¼Œå°½é‡æå‰æŒ‡å®šå®¹é‡ï¼Œé¿å…é¢‘ç¹çš„æ‰©å®¹å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚</p><blockquote><p>æ ¹æ®ä½¿ç”¨åœºæ™¯ï¼Œå¦‚æœé›†åˆçš„æ•°æ®é‡ä¸å¥½é¢„ä¼°ï¼Œä¸”åªä¼šå¯¹å…¶è¿›è¡Œå¢åˆ æ“ä½œï¼Œåˆ™ä¸å»ºè®®ä½¿ç”¨<code>ArrayList</code>é›†åˆï¼Œè€Œæ˜¯å»ºè®®ä½¿ç”¨<code>LinkedList</code>é›†åˆã€‚</p></blockquote><h4 id="æ’å…¥è‡³æŒ‡å®šä½ç½®"><a href="#æ’å…¥è‡³æŒ‡å®šä½ç½®" class="headerlink" title="æ’å…¥è‡³æŒ‡å®šä½ç½®"></a>æ’å…¥è‡³æŒ‡å®šä½ç½®</h4><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> index å¾…æ’å…¥å…ƒç´ çš„æŒ‡å®šçš„ä½ç½®çš„ç´¢å¼•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> element å¾…æ’å…¥çš„å…ƒç´ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line">    <span class="comment">// ç¡®ä¿å®¹é‡ï¼Œä¿®æ”¹modCountå€¼</span></span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    <span class="comment">// æ•°ç»„æ‹·è´ï¼šå°†[index,size)ç´¢å¼•åŒºé—´çš„å…ƒç´ æ•´ä½“å‘åç§»åŠ¨ä¸€ä¸ªå•ä½ï¼Œå°†é›†åˆçš„`index`ä½ç½®ç•™ç©ºã€‚</span></span><br><span class="line">    System.arraycopy(elementData, index, elementData, index + <span class="number">1</span>,</span><br><span class="line">                     size - index);</span><br><span class="line">    <span class="comment">// ç»™indexç´¢å¼•ä½ç½®èµ‹å€¼ä¸ºå¾…æ’å…¥å…ƒç´ </span></span><br><span class="line">    elementData[index] = element;</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å¢åŠ </span></span><br><span class="line">    size++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥è‡³å½“å‰é›†åˆæœ«å°¾"><a href="#å°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥è‡³å½“å‰é›†åˆæœ«å°¾" class="headerlink" title="å°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥è‡³å½“å‰é›†åˆæœ«å°¾"></a>å°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥è‡³å½“å‰é›†åˆæœ«å°¾</h4><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é›†åˆè½¬æ•°ç»„</span></span><br><span class="line">    Object[] a = c.toArray();</span><br><span class="line">    <span class="comment">// å¾…æ·»åŠ å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">    <span class="comment">// ç¡®ä¿å®¹é‡</span></span><br><span class="line">    ensureCapacityInternal(size + numNew);  <span class="comment">// Increments modCount</span></span><br><span class="line">    <span class="comment">// æ•°ç»„æ‹·è´</span></span><br><span class="line">    System.arraycopy(a, <span class="number">0</span>, elementData, size, numNew);</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å¢åŠ </span></span><br><span class="line">    size += numNew;</span><br><span class="line">    <span class="comment">// ä¼ å…¥é›†åˆæ— å…ƒç´ åˆ™è¿”å›falseï¼Œå¦åˆ™è¿”å›trueã€‚</span></span><br><span class="line">    <span class="keyword">return</span> numNew != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå°†ä¼ å…¥çš„é›†åˆ<code>c</code>è½¬ä¸º<code>Object[]</code>å¯¹è±¡æ•°ç»„ï¼Œè°ƒç”¨<code>Collection</code>çš„<code>toArray()</code>æ–¹æ³•ï¼Œä¸ç®¡æ˜¯å“ªç§é›†åˆçš„å®ç°ï¼Œæœ€ç»ˆéƒ½ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ã€‚ä»¥ä¸‹æ˜¯<code>ArrayList</code>ç±»çš„å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object[] toArray() &#123;</span><br><span class="line">    <span class="keyword">return</span> Arrays.copyOf(elementData, size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨å·¥å…·ç±»çš„æ–¹æ³•<code>Arrays.copyOf</code>æ–¹æ³•è¿›è¡Œæ•°ç»„æ‹·è´ï¼Œè¿”å›ä¸€ä¸ª<code>Object[]</code>æ•°ç»„ã€‚</p><h4 id="ä»å½“å‰é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹ï¼Œå°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥"><a href="#ä»å½“å‰é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹ï¼Œå°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥" class="headerlink" title="ä»å½“å‰é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹ï¼Œå°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥"></a>ä»å½“å‰é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹ï¼Œå°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥</h4><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> index æŒ‡å®šç´¢å¼•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> c å¾…æ’å…¥é›†åˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line">    <span class="comment">// é›†åˆè½¬Objectæ•°ç»„</span></span><br><span class="line">    Object[] a = c.toArray();</span><br><span class="line">    <span class="comment">// å¾…æ’å…¥é›†åˆå…ƒç´ ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">    <span class="comment">// ç¡®ä¿å®¹é‡</span></span><br><span class="line">    ensureCapacityInternal(size + numNew);  <span class="comment">// Increments modCount</span></span><br><span class="line">    <span class="comment">// éœ€è¦ç§»åŠ¨çš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">int</span> numMoved = size - index;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// ä¸æ˜¯ä»æœ«å°¾æ·»åŠ ï¼Œåˆ™å°†[index,size)ç´¢å¼•ä¸Šçš„å…ƒç´ æ•´ä½“å‘åç§»åŠ¨numMovedä¸ªå•ä½ã€‚</span></span><br><span class="line">        System.arraycopy(elementData, index, elementData, index + numNew,</span><br><span class="line">                         numMoved);</span><br><span class="line">    <span class="comment">// Objectæ•°ç»„æ‹·è´è‡³elementData</span></span><br><span class="line">    System.arraycopy(a, <span class="number">0</span>, elementData, index, numNew);</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å¢åŠ </span></span><br><span class="line">    size += numNew;</span><br><span class="line">    <span class="comment">// ä¼ å…¥é›†åˆæ— å…ƒç´ åˆ™è¿”å›falseï¼Œå¦åˆ™è¿”å›trueã€‚</span></span><br><span class="line">    <span class="keyword">return</span> numNew != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤å…ƒç´ "><a href="#åˆ é™¤å…ƒç´ " class="headerlink" title="åˆ é™¤å…ƒç´ "></a>åˆ é™¤å…ƒç´ </h3><p>åˆ é™¤é›†åˆä¸­çš„å…ƒç´ æœ‰å¤šç§æƒ…å†µï¼šåˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´ /åˆ é™¤æŒ‡å®šå…ƒç´ /åˆ é™¤æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ /åˆ é™¤å…¨éƒ¨å…ƒç´ /æŒ‡å®šæ¡ä»¶åˆ é™¤ï¼ˆ<code>Java8</code>æ–°å¢ï¼‰ç­‰ã€‚</p><h4 id="åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´ "><a href="#åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´ " class="headerlink" title="åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´ "></a>åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´ </h4><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> index æŒ‡å®šç´¢å¼•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    rangeCheck(index);</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// è·å–æ—§çš„indexç´¢å¼•ä½ç½®å…ƒç´ å€¼</span></span><br><span class="line">    E oldValue = elementData(index);</span><br><span class="line">    <span class="comment">// è®¡ç®—éœ€è¦ç§»åŠ¨çš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// ç§»åŠ¨å…ƒç´ ï¼š[index+1,size)ç´¢å¼•åŒºé—´çš„å…ƒç´ æ•´ä½“å‘å‰ç§»åŠ¨ä¸€ä¸ªå•ä½ã€‚</span></span><br><span class="line">        System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,</span><br><span class="line">                         numMoved);</span><br><span class="line">    <span class="comment">// æ¸…é™¤æœ«å°¾ç´¢å¼•åŸæœ‰çš„å¼•ç”¨ï¼Œå‡å°é›†åˆå¤§å°</span></span><br><span class="line">    elementData[--size] = <span class="keyword">null</span>; <span class="comment">// clear to let GC do its work</span></span><br><span class="line">    <span class="comment">// è¿”å›è¢«åˆ é™¤çš„å…ƒç´ å€¼</span></span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸ºä»€ä¹ˆåˆ¤æ–­<code>size - index - 1 &gt; 0</code>ï¼Ÿ</p><p>ç­”ï¼šé›†åˆå¤§å°<code>size</code>æ˜¯ä»<code>1</code>å¼€å§‹è®¡ç®—ï¼Œè€Œæ•°ç»„ä¸‹æ ‡ç´¢å¼•<code>index</code>æ˜¯ä»<code>0</code>å¼€å§‹è®¡ç®—ã€‚</p></blockquote><h4 id="åˆ é™¤æŒ‡å®šå…ƒç´ "><a href="#åˆ é™¤æŒ‡å®šå…ƒç´ " class="headerlink" title="åˆ é™¤æŒ‡å®šå…ƒç´ "></a>åˆ é™¤æŒ‡å®šå…ƒç´ </h4><p>ç”±äº<code>ArrayList</code>é›†åˆä¸­çš„å…ƒç´ å¯ä»¥é‡å¤ï¼ŒæŒ‡å®šçš„å…ƒç´ å¯èƒ½åœ¨é›†åˆä¸­å‡ºç°å¤šæ¬¡ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•åˆ é™¤çš„æ˜¯æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®çš„å…ƒç´ ã€‚</p><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> o æŒ‡å®šå…ƒç´ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ ä¸ºnullï¼š==è¿ç®—ç¬¦æ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">            <span class="keyword">if</span> (elementData[index] == <span class="keyword">null</span>) &#123;</span><br><span class="line">                fastRemove(index);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// énullï¼šequalsæ–¹æ³•æ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">            <span class="keyword">if</span> (o.equals(elementData[index])) &#123;</span><br><span class="line">                fastRemove(index);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>fori</code>å¾ªç¯æ˜¯ä»ç´¢å¼•ä¸º<code>0</code>å¼€å§‹éå†ï¼Œæ‰€ä»¥åˆ é™¤çš„æ˜¯å…·æœ‰æœ€ä½ç´¢å¼•çš„å…ƒç´ ã€‚</p></blockquote><p>æˆ‘ä»¬æ¥çœ‹ä¸‹<code>fastRemove(index);</code>çš„å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> index æŒ‡å®šç´¢å¼•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fastRemove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// è®¡ç®—éœ€è¦ç§»åŠ¨çš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// ç§»åŠ¨å…ƒç´ ï¼š[index+1,size)ç´¢å¼•åŒºé—´å…ƒç´ æ•´ä½“å‘å‰ç§»åŠ¨ä¸€ä½ã€‚</span></span><br><span class="line">        System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,</span><br><span class="line">                         numMoved);</span><br><span class="line">    <span class="comment">// æ¸…é™¤æœ«å°¾ç´¢å¼•åŸæœ‰çš„å¼•ç”¨ï¼Œå‡å°é›†åˆå¤§å°</span></span><br><span class="line">    elementData[--size] = <span class="keyword">null</span>; <span class="comment">// clear to let GC do its work</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ "><a href="#åˆ é™¤æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ " class="headerlink" title="åˆ é™¤æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ "></a>åˆ é™¤æŒ‡å®šç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ </h4><p>è¯¥æ–¹æ³•ä¸º<code>ArrayList</code>ç±»ä¸­å—ä¿æŠ¤çš„æ–¹æ³•ï¼Œå¤–éƒ¨æ— æ³•ç›´æ¥è¿›è¡Œè°ƒç”¨ã€‚ç”±<code>JDK</code>é›†åˆæ¡†æ¶å†…éƒ¨è¿›è¡Œä½¿ç”¨ã€‚</p><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çº¦å®š fromIndex å°äº toIndexï¼Œå¦åˆ™ï¼Œè¿›è¡Œå…ƒç´ ç§»åŠ¨æ—¶ä¼šå‡ºç°ç´¢å¼•è¶Šç•Œã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fromIndex å¼€å§‹ç´¢å¼•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> toIndex ç»“æŸç´¢å¼•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">removeRange</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// è®¡ç®—éœ€è¦ç§»åŠ¨çš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">int</span> numMoved = size - toIndex;</span><br><span class="line">    <span class="comment">// ç§»åŠ¨å…ƒç´ ï¼š[toIndex,size)ç´¢å¼•åŒºé—´å…ƒç´ æ•´ä½“å‘å‰ç§»åŠ¨toIndex - fromIndexä¸ªå•ä½ã€‚</span></span><br><span class="line">    System.arraycopy(elementData, toIndex, elementData, fromIndex,</span><br><span class="line">                     numMoved);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// clear to let GC do its work</span></span><br><span class="line">    <span class="comment">// è®¡ç®—æ–°çš„æ•°ç»„å¤§å°</span></span><br><span class="line">    <span class="keyword">int</span> newSize = size - (toIndex-fromIndex);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = newSize; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="comment">// æ¸…é™¤åˆ é™¤çš„ç´¢å¼•ä½ç½®åŸæœ‰çš„å¼•ç”¨</span></span><br><span class="line">        elementData[i] = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŒ‡å®šæ–°çš„æ•°ç»„å¤§å°</span></span><br><span class="line">    size = newSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤å…¨éƒ¨å…ƒç´ "><a href="#åˆ é™¤å…¨éƒ¨å…ƒç´ " class="headerlink" title="åˆ é™¤å…¨éƒ¨å…ƒç´ "></a>åˆ é™¤å…¨éƒ¨å…ƒç´ </h4><p>æœ‰ä¸¤ç§æƒ…å†µï¼šä¸€ç§æ˜¯åˆ é™¤å½“å‰é›†åˆå…¨éƒ¨å…ƒç´ ï¼Œæ–¹æ³•ä¸º<code>clear()</code>ï¼›å¦ä¸€ç§æ˜¯ä»å½“å‰é›†åˆä¸­åˆ é™¤æŒ‡å®šé›†åˆä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ ï¼Œæ–¹æ³•ä¸º<code>removeAll(Collection&lt;?&gt; c)</code>ã€‚</p><p><code>clear()</code>æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// clear to let GC do its work</span></span><br><span class="line">    <span class="comment">// æ¸…é™¤æ‰€æœ‰ç´¢å¼•ä½ç½®çš„å¼•ç”¨å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">        elementData[i] = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°ç½®0</span></span><br><span class="line">    size = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>removeAll(Collection&lt;?&gt; c)</code>æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// éç©º</span></span><br><span class="line">    Objects.requireNonNull(c);</span><br><span class="line">    <span class="keyword">return</span> batchRemove(c, <span class="keyword">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œè°ƒç”¨<code>Java8</code>æä¾›çš„<code>Objects.requireNonNull(c);</code>æ–¹æ³•å¯¹ä¼ å…¥çš„é›†åˆ<code>c</code>è¿›è¡Œéç©ºæ ¡éªŒã€‚</p><p>ç„¶åï¼Œè°ƒç”¨ç§æœ‰æ–¹æ³•<code>batchRemove(c, false)</code>ï¼Œä¼ å…¥é›†åˆ<code>c</code>å’Œå¸ƒå°”å€¼<code>false</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">batchRemove</span><span class="params">(Collection&lt;?&gt; c, <span class="keyword">boolean</span> complement)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Object[] elementData = <span class="keyword">this</span>.elementData;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">0</span>, w = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">boolean</span> modified = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (; r &lt; size; r++)</span><br><span class="line">            <span class="keyword">if</span> (c.contains(elementData[r]) == complement)</span><br><span class="line">                elementData[w++] = elementData[r];</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">// Preserve behavioral compatibility with AbstractCollection,</span></span><br><span class="line">        <span class="comment">// even if c.contains() throws.</span></span><br><span class="line">        <span class="keyword">if</span> (r != size) &#123;</span><br><span class="line">            System.arraycopy(elementData, r,</span><br><span class="line">                             elementData, w,</span><br><span class="line">                             size - r);</span><br><span class="line">            w += size - r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (w != size) &#123;</span><br><span class="line">            <span class="comment">// clear to let GC do its work</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = w; i &lt; size; i++)</span><br><span class="line">                elementData[i] = <span class="keyword">null</span>;</span><br><span class="line">            modCount += size - w;</span><br><span class="line">            size = w;</span><br><span class="line">            modified = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> modified;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥å†™ä¸€ä¸ªç®€å•çš„<code>demo</code>æ¥çœ‹ä¸‹å…¶è¿‡ç¨‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"></span><br><span class="line">    List&lt;Integer&gt; removeList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    removeList.add(<span class="number">1</span>);</span><br><span class="line">    removeList.add(<span class="number">2</span>);</span><br><span class="line">    removeList.add(<span class="number">3</span>);</span><br><span class="line">    removeList.add(<span class="number">4</span>);</span><br><span class="line">    removeList.add(<span class="number">5</span>);</span><br><span class="line">    removeList.add(<span class="number">6</span>);</span><br><span class="line">    List&lt;Integer&gt; beRemovedList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    beRemovedList.add(<span class="number">3</span>);</span><br><span class="line">    beRemovedList.add(<span class="number">4</span>);</span><br><span class="line">    beRemovedList.add(<span class="number">6</span>);</span><br><span class="line">    System.out.println(removeList);</span><br><span class="line">    System.out.println(beRemovedList);</span><br><span class="line">    removeList.removeAll(beRemovedList);</span><br><span class="line">    System.out.println(removeList);</span><br><span class="line"></span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ª<code>removeList</code>é›†åˆå¹¶åˆå§‹åŒ–å…­ä¸ªå…ƒç´ ï¼Œå†åˆ›å»ºä¸€ä¸ªå¾…åˆ é™¤çš„<code>beRemovedList</code>é›†åˆå¹¶åˆå§‹åŒ–ä¸‰ä¸ªå…ƒç´ ï¼ˆåœ¨<code>removeList</code>ä¸­ï¼‰ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æ<code>removeAll</code>æ–¹æ³•çš„å…·ä½“æ‰§è¡Œæµç¨‹ï¼š</p><p>å½“æˆ‘ä»¬è°ƒç”¨<code>removeList.removeAll(beRemovedList);</code>æ—¶ï¼Œä¼šå…ˆå¯¹<code>beRemovedList</code>è¿›è¡Œéç©ºæ ¡éªŒï¼Œç„¶åè°ƒç”¨<code>batchRemove</code>æ–¹æ³•ï¼š</p><p>1ã€ä½¿ç”¨å±€éƒ¨æœ€ç»ˆå˜é‡<code>elementData</code>æŒ‡å‘å½“å‰é›†åˆï¼ˆ<code>removeList</code>ï¼‰çš„å¼•ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Object[] elementData = <span class="keyword">this</span>.elementData;</span><br></pre></td></tr></table></figure><p>2ã€å®šä¹‰ä¸¤ä¸ªç´¢å¼•å¹¶åˆå§‹åŒ–ä¸º<code>0</code>ï¼Œä»¥åŠå®šä¹‰ä¸€ä¸ªå¸ƒå°”å€¼ç”¨æ¥è®°å½•å½“å‰é›†åˆæ˜¯å¦è¢«ä¿®æ”¹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> r = <span class="number">0</span>, w = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">boolean</span> modified = <span class="keyword">false</span>;</span><br></pre></td></tr></table></figure><p>3ã€ä»<code>r</code>åˆ°<code>size</code>è¿›è¡Œéå†ï¼Œåˆ¤æ–­ä¼ å…¥çš„é›†åˆ<code>c</code>æ˜¯å¦åŒ…å«<code>r</code>ä½ç½®çš„å…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (; r &lt; size; r++)</span><br><span class="line">    <span class="keyword">if</span> (c.contains(elementData[r]) == complement)</span><br><span class="line">        elementData[w++] = elementData[r];</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯¹ç€æˆ‘ä»¬çš„<code>demo</code>ç¨‹åºè¿›è¡Œåˆ†æï¼Œ<code>c = &#123;3, 4, 6&#125;</code>ï¼Œ<code>elementData = &#123;1, 2, 3, 4, 5, 6&#125;</code>ï¼Œ<code>size=6</code>ï¼Œ<code>complement = false</code>ã€‚</p><p>æ¯æ¬¡å¾ªç¯<code>r</code>çš„å€¼å¢ä¸€ï¼Œå¾ªç¯ç»“æŸçš„æ¡ä»¶ä¸º<code>r &lt; size</code>ä¸æˆç«‹ï¼Œå³å½“<code>r = size</code>æ—¶å¾ªç¯ç»“æŸã€‚</p><ul><li>ç¬¬ä¸€æ¬¡å¾ªç¯ï¼š<code>r = 0</code>ï¼Œ<code>elementData[r] = 1</code>ï¼Œ<code>c.contains(1) = false</code>ã€‚<code>if</code>æ¡ä»¶æˆç«‹ï¼Œ<code>w = 0</code>ã€‚å°†<code>elementData[r]</code>èµ‹å€¼ç»™<code>elementData[w++]</code>ï¼šå³å°†å½“å‰ä¸åœ¨<code>c</code>é›†åˆä¸­çš„å…ƒç´ èµ‹å€¼åˆ°é›†åˆçš„ç¬¬<code>0</code>ä½ç½®ï¼Œéšå<code>w</code>å¢ä¸€ã€‚æ­¤æ—¶<code>elementData</code>çš„ç¬¬<code>0</code>ä½ç½®å…ƒç´ ä¸ºï¼š<code>1</code>ã€‚</li><li>ç¬¬äºŒæ¬¡å¾ªç¯ï¼š<code>r = 1</code>ï¼Œ<code>elementData[r] = 2</code>ï¼Œ<code>c.contains(2) = false</code>ã€‚<code>if</code>æ¡ä»¶æˆç«‹ï¼Œ<code>w = 1</code>ã€‚å°†<code>elementData[r]</code>èµ‹å€¼ç»™<code>elementData[w++]</code>ï¼šå³å°†å½“å‰ä¸åœ¨<code>c</code>é›†åˆä¸­çš„å…ƒç´ èµ‹å€¼åˆ°é›†åˆçš„ç¬¬<code>1</code>ä½ç½®ï¼Œéšå<code>w</code>å¢ä¸€ã€‚æ­¤æ—¶<code>elementData</code>çš„ç¬¬<code>1</code>ä½ç½®å…ƒç´ ä¸ºï¼š<code>2</code>ã€‚</li><li>ç¬¬ä¸‰æ¬¡å¾ªç¯ï¼š<code>r = 2</code>ï¼Œ<code>elementData[r] = 3</code>ï¼Œ<code>c.contains(3) = true</code>ã€‚<code>if</code>æ¡ä»¶ä¸æˆç«‹ï¼Œ<code>w</code>çš„å€¼ä¸º<code>2</code>ï¼Œä¸åšä»»ä½•æ“ä½œã€‚</li><li>ç¬¬å››æ¬¡å¾ªç¯ï¼š<code>r = 3</code>ï¼Œ<code>elementData[r] = 4</code>ï¼Œ<code>c.contains(4) = true</code>ã€‚<code>if</code>æ¡ä»¶ä¸æˆç«‹ï¼Œ<code>w</code>çš„å€¼ä¸º<code>2</code>ï¼Œä¸åšä»»ä½•æ“ä½œã€‚</li><li>ç¬¬äº”æ¬¡å¾ªç¯ï¼š<code>r = 4</code>ï¼Œ<code>elementData[r] = 5</code>ï¼Œ<code>c.contains(5) = false</code>ã€‚<code>if</code>æ¡ä»¶æˆç«‹ï¼Œ<code>w = 2</code>ï¼Œå°†<code>elementData[r]</code>èµ‹å€¼ç»™<code>elementData[w++]</code>ï¼šå³å°†å½“å‰ä¸åœ¨<code>c</code>é›†åˆä¸­çš„å…ƒç´ èµ‹å€¼åˆ°é›†åˆçš„ç¬¬<code>2</code>ä½ç½®ï¼Œéšå<code>w</code>å¢ä¸€ã€‚æ­¤æ—¶<code>elementData</code>çš„ç¬¬<code>2</code>ä½ç½®å…ƒç´ ä¸ºï¼š<code>5</code>ã€‚</li><li>ç¬¬å…­æ¬¡å¾ªç¯ï¼š<code>r = 5</code>ï¼Œ<code>elementData[r] = 6</code>ï¼Œ<code>c.contains(6) = true</code>ã€‚<code>if</code>æ¡ä»¶ä¸æˆç«‹ï¼Œ<code>w</code>çš„å€¼ä¸º<code>3</code>ï¼Œä¸åšä»»ä½•æ“ä½œã€‚</li></ul><p>å¾ªç¯ç»“æŸï¼Œ<code>w = 3</code>ï¼Œ<code>elementData = &#123;1, 2, 5, ......&#125;</code>ï¼Œ<code>r = 6</code>ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹<code>finally</code>å—ä¸­çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Preserve behavioral compatibility with AbstractCollection,</span></span><br><span class="line"><span class="comment">// even if c.contains() throws.</span></span><br><span class="line"><span class="keyword">if</span> (r != size) &#123;</span><br><span class="line">    System.arraycopy(elementData, r,elementData, w,size - r);</span><br><span class="line">    w += size - r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (w != size) &#123;</span><br><span class="line">    <span class="comment">// clear to let GC do its work</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = w; i &lt; size; i++)</span><br><span class="line">        elementData[i] = <span class="keyword">null</span>;</span><br><span class="line">    modCount += size - w;</span><br><span class="line">    size = w;</span><br><span class="line">    modified = <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºæˆ‘ä»¬çš„<code>demo</code>ç¨‹åºï¼š</p><p>æ­¤æ—¶<code>r = size</code>ï¼Œç¬¬ä¸€ä¸ª<code>if</code>å—ä¸è¿›å…¥ã€‚</p><p>æ­¤æ—¶<code>(w = 3) != (size = 6)</code>ï¼Œè¿›å…¥ç¬¬äºŒä¸ª<code>if</code>å—ï¼Œå°†ç´¢å¼•ä»<code>w</code>åˆ°<code>size - 1</code>ä½ç½®çš„å…ƒç´ ç½®ä¸º<code>null</code>ï¼Œé‡Šæ”¾å¯¹åŸæ¥å…ƒç´ çš„å¼•ç”¨ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯ä¸€äº›æ”¶å°¾å·¥ä½œï¼š</p><ul><li>è®°å½•ä¿®æ”¹æ¬¡æ•°ï¼Œä¿®æ”¹ï¼ˆç§»é™¤ï¼‰äº†<code>size - w</code>ä¸ªå…ƒç´ ï¼›</li><li>å°†é›†åˆå¤§å°è®¾ä¸º<code>w</code>ï¼šä¸ºåœ¨<code>for</code>å¾ªç¯ä¸­ç»™<code>elementData</code>åŸŸèµ‹å€¼çš„å…ƒç´ ä¸ªæ•°ã€‚</li><li>è®¾ç½®ä¿®æ”¹æ ‡è®°ä¸º<code>true</code>ï¼Œæ­¤å¤„æ˜¯<code>c</code>é›†åˆä¸­çš„å…ƒç´ å…¨éƒ¨ä»é›†åˆä¸­åˆ é™¤ã€‚</li></ul><p>æœ€åï¼Œ<code>batchRemove</code>æ–¹æ³•è¿”å›<code>modified</code>å¸ƒå°”å€¼ï¼šè¡¨ç¤ºæ˜¯å¦å½“å‰é›†åˆä¸­åˆ é™¤äº†æŒ‡å®šé›†åˆ<code>c</code>ä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ ã€‚</p><h3 id="ä¿®æ”¹å…ƒç´ "><a href="#ä¿®æ”¹å…ƒç´ " class="headerlink" title="ä¿®æ”¹å…ƒç´ "></a>ä¿®æ”¹å…ƒç´ </h3><p>ä¿®æ”¹æ–¹æ³•åªæœ‰ä¸€ä¸ªï¼šä¿®æ”¹æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ä¸ºæ–°çš„å…ƒç´ ã€‚</p><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> index æŒ‡å®šç´¢å¼•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> element æŒ‡å®šçš„æ–°å…ƒç´ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    rangeCheck(index);</span><br><span class="line">    <span class="comment">// è·å–indexç´¢å¼•ä½ç½®çš„æ—§å…ƒç´ </span></span><br><span class="line">    E oldValue = elementData(index);</span><br><span class="line">    <span class="comment">// èµ‹å€¼ä¸ºæ–°çš„æŒ‡å®šå…ƒç´ </span></span><br><span class="line">    elementData[index] = element;</span><br><span class="line">    <span class="comment">// è¿”å›æ—§å…ƒç´ </span></span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢å…ƒç´ "><a href="#æŸ¥è¯¢å…ƒç´ " class="headerlink" title="æŸ¥è¯¢å…ƒç´ "></a>æŸ¥è¯¢å…ƒç´ </h3><p>ç”±äº<code>ArrayList</code>åº•å±‚ç”±<code>elementData</code>æ•°ç»„å­˜å‚¨å…ƒç´ ï¼Œæ‰€ä»¥æ”¯æŒæŒ‰æ•°ç»„ä¸‹æ ‡è®¿é—®ï¼šå³éšæœºå¿«é€Ÿè®¿é—®ã€‚å…¶æŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(1)</code>ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ<code>ArrayList</code>å®ç°<code>RandomAccess</code>çš„åŸå› ï¼šæ ‡è®°è¯¥ç±»æ”¯æŒéšæœºå¿«é€Ÿè®¿é—®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    rangeCheck(index);</span><br><span class="line">    <span class="comment">// æŒ‰æ•°ç»„ä¸‹æ ‡å–å€¼</span></span><br><span class="line">    <span class="keyword">return</span> elementData(index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">E <span class="title">elementData</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (E) elementData[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¶å®ƒæ–¹æ³•"><a href="#å…¶å®ƒæ–¹æ³•" class="headerlink" title="å…¶å®ƒæ–¹æ³•"></a>å…¶å®ƒæ–¹æ³•</h3><h4 id="cloneæ–¹æ³•"><a href="#cloneæ–¹æ³•" class="headerlink" title="cloneæ–¹æ³•"></a><code>clone</code>æ–¹æ³•</h4><p><a href="/2020/04/26/javase/base/cloneable">ä¼ é€é—¨</a></p><h4 id="sizeæ–¹æ³•"><a href="#sizeæ–¹æ³•" class="headerlink" title="sizeæ–¹æ³•"></a><code>size</code>æ–¹æ³•</h4><p>è·å–é›†åˆå¤§å°ï¼šè¿”å›æˆå‘˜å˜é‡<code>size</code>ã€‚</p><h4 id="isEmptyæ–¹æ³•"><a href="#isEmptyæ–¹æ³•" class="headerlink" title="isEmptyæ–¹æ³•"></a><code>isEmpty</code>æ–¹æ³•</h4><p>åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©ºé›†åˆï¼šè¿”å›<code>size == 0</code>å¾—åˆ°çš„å€¼ã€‚</p><h4 id="indexOfæ–¹æ³•"><a href="#indexOfæ–¹æ³•" class="headerlink" title="indexOfæ–¹æ³•"></a><span id="indexOf"><code>indexOf</code>æ–¹æ³•</span></h4><p>è¿”å›æŒ‡å®šå…ƒç´ åœ¨å½“å‰é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ç´¢å¼•ã€‚å¦‚æœå½“å‰é›†åˆä¸­ä¸åŒ…å«æ­¤å…ƒç´ ï¼Œè¿”å›<code>-1</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ ä¸ºnullï¼šä½¿ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">            <span class="keyword">if</span> (elementData[i]==<span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// énullï¼šä½¿ç”¨equalsæ–¹æ³•æ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">            <span class="keyword">if</span> (o.equals(elementData[i]))</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æœªæ‰¾åˆ°ï¼Œè¿”å›-1ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»å‰å¾€åéå†ï¼Œ<code>null</code>å€¼ä½¿ç”¨<code>==</code>è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œå…¶å®ƒå¯¹è±¡ä½¿ç”¨<code>equals</code>æ–¹æ³•æ¯”è¾ƒã€‚</p><h4 id="lastIndexOfæ–¹æ³•"><a href="#lastIndexOfæ–¹æ³•" class="headerlink" title="lastIndexOfæ–¹æ³•"></a><code>lastIndexOf</code>æ–¹æ³•</h4><p>è¿”å›æŒ‡å®šå…ƒç´ åœ¨å½“å‰é›†åˆä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ç´¢å¼•ã€‚å¦‚æœå½“å‰é›†åˆä¸­ä¸åŒ…å«æ­¤å…ƒç´ ï¼Œè¿”å›<code>-1</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lastIndexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = size-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            <span class="keyword">if</span> (elementData[i]==<span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = size-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            <span class="keyword">if</span> (o.equals(elementData[i]))</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»åå¾€å‰éå†ï¼Œ<code>null</code>å€¼ä½¿ç”¨<code>==</code>è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œå…¶å®ƒå¯¹è±¡ä½¿ç”¨<code>equals</code>æ–¹æ³•æ¯”è¾ƒã€‚</p><h4 id="containsæ–¹æ³•"><a href="#containsæ–¹æ³•" class="headerlink" title="containsæ–¹æ³•"></a><code>contains</code>æ–¹æ³•</h4><p>åˆ¤æ–­æŒ‡å®šå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­ã€‚è°ƒç”¨çš„æ˜¯<a href="#indexOf"><code>indexOf(o)</code></a>æ–¹æ³•ï¼Œåˆ¤æ–­å…¶è¿”å›å€¼æ˜¯å¦å¤§äºç­‰äº<code>0</code>ï¼Œç­‰äº<code>-1</code>è¯´æ˜ä¸åœ¨é›†åˆä¸­ã€‚</p><h4 id="iteratoræ–¹æ³•"><a href="#iteratoræ–¹æ³•" class="headerlink" title="iteratoræ–¹æ³•"></a><code>iterator</code>æ–¹æ³•</h4><p>è¯¥æ–¹æ³•æ˜¯è¿­ä»£å™¨è®¾è®¡æ¨¡å¼çš„ä½“ç°ã€‚ä½¿ç”¨äº†<code>new</code>å…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªç§æœ‰å†…éƒ¨ç±»<code>Itr</code>å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Itr();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cursor;       <span class="comment">// index of next element to return</span></span><br><span class="line">    <span class="keyword">int</span> lastRet = -<span class="number">1</span>; <span class="comment">// index of last element returned; -1 if no such</span></span><br><span class="line">    <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line"></span><br><span class="line">    Itr() &#123;&#125;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç§æœ‰å†…éƒ¨ç±»<code>Itr</code>å®ç°äº†<code>java.util.Iterator</code>è¿­ä»£å™¨æ¥å£ã€‚å…¶æˆå‘˜å˜é‡æœ‰ä¸‰ä¸ªï¼š</p><ul><li><code>cursor</code>ï¼šæ¸¸æ ‡ï¼ˆä¸‹ä¸€ä¸ªè¦è¿”å›å…ƒç´ çš„ç´¢å¼•ï¼‰ã€‚</li><li><code>lastRet</code>ï¼šåˆå§‹åŒ–ä¸º<code>-1</code>ï¼Œæœ€åä¸€ä¸ªè¢«è¿”å›å…ƒç´ çš„ç´¢å¼•ï¼›å¦‚æœé›†åˆä¸­æœ¬æ¥æ²¡æœ‰ä»»ä½•å…ƒç´ åˆ™è¿”å›<code>-1</code>ã€‚</li><li><code>expectedModCount</code>ï¼šæœŸæœ›çš„ä¿®æ”¹æ¬¡æ•°ã€‚åˆå§‹åŒ–ä¸ºå½“å‰é›†åˆçš„<code>modCount</code>ã€‚</li></ul><p>åªæœ‰ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ä½¿ç”¨è¿­ä»£å™¨å¯¹<code>ArrayList</code>è¿›è¡Œéå†çš„å†™æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; iteratorList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">iteratorList.add(<span class="number">1</span>);</span><br><span class="line">iteratorList.add(<span class="number">2</span>);</span><br><span class="line">iteratorList.add(<span class="number">3</span>);</span><br><span class="line">iteratorList.add(<span class="number">4</span>);</span><br><span class="line">iteratorList.add(<span class="number">5</span>);</span><br><span class="line">iteratorList.add(<span class="number">6</span>);</span><br><span class="line">Iterator&lt;Integer&gt; iterator = iteratorList.iterator();</span><br><span class="line"><span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">    Integer next = iterator.next();</span><br><span class="line">    System.out.println(next);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­å…³é”®çš„ä¸¤ä¸ªæ–¹æ³•ä¸ºï¼š<code>hasNext()</code>å’Œ<code>next()</code>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç€é‡æ¥çœ‹ä¸‹è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚</p><p>é¦–å…ˆè°ƒç”¨<code>iteratorList</code>å¯¹è±¡çš„<code>iterator()</code>æ–¹æ³•å¾—åˆ°ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œç»è¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬å¯çŸ¥è¿™å®é™…æ˜¯ä¸€ä¸ª<code>Itr</code>å¯¹è±¡ã€‚</p><p>å…¶<code>hasNext()</code>æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cursor != size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿”å›å½“å‰æ¸¸æ ‡<code>cursor</code>æ˜¯å¦ä¸ç­‰äºé›†åˆå¤§å°<code>size</code>ã€‚å¦‚æœä¸ç­‰äº<code>size</code>ï¼Œè¯´æ˜è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚å¯ç»§ç»­è¿­ä»£ã€‚å¦åˆ™è¿­ä»£å®Œæˆã€‚</p><p><code>next()</code>æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// fail-fastæœºåˆ¶</span></span><br><span class="line">    checkForComodification();</span><br><span class="line">    <span class="comment">// è·å–å½“å‰æ¸¸æ ‡</span></span><br><span class="line">    <span class="keyword">int</span> i = cursor;</span><br><span class="line">    <span class="comment">// å½“å‰æ¸¸æ ‡è¶…è¿‡é›†åˆå¤§å°åˆ™æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> (i &gt;= size)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    <span class="comment">// è·å–å­˜å‚¨å…ƒç´ çš„æ•°ç»„å¯¹è±¡</span></span><br><span class="line">    Object[] elementData = ArrayList.<span class="keyword">this</span>.elementData;</span><br><span class="line">    <span class="keyword">if</span> (i &gt;= elementData.length)</span><br><span class="line">        <span class="comment">// å½“å‰æ¸¸æ ‡è¶…å‡ºæ•°ç»„é•¿åº¦ï¼šä¸hasNextæ–¹æ³•ä¸­çš„åˆ¤æ–­å‡ºç°äº†çŸ›ç›¾ã€‚å¹¶å‘ä¿®æ”¹ï¼šfail-fastæœºåˆ¶</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    <span class="comment">// æ ¡éªŒé€šè¿‡ï¼Œæ¸¸æ ‡åŠ ä¸€</span></span><br><span class="line">    cursor = i + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// æœ€åä¸€ä¸ªè¢«è¿”å›å…ƒç´ çš„ç´¢å¼•èµ‹å€¼ä¸ºæ—§çš„æ¸¸æ ‡iï¼Œè¿”å›æ—§çš„æ¸¸æ ‡å¯¹åº”çš„å…ƒç´ ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> (E) elementData[lastRet = i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨<code>Itr</code>ç±»ä¸­ä½¿ç”¨<code>this</code>æŒ‡ä»£çš„æ˜¯å½“å‰<code>Itr</code>å¯¹è±¡ï¼Œä½¿ç”¨<code>ArrayList.this</code>æŒ‡ä»£çš„æ˜¯é›†åˆå¯¹è±¡ã€‚</p></blockquote><blockquote><p>ä¸ºä»€ä¹ˆ<code>ArrayList</code>ä½¿ç”¨è¿­ä»£å™¨éå†æ²¡æœ‰æ™®é€š<code>fori</code>å¾ªç¯éå†æ•ˆç‡é«˜ï¼Ÿ</p><p>ç­”ï¼šç»è¿‡ä»¥ä¸Šä»£ç çš„åˆ†æï¼ŒåŸå› æ˜¾è€Œæ˜“è§ï¼šä½¿ç”¨è¿­ä»£å™¨éå†ï¼Œé¦–å…ˆéœ€è¦ä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»ºä¸€ä¸ª<code>Itr</code>å¯¹è±¡ï¼Œåˆ›å»ºå¯¹è±¡éœ€è¦è€—æ—¶ï¼ˆä¸€æ¬¡ï¼‰ï¼›å…¶æ¬¡ï¼Œä¸­é—´æœ‰å¤šæ¬¡æ¡ä»¶åˆ¤æ–­å¹¶ä¸”æœ‰å±€éƒ¨å˜é‡äº§ç”Ÿï¼Œä»¥åŠä¸€ä¸ªåŠ <code>1</code>æ“ä½œï¼Œè¿™ä¹Ÿéœ€è¦è€—è´¹æ—¶é—´ï¼ˆå¤šæ¬¡ï¼šæ¯æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼‰ã€‚</p></blockquote><h2 id="Demoå®æˆ˜"><a href="#Demoå®æˆ˜" class="headerlink" title="Demoå®æˆ˜"></a><code>Demo</code>å®æˆ˜</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.collect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayListTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ’å…¥å…ƒç´ </span></span><br><span class="line">        ArrayList&lt;String&gt; addList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é›†åˆå°¾éƒ¨æ’å…¥</span></span><br><span class="line">        addList.add(<span class="string">&quot;æµ‹è¯•1&quot;</span>);</span><br><span class="line">        System.out.println(addList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥</span></span><br><span class="line">        addList.add(<span class="number">1</span>,<span class="string">&quot;æŒ‡å®šä½ç½®1&quot;</span>);</span><br><span class="line">        System.out.println(addList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥ï¼šç´¢å¼•ä½ç½®æ— å…ƒç´ ä¸”ä¸æ˜¯å°¾éƒ¨ï¼šç´¢å¼•è¶Šç•Œã€‚</span></span><br><span class="line">        <span class="comment">// addList.add(10,&quot;æŒ‡å®šä½ç½®2&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¾…æ’å…¥é›†åˆåˆå§‹åŒ–</span></span><br><span class="line">        ArrayList&lt;String&gt; toBeAddList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        toBeAddList.add(<span class="string">&quot;æµ‹è¯•2&quot;</span>);</span><br><span class="line">        toBeAddList.add(<span class="string">&quot;æµ‹è¯•3&quot;</span>);</span><br><span class="line">        toBeAddList.add(<span class="string">&quot;æµ‹è¯•4&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¾…æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥é›†åˆåˆå§‹åŒ–</span></span><br><span class="line">        ArrayList&lt;String&gt; toBeAddIndexList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        toBeAddIndexList.add(<span class="string">&quot;æµ‹è¯•5&quot;</span>);</span><br><span class="line">        toBeAddIndexList.add(<span class="string">&quot;æµ‹è¯•6&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥è‡³å½“å‰é›†åˆæœ«å°¾</span></span><br><span class="line">        addList.addAll(toBeAddList);</span><br><span class="line">        System.out.println(addList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»å½“å‰é›†åˆæŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹ï¼Œå°†ä¸€ä¸ªé›†åˆå…¨éƒ¨å…ƒç´ æ’å…¥</span></span><br><span class="line">        addList.addAll(<span class="number">1</span>,toBeAddIndexList);</span><br><span class="line">        System.out.println(addList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ é™¤å…ƒç´ </span></span><br><span class="line">        List&lt;Integer&gt; removeList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        removeList.add(<span class="number">1</span>);</span><br><span class="line">        removeList.add(<span class="number">2</span>);</span><br><span class="line">        removeList.add(<span class="number">6</span>);</span><br><span class="line">        removeList.add(<span class="number">3</span>);</span><br><span class="line">        removeList.add(<span class="number">4</span>);</span><br><span class="line">        removeList.add(<span class="number">5</span>);</span><br><span class="line">        removeList.add(<span class="number">6</span>);</span><br><span class="line">        removeList.add(<span class="number">4</span>);</span><br><span class="line">        System.out.println(removeList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´ </span></span><br><span class="line">        removeList.remove(<span class="number">1</span>);</span><br><span class="line">        System.out.println(removeList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ é™¤æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®çš„å…ƒç´ </span></span><br><span class="line">        removeList.remove(<span class="keyword">new</span> Integer(<span class="number">6</span>));</span><br><span class="line">        System.out.println(removeList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¾…åˆ é™¤å…ƒç´ é›†åˆ</span></span><br><span class="line">        List&lt;Integer&gt; beRemovedList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        beRemovedList.add(<span class="number">2</span>);</span><br><span class="line">        beRemovedList.add(<span class="number">3</span>);</span><br><span class="line">        beRemovedList.add(<span class="number">6</span>);</span><br><span class="line">        System.out.println(removeList);</span><br><span class="line">        System.out.println(beRemovedList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»å½“å‰é›†åˆä¸­åˆ é™¤æŒ‡å®šé›†åˆä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ </span></span><br><span class="line">        <span class="keyword">boolean</span> b = removeList.removeAll(beRemovedList);</span><br><span class="line">        System.out.println(b);</span><br><span class="line">        System.out.println(removeList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ é™¤å…¨éƒ¨å…ƒç´ </span></span><br><span class="line">        removeList.clear();</span><br><span class="line">        System.out.println(removeList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¿®æ”¹å…ƒç´ é›†åˆåˆå§‹åŒ–</span></span><br><span class="line">        ArrayList&lt;Integer&gt; operatorList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        operatorList.add(<span class="number">1</span>);</span><br><span class="line">        operatorList.add(<span class="number">2</span>);</span><br><span class="line">        operatorList.add(<span class="number">3</span>);</span><br><span class="line">        operatorList.add(<span class="number">2</span>);</span><br><span class="line">        operatorList.add(<span class="number">1</span>);</span><br><span class="line">        System.out.println(operatorList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¿®æ”¹å…ƒç´ ï¼Œå°†ç´¢å¼•ä¸º1çš„å…ƒç´ ä¿®æ”¹ä¸º6</span></span><br><span class="line">        operatorList.set(<span class="number">1</span>,<span class="number">6</span>);</span><br><span class="line">        System.out.println(operatorList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŸ¥è¯¢å…ƒç´ </span></span><br><span class="line">        Integer integer = operatorList.get(<span class="number">1</span>);</span><br><span class="line">        System.out.println(integer);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…‹éš†</span></span><br><span class="line">        Object clone = operatorList.clone();</span><br><span class="line">        System.out.println(clone);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// size</span></span><br><span class="line">        System.out.println(operatorList.size());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// isEmpty</span></span><br><span class="line">        System.out.println(operatorList.isEmpty());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// indexOf</span></span><br><span class="line">        System.out.println(operatorList.indexOf(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// lastIndexOf</span></span><br><span class="line">        System.out.println(operatorList.lastIndexOf(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// contains</span></span><br><span class="line">        System.out.println(operatorList.contains(<span class="number">3</span>));</span><br><span class="line">        System.out.println(operatorList.contains(<span class="number">4</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿­ä»£å™¨è®¾è®¡æ¨¡å¼</span></span><br><span class="line">        List&lt;Integer&gt; iteratorList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        iteratorList.add(<span class="number">1</span>);</span><br><span class="line">        iteratorList.add(<span class="number">2</span>);</span><br><span class="line">        iteratorList.add(<span class="number">3</span>);</span><br><span class="line">        iteratorList.add(<span class="number">4</span>);</span><br><span class="line">        iteratorList.add(<span class="number">5</span>);</span><br><span class="line">        iteratorList.add(<span class="number">6</span>);</span><br><span class="line">        Iterator&lt;Integer&gt; iterator = iteratorList.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            Integer next = iterator.next();</span><br><span class="line">            System.out.println(next);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ™®é€šforiå¾ªç¯éå†</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>,size = iteratorList.size(); i &lt; size; i++) &#123;</span><br><span class="line">            System.out.println(iteratorList.get(i));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// forEachéå†ï¼Œåº•å±‚å®ç°ä¸ºè¿­ä»£å™¨</span></span><br><span class="line">        <span class="keyword">for</span> (Integer i : iteratorList) &#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><code>ArrayList</code>é›†åˆæ˜¯æˆ‘ä»¬åœ¨å·¥ä½œä¸­ç”¨åˆ°çš„æœ€å¤šçš„é›†åˆï¼Œæˆ‘ä»¬å¿…é¡»ç†Ÿç»ƒæŒæ¡å…¶ç‰¹æ€§ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„æºç åˆ†æå¯çŸ¥ï¼Œ<code>ArrayList</code>é›†åˆæŸ¥æ‰¾æ•ˆç‡éå¸¸é«˜ã€‚é¡ºåºæ·»åŠ å…ƒç´ è‡³æœ«å°¾æ•ˆç‡ä¹Ÿå¾ˆé«˜ï¼Œä½†éœ€è¦ç¡®ä¿ä¸æ‰©å®¹ï¼Œå¦åˆ™è¿›è¡Œæ•°ç»„æ‹·è´å¾ˆè€—æ—¶ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨åˆ›å»º<code>ArrayList</code>å¯¹è±¡æ—¶ï¼Œå¦‚æœå¯ä»¥é¢„ä¼°åˆ°é›†åˆä¸­å…ƒç´ ä¸ªæ•°ï¼Œæœ€å¥½æŒ‡å®šåˆå§‹å®¹é‡ï¼Œä»¥é¿å…åœ¨æ’å…¥æ—¶æ‰©å®¹å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚</p><p>æœ¬æ–‡<code>Demo</code>å®æˆ˜ä»£ç è§ï¼š<a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/java-se/src/main/java/com/sunchaser/javase/collect/ArrayListTest.java">ä¼ é€é—¨</a></p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹AbstractSequentialList</title>
      <link href="2020/05/27/javase/base/abstract-sequential-list/"/>
      <url>2020/05/27/javase/base/abstract-sequential-list/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>AbstractSequentialList</code>ç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒç»§æ‰¿äº†<code>AbstractList</code>æŠ½è±¡ç±»ã€‚åŒæ ·æä¾›äº†æœ‰åºé›†åˆçš„éª¨æ¶å®ç°ï¼Œä½†æ˜¯å®ƒæ˜¯æœ€å¤§ç¨‹åº¦åœ°å‡å°‘äº†æ”¯æŒé¡ºåºè®¿é—®æ•°æ®çš„å®ç°ç±»æ‰€éœ€çš„å·¥ä½œã€‚å¦‚æœéœ€è¦éšæœºè®¿é—®æ•°æ®ï¼Œä¼˜å…ˆä½¿ç”¨<code>AbstractList</code>æŠ½è±¡ç±»ã€‚</p><p>ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œè¯¥ç±»ä¸<code>AbstractList</code>æŠ½è±¡ç±»ç›¸åï¼Œè¯¥ç±»å®ç°äº†éšæœºè®¿é—®æ–¹æ³•ï¼Œè€Œä¸æ˜¯åƒ<code>AbstractList</code>æŠ½è±¡ç±»ä¸€æ ·æŠ›å‡ºå¼‚å¸¸ã€‚</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>è¯¥æŠ½è±¡ç±»æä¾›äº†æœ‰åºé›†åˆçš„éª¨æ¶å®ç°ã€‚è®©å®ç°ç±»æ”¯æŒé¡ºåºè®¿é—®ã€‚</p><p>å¦‚æœè¦å®ç°é›†åˆï¼Œåªéœ€ç»§æ‰¿è¯¥ç±»å¹¶å®ç°è¯¥ç±»çš„<code>listIterator()</code>æŠ½è±¡æ–¹æ³•å’Œ<code>AbstractCollection#size()</code>æ–¹æ³•ï¼›</p><p>å¦‚æœè¦å®ç°ä¸å¯ä¿®æ”¹çš„é›†åˆï¼Œåªéœ€ç»§æ‰¿è¯¥ç±»å¹¶å®ç°åˆ—è¡¨è¿­ä»£å™¨<code>ListIterator</code>çš„<code>hasNext</code>/<code>next</code>/<code>hasPrevious</code>/<code>previous</code>/<code>index</code>æ–¹æ³•ã€‚</p><p>å¦‚æœè¦å®ç°å¯ä¿®æ”¹çš„é›†åˆï¼Œåœ¨å®ç°ä¸å¯ä¿®æ”¹é›†åˆçš„åŸºç¡€ä¸Šï¼Œéœ€è¦å¦å¤–å®ç°åˆ—è¡¨è¿­ä»£å™¨çš„<code>set</code>æ–¹æ³•ï¼›å¯¹äºå¯å˜å¤§å°çš„é›†åˆï¼Œè¿˜éœ€è¦å®ç°åˆ—è¡¨è¿­ä»£å™¨çš„<code>remove</code>å’Œ<code>add</code>æ–¹æ³•ã€‚</p><p>æ­¤å¤–ï¼Œå®ç°ç±»åŒæ ·åº”è¯¥éµå¾ª<code>Collection</code>æ¥å£ä¸­æå‡ºçš„è§„èŒƒï¼šå¿…é¡»æä¾›ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼š<code>void</code>æ— å‚æ„é€ å™¨å’Œå¸¦<code>Collection</code>ç±»å‹çš„å•ä¸ªå‚æ•°çš„æ„é€ å™¨ã€‚</p><h2 id="æºç è¯¦è§£"><a href="#æºç è¯¦è§£" class="headerlink" title="æºç è¯¦è§£"></a>æºç è¯¦è§£</h2><h3 id="æ„é€ å™¨"><a href="#æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨"></a>æ„é€ å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">AbstractSequentialList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªæœ‰ä¸€ä¸ªä½¿ç”¨<code>protected</code>ä¿®é¥°ç¬¦ä¿®é¥°çš„æ— å‚æ„é€ å™¨ã€‚è¯´æ˜è¯¥æŠ½è±¡ç±»ä¸å…è®¸å¤–éƒ¨ç›´æ¥å®ä¾‹åŒ–ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªéª¨æ¶å®ç°ï¼Œå¹¶ä¸æä¾›é¡ºåºè®¿é—®é›†åˆçš„å®Œæ•´åŠŸèƒ½ã€‚</p><h3 id="æŠ½è±¡æ–¹æ³•"><a href="#æŠ½è±¡æ–¹æ³•" class="headerlink" title="æŠ½è±¡æ–¹æ³•"></a>æŠ½è±¡æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">(<span class="keyword">int</span> index)</span></span>;</span><br></pre></td></tr></table></figure><p>æŒ‰æ­£ç¡®çš„é¡ºåºè¿”å›æ­¤åˆ—è¡¨çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œå…¶å¼€å§‹ç´¢å¼•ä¸ºå…¥å‚<code>index</code>ã€‚è¯¥ç±»ä¸­çš„å…¶å®ƒæ–¹æ³•éƒ½æ˜¯åŸºäºæ­¤æŠ½è±¡æ–¹æ³•è¿”å›çš„åˆ—è¡¨è¿­ä»£å™¨å®ç°çš„ã€‚</p><h3 id="å·²å®ç°æ–¹æ³•"><a href="#å·²å®ç°æ–¹æ³•" class="headerlink" title="å·²å®ç°æ–¹æ³•"></a>å·²å®ç°æ–¹æ³•</h3><p>æ‰€æœ‰çš„å·²å®ç°æ–¹æ³•éƒ½ä¼ å…¥äº†ç´¢å¼•å€¼ï¼Œå¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œçœ‹ä¼¼æ˜¯éšæœºè®¿é—®ï¼Œä½†å†…éƒ¨å®ç°å´æ˜¯é¡ºåºè®¿é—®ã€‚</p><h4 id="è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "><a href="#è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ " class="headerlink" title="è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "></a>è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> listIterator(index).next();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchElementException exc) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">&quot;Index: &quot;</span>+index);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å–<code>index</code>ç´¢å¼•å¼€å§‹çš„åˆ—è¡¨è¿­ä»£å™¨åè°ƒç”¨å…¶<code>next</code>æ–¹æ³•è·å–<code>index</code>ç´¢å¼•ä½ç½®å…ƒç´ è¿”å›ã€‚</p><h4 id="ç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "><a href="#ç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ " class="headerlink" title="ç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "></a>ç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ListIterator&lt;E&gt; e = listIterator(index);</span><br><span class="line">        E oldVal = e.next();</span><br><span class="line">        e.set(element);</span><br><span class="line">        <span class="keyword">return</span> oldVal;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchElementException exc) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">&quot;Index: &quot;</span>+index);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å–<code>index</code>ç´¢å¼•å¼€å§‹çš„åˆ—è¡¨è¿­ä»£å™¨åè°ƒç”¨å…¶<code>next</code>æ–¹æ³•è·å–<code>index</code>ç´¢å¼•ä½ç½®çš„æ—§å€¼ï¼Œç„¶åè°ƒç”¨åˆ—è¡¨è¿­ä»£å™¨çš„<code>set</code>æ–¹æ³•ï¼Œè¦†ç›–<code>next</code>æ–¹æ³•æœ€åè¿”å›çš„<code>index</code>ç´¢å¼•ä½ç½®çš„å…ƒç´ ï¼Œæœ€åè¿”å›æ—§å€¼ã€‚</p><h4 id="åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šå…ƒç´ "><a href="#åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šå…ƒç´ " class="headerlink" title="åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šå…ƒç´ "></a>åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šå…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        listIterator(index).add(element);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchElementException exc) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">&quot;Index: &quot;</span>+index);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å®ç°ä¼šå°†å½“å‰ä½äº<code>index</code>ä½ç½®çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å’Œåç»­æ‰€æœ‰å…ƒç´ å³ç§»ä¸€ä½ï¼ˆç´¢å¼•å¢ä¸€ï¼‰ã€‚</p><p>é¦–å…ˆè·å–<code>index</code>ç´¢å¼•å¼€å§‹çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åè°ƒç”¨åˆ—è¡¨è¿­ä»£å™¨çš„<code>add</code>æ–¹æ³•æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚</p><p>æ‰€ä»¥åˆ—è¡¨è¿­ä»£å™¨å¿…é¡»å®ç°<code>add</code>æ–¹æ³•ï¼Œå¦åˆ™è¯¥æ–¹æ³•å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚</p><h4 id="åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "><a href="#åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ " class="headerlink" title="åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "></a>åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ListIterator&lt;E&gt; e = listIterator(index);</span><br><span class="line">        E outCast = e.next();</span><br><span class="line">        e.remove();</span><br><span class="line">        <span class="keyword">return</span> outCast;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchElementException exc) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">&quot;Index: &quot;</span>+index);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å®ç°ä¼šå°†<code>index</code>ç´¢å¼•ä½ç½®åç»­æ‰€æœ‰å…ƒç´ å·¦ç§»ä¸€ä½ï¼ˆç´¢å¼•å‡ä¸€ï¼‰ã€‚</p><p>é¦–å…ˆè·å–<code>index</code>ç´¢å¼•å¼€å§‹çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åè·å–<code>index</code>ç´¢å¼•ä½ç½®çš„æ—§å…ƒç´ ï¼Œå†è°ƒç”¨åˆ—è¡¨è¿­ä»£å™¨çš„<code>remove</code>æ–¹æ³•åˆ é™¤å…ƒç´ ï¼Œæœ€åè¿”å›æ—§å…ƒç´ ã€‚</p><p>æ‰€ä»¥åˆ—è¡¨è¿­ä»£å™¨å¿…é¡»å®ç°<code>remove</code>æ–¹æ³•ï¼Œå¦åˆ™è¯¥æ–¹æ³•å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚</p><h4 id="åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šé›†åˆ"><a href="#åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šé›†åˆ" class="headerlink" title="åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šé›†åˆ"></a>åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šé›†åˆ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">boolean</span> modified = <span class="keyword">false</span>;</span><br><span class="line">        ListIterator&lt;E&gt; e1 = listIterator(index);</span><br><span class="line">        Iterator&lt;? extends E&gt; e2 = c.iterator();</span><br><span class="line">        <span class="keyword">while</span> (e2.hasNext()) &#123;</span><br><span class="line">            e1.add(e2.next());</span><br><span class="line">            modified = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> modified;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchElementException exc) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">&quot;Index: &quot;</span>+index);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å®ç°ä¼šå°†å½“å‰ä½äº<code>index</code>ç´¢å¼•ä½ç½®åŠå…¶åç»­æ‰€æœ‰å…ƒç´ å³ç§»ï¼ŒæŒ‡å®šé›†åˆä¸­çš„å…ƒç´ å°†ä»¥å…¶è¿­ä»£å™¨è¿”å›çš„é¡ºåºæ˜¾ç¤ºåœ¨å½“å‰é›†åˆä¸­ã€‚</p><p>åˆ†åˆ«è·å–å½“å‰é›†åˆçš„åˆ—è¡¨è¿­ä»£å™¨å’ŒæŒ‡å®šé›†åˆçš„æ™®é€šè¿­ä»£å™¨ï¼Œè¿­ä»£æŒ‡å®šé›†åˆï¼Œä¾æ¬¡å°†å…ƒç´ <code>add</code>è‡³å½“å‰é›†åˆä¸­ã€‚</p><p>æ‰€ä»¥åˆ—è¡¨è¿­ä»£å™¨å¿…é¡»å®ç°<code>add</code>æ–¹æ³•ï¼Œå¦åˆ™è¯¥æ–¹æ³•å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚</p><h4 id="è·å–æ™®é€šè¿­ä»£å™¨"><a href="#è·å–æ™®é€šè¿­ä»£å™¨" class="headerlink" title="è·å–æ™®é€šè¿­ä»£å™¨"></a>è·å–æ™®é€šè¿­ä»£å™¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> listIterator();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è°ƒç”¨å½“å‰ç±»çš„æŠ½è±¡æ–¹æ³•<code>listIterator()</code>ï¼Œè¿”å›åˆ—è¡¨è¿­ä»£å™¨ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¯¥æŠ½è±¡ç±»æä¾›äº†é¡ºåºè®¿é—®é›†åˆçš„éª¨æ¶å®ç°ï¼Œæ˜¯<code>LinkedList</code>é›†åˆçš„ç›´æ¥çˆ¶ç±»ã€‚æ‰€æœ‰å®ç°ä¾æ‰˜äºè¯¥ç±»çš„<code>listIterator()</code>æŠ½è±¡æ–¹æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹LinkedList</title>
      <link href="2020/05/27/javase/base/linkedlist/"/>
      <url>2020/05/27/javase/base/linkedlist/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><code>LinkedList</code>çš„åº•å±‚å®ç°æ˜¯åŒå‘é“¾è¡¨ï¼Œåœ¨å­¦ä¹ å…¶æºç ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ææ‡‚é“¾è¡¨çš„åŸç†ã€‚</p><h2 id="å•é“¾è¡¨ç®€ä»‹"><a href="#å•é“¾è¡¨ç®€ä»‹" class="headerlink" title="å•é“¾è¡¨ç®€ä»‹"></a>å•é“¾è¡¨ç®€ä»‹</h2><p>å•é“¾è¡¨ä¸­çš„æ•°æ®æ˜¯ä»¥èŠ‚ç‚¹çš„å½¢å¼æ¥è¡¨ç¤ºçš„ï¼Œæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨äº†å½“å‰èŠ‚ç‚¹çš„å…ƒç´ å€¼ï¼ˆæ•°æ®åŸŸï¼‰å’Œä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆåç»§èŠ‚ç‚¹ï¼‰çš„åœ°å€å€¼ï¼ˆæŒ‡é’ˆåŸŸï¼‰ã€‚æ¯ä¸ªèŠ‚ç‚¹çš„å†…å­˜ç©ºé—´å¯ä»¥æ˜¯ä¸è¿ç»­çš„ï¼Œå®ƒé€šè¿‡æ¯ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸå°†å„ä¸ªèŠ‚ç‚¹è¿æ¥èµ·æ¥ã€‚</p><p>æ¯ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªæŒ‡é’ˆåŸŸçš„é“¾è¡¨ç§°ä¸ºå•é“¾è¡¨ã€‚å¦‚æœæƒ³è¦éå†å•é“¾è¡¨ï¼Œåˆ™å¿…é¡»ä»å¤´èŠ‚ç‚¹å¼€å§‹è¿­ä»£ã€‚</p><h2 id="åŒå‘é“¾è¡¨ç®€ä»‹"><a href="#åŒå‘é“¾è¡¨ç®€ä»‹" class="headerlink" title="åŒå‘é“¾è¡¨ç®€ä»‹"></a>åŒå‘é“¾è¡¨ç®€ä»‹</h2><p>åŒå‘é“¾è¡¨ä¸å•é“¾è¡¨ç›¸æ¯”ï¼Œå®ƒçš„æ¯ä¸ªèŠ‚ç‚¹åœ¨å•é“¾è¡¨çš„åŸºç¡€ä¸Šè¿˜å­˜å‚¨äº†ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå‰é©±èŠ‚ç‚¹ï¼‰çš„åœ°å€å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä»ä»»ä¸€èŠ‚ç‚¹å¼€å§‹ï¼Œéƒ½å¯ä»¥éå†æ•´ä¸ªé“¾è¡¨ã€‚</p><h2 id="å¾ªç¯é“¾è¡¨ç®€ä»‹"><a href="#å¾ªç¯é“¾è¡¨ç®€ä»‹" class="headerlink" title="å¾ªç¯é“¾è¡¨ç®€ä»‹"></a>å¾ªç¯é“¾è¡¨ç®€ä»‹</h2><p>å•é“¾è¡¨å’ŒåŒé“¾è¡¨éƒ½å¯ä»¥æ„é€ æˆå¾ªç¯é“¾è¡¨ï¼Œåªéœ€å°†æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„åç»§ç»“ç‚¹æŒ‡é’ˆåŸŸæŒ‡å‘å¤´èŠ‚ç‚¹ï¼Œå½¢æˆä¸€ä¸ªç¯ã€‚å› æ­¤ï¼Œä»å¾ªç¯é“¾è¡¨çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œéƒ½å¯ä»¥éå†æ•´ä¸ªé“¾è¡¨ã€‚</p><h2 id="LinkedListç®€ä»‹"><a href="#LinkedListç®€ä»‹" class="headerlink" title="LinkedListç®€ä»‹"></a><code>LinkedList</code>ç®€ä»‹</h2><p><code>LinkedList</code>ç±»æ˜¯åŸºäºåŒå‘é“¾è¡¨å®ç°çš„ï¼Œå®ƒç»§æ‰¿äº†<code>AbstractSequentialList</code>é¡ºåºè®¿é—®é›†åˆæŠ½è±¡æ¨¡æ¿ç±»ï¼Œå®ç°äº†æœ‰åºé›†åˆæ¥å£<code>List</code>å’ŒåŒç«¯é˜Ÿåˆ—æ¥å£<code>Deque</code>ã€‚æ‰€ä»¥ï¼Œ<code>LinkedList</code>å³å¯ä»¥ä½œä¸ºé›†åˆä½¿ç”¨ï¼ŒåŒæ—¶å¯ä»¥ç”¨ä½œåŒç«¯é˜Ÿåˆ—ï¼Œè¿˜å¯ä»¥ç”¨ä½œæ ˆã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„å®ç°ç±»ã€‚</p><h2 id="LinkedListç‰¹æ€§"><a href="#LinkedListç‰¹æ€§" class="headerlink" title="LinkedListç‰¹æ€§"></a><code>LinkedList</code>ç‰¹æ€§</h2><p>ç”±äº<code>LinkedList</code>ç±»ç»§æ‰¿è‡ª<code>AbstractSequentialList</code>æŠ½è±¡ç±»ï¼Œè€Œ<code>AbstractSequentialList</code>æŠ½è±¡ç±»åˆç»§æ‰¿è‡ª<code>AbstractList</code>æŠ½è±¡ç±»ã€‚äºæ˜¯<code>LinkedList</code>ç±»å¾—åˆ°äº†<code>AbstractList</code>æŠ½è±¡ç±»çš„<code>modCount</code>å­—æ®µã€‚åŸºäºè¯¥å­—æ®µå®ç°äº†<code>fail-fast</code>æœºåˆ¶ã€‚</p><h2 id="æºç è¯¦è§£"><a href="#æºç è¯¦è§£" class="headerlink" title="æºç è¯¦è§£"></a>æºç è¯¦è§£</h2><h3 id="æˆå‘˜å˜é‡"><a href="#æˆå‘˜å˜é‡" class="headerlink" title="æˆå‘˜å˜é‡"></a>æˆå‘˜å˜é‡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰é›†åˆçš„å¤§å°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŒ‡å‘åŒå‘é“¾è¡¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Node&lt;E&gt; first;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŒ‡å‘åŒå‘é“¾è¡¨æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Node&lt;E&gt; last;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åºåˆ—åŒ–ID</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">876323262645176354L</span>;</span><br></pre></td></tr></table></figure><h3 id="NodeèŠ‚ç‚¹ç±»"><a href="#NodeèŠ‚ç‚¹ç±»" class="headerlink" title="NodeèŠ‚ç‚¹ç±»"></a><code>Node</code>èŠ‚ç‚¹ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// æ•°æ®åŸŸ</span></span><br><span class="line">    E item;</span><br><span class="line">    <span class="comment">// åç»§èŠ‚ç‚¹</span></span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    <span class="comment">// å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line"></span><br><span class="line">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.item = element;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">        <span class="keyword">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ„é€ å™¨"><a href="#æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨"></a>æ„é€ å™¨</h3><p>éµå¾ªäº†<code>Collection</code>æ¥å£çš„è§„èŒƒï¼šæä¾›äº†ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼š<code>void</code>æ— å‚æ„é€ å™¨å’Œå¸¦<code>Collection</code>ç±»å‹çš„å•ä¸ªå‚æ•°æ„é€ å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ— å‚æ„é€ å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸¦å‚æ„é€ å™¨ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆä¸­å…ƒç´ çš„é“¾è¡¨ï¼Œå…¶é¡ºåºä¸ºæŒ‡å®šé›†åˆè¿­ä»£å™¨è¿”å›çš„é¡ºåº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>();</span><br><span class="line">    addAll(c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— å‚æ„é€ å™¨ä¸­æ²¡æœ‰ä»»ä½•æ“ä½œã€‚</p><p>å¸¦å‚æ„é€ å™¨ä¸­é¦–å…ˆè°ƒç”¨äº†æ— å‚æ„é€ å™¨ï¼Œç„¶åè°ƒç”¨<code>addAll(c)</code>æ–¹æ³•æ„é€ é“¾è¡¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> addAll(size, c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥<code>addAll(c)</code>æ–¹æ³•æ˜¯å°†æŒ‡å®šé›†åˆ<code>c</code>æ·»åŠ è‡³æ­¤åˆ—è¡¨æœ«å°¾ï¼Œç”±äºæ˜¯åœ¨æ„é€ å™¨ä¸­è°ƒç”¨ï¼Œæ‰€ä»¥<code>size</code>ä¸ºåˆå§‹å€¼<code>0</code>ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹é‡è½½çš„<code>addAll(size,c)</code>æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    checkPositionIndex(index);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é›†åˆè½¬Objectæ•°ç»„</span></span><br><span class="line">    Object[] a = c.toArray();</span><br><span class="line">    <span class="comment">// è®¡ç®—æ•°ç»„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">int</span> numNew = a.length;</span><br><span class="line">    <span class="keyword">if</span> (numNew == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="comment">// predï¼š æ’å…¥ä½ç½®çš„å‰é©±èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼šindex - 1ï¼‰</span></span><br><span class="line">    <span class="comment">// succï¼š æ’å…¥ä½ç½®çš„åç»§èŠ‚ç‚¹ï¼ˆç´¢å¼•ï¼šindex + 1ï¼‰</span></span><br><span class="line">    Node&lt;E&gt; pred, succ;</span><br><span class="line">    <span class="keyword">if</span> (index == size) &#123;</span><br><span class="line">        <span class="comment">// æ’å…¥ä½ç½®ä¸ºæœ«å°¾</span></span><br><span class="line">        <span class="comment">// åç»§èŠ‚ç‚¹ä¸ºnull</span></span><br><span class="line">        succ = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">// å‰é©±èŠ‚ç‚¹ä¸º last</span></span><br><span class="line">        pred = last;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æ’å…¥ä½ç½®ä¸åœ¨æœ«å°¾ï¼Œåœ¨é“¾è¡¨ä¸­é—´</span></span><br><span class="line">        <span class="comment">// åç»§èŠ‚ç‚¹ä¸º node(index)</span></span><br><span class="line">        succ = node(index);</span><br><span class="line">        <span class="comment">// å‰é©±èŠ‚ç‚¹ä¸ºåç»§èŠ‚ç‚¹succçš„å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">        pred = succ.prev;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿­ä»£Objectæ•°ç»„a</span></span><br><span class="line">    <span class="keyword">for</span> (Object o : a) &#123;</span><br><span class="line">        <span class="comment">// å¼ºåˆ¶ç±»å‹è½¬æ¢</span></span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span> E e = (E) o;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹newNodeï¼šå…¶å‰é©±èŠ‚ç‚¹ä¸ºpredï¼ŒèŠ‚ç‚¹æ•°æ®åŸŸä¸ºæ­¤æ¬¡è¿­ä»£å…ƒç´ eï¼Œåç»§èŠ‚ç‚¹ä¸ºnull</span></span><br><span class="line">        Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(pred, e, <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">if</span> (pred == <span class="keyword">null</span>)</span><br><span class="line">            <span class="comment">// å‰é©±èŠ‚ç‚¹ä¸ºnullï¼šé“¾è¡¨åˆå§‹ä¸ºç©ºé“¾è¡¨ï¼›æ–°èŠ‚ç‚¹newNodeä¸ºå¤´èŠ‚ç‚¹</span></span><br><span class="line">            first = newNode;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="comment">// å‰é©±èŠ‚ç‚¹ä¸ä¸ºnullï¼šå°†predçš„åç»§èŠ‚ç‚¹æŒ‡å‘newNode</span></span><br><span class="line">            pred.next = newNode;</span><br><span class="line">        <span class="comment">// å°†å‰é©±èŠ‚ç‚¹ç½®ä¸ºnewNodeï¼Œä»¥ä¾¿ä¸‹æ¬¡è¿­ä»£é“¾æ¥èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        pred = newNode;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿­ä»£å®Œæˆ</span></span><br><span class="line">    <span class="keyword">if</span> (succ == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// åç»§èŠ‚ç‚¹ä¸ºnullï¼šåˆå§‹æ’å…¥ä½ç½®ä¸ºé“¾è¡¨æœ«å°¾ï¼šå°†lastç½®ä¸ºæœ€åä¸€æ¬¡è¿­ä»£çš„predï¼Œå³ä¸ºé“¾è¡¨æœ«å°¾å…ƒç´ ã€‚</span></span><br><span class="line">        last = pred;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// åç»§èŠ‚ç‚¹ä¸ä¸ºnullï¼šä»é“¾è¡¨ä¸­é—´è¿›è¡Œæ’å…¥ï¼šå°†æœ€åä¸€æ¬¡è¿­ä»£çš„predå…ƒç´ çš„åç»§èŠ‚ç‚¹æŒ‡å‘succã€‚</span></span><br><span class="line">        pred.next = succ;</span><br><span class="line">        <span class="comment">// å°†succçš„å‰é©±èŠ‚ç‚¹æŒ‡å‘predã€‚</span></span><br><span class="line">        succ.prev = pred;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å¢åŠ </span></span><br><span class="line">    size += numNew;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•æ˜¯å°†æŒ‡å®šé›†åˆæ’å…¥è‡³æŒ‡å®šç´¢å¼•ä½ç½®ï¼ŒæŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å’Œåç»­æ‰€æœ‰å…ƒç´ éƒ½å°†å³ç§»ã€‚</p><p>åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š</p><p>1ã€ ä»é“¾è¡¨å°¾éƒ¨æ’å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/jdk/linkedlistaddfromlast.gif" alt="ä»é“¾è¡¨å°¾éƒ¨æ’å…¥"></p><p>åˆå§‹æ¡ä»¶ä¸ºï¼š</p><ul><li>åˆå§‹é“¾è¡¨ä¸ºï¼š<code>[L,I,N]</code></li><li>æŒ‡å®šç´¢å¼•ä½ç½®ï¼š<code>indexï¼š3</code></li><li>å¾…æ’å…¥å…ƒç´ é›†åˆï¼š<code>collectionï¼š[K,E,D]</code></li><li>æ’å…¥ä½ç½®çš„å‰é©±èŠ‚ç‚¹ï¼š<code>predï¼šN</code></li><li>æ’å…¥ä½ç½®çš„åç»§èŠ‚ç‚¹ï¼š<code>succï¼šnull</code></li></ul><p>æ’å…¥è¿‡ç¨‹ï¼š</p><p>è¿­ä»£å¼€å§‹ï¼š</p><ul><li>å¾…æ’å…¥é›†åˆè½¬æ•°ç»„ï¼š<code>aï¼š[K,E,D]</code></li><li>ç¬¬ä¸€æ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹<code>newNode</code>ï¼Œå€¼ä¸º<code>K</code>ï¼Œå‰é©±èŠ‚ç‚¹<code>pred</code>ä¸º<code>N</code>ï¼Œåç»§èŠ‚ç‚¹<code>succ</code>ä¸º<code>null</code>ï¼Œå°†Nçš„åç»§èŠ‚ç‚¹æŒ‡å‘<code>K</code>ï¼Œå°†å‰é©±èŠ‚ç‚¹<code>pred</code>å¼•ç”¨<code>newNode:K</code>ã€‚</li><li>ç¬¬äºŒæ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹<code>newNode</code>ï¼Œå€¼ä¸º<code>E</code>ï¼Œå‰é©±èŠ‚ç‚¹<code>pred</code>ä¸º<code>K</code>ï¼Œåç»§èŠ‚ç‚¹<code>succ</code>ä¸º<code>null</code>ï¼Œå°†<code>K</code>çš„åç»§èŠ‚ç‚¹æŒ‡å‘<code>E</code>ï¼Œ å°†å‰é©±èŠ‚ç‚¹<code>pred</code>å¼•ç”¨<code>newNode:E</code>ã€‚</li><li>ç¬¬ä¸‰æ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹<code>newNode</code>ï¼Œå€¼ä¸º<code>D</code>ï¼Œå‰é©±èŠ‚ç‚¹<code>pred</code>ä¸º<code>E</code>ï¼Œåç»§èŠ‚ç‚¹<code>succ</code>ä¸º<code>null</code>ï¼Œå°†<code>E</code>çš„åç»§èŠ‚ç‚¹æŒ‡å‘<code>D</code>ï¼Œå°†å‰é©±èŠ‚ç‚¹<code>pred</code>å¼•ç”¨<code>newNode:D</code>ã€‚</li></ul><p>è¿­ä»£å®Œæˆã€‚</p><p>æ­¤æ—¶åç»§èŠ‚ç‚¹<code>succ</code>ä»æŒ‡å‘<code>null</code>ï¼Œå‰é©±èŠ‚ç‚¹<code>pred</code>å¼•ç”¨<code>newNode:D</code>ï¼Œä¸ºé“¾è¡¨æœ«å°¾èŠ‚ç‚¹ï¼Œå°†<code>last</code>å¼•ç”¨ç½®ä¸º<code>pred</code>ã€‚</p><p>é›†åˆå¤§å°å¢åŠ äº†æ•°ç»„<code>a</code>çš„é•¿åº¦ä¸ªï¼›ä¿®æ”¹æ¬¡æ•°<code>modCount</code>å¢åŠ ã€‚</p><p>2ã€ ä»é“¾è¡¨ä¸­é—´æ’å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/jdk/linkedlistaddfrommid.gif" alt="ä»é“¾è¡¨ä¸­é—´æ’å…¥"></p><p>åˆå§‹æ¡ä»¶ä¸ºï¼š</p><ul><li>åˆå§‹é“¾è¡¨ä¸ºï¼š<code>[L,I,N,D]</code></li><li>æŒ‡å®šç´¢å¼•ä½ç½®ï¼š<code>indexï¼š3</code></li><li>å¾…æ’å…¥å…ƒç´ é›†åˆï¼š<code>collectionï¼š[K,E]</code></li><li>æ’å…¥ä½ç½®çš„å‰é©±èŠ‚ç‚¹ï¼š<code>predï¼šN</code></li><li>æ’å…¥ä½ç½®çš„åç»§èŠ‚ç‚¹ï¼š<code>succï¼šD</code></li></ul><p>æ’å…¥è¿‡ç¨‹ï¼š</p><p>è¿­ä»£å¼€å§‹ï¼š</p><ul><li>å¾…æ’å…¥é›†åˆè½¬æ•°ç»„ï¼š<code>aï¼š[K,E]</code></li><li>ç¬¬ä¸€æ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹<code>newNode</code>ï¼Œå€¼ä¸º<code>K</code>ï¼Œå‰é©±èŠ‚ç‚¹<code>pred</code>ä¸º<code>N</code>ï¼Œåç»§èŠ‚ç‚¹<code>succ</code>ä¸º<code>D</code>ï¼Œå°†Nçš„åç»§èŠ‚ç‚¹æŒ‡å‘<code>K</code>ï¼Œå°†å‰é©±èŠ‚ç‚¹<code>pred</code>å¼•ç”¨<code>newNode:K</code>ã€‚</li><li>ç¬¬äºŒæ¬¡è¿­ä»£ï¼šåˆ›å»ºæ–°èŠ‚ç‚¹<code>newNode</code>ï¼Œå€¼ä¸º<code>E</code>ï¼Œå‰é©±èŠ‚ç‚¹<code>pred</code>ä¸º<code>K</code>ï¼Œåç»§èŠ‚ç‚¹<code>succ</code>ä¸º<code>D</code>ï¼Œå°†<code>K</code>çš„åç»§èŠ‚ç‚¹æŒ‡å‘<code>E</code>ï¼Œ å°†å‰é©±èŠ‚ç‚¹<code>pred</code>å¼•ç”¨<code>newNode:E</code>ã€‚</li></ul><p>è¿­ä»£å®Œæˆã€‚</p><p>æ­¤æ—¶åç»§èŠ‚ç‚¹<code>succ</code>ä»æŒ‡å‘<code>D</code>ï¼Œå‰é©±èŠ‚ç‚¹<code>pred</code>å¼•ç”¨<code>newNode:E</code>ï¼Œ<code>last</code>å¼•ç”¨ä»æŒ‡å‘<code>D</code>ã€‚</p><p>å°†<code>pred</code>çš„åç»§èŠ‚ç‚¹æŒ‡å‘<code>D</code>ï¼Œå°†<code>D</code>çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘<code>E</code>ã€‚</p><p>é›†åˆå¤§å°å¢åŠ äº†æ•°ç»„<code>a</code>çš„é•¿åº¦ä¸ªï¼›ä¿®æ”¹æ¬¡æ•°<code>modCount</code>å¢åŠ ã€‚</p><h3 id="å†…éƒ¨æ–¹æ³•"><a href="#å†…éƒ¨æ–¹æ³•" class="headerlink" title="å†…éƒ¨æ–¹æ³•"></a>å†…éƒ¨æ–¹æ³•</h3><p><code>LinkedList</code>ç±»ä¸­æä¾›äº†ä¸€äº›é»˜è®¤æˆ–ç§æœ‰æ–¹æ³•ç”¨æ¥å°†ä¸€ä¸ªæŒ‡å®šå…ƒç´ è¿æ¥è‡³æ•´ä¸ªé“¾è¡¨ã€‚</p><h4 id="è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå¤´èŠ‚ç‚¹"><a href="#è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå¤´èŠ‚ç‚¹" class="headerlink" title="è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå¤´èŠ‚ç‚¹"></a><span id="linkFirst">è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå¤´èŠ‚ç‚¹</span></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">linkFirst</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è·å–é“¾è¡¨å¤´èŠ‚ç‚¹f</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå…¶æ•°æ®åŸŸä¸ºeï¼Œåç»§èŠ‚ç‚¹ä¸ºé“¾è¡¨å¤´èŠ‚ç‚¹fã€‚</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(<span class="keyword">null</span>, e, f);</span><br><span class="line">    <span class="comment">// é“¾è¡¨å¤´èŠ‚ç‚¹å¼•ç”¨æŒ‡å‘æ–°èŠ‚ç‚¹</span></span><br><span class="line">    first = newNode;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">// æ—§çš„å¤´èŠ‚ç‚¹ä¸ºnullï¼šåŸé“¾è¡¨ä¸ºç©ºé“¾è¡¨ã€‚å°†å°¾èŠ‚ç‚¹å¼•ç”¨lastä¹ŸæŒ‡å‘æ–°èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        last = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// æ—§çš„å¤´èŠ‚ç‚¹ä¸ä¸ºnullï¼šæ–°èŠ‚ç‚¹å°†ä½œä¸ºæ•´ä¸ªé“¾è¡¨çš„æ–°çš„å¤´èŠ‚ç‚¹ã€‚å°†æ—§çš„å¤´èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        f.prev = newNode;</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å¢åŠ </span></span><br><span class="line">    size++;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆé€šè¿‡å¤´èŠ‚ç‚¹å¼•ç”¨<code>first</code>è·å–å½“å‰é“¾è¡¨å¤´èŠ‚ç‚¹<code>f</code>ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„<code>Node</code>èŠ‚ç‚¹<code>newNode</code>ï¼Œå…¶æ•°æ®åŸŸä¸ºæŒ‡å®šå…ƒç´ <code>e</code>ï¼Œåç»§èŠ‚ç‚¹ä¸ºå½“å‰é“¾è¡¨å¤´èŠ‚ç‚¹<code>f</code>ï¼›</p><p>ç„¶åå°†å¤´èŠ‚ç‚¹å¼•ç”¨<code>first</code>æŒ‡å‘<code>newNode</code>ï¼Œåˆ¤æ–­æ—§çš„å¤´èŠ‚ç‚¹<code>f</code>æ˜¯å¦ä¸º<code>null</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™åŸé“¾è¡¨ä¸ºç©ºé“¾è¡¨ï¼Œå°†å°¾èŠ‚ç‚¹å¼•ç”¨<code>last</code>æŒ‡å‘<code>newNode</code>ï¼›å¦åˆ™ï¼Œå°†æ—§çš„å¤´èŠ‚ç‚¹<code>f</code>çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘<code>newNode</code>ã€‚</p><h4 id="è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå°¾èŠ‚ç‚¹"><a href="#è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå°¾èŠ‚ç‚¹" class="headerlink" title="è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå°¾èŠ‚ç‚¹"></a><span id="linkLast">è¿æ¥æŒ‡å®šå…ƒç´ ä½œä¸ºå°¾èŠ‚ç‚¹</span></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linkLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è·å–é“¾è¡¨å°¾èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå…¶æ•°æ®åŸŸä¸ºeï¼Œå‰é©±èŠ‚ç‚¹ä¸ºé“¾è¡¨å°¾èŠ‚ç‚¹l</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(l, e, <span class="keyword">null</span>);</span><br><span class="line">    <span class="comment">// é“¾è¡¨å°¾èŠ‚ç‚¹å¼•ç”¨æ‰§è¡Œæ–°èŠ‚ç‚¹</span></span><br><span class="line">    last = newNode;</span><br><span class="line">    <span class="keyword">if</span> (l == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">// æ—§çš„å°¾èŠ‚ç‚¹ä¸ºnullï¼šåŸé“¾è¡¨ä¸ºç©ºé“¾è¡¨ã€‚å°†å¤´èŠ‚ç‚¹å¼•ç”¨ä¹ŸæŒ‡å‘æ–°èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        first = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// æ—§çš„å°¾èŠ‚ç‚¹ä¸ä¸ºnullï¼šæ–°èŠ‚ç‚¹å°†ä½œä¸ºæ•´ä¸ªé“¾è¡¨çš„æ–°çš„å°¾èŠ‚ç‚¹ã€‚å°†æ—§çš„å°¾èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        l.next = newNode;</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å¢åŠ </span></span><br><span class="line">    size++;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆé€šè¿‡å°¾èŠ‚ç‚¹å¼•ç”¨<code>last</code>è·å–å½“å‰é“¾è¡¨å°¾èŠ‚ç‚¹<code>l</code>ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„<code>Node</code>èŠ‚ç‚¹<code>newNode</code>ï¼Œå…¶æ•°æ®åŸŸä¸ºæŒ‡å®šå…ƒç´ <code>e</code>ï¼Œå‰é©±èŠ‚ç‚¹ä¸ºå½“å‰é“¾è¡¨å°¾èŠ‚ç‚¹<code>l</code>ï¼›</p><p>ç„¶åå°†å°¾èŠ‚ç‚¹å¼•ç”¨<code>last</code>æŒ‡å‘<code>newNode</code>ï¼Œåˆ¤æ–­æ—§çš„å°¾èŠ‚ç‚¹<code>l</code>æ˜¯å¦ä¸º<code>null</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™åŸé“¾è¡¨ä¸ºç©ºé“¾è¡¨ï¼Œå°†å¤´èŠ‚ç‚¹å¼•ç”¨<code>first</code>æŒ‡å‘<code>newNode</code>ï¼›å¦åˆ™ï¼Œå°†æ—§çš„å°¾èŠ‚ç‚¹<code>l</code>çš„åç»§èŠ‚ç‚¹æŒ‡å‘<code>newNode</code>ã€‚</p><h4 id="åœ¨æŒ‡å®šèŠ‚ç‚¹ä¹‹å‰è¿æ¥æŒ‡å®šå…ƒç´ "><a href="#åœ¨æŒ‡å®šèŠ‚ç‚¹ä¹‹å‰è¿æ¥æŒ‡å®šå…ƒç´ " class="headerlink" title="åœ¨æŒ‡å®šèŠ‚ç‚¹ä¹‹å‰è¿æ¥æŒ‡å®šå…ƒç´ "></a><span id="linkBefore">åœ¨æŒ‡å®šèŠ‚ç‚¹ä¹‹å‰è¿æ¥æŒ‡å®šå…ƒç´ </span></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çº¦å®šæŒ‡å®šèŠ‚ç‚¹succä¸ä¸ºnull</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">linkBefore</span><span class="params">(E e, Node&lt;E&gt; succ)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert succ != null;</span></span><br><span class="line">    <span class="comment">// è·å–æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; pred = succ.prev;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå…¶æ•°æ®åŸŸä¸ºeï¼Œå‰é©±èŠ‚ç‚¹ä¸ºæŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ï¼Œåç»§èŠ‚ç‚¹ä¸ºæŒ‡å®šèŠ‚ç‚¹ã€‚</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> Node&lt;&gt;(pred, e, succ);</span><br><span class="line">    <span class="comment">// æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹</span></span><br><span class="line">    succ.prev = newNode;</span><br><span class="line">    <span class="keyword">if</span> (pred == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">// æŒ‡å®šèŠ‚ç‚¹çš„æ—§çš„å‰é©±èŠ‚ç‚¹ä¸ºnullï¼šæŒ‡å®šèŠ‚ç‚¹ä¸ºåŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚æ–°èŠ‚ç‚¹å°†ä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        first = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// æŒ‡å®šèŠ‚ç‚¹çš„æ—§çš„å‰é©±èŠ‚ç‚¹ä¸ä¸ºnullï¼šå°†æŒ‡å®šèŠ‚ç‚¹çš„æ—§çš„å‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        pred.next = newNode;</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å¢åŠ </span></span><br><span class="line">    size++;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¦å®šæŒ‡å®šèŠ‚ç‚¹<code>succ</code>éç©ºï¼Œå¦åˆ™å°†å¯¼è‡´<code>NPE</code>é—®é¢˜ã€‚</p><p>é¦–å…ˆè·å–æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹<code>pred</code>ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„<code>Node</code>èŠ‚ç‚¹<code>newNode</code>ï¼Œå…¶å‰é©±èŠ‚ç‚¹ä¸º<code>pred</code>ï¼Œæ•°æ®åŸŸä¸ºæŒ‡å®šå…ƒç´ <code>e</code>ï¼Œåç»§èŠ‚ç‚¹ä¸ºæŒ‡å®šèŠ‚ç‚¹<code>succ</code>ã€‚</p><p>å°†æŒ‡å®šèŠ‚ç‚¹<code>succ</code>çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘<code>newNode</code>ï¼Œåˆ¤æ–­æŒ‡å®šèŠ‚ç‚¹<code>succ</code>çš„æ—§çš„å‰é©±èŠ‚ç‚¹<code>pred</code>æ˜¯å¦ä¸º<code>null</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æŒ‡å®šèŠ‚ç‚¹<code>succ</code>ä¸ºåŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œå°†å¤´èŠ‚ç‚¹å¼•ç”¨<code>first</code>æŒ‡å‘<code>newNode</code>ï¼›å¦åˆ™ï¼Œå°†æ—§çš„å‰é©±èŠ‚ç‚¹<code>pred</code>çš„åç»§èŠ‚ç‚¹æŒ‡å‘<code>newNode</code>ã€‚</p><h4 id="å–æ¶ˆå¤´èŠ‚ç‚¹çš„è¿æ¥"><a href="#å–æ¶ˆå¤´èŠ‚ç‚¹çš„è¿æ¥" class="headerlink" title="å–æ¶ˆå¤´èŠ‚ç‚¹çš„è¿æ¥"></a>å–æ¶ˆå¤´èŠ‚ç‚¹çš„è¿æ¥</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çº¦å®šæŒ‡å®šèŠ‚ç‚¹fä¸ºé“¾è¡¨å¤´èŠ‚ç‚¹ä¸”ä¸ä¸ºnull</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> E <span class="title">unlinkFirst</span><span class="params">(Node&lt;E&gt; f)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert f == first &amp;&amp; f != null;</span></span><br><span class="line">    <span class="comment">// è·å–å¤´èŠ‚ç‚¹çš„å…ƒç´ å€¼</span></span><br><span class="line">    <span class="keyword">final</span> E element = f.item;</span><br><span class="line">    <span class="comment">// è·å–å¤´èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ï¼šå³å°†æˆä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; next = f.next;</span><br><span class="line">    <span class="comment">// å°†åŸå¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸå’Œåç»§èŠ‚ç‚¹ç½®ä¸ºnullã€‚è§£é™¤å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚</span></span><br><span class="line">    f.item = <span class="keyword">null</span>;</span><br><span class="line">    f.next = <span class="keyword">null</span>; <span class="comment">// help GC</span></span><br><span class="line">    <span class="comment">// å°†å¤´èŠ‚ç‚¹å¼•ç”¨æŒ‡å‘next</span></span><br><span class="line">    first = next;</span><br><span class="line">    <span class="keyword">if</span> (next == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">// nextä¸ºnullï¼šåŸé“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚å°†å°¾èŠ‚ç‚¹å¼•ç”¨ç½®ä¸ºnullã€‚</span></span><br><span class="line">        last = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// nextä¸ä¸ºnullï¼šå°†nextçš„å‰é©±èŠ‚ç‚¹ç½®ä¸ºnullã€‚å–æ¶ˆå¯¹åŸå¤´èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚</span></span><br><span class="line">        next.prev = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å‡å°‘</span></span><br><span class="line">    size--;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// è¿”å›è¢«å‰”é™¤çš„èŠ‚ç‚¹å…ƒç´ å€¼ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¦å®šæŒ‡å®šèŠ‚ç‚¹ä¸ºé“¾è¡¨çš„å¤´èŠ‚ç‚¹ä¸”éç©ºï¼Œå¦åˆ™å°†å¯¼è‡´<code>NPE</code>é—®é¢˜ã€‚</p><p>è·å–å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸå€¼<code>element</code>å’Œåç»§èŠ‚ç‚¹<code>next</code>ï¼Œå°†å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸå’Œåç»§èŠ‚ç‚¹ç½®ä¸º<code>null</code>ã€‚è§£é™¤å¯¹åŸå¯¹è±¡çš„å¼•ç”¨ï¼Œä¾¿äº<code>GC</code>æ¸…ç†ã€‚</p><p>ç„¶åå°†å¤´èŠ‚ç‚¹å¼•ç”¨<code>first</code>æŒ‡å‘<code>next</code>ï¼Œåˆ¤æ–­<code>next</code>æ˜¯å¦ä¸º<code>null</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™åŸé“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†å°¾èŠ‚ç‚¹å¼•ç”¨<code>last</code>ç½®ä¸º<code>null</code>ï¼›å¦åˆ™ï¼Œå°†<code>next</code>èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ç½®ä¸º<code>null</code>ï¼Œå–æ¶ˆå¯¹åŸé“¾è¡¨å¤´èŠ‚ç‚¹çš„å¼•ç”¨ã€‚</p><h4 id="å–æ¶ˆå°¾èŠ‚ç‚¹çš„è¿æ¥"><a href="#å–æ¶ˆå°¾èŠ‚ç‚¹çš„è¿æ¥" class="headerlink" title="å–æ¶ˆå°¾èŠ‚ç‚¹çš„è¿æ¥"></a><span id="unlinkLast">å–æ¶ˆå°¾èŠ‚ç‚¹çš„è¿æ¥</span></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çº¦å®šæŒ‡å®šèŠ‚ç‚¹lä¸ºé“¾è¡¨å°¾èŠ‚ç‚¹ä¸”ä¸ä¸ºnull</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> E <span class="title">unlinkLast</span><span class="params">(Node&lt;E&gt; l)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert l == last &amp;&amp; l != null;</span></span><br><span class="line">    <span class="comment">// è·å–å°¾èŠ‚ç‚¹çš„å…ƒç´ å€¼</span></span><br><span class="line">    <span class="keyword">final</span> E element = l.item;</span><br><span class="line">    <span class="comment">// è·å–å°¾èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ï¼šå³å°†æˆä¸ºæ–°çš„å°¾èŠ‚ç‚¹ã€‚</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; prev = l.prev;</span><br><span class="line">    <span class="comment">// å°†åŸå°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸå’Œå‰é©±èŠ‚ç‚¹ç½®ä¸ºnullã€‚è§£é™¤å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚</span></span><br><span class="line">    l.item = <span class="keyword">null</span>;</span><br><span class="line">    l.prev = <span class="keyword">null</span>; <span class="comment">// help GC</span></span><br><span class="line">    <span class="comment">// å°†å°¾èŠ‚ç‚¹å¼•ç”¨æŒ‡å‘prev</span></span><br><span class="line">    last = prev;</span><br><span class="line">    <span class="keyword">if</span> (prev == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">// prevä¸ºnullï¼šåŸé“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚å°†å¤´èŠ‚ç‚¹å¼•ç”¨ç½®ä¸ºnullã€‚</span></span><br><span class="line">        first = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// prevä¸ä¸ºnullï¼šå°†prevçš„åç»§èŠ‚ç‚¹ç½®ä¸ºnullã€‚å–æ¶ˆå¯¹åŸå°¾èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œä¾¿äºGCæ¸…ç†ã€‚</span></span><br><span class="line">        prev.next = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å‡å°‘</span></span><br><span class="line">    size--;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// è¿”å›è¢«å‰”é™¤çš„èŠ‚ç‚¹å…ƒç´ å€¼</span></span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¦å®šæŒ‡å®šèŠ‚ç‚¹ä¸ºé“¾è¡¨çš„å°¾èŠ‚ç‚¹ä¸”éç©ºï¼Œå¦åˆ™å°†å¯¼è‡´<code>NPE</code>é—®é¢˜ã€‚</p><p>è·å–å°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸå€¼<code>element</code>å’Œå‰é©±èŠ‚ç‚¹<code>prev</code>ï¼Œå°†å°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸå’Œå‰é©±èŠ‚ç‚¹ç½®ä¸º<code>null</code>ã€‚è§£é™¤å¯¹åŸå¯¹è±¡çš„å¼•ç”¨ï¼Œä¾¿äº<code>GC</code>æ¸…ç†ã€‚</p><p>ç„¶åå°†å°¾èŠ‚ç‚¹å¼•ç”¨<code>last</code>æŒ‡å‘<code>prev</code>ï¼Œåˆ¤æ–­<code>prev</code>æ˜¯å¦ä¸º<code>null</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™åŸé“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†å¤´èŠ‚ç‚¹å¼•ç”¨<code>first</code>ç½®ä¸º<code>null</code>ï¼›å¦åˆ™ï¼Œå°†<code>prev</code>èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ç½®ä¸º<code>null</code>ï¼Œå–æ¶ˆå¯¹åŸé“¾è¡¨å°¾èŠ‚ç‚¹çš„å¼•ç”¨ã€‚</p><h4 id="å–æ¶ˆæŒ‡å®šèŠ‚ç‚¹çš„è¿æ¥"><a href="#å–æ¶ˆæŒ‡å®šèŠ‚ç‚¹çš„è¿æ¥" class="headerlink" title="å–æ¶ˆæŒ‡å®šèŠ‚ç‚¹çš„è¿æ¥"></a><span id="unlink">å–æ¶ˆæŒ‡å®šèŠ‚ç‚¹çš„è¿æ¥</span></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çº¦å®šæŒ‡å®šèŠ‚ç‚¹xä¸ä¸ºnull</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">E <span class="title">unlink</span><span class="params">(Node&lt;E&gt; x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert x != null;</span></span><br><span class="line">    <span class="comment">// è·å–æŒ‡å®šèŠ‚ç‚¹xçš„æ•°æ®åŸŸå…ƒç´ </span></span><br><span class="line">    <span class="keyword">final</span> E element = x.item;</span><br><span class="line">    <span class="comment">// è·å–æŒ‡å®šèŠ‚ç‚¹xçš„åç»§èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; next = x.next;</span><br><span class="line">    <span class="comment">// è·å–æŒ‡å®šèŠ‚ç‚¹xçš„å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; prev = x.prev;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (prev == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ä¸ºnullï¼šæŒ‡å®šèŠ‚ç‚¹ä¸ºåŸé“¾è¡¨å¤´èŠ‚ç‚¹ã€‚æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹å°†ä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        first = next;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¦åˆ™ï¼Œå°†æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        prev.next = next;</span><br><span class="line">        <span class="comment">// æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ç½®ä¸ºnull</span></span><br><span class="line">        x.prev = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ä¸ºnullï¼šæŒ‡å®šèŠ‚ç‚¹ä¸ºåŸé“¾è¡¨å°¾èŠ‚ç‚¹ã€‚æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹å°†ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        last = prev;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¦åˆ™ï¼Œå°†æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘æŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        next.prev = prev;</span><br><span class="line">        <span class="comment">// æŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ç½®ä¸ºnull</span></span><br><span class="line">        x.next = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡å®šèŠ‚ç‚¹çš„æ•°æ®åŸŸå…ƒç´ ç½®ä¸ºnull</span></span><br><span class="line">    x.item = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// é›†åˆå¤§å°å‡å°‘</span></span><br><span class="line">    size--;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// è¿”å›è¢«å‰”é™¤çš„èŠ‚ç‚¹å…ƒç´ å€¼</span></span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¦å®šæŒ‡å®šèŠ‚ç‚¹<code>x</code>éç©ºï¼Œå¦åˆ™å°†å¯¼è‡´<code>NPE</code>é—®é¢˜ã€‚</p><p>åˆ†åˆ«è·å–æŒ‡å®šèŠ‚ç‚¹<code>x</code>çš„æ•°æ®åŸŸå…ƒç´ <code>element</code>ã€åç»§èŠ‚ç‚¹<code>next</code>å’Œå‰é©±èŠ‚ç‚¹<code>prev</code>ã€‚</p><p>å¦‚æœå‰é©±èŠ‚ç‚¹<code>prev</code>ä¸º<code>null</code>ï¼Œåˆ™åœ¨åŸé“¾è¡¨ä¸­ï¼ŒæŒ‡å®šèŠ‚ç‚¹<code>x</code>ä¸ºå¤´èŠ‚ç‚¹ï¼ŒæŒ‡å®šèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹<code>next</code>å°†ä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ï¼šå°†<code>first</code>å¼•ç”¨æŒ‡å‘åç»§èŠ‚ç‚¹<code>next</code>ï¼›å¦åˆ™å°†å‰é©±èŠ‚ç‚¹<code>prev</code>çš„åç»§èŠ‚ç‚¹æŒ‡å‘<code>next</code>ï¼Œå°†æŒ‡å®šå…ƒç´ <code>x</code>çš„å‰é©±èŠ‚ç‚¹ç½®ä¸º<code>null</code>ã€‚</p><p>å¦‚æœåç»§èŠ‚ç‚¹<code>next</code>ä¸º<code>null</code>ï¼Œåˆ™åœ¨åŸé“¾è¡¨ä¸­ï¼ŒæŒ‡å®šèŠ‚ç‚¹<code>x</code>ä¸ºå°¾èŠ‚ç‚¹ï¼ŒæŒ‡å®šèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹<code>prev</code>å°†ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ï¼šå°†<code>last</code>å¼•ç”¨æŒ‡å‘å‰é©±èŠ‚ç‚¹<code>prev</code>ï¼›å¦åˆ™å°†åç»§èŠ‚ç‚¹<code>next</code>çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘<code>prev</code>ï¼Œå°†æŒ‡å®šå…ƒç´ <code>x</code>çš„åç»§èŠ‚ç‚¹ç½®ä¸º<code>null</code>ã€‚</p><p>æœ€åå°†æŒ‡å®šèŠ‚ç‚¹<code>x</code>çš„æ•°æ®åŸŸç½®ä¸º<code>null</code>ï¼Œè§£é™¤å¯¹è±¡å¼•ç”¨ï¼Œä¾¿äº<code>GC</code>æ¸…ç†ã€‚</p><h4 id="è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„NodeèŠ‚ç‚¹"><a href="#è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„NodeèŠ‚ç‚¹" class="headerlink" title="è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„NodeèŠ‚ç‚¹"></a><span id="node">è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„<code>Node</code>èŠ‚ç‚¹</span></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çº¦å®šæŒ‡å®šç´¢å¼•åˆæ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Node&lt;E&gt; <span class="title">node</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// assert isElementIndex(index);</span></span><br><span class="line">    <span class="comment">// äºŒåˆ†æ³•</span></span><br><span class="line">    <span class="keyword">if</span> (index &lt; (size &gt;&gt; <span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šç´¢å¼•åœ¨[0,size/2)ä¹‹é—´</span></span><br><span class="line">        <span class="comment">// è·å–å¤´èŠ‚ç‚¹x</span></span><br><span class="line">        Node&lt;E&gt; x = first;</span><br><span class="line">        <span class="comment">// ä»0è¿­ä»£åˆ°indexï¼Œæ¯æ¬¡è¿­ä»£å°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; index; i++)</span><br><span class="line">            x = x.next;</span><br><span class="line">        <span class="comment">// è¿­ä»£å®Œæˆï¼Œxå³ä¸ºæŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šç´¢å¼•åœ¨[size/2,size]ä¹‹é—´</span></span><br><span class="line">        <span class="comment">// è·å–å°¾èŠ‚ç‚¹ </span></span><br><span class="line">        Node&lt;E&gt; x = last;</span><br><span class="line">        <span class="comment">// ä»size-1è¿­ä»£åˆ°indexï¼Œæ¯æ¬¡è¿­ä»£å°†xèµ‹å€¼ä¸ºxçš„å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = size - <span class="number">1</span>; i &gt; index; i--)</span><br><span class="line">            x = x.prev;</span><br><span class="line">        <span class="comment">// è¿­ä»£å®Œæˆï¼Œxå³ä¸ºæŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¦å®šæŒ‡å®šç´¢å¼•ä¸ä¼šäº§ç”Ÿè¶Šç•Œã€‚</p><p>é‡‡ç”¨äºŒåˆ†æ³•çš„æ€æƒ³ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ï¼Œå¦‚æœæŒ‡å®šç´¢å¼•<code>index</code>åœ¨<code>[0,size/2)</code>èŒƒå›´å†…ï¼Œåˆ™ä»<code>0</code>è¿­ä»£è‡³<code>index - 1</code>ï¼Œè¿­ä»£ä¹‹å‰è·å–å¤´èŠ‚ç‚¹<code>x</code>ï¼Œæ¯æ¬¡è¿­ä»£å°†<code>x</code>èµ‹å€¼ä¸º<code>x</code>çš„åç»§èŠ‚ç‚¹ï¼Œè¿­ä»£å®Œæˆæ—¶ï¼Œ<code>x</code>å³ä¸ºæŒ‡å®šç´¢å¼•<code>index</code>ä½ç½®çš„å…ƒç´ ï¼›å¦‚æœæŒ‡å®šç´¢å¼•<code>index</code>åœ¨[size/2,size)ä¹‹é—´ï¼Œåˆ™ä»<code>size - 1</code>è¿­ä»£è‡³<code>index + 1</code>ï¼Œè¿­ä»£ä¹‹å‰è·å–å°¾èŠ‚ç‚¹<code>x</code>ï¼Œæ¯æ¬¡è¿­ä»£å°†<code>x</code>èµ‹å€¼ä¸º<code>x</code>çš„å‰é©±èŠ‚ç‚¹ï¼Œè¿­ä»£å®Œæˆæ—¶ï¼Œ<code>x</code>å³ä¸ºæŒ‡å®šç´¢å¼•<code>index</code>ä½ç½®çš„å…ƒç´ ã€‚</p><h3 id="é›†åˆæ–¹æ³•"><a href="#é›†åˆæ–¹æ³•" class="headerlink" title="é›†åˆæ–¹æ³•"></a>é›†åˆæ–¹æ³•</h3><p><code>LinkedList</code>ç»§æ‰¿äº†<code>AbstractSequentialList</code>æœ‰åºé›†åˆé¡ºåºè®¿é—®æŠ½è±¡æ¨¡æ¿ç±»ã€‚å¯¹é›†åˆæ–¹æ³•è¿›è¡Œäº†å®ç°ï¼Œå¯ä»¥ä½œä¸ºé›†åˆä½¿ç”¨ã€‚</p><h4 id="æ·»åŠ æŒ‡å®šå…ƒç´ è‡³é›†åˆæœ«å°¾"><a href="#æ·»åŠ æŒ‡å®šå…ƒç´ è‡³é›†åˆæœ«å°¾" class="headerlink" title="æ·»åŠ æŒ‡å®šå…ƒç´ è‡³é›†åˆæœ«å°¾"></a><span id="add">æ·»åŠ æŒ‡å®šå…ƒç´ è‡³é›†åˆæœ«å°¾</span></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨å†…éƒ¨æ–¹æ³•linkLast(e)</span></span><br><span class="line">    linkLast(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•çš„æœ€åˆæ¥æºæ˜¯<code>Collection</code>æ¥å£ä¸­å®šä¹‰çš„<code>add(E e)</code>æ–¹æ³•ã€‚</p><blockquote><p><code>AbstractSequentialList</code>æŠ½è±¡ç±»ç»§æ‰¿äº†<code>AbstractList</code>æŠ½è±¡ç±»ï¼Œåœ¨<code>AbstractList</code>æŠ½è±¡ç±»ä¸­å·²ç»å®ç°äº†<code>add(E e)</code>æ–¹æ³•ã€‚å®ƒåªè¦æ±‚å­ç±»å»å®ç°<code>add(int index,E e)</code>æ–¹æ³•å³å¯å®ç°<code>add(E e)</code>ã€‚åœ¨<code>LinkedList</code>ç±»ä¸­å·²ç»æä¾›äº†<code>add(int index,E e)</code>æ–¹æ³•çš„å®ç°ï¼Œå®ƒä¸ºä»€ä¹ˆè¿˜è¦é‡å†™<code>add(E e)</code>æ–¹æ³•å‘¢ï¼Ÿ</p><p>ç†è§£ï¼š<code>LinkedList</code>ä½œä¸ºä¸€ä¸ªä¼˜ç§€çš„å®ç°ç±»ï¼Œå®ƒç»§æ‰¿/å®ç°äº†å¤šä¸ªæ¥å£ã€‚åœ¨ç¼–ç å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¾‹å¦‚ï¼š<code>List&lt;String&gt; list = new LinkedList&lt;&gt;()</code>ã€‚<code>LinkedList</code>ç±»çš„å¯¹è±¡ä¼šå‘ä¸Šè½¬å‹ä¸º<code>List</code>ç±»ã€‚å¯¹äºå®ä¾‹å¯¹è±¡<code>list</code>æ¥è¯´ï¼Œæ­¤æ—¶å®ƒæ˜¯ä¸€ä¸ª<code>List</code>ï¼Œå®ƒæ‰€å…·æœ‰çš„æ–¹æ³•æ˜¯<code>List</code>æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯<code>LinkedList</code>ç±»ä¸­çš„æ–¹æ³•ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è°ƒç”¨<code>list.add(E e)</code>æ—¶ï¼Œå®é™…ä¸Šè°ƒç”¨çš„æ˜¯<code>List</code>ç±»ä¸­å®šä¹‰çš„<code>add(E e)</code>æ–¹æ³•ï¼Œè€Œå®ƒçš„å®ç°æ˜¯åœ¨<code>LinkedList</code>ç±»ä¸­ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬æƒ³æŠŠ<code>LinkedList</code>ä½œä¸º<code>List</code>é›†åˆä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆï¼š<code>List&lt;String&gt; list = new LinkedList&lt;&gt;()</code>ã€‚è€Œå½“æˆ‘ä»¬æƒ³æŠŠ<code>LinkedList</code>å½“åš<code>Queue</code>é˜Ÿåˆ—ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆ<code>Queue&lt;String&gt; queue = new LinkedList&lt;&gt;()</code>ã€‚å®ƒå¯ä»¥å‘ä¸Šè½¬å‹æˆä»»æ„çš„çˆ¶æ¥å£ï¼ˆæˆ–çˆ¶æ¥å£çš„çˆ¶æ¥å£ï¼‰ï¼Œå‘ä¸Šè½¬å‹åï¼Œå®ä¾‹å¯¹è±¡åªæ‹¥æœ‰è½¬å‹åçš„æ¥å£ä¸­æ‰€å®šä¹‰çš„æ–¹æ³•ã€‚æ‰€ä»¥ï¼Œ<code>LinkedList</code>ç±»ä¸­å¯¹æ‰€æœ‰çˆ¶æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•éƒ½è¿›è¡Œäº†å®ç°ï¼Œä»¥ä¾¿å‘ä¸Šè½¬å‹ä½¿ç”¨ã€‚</p><p>è¿™ä½“ç°äº†<code>Java</code>çš„å¤šæ€æœºåˆ¶ã€‚</p></blockquote><p>ç›´æ¥è°ƒç”¨äº†å†…éƒ¨æ–¹æ³•<a href="#linkLast"><code>linkLast(e)</code></a>ï¼Œåœ¨ä¸å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹å›ºå®šè¿”å›<code>true</code>ã€‚</p><h4 id="åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ "><a href="#åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ " class="headerlink" title="åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ "></a>åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    checkPositionIndex(index);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (index == size)</span><br><span class="line">        <span class="comment">// æŒ‡å®šç´¢å¼•åœ¨é›†åˆæœ«å°¾ï¼šè°ƒç”¨å†…éƒ¨æ–¹æ³•è¿æ¥æŒ‡å®šå…ƒç´ è‡³é“¾è¡¨æœ«å°¾</span></span><br><span class="line">        linkLast(element);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment">// æŒ‡å®šç´¢å¼•åœ¨é›†åˆä¸­é—´ï¼šè°ƒç”¨å†…éƒ¨æ–¹æ³•è¿æ¥æŒ‡å®šå…ƒç´ è‡³æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ä¹‹å‰ã€‚</span></span><br><span class="line">        linkBefore(element, node(index));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œï¼Œç„¶ååˆ¤æ–­æŒ‡å®šç´¢å¼•æ˜¯å¦åœ¨é›†åˆæœ«å°¾ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æŒ‡å®šå…ƒç´ ä¸ºé“¾è¡¨çš„æ–°å°¾èŠ‚ç‚¹ï¼Œè°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#linkLast"><code>linkLast(e)</code></a>ï¼Œå°†æŒ‡å®šå…ƒç´ è¿æ¥è‡³é“¾è¡¨æœ«å°¾ï¼›å¦åˆ™ï¼Œè°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#linkBefore"><code>linkBefore(e,node)</code></a>å°†æŒ‡å®šå…ƒç´ è¿æ¥è‡³æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ä¹‹å‰ã€‚</p><h4 id="æ¸…ç©ºæ‰€æœ‰å…ƒç´ "><a href="#æ¸…ç©ºæ‰€æœ‰å…ƒç´ " class="headerlink" title="æ¸…ç©ºæ‰€æœ‰å…ƒç´ "></a>æ¸…ç©ºæ‰€æœ‰å…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Clearing all of the links between nodes is &quot;unnecessary&quot;, but:</span></span><br><span class="line">    <span class="comment">// - helps a generational GC if the discarded nodes inhabit</span></span><br><span class="line">    <span class="comment">//   more than one generation</span></span><br><span class="line">    <span class="comment">// - is sure to free memory even if there is a reachable Iterator</span></span><br><span class="line">    <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; ) &#123;</span><br><span class="line">        <span class="comment">// è¿­ä»£ï¼šåˆå§‹xä¸ºå¤´èŠ‚ç‚¹ï¼›è¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºï¼šxä¸ºnullã€‚</span></span><br><span class="line">        <span class="comment">// è·å–xçš„åç»§èŠ‚ç‚¹</span></span><br><span class="line">        Node&lt;E&gt; next = x.next;</span><br><span class="line">        <span class="comment">// å½“å‰xçš„æ•°æ®åŸŸã€åç»§èŠ‚ç‚¹å’Œå‰é©±èŠ‚ç‚¹éƒ½ç½®ä¸ºnull</span></span><br><span class="line">        x.item = <span class="keyword">null</span>;</span><br><span class="line">        x.next = <span class="keyword">null</span>;</span><br><span class="line">        x.prev = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">// xèµ‹å€¼ä¸ºå…¶åç»§èŠ‚ç‚¹ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ã€‚</span></span><br><span class="line">        x = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ¸…é™¤å¤´å°¾èŠ‚ç‚¹å¼•ç”¨</span></span><br><span class="line">    first = last = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// é‡ç½®é›†åˆå¤§å°</span></span><br><span class="line">    size = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿­ä»£é“¾è¡¨ï¼Œ<code>for</code>å¾ªç¯ä¸­è·å–åŸé“¾è¡¨å¤´èŠ‚ç‚¹<code>x</code>ï¼Œè¿­ä»£è¿‡ç¨‹ä¸­å¯¹<code>x</code>è¿›è¡Œé‡æ–°èµ‹å€¼ï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸º<code>x</code>ä¸º<code>null</code>ã€‚</p><p>æ¯æ¬¡è¿­ä»£å°†å½“å‰è¿­ä»£çš„èŠ‚ç‚¹<code>x</code>çš„æ•°æ®åŸŸã€åç»§èŠ‚ç‚¹å’Œå‰é©±èŠ‚ç‚¹éƒ½ç½®ä¸º<code>null</code>ï¼Œç„¶åå°†<code>x</code>èµ‹å€¼ä¸º<code>x</code>çš„åç»§èŠ‚ç‚¹ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ï¼Œç›´è‡³<code>x</code>ä¸ºå°¾èŠ‚ç‚¹ã€‚</p><p>è¿­ä»£å®Œæˆåæ¸…é™¤å¤´å°¾èŠ‚ç‚¹<code>first</code>å’Œ<code>last</code>çš„å¼•ç”¨ï¼Œé‡ç½®é›†åˆå¤§å°ä¸º<code>0</code>ã€‚</p><h4 id="è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®"><a href="#è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®" class="headerlink" title="è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®"></a>è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç´¢å¼•è®°å½•</span></span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ ä¸ºnull</span></span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next) &#123;</span><br><span class="line">            <span class="comment">// è¿­ä»£ï¼šè·å–é“¾è¡¨å¤´èŠ‚ç‚¹xï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºxä¸ºnullï¼Œæ¯æ¬¡è¿­ä»£å®Œæˆå°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment">// åˆ¤æ–­èŠ‚ç‚¹xçš„æ•°æ®åŸŸæ˜¯å¦ä¸ºnullï¼šæ˜¯åˆ™æ‰¾åˆ°äº†æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œè¿”å›ç´¢å¼•è®°å½•indexï¼›å¦åˆ™ï¼Œç´¢å¼•å¢ä¸€ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (x.item == <span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">return</span> index;</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ ä¸ä¸ºnullï¼Œé‡‡ç”¨equalsæ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next) &#123;</span><br><span class="line">            <span class="comment">// è¿­ä»£çš„æ¡ä»¶åŒæŒ‡å®šå…ƒç´ ä¸ºnullçš„æƒ…å†µ</span></span><br><span class="line">            <span class="keyword">if</span> (o.equals(x.item))</span><br><span class="line">                <span class="keyword">return</span> index;</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿­ä»£å®Œæˆä»æœªè¿”å›ï¼šé›†åˆä¸­ä¸å­˜åœ¨æŒ‡å®šå…ƒç´ ï¼Œè¿”å›-1ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç´¢å¼•è®°å½•<code>index</code>åˆå§‹ä¸º<code>0</code>ï¼Œç„¶åè¿­ä»£é“¾è¡¨ï¼Œåˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸º<code>null</code>å’Œé<code>null</code>ä¸¤ç§æƒ…å†µï¼Œä¸º<code>null</code>åˆ™é‡‡ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒï¼›é<code>null</code>åˆ™é‡‡ç”¨<code>equals</code>æ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚ä»é“¾è¡¨å¤´èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œä¸€æ—¦æ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ ï¼Œåˆ™è¿”å›ç´¢å¼•<code>index</code>ï¼Œå¦åˆ™ç´¢å¼•å¢ä¸€ã€‚å¦‚æœè¿­ä»£å®Œæˆä»æœªæ‰¾åˆ°æŒ‡å®šå…ƒç´ ï¼Œåˆ™è¿”å›<code>-1</code>ã€‚</p><h4 id="è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®"><a href="#è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®" class="headerlink" title="è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®"></a>è·å–æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lastIndexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç´¢å¼•è®°å½•åˆå§‹ä¸ºé›†åˆå¤§å°size</span></span><br><span class="line">    <span class="keyword">int</span> index = size;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ ä¸ºnullï¼Œé‡‡ç”¨==è¿ç®—ç¬¦æ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = last; x != <span class="keyword">null</span>; x = x.prev) &#123;</span><br><span class="line">            <span class="comment">// è¿­ä»£ï¼šè·å–é“¾è¡¨å°¾èŠ‚ç‚¹xï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºxä¸ºnullï¼Œæ¯æ¬¡è¿­ä»£åå°†xèµ‹å€¼ä¸ºxçš„å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment">// é¦–å…ˆç´¢å¼•è®°å½•å‡ä¸€</span></span><br><span class="line">            index--;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­èŠ‚ç‚¹xçš„æ•°æ®åŸŸæ˜¯å¦ä¸ºnullï¼šæ˜¯åˆ™æ‰¾åˆ°äº†æŒ‡å®šå…ƒç´ çš„æœ€åä¸€æ¬¡å‡ºç°ï¼Œè¿”å›ç´¢å¼•è®°å½•indexï¼›å¦åˆ™ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (x.item == <span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">return</span> index;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ ä¸ä¸ºnullï¼Œé‡‡ç”¨equalsæ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = last; x != <span class="keyword">null</span>; x = x.prev) &#123;</span><br><span class="line">            <span class="comment">// è¿­ä»£çš„æ¡ä»¶åŒæŒ‡å®šå…ƒç´ ä¸ºnullçš„æƒ…å†µ</span></span><br><span class="line">            index--;</span><br><span class="line">            <span class="keyword">if</span> (o.equals(x.item))</span><br><span class="line">                <span class="keyword">return</span> index;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿­ä»£å®Œæˆä»æœªè¿”å›ï¼šé›†åˆä¸­ä¸å­˜åœ¨æŒ‡å®šå…ƒç´ ï¼Œè¿”å›-1ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç´¢å¼•è®°å½•<code>index</code>åˆå§‹ä¸ºé›†åˆå¤§å°<code>size</code>ï¼Œç„¶åè¿­ä»£é“¾è¡¨ï¼Œåˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸º<code>null</code>å’Œé<code>null</code>ä¸¤ç§æƒ…å†µï¼Œä¸º<code>null</code>åˆ™é‡‡ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒï¼›é<code>null</code>åˆ™é‡‡ç”¨<code>equals</code>æ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚ä»é“¾è¡¨å°¾èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œè¿­ä»£ä¸€å¼€å§‹å°±å°†ç´¢å¼•è®°å½•å‡ä¸€ï¼Œç„¶åè¿›è¡Œç›¸ç­‰æ¯”è¾ƒï¼Œä¸€æ—¦æ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ ï¼Œåˆ™è¿”å›ç´¢å¼•<code>index</code>ï¼Œå¦åˆ™è¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ã€‚å¦‚æœè¿­ä»£å®Œæˆä»æœªæ‰¾åˆ°æŒ‡å®šå…ƒç´ ï¼Œåˆ™è¿”å›<code>-1</code>ã€‚</p><h4 id="åˆ¤æ–­æŒ‡å®šå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­è‡³å°‘å‡ºç°ä¸€æ¬¡"><a href="#åˆ¤æ–­æŒ‡å®šå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­è‡³å°‘å‡ºç°ä¸€æ¬¡" class="headerlink" title="åˆ¤æ–­æŒ‡å®šå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­è‡³å°‘å‡ºç°ä¸€æ¬¡"></a>åˆ¤æ–­æŒ‡å®šå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­è‡³å°‘å‡ºç°ä¸€æ¬¡</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> indexOf(o) != -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šè°ƒç”¨çš„æ˜¯<code>indexOf</code>æ–¹æ³•å¯»æ‰¾æŒ‡å®šå…ƒç´ çš„ç´¢å¼•ä½ç½®ï¼Œå¦‚æœè¿”å›<code>-1</code>åˆ™é›†åˆä¸­ä¸å­˜åœ¨è¯¥æŒ‡å®šå…ƒç´ ï¼Œå¦åˆ™è¡¨ç¤ºæŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­è‡³å°‘å‡ºç°è¿‡ä¸€æ¬¡ã€‚</p><h4 id="è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "><a href="#è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ " class="headerlink" title="è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "></a>è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    checkElementIndex(index);</span><br><span class="line">    <span class="comment">// è°ƒç”¨å†…éƒ¨æ–¹æ³•node(index)è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ï¼Œå–å‡ºæ•°æ®åŸŸitemè¿”å›ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> node(index).item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œï¼Œç„¶åè°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#node"><code>node(index)</code></a>è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ï¼Œå–å‡ºå…¶æ•°æ®åŸŸ<code>item</code>è¿”å›ã€‚</p><h4 id="å‰”é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "><a href="#å‰”é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ " class="headerlink" title="å‰”é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "></a><span id="remove">å‰”é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ </span></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    checkElementIndex(index);</span><br><span class="line">    <span class="comment">// è°ƒç”¨å†…éƒ¨æ–¹æ³•nodeè·å–æŒ‡å®šç´¢å¼•ä½ç½®èŠ‚ç‚¹ï¼Œå†è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkå–æ¶ˆæ­¤èŠ‚ç‚¹çš„è¿æ¥</span></span><br><span class="line">    <span class="keyword">return</span> unlink(node(index));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œï¼Œç„¶åè°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#node"><code>node(index)</code></a>è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹ï¼Œæœ€åè°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#unlink"><code>unlink(node)</code></a>å–æ¶ˆæ­¤èŠ‚ç‚¹çš„è¿æ¥ã€‚</p><h4 id="å‰”é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°"><a href="#å‰”é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°" class="headerlink" title="å‰”é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°"></a><span id="remove">å‰”é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°</span></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ ä¸ºnullï¼šä»å¤´èŠ‚ç‚¹xå¼€å§‹è¿­ä»£ï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºxä¸ºnullï¼Œæ¯æ¬¡è¿­ä»£å°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x.item == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœæ‰¾åˆ°äº†nullå…ƒç´ ï¼Œåˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkå‰”é™¤xå…ƒç´ çš„è¿æ¥ã€‚</span></span><br><span class="line">                unlink(x);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ énull</span></span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next) &#123;</span><br><span class="line">            <span class="comment">// è¿­ä»£çš„æ¡ä»¶åŒæŒ‡å®šå…ƒç´ ä¸ºnullçš„æƒ…å†µï¼Œä½¿ç”¨equalsæ¯”è¾ƒå½“å‰è¿­ä»£å…ƒç´ xä¸æŒ‡å®šå…ƒç´ æ˜¯å¦ç›¸ç­‰ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (o.equals(x.item)) &#123;</span><br><span class="line">                unlink(x);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿­ä»£å®Œæˆéƒ½æœªè¿”å›ï¼Œåˆ™é›†åˆä¸­æ— è¯¥å…ƒç´ ï¼Œè¿”å›falseã€‚</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿­ä»£é“¾è¡¨ï¼Œåˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸º<code>null</code>å’Œé<code>null</code>ä¸¤ç§æƒ…å†µï¼Œä¸º<code>null</code>é‡‡ç”¨<code>==</code>è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œé<code>null</code>åˆ™é‡‡ç”¨<code>equals</code>æ–¹æ³•æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚ä»é“¾è¡¨å¤´èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œä¸€æ—¦æ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ ï¼Œåˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#unlink"><code>unlink(node)</code></a>å–æ¶ˆè¯¥èŠ‚ç‚¹çš„è¿æ¥ï¼Œè¿”å›<code>true</code>ã€‚å¦‚æœè¿­ä»£å®Œæˆæ—¶éƒ½æœªæ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ ï¼Œåˆ™è¿”å›<code>false</code>ã€‚</p><h4 id="è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "><a href="#è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ " class="headerlink" title="è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "></a>è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    checkElementIndex(index);</span><br><span class="line">    <span class="comment">// è·å–æŒ‡å®šç´¢å¼•ä½ç½®èŠ‚ç‚¹x</span></span><br><span class="line">    Node&lt;E&gt; x = node(index);</span><br><span class="line">    <span class="comment">// å–å‡ºxçš„æ•°æ®åŸŸ</span></span><br><span class="line">    E oldVal = x.item;</span><br><span class="line">    <span class="comment">// ç»™xçš„æ•°æ®åŸŸèµ‹å€¼ä¸ºæŒ‡å®šå…ƒç´ </span></span><br><span class="line">    x.item = element;</span><br><span class="line">    <span class="comment">// è¿”å›xèŠ‚ç‚¹æ—§çš„æ•°æ®åŸŸ</span></span><br><span class="line">    <span class="keyword">return</span> oldVal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ ¡éªŒæŒ‡å®šç´¢å¼•æ˜¯å¦è¶Šç•Œï¼Œç„¶åè°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#node"><code>node(index)</code></a>è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹<code>x</code>ï¼Œå–å‡ºèŠ‚ç‚¹<code>x</code>çš„æ•°æ®åŸŸï¼Œç„¶åä¸º<code>x</code>çš„æ•°æ®åŸŸé‡æ–°èµ‹å€¼ä¸ºæŒ‡å®šå…ƒç´ ï¼Œæœ€åè¿”å›èŠ‚ç‚¹<code>x</code>æ—§çš„æ•°æ®åŸŸã€‚</p><h4 id="è·å–é›†åˆä¸­å…ƒç´ ä¸ªæ•°"><a href="#è·å–é›†åˆä¸­å…ƒç´ ä¸ªæ•°" class="headerlink" title="è·å–é›†åˆä¸­å…ƒç´ ä¸ªæ•°"></a>è·å–é›†åˆä¸­å…ƒç´ ä¸ªæ•°</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è¿”å›<code>size</code>æˆå‘˜å˜é‡ã€‚</p><h4 id="è½¬æ¢æˆObjectæ•°ç»„"><a href="#è½¬æ¢æˆObjectæ•°ç»„" class="headerlink" title="è½¬æ¢æˆObjectæ•°ç»„"></a>è½¬æ¢æˆ<code>Object</code>æ•°ç»„</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object[] toArray() &#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰sizeé•¿åº¦çš„æ•°ç»„</span></span><br><span class="line">    Object[] result = <span class="keyword">new</span> Object[size];</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ä»å¤´èŠ‚ç‚¹xå¼€å§‹è¿­ä»£ï¼Œè¿­ä»£ç»“æŸçš„æ¡ä»¶ä¸ºx=nullï¼Œæ¯æ¬¡è¿­ä»£å®Œæˆå°†xèµ‹å€¼ä¸ºxçš„åç»§èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next)</span><br><span class="line">        <span class="comment">// å¡«å……æ•°ç»„</span></span><br><span class="line">        result[i++] = x.item;</span><br><span class="line">    <span class="comment">// è¿”å›æ•°ç»„</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ª<code>size</code>é•¿åº¦çš„<code>Object</code>æ•°ç»„ï¼Œç„¶åä»é“¾è¡¨å¤´èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œæ¯æ¬¡è¿­ä»£å‘<code>Object</code>æ•°ç»„ä¸­å¡«å……ä¸€ä¸ªå…ƒç´ ï¼Œè¿­ä»£å®Œæˆæ—¶æ•°ç»„ä¸­çš„å…ƒç´ å³ä¸ºé“¾è¡¨ä¸­çš„å…¨éƒ¨å…ƒç´ ï¼Œæœ€åè¿”å›æ•°ç»„ã€‚</p><h4 id="è½¬æ¢æˆæŒ‡å®šç±»å‹æ•°ç»„"><a href="#è½¬æ¢æˆæŒ‡å®šç±»å‹æ•°ç»„" class="headerlink" title="è½¬æ¢æˆæŒ‡å®šç±»å‹æ•°ç»„"></a>è½¬æ¢æˆæŒ‡å®šç±»å‹æ•°ç»„</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; T[] toArray(T[] a) &#123;</span><br><span class="line">    <span class="comment">// æŒ‡å®šæ•°ç»„é•¿åº¦æ˜¯å¦å°äºé“¾è¡¨é•¿åº¦</span></span><br><span class="line">    <span class="keyword">if</span> (a.length &lt; size)</span><br><span class="line">        <span class="comment">// å°äºï¼šé‡æ–°åˆ†é…ä¸€ä¸ªsizeé•¿åº¦æ•°ç»„</span></span><br><span class="line">        a = (T[])java.lang.reflect.Array.newInstance(</span><br><span class="line">                            a.getClass().getComponentType(), size);</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// è¿”å›æ•°ç»„å®¹å™¨</span></span><br><span class="line">    Object[] result = a;</span><br><span class="line">    <span class="comment">// è¿­ä»£é“¾è¡¨ï¼Œå¡«å……å…ƒç´ ã€‚</span></span><br><span class="line">    <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next)</span><br><span class="line">        result[i++] = x.item;</span><br><span class="line">    <span class="comment">// è¿­ä»£å®Œæˆï¼Œå¦‚æœæŒ‡å®šæ•°ç»„çš„é•¿åº¦å¤§äºé“¾è¡¨é•¿åº¦ï¼Œåˆ™å°†è¿”å›æ•°ç»„å®¹å™¨ä¸­sizeç´¢å¼•ä½ç½®çš„å…ƒç´ ç½®ä¸ºnull</span></span><br><span class="line">    <span class="comment">// nullå…ƒç´ ä¹‹å‰ä¸ºåŸé“¾è¡¨å…ƒç´ ï¼Œnullå…ƒç´ ä¹‹åä¸ºåŸæŒ‡å®šæ•°ç»„å…ƒç´ ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (a.length &gt; size)</span><br><span class="line">        a[size] = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// æ•°ç»„è¿”å›ã€‚æ­¤æ—¶æ•°ç»„ä¸­å…ƒç´ ç±»å‹å·²ç”±Objectå¼ºè½¬æˆæ³›å‹T</span></span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¥å‚ä¸ºæ³›å‹æ•°ç»„<code>a</code>ï¼Œåˆ¤æ–­å…¥å‚æ•°ç»„é•¿åº¦æ˜¯å¦å°äºé“¾è¡¨é•¿åº¦ï¼Œå°äºåˆ™é‡æ–°åˆ†é…ä¸€ä¸ªé“¾è¡¨é•¿åº¦<code>size</code>å¤§å°çš„æ•°ç»„ç©ºé—´ã€‚è¿­ä»£é“¾è¡¨ï¼Œå°†å…ƒç´ å¡«å……è‡³æ•°ç»„ï¼Œè¿­ä»£å®Œæˆæ—¶ï¼Œå¦‚æœæ˜¯é‡æ–°åˆ†é…çš„æ•°ç»„ç©ºé—´ï¼Œåˆ™æ•°ç»„ä¸­çš„å…ƒç´ æ°å¥½å…¨éƒ¨ä¸ºé“¾è¡¨ä¸­çš„å…ƒç´ ï¼›å¦åˆ™æ•°ç»„ä¸­çš„å…ƒç´ å¤šäºé“¾è¡¨ä¸­çš„å…ƒç´ ï¼Œå°†<code>size</code>ç´¢å¼•ä½ç½®çš„å…ƒç´ ç½®ä¸º<code>null</code>ï¼Œæ­¤æ—¶ï¼Œ<code>null</code>å…ƒç´ ä¹‹å‰ä¸ºåŸé“¾è¡¨å…ƒç´ ï¼Œä¹‹åä¸ºåŸå…¥å‚æ•°ç»„å…ƒç´ ã€‚æœ€åè¿”å›å°†<code>Object</code>æ•°ç»„å¼ºè½¬æˆæ³›å‹æ•°ç»„ã€‚</p><p>æ­¤æ–¹æ³•å¯ç”¨äºå°†é›†åˆä¸­çš„å…ƒç´ ç±»å‹è½¬æ¢ä¸ºæŒ‡å®šç±»å‹å¹¶è½¬æ¢æˆæ•°ç»„ã€‚</p><h3 id="åŒç«¯é˜Ÿåˆ—æ–¹æ³•"><a href="#åŒç«¯é˜Ÿåˆ—æ–¹æ³•" class="headerlink" title="åŒç«¯é˜Ÿåˆ—æ–¹æ³•"></a>åŒç«¯é˜Ÿåˆ—æ–¹æ³•</h3><p><code>LinkedList</code>å®ç°äº†<code>Deque</code>åŒç«¯é˜Ÿåˆ—æ¥å£ï¼Œæä¾›äº†åŒç«¯é˜Ÿåˆ—çš„åŸºæœ¬å®ç°ã€‚</p><h4 id="å…¥é˜Ÿåˆ—"><a href="#å…¥é˜Ÿåˆ—" class="headerlink" title="å…¥é˜Ÿåˆ—"></a>å…¥é˜Ÿåˆ—</h4><h5 id="å…¥é˜Ÿé¦–"><a href="#å…¥é˜Ÿé¦–" class="headerlink" title="å…¥é˜Ÿé¦–"></a>å…¥é˜Ÿé¦–</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFirst</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    linkFirst(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#linkFirst"><code>linkFirst(e)</code></a>è¿æ¥æŒ‡å®šå…ƒç´ <code>e</code>ä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">offerFirst</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    addFirst(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯è°ƒç”¨äº†å†…éƒ¨æ–¹æ³•<a href="#linkFirst"><code>linkFirst(e)</code></a>è¿æ¥æŒ‡å®šå…ƒç´ <code>e</code>ä½œä¸ºæ–°çš„å¤´èŠ‚ç‚¹ã€‚ç„¶åè¿”å›ç‰¹æ®Šå€¼<code>true</code>ã€‚</p><h5 id="å…¥é˜Ÿå°¾"><a href="#å…¥é˜Ÿå°¾" class="headerlink" title="å…¥é˜Ÿå°¾"></a>å…¥é˜Ÿå°¾</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    linkLast(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#linkLast"><code>linkLast(e)</code></a>è¿æ¥æŒ‡å®šå…ƒç´ <code>e</code>ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">offerLast</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    addLast(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯è°ƒç”¨äº†å†…éƒ¨æ–¹æ³•<a href="#linkLast"><code>linkLast(e)</code></a>è¿æ¥æŒ‡å®šå…ƒç´ <code>e</code>ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ã€‚ç„¶åè¿”å›ç‰¹æ®Šå€¼<code>true</code>ã€‚</p><h4 id="å‡ºé˜Ÿåˆ—"><a href="#å‡ºé˜Ÿåˆ—" class="headerlink" title="å‡ºé˜Ÿåˆ—"></a>å‡ºé˜Ÿåˆ—</h4><h5 id="ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—"><a href="#ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—" class="headerlink" title="ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—"></a>ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">removeFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    <span class="keyword">return</span> unlinkFirst(f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼ŒæŠ›å‡º<code>NoSuchElementException</code>å¼‚å¸¸ã€‚</p><p>å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#unlinkFirst"><code>unlinkFirst(e)</code></a>å‰”é™¤å¤´èŠ‚ç‚¹çš„è¿æ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">pollFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">return</span> (f == <span class="keyword">null</span>) ? <span class="keyword">null</span> : unlinkFirst(f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›<code>null</code>ï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#unlinkFirst"><code>unlinkFirst(e)</code></a>å‰”é™¤å¤´èŠ‚ç‚¹çš„è¿æ¥ã€‚</p><p>æ­¤å®ç°ç¬¦åˆ<code>Deque</code>æ¥å£ä¸­çš„å®šä¹‰ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶ï¼Œ<code>removeFirst()</code>æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ<code>pollFirst()</code>æ–¹æ³•è¿”å›ç‰¹æ®Šå€¼<code>null</code>ã€‚</p><h5 id="ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—"><a href="#ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—" class="headerlink" title="ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—"></a>ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">removeLast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last;</span><br><span class="line">    <span class="keyword">if</span> (l == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    <span class="keyword">return</span> unlinkLast(l);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè·å–é“¾è¡¨å°¾èŠ‚ç‚¹ï¼Œå¦‚æœå°¾èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼ŒæŠ›å‡º<code>NoSuchElementException</code>å¼‚å¸¸ã€‚</p><p>å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#unlinkLast"><code>unlinkLast(e)</code></a>å‰”é™¤å°¾èŠ‚ç‚¹çš„è¿æ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">pollLast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last;</span><br><span class="line">    <span class="keyword">return</span> (l == <span class="keyword">null</span>) ? <span class="keyword">null</span> : unlinkLast(l);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯å…ˆè·å–é“¾è¡¨å°¾èŠ‚ç‚¹ï¼Œå¦‚æœå°¾èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›<code>null</code>ï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#unlinkLast"><code>unlinkLast(e)</code></a>å‰”é™¤å°¾èŠ‚ç‚¹çš„è¿æ¥ã€‚</p><p>æ­¤å®ç°ä¹Ÿç¬¦åˆ<code>Deque</code>æ¥å£ä¸­çš„å®šä¹‰ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶ï¼Œ<code>removeLast()</code>æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ<code>pollLast()</code>æ–¹æ³•è¿”å›ç‰¹æ®Šå€¼<code>null</code>ã€‚</p><h5 id="æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ "><a href="#æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ " class="headerlink" title="æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ "></a><span id="getFirst">æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ </span></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">getFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    <span class="keyword">return</span> f.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼ŒæŠ›å‡º<code>NoSuchElementException</code>å¼‚å¸¸ã€‚å¦åˆ™è¿”å›å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">peekFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">return</span> (f == <span class="keyword">null</span>) ? <span class="keyword">null</span> : f.item;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›<code>null</code>ï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›å¦åˆ™è¿”å›å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚</p><p>æ­¤å®ç°ä¹Ÿç¬¦åˆ<code>Deque</code>æ¥å£ä¸­çš„å®šä¹‰ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶ï¼Œ<code>getFirst()</code>æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ<code>peekFirst()</code>æ–¹æ³•è¿”å›ç‰¹æ®Šå€¼<code>null</code>ã€‚</p><h5 id="æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ "><a href="#æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ " class="headerlink" title="æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ "></a>æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">getLast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last;</span><br><span class="line">    <span class="keyword">if</span> (l == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    <span class="keyword">return</span> l.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè·å–é“¾è¡¨å°¾èŠ‚ç‚¹ï¼Œå¦‚æœå°¾èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼ŒæŠ›å‡º<code>NoSuchElementException</code>å¼‚å¸¸ã€‚å¦åˆ™è¿”å›å°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">peekLast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last;</span><br><span class="line">    <span class="keyword">return</span> (l == <span class="keyword">null</span>) ? <span class="keyword">null</span> : l.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯å…ˆè·å–é“¾è¡¨å°¾èŠ‚ç‚¹ï¼Œå¦‚æœå°¾èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›<code>null</code>ï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼›å¦åˆ™è¿”å›å°¾èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚</p><p>æ­¤å®ç°ä¹Ÿç¬¦åˆ<code>Deque</code>æ¥å£ä¸­çš„å®šä¹‰ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶ï¼Œ<code>getLast()</code>æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ<code>peekLast()</code>æ–¹æ³•è¿”å›ç‰¹æ®Šå€¼<code>null</code>ã€‚</p><h5 id="åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ "><a href="#åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ " class="headerlink" title="åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ "></a>åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeFirstOccurrence</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> remove(o);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è°ƒç”¨é›†åˆæ–¹æ³•<a href="#remove"><code>remove(o)</code></a>å‰”é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€æ¬¡å‡ºç°ã€‚</p><h5 id="åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ "><a href="#åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ " class="headerlink" title="åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ "></a>åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeLastOccurrence</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ ä¸ºnull</span></span><br><span class="line">        <span class="comment">// ä»å°¾èŠ‚ç‚¹å¼€å§‹è¿­ä»£é“¾è¡¨ï¼Œä¸€æ—¦æ‰¾åˆ°æ•°æ®åŸŸä¸ºnullçš„èŠ‚ç‚¹ï¼Œåˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•unlinkå‰”é™¤è¯¥èŠ‚ç‚¹çš„è¿æ¥ã€‚</span></span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = last; x != <span class="keyword">null</span>; x = x.prev) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x.item == <span class="keyword">null</span>) &#123;</span><br><span class="line">                unlink(x);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šå…ƒç´ énullï¼Œä½¿ç”¨equalsæ¯”è¾ƒå…ƒç´ æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">        <span class="comment">// è¿­ä»£çš„æ¡ä»¶åŒæŒ‡å®šå…ƒç´ ä¸ºnullçš„æƒ…å†µ</span></span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = last; x != <span class="keyword">null</span>; x = x.prev) &#123;</span><br><span class="line">            <span class="keyword">if</span> (o.equals(x.item)) &#123;</span><br><span class="line">                unlink(x);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿­ä»£å®Œæˆä»æœªæ‰¾åˆ°ï¼Œè¿”å›falseã€‚</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸º<code>null</code>å’Œé<code>null</code>ä¸¤ç§æƒ…å†µï¼Œä¸º<code>null</code>é‡‡ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒï¼Œé<code>null</code>é‡‡ç”¨<code>equals</code>æ–¹æ³•æ¯”è¾ƒã€‚ä»å°¾èŠ‚ç‚¹å¼€å§‹è¿­ä»£ï¼Œä¸€æ—¦æ‰¾åˆ°æ•°æ®åŸŸä¸æŒ‡å®šå…ƒç´ ç›¸ç­‰çš„èŠ‚ç‚¹ï¼Œåˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#unlink"><code>unlink</code></a>å‰”é™¤è¯¥èŠ‚ç‚¹çš„è¿æ¥ã€‚</p><h3 id="æ™®é€šé˜Ÿåˆ—æ–¹æ³•"><a href="#æ™®é€šé˜Ÿåˆ—æ–¹æ³•" class="headerlink" title="æ™®é€šé˜Ÿåˆ—æ–¹æ³•"></a>æ™®é€šé˜Ÿåˆ—æ–¹æ³•</h3><p><code>Deque</code>åŒç«¯é˜Ÿåˆ—æ¥å£ä¸­åŒæ ·å£°æ˜äº†æ™®é€šé˜Ÿåˆ—<code>Queue</code>æ¥å£ä¸­å®šä¹‰çš„ä¸€ç³»åˆ—æ–¹æ³•ã€‚<code>LinkedList</code>ç±»ä¹Ÿå¯¹å…¶è¿›è¡Œäº†å®ç°ã€‚</p><p><code>Queue</code>æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">action</th><th align="left">throws exception</th><th align="left">returns special value</th></tr></thead><tbody><tr><td align="left">insert</td><td align="left">add(e)</td><td align="left">offer(e)</td></tr><tr><td align="left">remove</td><td align="left">remove()</td><td align="left">poll()</td></tr><tr><td align="left">get head</td><td align="left">element()</td><td align="left">peek()</td></tr></tbody></table><p>å®ƒæœ‰ä¸‰ç»„å…±å…­ä¸ªæ–¹æ³•ï¼Œåœ¨<code>Queue</code>æ¥å£çš„å£°æ˜ä¸­çº¦å®šäº†æ¯ç»„æ–¹æ³•ä¸­æœ‰ä¸€ä¸ªæ˜¯å¤±è´¥æ—¶æŠ›å‡ºæŒ‡å®šå¼‚å¸¸ï¼Œå¦ä¸€ä¸ªæ˜¯è¿”å›ç‰¹æ®Šå€¼<code>null</code>æˆ–<code>false</code>ã€‚</p><p><code>LinkedList</code>ç±»å´æ²¡æœ‰å®Œå…¨éµå®ˆ<code>Queue</code>æ¥å£çš„çº¦å®šï¼Œæ‰€æœ‰æ–¹æ³•åœ¨æ‰§è¡Œå¤±è´¥æ—¶å‡æœªæŠ›å‡ºæŒ‡å®šå¼‚å¸¸ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>åœ¨æˆ‘çœ‹æ¥ï¼Œ<code>LinkedList</code>çš„å®ç°åˆè¡·æ˜¯ä½œä¸º<code>List</code>é›†åˆä½¿ç”¨ï¼ˆè¿™ç‚¹å¯ä»ç±»åä½“ç°å‡ºæ¥ï¼Œå®ƒæ˜¯ä¸€ç§<code>List</code>ï¼‰ã€‚ç”±äºå…¶åº•å±‚æ•°æ®ç»“æ„æ˜¯åŒå‘é“¾è¡¨ï¼Œå®ƒå¯ä»¥ç”¨æ¥å®ç°é˜Ÿåˆ—ç­‰å…¶å®ƒæ•°æ®ç»“æ„ï¼Œæ‰€ä»¥è®¾è®¡è€…è®©<code>LinkedList</code>ç±»å®ç°äº†é˜Ÿåˆ—æ¥å£ã€‚</p><blockquote><p>æ˜¯å› ä¸ºåŒå‘é“¾è¡¨è¿™ç§æ•°æ®ç»“æ„å¯ä»¥ç”¨æ¥å®ç°é˜Ÿåˆ—ï¼Œæ‰€ä»¥æ‰å®ç°é˜Ÿåˆ—æ¥å£ã€‚è€Œä¸æ˜¯å› ä¸ºå®ç°äº†é˜Ÿåˆ—æ¥å£ï¼Œæ‰å†³å®šä½¿ç”¨åŒå‘é“¾è¡¨è¿™ç§æ•°æ®ç»“æ„ã€‚</p></blockquote><h4 id="ä»é˜Ÿå°¾å…¥é˜Ÿåˆ—"><a href="#ä»é˜Ÿå°¾å…¥é˜Ÿåˆ—" class="headerlink" title="ä»é˜Ÿå°¾å…¥é˜Ÿåˆ—"></a>ä»é˜Ÿå°¾å…¥é˜Ÿåˆ—</h4><p>ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯<code>add(e)</code>ï¼Œå®é™…ä¸Šè¿™ä¹Ÿæ˜¯åœ¨<code>List</code>æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå®ƒçš„å®ç°æ—¢ç¬¦åˆåˆ—è¡¨çš„å®šä¹‰ï¼Œåˆç¬¦åˆé˜Ÿåˆ—çš„å®šä¹‰ã€‚</p><p>è¯¦æƒ…è§é›†åˆæ–¹æ³•ä¸­çš„<a href="#add"><code>add(e)</code></a>ã€‚</p><p>ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯<code>offer(e)</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">offer</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> add(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è°ƒç”¨äº†<a href="#add"><code>add(e)</code></a>æ–¹æ³•ã€‚</p><h4 id="ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—-1"><a href="#ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—-1" class="headerlink" title="ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—"></a>ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—</h4><p>ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯<code>remove()</code>ï¼Œè¯¥æ–¹æ³•åŒæ ·ä¹Ÿå®šä¹‰åœ¨äº†<code>List</code>æ¥å£ä¸­ï¼Œè¯¦æƒ…è§é›†åˆæ–¹æ³•ä¸­çš„<a href="#remove"><code>remove</code></a>ã€‚</p><p>ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯<code>poll()</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">poll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">return</span> (f == <span class="keyword">null</span>) ? <span class="keyword">null</span> : unlinkFirst(f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›ç‰¹æ®Šå€¼<code>null</code>ï¼›å¦åˆ™è°ƒç”¨å†…éƒ¨æ–¹æ³•<a href="#unlinkFirst"><code>unlinkFirst(f)</code></a>å‰”é™¤å¤´èŠ‚ç‚¹çš„è¿æ¥ã€‚è¿™ç¬¦åˆ<code>Queue</code>æ¥å£ä¸­<code>poll</code>æ–¹æ³•çš„å®šä¹‰ã€‚</p><h4 id="æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ -1"><a href="#æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ -1" class="headerlink" title="æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ "></a>æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ </h4><p>ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯<code>element()</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">element</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getFirst();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è°ƒç”¨åŒç«¯é˜Ÿåˆ—çš„<a href="#getFirst"><code>getFirst()</code></a>æ–¹æ³•æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ ã€‚</p><p>ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯<code>peek()</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">peek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">return</span> (f == <span class="keyword">null</span>) ? <span class="keyword">null</span> : f.item;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè·å–é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸º<code>null</code>ï¼Œåˆ™ä¸ºç©ºé˜Ÿåˆ—ï¼Œè¿”å›ç‰¹æ®Šå€¼<code>null</code>ï¼›å¦åˆ™è¿”å›å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸã€‚è¿™ç¬¦åˆ<code>Queue</code>æ¥å£ä¸­<code>peek</code>æ–¹æ³•çš„å®šä¹‰ã€‚</p><h3 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h3><p><code>LinkedList</code>ç±»åªæä¾›äº†åˆ—è¡¨è¿­ä»£å™¨çš„å®ç°ï¼ŒåŸºç±»<code>AbstractSequentialList</code>ç±»ä¸­æä¾›çš„æ™®é€šè¿­ä»£å™¨å®ç°ä¹Ÿæ˜¯åˆ—è¡¨è¿­ä»£å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒç´¢å¼•æ˜¯å¦è¶Šç•Œ</span></span><br><span class="line">    checkPositionIndex(index);</span><br><span class="line">    <span class="comment">// è¿”å›ä»indexä½ç½®å¼€å§‹çš„è¿­ä»£å™¨å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ListItr(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿­ä»£å™¨<code>ListItr</code>å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ListItr</span> <span class="keyword">implements</span> <span class="title">ListIterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ€åä¸€æ¬¡é€šè¿‡è¿­ä»£å™¨è¿”å›çš„èŠ‚ç‚¹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Node&lt;E&gt; lastReturned;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰è¿­ä»£å™¨æ‰€æŒæœ‰çš„èŠ‚ç‚¹å¯¹è±¡ï¼Œå®ƒå°†ä½œä¸ºè¿­ä»£çš„ä¾æ®ï¼Œè°ƒç”¨previousæ–¹æ³•å°†è¿”å›å…¶å‰é©±èŠ‚ç‚¹ï¼›è°ƒç”¨nextæ–¹æ³•å°†è¿”å›å…¶åç»§èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Node&lt;E&gt; next;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰è¿­ä»£å™¨æ‰€æŒæœ‰çš„èŠ‚ç‚¹å¯¹è±¡çš„ç´¢å¼•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> nextIndex;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * fail-fastæœºåˆ¶çš„æœŸæœ›ä¿®æ”¹æ¬¡æ•°ï¼Œåˆå§‹åŒ–ä¸ºAbstractList#modCount</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¸¦å‚æ„é€ å™¨ï¼Œæ„é€ æŒ‡å®šç´¢å¼•ä½ç½®çš„åˆ—è¡¨è¿­ä»£å™¨ã€‚ç”±å¤–éƒ¨æ ¡éªŒç´¢å¼•åˆæ³•ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ListItr(<span class="keyword">int</span> index) &#123;</span><br><span class="line">        <span class="comment">// assert isPositionIndex(index);</span></span><br><span class="line">        <span class="comment">// index = size æ˜¯åˆæ³•çš„ï¼Œä¾¿äºä»åå‘å‰è¿­ä»£ã€‚æ­¤æ—¶nextä¸ºå°¾èŠ‚ç‚¹lastçš„åç»§èŠ‚ç‚¹nullï¼Œå¯ä»¥è°ƒç”¨previousæ–¹æ³•è¿­ä»£å°¾èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        next = (index == size) ? <span class="keyword">null</span> : node(index);</span><br><span class="line">        nextIndex = index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­æ˜¯å¦è¿­ä»£åˆ°äº†åˆ—è¡¨æœ«å°¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nextIndex &lt; size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰nextIndexç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹å…ƒç´ ï¼Œä¸”ç´¢å¼•å³ç§»ä¸€ä½ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// fail-fast</span></span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="keyword">if</span> (!hasNext())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">        <span class="comment">// è®°å½•æœ€åä¸€æ¬¡é€šè¿‡è¿­ä»£å™¨è¿”å›çš„èŠ‚ç‚¹å¯¹è±¡</span></span><br><span class="line">        lastReturned = next;</span><br><span class="line">        <span class="comment">// å½“å‰è¿­ä»£å™¨æ‰€æŒæœ‰çš„èŠ‚ç‚¹å¯¹è±¡ èµ‹å€¼ ä¸ºå…¶åç»§èŠ‚ç‚¹</span></span><br><span class="line">        next = next.next;</span><br><span class="line">        <span class="comment">// ç´¢å¼•å³ç§»</span></span><br><span class="line">        nextIndex++;</span><br><span class="line">        <span class="comment">// è¿”å›å…ƒç´ å€¼</span></span><br><span class="line">        <span class="keyword">return</span> lastReturned.item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­æ˜¯å¦è¿­ä»£åˆ°äº†åˆ—è¡¨å¼€å¤´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPrevious</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nextIndex &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰nextIndexç´¢å¼•ä½ç½®çš„èŠ‚ç‚¹å…ƒç´ ï¼Œä¸”ç´¢å¼•å·¦ç§»ä¸€ä½ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">previous</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// fail-fastæœºåˆ¶</span></span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="keyword">if</span> (!hasPrevious())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">        <span class="comment">// å¦‚æœnextä¸ºnullï¼Œåˆ™åˆå§‹åŒ–è¯¥è¿­ä»£å™¨å¯¹è±¡æ—¶ï¼Œæ„é€ æ–¹æ³•ä¸­ä¼ å…¥çš„index=sizeã€‚</span></span><br><span class="line">        <span class="comment">// è¡¨ç¤ºä»åˆ—è¡¨å°¾éƒ¨å¼€å§‹è¿­ä»£ï¼Œå°†nextèµ‹å€¼ä¸ºå°¾èŠ‚ç‚¹lastï¼›å¦åˆ™èµ‹å€¼ä¸ºå…¶å‰é©±èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        lastReturned = next = (next == <span class="keyword">null</span>) ? last : next.prev;</span><br><span class="line">        nextIndex--;</span><br><span class="line">        <span class="keyword">return</span> lastReturned.item;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›å½“å‰è¿­ä»£ç´¢å¼•ï¼Œå…¶å€¼ç”±æ„é€ å™¨åˆå§‹åŒ–ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">nextIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nextIndex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›å½“å‰è¿­ä»£ç´¢å¼•å‰ä¸€ä½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">previousIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nextIndex - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®‰å…¨åœ°ä»åˆ—è¡¨ä¸­åˆ é™¤ä¸Šä¸€æ¬¡è¿­ä»£æ–¹æ³•ï¼ˆnext/previousï¼‰è¿”å›çš„èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     * è¿­ä»£è¿‡ç¨‹ä¸­åªèƒ½è°ƒç”¨è¯¥æ–¹æ³•ä¿®æ”¹åˆ—è¡¨ï¼Œå¦åˆ™å°†å¼•å‘fail-fastæœºåˆ¶ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// fail-fastæœºåˆ¶</span></span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="comment">// è¿­ä»£çŠ¶æ€æ ¡éªŒï¼šè°ƒç”¨æ­¤removeæ–¹æ³•ä¹‹å‰å¿…é¡»å…ˆè°ƒç”¨è¿­ä»£æ–¹æ³•ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (lastReturned == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–ä¸Šæ¬¡è¿­ä»£è¿”å›èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹</span></span><br><span class="line">        Node&lt;E&gt; lastNext = lastReturned.next;</span><br><span class="line">        <span class="comment">// å‰”é™¤lastReturnedèŠ‚ç‚¹çš„è¿æ¥ï¼ˆä¼šå¯¼è‡´AbstractList#modCountå¢åŠ ï¼‰</span></span><br><span class="line">        unlink(lastReturned);</span><br><span class="line">        <span class="comment">// ä»åå¾€å‰ï¼ˆpreviousï¼‰è¿­ä»£æ—¶ï¼Œnext = lastReturnedæˆç«‹</span></span><br><span class="line">        <span class="keyword">if</span> (next == lastReturned)</span><br><span class="line">            <span class="comment">// å½“å‰è¿­ä»£å™¨æ‰€æŒæœ‰çš„èŠ‚ç‚¹å¯¹è±¡èµ‹å€¼ä¸ºä¸Šæ¬¡è¿­ä»£è¿”å›èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹</span></span><br><span class="line">            next = lastNext;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="comment">// ä»å‰å¾€åï¼ˆnextï¼‰è¿­ä»£æ—¶ï¼Œè¿›å…¥elseåˆ†æ”¯ï¼Œè¿­ä»£ç´¢å¼•å‡ä¸€ã€‚</span></span><br><span class="line">            nextIndex--;</span><br><span class="line">        <span class="comment">// é‡ç½®è¿­ä»£å™¨è¿­ä»£çŠ¶æ€ï¼Œä¸‹æ¬¡è°ƒç”¨è¿­ä»£æ–¹æ³•ä¹‹å‰ä¸å¯å†è°ƒç”¨removeæ–¹æ³•ã€‚</span></span><br><span class="line">        lastReturned = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">// æœŸæœ›ä¿®æ”¹æ¬¡æ•°å¢åŠ </span></span><br><span class="line">        expectedModCount++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¦†ç›–ä¸Šæ¬¡è¿­ä»£æ–¹æ³•è¿”å›çš„èŠ‚ç‚¹æ•°æ®åŸŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è¿­ä»£çŠ¶æ€æ ¡éªŒ</span></span><br><span class="line">        <span class="keyword">if</span> (lastReturned == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">        <span class="comment">// fail-fastæœºåˆ¶</span></span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="comment">// è¦†ç›–</span></span><br><span class="line">        lastReturned.item = e;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨ä¸‹æ¬¡è°ƒç”¨è¿­ä»£æ–¹æ³•å°†è¿”å›çš„èŠ‚ç‚¹ä¹‹å‰è¿æ¥æŒ‡å®šèŠ‚ç‚¹e</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">        checkForComodification();</span><br><span class="line">        lastReturned = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (next == <span class="keyword">null</span>)</span><br><span class="line">            linkLast(e);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            linkBefore(e, next);</span><br><span class="line">        nextIndex++;</span><br><span class="line">        expectedModCount++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * JDK8 æ–°å¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">forEachRemaining</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> E&gt; action)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(action);</span><br><span class="line">        <span class="keyword">while</span> (modCount == expectedModCount &amp;&amp; nextIndex &lt; size) &#123;</span><br><span class="line">            action.accept(next.item);</span><br><span class="line">            lastReturned = next;</span><br><span class="line">            next = next.next;</span><br><span class="line">            nextIndex++;</span><br><span class="line">        &#125;</span><br><span class="line">        checkForComodification();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * fail-fastæœºåˆ¶ï¼šæ ¡éªŒå®é™…ä¿®æ”¹æ¬¡æ•°æ˜¯å¦ç­‰äºæœŸæœ›ä¿®æ”¹æ¬¡æ•°ã€‚ä¸ç­‰åˆ™ç«‹å³æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">checkForComodification</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (modCount != expectedModCount)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¶å®ƒæ–¹æ³•"><a href="#å…¶å®ƒæ–¹æ³•" class="headerlink" title="å…¶å®ƒæ–¹æ³•"></a>å…¶å®ƒæ–¹æ³•</h3><h4 id="å…‹éš†"><a href="#å…‹éš†" class="headerlink" title="å…‹éš†"></a>å…‹éš†</h4><p>è¯¥ç±»æä¾›äº†æ·±æ‹·è´æ–¹æ³•ï¼ˆä»<code>LinkedList</code>ç»´åº¦æ¥è¯´å¯ä»¥ç§°ä¸ºæ·±æ‹·è´ï¼‰ã€‚ç”±äºå…¶å†…éƒ¨æŒæœ‰çš„æ˜¯å¯¹è±¡å¼•ç”¨ï¼Œåˆ—è¡¨ä¸­çš„å…ƒç´ å¹¶æ²¡æœ‰è¿›è¡Œâ€œæ·±æ‹·è´â€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…‹éš†å®ç°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è·å–ä¸€ä¸ªæµ…æ‹·è´å¯¹è±¡</span></span><br><span class="line">    LinkedList&lt;E&gt; clone = superClone();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line">    <span class="comment">// Put clone into &quot;virgin&quot; state</span></span><br><span class="line">    clone.first = clone.last = <span class="keyword">null</span>;</span><br><span class="line">    clone.size = <span class="number">0</span>;</span><br><span class="line">    clone.modCount = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å€¼å¡«å……</span></span><br><span class="line">    <span class="comment">// Initialize clone with our elements</span></span><br><span class="line">    <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="keyword">null</span>; x = x.next)</span><br><span class="line">        clone.add(x.item);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> clone;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç§æœ‰æ–¹æ³•ï¼šè°ƒç”¨Object#cloneæµ…æ‹·è´</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> LinkedList&lt;E&gt; <span class="title">superClone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (LinkedList&lt;E&gt;) <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> InternalError(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹Deque</title>
      <link href="2020/05/11/javase/base/deque/"/>
      <url>2020/05/11/javase/base/deque/</url>
      
        <content type="html"><![CDATA[<h2 id="åŒç«¯é˜Ÿåˆ—ç®€è¿°"><a href="#åŒç«¯é˜Ÿåˆ—ç®€è¿°" class="headerlink" title="åŒç«¯é˜Ÿåˆ—ç®€è¿°"></a>åŒç«¯é˜Ÿåˆ—ç®€è¿°</h2><p>åŒç«¯é˜Ÿåˆ—æ˜¯ä¸€ç§æ›´ç‰¹æ®Šçš„çº¿æ€§è¡¨ã€‚æ™®é€šé˜Ÿåˆ—<code>Queue</code>åªå…è®¸åœ¨é˜Ÿé¦–åˆ é™¤å…ƒç´ ï¼Œåœ¨é˜Ÿå°¾æ’å…¥å…ƒç´ ã€‚è€ŒåŒç«¯é˜Ÿåˆ—åŒæ—¶å…è®¸åœ¨é˜Ÿé¦–å’Œé˜Ÿå°¾æ’å…¥å’Œåˆ é™¤å…ƒç´ ã€‚</p><h2 id="Dequeæ¥å£ç®€è¿°"><a href="#Dequeæ¥å£ç®€è¿°" class="headerlink" title="Dequeæ¥å£ç®€è¿°"></a><code>Deque</code>æ¥å£ç®€è¿°</h2><p><code>Deque</code>æ¥å£æ˜¯<code>Java</code>ä¸­çš„åŒç«¯é˜Ÿåˆ—å®šä¹‰ï¼Œç»§æ‰¿<code>java.util.Queue</code>æ¥å£ï¼Œå®ƒæä¾›äº†æ“ä½œé˜Ÿé¦–å’Œé˜Ÿå°¾çš„å…­ç»„æ–¹æ³•ï¼šæ’å…¥é˜Ÿé¦–/é˜Ÿå°¾å…ƒç´ ã€åˆ é™¤é˜Ÿé¦–/é˜Ÿå°¾å…ƒç´ ã€æå–é˜Ÿé¦–/é˜Ÿå°¾å…ƒç´ ã€‚åŒ<code>Queue</code>æ¥å£ä¸€æ ·ï¼Œæ¯ç»„æ“ä½œéƒ½åŒ…å«ä¸¤ç§å½¢å¼ï¼šä¸€ç§åœ¨æ“ä½œå¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸ï¼›å¦ä¸€ç§è¿”å›ç‰¹æ®Šçš„å€¼ï¼ˆ<code>null</code>æˆ–<code>false</code>ï¼‰ã€‚</p><p>å½“æŠŠåŒç«¯é˜Ÿåˆ—å½“åšæ™®é€šé˜Ÿåˆ—ä½¿ç”¨æ—¶ï¼Œå°†å‡ºç°<code>FIFO</code>ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰è¡Œä¸ºã€‚ç»§æ‰¿è‡ª<code>Queue</code>æ¥å£çš„æ–¹æ³•ç­‰åŒäº<code>Deque</code>æ¥å£ä¸­çš„ç‰¹å®šæ–¹æ³•ã€‚</p><p>åŒç«¯é˜Ÿåˆ—ä¹Ÿå¯ç”¨åš<code>LIFO</code>ï¼ˆåè¿›å…ˆå‡ºï¼‰å †æ ˆã€‚åº”è¯¥ä¼˜å…ˆé€‰ç”¨æ­¤æ¥å£ï¼Œå°½é‡ä¸è¦ä½¿ç”¨æ—§ç‰ˆ<code>java.util.Stack</code>ç±»ï¼ˆç»§æ‰¿è‡ªåŒæ­¥é›†åˆ<code>Vector</code>ï¼‰ã€‚</p><h2 id="æ¥å£è¯¦è§£"><a href="#æ¥å£è¯¦è§£" class="headerlink" title="æ¥å£è¯¦è§£"></a>æ¥å£è¯¦è§£</h2><p>åŒç«¯é˜Ÿåˆ—æ“ä½œæ¥å£ï¼š</p><table style="vertical-align:middle; text-align:center;">    <tr>        <th>æ“ä½œä½ç½®</th>        <th colspan="2">é˜Ÿé¦–ï¼ˆHeadï¼‰</th>        <th colspan="2">é˜Ÿå°¾ï¼ˆTailï¼‰</th>    </tr>    <tr>        <th>å“åº”</th>        <th>throws exception</th>        <th>special value</th>        <th>throws exception</th>        <th>special value</th>    </tr>    <tr>        <td>insert</td>        <td>addFirst(e)</td>        <td>offerFirst(e)</td>        <td>addLast(e)</td>        <td>offerLast(e)</td>    </tr>    <tr>        <td>remove</td>        <td>removeFirst()</td>        <td>pollFirst()</td>        <td>removeLast()</td>        <td>pollLast()</td>    </tr>    <tr>        <td>get element</td>        <td>getFirst()</td>        <td>peekFirst()</td>        <td>getLast()</td>        <td>peekLast()</td>    </tr></table><h3 id="å…¥é˜Ÿåˆ—"><a href="#å…¥é˜Ÿåˆ—" class="headerlink" title="å…¥é˜Ÿåˆ—"></a>å…¥é˜Ÿåˆ—</h3><h4 id="å…¥é˜Ÿé¦–"><a href="#å…¥é˜Ÿé¦–" class="headerlink" title="å…¥é˜Ÿé¦–"></a>å…¥é˜Ÿé¦–</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addFirst</span><span class="params">(E e)</span></span>;</span><br></pre></td></tr></table></figure><p>æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿé¦–ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›<code>true</code>ï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™æŠ›å‡º<code>IllegalStateException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">offerFirst</span><span class="params">(E e)</span></span>;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿé¦–ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›<code>true</code>ï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™è¿”å›<code>false</code>ã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>æ‰€ä»¥ï¼Œå½“ä½¿ç”¨å®¹é‡å—é™çš„é˜Ÿåˆ—æ—¶ï¼Œé€šå¸¸ä½¿ç”¨<code>offerFirst</code>æ–¹æ³•æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿé¦–ã€‚</p><h4 id="å…¥é˜Ÿå°¾"><a href="#å…¥é˜Ÿå°¾" class="headerlink" title="å…¥é˜Ÿå°¾"></a>å…¥é˜Ÿå°¾</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addLast</span><span class="params">(E e)</span></span>;</span><br></pre></td></tr></table></figure><p>æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›<code>true</code>ï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™æŠ›å‡º<code>IllegalStateException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">offerLast</span><span class="params">(E e)</span></span>;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›<code>true</code>ï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™è¿”å›<code>false</code>ã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>æ‰€ä»¥ï¼Œå½“ä½¿ç”¨å®¹é‡å—é™çš„é˜Ÿåˆ—æ—¶ï¼Œé€šå¸¸ä½¿ç”¨<code>offerLast</code>æ–¹æ³•æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ã€‚</p><h3 id="å‡ºé˜Ÿåˆ—"><a href="#å‡ºé˜Ÿåˆ—" class="headerlink" title="å‡ºé˜Ÿåˆ—"></a>å‡ºé˜Ÿåˆ—</h3><h4 id="ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—"><a href="#ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—" class="headerlink" title="ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—"></a>ä»é˜Ÿé¦–å‡ºé˜Ÿåˆ—</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">removeFirst</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åˆ é™¤é˜Ÿé¦–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">pollFirst</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯åˆ é™¤é˜Ÿé¦–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›<code>null</code>ã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h3 id="ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—"><a href="#ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—" class="headerlink" title="ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—"></a>ä»é˜Ÿå°¾å‡ºé˜Ÿåˆ—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">removeLast</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åˆ é™¤é˜Ÿå°¾ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">pollLast</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯åˆ é™¤é˜Ÿå°¾ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›<code>null</code>ã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h3 id="æŸ¥è¯¢é˜Ÿåˆ—å…ƒç´ "><a href="#æŸ¥è¯¢é˜Ÿåˆ—å…ƒç´ " class="headerlink" title="æŸ¥è¯¢é˜Ÿåˆ—å…ƒç´ "></a>æŸ¥è¯¢é˜Ÿåˆ—å…ƒç´ </h3><h4 id="æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ "><a href="#æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ " class="headerlink" title="æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ "></a>æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">getFirst</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>è·å–é˜Ÿé¦–å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡º<code>NoSuchElementException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">peekFirst</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯è·å–é˜Ÿé¦–å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›<code>null</code>ã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h4 id="æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ "><a href="#æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ " class="headerlink" title="æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ "></a>æŸ¥è¯¢é˜Ÿå°¾å…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">getLast</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>è·å–é˜Ÿå°¾å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡º<code>NoSuchElementException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">peekLast</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯è·å–é˜Ÿå°¾å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›<code>null</code>ã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h3 id="åˆ é™¤æŒ‡å®šå…ƒç´ "><a href="#åˆ é™¤æŒ‡å®šå…ƒç´ " class="headerlink" title="åˆ é™¤æŒ‡å®šå…ƒç´ "></a>åˆ é™¤æŒ‡å®šå…ƒç´ </h3><h4 id="åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ "><a href="#åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ " class="headerlink" title="åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ "></a>åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">removeFirstOccurrence</span><span class="params">(Object o)</span></span>;</span><br></pre></td></tr></table></figure><p>ä»æ­¤åŒç«¯é˜Ÿåˆ—ä¸­åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ <code>e</code>ã€‚å¦‚æœä»æœªå‡ºç°ï¼Œåˆ™é˜Ÿåˆ—ä¿æŒä¸å˜ã€‚åˆ¤æ–­é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸æŒ‡å®šå…ƒç´ ç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼š<code>o == null ? e == null : o.equals(e)</code>ã€‚</p><h4 id="åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ "><a href="#åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ " class="headerlink" title="åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ "></a>åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">removeLastOccurrence</span><span class="params">(Object o)</span></span>;</span><br></pre></td></tr></table></figure><p>ä»æ­¤åŒç«¯é˜Ÿåˆ—ä¸­åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ <code>e</code>ã€‚å¦‚æœä»æœªå‡ºç°ï¼Œåˆ™é˜Ÿåˆ—ä¿æŒä¸å˜ã€‚åˆ¤æ–­é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸æŒ‡å®šå…ƒç´ ç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼š<code>o == null ? e == null : o.equals(e)</code>ã€‚</p><h3 id="ä½œä¸ºæ™®é€šé˜Ÿåˆ—"><a href="#ä½œä¸ºæ™®é€šé˜Ÿåˆ—" class="headerlink" title="ä½œä¸ºæ™®é€šé˜Ÿåˆ—"></a>ä½œä¸ºæ™®é€šé˜Ÿåˆ—</h3><p>è¯¥åŒç«¯é˜Ÿåˆ—<code>Deque</code>æ¥å£åŒæ ·æä¾›äº†æ™®é€šé˜Ÿåˆ—<code>Queue</code>çš„å…­ä¸ªæ“ä½œæ–¹æ³•ã€‚ç”¨ä½œæ™®é€šé˜Ÿåˆ—æ—¶ï¼Œäº§ç”Ÿ<code>FIFO</code>ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰è¡Œä¸ºï¼Œå…¶æ–¹æ³•ç­‰åŒäºä¸Šè¿°åŒç«¯é˜Ÿåˆ—çš„ç‰¹å®šæ–¹æ³•ã€‚ä¸‹é¢æ˜¯å®ƒä»¬çš„å¯¹åº”å…³ç³»ï¼š</p><table><thead><tr><th align="left">Queue Method</th><th align="left">Equivalent Deque Method</th></tr></thead><tbody><tr><td align="left">add(e)</td><td align="left">addLast(e)</td></tr><tr><td align="left">offer(e)</td><td align="left">offerLast(e)</td></tr><tr><td align="left">remove()</td><td align="left">removeFirst()</td></tr><tr><td align="left">poll()</td><td align="left">pollFirst()</td></tr><tr><td align="left">element()</td><td align="left">getFirst()</td></tr><tr><td align="left">peek()</td><td align="left">peekFirst()</td></tr></tbody></table><p>è™½ç„¶<code>Deque</code>æ¥å£ä¹Ÿæä¾›äº†æ™®é€šé˜Ÿåˆ—çš„å…­ä¸ªæ“ä½œæ–¹æ³•ï¼Œä½†æˆ‘ä»¬å°½é‡ä¸è¦å»ä½¿ç”¨å®ƒä»¬ï¼Œè€Œæ˜¯ä½¿ç”¨å…¶å¯¹åº”çš„æ–¹æ³•ã€‚</p><p>ä¾‹å¦‚å…¥é˜Ÿåˆ—ï¼Œæœ€å¥½ä¸è¦è°ƒç”¨<code>offer(e)</code>ï¼Œè€Œæ˜¯è°ƒç”¨<code>offerLast(e)</code>ã€‚</p><p>å› ä¸ºå½“ä½¿ç”¨<code>offer(e)</code>æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ€è€ƒï¼Œ<code>offer(e)</code>å®é™…ä¸Šå°±æ˜¯<code>offerLast(e)</code>ï¼šä»é˜Ÿå°¾å…¥é˜Ÿåˆ—ã€‚å¦‚æœæˆ‘ä»¬ç›´æ¥è°ƒç”¨<code>offerLast(e)</code>ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºæ˜¯ä»é˜Ÿå°¾å…¥é˜Ÿåˆ—ã€‚</p><p>æ‰€ä»¥ï¼Œä½¿ç”¨<code>Deque</code>æ¥å£æ—¶ï¼Œæ¨èæ˜ç¡®ä½¿ç”¨<code>xxxLast</code>/<code>xxxFirst</code>è¿™ç±»æ–¹æ³•ã€‚</p><h3 id="ä½œä¸ºæ ˆ"><a href="#ä½œä¸ºæ ˆ" class="headerlink" title="ä½œä¸ºæ ˆ"></a>ä½œä¸ºæ ˆ</h3><p>åŒç«¯é˜Ÿåˆ—å¯ä»¥å½“åšæ ˆï¼ˆ<code>LIFO</code>åè¿›å…ˆå‡ºï¼‰æ¥ä½¿ç”¨ã€‚å®ƒæä¾›äº†é—ç•™ç±»<code>Stack</code>ä¸­å¯¹æ ˆçš„åŸºæœ¬æ“ä½œæ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ç­‰åŒäºä¸Šè¿°åŒç«¯é˜Ÿåˆ—çš„ç‰¹å®šæ–¹æ³•ã€‚ä¸‹é¢æ˜¯å®ƒä»¬çš„å¯¹åº”å…³ç³»ï¼š</p><table><thead><tr><th align="left">Stack Method</th><th align="left">Equivalent Deque Method</th></tr></thead><tbody><tr><td align="left">push(e)</td><td align="left">addFirst(e)</td></tr><tr><td align="left">pop()</td><td align="left">removeFirst()</td></tr><tr><td align="left">peek()</td><td align="left">peekFirst()</td></tr></tbody></table><p>å½“åšæ ˆä½¿ç”¨æ—¶ï¼Œå°½é‡ä½¿ç”¨æ ˆçš„æ–¹æ³•ï¼š<code>push(e)</code>/<code>pop</code>/<code>peek</code>ï¼Œä¸è¦è°ƒç”¨å…¶å¯¹åº”çš„æ–¹æ³•ã€‚</p><p>å› ä¸ºé—ç•™ç±»<code>Stack</code>å·²ç»å­˜åœ¨äº†ï¼Œè€ƒè™‘åˆ°ç±»åº“å…¼å®¹æ€§é—®é¢˜æ— æ³•å°†å…¶è¦†ç›–ï¼Œæ‰€ä»¥åœ¨<code>Deque</code>æ¥å£ä¸­å®šä¹‰äº†æ ˆçš„æ–¹æ³•ï¼Œå½“æˆ‘ä»¬æŠŠ<code>Deque</code>å½“åšæ ˆä½¿ç”¨æ—¶ï¼Œç›´æ¥è°ƒç”¨æ ˆçš„æ–¹æ³•ä¼šä½¿è¯­ä¹‰æ›´åŠ æ˜ç¡®ã€‚</p><h3 id="ä½œä¸ºé›†åˆ"><a href="#ä½œä¸ºé›†åˆ" class="headerlink" title="ä½œä¸ºé›†åˆ"></a>ä½œä¸ºé›†åˆ</h3><p>ç”±äº<code>Deque</code>æ¥å£ç»§æ‰¿äº†<code>Queue</code>æ¥å£ï¼Œè€Œ<code>Queue</code>æ¥å£åˆç»§æ‰¿äº†<code>Collection</code>æ¥å£ï¼Œæ‰€ä»¥<code>Deque</code>ä¹Ÿå¯ä½œä¸ºé›†åˆä½¿ç”¨ã€‚å®ƒä¹Ÿå®šä¹‰äº†ä¸€äº›é›†åˆçš„åŸºæœ¬æ“ä½œã€‚</p><p>åˆ¤æ–­æŒ‡å®šå…ƒç´ <code>o</code>ä¸åŒç«¯é˜Ÿåˆ—ä¸­å…ƒç´ <code>e</code>ç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼š<code>o == null ? e == null : o.equals(e)</code>ã€‚</p><h4 id="åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ -1"><a href="#åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ -1" class="headerlink" title="åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ "></a>åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span></span>;</span><br></pre></td></tr></table></figure><p>ä¸<code>Collection</code>æ¥å£ä¸­å®šä¹‰çš„ç±»ä¼¼ï¼Œåˆ é™¤æŒ‡å®šå…ƒç´ åœ¨é›†åˆä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°ã€‚å®é™…ä¸Šï¼Œè¯¥æ–¹æ³•ç­‰åŒä¸<code>removeFirstOccurrence(o)</code>æ–¹æ³•ã€‚</p><h4 id="åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ "><a href="#åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ " class="headerlink" title="åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ "></a>åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span></span>;</span><br></pre></td></tr></table></figure><p>è¯¥åŒç«¯é˜Ÿåˆ—ä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å…ƒç´ <code>o</code>ã€‚</p><h4 id="æŸ¥è¯¢å…ƒç´ ä¸ªæ•°"><a href="#æŸ¥è¯¢å…ƒç´ ä¸ªæ•°" class="headerlink" title="æŸ¥è¯¢å…ƒç´ ä¸ªæ•°"></a>æŸ¥è¯¢å…ƒç´ ä¸ªæ•°</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>è¿”å›è¯¥åŒç«¯é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°ã€‚</p><h4 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h4><p>æä¾›äº†ä¸¤ä¸ªä¸åŒå…ƒç´ é¡ºåºçš„è¿­ä»£å™¨ã€‚</p><h5 id="ä»é˜Ÿé¦–åˆ°é˜Ÿå°¾çš„è¿­ä»£å™¨"><a href="#ä»é˜Ÿé¦–åˆ°é˜Ÿå°¾çš„è¿­ä»£å™¨" class="headerlink" title="ä»é˜Ÿé¦–åˆ°é˜Ÿå°¾çš„è¿­ä»£å™¨"></a>ä»é˜Ÿé¦–åˆ°é˜Ÿå°¾çš„è¿­ä»£å™¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>è¿­ä»£å™¨ä¸­çš„å…ƒç´ é¡ºåºä¸ºåŒç«¯é˜Ÿåˆ—ä»é˜Ÿé¦–åˆ°é˜Ÿå°¾çš„å…ƒç´ é¡ºåºã€‚</p><h5 id="ä»é˜Ÿå°¾åˆ°é˜Ÿé¦–çš„è¿­ä»£å™¨"><a href="#ä»é˜Ÿå°¾åˆ°é˜Ÿé¦–çš„è¿­ä»£å™¨" class="headerlink" title="ä»é˜Ÿå°¾åˆ°é˜Ÿé¦–çš„è¿­ä»£å™¨"></a>ä»é˜Ÿå°¾åˆ°é˜Ÿé¦–çš„è¿­ä»£å™¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Iterator&lt;E&gt; <span class="title">descendingIterator</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>ä»¥ç›¸åçš„é¡ºåºè¿”å›è¿­ä»£å™¨ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><code>Deque</code>æ¥å£å®šä¹‰äº†ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼ˆ<code>Double Ended Queue</code>ï¼‰ï¼Œå®ƒå¯ä»¥ä»é˜Ÿé¦–æˆ–é˜Ÿå°¾æ“ä½œå…ƒç´ ï¼›ä¹Ÿå¯ä»¥å½“åšæ™®é€šé˜Ÿåˆ—<code>Queue</code>ä½¿ç”¨ï¼›åŒæ—¶è¿˜å¯ä»¥å½“åšæ ˆ<code>Stack</code>æ¥ä½¿ç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹Queue</title>
      <link href="2020/05/11/javase/base/queue/"/>
      <url>2020/05/11/javase/base/queue/</url>
      
        <content type="html"><![CDATA[<h2 id="é˜Ÿåˆ—ç®€è¿°"><a href="#é˜Ÿåˆ—ç®€è¿°" class="headerlink" title="é˜Ÿåˆ—ç®€è¿°"></a>é˜Ÿåˆ—ç®€è¿°</h2><p>é˜Ÿåˆ—æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§è¡¨ï¼Œå®ƒå…·æœ‰å…ˆè¿›å…ˆå‡ºï¼ˆ<code>FIFO</code>ï¼‰çš„ç‰¹ç‚¹ï¼Œåªå…è®¸åœ¨è¡¨çš„å‰ç«¯ï¼ˆ<code>front</code>ï¼‰è¿›è¡Œåˆ é™¤æ“ä½œï¼Œè€Œåœ¨è¡¨çš„åç«¯ï¼ˆ<code>rear</code>ï¼‰è¿›è¡Œæ’å…¥æ“ä½œã€‚è¿›è¡Œæ’å…¥æ“ä½œçš„ç«¯ç§°ä¸ºé˜Ÿå°¾ï¼Œè¿›è¡Œåˆ é™¤æ“ä½œçš„ç«¯ç§°ä¸ºé˜Ÿå¤´ã€‚é˜Ÿåˆ—ä¸­æ²¡æœ‰å…ƒç´ æ—¶ï¼Œç§°ä¸ºç©ºé˜Ÿåˆ—ã€‚</p><h2 id="Queueæ¥å£ç®€è¿°"><a href="#Queueæ¥å£ç®€è¿°" class="headerlink" title="Queueæ¥å£ç®€è¿°"></a><code>Queue</code>æ¥å£ç®€è¿°</h2><p><code>Queue</code>æ¥å£æ˜¯<code>Java</code>ä¸­çš„é˜Ÿåˆ—å®šä¹‰ï¼Œå®ƒä¹Ÿæ˜¯<code>Java</code>å®¹å™¨ä¸­çš„ä¸€å‘˜ï¼Œç»§æ‰¿è‡ª<code>java.util.Collection</code>æ¥å£ã€‚<code>Queue</code>æ¥å£åœ¨<code>Collection</code>æ¥å£çš„åŸºç¡€ä¸Šå®šä¹‰äº†ä¸‰ç»„æ“ä½œï¼šæ’å…¥ã€åˆ é™¤å’Œæå–ã€‚æ¯ç»„æ“ä½œéƒ½åŒ…å«ä¸¤ç§å½¢å¼ï¼šä¸€ç§åœ¨æ“ä½œå¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸ï¼›å¦ä¸€ç§è¿”å›ç‰¹æ®Šçš„å€¼ï¼ˆ<code>null</code>æˆ–<code>false</code>ï¼‰ã€‚</p><h2 id="æ¥å£è¯¦è§£"><a href="#æ¥å£è¯¦è§£" class="headerlink" title="æ¥å£è¯¦è§£"></a>æ¥å£è¯¦è§£</h2><table><thead><tr><th align="left">action</th><th align="left">throws exception</th><th align="left">returns special value</th></tr></thead><tbody><tr><td align="left">insert</td><td align="left">add(e)</td><td align="left">offer(e)</td></tr><tr><td align="left">remove</td><td align="left">remove()</td><td align="left">poll()</td></tr><tr><td align="left">get head</td><td align="left">element()</td><td align="left">peek()</td></tr></tbody></table><h3 id="å…¥é˜Ÿåˆ—"><a href="#å…¥é˜Ÿåˆ—" class="headerlink" title="å…¥é˜Ÿåˆ—"></a>å…¥é˜Ÿåˆ—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span></span>;</span><br></pre></td></tr></table></figure><p>æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›<code>true</code>ï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™æŠ›å‡º<code>IllegalStateException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">offer</span><span class="params">(E e)</span></span>;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯æ’å…¥æŒ‡å®šå…ƒç´ è‡³é˜Ÿå°¾ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›<code>true</code>ï¼Œå¦‚æœè¾¾åˆ°äº†å½“å‰é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡é™åˆ¶ï¼Œåˆ™è¿”å›<code>false</code>ã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>æ‰€ä»¥ï¼Œå½“ä½¿ç”¨å®¹é‡å—é™çš„é˜Ÿåˆ—æ—¶ï¼Œé€šå¸¸ä½¿ç”¨<code>offer</code>æ–¹æ³•æ’å…¥å…ƒç´ ã€‚</p><h3 id="å‡ºé˜Ÿåˆ—"><a href="#å‡ºé˜Ÿåˆ—" class="headerlink" title="å‡ºé˜Ÿåˆ—"></a>å‡ºé˜Ÿåˆ—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">remove</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åˆ é™¤é˜Ÿé¦–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡º<code>NoSuchElementException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">poll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯åˆ é™¤é˜Ÿé¦–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›<code>null</code>ã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h3 id="æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ "><a href="#æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ " class="headerlink" title="æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ "></a>æŸ¥è¯¢é˜Ÿé¦–å…ƒç´ </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">element</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>è·å–é˜Ÿé¦–å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™æŠ›å‡º<code>NoSuchElementException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">E <span class="title">peek</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯è·å–é˜Ÿé¦–å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºé˜Ÿåˆ—ï¼Œåˆ™è¿”å›<code>null</code>ã€‚ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><code>Queue</code>æ¥å£å®ç°é€šå¸¸ä¸å…è®¸æ’å…¥<code>null</code>å…ƒç´ ï¼Œå°½ç®¡æŸäº›å®ç°ï¼ˆä¾‹å¦‚<code>LinkedList</code>ï¼‰å¯ä»¥æ’å…¥<code>null</code>å…ƒç´ ï¼Œä¹Ÿä¸åº”å°†<code>null</code>æ’å…¥é˜Ÿåˆ—ä¸­ï¼Œå› ä¸º<code>poll</code>å’Œ<code>peek</code>æ–¹æ³•ä¼šåœ¨é˜Ÿåˆ—ä¸ºç©ºé˜Ÿåˆ—æ—¶è¿”å›ç‰¹æ®Šå€¼<code>null</code>ï¼Œä¼šäº§ç”Ÿæ­§ä¹‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹AbstractList</title>
      <link href="2020/05/08/javase/base/abstract-list/"/>
      <url>2020/05/08/javase/base/abstract-list/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>AbstractList</code>ç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒç»§æ‰¿äº†<code>AbstractCollection</code>æŠ½è±¡ç±»å¹¶å®ç°äº†<code>List</code>æ¥å£ã€‚<code>List</code>æ¥å£å®šä¹‰äº†ä¸€ç§æœ‰åºé›†åˆï¼Œå¯ä»¥ç²¾ç¡®æ§åˆ¶æ¯ä¸ªå…ƒç´ çš„æ’å…¥ä½ç½®ï¼›è€Œ<code>AbstractCollection</code>æŠ½è±¡ç±»æä¾›äº†ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼ŒåŸºäºè¿™ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•æä¾›å‡ºäº†é›†åˆçš„æœ€åŸºæœ¬å®ç°ã€‚</p><p>æ‰€ä»¥ï¼Œ<code>AbstractList</code>æŠ½è±¡ç±»æä¾›çš„æ˜¯æœ‰åºé›†åˆçš„éª¨æ¶å®ç°ï¼Œç”¨ä»¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘æ”¯æŒéšæœºè®¿é—®æ•°æ®ï¼ˆä¾‹å¦‚æ•°ç»„ï¼‰çš„å®ç°ç±»æ‰€éœ€çš„å·¥ä½œã€‚è€Œå¯¹äºé¡ºåºè®¿é—®æ•°æ®ï¼ˆä¾‹å¦‚é“¾è¡¨ï¼‰ï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨<code>AbstractSequentialList</code>æŠ½è±¡ç±»ã€‚</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>è¯¥æŠ½è±¡ç±»æä¾›äº†æœ‰åºé›†åˆçš„éª¨æ¶å®ç°ã€‚è®©å®ç°ç±»æ”¯æŒéšæœºå¿«é€Ÿè®¿é—®ã€‚</p><p>å¦‚æœè¦å®ç°ä¸å¯ä¿®æ”¹çš„æœ‰åºé›†åˆï¼Œåªéœ€ç»§æ‰¿è¯¥ç±»å¹¶ä¸º<code>get</code>å’Œ<code>size</code>æ–¹æ³•æä¾›å®ç°ï¼›å¦‚æœè¦å®ç°å¯ä¿®æ”¹çš„æœ‰åºé›†åˆï¼Œåœ¨å®ç°ä¸å¯ä¿®æ”¹çš„æœ‰åºé›†åˆåŸºç¡€ä¹‹ä¸Šï¼Œè¿˜è¦å¦å¤–é‡å†™æ­¤ç±»çš„ä¸¤ä¸ªé‡è½½çš„<code>set</code>æ–¹æ³•ï¼ˆå¦åˆ™å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ï¼‰ï¼Œå¦‚æœé›†åˆçš„å¤§å°æ˜¯å¯å˜çš„ï¼Œè¿˜è¦å†å¦å¤–é‡å†™ä¸¤ä¸ªé‡è½½çš„<code>add</code>æ–¹æ³•å’Œä¸€ä¸ª<code>remove</code>æ–¹æ³•ã€‚</p><p>æ­¤å¤–ï¼Œå®ç°ç±»åŒæ ·åº”è¯¥éµå¾ª<code>Collection</code>æ¥å£ä¸­æå‡ºçš„è§„èŒƒï¼šå¿…é¡»æä¾›ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼š<code>void</code>æ— å‚æ„é€ å™¨å’Œå¸¦<code>Collection</code>ç±»å‹çš„å•ä¸ªå‚æ•°çš„æ„é€ å™¨ã€‚</p><p>ä¸å…¶å®ƒæŠ½è±¡é›†åˆå®ç°ä¸åŒï¼Œæ­¤ç±»çš„å®ç°ç±»ä¸æ˜¯å¿…é¡»è¦æä¾›è¿­ä»£å™¨å®ç°ï¼›æ­¤ç±»çš„è¿­ä»£å™¨å’Œåˆ—è¡¨è¿­ä»£å™¨æ˜¯åœ¨â€œéšæœºè®¿é—®â€æ–¹æ³•ä¹‹ä¸Šç”±æ­¤ç±»è‡ªèº«è¿›è¡Œå®ç°çš„ã€‚</p><p>â€œéšæœºè®¿é—®â€æ–¹æ³•ï¼ˆç´¢å¼•è®¿é—®ï¼‰æœ‰ï¼š</p><ul><li><code>get(int)</code></li><li><code>set(int, Object)</code></li><li><code>set(int, E)</code></li><li><code>add(int Object)</code></li><li><code>add(int, E)</code></li><li><code>remove(int)</code></li></ul><h2 id="æºç è¯¦è§£"><a href="#æºç è¯¦è§£" class="headerlink" title="æºç è¯¦è§£"></a>æºç è¯¦è§£</h2><h3 id="æ„é€ å™¨"><a href="#æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨"></a>æ„é€ å™¨</h3><p>åªæœ‰ä¸€ä¸ªä½¿ç”¨<code>protected</code>ä¿®é¥°ç¬¦ä¿®é¥°çš„æ— å‚æ„é€ å™¨ã€‚è¯´æ˜è¯¥æŠ½è±¡ç±»ä¸å…è®¸å¤–éƒ¨ç›´æ¥å®ä¾‹åŒ–ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªéª¨æ¶å®ç°ï¼Œå¹¶ä¸æä¾›æœ‰åºé›†åˆçš„å®Œæ•´åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">AbstractList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æˆå‘˜å˜é‡"><a href="#æˆå‘˜å˜é‡" class="headerlink" title="æˆå‘˜å˜é‡"></a>æˆå‘˜å˜é‡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">transient</span> <span class="keyword">int</span> modCount = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>åªæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œè¡¨ç¤ºè¯¥åˆ—è¡¨è¢«ç»“æ„ä¿®æ”¹çš„æ¬¡æ•°ã€‚</p><p>ç»“æ„ä¿®æ”¹æ˜¯æŒ‡ï¼šæ›´æ”¹åˆ—è¡¨å¤§å°æˆ–ä»¥å…¶å®ƒæ–¹å¼å¹²æ‰°åˆ—è¡¨ã€‚</p><p>æ­¤å­—æ®µç”±<code>iterator</code>å’Œ<code>listIterator</code>æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨ä½¿ç”¨ã€‚å¦‚æœåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä¿®æ”¹äº†è¯¥å­—æ®µçš„å€¼ï¼Œåˆ™è¿­ä»£å™¨å°†åœ¨<code>next</code>ã€<code>remove</code>å’Œ<code>previous</code>æ–¹æ³•ä¸­æŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ã€‚è¿™é‡Œå°±æ˜¯<code>Java</code>æ™®é€šé›†åˆçš„<code>fail-fast</code>æœºåˆ¶ã€‚å¦åˆ™å°†å‡ºç°ä¸ç¡®å®šçš„è¡Œä¸ºã€‚</p><p>å­ç±»å¯¹è¯¥å­—æ®µçš„ä½¿ç”¨æ˜¯å¯é€‰çš„ï¼Œå½“å­ç±»éœ€è¦æä¾›å…·æœ‰<code>fail-fast</code>æœºåˆ¶çš„è¿­ä»£å™¨ï¼ˆæˆ–åˆ—è¡¨è¿­ä»£å™¨ï¼‰æ—¶ï¼Œåªéœ€åœ¨å…¶<code>add</code>å’Œ<code>remove</code>æ–¹æ³•ä¸­ä¿®æ”¹è¯¥å­—æ®µçš„å€¼ï¼Œä¸€æ¬¡è°ƒç”¨<code>add</code>æˆ–<code>remove</code>æ–¹æ³•å¿…é¡»ä¿®æ”¹è¯¥å€¼ä¸”ä¸è¶…è¿‡<code>1</code>ã€‚å¦åˆ™è¿­ä»£å™¨å°†æŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ï¼›å½“å­ç±»ä¸éœ€è¦æä¾›å…·æœ‰<code>fail-fast</code>æœºåˆ¶çš„è¿­ä»£å™¨æ—¶ï¼Œå¯ç›´æ¥å¿½ç•¥è¯¥å­—æ®µã€‚</p><h3 id="æŠ½è±¡æ–¹æ³•"><a href="#æŠ½è±¡æ–¹æ³•" class="headerlink" title="æŠ½è±¡æ–¹æ³•"></a>æŠ½è±¡æ–¹æ³•</h3><p>è¯¥ç±»ä¸­åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç”¨äºæ”¯æŒéšæœºå¿«é€Ÿè®¿é—®ï¼ˆæ ¹æ®ç´¢å¼•å–å€¼ï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="å·²å®ç°æ–¹æ³•"><a href="#å·²å®ç°æ–¹æ³•" class="headerlink" title="å·²å®ç°æ–¹æ³•"></a>å·²å®ç°æ–¹æ³•</h3><p>æ‰€æœ‰çš„å®ç°æ–¹æ³•éƒ½æ˜¯åŸºäºè¯¥ç±»çš„æŠ½è±¡æ–¹æ³•æˆ–å…¶å®ƒå·²å®ç°æ–¹æ³•ï¼Œå¤§éƒ¨åˆ†å®ç°æ˜¯åŸºäºè¿­ä»£å™¨çš„ã€‚éƒ¨åˆ†æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ï¼Œè¿™æ ·çš„å®ç°è¡¨ç¤ºè¯¥æ–¹æ³•éœ€è¦å­ç±»è¿›è¡Œé‡å†™å®ç°ã€‚æ€»çš„æ¥çœ‹ï¼Œè¯¥ç±»æä¾›äº†æœ‰åºé›†åˆçš„æ¨¡æ¿å®ç°ã€‚ä¸‹é¢æˆ‘ä»¬æ¥å…·ä½“çš„åˆ†ææ¯ä¸ªæ–¹æ³•ã€‚</p><h4 id="å¿«é€Ÿè®¿é—®"><a href="#å¿«é€Ÿè®¿é—®" class="headerlink" title="å¿«é€Ÿè®¿é—®"></a>å¿«é€Ÿè®¿é—®</h4><h5 id="æ·»åŠ æŒ‡å®šå…ƒç´ è‡³åˆ—è¡¨æœ«å°¾"><a href="#æ·»åŠ æŒ‡å®šå…ƒç´ è‡³åˆ—è¡¨æœ«å°¾" class="headerlink" title="æ·»åŠ æŒ‡å®šå…ƒç´ è‡³åˆ—è¡¨æœ«å°¾"></a>æ·»åŠ æŒ‡å®šå…ƒç´ è‡³åˆ—è¡¨æœ«å°¾</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    add(size(), e);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨äº†é‡è½½çš„<code>add</code>æ–¹æ³•ï¼Œä¼ å…¥<code>size()</code>æ–¹æ³•çš„è¿”å›å€¼å’ŒæŒ‡å®šå…ƒç´ ï¼Œç„¶åè¿”å›<code>true</code>ã€‚</p><p>åªè¦é‡è½½çš„<code>add</code>æ–¹æ³•ä¸­ä¸å‡ºç°å¼‚å¸¸ï¼Œåˆ™è¯¥<code>add</code>æ–¹æ³•å§‹ç»ˆè¿”å›<code>true</code>ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ”¯æŒæ­¤æ“ä½œçš„åˆ—è¡¨å¯èƒ½ä¼šå¯¹å¯ä»¥æ·»åŠ è‡³åˆ—è¡¨çš„å…ƒç´ è¿›è¡Œé™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒæŸäº›åˆ—è¡¨æ‹’ç»æ·»åŠ <code>null</code>å…ƒç´ ï¼Œè€Œå¦ä¸€äº›å¯¹å¯èƒ½æ·»åŠ çš„å…ƒç´ è¿›è¡Œç±»å‹é™åˆ¶ã€‚æ‰€ä»¥å®ç°ç±»åº”åœ¨å…¶æ–‡æ¡£ä¸­æ˜ç¡®æŒ‡å‡ºå¯¹å¯ä»¥æ·»åŠ çš„å…ƒç´ æœ‰å“ªäº›é™åˆ¶ã€‚</p><h5 id="åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ "><a href="#åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ " class="headerlink" title="åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ "></a>åœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ï¼Œæ˜¯å¿…é¡»è¦å­ç±»é‡å†™è¿›è¡Œå…·ä½“å®ç°çš„ã€‚</p><h5 id="ç”¨æŒ‡å®šå…ƒç´ æ¥è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å€¼"><a href="#ç”¨æŒ‡å®šå…ƒç´ æ¥è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å€¼" class="headerlink" title="ç”¨æŒ‡å®šå…ƒç´ æ¥è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å€¼"></a>ç”¨æŒ‡å®šå…ƒç´ æ¥è¦†ç›–æŒ‡å®šç´¢å¼•ä½ç½®çš„å€¼</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ï¼Œæ˜¯å¿…é¡»è¦å­ç±»é‡å†™è¿›è¡Œå…·ä½“å®ç°çš„ã€‚</p><h5 id="æ·»åŠ æŒ‡å®šå…ƒç´ è‡³æŒ‡å®šç´¢å¼•ä½ç½®"><a href="#æ·»åŠ æŒ‡å®šå…ƒç´ è‡³æŒ‡å®šç´¢å¼•ä½ç½®" class="headerlink" title="æ·»åŠ æŒ‡å®šå…ƒç´ è‡³æŒ‡å®šç´¢å¼•ä½ç½®"></a>æ·»åŠ æŒ‡å®šå…ƒç´ è‡³æŒ‡å®šç´¢å¼•ä½ç½®</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ï¼Œæ˜¯å¿…é¡»è¦å­ç±»é‡å†™è¿›è¡Œå…·ä½“å®ç°çš„ã€‚</p><h5 id="åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "><a href="#åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ " class="headerlink" title="åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ "></a>åˆ é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ï¼Œæ˜¯å¿…é¡»è¦å­ç±»é‡å†™è¿›è¡Œå…·ä½“å®ç°çš„ã€‚</p><h4 id="æŸ¥è¯¢æ“ä½œ"><a href="#æŸ¥è¯¢æ“ä½œ" class="headerlink" title="æŸ¥è¯¢æ“ä½œ"></a>æŸ¥è¯¢æ“ä½œ</h4><h5 id="æŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®"><a href="#æŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®" class="headerlink" title="æŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®"></a>æŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    ListIterator&lt;E&gt; it = listIterator();</span><br><span class="line">    <span class="keyword">if</span> (o==<span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext())</span><br><span class="line">            <span class="keyword">if</span> (it.next()==<span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">return</span> it.previousIndex();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext())</span><br><span class="line">            <span class="keyword">if</span> (o.equals(it.next()))</span><br><span class="line">                <span class="keyword">return</span> it.previousIndex();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•çš„å®ç°ä¸ºï¼šé¦–å…ˆè°ƒç”¨è¯¥ç±»çš„<code>listIterator()</code>æ–¹æ³•è·å–ä¸€ä¸ªæŒ‡å‘åˆ—è¡¨å¼€å¤´çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åï¼Œä»å‰å¾€åéå†åˆ—è¡¨ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡æ‰¾åˆ°æŒ‡å®šçš„å…ƒç´ æˆ–åˆ°è¾¾åˆ—è¡¨çš„æœ«å°¾ï¼ˆè¿”å›<code>-1</code>ï¼‰ã€‚</p><h5 id="æŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®"><a href="#æŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®" class="headerlink" title="æŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®"></a>æŸ¥è¯¢æŒ‡å®šå…ƒç´ åœ¨åˆ—è¡¨ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ä½ç½®</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lastIndexOf</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    ListIterator&lt;E&gt; it = listIterator(size());</span><br><span class="line">    <span class="keyword">if</span> (o==<span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasPrevious())</span><br><span class="line">            <span class="keyword">if</span> (it.previous()==<span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">return</span> it.nextIndex();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasPrevious())</span><br><span class="line">            <span class="keyword">if</span> (o.equals(it.previous()))</span><br><span class="line">                <span class="keyword">return</span> it.nextIndex();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•çš„å®ç°ä¸ºï¼šé¦–å…ˆè°ƒç”¨è¯¥ç±»çš„<code>listIterator()</code>æ–¹æ³•ä¼ å…¥<code>size()</code>æ–¹æ³•çš„è¿”å›å€¼ï¼ˆè¯¥åˆ—è¡¨çš„å¤§å°ï¼‰è·å–ä¸€ä¸ªæŒ‡å‘åˆ—è¡¨æœ«å°¾çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åï¼Œä»åå¾€å‰éå†åˆ—è¡¨ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡æ‰¾åˆ°æŒ‡å®šçš„å…ƒç´ æˆ–åˆ°è¾¾åˆ—è¡¨çš„å¼€å¤´ï¼ˆè¿”å›<code>-1</code>ï¼‰ã€‚</p><h4 id="æ‰¹é‡æ“ä½œ"><a href="#æ‰¹é‡æ“ä½œ" class="headerlink" title="æ‰¹é‡æ“ä½œ"></a>æ‰¹é‡æ“ä½œ</h4><h5 id="æ¸…ç©ºåˆ—è¡¨"><a href="#æ¸…ç©ºåˆ—è¡¨" class="headerlink" title="æ¸…ç©ºåˆ—è¡¨"></a>æ¸…ç©ºåˆ—è¡¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    removeRange(<span class="number">0</span>, size());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ é™¤æ­¤åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå†…éƒ¨è°ƒç”¨çš„æ˜¯<code>removeRange</code>æ–¹æ³•ã€‚å­ç±»å¿…é¡»é‡å†™æœ¬ç±»çš„<code>remove</code>æˆ–<code>removeRange</code>æ–¹æ³•ï¼Œå¦åˆ™å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹<code>removeRange</code>æ–¹æ³•çš„å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">removeRange</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex)</span> </span>&#123;</span><br><span class="line">    ListIterator&lt;E&gt; it = listIterator(fromIndex);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>, n=toIndex-fromIndex; i&lt;n; i++) &#123;</span><br><span class="line">        it.next();</span><br><span class="line">        it.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»è¯¥åˆ—è¡¨ä¸­åˆ é™¤ç´¢å¼•ä»‹äº<code>fromIndex</code>å’Œ<code>toIndex</code>ä¹‹é—´çš„å…ƒç´ ï¼Œå°†<code>toIndex</code>ç´¢å¼•åçš„æ‰€æœ‰å…ƒç´ å·¦ç§»ã€‚å½“<code>fromIndex</code>ç­‰äº<code>toIndex</code>æ—¶ï¼Œæ­¤æ–¹æ³•ä¸ä¼šåšä»»ä½•æ“ä½œã€‚</p><p>å…¥å‚æœ‰ä¸¤ä¸ªï¼š</p><ul><li><code>fromIndex</code>ï¼šè¦åˆ é™¤çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ï¼›</li><li><code>toIndex</code>ï¼šè¦åˆ é™¤çš„æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„ç´¢å¼•ã€‚</li></ul><p>é¦–å…ˆè°ƒç”¨<code>listIterator(fromIndex)</code>æ–¹æ³•è·å–ä½äº<code>fromIndex</code>ä¹‹å‰çš„åˆ—è¡¨è¿­ä»£å™¨ï¼Œç„¶åè¿­ä»£ç´¢å¼•åŒºé—´ä¸º<code>[0,toIndex-fromIndex)</code>çš„å…ƒç´ ï¼Œåœ¨æ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨<code>ListIterator.next</code>æ–¹æ³•è·å–ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åè°ƒç”¨<code>ListIterator.remove</code>æ–¹æ³•åˆ é™¤å½“å‰è¿­ä»£ç´¢å¼•å…ƒç´ ï¼Œç›´åˆ°åˆ é™¤äº†æ•´ä¸ªèŒƒå›´å†…çš„å…ƒç´ ä¸ºæ­¢ã€‚</p><p>å¦‚æœ<code>ListIterator.remove</code>æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ã€‚</p><h5 id="å°†æŒ‡å®šé›†åˆä»æŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹æ’å…¥"><a href="#å°†æŒ‡å®šé›†åˆä»æŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹æ’å…¥" class="headerlink" title="å°†æŒ‡å®šé›†åˆä»æŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹æ’å…¥"></a>å°†æŒ‡å®šé›†åˆä»æŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹æ’å…¥</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line">    <span class="keyword">boolean</span> modified = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (E e : c) &#123;</span><br><span class="line">        add(index++, e);</span><br><span class="line">        modified = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> modified;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†æŒ‡å®šé›†åˆ<code>c</code>ä»ç´¢å¼•ä¸º<code>index</code>çš„ä½ç½®å¼€å§‹æ’å…¥ï¼Œéœ€è¦å­ç±»å®ç°<code>add(int,E)</code>æ–¹æ³•ï¼Œå¦åˆ™å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚</p><p>é¦–å…ˆè°ƒç”¨<code>rangeCheckForAdd(index)</code>æ–¹æ³•æ ¡éªŒç´¢å¼•èŒƒå›´ï¼ˆåŒºé—´ä¸º<code>[0,size())</code>ï¼‰ï¼Œç„¶åè¿­ä»£æŒ‡å®šé›†åˆ<code>c</code>ï¼Œä½¿ç”¨<code>add(int,E)</code>æ–¹æ³•è¿›è¡Œæ’å…¥ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå­ç±»ä¼šé€‰æ‹©é‡å†™è¯¥æ–¹æ³•æ¥æé«˜æ‰¹é‡æ’å…¥æ•ˆç‡ã€‚</p><h4 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h4><h5 id="æ™®é€šè¿­ä»£å™¨"><a href="#æ™®é€šè¿­ä»£å™¨" class="headerlink" title="æ™®é€šè¿­ä»£å™¨"></a>æ™®é€šè¿­ä»£å™¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Itr();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥åˆ›å»ºå†…éƒ¨ç±»<code>Itr</code>çš„å®ä¾‹å¯¹è±¡è¿”å›ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸ªå†…éƒ¨ç±»<code>Itr</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Index of element to be returned by subsequent call to next.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">int</span> cursor = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Index of element returned by most recent call to next or</span></span><br><span class="line"><span class="comment">         * previous.  Reset to -1 if this element is deleted by a call</span></span><br><span class="line"><span class="comment">         * to remove.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">int</span> lastRet = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * The modCount value that the iterator believes that the backing</span></span><br><span class="line"><span class="comment">         * List should have.  If this expectation is violated, the iterator</span></span><br><span class="line"><span class="comment">         * has detected concurrent modification.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor != size();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            checkForComodification();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> i = cursor;</span><br><span class="line">                E next = get(i);</span><br><span class="line">                lastRet = i;</span><br><span class="line">                cursor = i + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">return</span> next;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException e) &#123;</span><br><span class="line">                checkForComodification();</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">            checkForComodification();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                AbstractList.<span class="keyword">this</span>.remove(lastRet);</span><br><span class="line">                <span class="keyword">if</span> (lastRet &lt; cursor)</span><br><span class="line">                    cursor--;</span><br><span class="line">                lastRet = -<span class="number">1</span>;</span><br><span class="line">                expectedModCount = modCount;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">checkForComodification</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (modCount != expectedModCount)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æœ‰ä¸‰ä¸ªæˆå‘˜å˜é‡ï¼š</p><ul><li><code>cursor</code>ï¼šæ¸¸æ ‡ï¼Œåˆå§‹åŒ–ä¸º<code>0</code>ï¼Œåç»­è°ƒç”¨è¯¥å†…éƒ¨ç±»çš„<code>next</code>æ–¹æ³•è¿”å›çš„å…ƒç´ ç´¢å¼•ã€‚</li><li><code>lastRet</code>ï¼šåˆå§‹åŒ–ä¸º<code>-1</code>ï¼Œæœ€è¿‘ä¸€æ¬¡è°ƒç”¨<code>next</code>æˆ–<code>previous</code>æ–¹æ³•è¿”å›çš„å…ƒç´ ç´¢å¼•ã€‚å¦‚æœä¸€æ¬¡è°ƒç”¨ä¸­åˆ é™¤äº†å½“å‰æŒ‡å‘çš„å…ƒç´ ï¼Œåˆ™å°†å…¶é‡ç½®ä¸º<code>-1</code>ã€‚</li><li><code>expectedModCount</code>ï¼šæœŸæœ›ä¿®æ”¹æ¬¡æ•°ï¼Œåˆå§‹åŒ–ä¸ºå¤–éƒ¨ç±»<code>AbstractList</code>çš„æˆå‘˜å˜é‡<code>modCount</code>ï¼Œè¿­ä»£å™¨è®¤ä¸ºåç»­è¿­ä»£è¿‡ç¨‹ä¸­åˆ—è¡¨åº”è¯¥å…·æœ‰çš„<code>modCount</code>å€¼ï¼Œå¦‚æœæœŸæœ›å€¼ä¸å®é™…<code>modCount</code>å€¼ä¸ç›¸ç­‰ï¼Œåˆ™å‡ºç°äº†å¹¶å‘ä¿®æ”¹çš„æƒ…å†µã€‚</li></ul><p>æœ‰ä¸‰ä¸ªå…¬å…±æ–¹æ³•ï¼š</p><p>1ã€åˆ¤æ–­æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cursor != size();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­å½“å‰æ¸¸æ ‡æ˜¯å¦ç­‰äºåˆ—è¡¨å¤§å°ã€‚<code>size()</code>æ–¹æ³•ä¸ºçˆ¶ç±»<code>AbstractCollection</code>ä¸­çš„æŠ½è±¡<code>size()</code>æ–¹æ³•ã€‚</p><p>2ã€è·å–å½“å‰æ¸¸æ ‡ç´¢å¼•æŒ‡å‘çš„å…ƒç´ ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    checkForComodification();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> i = cursor;</span><br><span class="line">        E next = get(i);</span><br><span class="line">        lastRet = i;</span><br><span class="line">        cursor = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> next;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException e) &#123;</span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè°ƒç”¨å½“å‰å†…éƒ¨ç±»çš„<code>checkForComodification()</code>æ–¹æ³•æ ¡éªŒæœŸæœ›ä¿®æ”¹æ¬¡æ•°<code>expectedModCount</code>æ˜¯å¦ç­‰äºå®é™…ä¿®æ”¹æ¬¡æ•°<code>modCount</code>ã€‚å¦‚æœä¸ç›¸ç­‰ï¼Œåˆ™å·²å‡ºç°å¹¶å‘ä¿®æ”¹ï¼ŒæŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ã€‚</p><p>ç„¶åè°ƒç”¨å¤–éƒ¨ç±»<code>AbstractList</code>çš„æŠ½è±¡æ–¹æ³•<code>get(int)</code>æ ¹æ®å½“å‰æ¸¸æ ‡ç´¢å¼•å–å€¼ï¼Œå°†å½“å‰æ¸¸æ ‡å€¼èµ‹ç»™æˆå‘˜å˜é‡<code>lastRet</code>ï¼Œå½“å‰æ¸¸æ ‡å³ç§»ä¸€ä½ï¼Œæœ€åè¿”å›å–åˆ°çš„å…ƒç´ ã€‚</p><p>å…ˆæ ¡éªŒ<code>modCount</code>çš„å€¼ï¼Œå¦‚æœåœ¨æ ¡éªŒé€šè¿‡ä¸”ä»£ç æ‰§è¡Œåˆ°<code>get(i)</code>ä¹‹å‰æ—¶æœ‰å…¶å®ƒçº¿ç¨‹ä¿®æ”¹äº†å½“å‰åˆ—è¡¨çš„å¤§å°ï¼Œåˆ™å¯èƒ½ä¼šå‡ºç°ç´¢å¼•è¶Šç•Œ<code>IndexOutOfBoundsException</code>çš„å¼‚å¸¸ï¼Œæ­¤æ—¶å°†å…¶æ•è·ï¼Œåœ¨<code>catch</code>å—ä¸­å†æ¬¡è¿›è¡Œ<code>modCount</code>æ ¡éªŒï¼Œå¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œåˆ™ä¼šç›´æ¥æŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ï¼›ä½†å¯èƒ½åœ¨è¿™æ¬¡æ ¡éªŒä¹‹å‰åˆæœ‰å…¶å®ƒçº¿ç¨‹å°†å½“å‰åˆ—è¡¨è¿˜åŸäº†ï¼Œæ­¤æ—¶æ ¡éªŒåˆä¼šé€šè¿‡ï¼Œæ‰€ä»¥åœ¨æ ¡éªŒä¹‹åä¸»åŠ¨æŠ›å‡º<code>NoSuchElementException</code>å¼‚å¸¸ã€‚</p><p>3ã€åˆ é™¤æœ€è¿‘ä¸€æ¬¡é€šè¿‡<code>next</code>æ–¹æ³•è·å–åˆ°çš„å…ƒç´ ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">    checkForComodification();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        AbstractList.<span class="keyword">this</span>.remove(lastRet);</span><br><span class="line">        <span class="keyword">if</span> (lastRet &lt; cursor)</span><br><span class="line">            cursor--;</span><br><span class="line">        lastRet = -<span class="number">1</span>;</span><br><span class="line">        expectedModCount = modCount;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå¦‚æœ<code>lastRet</code>å°äº<code>0</code>ï¼Œåˆ™è¯¥è¿­ä»£å™¨çš„<code>next</code>æ–¹æ³•æœªå…ˆè°ƒç”¨ï¼ŒæŠ›å‡º<code>IllegalStateException</code>å¼‚å¸¸ã€‚</p><p>ç„¶åæ£€æŸ¥<code>expectedModCount</code>ä¸<code>modCount</code>æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰åˆ™å‡ºç°å¹¶å‘ä¿®æ”¹ï¼ŒæŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ã€‚</p><p>æ¥ä¸‹æ¥è°ƒç”¨å¤–éƒ¨ç±»<code>AbstractList</code>çš„<code>remove</code>æ–¹æ³•ï¼Œåˆ é™¤ä¸Šæ¬¡é€šè¿‡<code>next</code>æ–¹æ³•è·å–åˆ°çš„å…ƒç´ ã€‚æ‰€ä»¥<code>AbstractList</code>çš„å­ç±»å¿…é¡»é‡å†™<code>AbstractList</code>ç±»çš„<code>remove</code>æ–¹æ³•ã€‚</p><p>åˆ é™¤å…ƒç´ ä¹‹åï¼Œå°†æ¸¸æ ‡å·¦ç§»ä¸€ä½ï¼Œæ­¤æ—¶æŒ‡å‘çš„æ˜¯åˆ é™¤çš„å…ƒç´ ä¹‹åçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ç„¶åé‡ç½®<code>lastRet=-1</code>ï¼Œé‡æ–°å°†ä¿®æ”¹è¿‡åçš„<code>modCount</code>èµ‹ç»™<code>expectedModCount</code>ã€‚</p><blockquote><p>è§£é‡Šï¼š</p><p>ä¾‹å¦‚åˆ—è¡¨<code>A,B,C</code>ã€‚</p><p>åˆå§‹çŠ¶æ€ï¼šåˆå§‹æ¸¸æ ‡<code>cursor</code>ä¸º<code>0</code>æŒ‡å‘å…ƒç´ <code>A</code>ï¼Œ<code>lastRet=-1</code>ï¼›</p><p>ç¬¬ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼šæ¸¸æ ‡<code>cursor</code>å³ç§»ä¸€ä½ä¸º<code>1</code>æŒ‡å‘å…ƒç´ <code>B</code>ï¼Œ<code>lastRet=0</code>ï¼›</p><p>æ­¤æ—¶è°ƒç”¨<code>AbstractList</code>çš„<code>remove</code>æ–¹æ³•ï¼šåˆ é™¤ç´¢å¼•ä¸º<code>lastRet=0</code>çš„å…ƒç´ <code>A</code>ï¼Œ<code>lastRet=0 &lt; cursor=1</code>ï¼Œæ¸¸æ ‡å·¦ç§»ä¸€ä½ä¸º<code>0</code>æŒ‡å‘å…ƒç´ <code>B</code>ï¼Œé‡ç½®<code>lastRet=-1</code>å¹¶å°†<code>modCount</code>é‡æ–°èµ‹å€¼ç»™<code>expectedModCount</code>ã€‚</p><p>ç”±äºè°ƒç”¨è¿‡å¤–éƒ¨ç±»<code>AbstractList</code>çš„<code>remove</code>æ–¹æ³•ï¼Œæ­¤æ—¶çš„<code>modCount</code>å€¼å·²ç»ä¿®æ”¹ã€‚</p></blockquote><h5 id="åˆ—è¡¨è¿­ä»£å™¨"><a href="#åˆ—è¡¨è¿­ä»£å™¨" class="headerlink" title="åˆ—è¡¨è¿­ä»£å™¨"></a>åˆ—è¡¨è¿­ä»£å™¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> listIterator(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è°ƒç”¨<code>listIterator(0)</code>æ–¹æ³•è¿”å›ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹è¯¥æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ListItr(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ ¡éªŒä¼ å…¥ç´¢å¼•<code>index</code>èŒƒå›´ï¼Œç„¶åç›´æ¥ä¸€ä¸ªè¿”å›<code>ListItr</code>çš„å®ä¾‹å¯¹è±¡ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹<code>ListItr</code>çš„å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ListItr</span> <span class="keyword">extends</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">ListIterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">        ListItr(<span class="keyword">int</span> index) &#123;</span><br><span class="line">            cursor = index;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPrevious</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor != <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> E <span class="title">previous</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            checkForComodification();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> i = cursor - <span class="number">1</span>;</span><br><span class="line">                E previous = get(i);</span><br><span class="line">                lastRet = cursor = i;</span><br><span class="line">                <span class="keyword">return</span> previous;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException e) &#123;</span><br><span class="line">                checkForComodification();</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">nextIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">previousIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor-<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">            checkForComodification();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                AbstractList.<span class="keyword">this</span>.set(lastRet, e);</span><br><span class="line">                expectedModCount = modCount;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">            checkForComodification();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> i = cursor;</span><br><span class="line">                AbstractList.<span class="keyword">this</span>.add(i, e);</span><br><span class="line">                lastRet = -<span class="number">1</span>;</span><br><span class="line">                cursor = i + <span class="number">1</span>;</span><br><span class="line">                expectedModCount = modCount;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¯¥ç±»ç»§æ‰¿äº†å†…éƒ¨ç±»<code>Itr</code>å¹¶å®ç°äº†<code>ListIterator</code>æ¥å£ã€‚</p><p>ç»§æ‰¿å¾—åˆ°äº†<code>Itr</code>ç±»çš„ä¸‰ä¸ªå±æ€§ï¼š<code>cursor</code>ã€<code>lastRet</code>å’Œ<code>expectedModCount</code>ã€‚</p><p>åªæœ‰ä¸€ä¸ªå¸¦å‚æ„é€ å™¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ListItr(<span class="keyword">int</span> index) &#123;</span><br><span class="line">    cursor = index;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®©æ¸¸æ ‡æŒ‡å‘ä¼ å…¥çš„ç´¢å¼•<code>index</code>ã€‚</p><p>é‡å†™äº†<code>ListIterator</code>æ¥å£çš„å…­ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬æ¥ä¾æ¬¡çœ‹ä¸‹å®ç°ï¼š</p><p>1ã€åˆ¤æ–­æ˜¯å¦æœ‰å‰ä¸€ä¸ªå…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPrevious</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cursor != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥åˆ¤æ–­å½“å‰æ¸¸æ ‡<code>cursor</code>æ˜¯å¦æŒ‡å‘<code>0</code>ï¼Œä¸º<code>0</code>è¡¨ç¤ºæŒ‡å‘åˆ—è¡¨å¼€å§‹ä½ç½®ï¼Œæ— å‰ä¸€ä¸ªå…ƒç´ ã€‚</p><p>2ã€è·å–å‰ä¸€ä¸ªå…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">previous</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    checkForComodification();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> i = cursor - <span class="number">1</span>;</span><br><span class="line">        E previous = get(i);</span><br><span class="line">        lastRet = cursor = i;</span><br><span class="line">        <span class="keyword">return</span> previous;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException e) &#123;</span><br><span class="line">        checkForComodification();</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å–å½“å‰æ¸¸æ ‡æŒ‡å‘ç´¢å¼•çš„å‰ä¸€ä½<code>i</code>ï¼Œè·å–å…¶å…ƒç´ å€¼<code>previous</code>ï¼Œå°†ç´¢å¼•<code>i</code>èµ‹å€¼ç»™æ¸¸æ ‡<code>cursor</code>å’Œæœ€åè¿”å›å…ƒç´ ç´¢å¼•<code>lastRet</code>ï¼Œæœ€åè¿”å›å…ƒç´ <code>previous</code>ã€‚æ ¡éªŒé€»è¾‘åŒ<code>Itr</code>è¿­ä»£å™¨çš„<code>next</code>æ–¹æ³•ã€‚</p><p>3ã€è·å–ä¸‹ä¸€ä¸ªå³å°†è¿­ä»£å…ƒç´ ç´¢å¼•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">nextIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cursor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è¿”å›æ¸¸æ ‡<code>cursor</code>ã€‚</p><p>4ã€è·å–å³å°†è¿­ä»£å…ƒç´ çš„å‰ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">previousIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cursor-<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è¿”å›æ¸¸æ ‡<code>cursor</code>å‡ä¸€ã€‚</p><p>5ã€ç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢æœ€è¿‘ä¸€æ¬¡è¿­ä»£è¿”å›çš„å…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">    checkForComodification();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        AbstractList.<span class="keyword">this</span>.set(lastRet, e);</span><br><span class="line">        expectedModCount = modCount;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»…èƒ½åœ¨ä¸Šæ¬¡è°ƒç”¨<code>next</code>æˆ–<code>previous</code>æ–¹æ³•ä¹‹åæ²¡æœ‰è°ƒç”¨è¿­ä»£å™¨çš„<code>remove</code>æˆ–<code>add</code>æ–¹æ³•çš„æƒ…å†µä¸‹æ‰èƒ½è°ƒç”¨ã€‚</p><p>è°ƒç”¨äº†å¤–éƒ¨æŠ½è±¡ç±»<code>AbstractList</code>çš„<code>set</code>æ–¹æ³•å°†<code>lastRet</code>ç´¢å¼•æŒ‡å‘çš„å…ƒç´ æ›¿æ¢æˆæŒ‡å®šå…ƒç´ <code>e</code>ï¼Œç„¶åå°†å®é™…<code>modCount</code>èµ‹ç»™æœŸæœ›ä¿®æ”¹æ¬¡æ•°<code>expectedModCount</code>ã€‚æ ¡éªŒé€»è¾‘åŒ<code>Itr</code>è¿­ä»£å™¨çš„<code>remove</code>æ–¹æ³•ã€‚</p><p>6ã€æ’å…¥æŒ‡å®šå…ƒç´ è‡³åˆ—è¡¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    checkForComodification();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> i = cursor;</span><br><span class="line">        AbstractList.<span class="keyword">this</span>.add(i, e);</span><br><span class="line">        lastRet = -<span class="number">1</span>;</span><br><span class="line">        cursor = i + <span class="number">1</span>;</span><br><span class="line">        expectedModCount = modCount;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†æŒ‡å®šå…ƒç´ <code>e</code>æ’å…¥åˆ—è¡¨ï¼Œè¯¥å…ƒç´ çš„æ’å…¥ä½ç½®ä¸ºï¼š<code>next</code>æ–¹æ³•è¿”å›çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰å…ƒç´ ï¼‰ä¹‹å‰å’Œ<code>previous</code>æ–¹æ³•è¿”å›çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰å…ƒç´ ï¼‰ä¹‹åã€‚å¦‚æœåˆ—è¡¨ä¸­æœ¬æ¥ä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œåˆ™æŒ‡å®šå…ƒç´ <code>e</code>å°†æˆä¸ºåˆ—è¡¨ä¸­çš„å”¯ä¸€å…ƒç´ ã€‚è°ƒç”¨æ­¤æ–¹æ³•åï¼Œ<code>nextIndex</code>å’Œ<code>previousIndex</code>æ–¹æ³•çš„è°ƒç”¨è¿”å›å€¼å°†å¢åŠ ä¸€ã€‚</p><p>é¦–å…ˆè·å–å½“å‰æ¸¸æ ‡æŒ‡å‘ç´¢å¼•<code>i</code>ï¼Œç„¶åè°ƒç”¨å¤–éƒ¨ç±»<code>AbstractList</code>çš„<code>add</code>æ–¹æ³•å°†æŒ‡å®šå…ƒç´ <code>e</code>æ’å…¥æŒ‡å®šç´¢å¼•<code>i</code>ä½ç½®ã€‚å°†<code>lastRet</code>é‡ç½®ä¸º<code>-1</code>ï¼Œæ¸¸æ ‡<code>cursor</code>å¢ä¸€ï¼Œå³ä¸‹æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•å°†è¿”å›æŒ‡å®šå…ƒç´ <code>e</code>ä¹‹åçš„å…ƒç´ ï¼Œè€Œè°ƒç”¨<code>previous</code>æ–¹æ³•å°†è¿”å›æŒ‡å®šå…ƒç´ <code>e</code>ã€‚æœ€åå°†å®é™…<code>modCount</code>èµ‹ç»™æœŸæœ›ä¿®æ”¹æ¬¡æ•°<code>expectedModCount</code>ã€‚æ ¡éªŒé€»è¾‘åŒ<code>set</code>æ–¹æ³•ã€‚</p><h4 id="æ¯”è¾ƒå’Œå“ˆå¸Œ"><a href="#æ¯”è¾ƒå’Œå“ˆå¸Œ" class="headerlink" title="æ¯”è¾ƒå’Œå“ˆå¸Œ"></a>æ¯”è¾ƒå’Œå“ˆå¸Œ</h4><h5 id="equalsæ¯”è¾ƒ"><a href="#equalsæ¯”è¾ƒ" class="headerlink" title="equalsæ¯”è¾ƒ"></a><code>equals</code>æ¯”è¾ƒ</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="keyword">this</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> List))</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    ListIterator&lt;E&gt; e1 = listIterator();</span><br><span class="line">    ListIterator&lt;?&gt; e2 = ((List&lt;?&gt;) o).listIterator();</span><br><span class="line">    <span class="keyword">while</span> (e1.hasNext() &amp;&amp; e2.hasNext()) &#123;</span><br><span class="line">        E o1 = e1.next();</span><br><span class="line">        Object o2 = e2.next();</span><br><span class="line">        <span class="keyword">if</span> (!(o1==<span class="keyword">null</span> ? o2==<span class="keyword">null</span> : o1.equals(o2)))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> !(e1.hasNext() || e2.hasNext());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒæŒ‡å®šå¯¹è±¡ä¸æ­¤å¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚å½“ä¸”ä»…å½“æŒ‡å®šå¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä¸”ä¸¤ä¸ªåˆ—è¡¨å…·æœ‰ç›¸åŒçš„å¤§å°ï¼Œå¹¶ä¸”ä¸¤ä¸ªåˆ—è¡¨ä¸­æ‰€æœ‰å¯¹åº”çš„å…ƒç´ ä¹Ÿå‡ç›¸ç­‰æ—¶ï¼Œè¿”å›<code>true</code>ã€‚åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ ç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼šå½“ä¸”ä»…å½“<code>e1 == null ? e2 == null : e1.equals(e2)</code>æ—¶ï¼Œä¸¤ä¸ªå…ƒç´ è®¤ä¸ºæ˜¯ç›¸ç­‰çš„ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨åŒ…å«ç›¸åŒé¡ºåºçš„ç›¸åŒå…ƒç´ ï¼Œåˆ™å°†å®ƒä»¬å®šä¹‰ä¸ºç›¸ç­‰ã€‚</p><p>æ­¤å®ç°é¦–å…ˆæ£€æŸ¥æŒ‡å®šçš„å¯¹è±¡æ˜¯å¦ä¸ºå½“å‰åˆ—è¡¨ï¼ˆ<code>==</code>åˆ¤æ–­åœ°å€æ˜¯å¦ç›¸ç­‰ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å›<code>true</code>ï¼›å¦‚æœä¸æ˜¯ï¼Œå°†æ£€æŸ¥æŒ‡å®šå¯¹è±¡æ˜¯å¦ä¸º<code>List</code>ç±»å‹ï¼Œå¦‚æœä¸æ˜¯åˆ™è¿”å›<code>false</code>ï¼›å¦‚æœæ˜¯ï¼Œåˆ™è¿­ä»£ä¸¤ä¸ªåˆ—è¡¨ï¼Œæ¯”è¾ƒç›¸å¯¹åº”çš„å…ƒç´ å¯¹ï¼Œå¦‚æœæœ‰ä»»ä½•æ¯”è¾ƒè¿”å›<code>false</code>ï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›<code>false</code>ã€‚å¦‚æœæ¯”è¾ƒå®Œæˆåä»»æ„ä¸€ä¸ªè¿­ä»£å™¨è¿˜æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›<code>false</code>ï¼ˆå› ä¸ºä¸¤ä¸ªåˆ—è¡¨é•¿åº¦ä¸ç›¸ç­‰ï¼‰ï¼Œå¦åˆ™è¿­ä»£å®Œæˆåå°†è¿”å›<code>true</code>ã€‚</p><h5 id="hashCode"><a href="#hashCode" class="headerlink" title="hashCode"></a><code>hashCode</code></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> hashCode = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (E e : <span class="keyword">this</span>)</span><br><span class="line">        hashCode = <span class="number">31</span>*hashCode + (e==<span class="keyword">null</span> ? <span class="number">0</span> : e.hashCode());</span><br><span class="line">    <span class="keyword">return</span> hashCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å®ç°å®Œå…¨ä½¿ç”¨<code>List#hashCode</code>æ–¹æ³•æ–‡æ¡£ä¸­å®šä¹‰çš„åˆ—è¡¨å“ˆå¸Œå‡½æ•°çš„ä»£ç ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹AbstractCollection</title>
      <link href="2020/05/05/javase/base/abstract-collection/"/>
      <url>2020/05/05/javase/base/abstract-collection/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>java.util.AbstractCollection</code>ç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå®ç°äº†<code>Collection</code>æ¥å£ã€‚ä»è®¾è®¡æ¨¡å¼çš„è§’åº¦æ¥çœ‹ï¼Œä»¥<code>Abstract</code>å¼€å¤´çš„ç±»åº”è¯¥æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ç±»ã€‚äº‹å®ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå®ƒæä¾›äº†å¯¹<code>Collection</code>æ¥å£çš„æœ€åŸºæœ¬å®ç°ã€‚ä»¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘å®ç°ç±»æ‰€éœ€çš„å·¥ä½œã€‚</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>è¯¥æŠ½è±¡ç±»åªæä¾›äº†é›†åˆçš„æœ€åŸºæœ¬å®ç°ï¼Œå¹¶æœªå¯¹å®ç°ç±»çš„ç‰¹æ€§è¿›è¡Œä»»ä½•é™åˆ¶ã€‚</p><p>å¦‚æœè¦å®ç°ä¸å¯ä¿®æ”¹çš„é›†åˆï¼Œåªéœ€ç»§æ‰¿è¯¥ç±»å¹¶ä¸º<code>iterator</code>å’Œ<code>size</code>æ–¹æ³•æä¾›å®ç°ï¼ˆç”±<code>iterator</code>æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨å¿…é¡»å®ç°<code>hasNext</code>å’Œ<code>next</code>æ–¹æ³•ï¼‰ï¼›å¦‚æœè¦å®ç°å¯ä¿®æ”¹çš„é›†åˆï¼Œåœ¨å®ç°ä¸å¯ä¿®æ”¹é›†åˆçš„åŸºç¡€ä¹‹ä¸Šï¼Œè¿˜è¦å¦å¤–é‡å†™æ­¤ç±»çš„<code>add</code>æ–¹æ³•ï¼ˆå¦åˆ™å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ï¼‰ï¼ŒåŒæ—¶ç”±<code>iterator</code>æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨å¿…é¡»å¦å¤–å®ç°å…¶<code>remove</code>æ–¹æ³•ã€‚</p><p>æ­¤å¤–ï¼Œå®ç°ç±»åŒæ ·åº”è¯¥éµå¾ª<code>Collection</code>æ¥å£ä¸­æå‡ºçš„è§„èŒƒï¼šå¿…é¡»æä¾›ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼š<code>void</code>æ— å‚æ„é€ å™¨å’Œå¸¦<code>Collection</code>ç±»å‹çš„å•ä¸ªå‚æ•°çš„æ„é€ å™¨ã€‚</p><p>æ‰€æœ‰æœªè¿›è¡Œå®ç°çš„æ–¹æ³•éƒ½è¢«æ ‡è®°ä¸ºæŠ½è±¡æ–¹æ³•å¾…å­ç±»å®ç°ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹åœ¨è¯¥æŠ½è±¡ç±»ä¸­æ˜¯å¦‚ä½•å¯¹é›†åˆè¿›è¡Œæœ€åŸºæœ¬å®ç°çš„ã€‚</p><h2 id="æºç è¯¦è§£"><a href="#æºç è¯¦è§£" class="headerlink" title="æºç è¯¦è§£"></a>æºç è¯¦è§£</h2><h3 id="æ„é€ å™¨"><a href="#æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨"></a>æ„é€ å™¨</h3><p>åªæœ‰ä¸€ä¸ªä½¿ç”¨<code>protected</code>ä¿®é¥°ç¬¦ä¿®é¥°çš„æ— å‚æ„é€ å™¨ã€‚è¯´æ˜è¯¥æŠ½è±¡ç±»ä¸å…è®¸å¤–éƒ¨ç›´æ¥å®ä¾‹åŒ–ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåªæ˜¯æœ€åŸºæœ¬çš„å®ç°ï¼Œå¹¶ä¸å…·å¤‡é›†åˆçš„å®Œæ•´åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">AbstractCollection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æˆå‘˜å˜é‡"><a href="#æˆå‘˜å˜é‡" class="headerlink" title="æˆå‘˜å˜é‡"></a>æˆå‘˜å˜é‡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_ARRAY_SIZE = Integer.MAX_VALUE - <span class="number">8</span>;</span><br></pre></td></tr></table></figure><p>åªæœ‰ä¸€ä¸ªé™æ€æˆå‘˜å˜é‡ï¼Œå®ƒè¡¨æ˜äº†è¦åˆ†é…çš„æ•°ç»„çš„æœ€å¤§å¤§å°ã€‚å¦‚æœè¶…å‡ºæ­¤é™åˆ¶å¯èƒ½ä¼šå¯¼è‡´<code>OutOfMemoryError</code>ã€‚</p><h3 id="æŠ½è±¡æ–¹æ³•"><a href="#æŠ½è±¡æ–¹æ³•" class="headerlink" title="æŠ½è±¡æ–¹æ³•"></a>æŠ½è±¡æ–¹æ³•</h3><p>æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•éƒ½æ˜¯å¾…å…·ä½“å­ç±»å»å®ç°çš„æ–¹æ³•ã€‚ä¸€å…±æœ‰ä¸¤ä¸ªï¼š</p><ul><li><code>public abstract Iterator&lt;E&gt; iterator();</code>ï¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ã€‚</li><li><code>public abstract int size();</code>ï¼šè®¡ç®—é›†åˆå¤§å°ã€‚</li></ul><h3 id="å·²å®ç°æ–¹æ³•"><a href="#å·²å®ç°æ–¹æ³•" class="headerlink" title="å·²å®ç°æ–¹æ³•"></a>å·²å®ç°æ–¹æ³•</h3><p>æ‰€æœ‰å®ç°æ–¹æ³•éƒ½æ˜¯æœ€åŸºæœ¬çš„å®ç°ï¼Œå½“å­ç±»æœ‰æ›´å¥½çš„å®ç°æ–¹å¼æ—¶å®Œå…¨å¯ä»¥è¿›è¡Œé‡å†™ã€‚</p><h4 id="æŸ¥è¯¢æ“ä½œ"><a href="#æŸ¥è¯¢æ“ä½œ" class="headerlink" title="æŸ¥è¯¢æ“ä½œ"></a>æŸ¥è¯¢æ“ä½œ</h4><h5 id="åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º"><a href="#åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º" class="headerlink" title="åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º"></a>åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> size() == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªéœ€åˆ¤æ–­<code>size()</code>æ–¹æ³•è®¡ç®—å‡ºçš„é›†åˆå¤§å°æ˜¯å¦ä¸º<code>0</code>å³å¯ã€‚ç”±äº<code>size()</code>æ–¹æ³•æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ç›¸å½“äºè¿˜æ˜¯äº¤ç”±å­ç±»å®ç°ã€‚</p><h5 id="åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„å…ƒç´ "><a href="#åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„å…ƒç´ " class="headerlink" title="åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„å…ƒç´ "></a>åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„å…ƒç´ </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    Iterator&lt;E&gt; it = iterator();</span><br><span class="line">    <span class="keyword">if</span> (o==<span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext())</span><br><span class="line">            <span class="keyword">if</span> (it.next()==<span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext())</span><br><span class="line">            <span class="keyword">if</span> (o.equals(it.next()))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè°ƒç”¨æŠ½è±¡çš„<code>iterator</code>æ–¹æ³•è·å–ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œç„¶åå¯¹é›†åˆè¿›è¡Œè¿­ä»£éå†ã€‚</p><p>åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼ŒæŒ‡å®šçš„å…ƒç´ ä¸º<code>null</code>å’Œé<code>null</code>ï¼Œå¦‚æœä¸º<code>null</code>ï¼Œåˆ™ä½¿ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒï¼›å¦‚æœä¸ºé<code>null</code>ï¼Œåˆ™ä½¿ç”¨<code>equals</code>æ–¹æ³•è¿›è¡Œæ¯”è¾ƒã€‚</p><p>è¿­ä»£å™¨å¯¹è±¡çš„<code>hasNext</code>å’Œ<code>next</code>æ–¹æ³•å‡ç”±å…·ä½“å­ç±»è¿›è¡Œå®ç°ã€‚</p><h5 id="å°†é›†åˆè½¬æ¢æˆå¯¹è±¡æ•°ç»„"><a href="#å°†é›†åˆè½¬æ¢æˆå¯¹è±¡æ•°ç»„" class="headerlink" title="å°†é›†åˆè½¬æ¢æˆå¯¹è±¡æ•°ç»„"></a>å°†é›†åˆè½¬æ¢æˆå¯¹è±¡æ•°ç»„</h5><p>å°†è¯¥é›†åˆçš„è¿­ä»£å™¨è¿”å›çš„æ‰€æœ‰å…ƒç´ æŒ‰ç›¸åŒé¡ºåºè¿ç»­å­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œæ•°ç»„ç´¢å¼•ä»<code>0</code>å¼€å§‹ã€‚è¿”å›çš„æ•°ç»„é•¿åº¦ç­‰äºé›†åˆå…ƒç´ çš„æ•°é‡ï¼Œå³ä½¿åœ¨è¿­ä»£è¿‡ç¨‹ä¸­æ­¤é›†åˆçš„å¤§å°å‘ç”Ÿäº†æ”¹å˜ï¼ˆå¹¶å‘ä¿®æ”¹ï¼‰ï¼Œæœ€ç»ˆè¿”å›çš„æ•°ç»„ä¹Ÿä¸é›†åˆä¿æŒä¸€è‡´ã€‚</p><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object[] toArray() &#123;</span><br><span class="line">    <span class="comment">// Estimate size of array; be prepared to see more or fewer elements</span></span><br><span class="line">    Object[] r = <span class="keyword">new</span> Object[size()];</span><br><span class="line">    Iterator&lt;E&gt; it = iterator();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (! it.hasNext()) <span class="comment">// fewer elements than expected</span></span><br><span class="line">            <span class="keyword">return</span> Arrays.copyOf(r, i);</span><br><span class="line">        r[i] = it.next();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> it.hasNext() ? finishToArray(r, it) : r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆåˆ›å»º<code>size()</code>å¤§å°çš„<code>Object</code>æ•°ç»„ï¼Œè°ƒç”¨<code>iterator</code>æ–¹æ³•å¾—åˆ°é›†åˆçš„è¿­ä»£å™¨ï¼Œç„¶åå¯¹åˆ›å»ºçš„<code>Object</code>æ•°ç»„è¿›è¡Œä¸‹æ ‡ç´¢å¼•éå†ï¼š</p><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œåœ¨<code>for</code>å¾ªç¯çš„éå†ä¸­ï¼Œ<code>it.hasNext()</code>æ–¹æ³•å°†ä¸€ç›´è¿”å›<code>true</code>ï¼Œ<code>if</code>æ¡ä»¶åˆ¤æ–­å°†ä¸ä¼šæˆç«‹ï¼Œå¾ªç¯å®Œæˆåï¼Œè¿­ä»£å™¨çš„<code>hasNext</code>æ–¹æ³•å°†è¿”å›<code>false</code>ï¼Œæœ€ç»ˆå°†<code>r</code>æ•°ç»„è¿”å›ï¼›</p><p>è€Œåœ¨å¹¶å‘ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œä¼šå‡ºç°è¿­ä»£è¿‡ç¨‹ä¸­é›†åˆå…ƒç´ å‡å°‘çš„æƒ…å†µï¼Œè¿™æ—¶<code>if(!it.hasNext())</code>åˆ¤æ–­æˆç«‹ï¼Œå°†è¿”å›<code>Arrays.copyOf(r,i)</code>ï¼šæ‹·è´ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶é•¿åº¦ä¸º<code>i</code>ï¼›</p><p>åŒæ ·åœ°ï¼Œå¹¶å‘ä¿®æ”¹ä¼šé€ æˆé›†åˆå…ƒç´ å¢åŠ çš„æƒ…å†µï¼Œ<code>for</code>å¾ªç¯éå†åŸé›†åˆé•¿åº¦<code>r.length</code>æ¬¡åå°±å·²ç»ç»“æŸäº†ï¼Œå†è¿”å›æ—¶è¿›è¡Œäº†ä¸‰ç›®è¡¨è¾¾å¼åˆ¤æ–­ï¼Œå¦‚æœè¿­ä»£å™¨çš„<code>hasNext</code>æ–¹æ³•è¿”å›<code>true</code>ï¼ˆè¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œåˆ™è°ƒç”¨<code>finishToArray(r, it)</code>æ–¹æ³•å¹¶è¿”å›ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹<code>finishToArray</code>æ–¹æ³•çš„å…·ä½“å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> &lt;T&gt; T[] finishToArray(T[] r, Iterator&lt;?&gt; it) &#123;</span><br><span class="line">    <span class="keyword">int</span> i = r.length;</span><br><span class="line">    <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">        <span class="keyword">int</span> cap = r.length;</span><br><span class="line">        <span class="keyword">if</span> (i == cap) &#123;</span><br><span class="line">            <span class="keyword">int</span> newCap = cap + (cap &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// overflow-conscious code</span></span><br><span class="line">            <span class="keyword">if</span> (newCap - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">                newCap = hugeCapacity(cap + <span class="number">1</span>);</span><br><span class="line">            r = Arrays.copyOf(r, newCap);</span><br><span class="line">        &#125;</span><br><span class="line">        r[i++] = (T)it.next();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// trim if overallocated</span></span><br><span class="line">    <span class="keyword">return</span> (i == r.length) ? r : Arrays.copyOf(r, i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¥å‚ä¸ºåŸé›†åˆçš„å¯¹è±¡æ•°ç»„ï¼ˆå¹¶å‘ä¿®æ”¹å‰çš„é›†åˆï¼‰å’Œé›†åˆçš„è¿­ä»£å™¨ã€‚</p><p>é¦–å…ˆè®°å½•åŸæ•°ç»„çš„é•¿åº¦ä¸º<code>i</code>ï¼›</p><p>ç„¶åå¼€å§‹è¿­ä»£ï¼Œå†æ¬¡è®°å½•ä¸€æ¬¡åŸæ•°ç»„é•¿åº¦ï¼Œç”¨å±€éƒ¨å˜é‡<code>cap</code>æ¥æ”¶ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶<code>i == cap</code>æˆç«‹ï¼Œå¯¹<code>cap</code>è¿›è¡Œæ‰©å®¹ï¼Œ<code>newCap = cap + (cap &gt;&gt; 1) + 1;</code>ï¼šæ‰©å®¹å¤§çº¦ä¸ºåŸ<code>cap</code>çš„<code>1.5</code>å€ã€‚</p><p>æ‰©å®¹åå¦‚æœå‘ç°å¤§äºäº†å®šä¹‰çš„é™æ€æˆå‘˜å˜é‡<code>MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8</code>æ—¶ï¼Œåˆ™è¿›è¡Œå®¹é‡æœ€å¤§åŒ–å¤„ç†ï¼šè°ƒç”¨<code>hugeCapacity</code>æ–¹æ³•ã€‚</p><p><code>hugeCapacity</code>æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hugeCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> OutOfMemoryError</span><br><span class="line">            (<span class="string">&quot;Required array size too large&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class="line">        Integer.MAX_VALUE :</span><br><span class="line">        MAX_ARRAY_SIZE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯çœ‹åˆ°è¿”å›çš„æœ€å¤§å®¹é‡ä¸º<code>Integer.MAX_VALUE</code>ã€‚</p><p>æ¥ä¸‹æ¥è°ƒç”¨<code>r = Arrays.copyOf(r, newCap);</code>ï¼Œå°†æ•°ç»„<code>r</code>ä¸­çš„å…ƒç´ æ‹·è´è‡³ä¸€ä¸ªæ–°çš„å®¹é‡ä¸º<code>newCap</code>çš„æ•°ç»„ä¸­å¹¶èµ‹å€¼ç»™<code>r</code>ã€‚</p><p>å†æ¥ä¸‹æ¥è°ƒç”¨<code>r[i++] = (T)it.next();</code>å°†é›†åˆä¸­çš„å‰©ä½™å…ƒç´ ï¼ˆå¹¶å‘ä¿®æ”¹äº§ç”Ÿçš„ï¼Œç´¢å¼•å¤§äº<code>i</code>ï¼‰å¡«å……è‡³æ–°å®¹é‡çš„<code>r</code>æ•°ç»„ä¸­ã€‚</p><p>ç„¶åè¿›è¡Œä¸‹ä¸€æ¬¡çš„è¿­ä»£ï¼Œå¦‚æœ<code>newCap</code>å®¹é‡çš„æ•°ç»„ä»ä¸èƒ½å®Œå…¨å¡«å……é›†åˆä¸­çš„å‰©ä½™å…ƒç´ ï¼Œåˆ™<code>i == cap</code>æ¡ä»¶ä¼šå†æ¬¡æˆç«‹ï¼Œä¼šå†æ¬¡è¿›è¡Œæ‰©å®¹ï¼Œç›´è‡³å®Œå…¨å¡«å……ã€‚</p><p>å¡«å……å®Œæˆåï¼Œ<code>r</code>æ•°ç»„å¹¶ä¸æ˜¯æ°å¥½è¢«å¡«æ»¡ï¼Œå› ä¸ºæ‰©å®¹æ˜¯ç›´æ¥æ‰©å®¹<code>1.5</code>å€ï¼Œå¾ˆå¯èƒ½æ•°ç»„æœ«å°¾æ²¡æœ‰ä»»ä½•å…ƒç´ ï¼Œæ‰€ä»¥åœ¨<code>return</code>æ—¶åˆ©ç”¨ä¸‰ç›®è¿ç®—ç¬¦åˆ¤æ–­<code>i == r.length</code>æ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹åˆ™è¡¨ç¤ºæ°å¥½å¡«æ»¡ï¼Œç›´æ¥è¿”å›<code>r</code>æ•°ç»„ï¼›å¦åˆ™è°ƒç”¨<code>Arrays.copyOf(r, i)</code>å°†<code>r</code>æ•°ç»„æ‹·è´è‡³ä¸€ä¸ªæ–°çš„å®¹é‡ä¸º<code>i</code>çš„æ•°ç»„ä¸­è¿”å›ã€‚</p><h4 id="ä¿®æ”¹æ“ä½œ"><a href="#ä¿®æ”¹æ“ä½œ" class="headerlink" title="ä¿®æ”¹æ“ä½œ"></a>ä¿®æ”¹æ“ä½œ</h4><h5 id="æ·»åŠ å…ƒç´ è‡³é›†åˆ"><a href="#æ·»åŠ å…ƒç´ è‡³é›†åˆ" class="headerlink" title="æ·»åŠ å…ƒç´ è‡³é›†åˆ"></a>æ·»åŠ å…ƒç´ è‡³é›†åˆ</h5><p>æ­¤æŠ½è±¡ç±»ç›´æ¥æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚ç”±å…·ä½“å­ç±»å»é‡å†™<code>add</code>æ–¹æ³•æ¥å®ç°å‘é›†åˆä¸­æ·»åŠ å…ƒç´ ã€‚</p><blockquote><p>æ·»åŠ å…ƒç´ å·²ç»å±äºé›†åˆçš„ä¸ªæ€§åŒ–æ“ä½œäº†ï¼Œä¸åŒçš„é›†åˆä¿å­˜å…ƒç´ çš„æ–¹å¼ä¸åŒï¼Œæ·»åŠ çš„æ–¹å¼ä¹Ÿä¸åŒï¼Œåœ¨æŠ½è±¡ç±»ä¸­ä¸åº”æœ‰ä»»ä½•å…·ä½“å®ç°ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä»é›†åˆä¸­åˆ é™¤æŒ‡å®šå…ƒç´ "><a href="#ä»é›†åˆä¸­åˆ é™¤æŒ‡å®šå…ƒç´ " class="headerlink" title="ä»é›†åˆä¸­åˆ é™¤æŒ‡å®šå…ƒç´ "></a>ä»é›†åˆä¸­åˆ é™¤æŒ‡å®šå…ƒç´ </h5><p>æ­¤æŠ½è±¡ç±»ä¸­æ²¡æœ‰ä»»ä½•å­˜å‚¨é›†åˆå…ƒç´ çš„ä»‹è´¨ï¼Œå”¯ä¸€èƒ½æ¥è§¦åˆ°é›†åˆå…ƒç´ çš„æ˜¯è¿­ä»£å™¨ã€‚</p><blockquote><p>è¿™é‡Œå°±ä½“ç°å‡ºè¿­ä»£å™¨è®¾è®¡æ¨¡å¼çš„å¥½å¤„äº†ï¼šä¸ç”¨å»å…³å¿ƒå­ç±»é‡‡ç”¨ä½•ç§ç®—æ³•å»å®ç°è¿­ä»£ï¼Œåªéœ€è¦çŸ¥é“<code>hasNext</code>æ–¹æ³•å¯åˆ¤æ–­é›†åˆä¸­æ˜¯å¦è¿˜æœ‰å…ƒç´ ï¼›<code>next</code>æ–¹æ³•å¯è·å–åˆ°æœ¬æ¬¡è¿­ä»£çš„å…ƒç´ å³å¯ã€‚</p></blockquote><p>æ‰€ä»¥åˆ é™¤æŒ‡å®šå…ƒç´ åˆ©ç”¨çš„æ˜¯è¿­ä»£å™¨çš„åˆ é™¤æ–¹æ³•ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹å…·ä½“ä»£ç å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">    Iterator&lt;E&gt; it = iterator();</span><br><span class="line">    <span class="keyword">if</span> (o==<span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (it.next()==<span class="keyword">null</span>) &#123;</span><br><span class="line">                it.remove();</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (o.equals(it.next())) &#123;</span><br><span class="line">                it.remove();</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†ä¸ºæŒ‡å®šå…ƒç´ ä¸º<code>null</code>å’Œé<code>null</code>ä¸¤ç§æƒ…å†µï¼š<code>null</code>ä½¿ç”¨<code>==</code>è¿ç®—ç¬¦æ¯”è¾ƒï¼›é<code>null</code>ä½¿ç”¨<code>equals</code>æ–¹æ³•æ¯”è¾ƒã€‚æœ€ç»ˆéƒ½ä¼šè°ƒç”¨è¿­ä»£å™¨çš„<code>remove</code>æ–¹æ³•åˆ é™¤æŒ‡å®šå…ƒç´ ã€‚</p><p>æ‰€ä»¥å®ç°ç±»å¦‚æœä¸é‡å†™è¯¥<code>remove(Object o)</code>æ–¹æ³•ï¼Œåˆ™å¿…é¡»åœ¨<code>iterator()</code>æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨ä¸­å®ç°è¿­ä»£å™¨çš„<code>remove</code>æ–¹æ³•ã€‚å¦åˆ™å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚</p><h4 id="æ‰¹é‡æ“ä½œ"><a href="#æ‰¹é‡æ“ä½œ" class="headerlink" title="æ‰¹é‡æ“ä½œ"></a>æ‰¹é‡æ“ä½œ</h4><h5 id="åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ "><a href="#åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ " class="headerlink" title="åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ "></a>åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ </h5><p>ä½¿ç”¨è¿­ä»£å™¨éå†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œéå†è¿‡ç¨‹ä¸­è°ƒç”¨æœ¬æŠ½è±¡ç±»ä¸­çš„<code>contains</code>æ–¹æ³•åˆ¤æ–­æ˜¯å¦åŒ…å«ï¼Œåªè¦å‡ºç°ä¸€ä¸ªä¸åŒ…å«çš„æƒ…å†µï¼Œè¿”å›<code>false</code>ï¼Œå…¨éƒ¨åŒ…å«è¿”å›<code>true</code>ã€‚</p><blockquote><p>è¯­æ³•ç³–ï¼šJDK5å¼•å…¥çš„forEachå¾ªç¯å®é™…è°ƒç”¨çš„æ˜¯è¿­ä»£å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (Object e : c)</span><br><span class="line">        <span class="keyword">if</span> (!contains(e))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="æ·»åŠ æŒ‡å®šé›†åˆè‡³å½“å‰é›†åˆ"><a href="#æ·»åŠ æŒ‡å®šé›†åˆè‡³å½“å‰é›†åˆ" class="headerlink" title="æ·»åŠ æŒ‡å®šé›†åˆè‡³å½“å‰é›†åˆ"></a>æ·»åŠ æŒ‡å®šé›†åˆè‡³å½“å‰é›†åˆ</h5><p>ä½¿ç”¨è¿­ä»£å™¨è¿­ä»£æŒ‡å®šçš„é›†åˆï¼Œå¹¶å°†è¿­ä»£å™¨è¿”å›çš„æ¯ä¸ªå¯¹è±¡æ·»åŠ è‡³å½“å‰é›†åˆä¸­ã€‚</p><p>ç”±äºå½“å‰é›†åˆçš„<code>add</code>æ–¹æ³•ä¸­ç›´æ¥æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•ä¾èµ–äºå…·ä½“å­ç±»çš„<code>add</code>æ–¹æ³•å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> modified = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (E e : c)</span><br><span class="line">        <span class="keyword">if</span> (add(e))</span><br><span class="line">            modified = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">return</span> modified;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="åˆ é™¤æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ "><a href="#åˆ é™¤æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ " class="headerlink" title="åˆ é™¤æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ "></a>åˆ é™¤æŒ‡å®šé›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ </h5><p>ä½¿ç”¨è¿­ä»£å™¨éå†å½“å‰é›†åˆï¼Œå¦‚æœè¿­ä»£å™¨è¿”å›çš„å…ƒç´ åŒ…å«åœ¨æŒ‡å®šé›†åˆä¸­ï¼Œåˆ™è°ƒç”¨è¿­ä»£å™¨çš„<code>remove</code>æ–¹æ³•å°†å…¶ä»å½“å‰é›†åˆä¸­åˆ é™¤ã€‚</p><p>æ‰€ä»¥ï¼Œå­ç±»å®ç°çš„<code>iterator</code>æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨å¿…é¡»åŒ…å«<code>remove</code>æ–¹æ³•å®ç°ã€‚å¦åˆ™è°ƒç”¨è¯¥æ–¹æ³•å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">    Objects.requireNonNull(c);</span><br><span class="line">    <span class="keyword">boolean</span> modified = <span class="keyword">false</span>;</span><br><span class="line">    Iterator&lt;?&gt; it = iterator();</span><br><span class="line">    <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (c.contains(it.next())) &#123;</span><br><span class="line">            it.remove();</span><br><span class="line">            modified = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> modified;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä»å½“å‰é›†åˆä¸­åˆ é™¤æŒ‡å®šé›†åˆä¹‹å¤–çš„å…¨éƒ¨å…ƒç´ "><a href="#ä»å½“å‰é›†åˆä¸­åˆ é™¤æŒ‡å®šé›†åˆä¹‹å¤–çš„å…¨éƒ¨å…ƒç´ " class="headerlink" title="ä»å½“å‰é›†åˆä¸­åˆ é™¤æŒ‡å®šé›†åˆä¹‹å¤–çš„å…¨éƒ¨å…ƒç´ "></a>ä»å½“å‰é›†åˆä¸­åˆ é™¤æŒ‡å®šé›†åˆä¹‹å¤–çš„å…¨éƒ¨å…ƒç´ </h5><p>ä½¿ç”¨è¿­ä»£å™¨éå†å½“å‰é›†åˆï¼Œå¦‚æœè¿­ä»£å™¨è¿”å›çš„å…ƒç´ ä¸åŒ…å«åœ¨æŒ‡å®šé›†åˆä¸­ï¼Œåˆ™è°ƒç”¨è¿­ä»£å™¨çš„<code>remove</code>æ–¹æ³•å°†å…¶é‡å½“å‰é›†åˆä¸­åˆ é™¤ã€‚</p><p>æ‰€ä»¥ï¼Œå­ç±»å®ç°çš„<code>iterator</code>æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨å¿…é¡»åŒ…å«<code>remove</code>æ–¹æ³•å®ç°ã€‚å¦åˆ™è°ƒç”¨è¯¥æ–¹æ³•å°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">retainAll</span><span class="params">(Collection&lt;?&gt; c)</span> </span>&#123;</span><br><span class="line">    Objects.requireNonNull(c);</span><br><span class="line">    <span class="keyword">boolean</span> modified = <span class="keyword">false</span>;</span><br><span class="line">    Iterator&lt;E&gt; it = iterator();</span><br><span class="line">    <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!c.contains(it.next())) &#123;</span><br><span class="line">            it.remove();</span><br><span class="line">            modified = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> modified;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="æ¸…ç©ºé›†åˆ"><a href="#æ¸…ç©ºé›†åˆ" class="headerlink" title="æ¸…ç©ºé›†åˆ"></a>æ¸…ç©ºé›†åˆ</h5><p>åœ¨æ­¤æŠ½è±¡ç±»ä¸­ï¼Œæ˜¯ä½¿ç”¨è¿­ä»£å™¨éå†å½“å‰é›†åˆï¼Œè°ƒç”¨è¿­ä»£å™¨çš„<code>remove</code>æ–¹æ³•ä¾æ¬¡åˆ é™¤æ¯ä¸ªå…ƒç´ ã€‚</p><p>ä½†å¤§å¤šæ•°å…·ä½“å®ç°ç±»ä¼šé€‰æ‹©é‡å†™è¯¥æ–¹æ³•ä»¥æé«˜æ•ˆç‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Iterator&lt;E&gt; it = iterator();</span><br><span class="line">    <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">        it.next();</span><br><span class="line">        it.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è½¬æ¢æˆå­—ç¬¦ä¸²"><a href="#è½¬æ¢æˆå­—ç¬¦ä¸²" class="headerlink" title="è½¬æ¢æˆå­—ç¬¦ä¸²"></a>è½¬æ¢æˆå­—ç¬¦ä¸²</h4><p>æ­¤æ–¹æ³•æ˜¯é‡å†™<code>Object#toString</code>æ–¹æ³•ï¼Œé¿å…åœ¨æ§åˆ¶å°æ‰“å°é›†åˆæ—¶æ‰“å°å‡ºé›†åˆå¯¹è±¡çš„åœ°å€å€¼ã€‚å…¶æ ¼å¼ä¸ºï¼šæœ€å¤–å±‚ç”¨æ–¹æ‹¬å·<code>[]</code>æ‹¬èµ·æ¥ï¼Œæ–¹æ‹¬å·ä¸­é—´å¡«å……ç”±è¿­ä»£å™¨è¿”å›çš„å…ƒç´ ï¼Œé¡ºåºä¸ºè¿­ä»£å™¨è¿”å›çš„é¡ºåºã€‚ç›¸é‚»å…ƒç´ ä¸­é—´ä»¥è‹±æ–‡é€—å·<code>,</code>åˆ†éš”ã€‚æ¯ä¸€ä¸ªå…ƒç´ é€šè¿‡<code>String.valueOf(Object)</code>æ–¹æ³•è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Iterator&lt;E&gt; it = iterator();</span><br><span class="line">    <span class="keyword">if</span> (! it.hasNext())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[]&quot;</span>;</span><br><span class="line"></span><br><span class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    sb.append(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        E e = it.next();</span><br><span class="line">        sb.append(e == <span class="keyword">this</span> ? <span class="string">&quot;(this Collection)&quot;</span> : e);</span><br><span class="line">        <span class="keyword">if</span> (! it.hasNext())</span><br><span class="line">            <span class="keyword">return</span> sb.append(<span class="string">&#x27;]&#x27;</span>).toString();</span><br><span class="line">        sb.append(<span class="string">&#x27;,&#x27;</span>).append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ–¹æ³•æ˜¯å¤§å¤šæ•°é›†åˆçš„<code>toString</code>æ–¹æ³•ï¼Œå…·ä½“å®ç°ç±»ï¼ˆä¾‹å¦‚<code>ArrayList</code>ï¼‰ä¸­å¹¶æœªé‡å†™è¯¥æ–¹æ³•ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¯¥æŠ½è±¡ç±»è™½ç„¶æä¾›äº†å¾ˆå¤šæ–¹æ³•çš„å®ç°ï¼Œä½†æ‰€æœ‰çš„å®ç°éƒ½æ˜¯åŸºäº<code>iterator</code>å’Œ<code>size</code>è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ä»æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼çš„è§’åº¦çœ‹ï¼Œè¯¥ç±»å®šä¹‰äº†é›†åˆæ“ä½œçš„ç®—æ³•éª¨æ¶ï¼Œå…·ä½“å®ç°è¿˜æ˜¯å¾—ç”±å­ç±»å»è¿›è¡Œå®ç°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹Collection</title>
      <link href="2020/05/05/javase/base/collection/"/>
      <url>2020/05/05/javase/base/collection/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>Collection</code>æ¥å£æ˜¯<code>Java</code>å®¹å™¨ç±»åº“ä¸­çš„é¡¶å±‚æ¥å£ä¹‹ä¸€ã€‚å®ƒæ¦‚æ‹¬äº†åºåˆ—çš„æ¦‚å¿µï¼šä¸€ç§å­˜æ”¾ä¸€ç»„å¯¹è±¡çš„æ–¹å¼ã€‚</p><p><code>JDK</code>ä¸æä¾›<code>Collection</code>æ¥å£çš„ç›´æ¥å®ç°ï¼Œè€Œæ˜¯æä¾›æ›´ç‰¹æ®Šçš„å­æ¥å£çš„å®ç°ï¼Œæ¯”å¦‚<code>Set</code>å’Œ<code>List</code>ã€‚è¯¥æ¥å£é€šå¸¸ç”¨äºä¼ é€’é›†åˆå¹¶åœ¨éœ€è¦æœ€å¤§é€šç”¨æ€§çš„åœ°æ–¹æ“çºµå®ƒä»¬ã€‚</p><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>æ‰€æœ‰é€šç”¨çš„<code>Collection</code>æ¥å£å®ç°ç±»ï¼ˆé€šå¸¸é€šè¿‡å…¶å­æ¥å£ä¹‹ä¸€æ¥é—´æ¥å®ç°ï¼‰åº”è¯¥æä¾›ä¸¤ä¸ªæ ‡å‡†æ„é€ å™¨ï¼š</p><ul><li><code>void</code>æ— å‚æ„é€ å™¨ï¼šåˆ›å»ºä¸€ä¸ªç©ºé›†åˆã€‚</li><li>å¸¦æœ‰<code>Collection</code>ç±»å‹çš„å•ä¸ªå‚æ•°çš„æ„é€ å™¨ï¼šåˆ›å»ºä¸€ä¸ªæ–°é›†åˆï¼Œè¯¥é›†åˆå…·æœ‰ä¸å‚æ•°ç›¸åŒçš„å…ƒç´ ã€‚</li></ul><p>äº‹å®ä¸Šï¼Œåä¸€ä¸ªæ„é€ å™¨å…è®¸æˆ‘ä»¬å¤åˆ¶ä»»ä½•é›†åˆï¼Œä»è€Œäº§ç”Ÿæ‰€éœ€å®ç°ç±»å‹çš„ç­‰æ•ˆé›†åˆã€‚</p><p>ç”±äºæ¥å£æ— æ³•åŒ…å«æ„é€ å™¨ï¼Œæ‰€ä»¥æ— æ³•å¼ºåˆ¶æ‰§è¡Œæ­¤è§„èŒƒï¼Œä½†æ˜¯<code>Java</code>å¹³å°åº“ä¸­çš„æ‰€æœ‰é€šç”¨<code>Collection</code>å®ç°éƒ½éµå¾ªäº†è¯¥è§„èŒƒã€‚</p><p>æ­¤æ¥å£ä¸­åŒ…å«ä¸€äº›â€œç ´åæ€§â€æ–¹æ³•ï¼šä¿®æ”¹é›†åˆçš„æ“ä½œã€‚å¦‚æœå®ç°ç±»ä¸æ”¯æŒï¼Œå°†æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœè°ƒç”¨å¯¹é›†åˆæ²¡æœ‰å½±å“ï¼Œåˆ™å¯ä»¥ä½†ä¸å¼ºåˆ¶è¦æ±‚è¿™äº›æ–¹æ³•æŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚ä¾‹å¦‚ï¼Œå¯¹ä¸å¯ä¿®æ”¹çš„é›†åˆè°ƒç”¨<code>addAll(Collection c)</code>æ–¹æ³•æ—¶ï¼Œå¦‚æœå¾…æ·»åŠ çš„é›†åˆ<code>c</code>ä¸ºç©ºï¼Œåˆ™å¯ä»¥ä½†ä¸æ˜¯å¿…é¡»æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>æœ‰äº›é›†åˆå®ç°å¯¹å®ƒä»¬å¯èƒ½åŒ…å«çš„å…ƒç´ æœ‰é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œæœ‰äº›å®ç°ç¦æ­¢<code>null</code>å…ƒç´ ï¼Œè€Œæœ‰äº›å®ç°å¯¹å…¶å…ƒç´ ç±»å‹æœ‰é™åˆ¶ã€‚å°è¯•æ·»åŠ ä¸åˆæ³•å…ƒç´ ä¼šå¼•å‘æœªç»æ£€æŸ¥çš„å¼‚å¸¸ï¼Œé€šå¸¸ä¸º<code>NullPointerException</code>æˆ–<code>ClassCastException</code>ã€‚å°è¯•æŸ¥è¯¢ä¸åˆæ³•å…ƒç´ çš„å­˜åœ¨å¯èƒ½ä¼šå¼•å‘å¼‚å¸¸ï¼Œæˆ–è€…å¯èƒ½ä»…è¿”å›<code>false</code>ã€‚ä¸€äº›å®ç°ç±»å°†è¡¨ç°å‡ºå‰è€…çš„è¡Œä¸ºï¼Œè€ŒæŸäº›å®ç°ç±»åˆ™è¡¨ç°å‡ºåè€…çš„è¡Œä¸ºã€‚æ›´ä¸€èˆ¬çš„ï¼Œå°è¯•å¯¹ä¸åˆæ³•å…ƒç´ è¿›è¡Œæ“ä½œï¼Œè¯¥æ“ä½œçš„å®Œæˆä¸ä¼šå¯¼è‡´ä¸åˆæ³•å…ƒç´ æ’å…¥é›†åˆä¸­ï¼Œè¿™å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæˆ–è€…å¯èƒ½ä¼šæˆåŠŸï¼Œä¸€åˆ‡éƒ½å–å†³äºå®ç°ç±»ã€‚å¯¹äº<code>Collection</code>æ¥å£çš„è§„èŒƒæ¥è¯´ï¼Œè¿™äº›å¼‚å¸¸æ˜¯å¯é€‰çš„ï¼Œå¹¶æœªæ˜¾å¼æŠ›å‡ºã€‚</p><p>è¯¥æ¥å£ä¸­çš„è®¸å¤šæ–¹æ³•éƒ½æ˜¯æ ¹æ®<code>Object#equals(Object o)</code>æ–¹æ³•çš„æœ¯è¯­å®šä¹‰çš„ã€‚ä¾‹å¦‚ä»¥ä¸‹æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span></span>;</span><br></pre></td></tr></table></figure><p>æ­¤æ¥å£çš„å®šä¹‰ä¸ºï¼šå½“ä¸”ä»…å½“æ­¤é›†åˆä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ <code>e</code>ï¼Œä½¿å¾—<code>o == null ? e == null : o.equals(e)</code>æˆç«‹ã€‚</p><p>ä¸åº”ç†è§£ä¸ºå¯¹é›†åˆä¸­æ‰€æœ‰å…ƒç´ éƒ½è°ƒç”¨<code>equals</code>æ–¹æ³•ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å°±å¯ä»¥è¿”å›ã€‚å®ç°ç±»å¯ä»¥è‡ªç”±è¿›è¡Œä¼˜åŒ–ï¼Œä»è€Œé¿å…<code>equals</code>é¢‘ç¹è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å…ˆæ¯”è¾ƒä¸¤ä¸ªå…ƒç´ çš„å“ˆå¸Œç ï¼ˆ<code>Object#hashCode()</code>æ–¹æ³•çš„è§„èŒƒä¿è¯äº†å…·æœ‰ä¸ç›¸ç­‰å“ˆå¸Œç çš„ä¸¤ä¸ªå¯¹è±¡ä¸€å®šä¸ç›¸ç­‰ã€‚ï¼‰</p><p>ç®€å•çš„è¯´ï¼Œå„ç§<code>Collection</code>æ¥å£å®ç°ç±»éƒ½å¯ä»¥è‡ªç”±åˆ©ç”¨åŸºç¡€æ–¹æ³•ï¼ˆ<code>Object</code>ç±»çš„æ–¹æ³•ï¼‰ï¼Œåªè¦å®ç°ç±»è®¤ä¸ºåˆé€‚å³å¯ã€‚</p><h2 id="æ¥å£ç­¾å"><a href="#æ¥å£ç­¾å" class="headerlink" title="æ¥å£ç­¾å"></a>æ¥å£ç­¾å</h2><h3 id="æŸ¥è¯¢æ“ä½œ"><a href="#æŸ¥è¯¢æ“ä½œ" class="headerlink" title="æŸ¥è¯¢æ“ä½œ"></a>æŸ¥è¯¢æ“ä½œ</h3><ul><li><code>int size()</code>ï¼šè¿”å›é›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œæœ€å¤šä¸º<code>Integer.MAX_VALUE</code>ã€‚</li><li><code>boolean isEmpty()</code>ï¼šå¦‚æœé›†åˆä¸­ä¸åŒ…å«ä»»ä½•å…ƒç´ åˆ™è¿”å›<code>true</code>ã€‚</li><li><code>boolean contains(Object o)</code>ï¼šå½“ä¸”ä»…å½“æ­¤é›†åˆä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ <code>e</code>ä½¿å¾—<code>o == null ? e == null : o.equals(e)</code>æˆç«‹æ—¶è¿”å›<code>true</code>ã€‚</li><li><code>Iterator&lt;E&gt; iterator()</code>ï¼šè¿”å›æ­¤é›†åˆä¸­å…ƒç´ çš„è¿­ä»£å™¨ã€‚</li><li><code>Object[] toArray()</code>ï¼šè¿”å›åŒ…å«æ­¤é›†åˆä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ã€‚å¦‚æœæ­¤é›†åˆå¯¹ç”±å…¶è¿­ä»£å™¨è¿”å›å…ƒç´ çš„é¡ºåºè¿›è¡Œäº†ä»»ä½•ä¿è¯ï¼Œåˆ™æ­¤æ–¹æ³•å¿…é¡»æŒ‰ç›¸åŒçš„é¡ºåºè¿”å›å…ƒç´ ã€‚æ“ä½œè¿”å›çš„æ•°ç»„ä¸ä¼šå¯¹åŸé›†åˆäº§ç”Ÿä»»ä½•å½±å“ï¼ˆå®‰å…¨ï¼‰ã€‚æ­¤æ–¹æ³•å……å½“åŸºäºæ•°ç»„çš„<code>API</code>å’ŒåŸºäºé›†åˆçš„<code>API</code>ä¹‹é—´çš„æ¡¥æ¢ã€‚</li></ul><h3 id="ä¿®æ”¹æ“ä½œ"><a href="#ä¿®æ”¹æ“ä½œ" class="headerlink" title="ä¿®æ”¹æ“ä½œ"></a>ä¿®æ”¹æ“ä½œ</h3><ul><li><code>boolean add(E e)</code>ï¼šæ’å…¥å…ƒç´ <code>e</code>è‡³é›†åˆä¸­ï¼Œå¦‚æœæ­¤é›†åˆç”±äºè°ƒç”¨è¯¥æ–¹æ³•å‘ç”Ÿæ›´æ”¹ï¼Œåˆ™è¿”å›<code>true</code>ï¼›å¦‚æœé›†åˆä¸å…è®¸é‡å¤å…ƒç´ ï¼Œä¸”å·²ç»åŒ…å«<code>e</code>ï¼Œåˆ™è¿”å›<code>false</code>ã€‚</li><li><code>boolean remove(Object o)</code>ï¼šä»é›†åˆä¸­åˆ é™¤å…ƒç´ <code>o</code>ã€‚éœ€æ»¡è¶³æ¡ä»¶ï¼š<code>o == null ? e == null : o.equals(e)</code>ã€‚å¦‚æœå­˜åœ¨å¤šä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œåˆ™åªä¼šåˆ é™¤å…ˆæ‰¾åˆ°çš„é‚£ä¸ªã€‚</li></ul><h3 id="æ‰¹é‡æ“ä½œ"><a href="#æ‰¹é‡æ“ä½œ" class="headerlink" title="æ‰¹é‡æ“ä½œ"></a>æ‰¹é‡æ“ä½œ</h3><ul><li><code>boolean containsAll(Collection&lt;?&gt; c)</code>ï¼šå¦‚æœé›†åˆä¸­åŒ…å«æŒ‡å®šé›†åˆ<code>c</code>ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›<code>true</code>ã€‚</li><li><code>boolean addAll(Collection&lt;? extends E&gt; c)</code>ï¼šå°†æŒ‡å®šé›†åˆ<code>c</code>ä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³å½“å‰é›†åˆä¸­ã€‚å¦‚æœåœ¨æ“ä½œè¿‡ç¨‹ä¸­ä¿®æ”¹äº†æŒ‡å®šçš„é›†åˆ<code>c</code>ï¼Œåˆ™æ­¤æ“ä½œçš„è¡Œä¸ºæ˜¯ä¸ç¡®å®šçš„ã€‚</li><li><code>boolean removeAll(Collection&lt;?&gt; c)</code>ï¼šåˆ é™¤æ‰€æœ‰åŒ…å«åœ¨æŒ‡å®šé›†åˆ<code>c</code>ä¸­çš„å…ƒç´ ã€‚æ­¤è°ƒç”¨è¿”å›åï¼Œå½“å‰é›†åˆä¸­å°†ä¸åŒ…å«ä¸æŒ‡å®šé›†åˆç›¸åŒçš„å…ƒç´ ã€‚</li><li><code>boolean retainAll(Collection&lt;?&gt; c)</code>ï¼šä»…ä¿ç•™æ­¤é›†åˆä¸­åŒ…å«åœ¨æŒ‡å®šé›†åˆ<code>c</code>ä¸­çš„å…ƒç´ ã€‚æ¢å¥è¯è¯´ï¼Œæ­¤æ“ä½œå®Œæˆåï¼Œå½“å‰é›†åˆä¸æŒ‡å®šé›†åˆä¸­çš„å…ƒç´ å®Œå…¨ç›¸åŒã€‚</li><li><code>void clear()</code>ï¼šåˆ é™¤æ­¤é›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ ã€‚</li></ul><h3 id="æ¯”è¾ƒå’Œå“ˆå¸Œ"><a href="#æ¯”è¾ƒå’Œå“ˆå¸Œ" class="headerlink" title="æ¯”è¾ƒå’Œå“ˆå¸Œ"></a>æ¯”è¾ƒå’Œå“ˆå¸Œ</h3><p>è¯¥æ¥å£é‡æ–°å£°æ˜äº†<code>Object#equals</code>å’Œ<code>Object#hashCode</code>æ–¹æ³•ï¼Œå¼ºåˆ¶å­ç±»å¿…é¡»å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚</p><p><code>Collection</code>æ¥å£è¦æ±‚<code>hashCode</code>æ–¹æ³•è¿”å›è¯¥é›†åˆçš„å“ˆå¸Œç ï¼›<code>equals</code>æ–¹æ³•æ¯”è¾ƒæŒ‡å®šçš„å¯¹è±¡ä¸è¯¥é›†åˆæ˜¯å¦ç›¸ç­‰ã€‚</p><h3 id="JDK8æ–°å¢é»˜è®¤æ–¹æ³•"><a href="#JDK8æ–°å¢é»˜è®¤æ–¹æ³•" class="headerlink" title="JDK8æ–°å¢é»˜è®¤æ–¹æ³•"></a><code>JDK8</code>æ–°å¢é»˜è®¤æ–¹æ³•</h3><p><code>JDK8</code>çš„<code>StreamAPI</code>æä¾›çš„ä¸¤ä¸ªæ–¹æ³•ã€‚åœ¨æ­¤é¡¶å±‚æ¥å£ä¸­å®šä¹‰é»˜è®¤å®ç°ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„é›†åˆéƒ½å¯ä»¥ä½¿ç”¨æµæ“ä½œã€‚</p><h4 id="è·å–ä¸²è¡Œæµ"><a href="#è·å–ä¸²è¡Œæµ" class="headerlink" title="è·å–ä¸²è¡Œæµ"></a>è·å–ä¸²è¡Œæµ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">default</span> Stream&lt;E&gt; <span class="title">stream</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> StreamSupport.stream(spliterator(), <span class="keyword">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è·å–å¹¶è¡Œæµ"><a href="#è·å–å¹¶è¡Œæµ" class="headerlink" title="è·å–å¹¶è¡Œæµ"></a>è·å–å¹¶è¡Œæµ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">default</span> Stream&lt;E&gt; <span class="title">parallelStream</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> StreamSupport.stream(spliterator(), <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹List</title>
      <link href="2020/05/05/javase/base/list/"/>
      <url>2020/05/05/javase/base/list/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>List</code>æ¥å£ç»§æ‰¿äº†<code>Collection</code>æ¥å£ï¼Œæ›´ç²¾ç¡®çš„å®šä¹‰äº†ä¸€ç§é›†åˆç±»å‹ã€‚</p><p>è¯¥æ¥å£å®šä¹‰çš„æ˜¯ä¸€ç§æœ‰åºé›†åˆï¼Œä¹Ÿç§°ä¸ºåºåˆ—ã€‚æ¥å£çš„ä½¿ç”¨è€…å¯ä»¥ç²¾ç¡®æ§åˆ¶åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ çš„æ’å…¥ä½ç½®ã€‚å¯ä»¥é€šè¿‡å…¶æ•´æ•°ç´¢å¼•ï¼ˆåºåˆ—ä¸­çš„ä½ç½®ï¼‰è®¿é—®å…ƒç´ ï¼Œå¹¶åœ¨åºåˆ—ä¸­æœç´¢å…ƒç´ ã€‚</p><p>ä¸<code>Set</code>é›†åˆä¸åŒï¼Œåºåˆ—é€šå¸¸å…è®¸é‡å¤çš„å…ƒç´ ï¼ˆ<code>equals</code>æ¯”è¾ƒç›¸ç­‰ï¼‰ã€‚å¹¶ä¸”å…è®¸å¤šä¸ª<code>null</code>å…ƒç´ ã€‚</p><h2 id="ä¸»è¦æ¥å£ç­¾å"><a href="#ä¸»è¦æ¥å£ç­¾å" class="headerlink" title="ä¸»è¦æ¥å£ç­¾å"></a>ä¸»è¦æ¥å£ç­¾å</h2><p>å¯¹äº<code>Iterator</code>ã€<code>add</code>ã€<code>remove</code>ã€<code>equals</code>å’Œ<code>hashCode</code>æ–¹æ³•ï¼Œåºåˆ—åœ¨<code>Collection</code>æ¥å£çš„å®šä¹‰ä¹‹å¤–ï¼Œåˆå¢åŠ äº†ä¸€äº›å…¶å®ƒå®šä¹‰ã€‚åŒæ—¶ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œåºåˆ—ä¸­è¿˜åŒ…å«äº†å¯¹ç»§æ‰¿æ–¹æ³•çš„é‡æ–°å£°æ˜ã€‚</p><h3 id="hashCode"><a href="#hashCode" class="headerlink" title="hashCode()"></a><code>hashCode()</code></h3><p><code>Collection</code>æ¥å£ä¸­çš„<code>hashCode</code>æ–¹æ³•åªæ˜¯å®šä¹‰äº†è¿”å›å€¼æ˜¯è¯¥é›†åˆçš„å“ˆå¸Œç ï¼ˆè°ƒç”¨çš„æ˜¯<code>Object</code>ç±»çš„<code>hashCode</code>æ–¹æ³•ï¼‰ã€‚è€Œ<code>List</code>æ¥å£æ˜ç¡®è§„å®šäº†é›†åˆ<code>hashCode</code>çš„è®¡ç®—æ–¹å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> hashCode = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (E e : list)</span><br><span class="line">    hashCode = <span class="number">31</span>*hashCode + (e==<span class="keyword">null</span> ? <span class="number">0</span> : e.hashCode());</span><br></pre></td></tr></table></figure><p>è®¡ç®—æ¯ä¸€ä¸ªå…ƒç´ çš„<code>hashCode</code>å¹¶ç›¸åŠ ã€‚</p><p>è¿™ç¡®ä¿äº†å¯¹äºä»»æ„ä¸¤ä¸ªé›†åˆ<code>list1</code>å’Œ<code>list2</code>ï¼Œå¦‚æœæ»¡è¶³<code>list1.hashCode() == list2.hashCode()</code>ï¼Œåˆ™<code>list1.equals(list2)</code>ä¸€å®šç›¸ç­‰ã€‚è¿™ç¬¦åˆ<code>Object#hashCode</code>çš„è§„å®šã€‚</p><h3 id="equals-Object-o"><a href="#equals-Object-o" class="headerlink" title="equals(Object o)"></a><code>equals(Object o)</code></h3><p><code>Collection</code>æ¥å£ä¸­çš„<code>equals</code>æ–¹æ³•çš„å®šä¹‰æ˜¯æŒ‡å®šå¯¹è±¡ä¸å½“å‰é›†åˆæ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœå®ç°ç±»å¸Œæœ›ä¸ä½¿ç”¨é»˜è®¤çš„<code>Object#equals</code>æ–¹æ³•çš„<code>==</code>æ¯”è¾ƒï¼Œé‚£ä¹ˆéœ€è¦é‡å†™è¯¥æ–¹æ³•ã€‚</p><p><code>List</code>æ¥å£ä¸­é‡å†™çš„<code>equals</code>æ–¹æ³•è§„å®šäº†åˆ¤æ–­æŒ‡å®šå¯¹è±¡ä¸é›†åˆæ˜¯å¦ç›¸ç­‰çš„é€»è¾‘ï¼šå½“ä¸”ä»…å½“æŒ‡å®šçš„å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ª<code>List</code>åºåˆ—ï¼Œå…·æœ‰ç›¸åŒçš„å¤§å°ï¼Œå¹¶ä¸”ä¸¤ä¸ªåºåˆ—ä¸­æ‰€æœ‰å¯¹åº”ä½ç½®çš„å…ƒç´ éƒ½ç›¸ç­‰ï¼ˆç›¸ç­‰çš„æ¡ä»¶ä¸ºï¼š<code>e1 == null ? e2 == null : e1.equals(e2)</code>ï¼‰ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸¤ä¸ªåºåˆ—ä¸­ç›¸åŒç´¢å¼•ä½ç½®çš„å…ƒç´ éƒ½ç›¸ç­‰ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªåºåˆ—è¢«å®šä¹‰ä¸ºç›¸ç­‰ã€‚</p><p>è¿™ä¸ªå®šä¹‰ç¡®ä¿äº†<code>equals</code>æ–¹æ³•å¯ä»¥åœ¨<code>List</code>æ¥å£çš„ä¸åŒå®ç°ç±»ä¸­æ­£å¸¸è¿è¡Œã€‚</p><h3 id="add-E-e"><a href="#add-E-e" class="headerlink" title="add(E e)"></a><code>add(E e)</code></h3><p><code>Collection</code>æ¥å£ä¸­çš„<code>add</code>æ–¹æ³•å®šä¹‰äº†å¯ä»¥å‘é›†åˆä¸­æ·»åŠ å…ƒç´ ã€‚è€Œ<code>List</code>æ¥å£ä¸­å®šä¹‰çš„<code>add</code>æ–¹æ³•è§„å®šäº†å…ƒç´ æ·»åŠ çš„ä½ç½®ï¼šæ·»åŠ åˆ°åŸé›†åˆæœ«å°¾ã€‚</p><h3 id="add-int-index-E-element"><a href="#add-int-index-E-element" class="headerlink" title="add(int index, E element)"></a><code>add(int index, E element)</code></h3><p><code>List</code>æ¥å£ä¸­æ–°å¢çš„æ¥å£ç­¾åï¼Œåœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šå…ƒç´ ã€‚å¦‚æœæŒ‡å®šç´¢å¼•ä½ç½®æœ‰å…ƒç´ ï¼Œè¯¥å…ƒç´ åŠå…¶ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ•´ä½“å‘åç§»åŠ¨ä¸€ä½ã€‚</p><h3 id="addAll-Collection-lt-extends-E-gt-c"><a href="#addAll-Collection-lt-extends-E-gt-c" class="headerlink" title="addAll(Collection&lt;? extends E&gt; c)"></a><code>addAll(Collection&lt;? extends E&gt; c)</code></h3><p>åŒæ ·åœ°ï¼Œ<code>Collection</code>æ¥å£ä¸­çš„<code>add</code>æ–¹æ³•åªæ˜¯å®šä¹‰äº†å¯ä»¥å‘å½“å‰é›†åˆä¸­æ’å…¥å¦ä¸€ä¸ªé›†åˆã€‚è€Œ<code>List</code>æ¥å£æ˜ç¡®è§„å®šäº†æ’å…¥çš„ä½ç½®ä¸ºåŸé›†åˆæœ«å°¾ã€‚</p><h3 id="addAll-int-index-Collection-lt-extends-E-gt-c"><a href="#addAll-int-index-Collection-lt-extends-E-gt-c" class="headerlink" title="addAll(int index, Collection&lt;? extends E&gt; c)"></a><code>addAll(int index, Collection&lt;? extends E&gt; c)</code></h3><p><code>List</code>æ¥å£ä¸­æ–°å¢çš„æ¥å£ç­¾åï¼Œåœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ’å…¥æŒ‡å®šé›†åˆã€‚å¦‚æœæŒ‡å®šç´¢å¼•ä½ç½®æœ‰å…ƒç´ ï¼Œè¯¥å…ƒç´ åŠå…¶ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ•´ä½“å‘åç§»åŠ¨æŒ‡å®šé›†åˆå¤§å°ä½ã€‚</p><h3 id="remove-int-index"><a href="#remove-int-index" class="headerlink" title="remove(int index)"></a><code>remove(int index)</code></h3><p><code>List</code>æ¥å£ä¸­æ–°å¢çš„æ¥å£ç­¾åï¼Œåˆ é™¤åºåˆ—ä¸­æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ã€‚å¦‚æœæŒ‡å®šç´¢å¼•ä½ç½®åè¿˜æœ‰å…¶å®ƒå…ƒç´ ï¼Œåˆ™ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ•´ä½“å‘å‰ç§»åŠ¨ä¸€ä½ï¼Œæœ€åè¿”å›è¢«ç§»é™¤çš„é‚£ä¸ªå…ƒç´ ã€‚</p><h3 id="Iterator"><a href="#Iterator" class="headerlink" title="Iterator"></a><code>Iterator</code></h3><p><code>List</code>æ¥å£æä¾›äº†ä¸€ä¸ªç§°ä¸º<code>ListIterator</code>çš„ç‰¹æ®Šè¿­ä»£å™¨ï¼Œé™¤äº†å…è®¸<code>Iterator</code>æ¥å£æä¾›çš„å¸¸è§„æ“ä½œå¤–ï¼Œå®ƒè¿˜å…è®¸å…ƒç´ çš„æ’å…¥å’Œæ›¿æ¢ä»¥åŠåŒå‘è®¿é—®ã€‚æä¾›äº†ä¸€ç§æ–¹å¼æ¥è·å–ä»åºåˆ—çš„æŒ‡å®šä½ç½®å¼€å§‹çš„åºåˆ—è¿­ä»£å™¨ã€‚</p><p>å®šä¹‰äº†ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•è·å–åºåˆ—è¿­ä»£å™¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">(<span class="keyword">int</span> index)</span></span>;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­é‡è½½çš„å¸¦ä¸€ä¸ªå‚æ•°çš„<code>listIterator(int index)</code>æ–¹æ³•ä»æŒ‡å®šç´¢å¼•ä½ç½®å¼€å§‹è¿”å›åºåˆ—è¿­ä»£å™¨ï¼Œå®ƒè¡¨ç¤ºåœ¨é¦–æ¬¡è°ƒç”¨<code>ListIterator#next</code>æ–¹æ³•æ—¶å°†è¿”å›æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ã€‚é¦–æ¬¡è°ƒç”¨<code>ListIterator#previous</code>æ–¹æ³•æ—¶å°†è¿”å›æŒ‡å®šç´¢å¼•å‡ä¸€ä½ç½®çš„å…ƒç´ ã€‚</p><h2 id="å…¶å®ƒç‰¹æ€§"><a href="#å…¶å®ƒç‰¹æ€§" class="headerlink" title="å…¶å®ƒç‰¹æ€§"></a>å…¶å®ƒç‰¹æ€§</h2><p><code>List</code>æ¥å£å®šä¹‰äº†å››ä¸ªæ–¹æ³•ç”¨äºå¯¹åºåˆ—å…ƒç´ è¿›è¡Œä½ç½®ï¼ˆç´¢å¼•ï¼‰è®¿é—®ã€‚ç´¢å¼•ä»<code>0</code>å¼€å§‹ã€‚åœ¨æŸäº›å®ç°ç±»ä¸­ï¼Œä¾‹å¦‚<code>LinkedList</code>ï¼Œè¿™äº›æ–¹æ³•çš„å®ç°å¯èƒ½åœ¨æ—¶é—´ä¸Šä¸ç´¢å¼•çš„å€¼æˆæ¯”ä¾‹å¢é•¿ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨ç¼–ç è¿‡ç¨‹ä¸­ä¸çŸ¥é“<code>List</code>çš„å®ç°ç±»ï¼ˆä¾‹å¦‚ä½¿ç”¨åå°„ç­‰ï¼‰å…·ä½“æ˜¯å“ªä¸ªç±»ï¼Œåˆ™éå†åºåˆ—å¯èƒ½æ¯”é€šè¿‡ç´¢å¼•è¿›è¡Œç´¢å¼•æ›´åŠ é«˜æ•ˆã€‚</p><ul><li><code>void add(int index, E element);</code>ï¼šåœ¨æŒ‡å®šç´¢å¼•ä½ç½®æ·»åŠ æŒ‡å®šå…ƒç´ ã€‚</li><li><code>E get(int index);</code>ï¼šè·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ã€‚</li><li><code>E remove(int index);</code>ï¼šç§»é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ã€‚</li><li><code>E set(int index, E element);</code>ï¼šç»™æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ èµ‹å€¼ã€‚</li></ul><p>å¦å¤–ï¼Œ<code>List</code>æ¥å£è¿˜å®šä¹‰äº†ä¸¤ä¸ªç”¨æ¥æœç´¢æŒ‡å®šå¯¹è±¡çš„æ–¹æ³•ï¼Œä»æ€§èƒ½æ¥çœ‹ï¼Œåº”è°¨æ…ä½¿ç”¨è¿™äº›æ–¹æ³•ã€‚åœ¨è®¸å¤šå®ç°ç±»ä¸­ï¼Œå®ƒä»¬çš„æ‰§è¡Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚</p><ul><li><code>int indexOf(Object o);</code>ï¼šè¿”å›æŒ‡å®šå…ƒç´ ç¬¬ä¸€æ¬¡å‡ºç°åœ¨è¯¥åºåˆ—ä¸­çš„ç´¢å¼•ä½ç½®ã€‚å¦‚æœä¸å­˜åœ¨åˆ™è¿”å›<code>-1</code>ã€‚</li><li><code>int lastIndexOf(Object o);</code>ï¼šè¿”å›æŒ‡å®šå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°åœ¨è¯¥åºåˆ—ä¸­çš„ç´¢å¼•ä½ç½®ã€‚å¦‚æœä¸å­˜åœ¨åˆ™è¿”å›<code>-1</code>ã€‚</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><code>List</code>æ¥å£æ˜¯å¯¹<code>Collection</code>æ¥å£çš„è¿›ä¸€æ­¥å®šä¹‰ï¼Œæ˜ç¡®äº†ä¸€ç§é›†åˆçš„ç±»å‹ï¼šåºåˆ—ã€‚</p><p>æ¥å£ä¸­çš„æ–¹æ³•ä¸€éƒ¨åˆ†æ˜¯å¯¹çˆ¶æ¥å£æ–¹æ³•çš„é‡æ–°å£°æ˜ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ä¸ºäº†å¯¹åºåˆ—è¿™ç§é›†åˆå»ºæ¨¡è€Œå¢åŠ çš„æ¥å£ã€‚</p><p>æˆ‘ä»¬å­¦ä¹ è¯¥æ¥å£æ˜¯ä¸ºäº†â€œä»ä¸Šå¾€ä¸‹â€åœ°å¯¹é›†åˆæ¡†æ¶çš„ç‰¹æ€§è¿›è¡Œè®¤çŸ¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹Cloneable</title>
      <link href="2020/04/26/javase/base/cloneable/"/>
      <url>2020/04/26/javase/base/cloneable/</url>
      
        <content type="html"><![CDATA[<h2 id="Cloneableæ¥å£ç®€ä»‹"><a href="#Cloneableæ¥å£ç®€ä»‹" class="headerlink" title="Cloneableæ¥å£ç®€ä»‹"></a><code>Cloneable</code>æ¥å£ç®€ä»‹</h2><p>1ã€ä¸€ä¸ªç±»å®ç°<code>java.lang.Cloneable</code>æ ‡è®°æ€§æ¥å£ä»¥å‘<code>java.lang.Object#clone()</code>æ–¹æ³•æŒ‡ç¤ºè¯¥æ–¹æ³•ä¸ºè¯¥ç±»çš„å®ä¾‹è¿›è¡Œé€åŸŸå¤åˆ¶æ˜¯åˆæ³•çš„ã€‚</p><p>2ã€åœ¨æœªå®ç°<code>java.lang.Cloneable</code>æ¥å£çš„å®ä¾‹ä¸Šè°ƒç”¨<code>java.lang.Object#clone()</code>æ–¹æ³•ä¼šå¯¼è‡´æŠ›å‡º<code>java.lang.CloneNotSupportedException</code>å¼‚å¸¸ã€‚</p><p>3ã€æŒ‰ç…§çº¦å®šï¼Œå®ç°äº†<code>java.lang.Cloneable</code>æ¥å£çš„ç±»åº”ä½¿ç”¨<code>public</code>å…¬å…±æ–¹æ³•é‡å†™<code>java.lang.Object#clone()</code>æ–¹æ³•ï¼ˆ<code>protected</code>å—ä¿æŠ¤çš„ï¼‰ã€‚</p><h2 id="å…‹éš†çš„åŸºæœ¬ä½¿ç”¨"><a href="#å…‹éš†çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="å…‹éš†çš„åŸºæœ¬ä½¿ç”¨"></a>å…‹éš†çš„åŸºæœ¬ä½¿ç”¨</h2><p>ç”±äº<code>java.util.ArrayList</code>ç±»å®ç°äº†<code>Cloneable</code>æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ª<code>ArrayList</code>é›†åˆçš„æ•°æ®å…‹éš†è‡³å¦ä¸€ä¸ªæ–°çš„é›†åˆä¸­ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.common.collect.Lists;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å°†ä¸€ä¸ªArrayListé›†åˆçš„æ•°æ®å…‹éš†è‡³å¦ä¸€ä¸ªæ–°çš„é›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayListClone</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;String&gt; list = Lists.newArrayList();</span><br><span class="line">        list.add(<span class="string">&quot;Javaå¤§æ³•å¥½&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;å‘æ—¥è‘µçš„è‡ªæˆ‘ä¿®å…»&quot;</span>);</span><br><span class="line">        Object clone = list.clone();</span><br><span class="line">        System.out.println(clone == list);</span><br><span class="line">        System.out.println(clone);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç è¯´æ˜ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ª<code>ArrayList</code>é›†åˆå¯¹è±¡ï¼›</li><li>å¾€å…¶ä¸­æ·»åŠ ä¸‰ä¸ªå…ƒç´ ï¼›</li><li>è°ƒç”¨é›†åˆå¯¹è±¡çš„<code>clone()</code>æ–¹æ³•ï¼›</li><li>åˆ¤æ–­å…‹éš†åçš„é›†åˆåœ°å€ä¸åŸé›†åˆåœ°å€æ˜¯å¦ç›¸ç­‰ï¼›</li><li>åˆ†åˆ«æ‰“å°ä¸¤ä¸ªé›†åˆçš„å†…å®¹ã€‚</li></ol><p>è¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå…‹éš†åçš„<code>ArrayList</code>é›†åˆä¸æ—§é›†åˆçš„åœ°å€ä¸ä¸€æ ·ï¼Œä½†å…¶å†…å®¹ç›¸åŒã€‚</p><h2 id="ArrayList-clone-æ–¹æ³•æºç åˆ†æ"><a href="#ArrayList-clone-æ–¹æ³•æºç åˆ†æ" class="headerlink" title="ArrayList#clone()æ–¹æ³•æºç åˆ†æ"></a><code>ArrayList#clone()</code>æ–¹æ³•æºç åˆ†æ</h2><p>è°ƒç”¨äº†<code>list</code>å¯¹è±¡çš„<code>clone()</code>æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å…¶å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ArrayList&lt;?&gt; v = (ArrayList&lt;?&gt;) <span class="keyword">super</span>.clone();</span><br><span class="line">        v.elementData = Arrays.copyOf(elementData, size);</span><br><span class="line">        v.modCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">        <span class="comment">// this shouldn&#x27;t happen, since we are Cloneable</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> InternalError(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å…¶è°ƒç”¨çš„æ˜¯<code>super.clone()</code>æ–¹æ³•å¾—åˆ°çš„ä¸€ä¸ªæ–°çš„é›†åˆã€‚</p><p>é‚£ä¹ˆè¯¥<code>super</code>æŒ‡ä»£çš„æ˜¯å“ªä¸ªçˆ¶ç±»å‘¢ï¼Ÿ</p><ul><li><code>java.util.ArrayList</code>çš„ç›´æ¥çˆ¶ç±»æ˜¯<code>java.util.AbstractList</code>ï¼›</li><li><code>java.util.AbstractList</code>çš„ç›´æ¥çˆ¶ç±»æ˜¯<code>java.util.AbstractCollection</code>ï¼›</li><li><code>java.util.AbstractCollection</code>æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ç°äº†<code>java.util.Collection</code>æ¥å£ï¼Œæ²¡æœ‰ç»§æ‰¿ä»»ä½•çˆ¶ç±»ã€‚</li></ul><p>ä½†æ˜¯æˆ‘ä»¬å´æ²¡æœ‰åœ¨<code>java.util.AbstractList</code>å’Œ<code>java.util.AbstractCollection</code>ç±»ä¸­æ‰¾åˆ°<code>clone()</code>æ–¹æ³•ã€‚</p><p>äº‹å®ä¸Šå¯ä»¥ç›´æ¥å€ŸåŠ©<code>IDEA</code>çš„å¿«æ·é”®å¾—åˆ°å…¶æ˜¯<code>Object</code>ç±»çš„<code>clone()</code>æ–¹æ³•ã€‚</p><p>åªæœ‰<code>java.util.ArrayList</code>ç±»ä¸­æœ‰<code>clone()</code>æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨åŸºæœ¬ä½¿ç”¨çš„ä»£ç ä¸­åˆ›å»ºçš„é›†åˆï¼Œä½¿ç”¨<code>java.util.ArrayList</code>æ¥æ”¶è€Œä¸ç”¨é¡¶å±‚æ¥å£<code>java.util.List</code>æ¥æ”¶çš„åŸå› ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹<code>Object#clone()</code>æ–¹æ³•çš„æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">native</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException</span>;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªæœ¬åœ°<code>navive</code>æ–¹æ³•ï¼Œä½¿ç”¨äº†<code>protected</code>è®¿é—®ä¿®é¥°ç¬¦ï¼Œå¹¶æ˜¾å¼æŠ›å‡ºäº†<code>java.lang.CloneNotSupportedException</code>å¼‚å¸¸ã€‚å…¶å®ç°æ˜¯ç”±åº•å±‚çš„<code>c/c++</code>è¯­è¨€è¿›è¡Œå®ç°çš„ï¼Œæˆ‘ä»¬æ— æ³•ä»<code>Java</code>è¯­è¨€å±‚é¢çœ‹åˆ°ã€‚</p><p>å…‹éš†å‡ºä¸€ä¸ª<code>ArrayList</code>å¯¹è±¡<code>v</code>ä¹‹åï¼Œè°ƒç”¨å·¥å…·ç±»<code>java.util.Arrays</code>çš„<code>copyOf</code>æ–¹æ³•ï¼Œå°†åŸé›†åˆçš„æ•°æ®<code>elementData</code>å’Œé›†åˆå¤§å°<code>size</code>ä¼ å…¥ï¼Œæ‹·è´é›†åˆå…ƒç´ è‡³å…‹éš†é›†åˆ<code>v</code>çš„<code>elementData</code>åŸŸä¸­ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹<code>java.util.Arrays#copyOf()</code>æ–¹æ³•çš„å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T[] copyOf(T[] original, <span class="keyword">int</span> newLength) &#123;</span><br><span class="line">    <span class="keyword">return</span> (T[]) copyOf(original, newLength, original.getClass());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T,U&gt; T[] copyOf(U[] original, <span class="keyword">int</span> newLength, Class&lt;? extends T[]&gt; newType) &#123;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    T[] copy = ((Object)newType == (Object)Object[].class)</span><br><span class="line">        ? (T[]) <span class="keyword">new</span> Object[newLength]</span><br><span class="line">        : (T[]) Array.newInstance(newType.getComponentType(), newLength);</span><br><span class="line">    System.arraycopy(original, <span class="number">0</span>, copy, <span class="number">0</span>,</span><br><span class="line">                     Math.min(original.length, newLength));</span><br><span class="line">    <span class="keyword">return</span> copy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>copyOf</code>æ–¹æ³•å†…éƒ¨è°ƒç”¨çš„æ˜¯å¦ä¸€ä¸ªé‡è½½çš„<code>copyOf</code>æ–¹æ³•ï¼Œåˆ¤æ–­ä¼ å…¥çš„é›†åˆæ•°æ®<code>elementData</code>ç±»å‹æ˜¯ä¸æ˜¯<code>Object[]</code>æ•°ç»„ç±»å‹ï¼Œå¦‚æœæ˜¯<code>Object</code>ç±»å‹åˆ™ä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»ºä¸€ä¸ªæ–°çš„<code>Object[]</code>æ•°ç»„ï¼Œå¦åˆ™åˆ›å»ºå…¶å®ƒç±»å‹çš„æ•°ç»„ï¼Œæœ€åè°ƒç”¨<code>System.arraycopy</code>æ–¹æ³•å°†ä¼ å…¥çš„æ•°ç»„å…ƒç´ æ‹·è´è‡³æ–°å»ºçš„æ•°ç»„ä¸­è¿”å›ã€‚</p><p>è¿”å›äº†æ–°çš„æ•°ç»„ä¹‹åï¼Œå°†å…‹éš†å‡ºæ¥çš„é›†åˆ<code>v</code>çš„<code>elementData</code>åŸŸå¼•ç”¨æŒ‡å‘æ–°çš„æ•°ç»„åœ°å€ï¼Œç„¶åè®¾ç½®ä¿®æ”¹æ¬¡æ•°<code>modCount</code>å­—æ®µä¸º<code>0</code>ï¼Œå¾—åˆ°ä¸€ä¸ªå…¨æ–°çš„å…‹éš†é›†åˆè¿”å›ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><code>Java</code>ä¸­æ‰€æœ‰ç±»éƒ½æ˜¯ä»<code>java.lang.Object</code>ç±»ç»§æ‰¿è€Œæ¥çš„ï¼Œè€Œ<code>Object</code>ç±»æä¾›<code>protected Object clone()</code>æ–¹æ³•å¯¹å¯¹è±¡è¿›è¡Œå…‹éš†ï¼Œå­ç±»å¿…é¡»å®ç°æ ‡è®°å‹æ¥å£<code>java.lang.Cloneable</code>æ‰æ”¯æŒå…‹éš†ï¼Œå½“ç„¶å­ç±»ä¹Ÿå¯ä»¥é‡å†™<code>Object#clone()</code>æ–¹æ³•æ¥å®ç°è‡ªå·±çš„å…‹éš†æ–¹å¼ã€‚</p><p>å¯¹è±¡çš„å…‹éš†æœ‰ä¸€ä¸ªåŸºæœ¬é—®é¢˜ï¼šå¯¹è±¡å¯èƒ½åŒ…å«å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ï¼Œå½“ä½¿ç”¨<code>Object#clone()</code>æ–¹æ³•æ¥å…‹éš†å¯¹è±¡æ—¶ï¼Œæ­¤å¯¹è±¡å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ä¹Ÿè¢«å…‹éš†äº†ä¸€ä»½ï¼ˆæ³¨æ„ï¼šè¿™é‡Œå…‹éš†çš„æ˜¯å¼•ç”¨ï¼‰ã€‚</p><p><code>java.lang.Cloneable</code>æ¥å£åªèµ·ä¸€ä¸ªä½œç”¨ï¼Œå°±æ˜¯åœ¨è¿è¡ŒæœŸæŒ‡ç¤ºè™šæ‹Ÿæœºåœ¨å½“å‰ç±»ä½¿ç”¨<code>Object#clone()</code>æ–¹æ³•æ˜¯åˆæ³•çš„ã€‚é€šè¿‡å…‹éš†å¯ä»¥å¾—åˆ°ä¸€ä¸ªå¯¹è±¡çš„å¤åˆ¶ã€‚ä½†ç”±äº<code>Object</code>ç±»å¹¶æœªå®ç°<code>java.lang.Cloneable</code>æ¥å£ï¼Œæ‰€ä»¥è¢«å…‹éš†çš„ç±»å¦‚æœæœªå®ç°<code>java.lang.Cloneable</code>æ¥å£ï¼Œåœ¨è°ƒç”¨<code>java.lang.Object#clone()</code>æ–¹æ³•æ—¶ä¼šæŠ›å‡º<code>java.lang.CloneNotSupportedException</code>å¼‚å¸¸ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£æ·±æµ…æ‹·è´</title>
      <link href="2020/04/26/javase/base/depth-shallow-copy/"/>
      <url>2020/04/26/javase/base/depth-shallow-copy/</url>
      
        <content type="html"><![CDATA[<p>æ— è®ºæ˜¯<code>java.lang.Object#clone()</code>æ–¹æ³•è¿˜æ˜¯è‡ªå·±å®ç°çš„å…‹éš†æ–¹æ³•ï¼Œéƒ½å­˜åœ¨ç€æµ…æ‹·è´å’Œæ·±æ‹·è´çš„é—®é¢˜ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ˜¯æµ…æ‹·è´å’Œæ·±æ‹·è´å‘¢ï¼Ÿ</p><p>ä¸¾ä¸€ä¸ªä¸å¤ªæ°å½“çš„ä¾‹å­ï¼šå¤§å®¶éƒ½ç©è¿‡è‹±é›„è”ç›Ÿè¿™æ¬¾æ¸¸æˆå§ï¼Ÿè‹±é›„è”ç›Ÿä¸­çš„å­™æ‚Ÿç©ºè¿™ä¸ªè‹±é›„çš„<code>W</code>æŠ€èƒ½æ˜¯â€œçœŸå‡çŒ´ç‹â€ï¼šå­™æ‚Ÿç©ºè¿›å…¥éšå½¢çŠ¶æ€ç‰‡åˆ»ï¼Œå¹¶ç•™ä¸‹ä¸€ä¸ªæ›¿èº«ï¼Œæ›¿èº«åœ¨ç‰‡åˆ»åä¼šå¯¹å…¶å‘¨å›´çš„æ•Œäººé€ æˆé­”æ³•ä¼¤å®³ã€‚å¦‚æœç©å®¶æ”»å‡»æ›¿èº«ï¼Œæ›¿èº«æ‰è¡€ä½†æœ¬èº«ä¸æ‰è¡€ã€‚è¿™ä¼¼ä¹å¯ä»¥ç†è§£æˆæ·±æ‹·è´ã€‚</p><h2 id="æµ…æ‹·è´å’Œæ·±æ‹·è´ç®€ä»‹"><a href="#æµ…æ‹·è´å’Œæ·±æ‹·è´ç®€ä»‹" class="headerlink" title="æµ…æ‹·è´å’Œæ·±æ‹·è´ç®€ä»‹"></a>æµ…æ‹·è´å’Œæ·±æ‹·è´ç®€ä»‹</h2><ul><li>æµ…æ‹·è´ï¼šåªæ‹·è´è¢«å…‹éš†å¯¹è±¡ä¸­æŒ‰å€¼ä¼ é€’çš„å±æ€§æ•°æ®ï¼Œä¸æ‹·è´å¼•ç”¨ç±»å‹çš„å±æ€§æ•°æ®ã€‚æ¢è¨€ä¹‹ï¼Œæ‰€æœ‰å¯¹å…¶å®ƒå¯¹è±¡çš„å¼•ç”¨ä»æŒ‡å‘åŸæ¥çš„å¯¹è±¡ï¼Œæ‹·è´çš„æ˜¯æ ˆå†…çš„å¼•ç”¨è€Œä¸æ˜¯å †å†…çš„å¯¹è±¡ã€‚</li><li>æ·±æ‹·è´ï¼šé™¤äº†æµ…æ‹·è´éœ€è¦å…‹éš†çš„å€¼ä¼ é€’çš„å±æ€§æ•°æ®ä¹‹å¤–ï¼Œè¿˜ä¼šæ‹·è´å¼•ç”¨ç±»å‹æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œå³æ‹·è´çš„å¼•ç”¨ä¼šæŒ‡å‘æ–°çš„å¯¹è±¡ã€‚æ¢è¨€ä¹‹ï¼Œæ·±æ‹·è´æŠŠå¾…å…‹éš†çš„å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡å…¨éƒ½æ‹·è´äº†ä¸€éã€‚</li></ul><p>æ·±æ‹·è´è¦æ·±å…¥åˆ°å¤šå°‘å±‚ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦æ ¹æ®å®é™…æƒ…å†µæ¥å†³å®šçš„é—®é¢˜ã€‚å½“æ‹·è´è‡³æ— å¼•ç”¨å¯¹è±¡çš„æ—¶å€™ï¼Œå°±å¯ç§°ä¹‹ä¸ºå®Œå…¨æ·±æ‹·è´ã€‚æ­¤å¤–ï¼Œæ·±æ‹·è´ä¸­è¿˜å¯èƒ½ä¼šå‡ºç°å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œéœ€è¦ä»”ç»†å¤„ç†ã€‚</p><h2 id="java-lang-Object-clone-æµ…æ‹·è´"><a href="#java-lang-Object-clone-æµ…æ‹·è´" class="headerlink" title="java.lang.Object#clone()æµ…æ‹·è´"></a><code>java.lang.Object#clone()</code>æµ…æ‹·è´</h2><p>ä¸ºäº†è¯å®è¯¥æ–¹æ³•æ˜¯æµ…æ‹·è´ï¼Œæˆ‘ä»¬å…ˆæ¥å°è¯•è®¾è®¡ä¸€ä¸‹è‹±é›„ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª<code>LOL</code>è‹±é›„æ¥å£ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼šæ”»å‡»å’Œè¢«æ”»å‡»ï¼Œæ”»å‡»æ—¶æ³•åŠ›å€¼å‡å°‘ï¼Œè¢«æ”»å‡»æ—¶ç”Ÿå‘½å€¼å‡å°‘ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * LOLè‹±é›„æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LolHero</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”»å‡»</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lolSkill ä½¿ç”¨çš„æŠ€èƒ½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">attack</span><span class="params">(LolSkill lolSkill)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å—åˆ°å…¶å®ƒè‹±é›„æ”»å‡»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">beAttacked</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬æ¥å®šä¹‰æŠ€èƒ½ç±»ï¼ŒæŠ€èƒ½åŒ…æ‹¬æŒ‰é”®<code>key</code>ã€æŠ€èƒ½åç§°å’ŒæŠ€èƒ½æè¿°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * LOLè‹±é›„çš„æŠ€èƒ½ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LolSkill</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String key;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LolSkill</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LolSkill</span><span class="params">(String key, String name, String desc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> key;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;LolSkill&#123;&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;key=&#x27;&quot;</span>).append(key).append(<span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;, name=&#x27;&quot;</span>).append(name).append(<span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;, desc=&#x27;&quot;</span>).append(desc).append(<span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">        sb.append(<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®šä¹‰ç”Ÿå‘½å€¼å’Œæ³•åŠ›å€¼ç±»ã€‚</p><p>ç”Ÿå‘½å€¼ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‹±é›„ç”Ÿå‘½å€¼ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeValue</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer lifeValue;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LifeValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LifeValue</span><span class="params">(Integer lifeValue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lifeValue = lifeValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getLifeValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> lifeValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LifeValue <span class="title">setLifeValue</span><span class="params">(Integer lifeValue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lifeValue = lifeValue;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;LifeValue&#123;&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;lifeValue=&quot;</span>).append(lifeValue);</span><br><span class="line">        sb.append(<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³•åŠ›å€¼ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‹±é›„æ³•åŠ›å€¼ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mana</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer mana;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Mana</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Mana</span><span class="params">(Integer mana)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mana = mana;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getMana</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mana;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mana <span class="title">setMana</span><span class="params">(Integer mana)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mana = mana;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;Mana&#123;&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;mana=&quot;</span>).append(mana);</span><br><span class="line">        sb.append(<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åæˆ‘ä»¬æ¥åˆ›å»ºå­™æ‚Ÿç©ºè‹±é›„ç±»ï¼Œå®ƒå®ç°äº†è‡ªå®šä¹‰çš„<code>LOL</code>è‹±é›„æ¥å£å’Œ<code>java.lang.Cloneable</code>æ¥å£ï¼ŒåŒ…å«è‹±é›„åç§°ã€ç”Ÿå‘½å€¼ã€æ³•åŠ›å€¼å’Œå››ä¸ªæŠ€èƒ½ç­‰å±æ€§ï¼Œé‡å†™äº†<code>java.lang.Cloneable#clone()</code>æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‹±é›„ï¼šå­™æ‚Ÿç©º</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SunWuKong</span> <span class="keyword">implements</span> <span class="title">LolHero</span>,<span class="title">Cloneable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åå­—</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">&quot;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿå‘½å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> LifeValue sunWuKongLifeValue;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³•åŠ›å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Mana sunWuKongMana;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* skill */</span></span><br><span class="line">    <span class="keyword">private</span> LolSkill Q = <span class="keyword">new</span> LolSkill(<span class="string">&quot;Q&quot;</span>,<span class="string">&quot;ç²‰ç¢æ‰“å‡»&quot;</span>,<span class="string">&quot;å­™æ‚Ÿç©ºçš„ä¸‹æ¬¡æ”»å‡»é€ æˆé¢å¤–ç‰©ç†ä¼¤å®³ï¼Œè·å¾—è·ç¦»åŠ æˆï¼Œå¹¶æš‚æ—¶å‡å°‘æ•Œäººçš„æŠ¤ç”²ã€‚&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> LolSkill W = <span class="keyword">new</span> LolSkill(<span class="string">&quot;W&quot;</span>,<span class="string">&quot;çœŸå‡çŒ´ç‹&quot;</span>,<span class="string">&quot;å­™æ‚Ÿç©ºè¿›å…¥éšå½¢çŠ¶æ€ç‰‡åˆ»ï¼Œå¹¶ç•™ä¸‹ä¸€ä¸ªæ›¿èº«ï¼Œæ›¿èº«åœ¨ç‰‡åˆ»åä¼šå¯¹å…¶å‘¨å›´çš„æ•Œäººé€ æˆé­”æ³•ä¼¤å®³ã€‚&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> LolSkill E = <span class="keyword">new</span> LolSkill(<span class="string">&quot;E&quot;</span>,<span class="string">&quot;è…¾äº‘çªå‡»&quot;</span>,<span class="string">&quot;å­™æ‚Ÿç©ºçªè¿›è‡³ç›®æ ‡æ•Œäººå¤„ï¼Œå¹¶å˜å‡ºæœ€å¤š2ä¸ªåˆ†èº«ï¼Œæ”»å‡»é™„è¿‘ç›®æ ‡ã€‚å¯¹æ¯ä¸ªå‡»ä¸­çš„ç›®æ ‡é€ æˆç‰©ç†ä¼¤å®³ã€‚&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> LolSkill R = <span class="keyword">new</span> LolSkill(<span class="string">&quot;R&quot;</span>,<span class="string">&quot;å¤§é—¹å¤©å®«&quot;</span>,<span class="string">&quot;å­™æ‚Ÿç©ºå±•å¼€é‡‘ç®æ£’ï¼Œä¸åœåœ°æ—‹è½¬ï¼Œå¯¹æ•Œäººé€ æˆä¼¤å®³å¹¶å°†å…¶å‡»é£ã€‚åœ¨æ­¤æœŸé—´ï¼Œå­™æ‚Ÿç©ºé€Ÿåº¦æŒç»­å¢åŠ ã€‚&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attack</span><span class="params">(LolSkill lolSkill)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½¿ç”¨äº†&quot;</span> + lolSkill + <span class="string">&quot;è¿›è¡Œäº†æ”»å‡»&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beAttacked</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Integer oldSunWuKongLifeValue = <span class="keyword">this</span>.sunWuKongLifeValue.getLifeValue() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">this</span>.sunWuKongLifeValue.setLifeValue(oldSunWuKongLifeValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LifeValue <span class="title">getSunWuKongLifeValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sunWuKongLifeValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SunWuKong <span class="title">setSunWuKongLifeValue</span><span class="params">(LifeValue sunWuKongLifeValue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sunWuKongLifeValue = sunWuKongLifeValue;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mana <span class="title">getSunWuKongMana</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sunWuKongMana;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SunWuKong <span class="title">setSunWuKongMana</span><span class="params">(Mana sunWuKongMana)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sunWuKongMana = sunWuKongMana;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;SunWuKong&#123;&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;name=&#x27;&quot;</span>).append(name).append(<span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;, sunWuKongLifeValue=&quot;</span>).append(sunWuKongLifeValue);</span><br><span class="line">        sb.append(<span class="string">&quot;, sunWuKongMana=&quot;</span>).append(sunWuKongMana);</span><br><span class="line">        sb.append(<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ·±æµ…æ‹·è´æµ‹è¯•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DepthCopyTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªå­™æ‚Ÿç©ºè‹±é›„å¯¹è±¡ï¼Œå¹¶èµ‹äºˆç”Ÿå‘½å€¼1000ï¼Œæ³•åŠ›å€¼2000</span></span><br><span class="line">        SunWuKong sunWuKong = <span class="keyword">new</span> SunWuKong();</span><br><span class="line">        sunWuKong.setSunWuKongLifeValue(<span class="keyword">new</span> LifeValue(<span class="number">1000</span>))</span><br><span class="line">                .setSunWuKongMana(<span class="keyword">new</span> Mana(<span class="number">2000</span>));</span><br><span class="line">        <span class="comment">// å…‹éš†ä¸€ä¸ªæ›¿èº«</span></span><br><span class="line">        SunWuKong clone = (SunWuKong) sunWuKong.clone();</span><br><span class="line">        System.out.println(sunWuKong);</span><br><span class="line">        System.out.println(clone);</span><br><span class="line">        System.out.println(sunWuKong == clone);</span><br><span class="line">        <span class="comment">// æ›¿èº«å—åˆ°æ”»å‡»</span></span><br><span class="line">        clone.beAttacked();</span><br><span class="line">        System.out.println(sunWuKong);</span><br><span class="line">        System.out.println(clone);</span><br><span class="line">        System.out.println(sunWuKong == clone);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SunWuKong&#123;name&#x3D;&#39;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&#39;, sunWuKongLifeValue&#x3D;LifeValue&#123;lifeValue&#x3D;1000&#125;, sunWuKongMana&#x3D;Mana&#123;mana&#x3D;2000&#125;&#125;</span><br><span class="line">SunWuKong&#123;name&#x3D;&#39;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&#39;, sunWuKongLifeValue&#x3D;LifeValue&#123;lifeValue&#x3D;1000&#125;, sunWuKongMana&#x3D;Mana&#123;mana&#x3D;2000&#125;&#125;</span><br><span class="line">false</span><br><span class="line">SunWuKong&#123;name&#x3D;&#39;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&#39;, sunWuKongLifeValue&#x3D;LifeValue&#123;lifeValue&#x3D;999&#125;, sunWuKongMana&#x3D;Mana&#123;mana&#x3D;2000&#125;&#125;</span><br><span class="line">SunWuKong&#123;name&#x3D;&#39;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&#39;, sunWuKongLifeValue&#x3D;LifeValue&#123;lifeValue&#x3D;999&#125;, sunWuKongMana&#x3D;Mana&#123;mana&#x3D;2000&#125;&#125;</span><br><span class="line">false</span><br></pre></td></tr></table></figure><p>å­™æ‚Ÿç©ºâ€œæ›¿èº«â€å—åˆ°æ”»å‡»åï¼Œâ€œçœŸèº«â€çš„ç”Ÿå‘½å€¼ä¹Ÿå‡å°‘äº†ã€‚å¯ä»¥çœ‹å‡ºçœŸèº«å’Œæ›¿èº«å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªç”Ÿå‘½å€¼å¯¹è±¡ã€‚è¶³ä»¥è¯å®<code>java.lang.Cloneable#clone()</code>æ–¹æ³•æ˜¯æµ…æ‹·è´ã€‚</p><h2 id="æ·±æ‹·è´çš„å®ç°"><a href="#æ·±æ‹·è´çš„å®ç°" class="headerlink" title="æ·±æ‹·è´çš„å®ç°"></a>æ·±æ‹·è´çš„å®ç°</h2><p>æ·±æ‹·è´åˆ™ä¸èƒ½ç®€å•çš„åœ¨é‡å†™çš„<code>clone</code>æ–¹æ³•å†…ç›´æ¥è°ƒç”¨<code>super.clone()</code>ï¼Œéœ€è¦å°†å½“å‰ç±»çš„æ¯ä¸€ä¸ªå¼•ç”¨å¯¹è±¡éƒ½è¿›è¡Œæ‹·è´ï¼Œå¦‚æœå¼•ç”¨å¯¹è±¡è¿˜åŒ…å«å¼•ç”¨å¯¹è±¡ï¼Œåˆ™éœ€è¿›è¡Œå¤šå±‚æ‹·è´ã€‚</p><p>å½“å‰ç±»çš„æ¯ä¸€ä¸ªå¼•ç”¨å¯¹è±¡å‡éœ€å®ç°<code>java.lang.Cloneable</code>æ¥å£å¹¶é‡å†™å…¶<code>clone</code>æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹<code>SunWuKong</code>ç±»çš„å¼•ç”¨å¯¹è±¡ï¼š<code>LifeValue</code>å’Œ<code>Mana</code>ã€‚</p><p><code>LifeValue</code>ä»£ç å®ç°ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‹±é›„ç”Ÿå‘½å€¼ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeValue</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer lifeValue;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Mana</code>ä»£ç å®ç°ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‹±é›„æ³•åŠ›å€¼ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mana</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer mana;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶<code>SunWuKong</code>ç±»çš„<code>clone</code>æ–¹æ³•å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.cloneable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‹±é›„ï¼šå­™æ‚Ÿç©º</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/7</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SunWuKong</span> <span class="keyword">implements</span> <span class="title">LolHero</span>,<span class="title">Cloneable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åå­—</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">&quot;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿå‘½å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> LifeValue sunWuKongLifeValue;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³•åŠ›å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Mana sunWuKongMana;</span><br><span class="line">    </span><br><span class="line">    ......</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        SunWuKong clone = (SunWuKong) <span class="keyword">super</span>.clone();</span><br><span class="line">        LifeValue lifeValueClone = (LifeValue) <span class="keyword">this</span>.sunWuKongLifeValue.clone();</span><br><span class="line">        Mana manaClone = (Mana) <span class="keyword">this</span>.sunWuKongMana.clone();</span><br><span class="line">        clone.setSunWuKongLifeValue(lifeValueClone);</span><br><span class="line">        clone.setSunWuKongMana(manaClone);</span><br><span class="line">        <span class="keyword">return</span> clone;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å†æ¥çœ‹ä¸‹è¾“å‡ºç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SunWuKong&#123;name&#x3D;&#39;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&#39;, sunWuKongLifeValue&#x3D;LifeValue&#123;lifeValue&#x3D;1000&#125;, sunWuKongMana&#x3D;Mana&#123;mana&#x3D;2000&#125;&#125;</span><br><span class="line">SunWuKong&#123;name&#x3D;&#39;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&#39;, sunWuKongLifeValue&#x3D;LifeValue&#123;lifeValue&#x3D;1000&#125;, sunWuKongMana&#x3D;Mana&#123;mana&#x3D;2000&#125;&#125;</span><br><span class="line">false</span><br><span class="line">SunWuKong&#123;name&#x3D;&#39;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&#39;, sunWuKongLifeValue&#x3D;LifeValue&#123;lifeValue&#x3D;1000&#125;, sunWuKongMana&#x3D;Mana&#123;mana&#x3D;2000&#125;&#125;</span><br><span class="line">SunWuKong&#123;name&#x3D;&#39;é½å¤©å¤§åœ£-å­™æ‚Ÿç©º&#39;, sunWuKongLifeValue&#x3D;LifeValue&#123;lifeValue&#x3D;999&#125;, sunWuKongMana&#x3D;Mana&#123;mana&#x3D;2000&#125;&#125;</span><br><span class="line">false</span><br></pre></td></tr></table></figure><p>æ›¿èº«å¯¹è±¡å—åˆ°æ”»å‡»åï¼ŒåŸå¯¹è±¡ç”Ÿå‘½å€¼ä¸å˜ï¼Œæ›¿èº«å¯¹è±¡ç”Ÿå‘½å€¼å‡å°‘ã€‚è¿™å°±æ˜¯æ·±æ‹·è´çš„å®ç°ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ·±æ‹·è´è¦æ±‚è¢«æ‹·è´çš„ç±»çš„æ¯ä¸€ä¸ªå¼•ç”¨å¯¹è±¡éƒ½å®ç°<code>java.lang.Cloneable</code>æ¥å£å¹¶å®ç°<code>clone</code>æ–¹æ³•ï¼Œæ‰€ä»¥å½“éœ€è¦å®ç°æ·±æ‹·è´æ—¶ï¼Œéœ€è¦è¿›è¡Œå¯¹è±¡åŠŸèƒ½çš„å…¨é¢è€ƒè™‘ï¼Œç‰¹åˆ«æ˜¯å½“å¼•ç”¨å¯¹è±¡è¿˜åŒ…å«å¼•ç”¨å¯¹è±¡çš„å¤šå±‚åµŒå¥—æ—¶ï¼Œéœ€è¦ç»“åˆå¯¹è±¡çš„åŠŸèƒ½è¿›è¡Œè€ƒè™‘ã€‚</p><p>æœ¬ç¯‡æ–‡ç« æ‰€æœ‰æºä»£ç åœ°å€ï¼š<a href="https://github.com/sunchaser-lilu/gold-road-to-Java/tree/master/java-se/src/main/java/com/sunchaser/javase/base/cloneable">ä¼ é€é—¨</a></p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹RandomAccess</title>
      <link href="2020/04/26/javase/base/randomaccess/"/>
      <url>2020/04/26/javase/base/randomaccess/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è¯¥æ¥å£æ˜¯<code>List</code>å®ç°ä½¿ç”¨çš„æ ‡è®°å‹æ¥å£ï¼Œè¡¨æ˜å®ƒä»¬æ”¯æŒå¿«é€Ÿï¼ˆé€šå¸¸æ˜¯æ’å®šæ—¶é—´ï¼‰éšæœºè®¿é—®ã€‚æ­¤æ¥å£çš„ä¸»è¦ç›®çš„æ˜¯å…è®¸é€šç”¨ç®—æ³•æ›´æ”¹å…¶è¡Œä¸ºï¼Œä»¥åº”ç”¨äºéšæœºè®¿é—®åˆ—è¡¨æˆ–é¡ºåºè®¿é—®åˆ—è¡¨æ—¶æä¾›è‰¯å¥½çš„æ€§èƒ½ã€‚</p><p>å½“åº”ç”¨äºé¡ºåºè®¿é—®åˆ—è¡¨ï¼ˆä¾‹å¦‚<code>LinkedList</code>ï¼‰æ—¶ï¼Œç”¨äºæ“çºµéšæœºè®¿é—®åˆ—è¡¨ï¼ˆä¾‹å¦‚<code>ArrayList</code>ï¼‰çš„æœ€ä½³ç®—æ³•ä¼šäº§ç”ŸäºŒæ¬¡è¡Œä¸ºã€‚é¼“åŠ±ä½¿ç”¨é€šç”¨åˆ—è¡¨ç®—æ³•ï¼Œå…ˆæ£€æŸ¥ç»™å®šåˆ—è¡¨æ˜¯å¦ä¸ºè¯¥æ¥å£çš„å®ä¾‹ï¼Œç„¶åå†åº”ç”¨ä¸€ç§ç®—æ³•ï¼ˆå¦‚æœå°†å…¶åº”ç”¨äºé¡ºåºè®¿é—®åˆ—è¡¨åˆ™æ€§èƒ½è¾ƒå·®ï¼‰ï¼Œå¹¶åœ¨å¿…è¦æ—¶æ›´æ”¹å…¶è¡Œä¸ºä»¥ä¿è¯å¯æ¥å—çš„æ€§èƒ½ã€‚</p><p>å…¬è®¤çš„æ˜¯ï¼Œéšæœºè®¿é—®å’Œé¡ºåºè®¿é—®ä¹‹é—´çš„åŒºåˆ«é€šå¸¸æ˜¯æ¨¡ç³Šçš„ã€‚ä¾‹å¦‚ï¼ŒæŸäº›<code>List</code>å®ç°åœ¨å˜å¾—åºå¤§çš„æƒ…å†µä¸‹æä¾›æ¸è¿›çº¿æ€§çš„è®¿é—®æ—¶é—´ï¼Œä½†å®é™…ä¸Šå´æ˜¯æ’å®šçš„è®¿é—®æ—¶é—´ã€‚è¿™æ ·çš„<code>List</code>å®ç°é€šå¸¸åº”è¯¥å®ç°æ­¤æ¥å£ã€‚æ ¹æ®ç»éªŒï¼Œå¦‚æœæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œåˆ™<code>List</code>å®ç°åº”å®ç°æ­¤æ¥å£ï¼š</p><p>å¯¹äºç±»çš„å…¸å‹å®ä¾‹ï¼Œæ­¤å¾ªç¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>, n=list.size(); i &lt; n; i++)</span><br><span class="line">    list.get(i);</span><br></pre></td></tr></table></figure><p>æ¯”è¿™ä¸ªå¾ªç¯è¿è¡Œæ›´å¿«ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (Iterator i=list.iterator(); i.hasNext(); )</span><br><span class="line">    i.next();</span><br></pre></td></tr></table></figure><h2 id="ArrayListæ•ˆç‡æ¯”è¾ƒ"><a href="#ArrayListæ•ˆç‡æ¯”è¾ƒ" class="headerlink" title="ArrayListæ•ˆç‡æ¯”è¾ƒ"></a><code>ArrayList</code>æ•ˆç‡æ¯”è¾ƒ</h2><p><code>ArrayList</code>å®ç°äº†<code>RandomAccess</code>æ¥å£ï¼Œæ ¹æ®<code>RandomAccess</code>æ¥å£å®šä¹‰ï¼Œä½¿ç”¨<code>fori</code>å¾ªç¯éå†æ¯”è¿­ä»£å™¨éå†æ›´å¿«ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¿›è¡ŒéªŒè¯ã€‚</p><p>åˆ›å»ºä¸€ä¸ª<code>ArrayList</code>é›†åˆå¹¶å¡«å……ä¸€åƒä¸‡ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«ä½¿ç”¨<code>fori</code>å¾ªç¯å’Œè¿­ä»£å™¨è¿›è¡Œéå†ï¼Œè®¡ç®—å…¶è¿è¡Œæ—¶é—´ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.randomaccess;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éšæœºè®¿é—®å’Œè¿­ä»£å™¨è®¿é—®æ•ˆç‡æ¯”è¾ƒ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/4/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RandomIteratorCompare</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// init list data</span></span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000000</span>; i++) &#123;</span><br><span class="line">            list.add(String.valueOf(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// random access</span></span><br><span class="line">        <span class="keyword">long</span> randomStartTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>,size = list.size(); i &lt; size; i++) &#123;</span><br><span class="line">            list.get(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> randomEndTime = System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;random access:&quot;</span> + (randomEndTime - randomStartTime));</span><br><span class="line">        <span class="comment">// sequential access</span></span><br><span class="line">        <span class="keyword">long</span> sequentialStartTime = System.currentTimeMillis();</span><br><span class="line">        Iterator&lt;String&gt; iterator = list.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            iterator.next();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> sequentialEndTime = System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;sequential access:&quot;</span> + (sequentialEndTime - sequentialStartTime));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¾“å…¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">random access:6</span><br><span class="line">sequential access:11</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¾è€Œæ˜“è§ï¼Œ<code>ArrayList</code>ä½¿ç”¨è¿­ä»£å™¨éå†æ•ˆç‡ç•¥ä½äº<code>fori</code>éå†ã€‚</p><h2 id="LinkedListæ•ˆç‡æ¯”è¾ƒ"><a href="#LinkedListæ•ˆç‡æ¯”è¾ƒ" class="headerlink" title="LinkedListæ•ˆç‡æ¯”è¾ƒ"></a><code>LinkedList</code>æ•ˆç‡æ¯”è¾ƒ</h2><p>å½“åº”ç”¨äº<code>LinkedList</code>æ—¶ï¼Œç”¨äºæ“çºµ<code>ArrayList</code>çš„æœ€ä½³ç®—æ³•ï¼ˆ<code>fori</code>å¾ªç¯éå†ï¼‰ä¼šäº§ç”ŸäºŒæ¬¡è¡Œä¸ºã€‚<code>ListedList</code>æœªå®ç°<code>RandomAccess</code>æ¥å£ã€‚</p><p>æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª<code>LinkedList</code>ï¼Œå¯¹å…¶å¡«å……å…ƒç´ å¹¶åˆ†åˆ«ä½¿ç”¨<code>fori</code>å¾ªç¯å’Œè¿­ä»£å™¨è¿›è¡Œéå†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// init LinkedList data</span></span><br><span class="line">List&lt;String&gt; linkedList = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</span><br><span class="line">    linkedList.add(String.valueOf(i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// random access</span></span><br><span class="line"><span class="keyword">long</span> linkedListRandomStartTime = System.currentTimeMillis();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>,size = linkedList.size(); i &lt; size; i++) &#123;</span><br><span class="line">    linkedList.get(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> linkedListRandomEndTime = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">&quot;random access:&quot;</span> + (linkedListRandomEndTime - linkedListRandomStartTime));</span><br><span class="line"><span class="comment">// sequential access</span></span><br><span class="line"><span class="keyword">long</span> linkedListSequentialStartTime = System.currentTimeMillis();</span><br><span class="line">Iterator&lt;String&gt; linkedListIterator = arrayList.iterator();</span><br><span class="line"><span class="keyword">while</span> (linkedListIterator.hasNext()) &#123;</span><br><span class="line">    linkedListIterator.next();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> linkedListSequentialEndTime = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">&quot;sequential access:&quot;</span> + (linkedListSequentialEndTime - linkedListSequentialStartTime));</span><br></pre></td></tr></table></figure><p>è¿è¡Œåæ§åˆ¶å°è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">random access:11031</span><br><span class="line">sequential access:10</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>fori</code>å¾ªç¯éå†æ‰€è€—è´¹çš„æ—¶é—´å·²ç»è¿œè¿œè¶…è¿‡äº†è¿­ä»£å™¨éå†ï¼Œè¿™è¯´æ˜é€‚ç”¨äº<code>ArrayList</code>çš„æœ€ä½³ç®—æ³•ä¸å†é€‚ç”¨äº<code>LinkedList</code>ï¼Œè¿™ä¸é›†åˆçš„å†…éƒ¨æ•°æ®ç»“æ„å’Œ<code>get</code>æ–¹æ³•å®ç°æœ‰å…³ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å®ç°äº†<code>RandomAccess</code>æ¥å£çš„<code>ArrayList</code>ä½¿ç”¨<code>fori</code>å¾ªç¯éå†æ•ˆç‡æ›´é«˜ï¼Œè€Œ<code>LinkedList</code>ä½¿ç”¨è¿­ä»£å™¨éå†æ•ˆç‡æé«˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKæºç è§£æä¹‹Serializable</title>
      <link href="2020/03/21/javase/base/serializable/"/>
      <url>2020/03/21/javase/base/serializable/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Ÿ</p><ul><li>åºåˆ—åŒ–ï¼šå°†å¯¹è±¡çš„äºŒè¿›åˆ¶æ•°æ®æµå†™å…¥ç¡¬ç›˜ï¼ˆæˆ–ç”¨äºç½‘ç»œä¼ è¾“ï¼‰ï¼›</li><li>ååºåˆ—åŒ–ï¼šä»ç¡¬ç›˜ï¼ˆç½‘ç»œï¼‰ä¸­å°†å¯¹è±¡çš„äºŒè¿›åˆ¶æ•°æ®æµè¯»å–å‡ºæ¥è½¬åŒ–æˆå¯¹è±¡ã€‚</li></ul><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å®ç°äº†<code>java.io.serializable</code>æ ‡è®°æ€§æ¥å£çš„ç±»æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œå¯åºåˆ—åŒ–ç±»çš„æ‰€æœ‰å­ç±»å‹éƒ½æ˜¯å¯åºåˆ—åŒ–çš„ã€‚</p><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>Java</code>ä¸­åºåˆ—åŒ–æ¥å£æ˜¯ä¸€ä¸ªç©ºæ¥å£ï¼Œä»…ç”¨äºæ ‡è®°å¯åºåˆ—åŒ–çš„è¯­ä¹‰ã€‚</p><h2 id="åºåˆ—åŒ–UIDå­—æ®µï¼šserialVersionUID"><a href="#åºåˆ—åŒ–UIDå­—æ®µï¼šserialVersionUID" class="headerlink" title="åºåˆ—åŒ–UIDå­—æ®µï¼šserialVersionUID"></a>åºåˆ—åŒ–<code>UID</code>å­—æ®µï¼š<code>serialVersionUID</code></h2><p>å®ç°äº†<code>java.io.Serializable</code>æ¥å£çš„ç±»ï¼Œå¦‚æœæœªæ˜¾å¼è¿›è¡Œå£°æ˜ï¼Œåœ¨ç¼–è¯‘æœŸ<code>JVM</code>å°†ä½¿ç”¨è‡ªå·±çš„ç®—æ³•ç”Ÿæˆé»˜è®¤çš„<code>serialVersionUID</code>å­—æ®µã€‚</p><blockquote><p>é»˜è®¤çš„<code>serialVersionUID</code>ç”Ÿæˆç®—æ³•å¯¹ç±»çš„è¯¦ç»†ä¿¡æ¯éå¸¸æ•æ„Ÿï¼Œå› ä¸åŒçš„<code>JVM</code>å®ç°è€Œå¼‚ï¼Œå¹¶ä¸”åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šå¯èƒ½ä¼šå¯¼è‡´æ„å¤–çš„<code>java.io.InvalidClassException</code>å¼‚å¸¸ã€‚</p></blockquote><p>å½“è¿›è¡Œåºåˆ—åŒ–æ“ä½œæ—¶ï¼Œä¼šå°†æ­¤<code>serialVersionUID</code>åºåˆ—åŒ–è¿›äºŒè¿›åˆ¶æµä¸­ï¼›</p><p>å½“è¿›è¡Œååºåˆ—åŒ–æ“ä½œæ—¶ï¼Œå¦‚æœç”¨æ¥æ¥æ”¶å¯¹è±¡çš„ç±»ä¸­çš„<code>serialVersionUID</code>å­—æ®µå€¼ä¸åºåˆ—åŒ–æ—¶çš„å€¼ä¸ä¸€è‡´ï¼Œä¼šå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥ã€‚</p><h2 id="ä»£ç æ¼”ç¤º"><a href="#ä»£ç æ¼”ç¤º" class="headerlink" title="ä»£ç æ¼”ç¤º"></a>ä»£ç æ¼”ç¤º</h2><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç”¨æ¥åºåˆ—åŒ–æµ‹è¯•çš„ç±»<code>SerializableClass</code>ï¼Œå¹¶å®ç°åºåˆ—åŒ–æ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.serizlizable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åºåˆ—åŒ–ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/3/19</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializableClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">5135631042912401553L</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SerializableClass <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SerializableClass <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;SerializableClass&#123;&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;name=&#x27;&quot;</span>).append(name).append(<span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;, age=&quot;</span>).append(age);</span><br><span class="line">        sb.append(<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åˆ›å»ºæµ‹è¯•ç±»æ¥è¿›è¡Œåºåˆ—åŒ–ã€‚é¦–å…ˆåœ¨å½“å‰ç±»æ‰€åœ¨åŒ…ä¸­åˆ›å»º<code>serializableClass.txt</code>æ–‡ä»¶ã€‚ä¹‹åæˆ‘ä»¬åºåˆ—åŒ–å†™å¯¹è±¡å†™å…¥è¯¥æ–‡ä»¶ä¸­ï¼Œååºåˆ—åŒ–ä»è¯¥æ–‡ä»¶ä¸­è¯»å¯¹è±¡ã€‚</p><p>ä½¿ç”¨ä»¥ä¸‹ä»£ç å³å¯è·å–<code>txt</code>æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å½“å‰ç±»æ‰€åœ¨åŒ…ä¸­çš„serializableClass.txtæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">String path = SerializableTest.class.getResource(<span class="string">&quot;&quot;</span>).getPath();</span><br><span class="line">path = path.replace(<span class="string">&quot;target/classes&quot;</span>,<span class="string">&quot;src/main/java&quot;</span>) + <span class="string">&quot;serializableClass.txt&quot;</span>;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åˆ›å»ºç”¨æ¥åºåˆ—åŒ–çš„å¯¹è±¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SerializableClass sc = <span class="keyword">new</span> SerializableClass().setName(<span class="string">&quot;åºåˆ—åŒ–&quot;</span>).setAge(<span class="number">10</span>);</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬åˆ›å»ºåºåˆ—åŒ–çš„æ–¹æ³•<code>writeObject</code>ï¼Œå°†å¯¹è±¡å’Œ<code>txt</code>æ–‡ä»¶ç»å¯¹è·¯å¾„ä¼ å…¥è¿›è¡Œå†™å¯¹è±¡æ“ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(SerializableClass sc,String path)</span> </span>&#123;</span><br><span class="line">    FileOutputStream fos = <span class="keyword">null</span>;</span><br><span class="line">    ObjectOutputStream ops = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        fos = <span class="keyword">new</span> FileOutputStream(path);</span><br><span class="line">        ops = <span class="keyword">new</span> ObjectOutputStream(fos);</span><br><span class="line">        ops.writeObject(sc);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ops != <span class="keyword">null</span>) &#123;</span><br><span class="line">                ops.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (fos != <span class="keyword">null</span>) &#123;</span><br><span class="line">                fos.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>main</code>æ–¹æ³•ä¸­è°ƒç”¨å³å¯å°†å¯¹è±¡å†™å…¥æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œå¯æ‰“å¼€æ–‡æœ¬æ–‡ä»¶æŸ¥çœ‹ï¼ˆæœ‰ç‚¹ä¹±ç ï¼‰ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥åˆ›å»ºååºåˆ—åŒ–çš„æ–¹æ³•<code>readObject</code>ï¼Œå°†æ–‡æœ¬æ–‡ä»¶è·¯å¾„ä¼ å…¥è¿›è¡Œè¯»å¯¹è±¡æ“ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(String path)</span> </span>&#123;</span><br><span class="line">    FileInputStream fis = <span class="keyword">null</span>;</span><br><span class="line">    ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        fis = <span class="keyword">new</span> FileInputStream(path);</span><br><span class="line">        ois = <span class="keyword">new</span> ObjectInputStream(fis);</span><br><span class="line">        SerializableClass sc = (SerializableClass) ois.readObject();</span><br><span class="line">        System.out.println(sc);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ois != <span class="keyword">null</span>) &#123;</span><br><span class="line">                ois.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (fis != <span class="keyword">null</span>) &#123;</span><br><span class="line">                fis.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨è¯¥æ–¹æ³•åå¯åœ¨æ§åˆ¶å°çœ‹åˆ°å¯¹è±¡æ‰“å°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SerializableClass&#123;name&#x3D;&#39;åºåˆ—åŒ–&#39;, age&#x3D;10&#125;</span><br></pre></td></tr></table></figure><h3 id="ååºåˆ—åŒ–å¤±è´¥æ¼”ç¤º"><a href="#ååºåˆ—åŒ–å¤±è´¥æ¼”ç¤º" class="headerlink" title="ååºåˆ—åŒ–å¤±è´¥æ¼”ç¤º"></a>ååºåˆ—åŒ–å¤±è´¥æ¼”ç¤º</h3><p>å…ˆè°ƒç”¨<code>writeObject</code>æ–¹æ³•å°†å¯¹è±¡åºåˆ—åŒ–å†™å…¥æ–‡æœ¬æ–‡ä»¶ï¼Œç„¶åå»ä¿®æ”¹<code>SerializableClass</code>çš„<code>serialVersionUID</code>å­—æ®µçš„å€¼ï¼Œå†å»è°ƒç”¨<code>readObject</code>æ–¹æ³•ä»æ–‡æœ¬æ–‡ä»¶ä¸­ååºåˆ—åŒ–è¯»å¯¹è±¡ã€‚è¿™æ—¶ååºåˆ—åŒ–å°±ä¼šå¤±è´¥ï¼Œå¹¶æŠ›å‡º<code>java.io.InvalidClassException</code>å¼‚å¸¸ã€‚</p><p>ä¸»è¦å¼‚å¸¸å †æ ˆä¿¡æ¯å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java.io.InvalidClassException: com.sunchaser.javase.base.serizlizable.SerializableClass; </span><br><span class="line"></span><br><span class="line">local class incompatible: stream classdesc serialVersionUID &#x3D; 5135632042912401553, local class serialVersionUID &#x3D; 5135631042912401553</span><br></pre></td></tr></table></figure><h2 id="IDEAä¸­ç”ŸæˆserialVersionUID"><a href="#IDEAä¸­ç”ŸæˆserialVersionUID" class="headerlink" title="IDEAä¸­ç”ŸæˆserialVersionUID"></a><code>IDEA</code>ä¸­ç”Ÿæˆ<code>serialVersionUID</code></h2><p>æ‰“å¼€<code>IDEA</code>ï¼Œé€‰æ‹©<code>File</code>-&gt;<code>Settings</code>-&gt;<code>Editor</code>-&gt;<code>Inspections</code>ï¼Œåœ¨æœç´¢æ¡†ä¸­è¾“å…¥<code>serialVersionUID</code>ï¼Œæ‰¾åˆ°<code>Serializable class without &#39;serialVersionUID&#39;</code>ï¼Œè¿›è¡Œå‹¾é€‰ï¼Œç‚¹å‡»<code>apply</code>-&gt;<code>OK</code>è¿›è¡Œä¿å­˜ã€‚</p><p>è®¾ç½®ä¹‹åå¦‚æœå®ç°äº†<code>Serializable</code>æ¥å£çš„ç±»æœªå®šä¹‰<code>serialVersionUID</code>å­—æ®µï¼Œåˆ™ç±»åå¤„ä¼šæœ‰é»„è‰²è­¦å‘Šï¼Œè¾“å…¥å…‰æ ‡ç§»åŠ¨è‡³ç±»åå¤„æŒ‰ä¸‹å¿«æ·é”®<code>alt+enter</code>ä¼šæœ‰ç”Ÿæˆ<code>serialVersionUID</code>çš„å¿«æ·æ–¹å¼ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡å®Œæ•´ä»£ç åœ°å€ï¼š<a href="https://github.com/sunchaser-lilu/gold-road-to-Java/tree/master/java-se/src/main/java/com/sunchaser/javase/base/serizlizable">ä¼ é€é—¨</a></p><p><code>Serializable</code>æ¥å£å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œå®ç°äº†è¯¥æ¥å£çš„ç±»æ‰å…è®¸è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œè€Œ<code>serialVersionUID</code>å­—æ®µåˆ™åƒæ˜¯ä¸€ä¸ªâ€œç‰ˆæœ¬å·â€ï¼Œåºåˆ—åŒ–æ—¶å°†è¯¥å­—æ®µä¸€èµ·å­˜è‡³äºŒè¿›åˆ¶æµä¸­ï¼Œååºåˆ—åŒ–æ—¶ç”¨è¯¥å­—æ®µæ¥åˆ¤æ–­æ˜¯å¦æ˜¯å­˜è¿›å»æ—¶çš„çŠ¶æ€ã€‚å®ƒçš„ä½œç”¨å…¶å®å°±æ˜¯åˆ¤æ–­ååºåˆ—åŒ–å‡ºæ¥çš„å¯¹è±¡æ˜¯ä¸æ˜¯åŸæ¥åºåˆ—åŒ–çš„å¯¹è±¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JDKæºç è§£æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–å¤±è´¥ä»»åŠ¡ç®¡ç†ä¸­å¿ƒ</title>
      <link href="2020/03/03/middleware/xxl-job/job-fail-monitor/"/>
      <url>2020/03/03/middleware/xxl-job/job-fail-monitor/</url>
      
        <content type="html"><![CDATA[<p>è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æ—¶ä¸»è¦æ‰§è¡Œäº†<code>XxlJobScheduler.init()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ‰å…­ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼Œè¿™ç¯‡æ–‡ç« æ¥åˆ†æç¬¬ä¸‰ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼šåˆå§‹åŒ–å¤±è´¥ä»»åŠ¡ç®¡ç†ä¸­å¿ƒã€‚å…¶å…³é”®è°ƒç”¨ä»£ç ä¸ºï¼š<code>JobFailMonitorHelper.getInstance().start();</code></p><h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><p>æ¥çœ‹<code>com.xxl.job.admin.core.thread.JobFailMonitorHelper</code>ç±»çš„æºç ã€‚</p><h3 id="æˆå‘˜å˜é‡"><a href="#æˆå‘˜å˜é‡" class="headerlink" title="æˆå‘˜å˜é‡"></a>æˆå‘˜å˜é‡</h3><p>å…ˆçœ‹ç±»çš„ä¸»è¦æˆå‘˜å˜é‡ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/JobFailMonitorHelper.memberVariables.png" alt="JobFailMonitorHelper.memberVariables"></p><ol><li>ç§æœ‰<code>slf4j</code>æ—¥å¿—å¯¹è±¡ï¼›</li><li>ç§æœ‰é™æ€<code>JobFailMonitorHelper</code>ç±»å®ä¾‹å¯¹è±¡ï¼š<code>instance</code>ï¼›</li><li>ç§æœ‰æˆå‘˜å˜é‡ï¼š<code>Thread</code>ç±»å¯¹è±¡<code>monitorThread</code>ï¼›</li><li>ç§æœ‰å¸ƒå°”å˜é‡<code>toStop</code>ï¼Œåˆå§‹åŒ–ä¸º<code>false</code>ã€‚</li></ol><h3 id="æˆå‘˜æ–¹æ³•"><a href="#æˆå‘˜æ–¹æ³•" class="headerlink" title="æˆå‘˜æ–¹æ³•"></a>æˆå‘˜æ–¹æ³•</h3><ol><li>å®ä¾‹<code>instance</code>çš„å…¬æœ‰é™æ€è®¿é—®å™¨<code>getInstance()</code>ï¼›</li><li>å…¬æœ‰<code>start()</code>æ–¹æ³•ï¼›</li><li>å…¬æœ‰<code>toStop()</code>æ–¹æ³•ã€‚</li><li>ç§æœ‰<code>failAlarm()</code>æ–¹æ³•ï¼Œç”¨äºå¤±è´¥å‘Šè­¦ã€‚</li></ol><p>å…¶ä¸­å…¬æœ‰é™æ€è®¿é—®å™¨<code>getInstance()</code>å’Œç§æœ‰é™æ€<code>JobFailMonitorHelper</code>ç±»å®ä¾‹å¯¹è±¡<code>instance</code>å…±åŒå½¢æˆäº†é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ã€‚</p><h3 id="start-æ–¹æ³•è§£æ"><a href="#start-æ–¹æ³•è§£æ" class="headerlink" title="start()æ–¹æ³•è§£æ"></a><code>start()</code>æ–¹æ³•è§£æ</h3><p>å¯ä»¥å‘ç°è¯¥ç±»çš„ä¸»è¦å®ç°æ˜¯åœ¨<code>start()</code>æ–¹æ³•ä¸­ï¼Œå…ˆæŠ˜å ä¸€äº›å®ç°æˆ‘ä»¬æ¥çœ‹ä¸‹æ•´ä½“ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/JobFailMonitorHelper.start.png" alt="JobFailMonitorHelper.start"></p><ol><li>ç»™ç§æœ‰æˆå‘˜å˜é‡<code>Thread</code>ç±»å¯¹è±¡<code>monitorThread</code>èµ‹å€¼ï¼Œå³åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼šå®ç°<code>Runnable</code>æ¥å£å¹¶é‡å†™å…¶<code>run</code>æ–¹æ³•ï¼›</li><li>å°†å…¶è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼›</li><li>è®¾ç½®çº¿ç¨‹åä¸ºï¼š<code>xxl-job, admin JobFailMonitorHelper</code>ï¼›</li><li>è°ƒç”¨çº¿ç¨‹çš„<code>start()</code>æ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚</li></ol><p>è¿™å…¶å®æ˜¯ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ã€‚</p><p>æˆ‘ä»¬ç»§ç»­æ¥çœ‹å­çº¿ç¨‹é‡å†™çš„<code>run</code>æ–¹æ³•çš„å…·ä½“å®ç°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/JobFailMonitorHelper.complete.start.png" alt="JobFailMonitorHelper.complete.start"></p><p>çœ‹èµ·æ¥å®ç°æœ‰ç‚¹é•¿ï¼Œæˆ‘ä»¬é€æ¸å°†å…¶æ‹†è§£æ¥åˆ†æã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (!toStop) &#123;</span><br></pre></td></tr></table></figure><p>å¾ªç¯ï¼Œåˆ¤æ–­çš„æ¡ä»¶ä¸ºç§æœ‰å¸ƒå°”å˜é‡<code>toStop</code>çš„éï¼Œè€Œ<code>toStop</code>è¢«åˆå§‹åŒ–ä¸ºäº†<code>false</code>ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Long&gt; failLogIds = XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().findFailJobLogIds(<span class="number">1000</span>);</span><br></pre></td></tr></table></figure><p>ä»é…ç½®â€œå®¹å™¨â€<code>com.xxl.job.admin.core.conf.XxlJobAdminConfig</code>å¯¹è±¡ä¸­æ‹¿åˆ°<code>com.xxl.job.admin.dao.XxlJobLogDao</code>å¯¹è±¡ï¼Œè°ƒç”¨<code>findFailJobLogIds(1000)</code>æ–¹æ³•ã€‚è¿™æ˜¯<code>Mybatis</code>æŒä¹…å±‚çš„æ–¹æ³•ï¼Œæ¥çœ‹ä¸€ä¸‹å…¶å®ç°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;* Mapperæ¥å£ *&#x2F;</span><br><span class="line">public List&lt;Long&gt; findFailJobLogIds(@Param(&quot;pagesize&quot;) int pagesize);</span><br><span class="line"></span><br><span class="line">&#x2F;* xmlå®ç° *&#x2F;</span><br><span class="line">&lt;select id&#x3D;&quot;findFailJobLogIds&quot; resultType&#x3D;&quot;long&quot; &gt;</span><br><span class="line">SELECT id FROM &#96;xxl_job_log&#96;</span><br><span class="line">WHERE !(</span><br><span class="line">(trigger_code in (0, 200) and handle_code &#x3D; 0)</span><br><span class="line">OR</span><br><span class="line">(handle_code &#x3D; 200)</span><br><span class="line">)</span><br><span class="line">AND &#96;alarm_status&#96; &#x3D; 0</span><br><span class="line">ORDER BY id ASC</span><br><span class="line">LIMIT #&#123;pagesize&#125;</span><br><span class="line">&lt;&#x2F;select&gt;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥çš„å‚æ•°<code>pagesize</code>ä¸º<code>1000</code>ï¼Œ<code>SQL</code>çš„æŸ¥è¯¢æ¡ä»¶ï¼šéï¼ˆè°ƒåº¦æˆåŠŸ æˆ– æ‰§è¡ŒæˆåŠŸï¼‰ã€‚</p><p>æ‰€ä»¥æ­¤å¤„å®é™…ä¸Šå°±æ˜¯åˆ†é¡µæŸ¥è¯¢<code>1000</code>æ¡å¤±è´¥ä»»åŠ¡æ—¥å¿—è®°å½•çš„<code>failLogIds</code>ã€‚</p><p>å¦‚æœå­˜åœ¨å¤±è´¥çš„æ—¥å¿—è®°å½•åˆ™è¿›è¡Œéå†å¤„ç†ï¼Œæˆ‘ä»¬å¾€ä¸‹çœ‹å¤„ç†é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> lockRet = XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().updateAlarmStatus(failLogId, <span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (lockRet &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">XxlJobLog log = XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().load(failLogId);</span><br><span class="line">XxlJobInfo info = XxlJobAdminConfig.getAdminConfig().getXxlJobInfoDao().loadById(log.getJobId());</span><br></pre></td></tr></table></figure><p>è°ƒç”¨<code>XxlJobLogDao</code>çš„<code>updateAlarmStatus</code>æ–¹æ³•ï¼Œæ¥çœ‹ä¸‹å…¶<code>Mybatis</code>çš„å®ç°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public int updateAlarmStatus(@Param(&quot;logId&quot;) long logId,</span><br><span class="line"> @Param(&quot;oldAlarmStatus&quot;) int oldAlarmStatus,</span><br><span class="line"> @Param(&quot;newAlarmStatus&quot;) int newAlarmStatus);</span><br><span class="line"></span><br><span class="line">&lt;update id&#x3D;&quot;updateAlarmStatus&quot; &gt;</span><br><span class="line">    UPDATE xxl_job_log</span><br><span class="line">    SET</span><br><span class="line">        &#96;alarm_status&#96; &#x3D; #&#123;newAlarmStatus&#125;</span><br><span class="line">    WHERE &#96;id&#96;&#x3D; #&#123;logId&#125; AND &#96;alarm_status&#96; &#x3D; #&#123;oldAlarmStatus&#125;</span><br><span class="line">&lt;&#x2F;update&gt;</span><br></pre></td></tr></table></figure><p><code>CAS</code>ä¹è§‚é”çš„æ–¹å¼å°†<code>alarm_status</code>å­—æ®µä»<code>0</code>æ›´æ–°ä¸º<code>-1</code>ã€‚</p><blockquote><p>æ€è€ƒï¼šè¿™é‡Œä¸ºä»€ä¹ˆä½¿ç”¨ä¹è§‚é”ï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p><p>çŒœæƒ³ï¼šæ”¯æŒè°ƒåº¦é›†ç¾¤éƒ¨ç½²ï¼Œé«˜å¯ç”¨ã€‚</p></blockquote><p>å¦‚æœä¹è§‚é”â€œåŠ é”â€æˆåŠŸï¼Œåˆ™æ ¹æ®å¤±è´¥ä»»åŠ¡<code>failLogId</code>åŠ è½½ä»»åŠ¡æ—¥å¿—ä¿¡æ¯å’Œä»»åŠ¡ä¿¡æ¯ã€‚</p><p>å¾—åˆ°äº†ä»»åŠ¡å¿…è¦ä¿¡æ¯åå°±å¯ä»¥è¿›è¡Œå¤„ç†äº†ï¼ŒåŒ…æ‹¬é‡è¯•æˆ–å‘Šè­¦ï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (log.getExecutorFailRetryCount() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    JobTriggerPoolHelper.trigger(log.getJobId(), TriggerTypeEnum.RETRY, (log.getExecutorFailRetryCount()-<span class="number">1</span>), log.getExecutorShardingParam(), log.getExecutorParam());</span><br><span class="line">String retryMsg = <span class="string">&quot;&lt;br&gt;&lt;br&gt;&lt;span style=\&quot;color:#F39C12;\&quot; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;</span>+ I18nUtil.getString(<span class="string">&quot;jobconf_trigger_type_retry&quot;</span>) +<span class="string">&quot;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; &lt;/span&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">log.setTriggerMsg(log.getTriggerMsg() + retryMsg);</span><br><span class="line">XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().updateTriggerInfo(log);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­æ—¥å¿—ä¿¡æ¯ä¸­æ‰§è¡Œå™¨å¤±è´¥é‡è¯•æ¬¡æ•°æ˜¯å¦ä»å¤§äºé›¶ï¼Œæ˜¯åˆ™è¿›è¡Œé‡è¯•ã€‚</p><p>é‡è¯•å³é‡æ–°è¿›è¡Œè°ƒåº¦ï¼Œè°ƒç”¨<code>JobTriggerPoolHelper</code>ç±»çš„<code>trigger()</code>æ–¹æ³•ï¼Œä¼ å…¥äº†äº”ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ¥åˆ†åˆ«è§£é‡Šä¸€ä¸‹ï¼š</p><ul><li><code>log.getJobId()</code>ï¼šä»»åŠ¡ä¿¡æ¯è¡¨è‡ªå¢ä¸»é”®ã€‚</li><li><code>TriggerTypeEnum.RETRY</code>ï¼šæ‰§è¡Œç±»å‹ï¼šé‡è¯•ã€‚</li><li><code>(log.getExecutorFailRetryCount()-1)</code>ï¼šå½“å‰é‡è¯•æ¬¡æ•°å‡ä¸€ï¼Œè¿™é‡Œä¼ å…¥æ˜¯ä¸ºäº†æ‰§è¡Œæ—¶å­˜å…¥æ—¥å¿—è¡¨ï¼Œå½“å†æ¬¡å¤±è´¥æ—¶å¯ç¡®ä¿é‡è¯•æ¬¡æ•°ã€‚</li><li><code>log.getExecutorShardingParam()</code>ï¼šæ‰§è¡Œå™¨åˆ†ç‰‡å‚æ•°ï¼ˆåˆ†ç‰‡ä»»åŠ¡ç”¨åˆ°ï¼‰ã€‚</li><li><code>log.getExecutorParam()</code>ï¼šæ‰§è¡Œå™¨æ‰§è¡Œå‚æ•°ã€‚</li></ul><p>å…³äºä»»åŠ¡è°ƒåº¦æ‰§è¡Œæœ¬ç¯‡æ–‡ç« ä¸åšè¯¦ç»†ä»‹ç»ï¼Œåªéœ€çŸ¥é“è¿™é‡Œè§¦å‘äº†ä»»åŠ¡æ‰§è¡Œï¼Œå¹¶å°†å‡ä¸€åçš„é‡è¯•æ¬¡æ•°å­˜å…¥äº†æ—¥å¿—ï¼Œè‹¥è¿™æ¬¡æ‰§è¡Œä»ç„¶å¤±è´¥ï¼Œåˆ™å¯è¢«é‡æ–°æŸ¥å‡ºå¹¶æ ¹æ®å‰©ä½™é‡è¯•æ¬¡æ•°è¿›è¡Œå¤„ç†ã€‚</p><p>é‡è¯•å®Œæˆåæ›´æ–°æœ¬æ¡è®°å½•çš„è°ƒåº¦æ—¥å¿—<code>trigger_msg</code>å­—æ®µã€‚</p><p>ç„¶åè¿›è¡Œå‘Šè­¦å¤„ç†ï¼Œæ— è®ºæ˜¯å¦æœ‰é‡è¯•éƒ½ä¼šè¿›è¡Œå‘Šè­¦å¤„ç†ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹å‘Šè­¦çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> newAlarmStatus = <span class="number">0</span>;<span class="comment">// å‘Šè­¦çŠ¶æ€ï¼š0-é»˜è®¤ã€-1=é”å®šçŠ¶æ€ã€1-æ— éœ€å‘Šè­¦ã€2-å‘Šè­¦æˆåŠŸã€3-å‘Šè­¦å¤±è´¥</span></span><br><span class="line"><span class="keyword">if</span> (info!=<span class="keyword">null</span> &amp;&amp; info.getAlarmEmail()!=<span class="keyword">null</span> &amp;&amp; info.getAlarmEmail().trim().length()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">boolean</span> alarmResult = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        alarmResult = failAlarm(info, log);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        alarmResult = <span class="keyword">false</span>;</span><br><span class="line">        logger.error(e.getMessage(), e);</span><br><span class="line">    &#125;</span><br><span class="line">    newAlarmStatus = alarmResult?<span class="number">2</span>:<span class="number">3</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    newAlarmStatus = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">XxlJobAdminConfig.getAdminConfig().getXxlJobLogDao().updateAlarmStatus(failLogId, -<span class="number">1</span>, newAlarmStatus);</span><br></pre></td></tr></table></figure><p>åªæœ‰é…ç½®äº†å‘Šè­¦é‚®ç®±æ‰è¿›è¡Œå‘Šè­¦ï¼Œæ ¸å¿ƒé€»è¾‘æ˜¯è°ƒç”¨äº†ç§æœ‰æˆå‘˜æ–¹æ³•<code>failAlarm</code>ï¼Œæ ¹æ®è°ƒç”¨æƒ…å†µå¾—åˆ°æ–°çš„å‘Šè­¦çŠ¶æ€ï¼Œæœ€åä½¿ç”¨<code>CAS</code>çš„æ–¹å¼æ›´æ–°æ—¥å¿—è®°å½•è¡¨ï¼Œå°†<code>alarm_status</code>å­—æ®µä»<code>-1</code>æ›´æ–°ä¸ºæ–°çš„å‘Šè­¦çŠ¶æ€ã€‚</p><p>æœ€åé˜»å¡å½“å‰å­çº¿ç¨‹<code>10</code>ç§’ï¼Œä¸€æ¬¡å¾ªç¯å°±ç»“æŸäº†ã€‚</p><p>è€Œç§æœ‰æˆå‘˜æ–¹æ³•<code>failAlarm</code>çš„ä¸»è¦é€»è¾‘æ˜¯å‘é€é‚®ä»¶ï¼Œè°ƒåº¦ä¸­å¿ƒ<code>xxl-job-admin</code>é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­å¯é…ç½®å‘Šè­¦å‘ä»¶é‚®ç®±ï¼Œ<code>Web</code>ç®¡ç†åå°ç•Œé¢æ·»åŠ ä»»åŠ¡æ—¶å¯å¡«å†™å‘Šè­¦æ”¶ä»¶äººé‚®ç®±ã€‚è¯¥æ–¹æ³•æœ‰ä¸€è¡Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;String&gt; emailSet = <span class="keyword">new</span> HashSet&lt;String&gt;(Arrays.asList(info.getAlarmEmail().split(<span class="string">&quot;,&quot;</span>)));</span><br></pre></td></tr></table></figure><p>ä»è€Œå¾—çŸ¥åœ¨ç®¡ç†åå°ç•Œé¢æ·»åŠ ä»»åŠ¡æ—¶å¯å¡«å†™å¤šä¸ªå‘Šè­¦æ”¶ä»¶äººé‚®ç®±ï¼Œç”¨è‹±æ–‡é€—å·åˆ†éš”å³å¯ï¼Œä¼šè‡ªåŠ¨å»é‡ã€‚</p><p>æˆ‘ä»¬å¯åœ¨è¯¥æ–¹æ³•ä¸­å®ç°è‡ªå®šä¹‰çš„å‘Šè­¦æ–¹å¼ï¼Œä¾‹å¦‚é’‰é’‰æœºå™¨äººç­‰ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç”¨ä»¥ä¸‹ä¸€å¼ å›¾æ¥å¯¹å¤±è´¥ä»»åŠ¡ç®¡ç†ä¸­å¿ƒè¿›è¡Œå½’çº³æ€»ç»“ã€‚<br><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/job-fail-monitor.png" alt="job-fail-monitor"></p>]]></content>
      
      
      <categories>
          
          <category> ä¸­é—´ä»¶ </category>
          
          <category> å®šæ—¶ä»»åŠ¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxl-job </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³ç»­çº¦â€æœåŠ¡</title>
      <link href="2020/02/29/middleware/xxl-job/registry-center-heartbeat-renewal/"/>
      <url>2020/02/29/middleware/xxl-job/registry-center-heartbeat-renewal/</url>
      
        <content type="html"><![CDATA[<p>è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æ—¶ä¸»è¦æ‰§è¡Œäº†<code>XxlJobScheduler.init()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ‰å…­ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼Œè¿™ç¯‡æ–‡ç« æ¥åˆ†æç¬¬äºŒä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼šåˆå§‹åŒ–æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³ç»­çº¦â€æœåŠ¡ã€‚å…¶å…³é”®è°ƒç”¨ä»£ç ä¸ºï¼š<code>JobRegistryMonitorHelper.getInstance().start();</code></p><h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><p>æ¥çœ‹<code>com.xxl.job.admin.core.thread.JobRegistryMonitorHelper</code>ç±»çš„æºç ã€‚</p><h3 id="æˆå‘˜å˜é‡"><a href="#æˆå‘˜å˜é‡" class="headerlink" title="æˆå‘˜å˜é‡"></a>æˆå‘˜å˜é‡</h3><p>å…ˆçœ‹ç±»çš„æˆå‘˜å˜é‡ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/JobRegistryMonitorHelper.memberVariables.png" alt="JobRegistryMonitorHelper.memberVariables"></p><ol><li>ç§æœ‰<code>slf4j</code>æ—¥å¿—å¯¹è±¡ï¼›</li><li>ç§æœ‰é™æ€<code>JobRegistryMonitorHelper</code>ç±»å®ä¾‹å¯¹è±¡ï¼š<code>instance</code>ï¼›</li><li>ç§æœ‰æˆå‘˜å˜é‡ï¼š<code>Thread</code>ç±»å¯¹è±¡<code>registryThread</code>ï¼›</li><li>ç§æœ‰å¸ƒå°”å˜é‡<code>toStop</code>ï¼Œåˆå§‹åŒ–ä¸º<code>false</code>ã€‚</li></ol><h3 id="æˆå‘˜æ–¹æ³•"><a href="#æˆå‘˜æ–¹æ³•" class="headerlink" title="æˆå‘˜æ–¹æ³•"></a>æˆå‘˜æ–¹æ³•</h3><ol><li>å®ä¾‹<code>instance</code>çš„å…¬æœ‰é™æ€è®¿é—®å™¨<code>getInstance()</code>ï¼›</li><li>å…¬æœ‰<code>start()</code>æ–¹æ³•ï¼›</li><li>å…¬æœ‰<code>toStop()</code>æ–¹æ³•ã€‚</li></ol><p>å…¶ä¸­å…¬æœ‰é™æ€è®¿é—®å™¨<code>getInstance()</code>å’Œç§æœ‰é™æ€<code>JobRegistryMonitorHelper</code>ç±»å®ä¾‹å¯¹è±¡<code>instance</code>å…±åŒå½¢æˆäº†é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ã€‚</p><h3 id="start-æ–¹æ³•è§£æ"><a href="#start-æ–¹æ³•è§£æ" class="headerlink" title="start()æ–¹æ³•è§£æ"></a><code>start()</code>æ–¹æ³•è§£æ</h3><p>å¯ä»¥å‘ç°è¯¥ç±»çš„ä¸»è¦å®ç°æ˜¯åœ¨<code>start()</code>æ–¹æ³•ä¸­ï¼Œå…ˆæŠ˜å ä¸€äº›å®ç°æˆ‘ä»¬æ¥çœ‹ä¸‹æ•´ä½“ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/JobRegistryMonitorHelper.start.png" alt="JobRegistryMonitorHelper.start"></p><ol><li>ç»™ç§æœ‰æˆå‘˜å˜é‡<code>Thread</code>ç±»å¯¹è±¡<code>registryThread</code>èµ‹å€¼ï¼Œå³åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼šå®ç°<code>Runnable</code>æ¥å£å¹¶é‡å†™å…¶<code>run</code>æ–¹æ³•ï¼›</li><li>å°†å…¶è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼›</li><li>è®¾ç½®çº¿ç¨‹åä¸ºï¼š<code>xxl-job, admin JobRegistryMonitorHelper</code>ï¼›</li><li>è°ƒç”¨çº¿ç¨‹çš„<code>start()</code>æ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚</li></ol><p>è¿™å…¶å®æ˜¯ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ã€‚</p><p>æˆ‘ä»¬ç»§ç»­æ¥çœ‹å­çº¿ç¨‹é‡å†™çš„<code>run</code>æ–¹æ³•çš„å…·ä½“å®ç°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/JobRegistryMonitorHelper.complete.start.png" alt="JobRegistryMonitorHelper.complete.start"></p><p>çœ‹èµ·æ¥å®ç°æœ‰ç‚¹é•¿ï¼Œæˆ‘ä»¬é€æ¸å°†å…¶æ‹†è§£æ¥åˆ†æã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (!toStop) &#123;</span><br></pre></td></tr></table></figure><p>å¾ªç¯ï¼Œåˆ¤æ–­çš„æ¡ä»¶ä¸ºç§æœ‰å¸ƒå°”å˜é‡<code>toStop</code>çš„éï¼Œè€Œ<code>toStop</code>è¢«åˆå§‹åŒ–ä¸ºäº†<code>false</code>ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;XxlJobGroup&gt; groupList = XxlJobAdminConfig.getAdminConfig().getXxlJobGroupDao().findByAddressType(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>ä»é…ç½®â€œå®¹å™¨â€<code>com.xxl.job.admin.core.conf.XxlJobAdminConfig</code>å¯¹è±¡ä¸­æ‹¿åˆ°<code>com.xxl.job.admin.dao.XxlJobGroupDao</code>å¯¹è±¡ï¼Œè°ƒç”¨<code>findByAddressType(0)</code>æ–¹æ³•ã€‚è¿™æ˜¯<code>Mybatis</code>æŒä¹…å±‚çš„æ–¹æ³•ï¼Œæ¥çœ‹ä¸€ä¸‹å…¶å®ç°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;* Mapperæ¥å£ *&#x2F;</span><br><span class="line">public List&lt;XxlJobGroup&gt; findByAddressType(@Param(&quot;addressType&quot;) int addressType);</span><br><span class="line"></span><br><span class="line">&#x2F;* xmlå®ç° *&#x2F;</span><br><span class="line">&lt;select id&#x3D;&quot;findByAddressType&quot; parameterType&#x3D;&quot;java.lang.Integer&quot; resultMap&#x3D;&quot;XxlJobGroup&quot;&gt;</span><br><span class="line">SELECT &lt;include refid&#x3D;&quot;Base_Column_List&quot; &#x2F;&gt;</span><br><span class="line">FROM xxl_job_group AS t</span><br><span class="line">WHERE t.address_type &#x3D; #&#123;addressType&#125;</span><br><span class="line">ORDER BY t.order ASC</span><br><span class="line">&lt;&#x2F;select&gt;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥çš„å‚æ•°<code>addressType</code>ä¸º<code>0</code>ï¼Œ<code>SQL</code>çš„å«ä¹‰ä¸ºï¼šæŸ¥è¯¢<code>xxl_job_group</code>è¡¨ä¸­<code>address_type</code>å­—æ®µä¸º<code>0</code>çš„æ•°æ®å¹¶æŒ‰<code>order</code>å­—æ®µå‡åºæ’åºã€‚</p><p>æˆ‘ä»¬å¯ä»¥å»åˆå§‹åŒ–<code>sql</code>è„šæœ¬ä¸­å¯»æ‰¾è¯¥å­—æ®µçš„å«ä¹‰ï¼š<code>æ‰§è¡Œå™¨åœ°å€ç±»å‹ï¼š0=è‡ªåŠ¨æ³¨å†Œã€1=æ‰‹åŠ¨å½•å…¥</code>ã€‚</p><p>æ‰€ä»¥æ­¤å¤„ä»£ç çš„ä½œç”¨æ˜¯ï¼šæŸ¥è¯¢åœ°å€ç±»å‹ä¸ºè‡ªåŠ¨æ³¨å†Œçš„æ‰§è¡Œå™¨ä¿¡æ¯åˆ—è¡¨ã€‚</p><p>å¦‚æœæŸ¥è¯¢å‡ºçš„æ‰§è¡Œå™¨åˆ—è¡¨ä¸ä¸ºç©ºåˆ™ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; ids = XxlJobAdminConfig.getAdminConfig()</span><br><span class="line">                                .getXxlJobRegistryDao()</span><br><span class="line">                                .findDead(RegistryConfig.DEAD_TIMEOUT, <span class="keyword">new</span> Date());</span><br><span class="line"><span class="keyword">if</span> (ids!=<span class="keyword">null</span> &amp;&amp; ids.size()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">    XxlJobAdminConfig.getAdminConfig().getXxlJobRegistryDao().removeDead(ids);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨<code>XxlJobRegistryDao</code>çš„<code>findDead</code>æ–¹æ³•ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºï¼š</p><ul><li><code>RegistryConfig.DEAD_TIMEOUT</code>ï¼šè¶…æ—¶æ—¶é—´ï¼Œå€¼ä¸º<code>90</code>ï¼›</li><li><code>new Date()</code>ï¼šå½“å‰æ—¶é—´å¯¹è±¡ã€‚</li></ul><p>æ¥çœ‹ä¸€ä¸‹<code>Mybatis</code>çš„å®ç°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;Integer&gt; findDead(@Param(&quot;timeout&quot;) int timeout,</span><br><span class="line">                              @Param(&quot;nowTime&quot;) Date nowTime);</span><br><span class="line">                                  </span><br><span class="line">&lt;select id&#x3D;&quot;findDead&quot; parameterType&#x3D;&quot;java.util.HashMap&quot; resultType&#x3D;&quot;java.lang.Integer&quot; &gt;</span><br><span class="line">SELECT t.id</span><br><span class="line">FROM xxl_job_registry AS t</span><br><span class="line">WHERE t.update_time &lt;![CDATA[ &lt; ]]&gt; DATE_ADD(#&#123;nowTime&#125;,INTERVAL -#&#123;timeout&#125; SECOND)</span><br><span class="line">&lt;&#x2F;select&gt;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢çš„æ˜¯ä¸»é”®<code>id</code>åˆ—è¡¨ï¼Œå…³é”®çš„æ˜¯<code>where</code>æ¡ä»¶ï¼Œ<code>xxl_job_registry</code>è¡¨çš„<code>update_time</code>å­—æ®µå°äºä¼ å…¥çš„å½“å‰æ—¶é—´å‡å»ä¼ å…¥çš„è¶…æ—¶æ—¶é—´<code>90</code>ç§’ã€‚</p><p>å…¶å«ä¹‰ä¸ºï¼šæŸ¥è¯¢å‡º<code>90</code>ç§’å†…æœªæ›´æ–°æ—¶é—´çš„ä»»åŠ¡<code>id</code>é›†åˆåˆ—è¡¨ã€‚</p><blockquote><p>æ€è€ƒï¼šè¿™é‡ŒæŸ¥è¯¢æ—¶ä¸ºä»€ä¹ˆé€‰æ‹©ä¼ å…¥<code>Java</code>æ—¶é—´è€Œä¸æ˜¯ç›´æ¥ç”¨<code>MySQL</code>çš„<code>NOW()</code>å‡½æ•°è·å–å½“å‰æ—¶é—´ï¼Ÿ</p><p>è§£ç­”ï¼šé˜²æ­¢<code>MySQL</code>æœåŠ¡å™¨å’Œè°ƒåº¦ä¸­å¿ƒæœåŠ¡å™¨çš„æ—¶é’Ÿä¸åŒæ­¥ã€‚</p></blockquote><p>å¦‚æœæŸ¥åˆ°äº†è®°å½•ï¼Œåˆ™è°ƒç”¨<code>XxlJobRegistryDao</code>çš„<code>removeDead</code>æ–¹æ³•ã€‚æ¥çœ‹ä¸‹å…¶<code>Mybatis</code>å®ç°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public int removeDead(@Param(&quot;ids&quot;) List&lt;Integer&gt; ids);</span><br><span class="line">    </span><br><span class="line">&lt;delete id&#x3D;&quot;removeDead&quot; parameterType&#x3D;&quot;java.lang.Integer&quot; &gt;</span><br><span class="line">DELETE FROM xxl_job_registry</span><br><span class="line">WHERE id in</span><br><span class="line">&lt;foreach collection&#x3D;&quot;ids&quot; item&#x3D;&quot;item&quot; open&#x3D;&quot;(&quot; close&#x3D;&quot;)&quot; separator&#x3D;&quot;,&quot; &gt;</span><br><span class="line">#&#123;item&#125;</span><br><span class="line">&lt;&#x2F;foreach&gt;</span><br><span class="line">&lt;&#x2F;delete&gt;</span><br></pre></td></tr></table></figure><p>åˆ é™¤ä»»åŠ¡<code>id</code>åˆ—è¡¨å¯¹åº”çš„<code>xxl_job_registry</code>è®°å½•ã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åº”è¯¥ç†è§£åˆ°è¿™å®é™…ä¸Šæ˜¯â€œå¿ƒè·³â€æœºåˆ¶ã€‚â€œå¿ƒè·³â€çš„æœ€é•¿æ—¶é—´é—´éš”ä¸º<code>90</code>ç§’ã€‚</p><p>ç»§ç»­å¾€ä¸‹çœ‹ï¼Œåˆå§‹åŒ–äº†ä¸€ä¸ªå±€éƒ¨<code>HashMap</code>å¯¹è±¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HashMap&lt;String, List&lt;String&gt;&gt; appAddressMap = <span class="keyword">new</span> HashMap&lt;String, List&lt;String&gt;&gt;();</span><br><span class="line">List&lt;XxlJobRegistry&gt; list = XxlJobAdminConfig.getAdminConfig()</span><br><span class="line">                                    .getXxlJobRegistryDao()</span><br><span class="line">                                    .findAll(RegistryConfig.DEAD_TIMEOUT, <span class="keyword">new</span> Date());</span><br></pre></td></tr></table></figure><p>éšå³è°ƒç”¨<code>XxlJobRegistryDao</code>çš„<code>findAll</code>æ–¹æ³•æŸ¥è¯¢å‡ºäº†ä¸€ä¸ª<code>List&lt;XxlJobRegistry&gt;</code>é›†åˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹æŸ¥è¯¢æ¡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;XxlJobRegistry&gt; findAll(@Param(&quot;timeout&quot;) int timeout,</span><br><span class="line">                                    @Param(&quot;nowTime&quot;) Date nowTime);</span><br><span class="line">                                        </span><br><span class="line">&lt;select id&#x3D;&quot;findAll&quot; parameterType&#x3D;&quot;java.util.HashMap&quot; resultMap&#x3D;&quot;XxlJobRegistry&quot;&gt;</span><br><span class="line">SELECT &lt;include refid&#x3D;&quot;Base_Column_List&quot; &#x2F;&gt;</span><br><span class="line">FROM xxl_job_registry AS t</span><br><span class="line">WHERE t.update_time &lt;![CDATA[ &gt; ]]&gt; DATE_ADD(#&#123;nowTime&#125;,INTERVAL -#&#123;timeout&#125; SECOND)</span><br><span class="line">&lt;&#x2F;select&gt;</span><br></pre></td></tr></table></figure><p>é‡ç‚¹æ˜¯<code>where</code>æ¡ä»¶ï¼šæ›´æ–°æ—¶é—´<code>update_time</code>å¤§äºå½“å‰æ—¶é—´å‡å»â€œæ­»äº¡â€è¶…æ—¶æ—¶é—´<code>90</code>ç§’ã€‚</p><p>å³ï¼šæŸ¥è¯¢ä¸Šæ¬¡â€œå¿ƒè·³â€æ—¶é—´åœ¨<code>90</code>ç§’ä»¥å†…çš„æ³¨å†Œåˆ—è¡¨ã€‚</p><p>å®é™…ä¸Šè¿™æ˜¯åœ¨åšæ‰§è¡Œå™¨â€œå¿ƒè·³â€ç»­çº¦ï¼Œç±»ä¼¼äºå¾®æœåŠ¡ä¸­çš„æœåŠ¡ç»­çº¦ã€‚</p><p>æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (list != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (XxlJobRegistry item: list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (RegistryConfig.RegistType.EXECUTOR.name().equals(item.getRegistryGroup())) &#123;</span><br><span class="line">            String appName = item.getRegistryKey();</span><br><span class="line">            List&lt;String&gt; registryList = appAddressMap.get(appName);</span><br><span class="line">            <span class="keyword">if</span> (registryList == <span class="keyword">null</span>) &#123;</span><br><span class="line">                registryList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!registryList.contains(item.getRegistryValue())) &#123;</span><br><span class="line">                registryList.add(item.getRegistryValue());</span><br><span class="line">            &#125;</span><br><span class="line">            appAddressMap.put(appName, registryList);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæŸ¥è¯¢åˆ°æœ‰æœªâ€œæ­»äº¡â€çš„æ³¨å†Œåˆ—è¡¨ï¼Œåˆ™å¯¹å…¶è¿›è¡Œâ€œç»­çº¦â€ï¼š</p><ul><li>éå†æŸ¥è¯¢å‡ºçš„æ³¨å†Œåˆ—è¡¨ã€‚</li><li>å¦‚æœæ³¨å†Œç»„ä¸ºæ‰§è¡Œå™¨ï¼ˆè¿™é‡Œæ³¨æ„åˆ°æšä¸¾<code>RegistType</code>æœ‰ä¸¤ä¸ªå€¼ï¼š<code>EXECUTOR</code>ï¼ˆæ‰§è¡Œå™¨ï¼‰å’Œ<code>ADMIN</code>ï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰ï¼‰ã€‚</li><li>å–å‡ºæ³¨å†Œè¡¨çš„æ³¨å†Œé”®ï¼ˆ<code>xxl_job_registry</code>è¡¨ä¸­çš„<code>registry_key</code>å­—æ®µï¼‰ï¼šå³æ‰§è¡Œå™¨åç§°<code>appName</code>ã€‚</li><li>å…ˆå°è¯•ä»å±€éƒ¨<code>map</code>å˜é‡ä¸­å–å‡ºè¯¥æ‰§è¡Œå™¨åç§°å¯¹åº”æ³¨å†Œåœ°å€é›†åˆï¼Œè‹¥æ²¡æœ‰åˆ™æ–°å»ºä¸€ä¸ªç©ºé›†åˆï¼ˆæ‡’åŠ è½½æ€æƒ³ï¼‰ã€‚</li><li>åˆ¤æ–­ä»<code>map</code>ä¸­å–å‡ºçš„æ³¨å†Œåœ°å€é›†åˆæ˜¯å¦åŒ…å«å½“å‰éå†çš„æ³¨å†Œè¡¨çš„æ³¨å†Œå€¼ï¼ˆ<code>xxl_job_registry</code>è¡¨ä¸­çš„<code>registry_value</code>å­—æ®µï¼‰ï¼Œè‹¥ä¸åŒ…å«åˆ™æ·»åŠ è‡³é›†åˆï¼ˆå»é‡ï¼‰ã€‚</li><li>å°†æ‰§è¡Œå™¨åç§°<code>appName</code>å’Œæ³¨å†Œåœ°å€é›†åˆæ˜ å°„è‡³å±€éƒ¨<code>map</code>å˜é‡ã€‚</li></ul><p>æ˜ å°„è‡³å±€éƒ¨<code>map</code>å˜é‡åï¼Œå¼€å§‹æ‰§è¡ŒçœŸæ­£çš„â€œç»­çº¦â€åŠ¨ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (XxlJobGroup group: groupList) &#123;</span><br><span class="line">    List&lt;String&gt; registryList = appAddressMap.get(group.getAppName());</span><br><span class="line">    String addressListStr = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (registryList!=<span class="keyword">null</span> &amp;&amp; !registryList.isEmpty()) &#123;</span><br><span class="line">        Collections.sort(registryList);</span><br><span class="line">        addressListStr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (String item:registryList) &#123;</span><br><span class="line">            addressListStr += item + <span class="string">&quot;,&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        addressListStr = addressListStr.substring(<span class="number">0</span>, addressListStr.length()-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    group.setAddressList(addressListStr);</span><br><span class="line">    XxlJobAdminConfig.getAdminConfig().getXxlJobGroupDao().update(group);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>éå†ä»<code>xxl_job_group</code>è¡¨ä¸­æŸ¥è¯¢å‡ºçš„è‡ªåŠ¨æ³¨å†Œæ‰§è¡Œå™¨çš„ä¿¡æ¯åˆ—è¡¨ã€‚</li><li>ä»å±€éƒ¨<code>map</code>å˜é‡ä¸­å–å‡ºå½“å‰éå†æ‰§è¡Œå™¨å¯¹åº”çš„â€œå¿ƒè·³ç»­çº¦â€æ³¨å†Œåœ°å€é›†åˆã€‚</li><li>ç»„è£…æ‰§è¡Œå™¨æ³¨å†Œåœ°å€åˆ—è¡¨ï¼Œå¤šåœ°å€é€—å·åˆ†éš”ï¼›å¦‚æœâ€œç»­çº¦â€çš„åœ°å€é›†åˆä¸ºç©ºï¼Œåˆ™ä»£è¡¨å½“å‰æ‰§è¡Œå™¨å·²â€œæ­»äº¡â€ã€‚</li><li>æ›´æ–°æ‰§è¡Œå™¨â€œç»­çº¦â€çš„åœ°å€ä¿¡æ¯è‡³<code>DB</code>ï¼šæ›´æ–°<code>xxl_job_group</code>è¡¨çš„<code>address_list</code>å­—æ®µã€‚</li></ul><p>è‡³æ­¤ï¼Œä»»åŠ¡æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³â€æœºåˆ¶å°±å·²å®Œæˆã€‚</p><blockquote><p>åˆ°è¿™é‡Œæˆ‘ä»¬æˆ–è®¸æœ‰äº†ä¸€ä¸ªç–‘é—®ï¼Ÿ<code>xxl_job_registry</code>ä»»åŠ¡æ³¨å†Œè¡¨çš„è®°å½•æ˜¯ä½•æ—¶å­˜åœ¨çš„ï¼Ÿå³ä»»åŠ¡æ˜¯ä½•æ—¶è¢«æ³¨å†Œçš„ï¼Ÿ<br>æˆ‘ä»¬ä¹Ÿè®¸ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­æœ‰æ‰€å‘ç°ã€‚</p></blockquote><p>æœ€åï¼Œé˜»å¡å½“å‰å­çº¿ç¨‹<code>30</code>ç§’ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    TimeUnit.SECONDS.sleep(RegistryConfig.BEAT_TIMEOUT);</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!toStop) &#123;</span><br><span class="line">        logger.error(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job, job registry monitor thread error:&#123;&#125;&quot;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè°ƒç”¨<code>java.util.concurrent</code>åŒ…ä¸‹çš„æšä¸¾<code>TimeUnit</code>ç±»çš„<code>sleep</code>æ–¹æ³•è¿›è¡Œç¡çœ ï¼Œå…ˆæŒ‡å®šæ—¶é—´å•ä½ï¼Œå†æŒ‡å®šæ—¶é—´å¤§å°ï¼Œä»£ç å¯è¯»æ€§æ›´é«˜ï¼›å¦‚æœç›´æ¥ä½¿ç”¨ä¼ ç»Ÿ<code>Thread.sleep()</code>æ–¹æ³•ï¼Œä¼ ç»™<code>sleep</code>æ–¹æ³•çš„å€¼çš„å•ä½æ˜¯æ¯«ç§’ï¼Œå³éœ€ä¼ å…¥<code>30*1000</code>ï¼Œä»£ç å¯è¯»æ€§ä¸é«˜ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç”¨ä»¥ä¸‹ä¸€å‰¯å›¾æ¥å¯¹æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³ç»­çº¦â€æœåŠ¡è¿›è¡Œå½’çº³æ€»ç»“ã€‚<br><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/registry-center-heartbeat-renewal.png" alt="registry-center-heartbeat-renewal"></p>]]></content>
      
      
      <categories>
          
          <category> ä¸­é—´ä»¶ </category>
          
          <category> å®šæ—¶ä»»åŠ¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxl-job </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–å›½é™…åŒ–ç»„ä»¶</title>
      <link href="2020/02/27/middleware/xxl-job/initI18n/"/>
      <url>2020/02/27/middleware/xxl-job/initI18n/</url>
      
        <content type="html"><![CDATA[<p>è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æ—¶ä¸»è¦æ‰§è¡Œäº†<code>XxlJobScheduler.init()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ‰å…­ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼Œè¿™ç¯‡æ–‡ç« æ¥åˆ†æç¬¬ä¸€ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼šåˆå§‹åŒ–å›½é™…åŒ–ç»„ä»¶ã€‚å…¶å…³é”®è°ƒç”¨ä»£ç ä¸ºï¼š<code>initI18n();</code></p><h2 id="å›½é™…åŒ–ç®€ä»‹"><a href="#å›½é™…åŒ–ç®€ä»‹" class="headerlink" title="å›½é™…åŒ–ç®€ä»‹"></a>å›½é™…åŒ–ç®€ä»‹</h2><p>å›½é™…åŒ–åˆç§°ä¸º<code>i18n</code>ï¼Œæ¥æºäºå›½é™…åŒ–çš„è‹±æ–‡å•è¯<code>internationalization</code>ä»<code>i</code>åˆ°<code>n</code>ä¹‹é—´æœ‰<code>18</code>ä¸ªè‹±æ–‡å­—æ¯ã€‚</p><h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>initI18n()</code>æ–¹æ³•çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initI18n</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (ExecutorBlockStrategyEnum item:ExecutorBlockStrategyEnum.values()) &#123;</span><br><span class="line">        item.setTitle(I18nUtil.getString(<span class="string">&quot;jobconf_block_&quot;</span>.concat(item.name())));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ªç¯è¿­ä»£æšä¸¾<code>com.xxl.job.core.enums.ExecutorBlockStrategyEnum</code>ï¼Œè¯¥æšä¸¾æ˜¯æ‰§è¡Œå™¨é˜»å¡ç­–ç•¥æšä¸¾ã€‚åªæœ‰ä¸€ä¸ª<code>title</code>å±æ€§ï¼Œæä¾›äº†ä¸‰ä¸ªæšä¸¾å¯¹è±¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">ExecutorBlockStrategyEnum</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    SERIAL_EXECUTION(<span class="string">&quot;Serial execution&quot;</span>),</span><br><span class="line">    <span class="comment">/*CONCURRENT_EXECUTION(&quot;å¹¶è¡Œ&quot;),*/</span></span><br><span class="line">    DISCARD_LATER(<span class="string">&quot;Discard Later&quot;</span>),</span><br><span class="line">    COVER_EARLY(<span class="string">&quot;Cover Early&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">......</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>å¾ªç¯ä¸­è°ƒç”¨å˜å¼‚å™¨<code>setTitle()</code>æ–¹æ³•ç»™æ¯ä¸ªæšä¸¾å¯¹è±¡çš„<code>title</code>å±æ€§é‡æ–°èµ‹å€¼ã€‚</p><p>å·¥å…·ç±»<code>I18nUtil</code>çš„<code>getString()</code>æ–¹æ³•è·å–åˆ°ä»¥<code>jobconf_block_</code>å¼€å¤´ï¼Œä»¥æšä¸¾å¯¹è±¡åç»“å°¾çš„å±æ€§å€¼ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å·¥å…·ç±»<code>getString()</code>æ–¹æ³•çš„å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getString</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> loadI18nProp().getProperty(key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨äº†é™æ€æˆå‘˜æ–¹æ³•<code>loadI18nProp()</code>å¾—åˆ°ä¸€ä¸ª<code>Properties</code>å¯¹è±¡ï¼Œå†è°ƒç”¨å…¶<code>getProperty()</code>æ–¹æ³•ä»èµ„æºæ–‡ä»¶ä¸­è·å–å¯¹åº”<code>key</code>çš„å€¼ã€‚</p><p>æ¥çœ‹ä¸€ä¸‹<code>loadI18nProp()</code>æ–¹æ³•çš„å®ç°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/I18nUtil.loadI18nProp.png" alt="I18nUtil.loadI18nProp"></p><ul><li>è¯»å–<code>application.properties</code>é…ç½®æ–‡ä»¶çš„<code>xxl.job.i18n</code>é…ç½®é¡¹çš„å€¼;</li><li><code>build</code>ç»„è£…ï¼Œå¾—åˆ°<code>i18n</code>æ–‡ä»¶è·¯å¾„ã€‚å³<code>resources\i18n</code>ç›®å½•ä¸‹çš„<code>Resource Bundle &#39;message&#39;</code>èµ„æºåŒ…æ–‡ä»¶;</li><li>ä½¿ç”¨<code>Spring</code>æä¾›çš„<code>PropertiesLoaderUtils</code>å·¥å…·ç±»åŠ è½½å¯¹åº”èµ„æºæ–‡ä»¶ã€‚</li></ul><p>æˆ‘ä»¬å¯ä»¥ä»è¿™é‡ŒçŸ¥é“è°ƒåº¦ä¸­å¿ƒ<code>application.properties</code>çš„é…ç½®é¡¹<code>xxl.job.i18n</code>æœ‰ä¸¤ç§é…ç½®ï¼Œä¸€æ˜¯ç¼ºçœä¸å¡«ï¼Œä¸ºä¸­æ–‡ï¼›äºŒæ˜¯è®¾ç½®ä¸º<code>en</code>ï¼Œå³è‹±æ–‡ã€‚</p><p>å»<code>resources\i18n</code>ç›®å½•çœ‹ä¸‹èµ„æºåŒ…æ–‡ä»¶ï¼š<code>message.properties</code>å’Œ<code>message_en.properties</code>ã€‚æœç´¢<code>jobconf_block_</code>ï¼Œå¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š</p><p><code>message.properties</code>ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## job conf</span></span><br><span class="line"><span class="attr">jobconf_block_SERIAL_EXECUTION</span>=<span class="string">å•æœºä¸²è¡Œ</span></span><br><span class="line"><span class="attr">jobconf_block_DISCARD_LATER</span>=<span class="string">ä¸¢å¼ƒåç»­è°ƒåº¦</span></span><br><span class="line"><span class="attr">jobconf_block_COVER_EARLY</span>=<span class="string">è¦†ç›–ä¹‹å‰è°ƒåº¦</span></span><br></pre></td></tr></table></figure><p><code>message_en.properties</code>ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## job conf</span></span><br><span class="line"><span class="attr">jobconf_block_SERIAL_EXECUTION</span>=<span class="string">Serial execution</span></span><br><span class="line"><span class="attr">jobconf_block_DISCARD_LATER</span>=<span class="string">Discard Later</span></span><br><span class="line"><span class="attr">jobconf_block_COVER_EARLY</span>=<span class="string">Cover Early</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°é”®ä¸­<code>jobconf_block_</code>åæ¥çš„å†…å®¹å³ä¸º<code>ExecutorBlockStrategyEnum</code>æšä¸¾çš„<code>name</code>å€¼ã€‚ä¸€å…±æœ‰ä¸‰ä¸ªé˜»å¡ç­–ç•¥ï¼šå•æœºä¸²è¡Œã€ä¸¢å¼ƒåç»­è°ƒåº¦å’Œè¦†ç›–ä¹‹å‰è°ƒåº¦ã€‚</p><p><code>initI18n()</code>æ–¹æ³•çš„è¿­ä»£å®Œæˆåï¼Œæšä¸¾çš„<code>title</code>å±æ€§å€¼å°±å˜æˆäº†å¯¹åº”çš„å›½é™…åŒ–è®¾ç½®ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯åˆ†æäº†è°ƒåº¦ä¸­å¿ƒå›½é™…åŒ–ç»„ä»¶çš„åˆå§‹åŒ–åŸç†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†ç»§ç»­åˆ†æè°ƒåº¦ä¸­å¿ƒå¯åŠ¨çš„å…¶å®ƒåˆå§‹åŒ–åŠ¨ä½œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ä¸­é—´ä»¶ </category>
          
          <category> å®šæ—¶ä»»åŠ¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxl-job </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®ç‚¼xxl-jobä¹‹è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æµç¨‹è§£æ</title>
      <link href="2020/02/26/middleware/xxl-job/dispatch-center-start-process-analysis/"/>
      <url>2020/02/26/middleware/xxl-job/dispatch-center-start-process-analysis/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯è§£æè°ƒåº¦ä¸­å¿ƒ<code>xxl-job-admin</code>å¯åŠ¨æµç¨‹ã€‚</p><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è°ƒåº¦ä¸­å¿ƒé¡¹ç›®çš„<code>maven</code>ä¾èµ–ã€‚ä¾èµ–äº†<code>Spring Boot</code>çš„ä¸€äº›<code>starter</code>ä¾èµ–ï¼š<code>web</code>ã€<code>test</code>ã€<code>freemarker</code>ã€<code>mail</code>ã€<code>actuator</code>å’Œ<code>mybatis</code>ç­‰ï¼Œæœ€åä¾èµ–äº†<code>xxl-job-core</code>åŒ…ã€‚</p><p>è¿˜è®°å¾—æˆ‘ä»¬åœ¨ <a href="/2020/02/13/middleware/xxl-job/build-local-dispatch-platform/">ä¿®ç‚¼xxl-jobä¹‹æ­å»ºæœ¬åœ°è°ƒåº¦å¹³å°</a> æ—¶å¯åŠ¨è°ƒåº¦ä¸­å¿ƒè¿‡ç¨‹ä¸­æ§åˆ¶å°è¾“å‡ºçš„ä¸€å¥æ—¥å¿—å—ï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">13:01:40.001 logback [xxl-job, admin JobScheduleHelper#scheduleThread] INFO  c.x.j.a.c.thread.JobScheduleHelper - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin scheduler success.</span><br></pre></td></tr></table></figure><p><code>JobScheduleHelper</code>ç±»æ‰“å°äº†<code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin scheduler success.</code>ã€‚è¡¨ç¤ºåˆå§‹åŒ–ä»»åŠ¡è°ƒåº¦å™¨æˆåŠŸã€‚</p><h2 id="å¯åŠ¨åˆ†æ"><a href="#å¯åŠ¨åˆ†æ" class="headerlink" title="å¯åŠ¨åˆ†æ"></a>å¯åŠ¨åˆ†æ</h2><p>æˆ‘ä»¬æ‰¾åˆ°<code>com.xxl.job.admin.core.thread.JobScheduleHelper</code>ç±»ä¸­æ‰“å°å¯åŠ¨æ—¥å¿—çš„ä»£ç ï¼Œå‘ç°å…¶åœ¨è¯¥ç±»çš„<code>start</code>æ–¹æ³•ä¸­ï¼Œ<code>start</code>æ–¹æ³•åˆå§‹åŒ–äº†ä¸€ä¸ªå­çº¿ç¨‹ï¼Œåœ¨å­çº¿ç¨‹ä¸­æ‰“å°äº†æ—¥å¿—ã€‚</p><p>é‚£ä¹ˆè¯¥<code>start</code>æ–¹æ³•æ˜¯ä½•æ—¶è¢«æ‰§è¡Œçš„å‘¢ï¼Ÿæˆ‘ä»¬å‘ç°è¯¥ç±»å¹¶æœªäº¤ç”±<code>Spring</code>ç®¡ç†ï¼Œå€ŸåŠ©äº<code>IDEA</code>çš„å¿«æ·é”®<code>Ctrl+Alt+H</code>æŸ¥çœ‹è¯¥æ–¹æ³•çš„è°ƒç”¨å¤„ï¼Œå‘ç°å…¶åœ¨<code>XxlJobScheduler.init()</code>æ–¹æ³•ä¸­è¢«è°ƒç”¨äº†ï¼Œæ¥çœ‹ä¸€ä¸‹<code>init</code>æ–¹æ³•çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// init i18n</span></span><br><span class="line">    initI18n();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// admin registry monitor run</span></span><br><span class="line">    JobRegistryMonitorHelper.getInstance().start();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// admin monitor run</span></span><br><span class="line">    JobFailMonitorHelper.getInstance().start();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// admin trigger pool start</span></span><br><span class="line">    JobTriggerPoolHelper.toStart();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// admin log report start</span></span><br><span class="line">    JobLogReportHelper.getInstance().start();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// start-schedule</span></span><br><span class="line">    JobScheduleHelper.getInstance().start();</span><br><span class="line"></span><br><span class="line">    logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin success.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>JobScheduleHelper.getInstance().start();</code>è¿™ä¸€è¡Œä»£ç ä½¿ç”¨â€œé¥¿æ±‰å¼â€å•ä¾‹æ¨¡å¼å¾—åˆ°<code>JobScheduleHelper</code>ç±»å¯¹è±¡å¹¶éšä¹‹è°ƒç”¨äº†å…¶<code>start</code>æ–¹æ³•ï¼Œç„¶åæ‰“å°äº†ä¸€è¡Œæ—¥å¿—ï¼š<code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin success.</code>ã€‚</p><p>æ€è€ƒï¼šæ—¢ç„¶<code>JobScheduleHelper</code>ç±»ä¸­çš„å­çº¿ç¨‹ä¸­çš„æ—¥å¿—éƒ½è¿›è¡Œäº†æ‰“å°ï¼Œé‚£ä¹ˆåœ¨å…¶ä¹‹åçš„æ—¥å¿—æ‰“å°åœ¨äº†ä½•å¤„å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¤åˆ¶ä»£ç ä¸­çš„æ—¥å¿—ä¿¡æ¯ï¼Œå‰å¾€è°ƒåº¦ä¸­å¿ƒå¯åŠ¨çš„æ§åˆ¶å°ä¸­æŒ‰ä¸‹<code>Ctrl+F</code>æœç´¢ç›¸å…³ä¿¡æ¯ï¼Œå‘ç°ç¡®å®æ‰“å°äº†ï¼Œå¹¶ä¸”æ‰“å°çš„ä½ç½®éå¸¸é å‰ã€‚</p><p>å†æ¥çœ‹ä¸€ä¸‹<code>init()</code>æ–¹æ³•çš„å†™æ³•ï¼Œå‡ ä¹éƒ½æ˜¯è°ƒç”¨æŸä¸ª<code>XxxxxHelper</code>ç±»çš„<code>getInstance()</code>æ–¹æ³•ç„¶åå†è°ƒç”¨å…¶<code>start()</code>æ–¹æ³•ã€‚</p><p>çŒœæƒ³ï¼šè¿™é‡Œæ‰€æœ‰çš„<code>XxxxxHelper</code>ç±»çš„<code>start()</code>æ–¹æ³•éƒ½æ˜¯å¼€å¯å­çº¿ç¨‹æ‰§è¡Œç›¸å…³ä»»åŠ¡ï¼Œæ‰å¯¼è‡´<code>init()</code>æ–¹æ³•ä¸­çš„æ—¥å¿—æ‰“å°ä½ç½®éå¸¸é å‰ã€‚</p><p>å®é™…ä¸Šè¿™æ˜¯å…¨å¼‚æ­¥åŒ–è®¾è®¡æ€æƒ³çš„ä½“ç°ã€‚</p><p>æˆ‘ä»¬å‘ç°<code>init()</code>æ–¹æ³•æ‰€åœ¨çš„ç±»<code>XxlJobScheduler</code>ä¹Ÿæœªäº¤ç”±<code>Spring</code>ç®¡ç†ï¼Œç»§ç»­å€ŸåŠ©<code>IDEA</code>çš„å¿«æ·é”®<code>Ctrl+Alt+H</code>æŸ¥çœ‹<code>init()</code>æ–¹æ³•çš„è°ƒç”¨å¤„ï¼Œå‘ç°æ˜¯åœ¨<code>XxlJobAdminConfig.afterPropertiesSet()</code>æ–¹æ³•ä¸­è¢«è°ƒç”¨çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/sunchaser-lilu/sunchaser-cdn@master/images/xxl-job/XxlJobAdminConfig.afterPropertiesSet.png" alt="XxlJobAdminConfig.afterPropertiesSet"></p><p><code>XxlJobAdminConfig</code>ç±»ä½¿ç”¨<code>@Component</code>æ³¨è§£äº¤ç”±<code>Spring</code>è¿›è¡Œç®¡ç†ï¼Œå¹¶å®ç°äº†<code>InitializingBean</code>å’Œ<code>DisposableBean</code>è¿™ä¸¤ä¸ªæ¥å£ï¼Œé‡å†™çš„<code>afterPropertiesSet()</code>æ–¹æ³•ä¸­åªæœ‰ç®€å•çš„ä¸‰è¡Œä»£ç ï¼Œç¬¬äºŒè¡Œä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»ºäº†<code>XxlJobScheduler</code>å¯¹è±¡èµ‹ç»™ç§æœ‰æˆå‘˜å˜é‡<code>xxlJobScheduler</code>ï¼Œéšåç¬¬ä¸‰è¡Œè°ƒç”¨äº†å…¶<code>init()</code>æ–¹æ³•ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†å¯åŠ¨çš„èµ·ç‚¹ï¼Œä¸å¦¨å…ˆæ¥åˆ†æä¸€ä¸‹è¿™ä¸ªâ€œèµ·ç‚¹ç±»â€ã€‚</p><p>ä»ç±»åæ¥çœ‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚å…¶ç¬¬ä¸€ä¸ªé™æ€æˆå‘˜å˜é‡<code>adminConfig</code>æ˜¯å®ƒæœ¬èº«ï¼Œå¹¶åœ¨<code>afterPropertiesSet()</code>æ–¹æ³•çš„ç¬¬ä¸€è¡Œå°†<code>this</code>å…³é”®å­—èµ‹ç»™äº†è¯¥å˜é‡ã€‚</p><p>è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿâ€œè‡ªèº«åŒ…å«è‡ªèº«â€å—ï¼Ÿåœ¨è¯¥é™æ€æˆå‘˜å˜é‡ä¸‹è¿˜æä¾›äº†ä¸€ä¸ªé™æ€æ–¹æ³•<code>getAdminConfig()</code>ç”¨æ¥è·å–è¯¥é™æ€æˆå‘˜å˜é‡çš„å¼•ç”¨ã€‚é‚£æˆ‘å¯ä»¥æ— é™é“¾å¼è°ƒç”¨é™æ€æ–¹æ³•<code>getAdminConfig()</code>äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XxlJobAdminConfig.getAdminConfig().getAdminConfig().getAdminConfig().......getAdminConfig();</span><br></pre></td></tr></table></figure><p>åªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¯é€šè¿‡ç±»å.é™æ€æ–¹æ³•åï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨è¿”å›äº†ç±»çš„å®ä¾‹å¯¹è±¡<code>adminConfig</code>ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡ä»¥åŠä¹‹åçš„æ¯æ¬¡é“¾å¼è°ƒç”¨éƒ½æ˜¯é€šè¿‡å®ä¾‹å¯¹è±¡.é™æ€æ–¹æ³•åã€‚è¿™æ˜¯ä¸è¢«å»ºè®®å’Œè®¤å¯çš„ï¼Œç¼–è¯‘å™¨ä¹Ÿå‘å‡ºäº†é»„è‰²è­¦å‘Šã€‚æ‰€ä»¥æ¯æ¬¡ä½¿ç”¨æ—¶å»ºè®®æ˜¯åªè°ƒç”¨ä¸€æ¬¡ï¼Œè°ƒç”¨ä¸€æ¬¡å°±æ‹¿åˆ°äº†<code>XxlJobAdminConfig</code>ç±»çš„å¯¹è±¡ï¼Œå¤šæ¬¡é“¾å¼è°ƒç”¨å¹¶æ— ä»»ä½•ä½œç”¨ã€‚</p><p>å†æ¥çœ‹ä¸€ä¸‹<code>XxlJobAdminConfig</code>ç±»çš„å…¶å®ƒæˆå‘˜å˜é‡ï¼Œå‘ç°æ˜¯ä¸€äº›é€šè¿‡<code>@Value</code>æ³¨è§£è·å–çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œè¿˜æœ‰ä¸€äº›æ˜¯é€šè¿‡<code>@Resource</code>æ³¨è§£æ³¨å…¥çš„<code>XxxxxxDao</code>ç±»å’Œå…¶å®ƒä¸šåŠ¡ç±»ï¼ŒåŒæ—¶æä¾›äº†æ¯ä¸ªæˆå‘˜å˜é‡çš„è®¿é—®å™¨ï¼ˆ<code>getter</code>æ–¹æ³•ï¼‰ã€‚</p><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆåšå‘¢ï¼Ÿä¸ºä»€ä¹ˆè¦å°†è¿™äº›<code>XxxxxxDao</code>ç­‰ç±»æ”¾åˆ°è¿™é‡Œå¹¶æä¾›è®¿é—®å™¨å‘¢ï¼Ÿ</p><p>ç®€å•çŒœæƒ³ï¼šå®é™…ä¸Š<code>XxlJobAdminConfig</code>å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªç®€å•çš„â€œå®¹å™¨â€ï¼Œè°ƒåº¦ä¸­å¿ƒåœ¨å¯åŠ¨æ—¶å°†æ•´ä¸ªç³»ç»Ÿéœ€è¦ç”¨åˆ°çš„é…ç½®ä¿¡æ¯å’Œ<code>XxxxxxDao</code>ç±»å¯¹è±¡åˆå§‹åŒ–åˆ°è¯¥â€œå®¹å™¨â€ä¸­ï¼Œåœ¨éœ€è¦ä½¿ç”¨æŸä¸ª<code>XxxxxxDao</code>ç±»æ—¶ï¼Œä¸ä½¿ç”¨<code>Spring</code>çš„ä¾èµ–æ³¨å…¥ï¼Œè€Œæ˜¯ä»è¯¥â€œå®¹å™¨â€ä¸­æ‹¿ï¼Œè¿˜è®°å¾—å‰é¢åˆ†æè¿‡çš„é™æ€æ–¹æ³•<code>getAdminConfig()</code>ï¼Œå®ƒè¿”å›äº†<code>XxlJobAdminConfig</code>ç±»çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥ä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XxlJobAdminConfig.getAdminConfig().getXxxxxxDao()</span><br></pre></td></tr></table></figure><p>è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ</p><p>çŒœæƒ³ï¼šè¿™æ ·åšå¯¹ç³»ç»Ÿçš„é…ç½®ä¿¡æ¯å’Œä¾èµ–ä¿¡æ¯è¿›è¡Œäº†ç»Ÿä¸€ç®¡ç†ï¼Œæœ‰ä¸€ç§å…¨å±€é…ç½®æ„Ÿã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ç¯‡æ–‡ç« ä¸»è¦åˆ†æäº†è°ƒåº¦ä¸­å¿ƒé¡¹ç›®<code>xxl-job-admin</code>çš„å¯åŠ¨æµç¨‹ã€‚å‘ç°ä¸»è¦æ‰§è¡Œäº†<code>XxlJobScheduler.init()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ‰å…­ä¸ªåˆå§‹åŒ–åŠ¨ä½œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¼šé€ä¸ªè¿›è¡Œåˆ†æã€‚</p><ul><li><a href="/2020/02/27/middleware/xxl-job/initI18n/">åˆå§‹åŒ–å›½é™…åŒ–ç»„ä»¶</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ä¸­é—´ä»¶ </category>
          
          <category> å®šæ—¶ä»»åŠ¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxl-job </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ›å»ºmysql5.7çš„Dockerå®¹å™¨</title>
      <link href="2020/02/19/ops/docker/create-mysql-container/"/>
      <url>2020/02/19/ops/docker/create-mysql-container/</url>
      
        <content type="html"><![CDATA[<h2 id="æ‹‰å–é•œåƒ"><a href="#æ‹‰å–é•œåƒ" class="headerlink" title="æ‹‰å–é•œåƒ"></a>æ‹‰å–é•œåƒ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:5.7</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºæŒ‚è½½ç›®å½•"><a href="#åˆ›å»ºæŒ‚è½½ç›®å½•" class="headerlink" title="åˆ›å»ºæŒ‚è½½ç›®å½•"></a>åˆ›å»ºæŒ‚è½½ç›®å½•</h2><p>å¦‚æœä¸åˆ›å»ºæŒ‚è½½ç›®å½•ï¼Œä¸€æ—¦å®¹å™¨é‡å¯ï¼Œåˆ™æ•°æ®ä¼šå…¨éƒ¨ä¸¢å¤±ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p &#x2F;usr&#x2F;local&#x2F;software&#x2F;mysql&#x2F;data &#x2F;usr&#x2F;local&#x2F;software&#x2F;mysql&#x2F;logs &#x2F;usr&#x2F;local&#x2F;software&#x2F;mysql&#x2F;conf</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºmysqlé…ç½®æ–‡ä»¶"><a href="#åˆ›å»ºmysqlé…ç½®æ–‡ä»¶" class="headerlink" title="åˆ›å»ºmysqlé…ç½®æ–‡ä»¶"></a>åˆ›å»º<code>mysql</code>é…ç½®æ–‡ä»¶</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;local&#x2F;software&#x2F;mysql</span><br><span class="line">touch my.cnf</span><br><span class="line">vim my.cnf</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">user&#x3D;mysql</span><br><span class="line">character-set-server&#x3D;utf8</span><br><span class="line">default_authentication_plugin&#x3D;mysql_native_password</span><br><span class="line">secure_file_priv&#x3D;&#x2F;var&#x2F;lib&#x2F;mysql</span><br><span class="line">expire_logs_days&#x3D;7</span><br><span class="line">sql_mode&#x3D;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</span><br><span class="line">max_connections&#x3D;1000</span><br><span class="line"> </span><br><span class="line">[client]</span><br><span class="line">default-character-set&#x3D;utf8</span><br><span class="line"> </span><br><span class="line">[mysql]</span><br><span class="line">default-character-set&#x3D;utf8</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºå®¹å™¨"><a href="#åˆ›å»ºå®¹å™¨" class="headerlink" title="åˆ›å»ºå®¹å™¨"></a>åˆ›å»ºå®¹å™¨</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --restart&#x3D;always -p 3306:3306 --name mysql5.7 -v &#x2F;usr&#x2F;local&#x2F;software&#x2F;mysql&#x2F;conf:&#x2F;etc&#x2F;mysql -v &#x2F;usr&#x2F;local&#x2F;software&#x2F;mysql&#x2F;logs:&#x2F;var&#x2F;log&#x2F;mysql -v &#x2F;usr&#x2F;local&#x2F;software&#x2F;mysql&#x2F;data:&#x2F;var&#x2F;lib&#x2F;mysql -v &#x2F;usr&#x2F;local&#x2F;software&#x2F;mysql&#x2F;my.cnf:&#x2F;etc&#x2F;mysql&#x2F;my.cnf -e MYSQL_ROOT_PASSWORD&#x3D;123456 -d mysql:5.7</span><br></pre></td></tr></table></figure><ul><li><code>--restart=always</code>ï¼šå½“dockeré‡å¯æ—¶ï¼Œå®¹å™¨ä¹Ÿé‡å¯ã€‚</li><li><code>--name</code>ï¼šå®¹å™¨åç§°ã€‚</li><li><code>-p 3306:3306</code>ï¼šå®¿ä¸»æœºï¼šå®¹å™¨ç«¯å£æ˜ å°„ã€‚</li><li><code>-v source:target</code>ï¼šç›®å½•æŒ‚è½½ã€‚</li><li><code>-e</code>ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆ<code>mysql</code>å¯†ç ï¼‰ã€‚</li><li><code>-d</code>ï¼šåå°å¯åŠ¨ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> è¿ç»´ </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dockerå¸¸ç”¨å‘½ä»¤</title>
      <link href="2020/02/19/ops/docker/docker-common-commands/"/>
      <url>2020/02/19/ops/docker/docker-common-commands/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p><code>yum install -y yum-utils device-mapper-persistent-data lvm2</code></p><p><code>yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</code></p><p><code>yum install docker-ce docker-ce-cli containerd.io</code></p><h2 id="è®¾ä¸ºå¼€æœºå¯åŠ¨"><a href="#è®¾ä¸ºå¼€æœºå¯åŠ¨" class="headerlink" title="è®¾ä¸ºå¼€æœºå¯åŠ¨"></a>è®¾ä¸ºå¼€æœºå¯åŠ¨</h2><p><code>systemctl enable docker</code></p><p>éå¸¸é‡è¦ï¼ï¼ï¼å¦åˆ™å¯èƒ½é‡å¯æœºå™¨åå†æ¬¡å¯åŠ¨<code>docker</code>æ—¶ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Failed to start docker: Unit docker is masked.</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹è¿è¡ŒçŠ¶æ€"><a href="#æŸ¥çœ‹è¿è¡ŒçŠ¶æ€" class="headerlink" title="æŸ¥çœ‹è¿è¡ŒçŠ¶æ€"></a>æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</h2><p><code>systemctl status docker</code></p><h2 id="åœæ­¢"><a href="#åœæ­¢" class="headerlink" title="åœæ­¢"></a>åœæ­¢</h2><p><code>systemctl stop docker</code></p><h2 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h2><p><code>systemctl start docker</code></p><h2 id="é‡å¯"><a href="#é‡å¯" class="headerlink" title="é‡å¯"></a>é‡å¯</h2><p><code>systemctl restart docker</code></p><h2 id="æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯"><a href="#æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯"></a>æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</h2><p><code>docker version</code></p><h2 id="æŸ¥çœ‹å‘½ä»¤å¸®åŠ©"><a href="#æŸ¥çœ‹å‘½ä»¤å¸®åŠ©" class="headerlink" title="æŸ¥çœ‹å‘½ä»¤å¸®åŠ©"></a>æŸ¥çœ‹å‘½ä»¤å¸®åŠ©</h2><p><code>docker --help</code></p><h2 id="åˆ—å‡ºé•œåƒ"><a href="#åˆ—å‡ºé•œåƒ" class="headerlink" title="åˆ—å‡ºé•œåƒ"></a>åˆ—å‡ºé•œåƒ</h2><p><code>docker images</code></p><h2 id="æ‹‰å–é•œåƒ"><a href="#æ‹‰å–é•œåƒ" class="headerlink" title="æ‹‰å–é•œåƒ"></a>æ‹‰å–é•œåƒ</h2><p><code>docker pull [OPTIONS] NAME[:tag]</code></p><h2 id="é…ç½®é•œåƒåŠ é€Ÿå™¨"><a href="#é…ç½®é•œåƒåŠ é€Ÿå™¨" class="headerlink" title="é…ç½®é•œåƒåŠ é€Ÿå™¨"></a>é…ç½®é•œåƒåŠ é€Ÿå™¨</h2><p>å‚è€ƒ <a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">é˜¿é‡Œäº‘å®¹å™¨é•œåƒåŠ é€Ÿå™¨æœåŠ¡</a></p><h2 id="æŸ¥æ‰¾é•œåƒ"><a href="#æŸ¥æ‰¾é•œåƒ" class="headerlink" title="æŸ¥æ‰¾é•œåƒ"></a>æŸ¥æ‰¾é•œåƒ</h2><p><code>docker search NAME</code></p><h2 id="åˆ é™¤é•œåƒ"><a href="#åˆ é™¤é•œåƒ" class="headerlink" title="åˆ é™¤é•œåƒ"></a>åˆ é™¤é•œåƒ</h2><p><code>docker rmi NAME1/ID1 NAME2/ID2</code></p><h2 id="æŸ¥çœ‹å®¹å™¨"><a href="#æŸ¥çœ‹å®¹å™¨" class="headerlink" title="æŸ¥çœ‹å®¹å™¨"></a>æŸ¥çœ‹å®¹å™¨</h2><ul><li>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š<code>docker ps</code></li><li>æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼š<code>docker ps -a</code></li><li>æŸ¥çœ‹æœ€åä¸€æ¬¡è¿è¡Œçš„å®¹å™¨ï¼š<code>docker ps -l</code></li></ul><h2 id="é€€å‡ºå®¹å™¨"><a href="#é€€å‡ºå®¹å™¨" class="headerlink" title="é€€å‡ºå®¹å™¨"></a>é€€å‡ºå®¹å™¨</h2><p><code>exit</code></p><h2 id="åˆ›å»ºäº¤äº’å¼å®¹å™¨"><a href="#åˆ›å»ºäº¤äº’å¼å®¹å™¨" class="headerlink" title="åˆ›å»ºäº¤äº’å¼å®¹å™¨"></a>åˆ›å»ºäº¤äº’å¼å®¹å™¨</h2><p><code>docker run -i -t --name=[NAME] IMAGE /bin/bash</code></p><ul><li><code>-i</code>ï¼šäº¤äº’å¼æ“ä½œ</li><li><code>-t</code>ï¼šåˆ†é…ä¸€ä¸ªå¯æ“ä½œå®¹å™¨çš„ç»ˆç«¯</li><li><code>--name=[NAME]</code>ï¼šæŒ‡å®šå®¹å™¨åç§°ï¼ˆå”¯ä¸€ï¼‰</li></ul><p>å¯é€‰å‚æ•°å¯åˆå¹¶ï¼š<br><code>docker run -it --name [NAME] IMAGE /bin/bash</code></p><p>äº¤äº’å¼å®¹å™¨<code>exit</code>é€€å‡ºåå®¹å™¨è‡ªåŠ¨å…³é—­ã€‚</p><h2 id="åˆ›å»ºå®ˆæŠ¤å¼å®¹å™¨"><a href="#åˆ›å»ºå®ˆæŠ¤å¼å®¹å™¨" class="headerlink" title="åˆ›å»ºå®ˆæŠ¤å¼å®¹å™¨"></a>åˆ›å»ºå®ˆæŠ¤å¼å®¹å™¨</h2><p><code>docker run -itd --name NAME IMAGE /bin/bash</code></p><p><code>-d</code>ï¼šæŒ‡å®šå®¹å™¨è¿è¡Œæ¨¡å¼</p><h2 id="è¿›å…¥å®ˆæŠ¤å¼å®¹å™¨"><a href="#è¿›å…¥å®ˆæŠ¤å¼å®¹å™¨" class="headerlink" title="è¿›å…¥å®ˆæŠ¤å¼å®¹å™¨"></a>è¿›å…¥å®ˆæŠ¤å¼å®¹å™¨</h2><p><code>docker exec -it [CONTAINER ID] /bin/bash</code></p><p>å®ˆæŠ¤å¼å®¹å™¨<code>exit</code>é€€å‡ºåå®¹å™¨ç»§ç»­è¿è¡Œã€‚</p><h2 id="å¯åŠ¨å·²åœæ­¢è¿è¡Œçš„å®¹å™¨"><a href="#å¯åŠ¨å·²åœæ­¢è¿è¡Œçš„å®¹å™¨" class="headerlink" title="å¯åŠ¨å·²åœæ­¢è¿è¡Œçš„å®¹å™¨"></a>å¯åŠ¨å·²åœæ­¢è¿è¡Œçš„å®¹å™¨</h2><p><code>docker start [CONTAINER ID]</code></p><h2 id="åœæ­¢å®¹å™¨"><a href="#åœæ­¢å®¹å™¨" class="headerlink" title="åœæ­¢å®¹å™¨"></a>åœæ­¢å®¹å™¨</h2><p><code>docker stop [CONTAINER ID]</code></p><h2 id="é‡å¯å®¹å™¨"><a href="#é‡å¯å®¹å™¨" class="headerlink" title="é‡å¯å®¹å™¨"></a>é‡å¯å®¹å™¨</h2><p><code>docker restart [CONTAINER ID]</code></p><h2 id="åˆ é™¤å®¹å™¨"><a href="#åˆ é™¤å®¹å™¨" class="headerlink" title="åˆ é™¤å®¹å™¨"></a>åˆ é™¤å®¹å™¨</h2><p><code>docker rm -f [CONTAINER ID]</code></p><p>åˆ é™¤æ—¶å®¹å™¨å¿…é¡»æ˜¯åœæ­¢çŠ¶æ€ã€‚</p><p>åˆ é™¤å…¨éƒ¨å®¹å™¨ï¼ˆå…ˆæŸ¥è¯¢å‡ºæ‰€æœ‰å®¹å™¨å†åˆ é™¤ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm &#96;docker ps -a -q&#96;</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯"><a href="#æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯"></a>æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</h2><p><code>docker inspect [CONTAINER NAME]</code></p><h2 id="æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯ä¸­æŸä¸ªå±æ€§çš„è¯¦ç»†ä¿¡æ¯"><a href="#æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯ä¸­æŸä¸ªå±æ€§çš„è¯¦ç»†ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯ä¸­æŸä¸ªå±æ€§çš„è¯¦ç»†ä¿¡æ¯"></a>æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯ä¸­æŸä¸ªå±æ€§çš„è¯¦ç»†ä¿¡æ¯</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#96;docker inspect -f&#x3D;&#39;&#123;&#123;.[å±æ€§å]&#125;&#125;&#39; [CONTAINER NAME]&#96;</span><br><span class="line"></span><br><span class="line">æˆ–</span><br><span class="line"></span><br><span class="line">&#96;docker inspect --format&#x3D;&#39;&#123;&#123;.[å±æ€§å]&#125;&#125;&#39; [CONTAINER NAME]&#96;</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶æ‹·è´"><a href="#æ–‡ä»¶æ‹·è´" class="headerlink" title="æ–‡ä»¶æ‹·è´"></a>æ–‡ä»¶æ‹·è´</h2><p><code>docker cp source target</code></p><p>å¯å°†å®¿ä¸»æœºçš„æ–‡ä»¶/ç›®å½•æ‹·è´è‡³å®¹å™¨æˆ–å°†å®¹å™¨å†…çš„æ–‡ä»¶/ç›®å½•æ‹·è´è‡³å®¿ä¸»æœºã€‚</p><p><code>example</code>ï¼š</p><p>ä»å®¿ä¸»æœºï¼ˆsourceï¼‰æ‹·è´è‡³å®¹å™¨å†…ï¼ˆtargetï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp .&#x2F;1.txt container1:&#x2F;root</span><br></pre></td></tr></table></figure><p>ä»å®¹å™¨å†…ï¼ˆsourceï¼‰æ‹·è´è‡³å®¿ä¸»æœºï¼ˆtargetï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp container1:&#x2F;root .&#x2F;1.txt</span><br></pre></td></tr></table></figure><h2 id="ç«¯å£æ˜ å°„"><a href="#ç«¯å£æ˜ å°„" class="headerlink" title="ç«¯å£æ˜ å°„"></a>ç«¯å£æ˜ å°„</h2><p>åˆ›å»ºå®¹å™¨æ—¶æŒ‡å®š<code>-p</code>å‚æ•°å°†å®¹å™¨å†…ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç«¯å£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name&#x3D;NAME -p å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ IMAGE &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><h2 id="ç›®å½•æŒ‚è½½"><a href="#ç›®å½•æŒ‚è½½" class="headerlink" title="ç›®å½•æŒ‚è½½"></a>ç›®å½•æŒ‚è½½</h2><p>åˆ›å»ºå®¹å™¨æ—¶æŒ‡å®š<code>-v</code>å‚æ•°è¿›è¡Œç›®å½•æŒ‚è½½ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name&#x3D;NAME -v å®¿ä¸»æœºç›®å½•:å®¹å™¨ç›®å½• IMAGE &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><h2 id="é•œåƒæ‰“åŒ…"><a href="#é•œåƒæ‰“åŒ…" class="headerlink" title="é•œåƒæ‰“åŒ…"></a>é•œåƒæ‰“åŒ…</h2><p><code>docker save -o [dir/NAME.tar] IMAGE_NAME</code></p><h2 id="å°†æ‰“åŒ…çš„é•œåƒä¸Šä¼ è‡³å…¶å®ƒæœåŠ¡å™¨"><a href="#å°†æ‰“åŒ…çš„é•œåƒä¸Šä¼ è‡³å…¶å®ƒæœåŠ¡å™¨" class="headerlink" title="å°†æ‰“åŒ…çš„é•œåƒä¸Šä¼ è‡³å…¶å®ƒæœåŠ¡å™¨"></a>å°†æ‰“åŒ…çš„é•œåƒä¸Šä¼ è‡³å…¶å®ƒæœåŠ¡å™¨</h2><p><code>scp ./NAME.tar ip:/root/dir</code></p><h2 id="å¯¼å…¥æ‰“åŒ…é•œåƒ"><a href="#å¯¼å…¥æ‰“åŒ…é•œåƒ" class="headerlink" title="å¯¼å…¥æ‰“åŒ…é•œåƒ"></a>å¯¼å…¥æ‰“åŒ…é•œåƒ</h2><p><code>docker load -i /root/dir/NAME.tar</code></p><h2 id="å®¹å™¨æ‰“åŒ…"><a href="#å®¹å™¨æ‰“åŒ…" class="headerlink" title="å®¹å™¨æ‰“åŒ…"></a>å®¹å™¨æ‰“åŒ…</h2><p><code>docker export -o /root/CONTAINER_NAME.tar CONTAINER_NAME</code></p><h2 id="å¯¼å…¥æ‰“åŒ…å®¹å™¨"><a href="#å¯¼å…¥æ‰“åŒ…å®¹å™¨" class="headerlink" title="å¯¼å…¥æ‰“åŒ…å®¹å™¨"></a>å¯¼å…¥æ‰“åŒ…å®¹å™¨</h2><p><code>docker import CONTAINER_NAME.tar CONTAINER_NAME</code></p>]]></content>
      
      
      <categories>
          
          <category> è¿ç»´ </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®ç‚¼xxl-jobä¹‹æ­å»ºæœ¬åœ°è°ƒåº¦å¹³å°</title>
      <link href="2020/02/13/middleware/xxl-job/build-local-dispatch-platform/"/>
      <url>2020/02/13/middleware/xxl-job/build-local-dispatch-platform/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h2><p><code>xxl-job</code>ç›®å‰æœ€æ–°<code>master</code>åˆ†æ”¯çš„ä»£ç ä¸º<code>v2.2.0</code>ï¼Œå®˜ç½‘æ˜¾ç¤ºä»åœ¨è¿­ä»£ä¸­ï¼ˆè¯¥ç‰ˆæœ¬ç›®å‰å‘å¸ƒçš„æ›´æ–°å†…å®¹ä¸»è¦æ˜¯è°ƒåº¦ä¸­å¿ƒå‡çº§<code>SpringBoot</code>ç‰ˆæœ¬ä¸º<code>2.x</code>ï¼‰ï¼Œæ‰€ä»¥æœ¬æ¬¡ä¿®ç‚¼æˆ‘ä»¬é‡‡ç”¨æœ€è¿‘ç¨³å®šç‰ˆ<code>v2.1.2</code>ï¼Œå‘å¸ƒæ—¥æœŸä¸º<code>2019-12-12</code>ã€‚</p><p>æºç åœ°å€ï¼š<a href="https://github.com/xuxueli/xxl-job">GitHub</a>/<a href="https://gitee.com/xuxueli0323/xxl-job">Gitee</a></p><h2 id="å·¥ç¨‹ç®€ä»‹"><a href="#å·¥ç¨‹ç®€ä»‹" class="headerlink" title="å·¥ç¨‹ç®€ä»‹"></a>å·¥ç¨‹ç®€ä»‹</h2><p>æºç ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">xxl-job-adminï¼šè°ƒåº¦ä¸­å¿ƒ</span><br><span class="line">xxl-job-coreï¼šå…¬å…±ä¾èµ–</span><br><span class="line">xxl-job-executor-samplesï¼šæ‰§è¡Œå™¨Sampleç¤ºä¾‹ï¼ˆé€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬æ‰§è¡Œå™¨ï¼Œå¯ç›´æ¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å‚è€ƒå…¶å¹¶å°†ç°æœ‰é¡¹ç›®æ”¹é€ æˆæ‰§è¡Œå™¨ï¼‰</span><br><span class="line">    ï¼šxxl-job-executor-sample-springbootï¼šSpringbootç‰ˆæœ¬ï¼Œé€šè¿‡Springbootç®¡ç†æ‰§è¡Œå™¨ï¼Œæ¨èè¿™ç§æ–¹å¼ï¼›</span><br><span class="line">    ï¼šxxl-job-executor-sample-springï¼šSpringç‰ˆæœ¬ï¼Œé€šè¿‡Springå®¹å™¨ç®¡ç†æ‰§è¡Œå™¨ï¼Œæ¯”è¾ƒé€šç”¨ï¼›</span><br><span class="line">    ï¼šxxl-job-executor-sample-framelessï¼šæ— æ¡†æ¶ç‰ˆæœ¬ï¼›</span><br><span class="line">    ï¼šxxl-job-executor-sample-jfinalï¼šJFinalç‰ˆæœ¬ï¼Œé€šè¿‡JFinalç®¡ç†æ‰§è¡Œå™¨ï¼›</span><br><span class="line">    ï¼šxxl-job-executor-sample-nutzï¼šNutzç‰ˆæœ¬ï¼Œé€šè¿‡Nutzç®¡ç†æ‰§è¡Œå™¨ï¼›</span><br><span class="line">    ï¼šxxl-job-executor-sample-jbootï¼šjbootç‰ˆæœ¬ï¼Œé€šè¿‡jbootç®¡ç†æ‰§è¡Œå™¨ï¼›</span><br></pre></td></tr></table></figure><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p>åŸºç¡€ç¯å¢ƒï¼š</p><ul><li><code>Maven3+</code></li><li><code>JDK7+</code></li><li><code>MySQL5.7+</code></li></ul><h3 id="æ­å»ºè°ƒåº¦ä¸­å¿ƒ"><a href="#æ­å»ºè°ƒåº¦ä¸­å¿ƒ" class="headerlink" title="æ­å»ºè°ƒåº¦ä¸­å¿ƒ"></a>æ­å»ºè°ƒåº¦ä¸­å¿ƒ</h3><p>è°ƒåº¦ä¸­å¿ƒé¡¹ç›®ï¼š<code>xxl-job-admin</code>ã€‚</p><p>ä½œç”¨ï¼šç»Ÿä¸€ç®¡ç†ä»»åŠ¡è°ƒåº¦å¹³å°ä¸Šè°ƒåº¦ä»»åŠ¡ï¼Œè´Ÿè´£è§¦å‘è°ƒåº¦æ‰§è¡Œï¼Œå¹¶ä¸”æä¾›ä»»åŠ¡ç®¡ç†å¹³å°ã€‚</p><h4 id="åˆå§‹åŒ–â€œè°ƒåº¦æ•°æ®åº“â€"><a href="#åˆå§‹åŒ–â€œè°ƒåº¦æ•°æ®åº“â€" class="headerlink" title="åˆå§‹åŒ–â€œè°ƒåº¦æ•°æ®åº“â€"></a>åˆå§‹åŒ–â€œè°ƒåº¦æ•°æ®åº“â€</h4><p>æºç ä¸‹è½½åè·å–åˆå§‹åŒ–æ•°æ®åº“<code>SQL</code>è„šæœ¬å¹¶åœ¨<code>MySQL</code>ä¸­æ‰§è¡Œã€‚</p><p>è°ƒåº¦æ•°æ®åº“åˆå§‹åŒ–<code>SQL</code>è„šæœ¬åœ°å€ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;xxl-job&#x2F;doc&#x2F;db&#x2F;tables_xxl_job.sql</span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹è°ƒåº¦ä¸­å¿ƒé…ç½®"><a href="#ä¿®æ”¹è°ƒåº¦ä¸­å¿ƒé…ç½®" class="headerlink" title="ä¿®æ”¹è°ƒåº¦ä¸­å¿ƒé…ç½®"></a>ä¿®æ”¹è°ƒåº¦ä¸­å¿ƒé…ç½®</h4><p>å°†æ•´ä¸ªé¡¹ç›®å·¥ç¨‹å¯¼å…¥<code>IDEA</code>ä¸­ï¼Œç­‰å¾…<code>maven</code>ä¾èµ–ä¸‹è½½å®Œæ¯•ï¼Œä¿®æ”¹è°ƒåº¦ä¸­å¿ƒé…ç½®ã€‚</p><p>è°ƒåº¦ä¸­å¿ƒé…ç½®æ–‡ä»¶åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;xxl-job&#x2F;xxl-job-admin&#x2F;src&#x2F;main&#x2F;resources&#x2F;application.properties</span><br></pre></td></tr></table></figure><p>éœ€è¦ä¿®æ”¹çš„é…ç½®é¡¹æœ‰ä»¥ä¸‹ä¸‰ä¸ªï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string"></span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string"></span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string"></span></span><br></pre></td></tr></table></figure><p>å°†æ•°æ®æºä¿¡æ¯ä¿®æ”¹ä¸ºä¸Šä¸€æ­¥ä¸­å¯¼å…¥è„šæœ¬çš„æ•°æ®åº“ä¿¡æ¯ã€‚</p><h4 id="å¯åŠ¨è°ƒåº¦ä¸­å¿ƒ"><a href="#å¯åŠ¨è°ƒåº¦ä¸­å¿ƒ" class="headerlink" title="å¯åŠ¨è°ƒåº¦ä¸­å¿ƒ"></a>å¯åŠ¨è°ƒåº¦ä¸­å¿ƒ</h4><p>åœ¨<code>IDEA</code>ä¸­è¿è¡Œ<code>com.xxl.job.admin.XxlJobAdminApplication#main</code>æ–¹æ³•ï¼Œå¯åŠ¨è°ƒåº¦ä¸­å¿ƒã€‚</p><p>å¦‚æœä¸€åˆ‡é…ç½®æ­£å¸¸ï¼Œå¯åœ¨æ§åˆ¶å°çœ‹åˆ°ä»¥ä¸‹ä¸‰è¡Œå…³é”®æ—¥å¿—ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">13:01:37.678 logback [main] INFO  o.s.b.c.e.t.TomcatEmbeddedServletContainer - Tomcat started on port(s): 8080 (http)</span><br><span class="line">13:01:37.690 logback [main] INFO  c.x.job.admin.XxlJobAdminApplication - Started XxlJobAdminApplication in 6.976 seconds (JVM running for 8.944)</span><br><span class="line">13:01:40.001 logback [xxl-job, admin JobScheduleHelper#scheduleThread] INFO  c.x.j.a.c.thread.JobScheduleHelper - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin scheduler success.</span><br></pre></td></tr></table></figure><p><code>Tomcat</code>å®¹å™¨ç›‘å¬<code>8080</code>ç«¯å£å¯åŠ¨ï¼›</p><p><code>JVM</code>å¯åŠ¨ï¼›</p><p><code>JobScheduleHelper</code>è¿™ä¸ªç±»æ‰“å°äº†<code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; init xxl-job admin scheduler success.</code>è¿™å¥è¯ã€‚</p><h4 id="è®¿é—®è°ƒåº¦ä¸­å¿ƒåœ°å€"><a href="#è®¿é—®è°ƒåº¦ä¸­å¿ƒåœ°å€" class="headerlink" title="è®¿é—®è°ƒåº¦ä¸­å¿ƒåœ°å€"></a>è®¿é—®è°ƒåº¦ä¸­å¿ƒåœ°å€</h4><p>å¦‚å·²æ­£ç¡®è¿›è¡Œå‰è¿°æ­¥éª¤ï¼Œåˆ™å¯è®¿é—®è°ƒåº¦ä¸­å¿ƒã€‚</p><p>è°ƒåº¦ä¸­å¿ƒè®¿é—®åœ°å€ï¼š<code>http://localhost:8080/xxl-job-admin</code></p><p>è¯¥åœ°å€æ‰§è¡Œå™¨å°†ä¼šä½¿ç”¨åˆ°ï¼Œä½œä¸ºå›è°ƒåœ°å€ã€‚</p><p>é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç ä¸º<code>admin/123456</code>ã€‚ç™»å½•æˆåŠŸåå¯çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š</p><p><img src="https://i.loli.net/2020/02/15/oZum5VbtTvH1SeY.png" alt="xxl-job-index.png"></p><p>è‡³æ­¤è°ƒåº¦ä¸­å¿ƒæ­å»ºå®Œæ¯•ã€‚</p><h3 id="æ­å»ºæ‰§è¡Œå™¨"><a href="#æ­å»ºæ‰§è¡Œå™¨" class="headerlink" title="æ­å»ºæ‰§è¡Œå™¨"></a>æ­å»ºæ‰§è¡Œå™¨</h3><p>â€œæ‰§è¡Œå™¨â€ç¤ºä¾‹é¡¹ç›®ï¼š<code>xxl-job-executor-sample</code>ï¼Œè¯¥æ¨¡å—ä¸‹åŒ…å«å¤šä¸ªç‰ˆæœ¬çš„æ‰§è¡Œå™¨ç¤ºä¾‹ï¼Œæˆ‘ä»¬é€‰ç”¨<code>xxl-job-executor-sample-springboot</code>ç‰ˆæœ¬ã€‚</p><p>ä½œç”¨ï¼šè´Ÿè´£æ¥æ”¶â€œè°ƒåº¦ä¸­å¿ƒâ€çš„è°ƒåº¦å¹¶æ‰§è¡Œï¼›å¯ç›´æ¥éƒ¨ç½²æ‰§è¡Œå™¨é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥å°†æ‰§è¡Œå™¨é›†æˆåˆ°ç°æœ‰ä¸šåŠ¡é¡¹ç›®ä¸­ã€‚</p><h4 id="å¯åŠ¨æ‰§è¡Œå™¨"><a href="#å¯åŠ¨æ‰§è¡Œå™¨" class="headerlink" title="å¯åŠ¨æ‰§è¡Œå™¨"></a>å¯åŠ¨æ‰§è¡Œå™¨</h4><p>åœ¨<code>IDEA</code>ä¸­è¿è¡Œ<code>com.xxl.job.executor.XxlJobExecutorApplication#main</code>æ–¹æ³•ï¼Œå¯åŠ¨ç¤ºä¾‹æ‰§è¡Œå™¨ã€‚</p><p>å¦‚æœä¸€åˆ‡è¿è¡Œæ­£å¸¸ï¼Œå¯åœ¨æ§åˆ¶å°çœ‹åˆ°ä»¥ä¸‹å…³é”®æ—¥å¿—ä¿¡æ¯ï¼ˆè¿™å°†ä½œä¸ºæˆ‘ä»¬åç»­è§£ææºç çš„æ€è·¯ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line">16:47:51.370 logback [main] INFO  c.x.j.e.core.config.XxlJobConfig - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.</span><br><span class="line">16:47:51.425 logback [main] INFO  c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:httpJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@1c32886a[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#httpJobHandler]</span><br><span class="line">16:47:51.426 logback [main] INFO  c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:demoJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@3a4b0e5d[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#demoJobHandler]</span><br><span class="line">16:47:51.426 logback [main] INFO  c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:demoJobHandler2, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@10b892d5[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#demoJobHandler2]</span><br><span class="line">16:47:51.427 logback [main] INFO  c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:commandJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@3d3f761a[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#commandJobHandler]</span><br><span class="line">16:47:51.427 logback [main] INFO  c.x.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job register jobhandler success, name:shardingJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@3546d80f[class com.xxl.job.executor.service.jobhandler.SampleXxlJob#shardingJobHandler]</span><br><span class="line">......</span><br><span class="line">16:47:52.172 logback [main] INFO  c.x.r.r.p.XxlRpcProviderFactory - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-rpc, provider factory add service success. serviceKey &#x3D; com.xxl.job.core.biz.ExecutorBiz, serviceBean &#x3D; class com.xxl.job.core.biz.impl.ExecutorBizImpl</span><br><span class="line">......</span><br><span class="line">16:48:02.189 logback [Thread-10] INFO  com.xxl.rpc.remoting.net.Server - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-rpc remoting server start success, nettype &#x3D; com.xxl.rpc.remoting.net.impl.netty_http.server.NettyHttpServer, port &#x3D; 9999</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸåï¼Œç‚¹å‡»ä»»åŠ¡è°ƒåº¦ä¸­å¿ƒåå°å¯¼èˆª-æ‰§è¡Œå™¨ç®¡ç†èœå•ï¼Œå¯çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<code>OnLine</code>æœºå™¨åœ°å€ä¸­å·²æ˜¾ç¤ºæˆ‘ä»¬è¿è¡Œçš„æ‰§è¡Œå™¨åœ°å€ã€‚</p><p><img src="https://i.loli.net/2020/02/15/2iUXThLzZHMkP9w.png" alt="xxl-job-executor-online.png"></p><p>ç‚¹å‡»ä»»åŠ¡ç®¡ç†èœå•å¯çœ‹åˆ°ç¤ºä¾‹æ‰§è¡Œå™¨çš„æµ‹è¯•ä»»åŠ¡1ï¼›</p><p><img src="https://i.loli.net/2020/02/15/DjYCsoTmGf3zknV.png" alt="xxl-job-demo-executor.png"></p><p>ç‚¹å‡»å³ä¾§[æ“ä½œ]-&gt;[æ‰§è¡Œä¸€æ¬¡]ï¼Œå¼¹å‡ºçš„æ¨¡æ€æ¡†ä¸­æ— éœ€è¾“å…¥ä»»åŠ¡å‚æ•°ï¼Œç›´æ¥ç‚¹å‡»[ä¿å­˜]å³å¯æ‰§è¡Œä»»åŠ¡ï¼›</p><p><img src="https://i.loli.net/2020/02/15/tq754auXjG1NP3f.png" alt="xxl-job-executor-one-times.png"></p><p>ç‚¹å‡»[æŸ¥è¯¢æ—¥å¿—]ï¼Œå¯è¿›å…¥è°ƒåº¦æ—¥å¿—åˆ—è¡¨é¡µï¼Œç‚¹å‡»å³ä¾§[æ‰§è¡Œæ—¥å¿—]ï¼Œå¯çœ‹åˆ°ä»»åŠ¡åœ¨æ‰§è¡Œå™¨ä¸€ä¾§è¿è¡Œè¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯ã€‚</p><p><img src="https://i.loli.net/2020/02/15/3WUBxcaE8YZMG6i.png" alt="xxl-job-executor-log.png"></p><p><img src="https://i.loli.net/2020/02/15/nVaF4GzW2LsUYxC.jpg" alt="xxl-job-executor-log-page.png"></p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ä»»åŠ¡çš„è°ƒåº¦å’Œæ‰§è¡Œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ä¸­é—´ä»¶ </category>
          
          <category> å®šæ—¶ä»»åŠ¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxl-job </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®ç‚¼xxl-jobä¹‹æ‰§è¡Œå™¨é¡¹ç›®ä¸ƒå¤§é…ç½®é¡¹è§£æ</title>
      <link href="2020/02/13/middleware/xxl-job/demo-executor-xxljobconfig-sourcecode-analysis/"/>
      <url>2020/02/13/middleware/xxl-job/demo-executor-xxljobconfig-sourcecode-analysis/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯è§£ææ‰§è¡Œå™¨é¡¹ç›®ä¸ƒå¤§é…ç½®é¡¹ä½œç”¨å’ŒåŸç†ã€‚æˆ‘ä»¬ä»¥ç¤ºä¾‹æ‰§è¡Œå™¨<code>xxl-job-executor-sample-springboot</code>é¡¹ç›®ä¸ºä¾‹ã€‚</p><h2 id="å·¥ç¨‹ç»“æ„ä»‹ç»"><a href="#å·¥ç¨‹ç»“æ„ä»‹ç»" class="headerlink" title="å·¥ç¨‹ç»“æ„ä»‹ç»"></a>å·¥ç¨‹ç»“æ„ä»‹ç»</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€java</span><br><span class="line">â”‚  â””â”€com</span><br><span class="line">â”‚      â””â”€xxl</span><br><span class="line">â”‚          â””â”€job</span><br><span class="line">â”‚              â””â”€executor</span><br><span class="line">â”‚                  â”‚  XxlJobExecutorApplication.java  ------å¯åŠ¨ç±»</span><br><span class="line">â”‚                  â”‚</span><br><span class="line">â”‚                  â”œâ”€core</span><br><span class="line">â”‚                  â”‚  â””â”€config</span><br><span class="line">â”‚                  â”‚          XxlJobConfig.java       ------XxlJobSpringExecutoré…ç½®ç±»</span><br><span class="line">â”‚                  â”‚</span><br><span class="line">â”‚                  â”œâ”€mvc</span><br><span class="line">â”‚                  â”‚  â””â”€controller</span><br><span class="line">â”‚                  â”‚          IndexController.java    ------ç©ºæ–‡ä»¶</span><br><span class="line">â”‚                  â”‚</span><br><span class="line">â”‚                  â””â”€service</span><br><span class="line">â”‚                      â””â”€jobhandler</span><br><span class="line">â”‚                              SampleXxlJob.java      ------ç¤ºä¾‹æ‰§è¡Œå™¨ç±»</span><br><span class="line">â”‚</span><br><span class="line">â””â”€resources</span><br><span class="line">        application.properties                        ------é¡¹ç›®é…ç½®æ–‡ä»¶</span><br><span class="line">        logback.xml                                   ------æ—¥å¿—é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="com-xxl-job-executor-core-config-XxlJobConfigé…ç½®ç±»è§£è¯»"><a href="#com-xxl-job-executor-core-config-XxlJobConfigé…ç½®ç±»è§£è¯»" class="headerlink" title="com.xxl.job.executor.core.config.XxlJobConfigé…ç½®ç±»è§£è¯»"></a><code>com.xxl.job.executor.core.config.XxlJobConfig</code>é…ç½®ç±»è§£è¯»</h2><p>ç”±äºæ˜¯<code>SpringBoot</code>é¡¹ç›®ï¼Œè¯¥ç±»é‡‡ç”¨<code>@Configuration</code>æ³¨è§£æ·»åŠ é…ç½®ã€‚</p><h3 id="æˆå‘˜å˜é‡ç®€ä»‹"><a href="#æˆå‘˜å˜é‡ç®€ä»‹" class="headerlink" title="æˆå‘˜å˜é‡ç®€ä»‹"></a>æˆå‘˜å˜é‡ç®€ä»‹</h3><p>è¯¥é…ç½®ç±»ä¸€å…±åŒ…å«å…«ä¸ªæˆå‘˜å˜é‡ã€‚</p><h4 id="æ—¥å¿—å¯¹è±¡"><a href="#æ—¥å¿—å¯¹è±¡" class="headerlink" title="æ—¥å¿—å¯¹è±¡"></a>æ—¥å¿—å¯¹è±¡</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Logger logger = LoggerFactory.getLogger(XxlJobConfig.class);</span><br></pre></td></tr></table></figure><p><code>slf4j</code>çš„æ—¥å¿—å¯¹è±¡ï¼Œç”¨æ¥æ‰“å°å…³é”®æ—¥å¿—ã€‚</p><h4 id="ä¸ƒå¤§æ ¸å¿ƒå±æ€§å˜é‡"><a href="#ä¸ƒå¤§æ ¸å¿ƒå±æ€§å˜é‡" class="headerlink" title="ä¸ƒå¤§æ ¸å¿ƒå±æ€§å˜é‡"></a>ä¸ƒå¤§æ ¸å¿ƒå±æ€§å˜é‡</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.admin.addresses&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String adminAddresses;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.appname&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String appName;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.ip&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String ip;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.port&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.accessToken&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String accessToken;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.logpath&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String logPath;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.logretentiondays&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> logRetentionDays;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>Spring</code>æä¾›çš„<code>@Value</code>æ³¨è§£æ¥æ³¨å…¥é…ç½®æ–‡ä»¶<code>application.properties</code>ä¸­çš„é…ç½®ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬æ‰“å¼€<code>resources</code>ç›®å½•ä¸‹çš„<code>application.properties</code>æ–‡ä»¶æŸ¥çœ‹ï¼Œé»˜è®¤é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### xxl-job admin address list, such as &quot;http://address&quot; or &quot;http://address01,http://address02&quot;</span></span><br><span class="line"><span class="meta">xxl.job.admin.addresses</span>=<span class="string">http://127.0.0.1:8080/xxl-job-admin</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### xxl-job executor address</span></span><br><span class="line"><span class="meta">xxl.job.executor.appname</span>=<span class="string">xxl-job-executor-sample</span></span><br><span class="line"><span class="meta">xxl.job.executor.ip</span>=<span class="string"></span></span><br><span class="line"><span class="meta">xxl.job.executor.port</span>=<span class="string">9999</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### xxl-job, access token</span></span><br><span class="line"><span class="meta">xxl.job.accessToken</span>=<span class="string"></span></span><br><span class="line"></span><br><span class="line"><span class="comment">### xxl-job log path</span></span><br><span class="line"><span class="meta">xxl.job.executor.logpath</span>=<span class="string">/data/applogs/xxl-job/jobhandler</span></span><br><span class="line"><span class="comment">### xxl-job log retention days</span></span><br><span class="line"><span class="meta">xxl.job.executor.logretentiondays</span>=<span class="string">30</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„ç›¸å…³æ³¨é‡Šæˆ‘ä»¬æ¥è§£é‡Šä¸ƒå¤§æ ¸å¿ƒå±æ€§çš„å«ä¹‰ï¼š</p><ul><li><code>adminAddresses</code>ï¼š<ul><li>é…ç½®é¡¹ï¼š<code>xxl.job.admin.addresses</code>ï¼Œé€‰å¡«ã€‚</li><li>å«ä¹‰ï¼šè°ƒåº¦ä¸­å¿ƒéƒ¨ç½²æ ¹åœ°å€ã€‚</li><li>ä½œç”¨ï¼šæ‰§è¡Œå™¨ä¼šä½¿ç”¨è¯¥åœ°å€è¿›è¡Œâ€œæ‰§è¡Œå™¨å¿ƒè·³æ³¨å†Œâ€å’Œä»»åŠ¡ç»“æœå›è°ƒã€‚</li><li>æ³¨æ„äº‹é¡¹ï¼šå¦‚è°ƒåº¦ä¸­å¿ƒé›†ç¾¤éƒ¨ç½²ï¼Œå­˜åœ¨å¤šä¸ªæ ¹åœ°å€ï¼Œåˆ™ç”¨é€—å·åˆ†éš”ã€‚ä¸ºç©ºä¸å¡«åˆ™å…³é—­è‡ªåŠ¨æ³¨å†ŒåŠŸèƒ½ã€‚</li></ul></li><li><code>appName</code>ï¼š<ul><li>é…ç½®é¡¹ï¼š<code>xxl.job.executor.appname</code>ï¼Œé€‰å¡«ã€‚</li><li>å«ä¹‰ï¼šæ˜¯æ¯ä¸ªæ‰§è¡Œå™¨é›†ç¾¤çš„å”¯ä¸€æ ‡ç¤ºAppNameã€‚</li><li>ä½œç”¨ï¼šæ‰§è¡Œå™¨å¿ƒè·³æ³¨å†Œåˆ†ç»„ä¾æ®ã€‚</li><li>æ³¨æ„äº‹é¡¹ï¼šä¸ºç©ºä¸å¡«è¡¨ç¤ºå…³é—­è‡ªåŠ¨æ³¨å†ŒåŠŸèƒ½ã€‚</li></ul></li><li><code>ip</code>ï¼š<ul><li>é…ç½®é¡¹ï¼š<code>xxl.job.executor.ip</code>ï¼Œé€‰å¡«ã€‚</li><li>å«ä¹‰ï¼šæ‰§è¡Œå™¨<code>IP</code>ã€‚</li><li>ä½œç”¨ï¼šé€‚ç”¨äºå¤šç½‘å¡æ—¶æ‰‹åŠ¨è®¾ç½®æŒ‡å®š<code>IP</code>ï¼Œè¯¥<code>IP</code>ä¸ä¼šç»‘å®š<code>Host</code>ä»…ä½œä¸ºé€šè®¯ä½¿ç”¨ï¼›ç”¨äºâ€œæ‰§è¡Œå™¨æ³¨å†Œâ€å’Œâ€œè°ƒåº¦ä¸­å¿ƒè¯·æ±‚å¹¶è§¦å‘ä»»åŠ¡â€ã€‚</li><li>æ³¨æ„äº‹é¡¹ï¼šä¸ºç©ºä¸å¡«è¡¨ç¤ºè‡ªåŠ¨è·å–<code>IP</code>ã€‚</li></ul></li><li><code>port</code>ï¼š<ul><li>é…ç½®é¡¹ï¼š<code>xxl.job.executor.port</code>ï¼Œé€‰å¡«ã€‚</li><li>å«ä¹‰ï¼šæ‰§è¡Œå™¨ç«¯å£å·ã€‚æ‰§è¡Œå™¨å®é™…æ˜¯ä¸€ä¸ªå†…åµŒçš„<code>Server</code>ï¼Œé»˜è®¤ç«¯å£<code>9999</code>ã€‚</li><li>ä½œç”¨ï¼šç”¨äºâ€œæ‰§è¡Œå™¨æ³¨å†Œâ€å’Œâ€œè°ƒåº¦ä¸­å¿ƒè¯·æ±‚å¹¶è§¦å‘ä»»åŠ¡â€æ—¶é€šè®¯ã€‚</li><li>æ³¨æ„äº‹é¡¹ï¼šå°äºç­‰äº<code>0</code>æ—¶è‡ªåŠ¨è·å–ã€‚å•æœºéƒ¨ç½²å¤šä¸ªæ‰§è¡Œå™¨æ—¶ï¼Œä¸åŒæ‰§è¡Œå™¨ç«¯å£ä¸èƒ½ç›¸åŒã€‚</li></ul></li><li><code>accessToken</code>ï¼š<ul><li>é…ç½®é¡¹ï¼š<code>xxl.job.accessToken</code>ï¼Œé€‰å¡«ã€‚</li><li>å«ä¹‰ï¼šè®¿é—®ä»¤ç‰Œã€‚</li><li>ä½œç”¨ï¼šä¸ºæå‡ç³»ç»Ÿå®‰å…¨æ€§ï¼Œè°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨è¿›è¡Œå®‰å…¨æ€§æ ¡éªŒï¼ŒåŒæ–¹<code>accessToken</code>åŒ¹é…æ‰å…è®¸é€šè®¯ã€‚</li><li>æ³¨æ„äº‹é¡¹ï¼šæ­£å¸¸é€šè®¯åªæœ‰ä¸¤ç§è®¾ç½®ï¼›<ul><li>è®¾ç½®ä¸€ï¼šè°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨å‡ä¸è®¾ç½®<code>accessToken</code>ï¼Œå…³é—­è®¿é—®ä»¤ç‰Œæ ¡éªŒã€‚</li><li>è®¾ç½®äºŒï¼šè°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨è®¾ç½®ç›¸åŒçš„<code>accessToken</code>ã€‚</li></ul></li></ul></li><li><code>logPath</code>ï¼š<ul><li>é…ç½®é¡¹ï¼š<code>xxl.job.executor.logpath</code>ï¼Œé€‰å¡«ã€‚</li><li>å«ä¹‰ï¼šæ‰§è¡Œå™¨è¿è¡Œæ—¥å¿—æ–‡ä»¶å­˜å‚¨ç£ç›˜è·¯å¾„ã€‚</li><li>ä½œç”¨ï¼šè®¾ç½®æ‰§è¡Œå™¨è¿è¡Œæ—¥å¿—æ–‡ä»¶å­˜å‚¨ç£ç›˜è·¯å¾„ã€‚</li><li>æ³¨æ„äº‹é¡¹ï¼šéœ€è¦å¯¹è®¾ç½®çš„è·¯å¾„æ‹¥æœ‰è¯»å†™æƒé™ï¼›ä¸ºç©ºåˆ™ä½¿ç”¨é»˜è®¤è·¯å¾„ï¼ˆ<code>/data/applogs/xxl-job/jobhandler</code>ï¼‰ã€‚</li></ul></li><li><code>logRetentionDays</code>ï¼š<ul><li>é…ç½®é¡¹ï¼š<code>xxl.job.executor.logretentiondays</code>ï¼Œé€‰å¡«ã€‚</li><li>å«ä¹‰ï¼šæ‰§è¡Œå™¨æ—¥å¿—æ–‡ä»¶ä¿å­˜å¤©æ•°ã€‚</li><li>ä½œç”¨ï¼šè®¾ç½®è¿‡æœŸæ—¥å¿—è‡ªåŠ¨æ¸…ç†ã€‚</li><li>æ³¨æ„äº‹é¡¹ï¼šè®¾ç½®çš„å€¼å¤§äºç­‰äº<code>3</code>æ—¶ç”Ÿæ•ˆï¼›å¦åˆ™æ—¥å¿—è‡ªåŠ¨æ¸…ç†åŠŸèƒ½å…³é—­ã€‚</li></ul></li></ul><h3 id="com-xxl-job-executor-core-config-XxlJobConfig-xxlJobExecutoræ–¹æ³•ä½œç”¨"><a href="#com-xxl-job-executor-core-config-XxlJobConfig-xxlJobExecutoræ–¹æ³•ä½œç”¨" class="headerlink" title="com.xxl.job.executor.core.config.XxlJobConfig#xxlJobExecutoræ–¹æ³•ä½œç”¨"></a><code>com.xxl.job.executor.core.config.XxlJobConfig#xxlJobExecutor</code>æ–¹æ³•ä½œç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> XxlJobSpringExecutor <span class="title">xxlJobExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.&quot;</span>);</span><br><span class="line">    XxlJobSpringExecutor xxlJobSpringExecutor = <span class="keyword">new</span> XxlJobSpringExecutor();</span><br><span class="line">    xxlJobSpringExecutor.setAdminAddresses(adminAddresses);</span><br><span class="line">    xxlJobSpringExecutor.setAppName(appName);</span><br><span class="line">    xxlJobSpringExecutor.setIp(ip);</span><br><span class="line">    xxlJobSpringExecutor.setPort(port);</span><br><span class="line">    xxlJobSpringExecutor.setAccessToken(accessToken);</span><br><span class="line">    xxlJobSpringExecutor.setLogPath(logPath);</span><br><span class="line">    xxlJobSpringExecutor.setLogRetentionDays(logRetentionDays);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> xxlJobSpringExecutor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šä¸€éƒ¨åˆ†åˆ—ä¸¾å‡ºçš„ä¸ƒå¤§å±æ€§æœ€ç»ˆè®¾ç½®ç»™äº†<code>com.xxl.job.core.executor.impl.XxlJobSpringExecutor</code>è¿™ä¸ªç±»çš„å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨<code>@Bean</code>æ³¨è§£äº¤ç”±<code>Spring</code>è¿›è¡Œç®¡ç†ã€‚è¯¥æ–¹æ³•ä¸­æ‰“å°çš„æ—¥å¿—ä¿¡æ¯ <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.</code> æˆ‘ä»¬åœ¨å¯åŠ¨æ‰§è¡Œå™¨æ—¶æ§åˆ¶å°æœ‰è¾“å‡ºã€‚</p><h2 id="ä¸ƒå¤§å±æ€§é…ç½®è¯¦è§£"><a href="#ä¸ƒå¤§å±æ€§é…ç½®è¯¦è§£" class="headerlink" title="ä¸ƒå¤§å±æ€§é…ç½®è¯¦è§£"></a>ä¸ƒå¤§å±æ€§é…ç½®è¯¦è§£</h2><p>ä¸Šä¸€éƒ¨åˆ†åˆ—ä¸¾å‡ºäº†æ¯ä¸ªå±æ€§çš„æ³¨æ„äº‹é¡¹ç­‰ï¼Œè¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å»æºç ä¸­éªŒè¯ä¸Šä¸€éƒ¨åˆ†çš„å†…å®¹ã€‚</p><h3 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>æˆ‘ä»¬è¦æ‰¾åˆ°ä¸Šè¿°ä¸ƒå¤§å±æ€§åœ¨è®¾ç½®ç»™<code>com.xxl.job.core.executor.impl.XxlJobSpringExecutor</code>è¿™ä¸ªç±»çš„å¯¹è±¡æ—¶æ˜¯å¦‚ä½•ä»¥åŠæ€æ ·è¿›è¡Œæ¡ä»¶é™åˆ¶çš„ã€‚</p><h3 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p>ä»<code>com.xxl.job.executor.core.config.XxlJobConfig#xxlJobExecutor</code>æ–¹æ³•æ¥çœ‹ï¼Œè¿™äº›é…ç½®ä»é…ç½®æ–‡ä»¶ä¸­è¯»åˆ°å€¼åæ˜¯ç›´æ¥ä½¿ç”¨å˜å¼‚å™¨ï¼ˆ<code>setter</code>æ–¹æ³•ï¼‰è®¾ç½®ç»™<code>xxlJobSpringExecutor</code>è¿™ä¸ªå¯¹è±¡ï¼Œç„¶åå°±æŠŠè¿™ä¸ªå¯¹è±¡äº¤ç»™<code>Spring</code>è¿›è¡Œç®¡ç†äº†ï¼Œæ‰€ä»¥åªæœ‰ä¸¤ç§å¯èƒ½ï¼Œç¬¬ä¸€æ˜¯åœ¨å˜å¼‚å™¨ä¸­è¿›è¡Œäº†é€»è¾‘å¤„ç†ï¼Œç¬¬äºŒæ˜¯åœ¨<code>Spring</code>åŠ è½½<code>bean</code>çš„è¿‡ç¨‹ä¸­è¿›è¡Œäº†é€»è¾‘å¤„ç†ã€‚</p><h3 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h3><p>æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹<code>com.xxl.job.core.executor.impl.XxlJobSpringExecutor</code>è¿™ä¸ªç±»çš„å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XxlJobSpringExecutor</span> <span class="keyword">extends</span> <span class="title">XxlJobExecutor</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span>, <span class="title">InitializingBean</span>, <span class="title">DisposableBean</span> </span>&#123;</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>è¯¥ç±»ç»§æ‰¿äº†<code>com.xxl.job.core.executor.XxlJobExecutor</code>çˆ¶ç±»å¹¶å®ç°äº†<code>Spring</code>çš„ä¸‰ä¸ªæ¥å£ï¼›æˆ‘ä»¬åœ¨è¯¥ç±»ä¸­æœªæ‰¾å±æ€§å¯¹åº”çš„å˜å¼‚å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å‡ ä¹å¯ä»¥æ–­å®šè¿™äº›å±æ€§æ˜¯å®šä¹‰åœ¨çˆ¶ç±»ä¸­ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çˆ¶ç±»çš„ä»£ç </p><p><img src="https://i.loli.net/2020/02/15/Xg4kodaAcUKtLG9.jpg" alt="XxlJobExecutorå˜å¼‚å™¨.png"></p><p>å˜å¼‚å™¨åªæ˜¯å•çº¯çš„æŠŠä¼ å…¥çš„å€¼è®¾ç½®ç»™å¯¹è±¡ï¼Œæ‰€ä»¥æ’é™¤äº†ç¬¬ä¸€ç§å¯èƒ½ï¼Œæƒ…å†µåªèƒ½æ˜¯ç¬¬äºŒç§ï¼šåœ¨<code>Spring</code>åŠ è½½<code>bean</code>çš„è¿‡ç¨‹ä¸­è¿›è¡Œäº†é€»è¾‘å¤„ç†ã€‚</p><p>æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹çˆ¶ç±»<code>XxlJobExecutor</code>çš„ä»£ç ï¼Œå‘ç°<code>start</code>æ–¹æ³•ä¸­ç”¨åˆ°äº†è¿™äº›å±æ€§ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä»”ç»†é˜…è¯»ä»¥ä¸‹è¯¥æ–¹æ³•çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ---------------------- start + stop ----------------------</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// init logpath</span></span><br><span class="line">    XxlJobFileAppender.initLogPath(logPath);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// init invoker, admin-client</span></span><br><span class="line">    initAdminBizList(adminAddresses, accessToken);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// init JobLogFileCleanThread</span></span><br><span class="line">    JobLogFileCleanThread.getInstance().start(logRetentionDays);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// init TriggerCallbackThread</span></span><br><span class="line">    TriggerCallbackThread.getInstance().start();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// init executor-server</span></span><br><span class="line">    port = port&gt;<span class="number">0</span>?port: NetUtil.findAvailablePort(<span class="number">9999</span>);</span><br><span class="line">    ip = (ip!=<span class="keyword">null</span>&amp;&amp;ip.trim().length()&gt;<span class="number">0</span>)?ip: IpUtil.getIp();</span><br><span class="line">    initRpcProvider(ip, port, appName, accessToken);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€å…±æœ‰ä¸ƒè¡Œæ ¸å¿ƒä»£ç ï¼Œæˆ‘ä»¬ä¸€è¡Œä¸€è¡Œçš„æ¥è§£è¯»ï¼š</p><ol><li><code>XxlJobFileAppender.initLogPath(logPath);</code></li></ol><p>ä»æ–¹æ³•åæ¥çœ‹æ˜¾ç„¶æ˜¯åˆå§‹åŒ–æ—¥å¿—å­˜å‚¨è·¯å¾„ï¼Œæˆ‘ä»¬è¿›å…¥<code>XxlJobFileAppender</code>ç±»æŸ¥çœ‹<code>initLogPath(logPath)</code>æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/02/15/DswcF91RrLxi4Ca.jpg" alt="XxlJobFileAppender_initLogPath.png"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é™æ€æˆå‘˜å˜é‡<code>logBasePath</code>çš„å€¼ä¸º<code>/data/applogs/xxl-job/jobhandler</code>ï¼Œå½“<code>logPath</code>å±æ€§æœªé…ç½®æ—¶è¯¥è·¯å¾„å³ä¸ºæ—¥å¿—å­˜ç›˜çš„é»˜è®¤è·¯å¾„ã€‚</p><p>è¯¥æ–¹æ³•çš„å®ç°æ€è·¯å¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœé…ç½®çš„<code>logPath</code>ä¸ä¸ºç©ºåˆ™è¦†ç›–é™æ€æˆå‘˜å˜é‡<code>logBasePath</code>çš„å€¼ã€‚</li><li>ä»¥é™æ€æˆå‘˜å˜é‡<code>logBasePath</code>çš„å€¼è°ƒç”¨<code>File</code>ç±»çš„<code>mkdirs</code>æ–¹æ³•åˆ›å»ºå¤šçº§æ–‡ä»¶ç›®å½•ã€‚</li><li>è°ƒç”¨<code>File</code>ç±»çš„<code>getPath</code>æ–¹æ³•å°†åˆ›å»ºå¥½çš„æ–‡ä»¶å¤¹çš„è·¯å¾„é‡æ–°èµ‹å€¼ç»™é™æ€æˆå‘˜å˜é‡<code>logBasePath</code>ã€‚</li></ul><p>ä»¥ä¸Šå°±æ˜¯å±æ€§<code>logPath</code>çš„é…ç½®æ–¹å¼ã€‚</p><ol start="2"><li><code>initAdminBizList(adminAddresses, accessToken);</code></li></ol><p>ä»æ–¹æ³•åæ¥çœ‹è¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯åˆå§‹åŒ–è°ƒåº¦ä¸­å¿ƒéƒ¨ç½²æ ¹åœ°å€é›†åˆï¼Œå…¶å‚æ•°æ˜¯é…ç½®é¡¹<code>adminAddresses</code>å’Œ<code>accessToken</code>çš„å€¼ã€‚æˆ‘ä»¬æ¥çœ‹è¯¥æ–¹æ³•çš„å…·ä½“å®ç°ï¼š</p><p><img src="https://i.loli.net/2020/02/15/KANYOLTaBfeh3mx.jpg" alt="initAdminBizList.png"></p><p>è¯¥æ–¹æ³•çš„å®ç°æ€è·¯å¦‚ä¸‹ï¼š</p><ul><li>åˆ¤æ–­ä¼ å…¥çš„é…ç½®é¡¹<code>adminAddresses</code>çš„å€¼æ˜¯å¦ä¸º<code>null</code>å¹¶ä¸”å»é™¤ä¸¤ç«¯ç©ºæ ¼åçš„é•¿åº¦æ˜¯å¦å¤§äºé›¶ã€‚</li><li>å¦‚æœä¸æ»¡è¶³ç¬¬ä¸€æ­¥çš„æ¡ä»¶åˆ™ä»€ä¹ˆä¹Ÿä¸åšï¼Œå³å…³é—­è‡ªåŠ¨æ³¨å†ŒåŠŸèƒ½ï¼›å¦‚æœæ»¡è¶³ç¬¬ä¸€æ­¥çš„æ¡ä»¶ï¼Œåˆ™å»é™¤ä¸¤ç«¯ç©ºæ ¼åè°ƒç”¨<code>split</code>æ–¹æ³•ä»¥è‹±æ–‡é€—å·<code>,</code>åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„è¿›è¡Œéå†ï¼Œéå†çš„ç¬¬ä¸€æ­¥æ˜¯é™åˆ¶æ•°ç»„ä¸­çš„å•ä¸ªåœ°å€å€¼ä¸ä¸º<code>null</code>å¹¶ä¸”å»é™¤ä¸¤ç«¯ç©ºæ ¼åçš„é•¿åº¦å¤§äºé›¶ï¼Œè¿™ä¸€æ­¥æ˜¯ä¸ºäº†é˜²æ­¢<code>,http://127.0.0.1:8080/xxl-job-admin,</code>ç­‰ç±»ä¼¼è¯¯é…ç½®ã€‚</li><li>ä¸€åˆ‡é™åˆ¶æ¡ä»¶é€šè¿‡åå¼€å§‹åˆ›å»º<code>com.xxl.job.core.biz.client.AdminBizClient</code>ç±»çš„å¯¹è±¡ï¼Œå¹¶æ·»åŠ è‡³é™æ€æˆå‘˜å˜é‡<code>adminBizList</code>é›†åˆä¸­ã€‚è¿™é‡Œæ˜¯åœ¨ç¬¬ä¸€æ¬¡å¾ªç¯æ—¶æ‰ä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»º<code>ArrayList</code>é›†åˆå¯¹è±¡ï¼Œå…¶æ€æƒ³æ˜¯â€œæ‡’åŠ è½½â€ï¼Œç”¨æ—¶æ‰å»åˆ›å»ºå¯¹è±¡ã€‚ç”±äº<code>Spring</code>çš„<code>bean</code>çš„é»˜è®¤ä½œç”¨åŸŸæ˜¯å•ä¾‹çš„ï¼Œæ‰€ä»¥ä¿è¯äº†è¯¥åˆå§‹åŒ–æ–¹æ³•åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</li></ul><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>com.xxl.job.core.biz.client.AdminBizClient</code>ç±»çš„æ„é€ æ–¹æ³•ï¼š</p><p><img src="https://i.loli.net/2020/02/15/on4UPLwMYal8jsm.png" alt="AdminBizClient_AdminBizClient.png"></p><p>æ„é€ æ–¹æ³•ä¸­å¯¹ä¼ å…¥çš„<code>addressUrl</code>è¿›è¡Œäº†ç®€å•çš„<code>valid</code>æ ¡éªŒï¼Œå¦‚æœä¸æ˜¯ä»¥<code>/</code>ç»“å°¾åˆ™å°†<code>/</code>æ‹¼æ¥è‡³æœ«å°¾ã€‚æ­¤å¤„å¯çœ‹å‡ºæˆ‘ä»¬çš„<code>adminAddresses</code>é…ç½®å®é™…ä¼šå˜æˆç±»ä¼¼<code>http://127.0.0.1:8080/xxl-job-admin/</code>è¿™æ ·çš„å­—ç¬¦ä¸²ã€‚è‡³äºè¯¥ç±»å¯¹è±¡ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æˆ‘ä»¬æš‚æ—¶æ²¡æœ‰çº¿ç´¢ï¼Œå¤§å¯å…ˆä¸å…³æ³¨è¿™ä¸ªã€‚</p><ol start="3"><li><code>JobLogFileCleanThread.getInstance().start(logRetentionDays);</code></li></ol><p>è°ƒç”¨<code>JobLogFileCleanThread</code>ç±»çš„<code>getInstance</code>æ–¹æ³•å–å¾—è¯¥ç±»å¯¹è±¡å†è°ƒç”¨å…¶<code>start(final long logRetentionDays)</code>æ–¹æ³•ã€‚</p><p>ä»ç±»åæ¥çœ‹æ˜¯æ¸…é™¤æ—¥å¿—æ–‡ä»¶çš„çº¿ç¨‹ã€‚</p><p>æˆ‘ä»¬å‰å¾€<code>com.xxl.job.core.thread.JobLogFileCleanThread</code>ç±»çœ‹ä¸€ä¸‹<code>getInstance</code>æ–¹æ³•ï¼Œä¼šå‘ç°æœ‰å¦‚ä¸‹ä¸¤è¡Œå…³é”®ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> JobLogFileCleanThread instance = <span class="keyword">new</span> JobLogFileCleanThread();</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> JobLogFileCleanThread <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯â€œé¥¿æ±‰å¼â€å•ä¾‹æ¨¡å¼çš„å†™æ³•ï¼Œåˆ›å»ºäº†å•ä¾‹çš„<code>JobLogFileCleanThread</code>å¯¹è±¡ã€‚</p><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹<code>start</code>æ–¹æ³•ï¼š</p><p><img src="https://i.loli.net/2020/02/15/V7KL4TDFZdYaqrj.png" alt="JobLogFileCleanThread_start.png"></p><p>é¦–å…ˆç¬¬ä¸€æ­¥æ£€æŸ¥è®¾ç½®çš„<code>logRetentionDays</code>å±æ€§æ˜¯å¦å°äº<code>3</code>ï¼Œå°äºåˆ™ç›´æ¥<code>return</code>ï¼›è¿™é‡Œè¯´æ˜äº†é…ç½®æ–‡ä»¶ä¸­çš„å€¼è®¾ç½®å°äº<code>3</code>æ—¶å…³é—­æ—¥å¿—è‡ªåŠ¨æ¸…ç†åŠŸèƒ½ã€‚</p><p>è¯¥æ–¹æ³•ä¸­å®ä¾‹åŒ–äº†æˆå‘˜å˜é‡<code>private Thread localThread;</code>ï¼Œè°ƒç”¨äº†<code>setDaemon(true)</code>æ–¹æ³•å°†è¯¥çº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå¹¶è°ƒç”¨<code>setName</code>æ–¹æ³•å°†çº¿ç¨‹åè®¾ä¸ºäº†<code>xxl-job, executor JobLogFileCleanThread</code>ã€‚</p><p>çº¿ç¨‹ä¸­è¿è¡Œçš„<code>run</code>æ–¹æ³•é€»è¾‘å¤§è‡´å¦‚ä¸‹ï¼š</p><ul><li>è°ƒç”¨<code>XxlJobFileAppender.getLogPath()</code>æ–¹æ³•è·å–è®¾ç½®çš„æ—¥å¿—å­˜ç›˜è·¯å¾„</li><li>éå†è¯¥è·¯å¾„ä¸‹æ‰€æœ‰æ–‡ä»¶å¤¹ï¼Œåˆ¤æ–­å½“å‰æ—¶é—´ä¸æ–‡ä»¶å¤¹çš„åˆ›å»ºæ—¶é—´ä¹‹å·®æ˜¯å¦å¤§äºç­‰äºè®¾ç½®çš„<code>logRetentionDays</code>å¤©æ•°ï¼Œå¦‚æœå¤§äºåˆ™è°ƒç”¨å·¥å…·ç±»<code>com.xxl.job.core.util.FileUtil</code>çš„<code>deleteRecursively</code>æ–¹æ³•é€’å½’åˆ é™¤æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚</li><li>åˆ é™¤é€»è¾‘å®Œæˆåï¼Œæœ‰è¿™æ ·ä¸€è¡Œä»£ç ï¼š<code>TimeUnit.DAYS.sleep(1);</code>ï¼Œçº¿ç¨‹ç¡çœ ä¸€å¤©ã€‚è¿™é‡Œè°ƒç”¨å¹¶å‘åŒ…ä¸‹çš„<code>TimeUnit</code>ç±»çš„<code>sleep</code>æ–¹æ³•è®©ä»£ç å¯è¯»æ€§æ›´é«˜ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨ä¼ ç»Ÿ<code>Thread.sleep()</code>æ–¹æ³•ï¼Œä¼ ç»™<code>sleep</code>æ–¹æ³•çš„å€¼çš„å•ä½æ˜¯æ¯«ç§’ï¼Œå³éœ€ä¼ å…¥<code>24*60*60*1000</code>ï¼Œä»£ç å¯è¯»æ€§ä¸é«˜ã€‚</li></ul><ol start="4"><li><code>TriggerCallbackThread.getInstance().start();</code></li></ol><p>ä»ç±»å<code>TriggerCallbackThread</code>æ¥çœ‹ï¼Œè¿™æ˜¯æ‰§è¡Œå™¨å›è°ƒçº¿ç¨‹ï¼Œç”±äºæœªä½¿ç”¨åˆ°é…ç½®å‚æ•°ï¼Œè¿™ç¯‡æ–‡ç« ä¸å¯¹å…¶è¿›è¡Œå±•å¼€è§£è¯»ã€‚</p><ol start="5"><li><code>port = port&gt;0?port: NetUtil.findAvailablePort(9999);</code></li></ol><p>åˆå§‹åŒ–<code>port</code>ç«¯å£å·ã€‚</p><p>å¦‚æœé…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„ç«¯å£å·å¤§äºé›¶ï¼Œåˆ™ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„å€¼ï¼›</p><p>å¦åˆ™æ‰§è¡Œä»£ç <code>NetUtil.findAvailablePort(9999);</code>ï¼Œæˆ‘ä»¬è¿›å…¥<code>NetUtil</code>ç±»æŸ¥çœ‹<code>findAvailablePort</code>æ–¹æ³•ï¼Œå‘ç°è¿™ä¸ªç±»å±äº<code>com.xxl.rpc.util</code>åŒ…ï¼Œå¯è§ï¼Œ<code>xxl-job</code>ä¾èµ–äº†<code>xxl-rpc</code>ï¼ˆè¿™æ˜¯ä½œè€…è®¸é›ªé‡Œå¼€æºçš„<code>rpc</code>æ¡†æ¶ï¼‰ã€‚</p><p>ä»æ–¹æ³•åæ¥çœ‹ä½œç”¨æ˜¯â€œå¯»æ‰¾å¯ç”¨ç«¯å£â€ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>findAvailablePort</code>æ–¹æ³•çš„å…·ä½“å®ç°é€»è¾‘ï¼š</p><p><img src="https://i.loli.net/2020/02/15/Y6MigAsaEbWwLxv.png" alt="NetUtil_findAvailablePort.png"></p><ul><li>ä¼ å…¥çš„<code>9999</code>ä½œä¸ºé»˜è®¤ç«¯å£ï¼Œé¦–å…ˆå¾ªç¯<code>9999</code>åˆ°<code>65534</code>ç«¯å£ï¼Œé€ä¸ªè¿›è¡Œ<code>!isPortUsed(portTmp)</code>åˆ¤æ–­ï¼Œå¦‚æœè¿”å›<code>true</code>åˆ™è¡¨ç¤ºå½“å‰ç«¯å£å·æœªè¢«ä½¿ç”¨ï¼Œè¿”å›èµ‹å€¼ç»™å±æ€§<code>port</code>ã€‚</li><li>å¦‚æœä¸Šè¿°å¾ªç¯æœªæ‰¾åˆ°å¯ä½¿ç”¨çš„ç«¯å£ï¼Œåˆ™å†å¾ªç¯<code>9999</code>åˆ°<code>1</code>ç«¯å£ï¼ŒåŒæ ·é€ä¸ªè¿›è¡Œ<code>!isPortUsed(portTmp)</code>åˆ¤æ–­ï¼Œå¦‚æœè¿˜æœªæ‰¾åˆ°å¯ç”¨ç«¯å£ï¼Œåˆ™æŠ›å‡º<code>XxlRpcException</code>å¼‚å¸¸ï¼Œå¼‚å¸¸ä¿¡æ¯ä¸º<code>no available port.</code>ã€‚</li></ul><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>isPortUsed</code>æ–¹æ³•æ˜¯å¦‚ä½•åˆ¤æ–­ç«¯å£æ˜¯å¦è¢«ä½¿ç”¨çš„ï¼š</p><p><img src="https://i.loli.net/2020/02/15/jy9bL4ZIrwB7shd.png" alt="NetUtil_isPortUsed.png"></p><p>å®é™…æ˜¯å°è¯•å»åˆ›å»ºä¸€ä¸ª<code>ServerSocket</code>å®¢æˆ·ç«¯å¹¶ä¸ä¼ å…¥çš„ç«¯å£å·è¿›è¡Œç»‘å®šï¼Œå¦‚ç«¯å£è¢«å ç”¨åˆ™ç»‘å®šæ—¶ä¼šæŠ›å‡º<code>IOException</code>ï¼Œç”±æ­¤æ¥ç¡®å®šç«¯å£æ˜¯å¦è¢«ä½¿ç”¨ï¼Œä»è€Œåœ¨æœªé…ç½®ç«¯å£å·æ—¶é€‰å‡ºä¸€ä¸ªå¯ç”¨ç«¯å£ã€‚æœ€ç»ˆ<code>finally</code>ä»£ç å—ä¸­è°ƒç”¨äº†<code>close</code>æ–¹æ³•å…³é—­èµ„æºã€‚</p><ol start="6"><li><code>ip = (ip!=null&amp;&amp;ip.trim().length()&gt;0)?ip: IpUtil.getIp();</code></li></ol><p>ä½œç”¨ï¼šç¡®å®š<code>ip</code>åœ°å€ã€‚ç¤ºä¾‹æ‰§è¡Œå™¨çš„é…ç½®ä¸­æ˜¯æœªè¿›è¡Œé…ç½®çš„ï¼Œæ‰€ä»¥ä¼šæ‰§è¡Œ<code>IpUtil.getIp()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ€åä¼šè°ƒç”¨<code>java.net.InetAddress#getHostAddress</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›<code>null</code>ï¼Œæ‰€ä»¥å±æ€§<code>ip</code>ä¼šè¢«è®¾ç½®æˆ<code>null</code>ã€‚</p><ol start="7"><li><code>initRpcProvider(ip, port, appName, accessToken);</code></li></ol><p>ä¼ å…¥äº†å››ä¸ªå‚æ•°ï¼š<code>ip</code>ã€<code>port</code>ã€<code>appName</code>å’Œ<code>accessToken</code>ç”¨æ¥åˆå§‹åŒ–<code>Rpc</code>æœåŠ¡æä¾›è€…ã€‚è¿™éƒ¨åˆ†å±äº<code>xxl-rpc</code>çš„å†…å®¹ï¼Œç›®å‰æˆ‘ä»¬å¯ä»¥ç®€å•çœ‹çœ‹ï¼Œå¤§è‡´å†…å®¹æ˜¯åˆ›å»ºå‡º<code>XxlRpcProviderFactory</code>ç±»çš„å¯¹è±¡ï¼Œç»™è¯¥å¯¹è±¡è®¾ç½®ç›¸å…³å±æ€§ï¼Œæ·»åŠ <code>com.xxl.job.core.biz.impl.ExecutorBizImpl</code>æœåŠ¡è‡³<code>rpc</code>æœåŠ¡æä¾›è€…<code>map</code>å®¹å™¨ä¸­ï¼Œæœ€åè°ƒç”¨<code>start</code>æ–¹æ³•å¯åŠ¨æœåŠ¡æä¾›è€…ï¼ˆè¿™é‡Œå®é™…æ˜¯ä¸€ä¸ª<code>NettyServer</code>ï¼‰ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å¤§å¯ä¸å¿…å»å…³æ³¨<code>xxl-rpc</code>æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œè¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯ææ¸…æ¥šä¸ƒå¤§æ ¸å¿ƒé…ç½®çš„å·¥ä½œåŸç†ã€‚</p><p>çˆ¶ç±»<code>XxlJobExecutor</code>çš„<code>start</code>æ–¹æ³•æˆ‘ä»¬çœ‹å®Œäº†ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä»€ä¹ˆæ—¶æœºæ‰§è¡Œçš„å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ³¨æ„åˆ°<code>XxlJobSpringExecutor</code>ç±»å®ç°äº†<code>Spring</code>çš„<code>InitializingBean</code>æ¥å£ï¼Œè¯¥æ¥å£æä¾›äº†<code>afterPropertiesSet</code>æ–¹æ³•ä¾›å­ç±»å®ç°ï¼Œåœ¨<code>bean</code>åŠ è½½è¿‡ç¨‹ä¸­ä¼šæ‰§è¡Œè¯¥æ–¹æ³•ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>XxlJobSpringExecutor</code>ç±»ä¸­é‡å†™çš„<code>afterPropertiesSet</code>æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// start</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// init JobHandler Repository</span></span><br><span class="line">    initJobHandlerRepository(applicationContext);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// init JobHandler Repository (for method)</span></span><br><span class="line">    initJobHandlerMethodRepository(applicationContext);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// refresh GlueFactory</span></span><br><span class="line">    GlueFactory.refreshInstance(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// super start</span></span><br><span class="line">    <span class="keyword">super</span>.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰ä¸‰è¡Œä»£ç æ˜¯åˆå§‹åŒ–ä¸€äº›ä¸œè¥¿ï¼Œæš‚æ—¶ä¸å»å…³æ³¨ï¼›æœ€åä¸€è¡Œ<code>super.start()</code>æ˜¯æˆ‘ä»¬çš„å…³é”®ï¼Œè°ƒç”¨äº†çˆ¶ç±»çš„<code>start</code>æ–¹æ³•ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è‡³æ­¤ï¼Œæˆ‘ä»¬çŸ¥é“äº†ä¸ƒå¤§é…ç½®é¡¹çš„åŸºæœ¬åŸç†ï¼Œå¯¹æˆ‘ä»¬ä½¿ç”¨<code>xxl-job</code>æœ‰äº†ä¸€äº›å¸®åŠ©ã€‚ä¾‹å¦‚é…ç½®é¡¹<code>logretentiondays</code>ä¸èƒ½å°äº<code>3</code>ï¼Œå¦åˆ™æ—¥å¿—æ–‡ä»¶ä¸ä¼šè‡ªåŠ¨æ¸…ç†ç­‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ä¸­é—´ä»¶ </category>
          
          <category> å®šæ—¶ä»»åŠ¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxl-job </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows 10ä¸‹Gitå®‰è£…åŠSSHå…¬ç§é’¥é…ç½®</title>
      <link href="2020/02/07/installed/install-git/"/>
      <url>2020/02/07/installed/install-git/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>å¯ä» <a href="https://git-scm.com/">Gitå®˜ç½‘</a> ä¸‹è½½æœ€æ–°<code>Windows</code>å®‰è£…æ–‡ä»¶ï¼ˆä¸‹è½½é€Ÿåº¦æœ‰ç‚¹æ„Ÿäººï¼‰ã€‚</p><p>è¿™é‡Œæˆ‘æä¾›<code>64</code>ä½çš„<code>Git 2.25.0</code>ç‰ˆæœ¬çš„ <a href="https://pan.baidu.com/s/1pAYF4SQDs2KF750rokTJgA">ç™¾åº¦ç½‘ç›˜</a> ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼š<code>uzs6</code>ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>åŒå‡»å®‰è£…åŒ…æ–‡ä»¶è¿›è¡Œå®‰è£…ï¼Œè‡ªå®šä¹‰å®‰è£…ä½ç½®ï¼Œå…¶ä½™ä¿æŒé»˜è®¤ä¸€ç›´<code>next</code>ä¸‹å»ã€‚</p><p>æŒ‰ä¸‹<code>win+R</code>é”®ï¼Œè¾“å…¥<code>cmd</code>ï¼Œå›è½¦ï¼Œè¾“å…¥å‘½ä»¤<code>git --version</code>ï¼Œå‡ºç°ä¸‹å›¾æ‰€ç¤ºå†…å®¹å³è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</p><p><img src="https://i.loli.net/2020/02/15/2RBSQYq6VMND5br.png" alt="git_version.png"></p><h2 id="å…¨å±€é…ç½®"><a href="#å…¨å±€é…ç½®" class="headerlink" title="å…¨å±€é…ç½®"></a>å…¨å±€é…ç½®</h2><p>å…¨å±€é…ç½®ç”¨æˆ·åå’Œé‚®ç®±ï¼Œå¦åˆ™æ— æ³•è¿›è¡Œä¸‹ä¸€æ­¥çš„<code>SSH</code>å…¬ç§é’¥é…ç½®ã€‚é¼ æ ‡å³å‡»æ¡Œé¢ç©ºç™½å¤„-&gt;é€‰æ‹©<code>Git Bash Here</code>æ‰“å¼€ã€‚åˆ†åˆ«è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;ä½ çš„ç”¨æˆ·å&quot;</span><br><span class="line">git config --global user.email &quot;ä½ çš„é‚®ç®±&quot;</span><br></pre></td></tr></table></figure><p>ç”¨æˆ·åå¯éšæ„æŒ‡å®šï¼Œä¸€èˆ¬æ˜¯è‡ªå·±åå­—æˆ–ç®€ç§°ï¼Œ<code>git</code>æäº¤ä»£ç åˆ°è¿œç¨‹æ—¶ä¼šä½¿ç”¨è¯¥åç§°ã€‚é‚®ç®±å¡«è‡ªå·±å–œæ¬¢çš„é‚®ç®±å³å¯ã€‚</p><h2 id="SSHå…¬ç§é’¥é…ç½®"><a href="#SSHå…¬ç§é’¥é…ç½®" class="headerlink" title="SSHå…¬ç§é’¥é…ç½®"></a><code>SSH</code>å…¬ç§é’¥é…ç½®</h2><ol><li>é¼ æ ‡å³å‡»æ¡Œé¢ç©ºç™½å¤„-&gt;é€‰æ‹©<code>Git Bash Here</code>æ‰“å¼€ã€‚</li><li>ä½¿ç”¨<code>cd ~/.ssh</code>åˆ‡æ¢åˆ°å…¬ç§é’¥ç›®å½•ã€‚</li><li>æ‰§è¡Œå‘½ä»¤<code>ssh-keygen -t rsa</code>ç”Ÿæˆå…¬ç§é’¥ï¼Œå›è½¦<code>3</code>æ¬¡ï¼ˆè¿™é‡Œå›è½¦ä¼šè®©ä½ è¾“å…¥ä¸€äº›é…ç½®ï¼Œæ¯”å¦‚å¯†ç ï¼Œå¦‚æœè®¾ç½®äº†å¯†ç åˆ™æ¯æ¬¡ä½¿ç”¨<code>git</code>å‘½ä»¤éƒ½ä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼Œä¸æ¨èï¼‰ï¼Œä¼šåœ¨<code>C:\Users\Administrator\.ssh</code>ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªç§é’¥<code>id_rsa</code>å’Œä¸€ä¸ªå…¬é’¥<code>id_rsa.pub</code>ã€‚</li></ol><h2 id="Gitlabé…ç½®"><a href="#Gitlabé…ç½®" class="headerlink" title="Gitlabé…ç½®"></a><code>Gitlab</code>é…ç½®</h2><p>ä¸Šè¿°é…ç½®å®Œæˆä¹‹åå³å¯åœ¨å…¨çƒæœ€å¤§çš„å¼€æºé¡¹ç›®æ‰˜ç®¡å¹³å°<code>Github</code>ä¸Šè¿›è¡Œä»£ç ç‰ˆæœ¬æ§åˆ¶ã€‚</p><p>ä½†ä¸€èˆ¬ä¼ä¸šéƒ½ä¼šæœ‰è‡ªå·±çš„<code>Gitlab</code>ä»£ç æ‰˜ç®¡å¹³å°ï¼Œè¿™æ—¶å¦‚æœæ²¡æœ‰åœ¨<code>Gitlab</code>ä¸Šé…ç½®å…¬ç§é’¥åˆ™ä¸èƒ½ä¸Šä¼ /ä¸‹è½½ä»£ç ã€‚</p><p>ç™»å½•ä¼ä¸šçš„<code>Gitlab</code>å¹³å°-&gt;å³ä¸Šè§’ä¸ªäººå¤´åƒ-&gt;<code>Settings</code>-&gt;<code>SSH Keys</code>-&gt;ç²˜è´´<code>.ssh</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>id_rsa.pub</code>å…¬é’¥å†…å®¹-&gt;ç¡®è®¤æ·»åŠ ã€‚</p><p><img src="https://i.loli.net/2020/02/15/g6BT2HSfZOLaWnV.png" alt="add_ssh_pub_key.png"></p><p>é…ç½®å®Œæˆåå³å¯åœ¨ä¼ä¸šçš„<code>Gitlab</code>å¹³å°ä¸Šä¼ /ä¸‹è½½ä»£ç ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰è£…é…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows 10ä¸‹IntelliJ IDEA 2019.3.2å®‰è£…å’Œå¸¸ç”¨é…ç½®</title>
      <link href="2020/02/07/installed/install-idea/"/>
      <url>2020/02/07/installed/install-idea/</url>
      
        <content type="html"><![CDATA[<p>ä»¥ä¸‹æ•™ç¨‹åŸºäº<code>windows 10</code>å’Œ<code>IntelliJ IDEA 2019.3.2</code>ã€‚</p><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>å¯ä» <a href="https://www.jetbrains.com/idea/download/#section=windows">IntelliJ IDEAå®˜ç½‘</a> ä¸‹è½½æœ€æ–°å®‰è£…åŒ…ã€‚</p><p>è¿™é‡Œæˆ‘æä¾› <a href="https://pan.baidu.com/s/14P-cczbbA-o8N6CdCsQe6w">ç™¾åº¦äº‘ç›˜</a> ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼š<code>v9oj</code>ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ul><li><p>åŒå‡»<code>.exe</code>å®‰è£…æ–‡ä»¶-&gt;<code>Next</code>-&gt;æŒ‡å®šå®‰è£…è·¯å¾„ï¼ˆå¯ç›´æ¥å¡«å†™ï¼Œä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼‰-&gt;<code>Next</code>-&gt;<code>Next</code>-&gt;<code>Install</code>ï¼›ç­‰å¾…å®‰è£…å®Œæˆã€‚</p></li><li><p>å‹¾é€‰<code>Run IntelliJ IDEA</code>-&gt;<code>Finish</code></p></li><li><p><code>Do not import settings</code>-&gt;<code>OK</code>-&gt;å‹¾é€‰<code>I confirm that...</code>-&gt;<code>Continue</code>-&gt;<code>Don&#39;t Send</code></p></li><li><p>é€‰æ‹©ç•Œé¢ä¸»é¢˜-&gt;<code>Next: Default plugins</code>-&gt;<code>Next: Featured plugins</code>-&gt;<code>Start using IntelliJ IDEA</code>ï¼ˆè¿™ä¸€ç³»åˆ—æ¨èæŒ‰é»˜è®¤é…ç½®ï¼‰</p></li><li><p><code>Evaluate for free</code>-&gt;<code>Evaluate</code>-&gt;<code>Continue</code></p></li></ul><h2 id="æ¿€æ´»"><a href="#æ¿€æ´»" class="headerlink" title="æ¿€æ´»"></a>æ¿€æ´»</h2><p>ç”±äºæ³•å¾‹å…³ç³»ï¼Œè¯·å¤§å®¶å°½é‡æ”¯æŒæ­£ç‰ˆã€‚</p><h2 id="å¸¸ç”¨é…ç½®"><a href="#å¸¸ç”¨é…ç½®" class="headerlink" title="å¸¸ç”¨é…ç½®"></a>å¸¸ç”¨é…ç½®</h2><p>ç‚¹å‡»<code>File</code>-&gt;<code>Close Project</code>ï¼Œå…³é—­ä¸»ç•Œé¢è¿›å…¥é€‰æ‹©é¡¹ç›®çª—å£ï¼ˆè¿™æ ·è®¾ç½®æ˜¯å…¨å±€è®¾ç½®ï¼Œè€Œä¸æ˜¯å•å¯¹äºæŸä¸ªé¡¹ç›®è®¾ç½®ï¼‰ã€‚</p><p>ç‚¹å‡»å³ä¸‹è§’<code>Configure</code>-&gt;<code>Settings</code>ï¼Œæ‰“å¼€è®¾ç½®é¢æ¿ã€‚</p><h3 id="è®¾ç½®æ¯æ¬¡æ‰“å¼€éƒ½æ˜¯é€‰æ‹©é¡¹ç›®ç•Œé¢ã€‚"><a href="#è®¾ç½®æ¯æ¬¡æ‰“å¼€éƒ½æ˜¯é€‰æ‹©é¡¹ç›®ç•Œé¢ã€‚" class="headerlink" title="è®¾ç½®æ¯æ¬¡æ‰“å¼€éƒ½æ˜¯é€‰æ‹©é¡¹ç›®ç•Œé¢ã€‚"></a>è®¾ç½®æ¯æ¬¡æ‰“å¼€éƒ½æ˜¯é€‰æ‹©é¡¹ç›®ç•Œé¢ã€‚</h3><p><code>Appearance &amp; Behavior</code>-&gt;<code>System Settings</code>-&gt;å–æ¶ˆå‹¾é€‰<code>Reopen last project on startup</code></p><p><img src="https://i.loli.net/2020/02/15/ARP29OHgBo7cfdb.png" alt="show_project_select.png"></p><h3 id="å–æ¶ˆè‡ªåŠ¨æ£€æŸ¥æ›´æ–°ã€‚"><a href="#å–æ¶ˆè‡ªåŠ¨æ£€æŸ¥æ›´æ–°ã€‚" class="headerlink" title="å–æ¶ˆè‡ªåŠ¨æ£€æŸ¥æ›´æ–°ã€‚"></a>å–æ¶ˆè‡ªåŠ¨æ£€æŸ¥æ›´æ–°ã€‚</h3><p><code>Appearance &amp; Behavior</code>-&gt;<code>System Settings</code>-&gt;<code>Updates</code>-&gt;å–æ¶ˆå‹¾é€‰<code>Automatically check updates for</code></p><h3 id="è®¾ç½®é¼ æ ‡æ”¾åˆ°ç±»æˆ–æ–¹æ³•ä¸Šè‡ªåŠ¨æ˜¾ç¤ºæ³¨é‡Šæ–‡æ¡£ã€‚"><a href="#è®¾ç½®é¼ æ ‡æ”¾åˆ°ç±»æˆ–æ–¹æ³•ä¸Šè‡ªåŠ¨æ˜¾ç¤ºæ³¨é‡Šæ–‡æ¡£ã€‚" class="headerlink" title="è®¾ç½®é¼ æ ‡æ”¾åˆ°ç±»æˆ–æ–¹æ³•ä¸Šè‡ªåŠ¨æ˜¾ç¤ºæ³¨é‡Šæ–‡æ¡£ã€‚"></a>è®¾ç½®é¼ æ ‡æ”¾åˆ°ç±»æˆ–æ–¹æ³•ä¸Šè‡ªåŠ¨æ˜¾ç¤ºæ³¨é‡Šæ–‡æ¡£ã€‚</h3><p><code>Editor</code>-&gt;<code>General</code>-&gt;å‹¾é€‰<code>Show quick documentation on mouse move</code></p><p>å¯åœ¨ä¸‹æ–¹è®¾ç½®æ˜¾ç¤ºçš„å»¶è¿Ÿæ¯«ç§’æ•°<code>Tooltip delay</code></p><h3 id="è®¾ç½®å­—ä½“å’Œå­—ä½“å¤§å°"><a href="#è®¾ç½®å­—ä½“å’Œå­—ä½“å¤§å°" class="headerlink" title="è®¾ç½®å­—ä½“å’Œå­—ä½“å¤§å°"></a>è®¾ç½®å­—ä½“å’Œå­—ä½“å¤§å°</h3><p><code>Editor</code>-&gt;<code>Font</code></p><h3 id="è®¾ç½®åˆ›å»ºJavaç±»æ—¶çš„å¤´éƒ¨æ³¨é‡Šæ¨¡æ¿ã€‚"><a href="#è®¾ç½®åˆ›å»ºJavaç±»æ—¶çš„å¤´éƒ¨æ³¨é‡Šæ¨¡æ¿ã€‚" class="headerlink" title="è®¾ç½®åˆ›å»ºJavaç±»æ—¶çš„å¤´éƒ¨æ³¨é‡Šæ¨¡æ¿ã€‚"></a>è®¾ç½®åˆ›å»º<code>Java</code>ç±»æ—¶çš„å¤´éƒ¨æ³¨é‡Šæ¨¡æ¿ã€‚</h3><p><code>Editor</code>-&gt;<code>File and Code Templates</code>-&gt;<code>Includes</code>-&gt;<code>File Header</code></p><p>å³ä¾§è¾“å…¥æ³¨é‡Šæ¨¡æ¿ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @author sunchaser</span><br><span class="line"> * @date $&#123;DATE&#125;</span><br><span class="line"> * @description</span><br><span class="line"> * @since 1.0</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®æ–‡ä»¶ç¼–ç å­—ç¬¦é›†ã€‚"><a href="#è®¾ç½®æ–‡ä»¶ç¼–ç å­—ç¬¦é›†ã€‚" class="headerlink" title="è®¾ç½®æ–‡ä»¶ç¼–ç å­—ç¬¦é›†ã€‚"></a>è®¾ç½®æ–‡ä»¶ç¼–ç å­—ç¬¦é›†ã€‚</h3><p><code>Editor</code>-&gt;<code>File Encodings</code></p><p>ç»Ÿä¸€é€‰æ‹©<code>UTF-8</code>/<code>with NO BOM</code>ã€‚</p><h3 id="è®¾ç½®GitåŠGitHubã€‚"><a href="#è®¾ç½®GitåŠGitHubã€‚" class="headerlink" title="è®¾ç½®GitåŠGitHubã€‚"></a>è®¾ç½®<code>Git</code>åŠ<code>GitHub</code>ã€‚</h3><p><code>Version Control</code>-&gt;<code>Git</code>/<code>GitHub</code></p><p>é€‰æ‹©<code>Git</code>å®‰è£…ç›®å½•ä¸‹çš„<code>bin\git.exe</code>æ–‡ä»¶ã€‚æœ‰å…³<code>Git</code>çš„å®‰è£…é…ç½®ï¼Œå¯å‚è€ƒ <a href="/2020/02/07/installed/install-git/">è¿™ç¯‡æ–‡ç« </a></p><p>è¾“å…¥ç”¨æˆ·å/å¯†ç ç™»å½•<code>GitHub</code>ã€‚</p><h3 id="è®¾ç½®Mavenã€‚"><a href="#è®¾ç½®Mavenã€‚" class="headerlink" title="è®¾ç½®Mavenã€‚"></a>è®¾ç½®<code>Maven</code>ã€‚</h3><p><code>Build,Execution,Deployment</code>-&gt;<code>Build Tools</code>-&gt;<code>Maven</code></p><p>é€‰æ‹©<code>Maven home directory</code>ä¸ºæˆ‘ä»¬è‡ªå·±å®‰è£…çš„<code>Maven</code>ç›®å½•ï¼Œç‚¹å‡»<code>Override</code>è¦†ç›–é»˜è®¤çš„<code>User settings file</code>å’Œ<code>Local repository</code>ã€‚</p><p>æœ‰å…³<code>Maven</code>çš„å®‰è£…å’Œé…ç½®ï¼Œå¯å‚è€ƒ <a href="/2020/02/07/installed/install-maven/">è¿™ç¯‡æ–‡ç« </a> ã€‚</p><p><code>Build,Execution,Deployment</code>-&gt;<code>Build Tools</code>-&gt;<code>Maven</code>-&gt;<code>Importing</code>/<code>Runner</code></p><p>é€‰æ‹©<code>JDK for importer</code>/<code>JRE</code>ä¸º<code>Use JAVA_HOME</code></p><h3 id="è®¾ç½®åºåˆ—åŒ–UIDç”Ÿæˆå¿«æ·é”®"><a href="#è®¾ç½®åºåˆ—åŒ–UIDç”Ÿæˆå¿«æ·é”®" class="headerlink" title="è®¾ç½®åºåˆ—åŒ–UIDç”Ÿæˆå¿«æ·é”®"></a>è®¾ç½®åºåˆ—åŒ–<code>UID</code>ç”Ÿæˆå¿«æ·é”®</h3><p>è®¾ç½®å®ç°äº†<code>Serializable</code>åºåˆ—åŒ–æ¥å£çš„ç±»ä¸­æœªå®šä¹‰<code>serialVersionUID</code>å±æ€§æ—¶ç±»åå¤„æŠ¥é»„è‰²è­¦å‘Šï¼ŒæŒ‰å¿«æ·é”®<code>alt</code>+<code>enter</code>æœ‰å¿«æ·ç”Ÿæˆåºåˆ—åŒ–<code>UID</code>çš„é€‰é¡¹ã€‚</p><p><code>Editor</code>-&gt;<code>Inspections</code></p><p>æœç´¢<code>Serializable</code>ï¼Œæ‰¾åˆ°<code>Serializable class without &#39;serialVersionUID&#39;</code>ï¼Œå³ä¾§è¿›è¡Œå‹¾é€‰ã€‚</p><p><img src="https://i.loli.net/2020/02/15/u5Cjxqkdo79TDFr.jpg" alt="serializable.png"></p><p>æ‰€æœ‰è®¾ç½®å®Œæˆåç‚¹å‡»å³ä¸‹è§’<code>Apply</code>-&gt;<code>OK</code>ï¼Œå®Œæˆè®¾ç½®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰è£…é…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IntelliJ IDEA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows 10ä¸‹JDKå®‰è£…åŠç¯å¢ƒå˜é‡é…ç½®</title>
      <link href="2020/02/07/installed/install-jdk/"/>
      <url>2020/02/07/installed/install-jdk/</url>
      
        <content type="html"><![CDATA[<p>ç”±äº<code>JDK</code>å¼€å§‹æ”¶è´¹ï¼Œç°åœ¨å¤§å¤šæ•°ä¼ä¸šä½¿ç”¨çš„<code>Java</code>ç‰ˆæœ¬æ˜¯<code>Java8</code>æˆ–è€…ä»¥ä¸‹ï¼Œ<code>Java8</code>çš„ä½¿ç”¨è€…å±…å¤šã€‚æˆ‘ä»¬åœ¨å­¦ä¹ æˆ–å¼€å‘ä¸­ï¼Œä¸‹è½½<code>Java8</code>å°±è¶³å¤Ÿä½¿ç”¨äº†ã€‚</p><h2 id="ä¸‹è½½JDKå®‰è£…åŒ…"><a href="#ä¸‹è½½JDKå®‰è£…åŒ…" class="headerlink" title="ä¸‹è½½JDKå®‰è£…åŒ…"></a>ä¸‹è½½<code>JDK</code>å®‰è£…åŒ…</h2><p>å¯å‰å¾€ <a href="https://www.oracle.com/technetwork/java/javase/documentation/8u-relnotes-2225394.html">Oracleå®˜ç½‘</a> ä¸‹è½½ã€‚</p><p>è¿™é‡Œæˆ‘åˆ†äº« <a href="https://pan.baidu.com/s/10_chUokZGwpcoCA-nGADOQ">ç™¾åº¦äº‘ç›˜</a> ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼š<code>5mxh</code>ã€‚</p><h2 id="è¿›è¡Œå®‰è£…"><a href="#è¿›è¡Œå®‰è£…" class="headerlink" title="è¿›è¡Œå®‰è£…"></a>è¿›è¡Œå®‰è£…</h2><p>åŒå‡»è¿è¡Œ<code>.exe</code>åç¼€æ–‡ä»¶ï¼Œè¿è¡Œå®‰è£…ç¨‹åºï¼Œæ³¨æ„ä¸‹å›¾æ‰€ç¤ºåœ°æ–¹ï¼Œå»é™¤å…¬å…±<code>JRE</code>çš„å®‰è£…ï¼Œç‚¹å‡»å·¦ä¾§çš„å°å›¾æ ‡é€‰æ‹©æ­¤åŠŸèƒ½å°†ä¸å¯ç”¨ã€‚ç‚¹å‡»å¼€å‘å·¥å…·æ›´æ”¹å®‰è£…è·¯å¾„ï¼Œç»§ç»­ä¸‹ä¸€æ­¥ç›´è‡³å®Œæˆå®‰è£…å³å¯ã€‚</p><p><img src="https://i.loli.net/2020/02/15/nafVXGuSYeIFr8o.png" alt="java-jre.png"></p><h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><p>å³å‡»æˆ‘çš„ç”µè„‘-&gt;å±æ€§-&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®-&gt;é«˜çº§-&gt;ç¯å¢ƒå˜é‡</p><p>åœ¨ç³»ç»Ÿå˜é‡å¤„ç‚¹å‡»æ–°å»ºï¼Œè¾“å…¥å˜é‡åï¼š<code>JAVA_HOME</code>ï¼Œå˜é‡å€¼ä¸ºä¸Šè¿°<code>JDK</code>å®‰è£…æ­¥éª¤ä¸­æ›´æ”¹çš„å®‰è£…è·¯å¾„ï¼Œç‚¹å‡»ç¡®å®šã€‚</p><p><img src="https://i.loli.net/2020/02/15/WcE1fDZLtdYCgm5.png" alt="java_home.png"></p><p>é€‰ä¸­ç³»ç»Ÿ<code>Path</code>å˜é‡ï¼Œç‚¹å‡»ç¼–è¾‘-&gt;æ–°å»ºï¼Œè¾“å…¥<code>%JAVA_HOME%\bin\</code>ï¼Œç‚¹å‡»ç¡®å®šã€‚</p><p><img src="https://i.loli.net/2020/02/15/RShbVoiKCfFg7nI.png" alt="java_home_path.png"><br><img src="https://i.loli.net/2020/02/15/GFevdKUXnPjZ8tO.png" alt="java_home_path_bin.png"></p><p>æœ€åä¸€ç›´ç¡®å®šä¸‹å»è‡³çª—å£å…³é—­å³å¯ã€‚</p><h2 id="æ£€éªŒ"><a href="#æ£€éªŒ" class="headerlink" title="æ£€éªŒ"></a>æ£€éªŒ</h2><p>æŒ‰ä¸‹<code>win+R</code>é”®ï¼Œè¾“å…¥<code>cmd</code>ï¼Œå›è½¦ï¼Œè¾“å…¥å‘½ä»¤<code>java -version</code>ï¼Œå‡ºç°ä¸‹å›¾æ‰€ç¤ºå†…å®¹å³è¡¨ç¤ºé…ç½®æˆåŠŸã€‚</p><p><img src="https://i.loli.net/2020/02/15/c6OCkniZS8IprxU.png" alt="java_version.png"></p><h2 id="é¢˜å¤–è¯"><a href="#é¢˜å¤–è¯" class="headerlink" title="é¢˜å¤–è¯"></a>é¢˜å¤–è¯</h2><p>ç½‘ä¸Šå¾ˆå¤šè€çš„æ•™ç¨‹è¿˜éœ€è¦é…ç½®<code>CLASSPATH</code>å˜é‡ï¼Œè¿™ä¸ªæ˜¯<code>JDK</code>çš„å†å²åŸå› ï¼Œç°åœ¨<code>JDK</code>ç›®å½•ä¸‹å·²åŒ…å«ä¸“ç”¨çš„<code>JRE</code>ï¼Œæ— éœ€å†è¿›è¡Œé¢å¤–é…ç½®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰è£…é…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows 10ä¸‹Mavenå®‰è£…åŠé…ç½®</title>
      <link href="2020/02/07/installed/install-maven/"/>
      <url>2020/02/07/installed/install-maven/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>å¯ä» <a href="http://maven.apache.org/download.cgi/">Mavenå®˜ç½‘</a> ä¸‹è½½<code>Binary zip archive</code>æœ€æ–°å‹ç¼©åŒ…ã€‚</p><p>è¿™é‡Œæˆ‘æä¾› <a href="https://pan.baidu.com/s/1QMUbAxNFTKTPwktK1-v1qg">ç™¾åº¦äº‘ç›˜</a> ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼š<code>olx2</code>ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p><code>maven</code>ä¸ºç»¿è‰²å®‰è£…ï¼Œä¸‹è½½å®Œæˆåè§£å‹è‡³è‡ªå®šä¹‰ç›®å½•å³å¯ã€‚</p><p>æ³¨æ„ï¼šè§£å‹è·¯å¾„ä¸è¦åŒ…å«ä¸­æ–‡ã€‚</p><h2 id="å®‰è£…æ–‡ä»¶ç®€ä»‹"><a href="#å®‰è£…æ–‡ä»¶ç®€ä»‹" class="headerlink" title="å®‰è£…æ–‡ä»¶ç®€ä»‹"></a>å®‰è£…æ–‡ä»¶ç®€ä»‹</h2><p>è§£å‹ç›®å½•åŒ…å«<code>4</code>ä¸ªæ–‡ä»¶å¤¹<code>bin/boot/conf/lib</code>ï¼Œå…¶å­˜æ”¾çš„æ–‡ä»¶åˆ†åˆ«ä¸ºï¼š</p><ul><li><code>bin</code>ï¼š<code>maven</code>çš„ä¸€äº›å¯æ‰§è¡Œç¨‹åºã€‚</li><li><code>boot</code>ï¼šä¸€äº›å¯åŠ¨å¼•å¯¼ç¨‹åºï¼Œä¾‹å¦‚ç±»åŠ è½½å™¨ç­‰ã€‚</li><li><code>conf</code>ï¼šé…ç½®æ–‡ä»¶ã€‚</li><li><code>lib</code>ï¼š<code>maven</code>è‡ªèº«è¿è¡Œä¾èµ–çš„åº“ã€‚</li></ul><h2 id="é…ç½®maven"><a href="#é…ç½®maven" class="headerlink" title="é…ç½®maven"></a>é…ç½®<code>maven</code></h2><h3 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h3><p>å³å‡»æˆ‘çš„ç”µè„‘-&gt;å±æ€§-&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®-&gt;é«˜çº§-&gt;ç¯å¢ƒå˜é‡</p><p>åœ¨ç³»ç»Ÿå˜é‡å¤„ç‚¹å‡»æ–°å»ºï¼Œè¾“å…¥å˜é‡åï¼š<code>MAVEN_HOME</code>ï¼Œå˜é‡å€¼ä¸Šè¿°<code>maven</code>çš„è§£å‹ç›®å½•ï¼Œç‚¹å‡»ç¡®å®šã€‚</p><p><img src="https://i.loli.net/2020/02/15/Trs4I5pO7ZhlxQk.png" alt="maven_home.png"></p><p>é€‰ä¸­ç³»ç»Ÿ<code>Path</code>å˜é‡ï¼Œç‚¹å‡»ç¼–è¾‘-&gt;æ–°å»ºï¼Œè¾“å…¥<code>%MAVEN_HOME%\bin\</code>ï¼Œç‚¹å‡»ç¡®å®šã€‚</p><p><img src="https://i.loli.net/2020/02/15/pmsHLowja4OdWDu.png" alt="maven_home_path.png"><br><img src="https://i.loli.net/2020/02/15/NcxXsZK68laoOfm.png" alt="maven_home_path_bin.png"></p><p>æœ€åä¸€ç›´ç¡®å®šä¸‹å»è‡³çª—å£å…³é—­å³å¯ã€‚</p><p>æŒ‰ä¸‹<code>win+R</code>é”®ï¼Œè¾“å…¥<code>cmd</code>ï¼Œå›è½¦ï¼Œè¾“å…¥å‘½ä»¤<code>mvn -v</code>ï¼Œå‡ºç°ä¸‹å›¾æ‰€ç¤ºå†…å®¹å³è¡¨ç¤ºé…ç½®æˆåŠŸã€‚</p><p><img src="https://i.loli.net/2020/02/15/meD3iLrZOnCNpyz.png" alt="mvn_v.png"></p><h3 id="é…ç½®æœ¬åœ°ä»“åº“"><a href="#é…ç½®æœ¬åœ°ä»“åº“" class="headerlink" title="é…ç½®æœ¬åœ°ä»“åº“"></a>é…ç½®æœ¬åœ°ä»“åº“</h3><p>æ–°å»ºä¸€ä¸ªè‡ªå®šä¹‰ç›®å½•<code>repository</code>ä½œä¸ºæœ¬åœ°ä»“åº“ï¼Œä¸€èˆ¬å’Œ<code>Maven</code>çš„è§£å‹ç›®å½•åœ¨åŒçº§ã€‚</p><p>ç„¶ååœ¨<code>Maven</code>çš„å®‰è£…ç›®å½•ä¸‹æ‰¾åˆ°<code>conf</code>ç›®å½•ä¸‹çš„<code>settings.xml</code>é…ç½®æ–‡ä»¶ï¼Œç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ï¼Œæ‰¾åˆ°å¤§æ¦‚ç¬¬<code>55</code>è¡Œçš„ä½ç½®ï¼Œè¾“å…¥ä»¥ä¸‹æ ‡ç­¾æŒ‡å®šæœ¬åœ°ä»“åº“çš„ä½ç½®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;localRepository&gt;E:\develop\maven\repository&lt;&#x2F;localRepository&gt;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/02/15/nAo7qkhJQZgEOjy.png" alt="local_repository.png"></p><p>æ ¹æ®ä¸ªäººå®‰è£…ä½ç½®è¾“å…¥ä»“åº“è·¯å¾„ã€‚</p><h3 id="é…ç½®é˜¿é‡Œäº‘é•œåƒä»“åº“"><a href="#é…ç½®é˜¿é‡Œäº‘é•œåƒä»“åº“" class="headerlink" title="é…ç½®é˜¿é‡Œäº‘é•œåƒä»“åº“"></a>é…ç½®é˜¿é‡Œäº‘é•œåƒä»“åº“</h3><p><img src="https://i.loli.net/2020/02/15/81W7sY9LOk5T6XD.jpg" alt="aliyun_mirror.png"></p><p>åœ¨<code>settings.xml</code>æ–‡ä»¶å¤§çº¦<code>160</code>è¡Œçš„åœ°æ–¹ï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹é…ç½®é˜¿é‡Œäº‘<code>Maven</code>é•œåƒï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- è¿™ä¸ªæ˜¯é…ç½®é˜¿é‡ŒMavené•œåƒ --&gt;</span><br><span class="line">&lt;mirror&gt;</span><br><span class="line">  &lt;id&gt;alimaven&lt;&#x2F;id&gt;</span><br><span class="line">  &lt;name&gt;aliyun maven&lt;&#x2F;name&gt;</span><br><span class="line">  &lt;url&gt;http:&#x2F;&#x2F;maven.aliyun.com&#x2F;nexus&#x2F;content&#x2F;groups&#x2F;public&#x2F;&lt;&#x2F;url&gt;</span><br><span class="line">  &lt;mirrorOf&gt;central&lt;&#x2F;mirrorOf&gt;</span><br><span class="line">&lt;&#x2F;mirror&gt;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è‡³æ­¤ï¼Œ<code>Maven</code>çš„é…ç½®å°±å®Œæˆäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰è£…é…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows 10ä¸‹Node.jså®‰è£…ä¸é…ç½®</title>
      <link href="2020/02/07/installed/install-nodejs/"/>
      <url>2020/02/07/installed/install-nodejs/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>å¯ä» <a href="https://nodejs.org/zh-cn/">Node.jsä¸­æ–‡å®˜ç½‘</a> ä¸‹è½½æœ€æ–°é•¿æœŸæ”¯æŒç‰ˆå®‰è£…åŒ…ã€‚</p><p>è¿™é‡Œæˆ‘æä¾›<code>12.15.0</code>é•¿æœŸæ”¯æŒç‰ˆ <a href="https://pan.baidu.com/s/1GQZYcUpMsBBA0nU20CJplg">ç™¾åº¦äº‘ç›˜</a> ä¾›å¤§å®¶ä¸‹è½½ï¼Œæå–ç ï¼š<code>itoe</code>ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>åŒå‡»å®‰è£…åŒ…æ–‡ä»¶è¿›è¡Œå®‰è£…ï¼Œè‡ªå®šä¹‰å®‰è£…ä½ç½®ï¼Œå…¶ä½™ä¿æŒé»˜è®¤ä¸€ç›´<code>next</code>ä¸‹å»ã€‚</p><p>æŒ‰ä¸‹<code>win+R</code>é”®ï¼Œè¾“å…¥<code>cmd</code>ï¼Œå›è½¦ï¼Œåˆ†åˆ«è¾“å…¥å‘½ä»¤<code>node -v</code>å’Œ<code>npm -v</code>ï¼Œå‡ºç°ä¸‹å›¾æ‰€ç¤ºå†…å®¹å³è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</p><p><img src="https://i.loli.net/2020/02/15/cEe7vjnkqC9m8Ol.png" alt="node_npm_v.png"></p><p>è¯´æ˜ï¼šæ–°ç‰ˆæœ¬<code>Node.js</code>è‡ªå¸¦<code>npm</code>ï¼Œå®‰è£…<code>Node.js</code>æ—¶ä¼šä¸€èµ·å®‰è£…ï¼Œ<code>npm</code>æ˜¯<code>Node.js</code>çš„ä¾èµ–åŒ…ç®¡ç†å·¥å…·ï¼Œå¯å¤§è‡´ç†è§£æˆ<code>maven</code>/<code>Composer</code>ç­‰ã€‚</p><h2 id="å…¨å±€é…ç½®"><a href="#å…¨å±€é…ç½®" class="headerlink" title="å…¨å±€é…ç½®"></a>å…¨å±€é…ç½®</h2><p>åœ¨æ‰§è¡Œç±»ä¼¼ï¼š<code>npm install express [-g]</code> ï¼ˆåé¢çš„å¯é€‰å‚æ•°<code>-g</code>ï¼Œ<code>g</code>ä»£è¡¨<code>global</code>å…¨å±€å®‰è£…çš„æ„æ€ï¼‰çš„å®‰è£…è¯­å¥æ—¶ï¼Œé»˜è®¤ä¼šå°†å®‰è£…çš„æ¨¡å—å®‰è£…åˆ°<code>C:\Users\ç”¨æˆ·å\AppData\Roaming\npm</code>è·¯å¾„ä¸­ï¼Œå ç”¨<code>C</code>ç›˜ç©ºé—´ã€‚</p><p>æˆ‘ä»¬å¸Œæœ›å°†å…¨å±€æ¨¡å—è·¯å¾„å’Œç¼“å­˜è·¯å¾„æ”¾ç½®åœ¨è‡ªå®šä¹‰ç›®å½•ï¼ˆéCç›˜ï¼‰ä¸­ã€‚è¿™é‡Œæˆ‘åœ¨<code>Node.js</code>å®‰è£…ç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹<code>node_global</code>å’Œ<code>node_cache</code>ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2020/02/15/3Ccqt2zyMBjxPVH.png" alt="node_global_cache.png"></p><p>ç©ºæ–‡ä»¶å¤¹åˆ›å»ºå®Œæˆåï¼ŒæŒ‰ä¸‹<code>win+R</code>é”®ï¼Œè¾“å…¥<code>cmd</code>ï¼Œå›è½¦ï¼Œåˆ†åˆ«è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm config set prefix &quot;E:\develop\nodejs\node_global&quot;</span><br><span class="line"></span><br><span class="line">npm config set cache &quot;E:\develop\nodejs\node_cache&quot;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><p>é¼ æ ‡å³å‡»æˆ‘çš„ç”µè„‘-&gt;å±æ€§-&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®-&gt;é«˜çº§-&gt;ç¯å¢ƒå˜é‡</p><p>åœ¨ç³»ç»Ÿå˜é‡å¤„ç‚¹å‡»æ–°å»ºï¼Œè¾“å…¥å˜é‡åï¼š<code>NODE_HOME</code>ï¼Œå˜é‡å€¼ä¸º<code>E:\develop\nodejs\node_global\node_modules</code>ï¼šä¸Šè¿°å…¨å±€é…ç½®ä¸­çš„<code>node_global</code>è·¯å¾„åå†åŠ ä¸€ä¸ª<code>node_modules</code>æ–‡ä»¶å¤¹ï¼ˆä¸ç”¨æ‰‹åŠ¨åˆ›å»ºï¼‰ï¼Œç‚¹å‡»ç¡®å®šã€‚</p><p><img src="https://i.loli.net/2020/02/15/tshAB4IbjM6FuZC.png" alt="node_home.png"></p><p>é€‰ä¸­ç”¨æˆ·å˜é‡<code>Path</code>ï¼Œç‚¹å‡»ç¼–è¾‘ï¼Œå°†é»˜è®¤çš„<code>C:\Users\ç”¨æˆ·å\AppData\Roaming\npm</code>æ”¹ä¸º<code>E:\develop\nodejs\node_global</code>ï¼šä¸Šè¿°å…¨å±€é…ç½®ä¸­çš„<code>node_global</code>ï¼Œç‚¹å‡»ç¡®å®šã€‚</p><p><img src="https://i.loli.net/2020/02/15/OfKmAPBJXRbyVsd.png" alt="user_node_path.png"></p><p>æœ€åä¸€ç›´ç¡®å®šä¸‹å»è‡³æ‰€æœ‰çª—å£å…³é—­å³å¯ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ€åï¼Œåˆ é™¤é»˜è®¤çš„<code>C:\Users\lilu\AppData\Roaming\npm</code>æ–‡ä»¶å¤¹ã€‚</p><p>è‡³æ­¤<code>Node.js</code>çš„å®‰è£…å’Œé…ç½®å°±å·²å®Œæˆï¼Œå¯ä½¿ç”¨<code>npm install -g</code>å‘½ä»¤ä¸‹è½½ä»»æ„<code>js</code>ä¾èµ–æ£€éªŒæ˜¯å¦å°†åŒ…ä¸‹è½½è‡³äº†æˆ‘ä»¬æŒ‡å®šçš„è·¯å¾„ä¸‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰è£…é…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡è£…Windows10ç³»ç»Ÿ</title>
      <link href="2020/02/07/installed/install-windows10/"/>
      <url>2020/02/07/installed/install-windows10/</url>
      
        <content type="html"><![CDATA[<ol><li><p>åˆ¶ä½œé‡è£…å¯åŠ¨<code>U</code>ç›˜ï¼Œæ¨è <a href="http://www.bigbaicai.com/">å¤§ç™½èœ</a> Uç›˜åˆ¶ä½œå·¥å…·ã€‚</p></li><li><p>ä¸‹è½½<code>win10</code>é•œåƒæ–‡ä»¶ï¼Œä¸€èˆ¬å» <a href="https://msdn.itellyou.cn/">MSDNæˆ‘å‘Šè¯‰ä½ </a> ä¸‹è½½ã€‚å¤§å®¶éƒ½æ˜¯<code>64</code>ä½çš„<code>CPU</code>ï¼Œä½ åº”è¯¥ä¸‹è½½<code>64</code>ä½ç‰ˆæœ¬çš„é•œåƒã€‚</p></li><li><p>ç™¾åº¦æœç´¢å¯¹åº”æœºå‹Uç›˜å¯åŠ¨å¿«æ·é”®ï¼Œè¿›è¡Œé‡è£…ã€‚</p></li><li><p>é‡è£…ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹ä¸­æœ‰ä¸€äº›å¯é€‰é…ç½®é¡¹ï¼Œä¸€èˆ¬éƒ½ä¸å‹¾é€‰ï¼Œæ²¡æœ‰å¿…è¦ã€‚åœ¨åˆ›å»ºç”¨æˆ·ç•Œé¢è¯·ä½¿ç”¨è„±æœºè´¦æˆ·ç™»å½•ï¼Œè„±æœºè´¦æˆ·å¯æ‰‹åŠ¨è®¾ç½®ç”¨æˆ·åã€‚ä¸è¦ä½¿ç”¨<code>outlook</code>é‚®ç®±ç™»å½•ï¼ŒåŸå› æ˜¯ä½¿ç”¨<code>outlook</code>é‚®ç®±ç™»å½•çš„è¯ï¼Œç”±äºç”¨æˆ·åè®¾ç½®è§„åˆ™ï¼Œåªä¼šå–é‚®ç®±çš„å‰äº”ä¸ªå­—ç¬¦ï¼Œä½œä¸ºå¾®è½¯ç”¨æˆ·ç»‘å®šçš„ç³»ç»Ÿç®¡ç†å‘˜ç”¨æˆ·åã€‚å¯èƒ½ä¼šé€ æˆ<code>C:\Users</code>ç›®å½•ä¸‹çš„ç”¨æˆ·åä¸æ˜¯ä½ æƒ³è¦çš„ã€‚é‡è£…å®Œæˆåå†åˆ°è®¾ç½®ä¸­ä½¿ç”¨<code>outlook</code>é‚®ç®±ç™»å½•å³å¯ã€‚è¿™æ ·ç³»ç»Ÿç”¨æˆ·åå°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„åç§°ã€‚</p></li><li><p>é‡è£…å®Œæˆåç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œä¸€äº›åŸºæœ¬è®¾ç½®ï¼Œç„¶åè¿›å…¥æ¡Œé¢ä¼šæç¤ºç­‰å¾…ç³»ç»Ÿéƒ¨ç½²å®Œæˆã€‚è¿™æ—¶ç­‰å¾…ä¸€ä¼šå³å¯ã€‚ä¸€èˆ¬ä¼šå®‰è£…ä¸€äº›ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼Œä¾‹å¦‚<code>360</code>/çˆ±å¥‡è‰º/æ·˜å®ç­‰ï¼Œå¤§å¯ä¸å¿…è§‰å¾—â€œæ¶å¿ƒâ€ï¼Œç¨åæˆ‘ä»¬ä¼šè¿›è¡Œæ¸…ç†ã€‚</p></li><li><p>ä¸€èˆ¬<code>win10</code>ç³»ç»Ÿå®‰è£…å®Œæˆåæ¡Œé¢ä¸Šæ²¡æœ‰æˆ‘çš„ç”µè„‘/æ§åˆ¶é¢æ¿ç­‰å›¾æ ‡ï¼Œåªæœ‰ä¸€ä¸ªå›æ”¶ç«™ã€‚å¯ä»¥é¼ æ ‡å³é”®ç‚¹å‡»æ¡Œé¢ç©ºç™½å¤„-&gt;ä¸ªæ€§åŒ–è®¾ç½®-&gt;ä¸»é¢˜-&gt;ç›¸å…³çš„è®¾ç½®ï¼ˆæ¡Œé¢å›¾æ ‡è®¾ç½®ï¼‰ï¼Œå‹¾é€‰è®¡ç®—æœº/æ§åˆ¶é¢æ¿ç­‰ï¼Œç‚¹å‡»ç¡®å®šå³å¯ã€‚è¿™æ—¶å‘ç°æ¡Œé¢å›¾æ ‡æ’åˆ—é¡ºåºæœ‰ç‚¹ä¸å¥½ï¼Œå¯é¼ æ ‡å³é”®ç‚¹å‡»åˆ·æ–°æ¡Œé¢ï¼Œå¦‚æœè¿˜ä¸è¡Œåˆ™é¼ æ ‡å³é”®ç‚¹å‡»æ¡Œé¢ç©ºç™½å¤„-&gt;æ’åºæ–¹å¼-&gt;åç§°ï¼Œé‡å¤ä¸¤éå³å¯ã€‚</p></li><li><p>æ¿€æ´»<code>Windows</code>ï¼Œå»ºè®®åœ¨æŸå®è´­ä¹°æ”¯æŒé‡è£…çš„æ¿€æ´»ç ï¼Œä¸€æ¬¡è´­ä¹°ï¼Œå¤šæ¬¡ä½¿ç”¨ã€‚ä¸æ¨èä½¿ç”¨ç¬¬ä¸‰æ–¹æ¿€æ´»å·¥å…·æ¿€æ´»ã€‚</p></li><li><p>å¼€å§‹æ¸…ç†ç³»ç»Ÿåˆå§‹ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼Œå¯åˆ©ç”¨è‡ªåŠ¨å®‰è£…çš„<code>360</code>è½¯ä»¶ç®¡å®¶ï¼Œå¸è½½è¿™äº›åº”ç”¨ã€‚æœ€ååœ¨å¸è½½<code>360</code>ã€‚åœ¨å¸è½½åº”ç”¨æ—¶æ³¨æ„å‹¾é€‰åˆ é™¤åœ¨æœ¬æœºä¿å­˜çš„ä¸ªäººé…ç½®æ•°æ®ç­‰ç±»ä¼¼é€‰é¡¹ã€‚</p></li><li><p>ç‚¹å‡»å¼€å§‹èœå•ï¼Œåœ¨å·¦ä¾§èœå•å’ŒåŠ¨æ€ç£è´´ä¸­ä¸€èˆ¬ä¼šæœ‰ä¸€äº›æ²¡ä»€ä¹ˆç”¨çš„<code>Windows</code>åº”ç”¨ï¼Œä¾‹å¦‚ä¸€äº›æ¸¸æˆç­‰ï¼Œå¦‚æœä¸éœ€è¦<code>office</code>ç­‰ä¹Ÿå¯ä»¥è¿›è¡Œå¸è½½ã€‚ç‚¹å‡»é¼ æ ‡å³é”®å³æœ‰å¸è½½æŒ‰é’®ã€‚</p></li><li><p>è¿™æ—¶ç³»ç»ŸåŸºæœ¬æ¸…ç†å®Œæˆï¼Œä½†è¿˜æ˜¯ä¼šæœ‰ä¸€äº›æ®‹ç•™æ–‡ä»¶å¤¹å­˜åœ¨ï¼Œè¿›å…¥<code>C:/Program Files (x86)</code>ç›®å½•ï¼Œå¦‚æœçœ‹åˆ°ä¸€äº›<code>360/tencent</code>ç­‰æ–‡ä»¶å¤¹å¯ç›´æ¥åˆ é™¤ï¼Œå¦‚æœæç¤ºæ“ä½œæ— æ³•å®Œæˆï¼Œå› ä¸ºå…¶ä¸­çš„æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶å·²åœ¨å¦ä¸€ç¨‹åºä¸­æ‰“å¼€ï¼Œåˆ™å¯å…ˆæ”¾ç€ï¼Œç­‰å°†å…¶å®ƒç±»ä¼¼æ–‡ä»¶å¤¹åˆ é™¤åï¼Œç¨åé‡å¯ç”µè„‘å³å¯åˆ é™¤ã€‚</p></li><li><p>æ‰“å¼€æˆ‘çš„ç”µè„‘ï¼Œç‚¹å‡»ä¸Šæ–¹æŸ¥çœ‹ï¼Œå‹¾é€‰æ–‡ä»¶æ‰©å±•å/éšè—çš„é¡¹ç›®ã€‚é‡å¯ç”µè„‘ï¼Œé‡å¯å®Œæˆåå³å¯åˆ é™¤ä¸Šè¿°æ‰€è¯´æ— æ³•åˆ é™¤çš„æ–‡ä»¶å¤¹ã€‚</p></li><li><p>ä¸‹é¢å¼€å§‹å®‰è£…æˆ‘ä»¬çš„ä¸ªäººè½¯ä»¶ï¼Œé¦–å…ˆå®‰è£…<code>360</code>ã€‚</p></li></ol><ul><li>ä¸ºä»€ä¹ˆå®‰è£…<code>360</code>ï¼Ÿ</li></ul><p>æœ‰äº›äººè§‰å¾—<code>360</code>æ˜¯æµæ°“è½¯ä»¶ï¼Œå½±å“ç”µè„‘è¿è¡Œé€Ÿåº¦ï¼Œä½†æˆ‘è§‰å¾—<code>360</code>æœ‰äº›åŠŸèƒ½è¿˜æ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚æ¸…ç†åƒåœ¾/ç¦æ­¢å¼€æœºå¯åŠ¨é¡¹ç­‰ã€‚</p><ul><li>ä¸ºä»€ä¹ˆå¸è½½ç³»ç»Ÿå®‰è£…å®Œæˆåè‡ªå¸¦çš„<code>360</code>ï¼Ÿ</li></ul><p>å› ä¸ºè‡ªå¸¦çš„<code>360</code>å®‰è£…åœ¨<code>C</code>ç›˜ï¼Œä¸å¥½ã€‚å» <a href="https://www.360.cn/">360å®˜ç½‘</a> ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…ã€‚åŒå‡»å®‰è£…åŒ…ï¼Œé€‰æ‹©è‡ªå®šä¹‰å®‰è£…ï¼Œé€‰æ‹©å®‰è£…è·¯å¾„ä¸ºè‡ªå®šä¹‰ç›˜ï¼ˆé<code>C</code>ç›˜ï¼‰ã€‚</p><ul><li>è¿›è¡Œæ¸…ç†ä¼˜åŒ–</li></ul><p>å®‰è£…å®Œæˆåæ‰“å¼€<code>360</code>ä¸»ç•Œé¢ï¼Œç‚¹å‡»åŠŸèƒ½å¤§å…¨-&gt;æˆ‘çš„å·¥å…·ï¼Œåˆ é™¤ä¸€äº›æ²¡ç”¨çš„è‡ªå¸¦å·¥å…·ã€‚ä¸€èˆ¬åªç•™ä¸€ä¸ªè½¯ä»¶ç®¡å®¶å³å¯ã€‚ç‚¹å‡»ç”µè„‘æ¸…ç†æ¸…ç†ç³»ç»Ÿåƒåœ¾ã€‚å‹¾é€‰ä¸€äº›ç—•è¿¹ä¿¡æ¯å’Œ<code>Cookie</code>ä¿¡æ¯ç­‰ã€‚ç‚¹å‡»ä¼˜åŒ–åŠ é€Ÿç¦ç”¨ä¸€äº›å¼€æœºå¯åŠ¨é¡¹ã€‚æ‰«æå®Œæˆåå‹¾é€‰ä¸€äº›éœ€è¦ä¼˜åŒ–çš„é¡¹ï¼Œç‚¹å‡»ç«‹å³ä¼˜åŒ–ã€‚</p><ul><li>å®‰è£…é©±åŠ¨å¤§å¸ˆæ›´æ–°é©±åŠ¨</li></ul><p>åœ¨åŠŸèƒ½å¤§å…¨ä¸­æœç´¢æ‰¾åˆ°<code>360</code>é©±åŠ¨å¤§å¸ˆï¼Œç‚¹å‡»å®‰è£…ï¼Œè¿›è¡Œç³»ç»Ÿé©±åŠ¨æ›´æ–°ã€‚é©±åŠ¨å¤§å¸ˆä¼šè‡ªåŠ¨è¿›è¡Œå¤‡ä»½ä¸‹è½½æ›´æ–°ï¼Œå¤‡ä»½çš„ç›®å½•å¯åœ¨é©±åŠ¨å¤§å¸ˆçš„è®¾ç½®ä¸­æŒ‡å®šï¼Œé»˜è®¤ä¸<code>360</code>å®‰è£…ç›®å½•åœ¨åŒä¸€ç›˜ç¬¦ä¸‹ã€‚</p><p>é©±åŠ¨æ›´æ–°å®Œæˆåé‡å¯ç”µè„‘ï¼Œé‡å¯ååˆ é™¤é©±åŠ¨å¤§å¸ˆã€‚åœ¨<code>360</code>å®‰å…¨å«å£«ä¸­-&gt;åŠŸèƒ½å¤§å…¨-&gt;æˆ‘çš„å·¥å…·ä¸­åˆ é™¤é©±åŠ¨å¤§å¸ˆï¼Œå¯é€‰æ‹©å‹¾é€‰åˆ é™¤å·²å¤‡ä»½å’Œä¸‹è½½çš„é©±åŠ¨ã€‚</p><ul><li>å®‰è£…å…¶å®ƒè½¯ä»¶ï¼ˆå¯é€‰ï¼‰<ul><li><code>360</code>å‹ç¼©ï¼šè§£å‹ç¼©è½¯ä»¶æœ‰å¾ˆå¤šé€‰æ‹©ï¼Œæ¯”å¦‚<code>WinR/7z</code>ç­‰ï¼Œè¿™é‡Œç”±äºå®‰è£…äº†<code>360</code>ï¼Œé€‰æ‹©<code>360</code>å‹ç¼©å³å¯ã€‚è¿›å…¥<code>360</code>å®‰å…¨å«å£«ä¸»ç•Œé¢-&gt;åŠŸèƒ½å¤§å…¨-&gt;æœç´¢é€‰æ‹©<code>360</code>å‹ç¼©-&gt;ç‚¹å‡»è¿›è¡Œå®‰è£…-&gt;å®‰è£…å®Œæˆåä¼šå¼¹å‡ºä¸»ç•Œé¢-&gt;ç‚¹å‡»å³ä¸Šè§’å·¥å…·-&gt;è®¾ç½®-&gt;å–æ¶ˆå‹¾é€‰å¸¸è§„ä¸­çš„å¼€å¯è‡ªåŠ¨å‡çº§/æ”¹å–„è®¡åˆ’ä¸­çš„å‚ä¸â€œ<code>360</code>ç”¨æˆ·ä½“éªŒæ”¹å–„è®¡åˆ’â€-&gt;ç¡®å®šã€‚å¯¹äºå³ä¸‹è§’å¯èƒ½å‡ºç°çš„å¼¹çª—ï¼Œè¯·ç‚¹å‡»å¼¹çª—å³ä¸Šè§’çš„<code>Ã—</code>è¿›è¡Œå…³é—­ã€‚</li><li>æœç‹—è¾“å…¥æ³•ï¼šå‰å¾€ <a href="https://pinyin.sogou.com/">æœç‹—è¾“å…¥æ³•å®˜ç½‘</a> ä¸‹è½½æœ€æ–°å®‰è£…åŒ…ï¼Œä¸‹è½½å®ŒæˆååŒå‡»è¿è¡Œ-&gt;é€‰æ‹©è‡ªå®šä¹‰å®‰è£…-&gt;é€‰æ‹©å®‰è£…ç›®å½•-&gt;ç‚¹å‡»å®‰è£…-&gt;å–æ¶ˆå‹¾é€‰å®Œæˆç•Œé¢çš„ä¸€äº›æ†ç»‘å®‰è£…çš„é€‰é¡¹ã€‚å®‰è£…å®Œæˆåè¿›è¡Œæœç‹—è¾“å…¥æ³•çš„ä¸€äº›åŸºæœ¬è®¾ç½®å³å¯ï¼Œæœç‹—è¾“å…¥æ³•æ¯å¤©ä¼šåœ¨å³ä¸‹è§’å¼¹å‡ºä¸€ä¸ªå¼¹çª—ï¼Œä¸è¦ç‚¹å‡»ä¸åœ¨æç¤ºï¼Œè¯·ç‚¹å‡»å³ä¸Šè§’çš„<code>Ã—</code>ï¼Œä¸ç„¶ä¼šä¸‹è½½æœç‹—æµè§ˆå™¨ã€‚</li><li>æœ‰é“äº‘ç¬”è®°ï¼šå‰å¾€ <a href="http://note.youdao.com/">æœ‰é“äº‘ç¬”è®°å®˜ç½‘</a> ä¸‹è½½æœ€æ–°å®‰è£…åŒ…-&gt;åŒå‡»è¿è¡Œ-&gt;è‡ªå®šä¹‰å®‰è£…-&gt;æŒ‡å®šå®‰è£…ç›®å½•-&gt;å–æ¶ˆå‹¾é€‰æœ‰é“ç¿»è¯‘å®‰è£…ã€‚å®‰è£…å®Œæˆåè¿›è¡Œç™»å½•ï¼Œç™»å½•åç‚¹å‡»å³ä¸Šè§’-&gt;è®¾ç½®ï¼Œå–æ¶ˆå‹¾é€‰å¯åŠ¨<code>windows</code>æ—¶å¯åŠ¨æœ‰é“äº‘ç¬”è®°/è‡ªåŠ¨æ£€æŸ¥å®¢æˆ·ç«¯æ›´æ–°ã€‚é»˜è®¤æƒ…å†µä¸‹æœ¬åœ°æ–‡ä»¶ä¼šä¿å­˜åœ¨<code>C:\Users\ç”¨æˆ·å\AppData\Local\YNote</code>ç›¸å…³ç›®å½•ä¸‹ï¼Œåœ¨å®‰è£…æ—¶æŒ‡å®šå¯èƒ½æ²¡æœ‰æ•ˆæœã€‚å¦‚æœæƒ³è®©æœ¬åœ°æ–‡ä»¶ä¸ä¿å­˜åœ¨<code>C</code>ç›˜å¯åœ¨è®¾ç½®ä¸­è¿›è¡ŒæŒ‡å®šï¼Œæœ‰é“äº‘ç¬”è®°ä¼šè‡ªåŠ¨è¿›è¡Œæ•°æ®è¿ç§»ã€‚</li><li>ç™¾åº¦ç½‘ç›˜ï¼šå‰å¾€ <a href="https://pan.baidu.com/">ç™¾åº¦äº‘ç½‘ç›˜å®˜ç½‘</a> ä¸‹è½½æœ€æ–°å®‰è£…åŒ…-&gt;åŒå‡»è¿è¡Œ-&gt;è‡ªå®šä¹‰å®‰è£…-&gt;æŒ‡å®šå®‰è£…ç›®å½•-&gt;å®Œæˆåç™»å½•-&gt;è¿›å…¥ä¸»ç•Œé¢åç‚¹å‡»å³ä¸Šè§’è®¾ç½®-&gt;å–æ¶ˆå‹¾é€‰å¼€æœºæ—¶å¯åŠ¨ç™¾åº¦ç½‘ç›˜(æ¨è)ã€‚</li></ul></li></ul><p>è‡³æ­¤ï¼Œç”µè„‘é‡è£…ç³»ç»ŸåŸºæœ¬å®Œæˆï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œåº”ç”¨è½¯ä»¶å®‰è£…äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰è£…é…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows10 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºæœ¬æ•°æ®ç±»å‹charä¸ºä»€ä¹ˆä¸ä¼šè¢«éšå¼è½¬æ¢æˆbyteæˆ–shortç±»å‹ï¼Ÿ</title>
      <link href="2020/01/09/javase/base/why-char-cannot-be-converted-to-byte-or-short/"/>
      <url>2020/01/09/javase/base/why-char-cannot-be-converted-to-byte-or-short/</url>
      
        <content type="html"><![CDATA[<p>Javaçš„åŸºæœ¬æ•°æ®ç±»å‹ä¸­çš„æ•°å€¼ç±»å‹åŒ…æ‹¬ï¼šbyte/char/short/int/float/double/long</p><p>å…¶æ•°å€¼èŒƒå›´å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>åŸºæœ¬ç±»å‹</th><th align="center">å¤§å°</th><th align="left">èŒƒå›´</th></tr></thead><tbody><tr><td>byte</td><td align="center">8 bits</td><td align="left">[-128, +127]</td></tr><tr><td>char</td><td align="center">16 bits</td><td align="left">[â€˜\u0000â€™, â€˜\uFFFFâ€™] å³ [0, 2^16 - 1]</td></tr><tr><td>short</td><td align="center">16 bits</td><td align="left">[-2^15, +2^15 - 1]</td></tr><tr><td>int</td><td align="center">32 bits</td><td align="left">[-2^31, +2^31 - 1]</td></tr><tr><td>float</td><td align="center">32 bits</td><td align="left">IEEE754èŒƒå›´</td></tr><tr><td>double</td><td align="center">64 bits</td><td align="left">IEEE754èŒƒå›´</td></tr><tr><td>long</td><td align="center">64 bits</td><td align="left">[-2^63, +2^63 - 1]</td></tr></tbody></table><p>æ³¨ï¼šè¡¨æ ¼ä¸­çš„ â€˜[â€˜ å’Œ â€˜]â€™ è¡¨ç¤ºé—­åŒºé—´ï¼›IEEE754èŒƒå›´å‚è€ƒ<a href="https://en.wikipedia.org/wiki/IEEE_754-1985">wiki</a></p><p>charç±»å‹çš„è¡¨ç¤ºèŒƒå›´å¯é€šè¿‡ä»¥ä¸‹ä»£ç æŸ¥çœ‹ï¼š0-65535</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(Character.MIN_VALUE + 1 - 1);</span><br><span class="line">System.out.println(Character.MAX_VALUE + 1 - 1);</span><br></pre></td></tr></table></figure><p>byteç±»å‹åªå ä¸€ä¸ªå­—èŠ‚ï¼ˆ8æ¯”ç‰¹ï¼‰ï¼Œè€Œcharå’Œshortéƒ½å ä¸¤ä¸ªå­—èŠ‚ã€‚charè½¬æˆbyteä¼šå‡ºç°è£…ä¸ä¸‹çš„æƒ…å†µï¼Œç²¾åº¦ä¸¢å¤±ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨è¿›è¡Œéšå¼è½¬æ¢ï¼›</p><p>shortç±»å‹è™½ç„¶å ä¸¤ä¸ªå­—èŠ‚ï¼Œä½†å…¶æœ€å¤§å€¼æ˜¯2^15-1ï¼Œcharçš„æœ€å¤§å€¼æ˜¯2^16-1ï¼Œä¼šå‡ºç°è½¬æ¢ä¸äº†çš„æƒ…å†µï¼Œæ‰€ä»¥ç¼–è¯‘å™¨ä¹Ÿä¸ä¼šè¿›è¡Œéšå¼è½¬æ¢ã€‚</p><p>intç±»å‹æ˜¯ç¬¬ä¸€ä¸ªæ•°å€¼èŒƒå›´æ¯”charå¤§çš„ç±»å‹ï¼Œæ‰€ä»¥åœ¨æ¶‰åŠåˆ°éšå¼è½¬æ¢æ—¶ï¼ŒJavaé»˜è®¤å°†charéšå¼è½¬æ¢æˆintã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java SE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšå¼è½¬æ¢ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–¹æ³•é‡è½½Overload</title>
      <link href="2020/01/09/javase/base/method-overload/"/>
      <url>2020/01/09/javase/base/method-overload/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œç›¸åŒçš„è¯å¯ä»¥è¡¨è¾¾å¤šç§ä¸åŒçš„å«ä¹‰â€”â€”å®ƒä»¬è¢«â€œé‡è½½äº†â€ã€‚ä¾‹å¦‚ï¼šâ€œå†¬å¤©èƒ½ç©¿å¤šå°‘ç©¿å¤šå°‘ã€‚å¤å¤©èƒ½ç©¿å¤šå°‘ç©¿å¤šå°‘ã€‚â€ã€â€œä¸­å›½è¶³çƒè°ä¹Ÿæ‰“ä¸è¿‡ã€‚ä¸­å›½ä¹’ä¹“çƒè°ä¹Ÿæ‰“ä¸è¿‡ã€‚â€ã€‚ç›¸åŒçš„åå­—ä½†è¡¨è¾¾å‡ºäº†ä¸åŒçš„å«ä¹‰ï¼Œè¿™å°±æ˜¯æ–¹æ³•é‡è½½ã€‚</p><h2 id="æ„é€ å™¨é‡è½½"><a href="#æ„é€ å™¨é‡è½½" class="headerlink" title="æ„é€ å™¨é‡è½½"></a>æ„é€ å™¨é‡è½½</h2><p>æˆ‘ä»¬çŸ¥é“ç±»çš„æ„é€ å™¨åå­—å¿…é¡»ä¸ç±»åå®Œå…¨ç›¸åŒï¼Œä¸æ¥å—ä»»ä½•å‚æ•°çš„æ„é€ å™¨å«åšé»˜è®¤æ„é€ å™¨ï¼ŒåŒå…¶å®ƒæ–¹æ³•ä¸€æ ·ï¼Œæ„é€ å™¨ä¹Ÿèƒ½å¸¦æœ‰å½¢å¼å‚æ•°ï¼Œä»¥ä¾¿æŒ‡å®šå¦‚ä½•åˆ›å»ºå¯¹è±¡ã€‚è¿™é‡Œå°±ä½“ç°äº†æ–¹æ³•é‡è½½ï¼Œå®ƒä»¬éƒ½æœ‰ç›¸åŒçš„åå­—ï¼Œå³ç±»åï¼Œä½†å½¢å¼å‚æ•°ä¸åŒã€‚</p><h2 id="åŒºåˆ†æ–¹æ³•é‡è½½"><a href="#åŒºåˆ†æ–¹æ³•é‡è½½" class="headerlink" title="åŒºåˆ†æ–¹æ³•é‡è½½"></a>åŒºåˆ†æ–¹æ³•é‡è½½</h2><p>å¦‚æœæœ‰å‡ ä¸ªåå­—ç›¸åŒçš„æ–¹æ³•ï¼ŒJavaå¦‚ä½•è¿›è¡ŒåŒºåˆ†å‘¢ï¼Ÿ</p><p>è¯·è®°ä½æ–¹æ³•é‡è½½çš„æ¦‚å¿µï¼šæ–¹æ³•åç›¸åŒï¼Œä½†å½¢å‚åˆ—è¡¨ä¸åŒã€‚</p><p>å³ä½¿å½¢å‚é¡ºåºä¸åŒä¹Ÿè¶³ä»¥åŒºåˆ†ä¸¤ä¸ªæ–¹æ³•ã€‚ä½†æ˜¯æœ€å¥½åˆ«è¿™æ ·åšï¼Œç»†æƒ³ä¸€ä¸‹ï¼Œå¦‚æœåªæ˜¯å‚æ•°é¡ºåºä¸åŒï¼Œæœ‰ä»€ä¹ˆå®é™…çš„æ„ä¹‰å‘¢ï¼Ÿè¿™æ ·çš„é‡è½½ä¹Ÿä¼šè®©ä»£ç éš¾ä»¥ç¢ç£¨ã€‚</p><h2 id="åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½"><a href="#åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½"></a>åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½</h2><h3 id="ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å°äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´"><a href="#ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å°äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´" class="headerlink" title="ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å°äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´"></a>ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å°äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´</h3><p>æˆ‘ä»¬çŸ¥é“Javaä¸­æœ‰è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆéšå¼è½¬æ¢ï¼‰çš„æ¦‚å¿µï¼ŒåŸºæœ¬æ•°æ®ç±»å‹èƒ½ä»ä¸€ä¸ªèŒƒå›´â€œè¾ƒå°â€çš„ç±»å‹è‡ªåŠ¨è½¬æ¢è‡³ä¸€ä¸ªèŒƒå›´â€œè¾ƒå¤§â€çš„ç±»å‹ï¼Œæ­¤è¿‡ç¨‹ä¸€æ—¦æ¶‰åŠåˆ°æ–¹æ³•é‡è½½ï¼Œå¯èƒ½ä¼šé€ æˆä¸€äº›æ··æ·†ã€‚</p><p>æˆ‘ä»¬æ¥è¿›è¡Œä¸€äº›æµ‹è¯•ã€‚</p><p>foo1æ–¹æ³•åŒ…å«char/byte/short/int/long/float/doubleè¿™7ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo2æ–¹æ³•åŒ…å«byte/short/int/long/float/doubleè¿™6ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo3æ–¹æ³•åŒ…å«short/int/long/float/doubleè¿™5ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo4æ–¹æ³•åŒ…å«int/long/float/doubleè¿™4ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo5æ–¹æ³•åŒ…å«long/float/doubleè¿™3ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo6æ–¹æ³•åŒ…å«float/doubleè¿™2ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo7æ–¹æ³•åªæœ‰ä¸€ä¸ªdoubleç±»å‹å‚æ•°çš„æ–¹æ³•ï¼›</p><p>åˆ†åˆ«ä½¿ç”¨å¸¸é‡å€¼6ã€charç±»å‹çš„â€™xâ€™ã€byteç±»å‹çš„1ã€shortç±»å‹çš„1ã€intç±»å‹çš„1ã€longç±»å‹çš„1ã€floatç±»å‹çš„1å’Œdoubleç±»å‹çš„1åˆ†åˆ«è°ƒç”¨fooç³»åˆ—çš„æ–¹æ³•ï¼Œè§‚å¯Ÿè¾“å‡ºç»“æœã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.overload;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/1/8</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span></span></span><br><span class="line"><span class="comment"> * åŸºæœ¬æ•°æ®ç±»å‹é‡è½½çš„æµ‹è¯•ï¼šåŸºæœ¬æ•°æ®ç±»å‹èŒƒå›´è¾ƒå°çš„ä¼šè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆéšå¼è½¬æ¢ï¼‰æˆèŒƒå›´è¾ƒå¤§çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆé™¤å»booleanï¼‰èŒƒå›´å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment"> * &#x27;[&#x27; å’Œ &#x27;]&#x27; è¡¨ç¤ºé—­åŒºé—´ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * byte   |  8 bits | [-128, +127]</span></span><br><span class="line"><span class="comment"> * char   | 16 bits | [&#x27;\u0000&#x27;, &#x27;\uFFFF&#x27;]</span></span><br><span class="line"><span class="comment"> * short  | 16 bits | [-2^15, +2^15 - 1]</span></span><br><span class="line"><span class="comment"> * int    | 32 bits | [-2^31, +2^31 - 1]</span></span><br><span class="line"><span class="comment"> * float  | 32 bits | IEEE754èŒƒå›´</span></span><br><span class="line"><span class="comment"> * double | 64 bits | IEEE754èŒƒå›´</span></span><br><span class="line"><span class="comment"> * long   | 64 bits | [-2^63, +2^63 - 1]</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SmallToBigDataTypeOverloadTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * const: 6</span></span><br><span class="line"><span class="comment">     * foo1(int x)</span></span><br><span class="line"><span class="comment">     * foo2(int x)</span></span><br><span class="line"><span class="comment">     * foo3(int x)</span></span><br><span class="line"><span class="comment">     * foo4(int x)</span></span><br><span class="line"><span class="comment">     * foo5(long x)</span></span><br><span class="line"><span class="comment">     * foo6(float x)</span></span><br><span class="line"><span class="comment">     * foo7(double x)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * å¸¸é‡å€¼6è¢«å½“åšintå€¼è¿›è¡Œå¤„ç†ã€‚å¦‚æœæ²¡æœ‰intç±»å‹çš„é‡è½½æ–¹æ³•ï¼Œåˆ™è‡ªåŠ¨ç±»å‹è½¬æ¢æˆâ€œè¾ƒå¤§â€çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testConstValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;const: 6&quot;</span>);</span><br><span class="line">        foo1(<span class="number">6</span>);</span><br><span class="line">        foo2(<span class="number">6</span>);</span><br><span class="line">        foo3(<span class="number">6</span>);</span><br><span class="line">        foo4(<span class="number">6</span>);</span><br><span class="line">        foo5(<span class="number">6</span>);</span><br><span class="line">        foo6(<span class="number">6</span>);</span><br><span class="line">        foo7(<span class="number">6</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * char: x</span></span><br><span class="line"><span class="comment">     * foo1(char x)</span></span><br><span class="line"><span class="comment">     * foo2(int x)</span></span><br><span class="line"><span class="comment">     * foo3(int x)</span></span><br><span class="line"><span class="comment">     * foo4(int x)</span></span><br><span class="line"><span class="comment">     * foo5(long x)</span></span><br><span class="line"><span class="comment">     * foo6(float x)</span></span><br><span class="line"><span class="comment">     * foo7(double x)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * é™¤foo1å¤–ï¼Œcharç±»å‹çš„&#x27;x&#x27;è¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">     * åœ¨foo2ã€foo3å’Œfoo4ä¸­ï¼Œcharç±»å‹è¢«ç›´æ¥è½¬æ¢æˆäº†intç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testChar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;char: &quot;</span> + c);</span><br><span class="line">        foo1(c);</span><br><span class="line">        foo2(c);</span><br><span class="line">        foo3(c);</span><br><span class="line">        foo4(c);</span><br><span class="line">        foo5(c);</span><br><span class="line">        foo6(c);</span><br><span class="line">        foo7(c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * byte: 1</span></span><br><span class="line"><span class="comment">     * foo1(byte x)</span></span><br><span class="line"><span class="comment">     * foo2(byte x)</span></span><br><span class="line"><span class="comment">     * foo3(short x)</span></span><br><span class="line"><span class="comment">     * foo4(int x)</span></span><br><span class="line"><span class="comment">     * foo5(long x)</span></span><br><span class="line"><span class="comment">     * foo6(float x)</span></span><br><span class="line"><span class="comment">     * foo7(double x)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * é™¤foo1å’Œfoo2å¤–ï¼Œbyteç±»å‹çš„1è¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testByte</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span> b = <span class="number">1</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;byte: &quot;</span> + b);</span><br><span class="line">        foo1(b);</span><br><span class="line">        foo2(b);</span><br><span class="line">        foo3(b);</span><br><span class="line">        foo4(b);</span><br><span class="line">        foo5(b);</span><br><span class="line">        foo6(b);</span><br><span class="line">        foo7(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * short: 1</span></span><br><span class="line"><span class="comment">     * foo1(short x)</span></span><br><span class="line"><span class="comment">     * foo2(short x)</span></span><br><span class="line"><span class="comment">     * foo3(short x)</span></span><br><span class="line"><span class="comment">     * foo4(int x)</span></span><br><span class="line"><span class="comment">     * foo5(long x)</span></span><br><span class="line"><span class="comment">     * foo6(float x)</span></span><br><span class="line"><span class="comment">     * foo7(double x)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * é™¤foo1ã€foo2å’Œfoo3å¤–ï¼Œshortç±»å‹çš„1è¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testShort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">short</span> s = <span class="number">1</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;short: &quot;</span> + s);</span><br><span class="line">        foo1(s);</span><br><span class="line">        foo2(s);</span><br><span class="line">        foo3(s);</span><br><span class="line">        foo4(s);</span><br><span class="line">        foo5(s);</span><br><span class="line">        foo6(s);</span><br><span class="line">        foo7(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * int: 1</span></span><br><span class="line"><span class="comment">     * foo1(int x)</span></span><br><span class="line"><span class="comment">     * foo2(int x)</span></span><br><span class="line"><span class="comment">     * foo3(int x)</span></span><br><span class="line"><span class="comment">     * foo4(int x)</span></span><br><span class="line"><span class="comment">     * foo5(long x)</span></span><br><span class="line"><span class="comment">     * foo6(float x)</span></span><br><span class="line"><span class="comment">     * foo7(double x)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * foo5ã€foo6å’Œfoo7æ–¹æ³•ï¼Œintç±»å‹çš„1éƒ½è¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;int: &quot;</span> + i);</span><br><span class="line">        foo1(i);</span><br><span class="line">        foo2(i);</span><br><span class="line">        foo3(i);</span><br><span class="line">        foo4(i);</span><br><span class="line">        foo5(i);</span><br><span class="line">        foo6(i);</span><br><span class="line">        foo7(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * long: 1</span></span><br><span class="line"><span class="comment">     * foo1(long x)</span></span><br><span class="line"><span class="comment">     * foo2(long x)</span></span><br><span class="line"><span class="comment">     * foo3(long x)</span></span><br><span class="line"><span class="comment">     * foo4(long x)</span></span><br><span class="line"><span class="comment">     * foo5(long x)</span></span><br><span class="line"><span class="comment">     * foo6(float x)</span></span><br><span class="line"><span class="comment">     * foo7(double x)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * foo6å’Œfoo7æ–¹æ³•ï¼Œlongç±»å‹çš„1Lè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLong</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> l = <span class="number">1L</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;long: &quot;</span> + l);</span><br><span class="line">        foo1(l);</span><br><span class="line">        foo2(l);</span><br><span class="line">        foo3(l);</span><br><span class="line">        foo4(l);</span><br><span class="line">        foo5(l);</span><br><span class="line">        foo6(l);</span><br><span class="line">        foo7(l);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * float: 1.0</span></span><br><span class="line"><span class="comment">     * foo1(float x)</span></span><br><span class="line"><span class="comment">     * foo2(float x)</span></span><br><span class="line"><span class="comment">     * foo3(float x)</span></span><br><span class="line"><span class="comment">     * foo4(float x)</span></span><br><span class="line"><span class="comment">     * foo5(float x)</span></span><br><span class="line"><span class="comment">     * foo6(float x)</span></span><br><span class="line"><span class="comment">     * foo7(double x)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * foo7æ–¹æ³•ä¸­ï¼Œfloatç±»å‹çš„1Fè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFloat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">float</span> f = <span class="number">1F</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;float: &quot;</span> + f);</span><br><span class="line">        foo1(f);</span><br><span class="line">        foo2(f);</span><br><span class="line">        foo3(f);</span><br><span class="line">        foo4(f);</span><br><span class="line">        foo5(f);</span><br><span class="line">        foo6(f);</span><br><span class="line">        foo7(f);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * double: 1.0</span></span><br><span class="line"><span class="comment">     * foo1(double x)</span></span><br><span class="line"><span class="comment">     * foo2(double x)</span></span><br><span class="line"><span class="comment">     * foo3(double x)</span></span><br><span class="line"><span class="comment">     * foo4(double x)</span></span><br><span class="line"><span class="comment">     * foo5(double x)</span></span><br><span class="line"><span class="comment">     * foo6(double x)</span></span><br><span class="line"><span class="comment">     * foo7(double x)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDouble</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> d = <span class="number">1D</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;double: &quot;</span> + d);</span><br><span class="line">        foo1(d);</span><br><span class="line">        foo2(d);</span><br><span class="line">        foo3(d);</span><br><span class="line">        foo4(d);</span><br><span class="line">        foo5(d);</span><br><span class="line">        foo6(d);</span><br><span class="line">        foo7(d);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo1 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(char x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">byte</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(byte x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(short x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(int x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(long x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(float x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(double x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo2 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">byte</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(byte x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(short x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(int x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(long x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(float x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(double x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo3 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(short x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(int x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(long x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(float x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(double x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo4 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo4</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo4(int x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo4</span><span class="params">(<span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo4(long x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo4</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo4(float x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo4</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo4(double x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo5 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo5</span><span class="params">(<span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo5(long x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo5</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo5(float x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo5</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo5(double x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo6 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo6</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo6(float x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo6</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo6(double x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo7 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo7</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo7(double x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼šå‘ç°å¸¸é‡å€¼6è¢«foo1/foo2/foo3/foo4æ–¹æ³•å½“åšintå€¼è¿›è¡Œå¤„ç†ï¼Œfoo5/foo6/foo7æ²¡æœ‰intç±»å‹çš„é‡è½½æ–¹æ³•ï¼Œè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†â€œè¾ƒå¤§â€çš„ç±»å‹ï¼ˆlong/float/doubleï¼‰ã€‚</p><p>å¯¹äºcharç±»å‹çš„â€™xâ€™ï¼Œfoo1æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼Œå‰©ä½™6ç§æ–¹æ³•ä¸åŒ…å«charç±»å‹çš„é‡è½½ï¼Œä½†foo2/foo3/foo4ç›´æ¥å°†charç±»å‹è‡ªåŠ¨ç±»å‹è½¬æ¢æˆäº†intç±»å‹ã€‚foo5/foo6/foo7åˆ†åˆ«å°†charç±»å‹éšå¼è½¬æ¢æˆäº†long/float/doubleç±»å‹ã€‚</p><blockquote><p>charç±»å‹æ˜¯ä¸ä¼šè¢«è‡ªåŠ¨ç±»å‹è½¬æ¢æˆbyte/shortç±»å‹çš„ã€‚å…¶åŸå› å¯æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="/2020/01/09/javase/base/why-char-cannot-be-converted-to-byte-or-short/">ä¼ é€é—¨</a></p></blockquote><p>å¯¹äºbyteç±»å‹çš„1ï¼Œfoo1/foo2æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼›å‰©ä½™5ç§æ–¹æ³•ä¸åŒ…å«charç±»å‹çš„é‡è½½ï¼Œè¢«åˆ†åˆ«éšå¼è½¬æ¢æˆäº†short/int/long/float/doubleç±»å‹ã€‚</p><p>å¯¹äºshortç±»å‹çš„1ï¼Œfoo1/foo2/foo3æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼›å‰©ä½™4ç§æ–¹æ³•ä¸åŒ…å«shortç±»å‹çš„é‡è½½ï¼Œè¢«åˆ†åˆ«éšå¼è½¬æ¢æˆäº†int/long/float/doubleç±»å‹ã€‚</p><p>å¯¹äºintç±»å‹çš„1ï¼Œfoo1/foo2/foo3/foo4æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼›foo5/foo6/foo7ä¸åŒ…å«intç±»å‹çš„é‡è½½ï¼Œè¢«åˆ†åˆ«éšå¼è½¬æ¢æˆäº†long/float/doubleç±»å‹ã€‚</p><p>å¯¹äºlongç±»å‹çš„1ï¼Œfoo1/foo2/foo3/foo4/foo5æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ï¼›foo6/foo7ä¸åŒ…å«longç±»å‹çš„é‡è½½ï¼Œè¢«åˆ†åˆ«éšå¼è½¬æ¢æˆäº†float/doubleç±»å‹ã€‚</p><p>å¯¹åº”floatç±»å‹çš„1ï¼Œfoo7ä¸åŒ…å«floatç±»å‹çš„é‡è½½ï¼Œè¢«éšå¼è½¬æ¢æˆäº†doubleç±»å‹ï¼›è€Œå…¶å®ƒ6ç§æ–¹æ³•åŒ…å«å¯¹åº”ç±»å‹çš„é‡è½½ã€‚</p><p>å¯¹äºdoubleç±»å‹çš„1,7ç§æ–¹æ³•éƒ½æœ‰å¯¹åº”ç±»å‹çš„é‡è½½ã€‚</p><p>æ•°å€¼åŸºæœ¬ç±»å‹éšå¼è½¬æ¢å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/02/15/OeS472iBMyCUz9n.png" alt="basic-data-type-conversion.png"></p><p>å®çº¿ç®­å¤´æ— ç²¾åº¦ä¸¢å¤±ï¼Œè™šçº¿ç®­å¤´å¯èƒ½ä¸¢å¤±ç²¾åº¦ã€‚</p><h3 id="ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å¤§äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´"><a href="#ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å¤§äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´" class="headerlink" title="ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å¤§äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´"></a>ä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å¤§äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°èŒƒå›´</h3><p>åè¿‡æ¥ï¼Œå¦‚æœä¼ å…¥çš„å®é™…å‚æ•°èŒƒå›´å¤§äºé‡è½½æ–¹æ³•å£°æ˜çš„å½¢å¼å‚æ•°ï¼Œä¼šæ˜¯ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿæˆ‘ä»¬å†æ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p><p>foo1æ–¹æ³•åŒ…å«char/byte/short/int/long/float/doubleè¿™7ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo2æ–¹æ³•åŒ…å«char/byte/short/int/long/floatè¿™6ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo3æ–¹æ³•åŒ…å«char/byte/short/int/longè¿™5ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo4æ–¹æ³•åŒ…å«char/byte/short/intè¿™4ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo5æ–¹æ³•åŒ…å«char/byte/shortè¿™3ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo6æ–¹æ³•åŒ…å«char/byteè¿™2ç§åŸºæœ¬æ•°æ®ç±»å‹çš„é‡è½½ï¼›</p><p>foo7æ–¹æ³•åªæœ‰ä¸€ä¸ªcharç±»å‹å‚æ•°çš„æ–¹æ³•ï¼›</p><p>ä½¿ç”¨doubleç±»å‹çš„3.1415926åˆ†åˆ«è°ƒç”¨fooç³»åˆ—çš„æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¼–è¯‘å™¨æç¤ºäº†é”™è¯¯ï¼š<code>Cannot resolve method &#39;foo2(double)&#39;</code>ç­‰ã€‚é™¤äº†foo1æ–¹æ³•å¤–ï¼Œå…¶ä½™fooç³»åˆ—çš„æ–¹æ³•éƒ½ä¸åŒ…å«doubleç±»å‹çš„é‡è½½ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šéšå¼å°†doubleç±»å‹è‡ªåŠ¨è½¬æ¢æˆå…¶å®ƒåŸºæœ¬ç±»å‹ï¼Œå…¶åŸå› åœ¨äºdoubleç±»å‹çš„å–å€¼èŒƒå›´ï¼ˆäºŒè¿›åˆ¶ä½æ•°ï¼‰æ˜¯æœ€å¤§çš„ï¼Œå¦‚æœå°†doubleç±»å‹çš„æ•°æ®éšå¼è½¬æ¢æˆå…¶å®ƒåŸºæœ¬ç±»å‹ï¼Œå¯èƒ½ä¼šå‡ºç°ç²¾åº¦ä¸¢å¤±çš„é—®é¢˜ï¼Œè¿™æ˜¯æœ‰é£é™©çš„ï¼Œç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åšã€‚</p><p>æˆ‘ä»¬éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆæ˜¾å¼è½¬æ¢ï¼‰è¿›è¡Œçª„åŒ–å¤„ç†ï¼Œè¿™æ ·åšå¯èƒ½ä¼šä¸¢å¤±ç²¾åº¦ã€‚ä½†å¦‚æœä¸è¿™æ ·åšï¼Œæˆ‘ä»¬æ— æ³•æ­£å¸¸è¿›è¡Œæ–¹æ³•çš„è°ƒç”¨ã€‚</p><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.javase.base.overload;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/1/8</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span></span></span><br><span class="line"><span class="comment"> * åŸºæœ¬æ•°æ®ç±»å‹é‡è½½çš„æµ‹è¯•ï¼šåŸºæœ¬æ•°æ®ç±»å‹èŒƒå›´è¾ƒå¤§çš„éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆæ˜¾å¼è½¬æ¢ï¼‰è¿›è¡Œçª„åŒ–å¤„ç†ï¼Œè½¬æ¢æˆèŒƒå›´è¾ƒå°çš„ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆé™¤å»booleanï¼‰èŒƒå›´å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment"> * &#x27;[&#x27; å’Œ &#x27;]&#x27; è¡¨ç¤ºé—­åŒºé—´ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * byte   |  8 bits | [-128, +127]</span></span><br><span class="line"><span class="comment"> * char   | 16 bits | [&#x27;\u0000&#x27;, &#x27;\uFFFF&#x27;]</span></span><br><span class="line"><span class="comment"> * short  | 16 bits | [-2^15, +2^15 - 1]</span></span><br><span class="line"><span class="comment"> * int    | 32 bits | [-2^31, +2^31 - 1]</span></span><br><span class="line"><span class="comment"> * float  | 32 bits | IEEE754èŒƒå›´</span></span><br><span class="line"><span class="comment"> * double | 64 bits | IEEE754èŒƒå›´</span></span><br><span class="line"><span class="comment"> * long   | 64 bits | [-2^63, +2^63 - 1]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BigToSmallDataTypeOverloadTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * double: 3.1415926</span></span><br><span class="line"><span class="comment">     * foo1(double x)</span></span><br><span class="line"><span class="comment">     * foo2(float x)</span></span><br><span class="line"><span class="comment">     * foo3(long x)</span></span><br><span class="line"><span class="comment">     * foo4(int x)</span></span><br><span class="line"><span class="comment">     * foo5(short x)</span></span><br><span class="line"><span class="comment">     * foo6(byte x)</span></span><br><span class="line"><span class="comment">     * foo7(char x)</span></span><br><span class="line"><span class="comment">     * (float) dï¼š3.1415925  // å¯çœ‹åˆ°ç²¾åº¦å·²ç»ä¸¢å¤±</span></span><br><span class="line"><span class="comment">     * (long) dï¼š3</span></span><br><span class="line"><span class="comment">     * (int) dï¼š3</span></span><br><span class="line"><span class="comment">     * (short) dï¼š3</span></span><br><span class="line"><span class="comment">     * (byte) dï¼š3</span></span><br><span class="line"><span class="comment">     * (char) dï¼š3</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDouble</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> d = <span class="number">3.1415926</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;double: &quot;</span> + d);</span><br><span class="line">        foo1(d);</span><br><span class="line">        foo2((<span class="keyword">float</span>) d);</span><br><span class="line">        foo3((<span class="keyword">long</span>) d);</span><br><span class="line">        foo4((<span class="keyword">int</span>) d);</span><br><span class="line">        foo5((<span class="keyword">short</span>) d);</span><br><span class="line">        foo6((<span class="keyword">byte</span>) d);</span><br><span class="line">        foo7((<span class="keyword">char</span>) d);</span><br><span class="line">        <span class="keyword">float</span> f = (<span class="keyword">float</span>) d;</span><br><span class="line">        System.out.println(<span class="string">&quot;(float) dï¼š&quot;</span> + f);</span><br><span class="line">        <span class="keyword">long</span> l = (<span class="keyword">long</span>) d;</span><br><span class="line">        System.out.println(<span class="string">&quot;(long) dï¼š&quot;</span> + l);</span><br><span class="line">        <span class="keyword">int</span> i = (<span class="keyword">int</span>) d;</span><br><span class="line">        System.out.println(<span class="string">&quot;(int) dï¼š&quot;</span> + i);</span><br><span class="line">        <span class="keyword">short</span> s = (<span class="keyword">short</span>) d;</span><br><span class="line">        System.out.println(<span class="string">&quot;(short) dï¼š&quot;</span> + s);</span><br><span class="line">        <span class="keyword">byte</span> b = (<span class="keyword">byte</span>) d;</span><br><span class="line">        System.out.println(<span class="string">&quot;(byte) dï¼š&quot;</span> + b);</span><br><span class="line">        <span class="keyword">char</span> c = (<span class="keyword">char</span>) d;</span><br><span class="line">        System.out.println(<span class="string">&quot;(char) dï¼š&quot;</span> + (c + <span class="number">1</span> - <span class="number">1</span>)); <span class="comment">// æŸ¥çœ‹charè¡¨ç¤ºçš„æ•°å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo1 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(char x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">byte</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(byte x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(short x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(int x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(long x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(float x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo1(double x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo2 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(char x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">byte</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(byte x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(short x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(int x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(long x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo2(float x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo3 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(char x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">byte</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(byte x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(short x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(int x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo3</span><span class="params">(<span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo3(long x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo4 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo4</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo4(char x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo4</span><span class="params">(<span class="keyword">byte</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo4(byte x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo4</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo4(short x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo4</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo4(int x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo5 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo5</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo5(char x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo5</span><span class="params">(<span class="keyword">byte</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo5(byte x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo5</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo5(short x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo6 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo6</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo6(char x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo6</span><span class="params">(<span class="keyword">byte</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo6(byte x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*==========================foo7 Overload===========================*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo7</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;foo7(char x)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»è¾“å‡ºç»“æœä¸­å¯çœ‹åˆ°ï¼šdoubleç±»å‹çš„3.1415926å¼ºåˆ¶è½¬æ¢æˆfloatæ—¶å˜æˆäº†3.1415925ï¼Œç²¾åº¦å·²ç»ä¸¢å¤±ï¼›è€Œå¼ºåˆ¶è½¬æ¢æˆlong/int/short/byte/charæ—¶æµ®ç‚¹éƒ¨åˆ†ç›´æ¥è¢«èˆå¼ƒã€‚</p><h2 id="è¿”å›å€¼èƒ½åŒºåˆ†é‡è½½æ–¹æ³•å—ï¼Ÿ"><a href="#è¿”å›å€¼èƒ½åŒºåˆ†é‡è½½æ–¹æ³•å—ï¼Ÿ" class="headerlink" title="è¿”å›å€¼èƒ½åŒºåˆ†é‡è½½æ–¹æ³•å—ï¼Ÿ"></a>è¿”å›å€¼èƒ½åŒºåˆ†é‡è½½æ–¹æ³•å—ï¼Ÿ</h2><p>ä¾‹å¦‚æœ‰ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> -<span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬äººç”¨è‚‰çœ¼å»çœ‹æ–¹æ³•çš„å£°æ˜å¾ˆå®¹æ˜“åˆ†è¾¨è¿™ä¸¤ä¸ªåŒåæ–¹æ³•çš„ä¸åŒä¹‹å¤„ã€‚ä½†æ˜¯å½“æˆ‘ä»¬å»è°ƒç”¨fooæ–¹æ³•æ—¶ï¼Œå¦‚æœæˆ‘ä»¬çš„è°ƒç”¨æ–¹å¼æ˜¯ï¼š<code>int x = foo()</code>ï¼Œé‚£ä¹ˆçš„ç¡®å¯ä»¥æ˜ç¡®æˆ‘ä»¬è°ƒç”¨çš„æ˜¯<code>int foo() &#123;return -1;&#125;</code>ï¼›ä½†æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸åœ¨æ„è¿”å›å€¼ï¼ˆåªæ˜¯è°ƒç”¨æ–¹æ³•å»æ‰§è¡ŒæŸä¸ªæ“ä½œï¼‰ï¼Œè°ƒç”¨æ–¹å¼ä¸ºï¼š<code>foo()</code>ï¼Œè¿™æ—¶å€™Javaå¦‚ä½•æ‰èƒ½åˆ¤æ–­è°ƒç”¨çš„æ˜¯å“ªä¸€ä¸ª<code>foo()</code>å‘¢ï¼Ÿç¨‹åºå‘˜åˆè¯¥å¦‚ä½•ç†è§£è¿™ç§ä»£ç å‘¢ï¼Ÿå› æ­¤ï¼Œè¿”å›å€¼æ˜¯ä¸èƒ½åŒºåˆ†æ–¹æ³•é‡è½½çš„ã€‚</p><h2 id="intå’ŒIntegerçš„å½¢å‚æ˜¯é‡è½½æ–¹æ³•å—ï¼Ÿ"><a href="#intå’ŒIntegerçš„å½¢å‚æ˜¯é‡è½½æ–¹æ³•å—ï¼Ÿ" class="headerlink" title="intå’ŒIntegerçš„å½¢å‚æ˜¯é‡è½½æ–¹æ³•å—ï¼Ÿ"></a>intå’ŒIntegerçš„å½¢å‚æ˜¯é‡è½½æ–¹æ³•å—ï¼Ÿ</h2><p>ä¾‹å¦‚æœ‰ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;int&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(Integer y)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Integer&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒä»¬æ˜¯é‡è½½æ–¹æ³•å—ï¼Ÿ</p><p>å³ä½¿intå’ŒIntegerä¹‹é—´å­˜åœ¨è‡ªåŠ¨è£…ç®±/æ‹†ç®±æ“ä½œï¼Œä½†å®ƒä»¬ä»æ˜¯é‡è½½çš„æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬ä¼ é€’intç±»å‹çš„å˜é‡ç»™fooï¼Œç¼–è¯‘å™¨å¹¶ä¸ä¼šè¿›è¡Œè£…ç®±æ“ä½œï¼Œå› ä¸ºæœ‰å¯¹åº”çš„intç±»å‹é‡è½½æ–¹æ³•ï¼›ç›¸åº”åœ°ï¼Œæˆ‘ä»¬ä¼ é€’Integerç±»å‹çš„å˜é‡ç»™fooï¼Œç¼–è¯‘å™¨ä¸ä¼šè¿›è¡Œæ‹†ç®±æ“ä½œï¼Œè€Œæ˜¯è°ƒç”¨å¯¹åº”Integerç±»å‹çš„é‡è½½æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬ä¼ é€’å­—é¢é‡1ç»™fooæ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šé»˜è®¤å½“æˆåŸºæœ¬ç±»å‹intè°ƒç”¨fooã€‚</p><p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * print:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * int</span></span><br><span class="line"><span class="comment"> * int</span></span><br><span class="line"><span class="comment"> * Integer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * å­—é¢é‡å€¼1æ˜¯intåŸºæœ¬æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * æ˜¯é‡è½½æ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testIntInteger</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    foo(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">1</span>;</span><br><span class="line">    foo(x);</span><br><span class="line">    Integer y = <span class="number">1</span>;</span><br><span class="line">    foo(y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯æ–¹æ³•é‡è½½Overloadçš„å…¨éƒ¨å†…å®¹ï¼Œå®Œæ•´ç¤ºä¾‹ä»£ç åœ°å€è§ï¼š<a href="https://github.com/sunchaser-lilu/gold-road-to-Java/tree/master/JavaSE/src/main/java/com/sunchaser/javase/base/overload">ä¼ é€é—¨</a></p>]]></content>
      
      
      <categories>
          
          <category> Java SE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–¹æ³•é‡è½½ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019å¹´åº¦æ€»ç»“</title>
      <link href="2019/12/31/annual-summary/2019/"/>
      <url>2019/12/31/annual-summary/2019/</url>
      
        <content type="html"><![CDATA[<p>2019æ˜¯æ—¥æ— æš‡æ™·çš„ä¸€å¹´ã€‚</p><p>ä»å¹´åˆçš„å¤§å››å‡†æ¯•ä¸šç”Ÿåˆ°ç°åœ¨åŠå¹´ç»éªŒçš„èŒåœºå°‘å¹´ï¼Œä¸€è·¯èµ°æ¥ï¼Œä»æŠ€æœ¯èœé¸Ÿåˆ°å°æœ‰æˆå°±ï¼Œä»ç¨šå«©åˆ°æ²‰ç¨³ï¼Œè¿™æ˜¯æˆé•¿çš„å°è®°ã€‚</p><p>2019å‰3ä¸ªæœˆæ˜¯è‰°éš¾çš„ã€‚çŠ¹è®°å¾—2018å¹´9æœˆç§‹æ‹›ç»å†è¿‡çš„ææƒ§ï¼Œå¤§ä¸‰æ—¶â€œå¬ä¿¡äº†â€å¤§å­¦è€å¸ˆçš„è°—è¨€ï¼šPHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ã€‚å¤§ä¸‰ä¸€æ•´å¹´éƒ½åœ¨å­¦ä¹ PHPï¼ŒæŸé©¬ç¨‹åºå‘˜å®˜ç½‘æ”¾å‡ºçš„PHPè§†é¢‘æ•™ç¨‹çœ‹äº†80%å¤šã€‚ä½†ç°å®ç»ˆç©¶æ˜¯æ®‹é…·çš„ï¼Œå›½å†…å¤§éƒ¨åˆ†ä¼ä¸šåç«¯éƒ½è¿˜æ˜¯ä»¥Javaè¯­è¨€ä¸ºä¸»ï¼ˆåˆ«è·Ÿæˆ‘è®²ç™¾åº¦ç”¨PHPï¼‰ã€‚ç§‹æ‹›çš„PHPå²—ä½å®åœ¨æ˜¯å¤ªå°‘äº†ï¼ŒåŠ ä¸Šæˆ‘åªæ˜¯ä¸€ä¸ªåŒéæ™®é€šä¸€æœ¬å­¦å†ï¼Œåˆæ²¡æœ‰ä»€ä¹ˆæ‹¿å¾—å‡ºæ‰‹çš„è·å¥–è¯ä¹¦ï¼Œæ ¹æœ¬å°±æ²¡æœ‰ä¸€ç‚¹ç«äº‰åŠ›ã€‚äºæ˜¯ä¿®æ”¹äº†ç®€å†ï¼Œé¡¹ç›®ç»éªŒå†™ä¸Šäº†å¤§å­¦Java Webè¯¾ç¨‹è®¾è®¡å†™çš„JSP+Servleté¡¹ç›®ï¼Œå°±å¼€å§‹è½¬å‘æŠ•é€’Javaå²—ã€‚</p><p>ç»ˆäºè¿‡äº†ä¸€å®¶æ·±åœ³äº’è”ç½‘å…¬å¸çš„ç¬”è¯•ï¼Œæ¥åˆ°é¢è¯•é˜¶æ®µï¼Œè·Ÿé¢è¯•å®˜èŠäº†ä¸€ä¸‹å¤§ä¸‰å­¦PHPçš„äº‹æƒ…ï¼Œç„¶åå¼€å§‹é—®æŠ€æœ¯æ–¹é¢çš„é—®é¢˜ï¼Œç°åœ¨å›æƒ³èµ·æ¥ï¼Œå½“æ—¶çš„é—®é¢˜ç®—å¾—ä¸Šæ˜¯éå¸¸åŸºç¡€çš„çŸ¥è¯†ç‚¹äº†ã€‚ä¾‹å¦‚ï¼šintå’ŒIntegerçš„åŒºåˆ«ï¼Ÿintå’ŒIntegerä½œä¸ºåŒåæ–¹æ³•çš„å‚æ•°ï¼Œç®—ä¸ç®—é‡è½½ï¼Ÿ</p><p>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€æ¬¡Javaé¢è¯•ï¼Œé¢è¯•è¿‡ç¨‹ä¸­æ»¡æ€€ä¿¡å¿ƒè§‰å¾—è‡ªå·±éƒ½ç­”å¯¹äº†ï¼Œé¢è¯•å‡ºæ¥åæŸ¥äº†ä¸‹ç™¾åº¦ï¼Œå‘ç°å¥½åƒä¸€ä¸ªéƒ½æ²¡ç­”å¯¹ã€‚â€œç”µå­ç«æŠ€ï¼Œèœæ˜¯åŸç½ªâ€ã€‚</p><p>å½“æ—¶æ·±åˆ»è®¤è¯†åˆ°å‡­å½“æ—¶çš„è‡ªèº«æŠ€æœ¯èƒ½åŠ›æƒ³æ‰¾Javaå¼€å‘çš„å²—ä½å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œäºæ˜¯åšäº†ä¸€ä¸ªå¾ˆæœæ–­çš„å†³å®šï¼Œåœæ­¢æŠ•é€’ç®€å†ï¼Œç³»ç»Ÿå­¦ä¹ JavaçŸ¥è¯†ä½“ç³»ï¼Œç­‰å¾…æ˜¥æ‹›ã€‚</p><p>æŸåŒ—å¤§å­¦è®¡ç®—æœºå­¦é™¢çš„å­¦ç”Ÿå®¿èˆåœ¨æ ¡å¤–ï¼ˆä¿—ç§°â€œä¸‰æœŸâ€å…¬å¯“ï¼‰ï¼Œæ²¡æœ‰ç‹¬å«ï¼Œæ²¡æœ‰ç©ºè°ƒï¼Œå…­äººé—´ã€‚è‡ªå­¦æ˜¯å¾ˆè€ƒéªŒäººçš„ï¼Œé‚£ä¸ªæ—¶å€™åˆšè½¬å‘Javaï¼Œç–¯ç‹‚çš„æ‰¾å­¦ä¹ èµ„æ–™ï¼ŒæŸé©¬ç¨‹åºå‘˜ï¼ŒæŸç¡…è°·ï¼ŒæŸå­¦å ‚ï¼ŒæŸå®¢ç½‘ï¼ŒæŸå®â€¦å‡ ä¹æ‰€æœ‰çš„å…è´¹è§†é¢‘æ•™ç¨‹æˆ‘éƒ½ä¸‹è½½äº†ã€‚é¢å¯¹å‡ åä¸ªGçš„èµ„æºï¼Œæˆ‘é™·å…¥äº†è¿·èŒ«ï¼Œè¯¥ä»ä½•å­¦èµ·å‘¢ï¼Ÿ</p><p>é‚£ä¸ªæ—¶å€™æˆ‘çš„çŸ¥è¯†ä½“ç³»åŸºæœ¬æ˜¯ä¸€ç‰‡ç©ºç™½ï¼Œåªæœ‰å¤§å­¦çš„JavaåŸºç¡€è¯¾ç¨‹å’ŒJ2EEè¯¾ç¨‹å­¦çš„ä¸€ç‚¹çŸ¥è¯†å‚¨å¤‡ã€‚å¬äº†åŒå­¦çš„å»ºè®®åï¼Œå†³å®šä»æŸå®¢ç½‘é«˜çº§é¡¹ç›®è¯¾å¼€å§‹å­¦èµ·ï¼Œè·Ÿéšé¡¹ç›®éœ€æ±‚ï¼Œå¯¹é¡¹ç›®ä¸­ç”¨åˆ°çš„çŸ¥è¯†ç‚¹ï¼ŒæŠ€æœ¯æ¡†æ¶è¿›è¡Œç»†è‡´å­¦ä¹ ã€‚ç„¶è€Œä¸€åˆ‡éƒ½æ˜¯è‰°éš¾çš„ï¼Œè¿™ä¸ªé¡¹ç›®ç”¨çš„æŠ€æœ¯æ ˆä¸»è¦æ˜¯Spring Bootã€Mybatisç­‰ï¼Œå¯¹äºå½“æ—¶è¿Springéƒ½ä¸çŸ¥é“çš„æˆ‘ï¼Œå®åœ¨æ˜¯å¤ªéš¾äº†ã€‚</p><p>äºæ˜¯æˆ‘æ‰“å¼€äº†æŸé©¬ç¨‹åºå‘˜çš„Springå…¥é—¨åˆ°ç²¾é€šè§†é¢‘ï¼Œä»ä¼ ç»Ÿçš„Java Webåˆ°å¼•å…¥DI/IOCï¼Œå¤§æ¦‚èƒ½å¬æ‡‚ä¸€ç‚¹ï¼Œæˆ‘å¼€å§‹æ‰“å¼€IDEå¯¹ç€è§†é¢‘æ•²ä»£ç ï¼Œç»å¸¸ä¸€ä¸ªè§†é¢‘é‡å¤æ’­æ”¾ä¸‰éç”šè‡³æ›´å¤šï¼Œç¬¬ä¸€éæ˜¯å¬å¤§æ¦‚çš„å†…å®¹ï¼Œç¬¬äºŒéæ˜¯ç»†å¬ï¼Œç„¶åè·Ÿç€æ•²ä»£ç ï¼Œç¬¬ä¸‰éæ˜¯æ€»ç»“æ€§çš„å¬ï¼Œåšä¸€äº›ç¬”è®°ã€‚</p><p>ä½†æ˜¯æˆ‘å‘ç°ï¼Œæˆ‘å¯¹Javaè¯­è¨€çš„ä¸€äº›åŸºç¡€æ€§çš„è¯­æ³•å’Œæ¦‚å¿µè¿˜ä¸æ˜¯å¤ªç†Ÿæ‚‰ï¼Œäºæ˜¯æˆ‘æ‰“å¼€äº†2018å¹´åŒåä¸€ä¹°çš„ã€ŠJavaç¼–ç¨‹æ€æƒ³ã€‹ï¼Œå¼€å§‹äº†è§£Javaè¯­è¨€çš„ä¸€äº›ç‰¹æ€§ã€‚åŒæ—¶è¿˜çœ‹äº†æŸé©¬ç¨‹åºå‘˜åˆ›å§‹äººå¼ è€å¸ˆçš„ã€ŠJavaé«˜æ–°æŠ€æœ¯ã€‹è§†é¢‘è¯¾ç¨‹ï¼Œå¯¹æˆ‘å½±å“ç”šå¤§ï¼Œè§†é¢‘å†…å®¹åŸºæœ¬æ˜¯JDK5çš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬é™æ€å¯¼åŒ…ã€å¯å˜å‚æ•°ã€å¢å¼ºforå¾ªç¯ã€è‡ªåŠ¨æ‹†/è£…ç®±ã€äº«å…ƒè®¾è®¡æ¨¡å¼ã€æšä¸¾ã€åå°„ã€ç±»åŠ è½½å™¨ã€åŒäº²å§”æ´¾æ¨¡å‹ã€æ³¨è§£ã€æ³›å‹å’ŒåŠ¨æ€ä»£ç†ç­‰ã€‚è¿™å¥—è§†é¢‘ç®—å¾—ä¸Šæ˜¯å½»åº•æ”¹å˜äº†æˆ‘ï¼ŒçœŸæ­£çš„è®©æˆ‘å…¥äº†Javaçš„é—¨ã€‚</p><p>æ­¤åï¼Œè¿˜çœ‹äº†å¼ è€å¸ˆçš„ã€ŠJavaå¤šçº¿ç¨‹ä¸å¹¶å‘åº“ã€‹è¿™å¥—è§†é¢‘ï¼Œè¿™å¥—è§†é¢‘å¥ å®šäº†æˆ‘çš„JavaåŸºç¡€ï¼Œè§†é¢‘ä¸»è¦è®²è§£äº†ä¼ ç»Ÿçº¿ç¨‹åŒæ­¥ä¸äº’æ–¥æŠ€æœ¯ã€ThreadLocalç±»ã€Callableå’ŒFutureç±»ã€Timerå®šæ—¶å™¨ç±»ã€çº¿ç¨‹æ± ã€è¯»å†™é”ã€é—­é”ã€æ …æ ã€è®¡æ•°å™¨ã€é˜»å¡é˜Ÿåˆ—ã€åŸå­æ“ä½œç±»å’ŒåŒæ­¥é›†åˆç­‰å†…å®¹ã€‚</p><p>å†ä¹‹åï¼Œæˆ‘æ¥è§¦åˆ°äº†Springï¼ŒSpring MVCï¼ŒMybatisï¼ŒMavenï¼ŒSpring Bootï¼ŒRedisâ€¦ç­‰ä¸€äº›æŠ€æœ¯æ ˆã€‚</p><p>åŸºæœ¬ç†Ÿæ‚‰è¿™äº›æ¡†æ¶ä¹‹åï¼Œæˆ‘ç»§ç»­äº†æŸå®¢ç½‘é«˜çº§é¡¹ç›®è¯¾ï¼Œæ˜¥èŠ‚åœ¨å®¶çš„ä¸€ä¸ªæœˆï¼Œè·Ÿç€è§†é¢‘æŠŠä»£ç å†™çš„å·®ä¸å¤šäº†ã€‚ç„¶åæŠŠè¿™ä¸ªé¡¹ç›®å½“åšé¡¹ç›®ç»éªŒå¡«å……åœ¨è‡ªå·±çš„ç®€å†ä¸Šã€‚</p><p>å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘å¹¶ä¸æ˜¯å®Œå…¨ç…§æ¬è§†é¢‘ä¸­æ‰€è®²ï¼Œè€Œæ˜¯é‡‡ç”¨æ ‡å‡†å‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼ï¼Œå‰ç«¯é€‰æ‹©äº†Vueå…¨å®¶æ¡¶æŠ€æœ¯æ ˆï¼Œåç«¯åˆ™æ˜¯è§†é¢‘ä¸­çš„Spring BootæŠ€æœ¯æ ˆï¼Œè¿™å¯¹äºæˆ‘çš„é¡¹ç›®ç»éªŒæ¥è¯´æ˜¯ä¸€ä¸ªåŠ åˆ†é¡¹ã€‚</p><p>ç»è¿‡ä¸ºæœŸäº”ä¸ªæœˆçš„å­¦ä¹ ï¼Œæˆ‘å¼€å§‹æ˜¥æ‹›çš„æ­¥ä¼ï¼Œç»è¿‡äºŒæœˆåº•ä¸‰æœˆåˆä¸€ä¸ªå¤šæœˆçš„è·‘å®£è®²ä¼šï¼Œå‚åŠ ç¬”è¯•é¢è¯•ï¼Œæœ€ç»ˆæ”¶è·äº†ä¸€å®¶æ­¦æ±‰çš„Offerï¼Œä¸€åˆ‡éƒ½æŒºå¹¸è¿çš„ï¼Œè¿™å®¶å…¬å¸çš„è–ªèµ„ï¼ŒæŠ€æœ¯æ ˆéƒ½æ¯”è¾ƒæ»¡æ„ã€‚ç»ˆäºæ˜¯åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººã€‚</p><p>7æœˆï¼Œå…¥èŒã€‚</p><p>è¿›å…¥æ–°å…¬å¸ï¼Œæ–°ç¯å¢ƒï¼Œæˆä¸ºäº†ç¤¾ä¼šäººï¼Œå¾ˆæ¿€åŠ¨ã€‚</p><p>9æœˆï¼Œå‚ä¸çš„ç¬¬ä¸€ä¸ªéœ€æ±‚ä¸Šçº¿ã€‚è€æ€»è¯·å–é…’ï¼Œå–åäº†ä¸€ç‰‡äººï¼Œæˆ‘ä¹Ÿåå€’åœ¨é—¨å¤–ã€‚</p><p>10æœˆï¼Œå¼€å§‹äº†ä»Šå¹´æœ€å¤§çš„ä¸€ä¸ªé¡¹ç›®ï¼ŒåŠ ç­é€šå®µäº†ä¸¤æ¬¡ã€‚å¾ˆç´¯ã€‚</p><p>12æœˆï¼Œå‡ºå·®æ¥åˆ°äº†åŒ—äº¬ï¼Œçœ‹äº†å¤©å®‰é—¨ï¼Œçœ‹äº†ç´«ç¦åŸï¼Œçœ‹äº†æ­ç‹åºœï¼Œçœ‹äº†æ°´ç«‹æ–¹ï¼Œçœ‹äº†é¸Ÿå·¢ã€‚ä¸è™šæ­¤è¡Œã€‚</p><p>æœ«äº†ï¼Œ12æœˆçš„æœ€åä¸€å¤©è¿›è¡Œäº†è½¬æ­£ç­”è¾©ï¼Œåº”è¯¥æ˜¯è½¬æ­£äº†ã€‚</p><p>ä¸”è¡Œä¸”çæƒœã€‚</p><p>2020å¹´ï¼Œå¸Œæœ›å¯ä»¥é‡è§æ›´å¥½çš„è‡ªå·±ï¼Œæé«˜æ—¶é—´è§„åˆ’èƒ½åŠ›ä¸è‡ªæ§åŠ›ï¼Œå½¢æˆè‡ªå·±çš„çŸ¥è¯†ä½“ç³»ï¼Œå¹¶æ·±å…¥åˆ°æŠ€æœ¯ä¸­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¹´åº¦æ€»ç»“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¹´åº¦æ€»ç»“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaBucket</title>
      <link href="2019/12/13/java-bucket/"/>
      <url>2019/12/13/java-bucket/</url>
      
        <content type="html"><![CDATA[<h2 id="JavaæŠ€èƒ½æ ‘"><a href="#JavaæŠ€èƒ½æ ‘" class="headerlink" title="JavaæŠ€èƒ½æ ‘"></a><code>Java</code>æŠ€èƒ½æ ‘</h2><p><img src="https://i.loli.net/2020/02/15/KqUBzrXAP4JOjHd.png" alt="gold-road-to-java.png"></p><h2 id="JavaSE"><a href="#JavaSE" class="headerlink" title="JavaSE"></a><code>JavaSE</code></h2><h3 id="JDKæºç è§£æç³»åˆ—"><a href="#JDKæºç è§£æç³»åˆ—" class="headerlink" title="JDKæºç è§£æç³»åˆ—"></a><code>JDK</code>æºç è§£æç³»åˆ—</h3><ul><li><a href="https://lilu.org.cn/2020/03/21/javase/base/serializable/"><code>JDK</code>æºç è§£æä¹‹<code>Serializable</code></a></li><li><a href="https://lilu.org.cn/2020/04/26/javase/base/randomaccess/"><code>JDK</code>æºç è§£æä¹‹<code>RandomAccess</code></a></li><li><a href="https://lilu.org.cn/2020/04/26/javase/base/cloneable/"><code>JDK</code>æºç è§£æä¹‹<code>Cloneable</code></a></li><li><a href="https://lilu.org.cn/2020/05/05/javase/base/list/"><code>JDK</code>æºç è§£æä¹‹<code>List</code></a></li><li><a href="https://lilu.org.cn/2020/05/05/javase/base/collection/"><code>JDK</code>æºç è§£æä¹‹<code>Collection</code></a></li><li><a href="https://lilu.org.cn/2020/05/05/javase/base/abstract-collection/"><code>JDK</code>æºç è§£æä¹‹<code>AbstractCollection</code></a></li><li><a href="https://lilu.org.cn/2020/05/08/javase/base/abstract-list/"><code>JDK</code>æºç è§£æä¹‹<code>AbstractList</code></a></li><li><a href="https://lilu.org.cn/2020/05/11/javase/base/queue/"><code>JDK</code>æºç è§£æä¹‹<code>Queue</code></a></li><li><a href="https://lilu.org.cn/2020/05/11/javase/base/deque/"><code>JDK</code>æºç è§£æä¹‹<code>Deque</code></a></li><li><a href="https://lilu.org.cn/2020/05/27/javase/base/linkedlist/"><code>JDK</code>æºç è§£æä¹‹<code>LinkedList</code></a></li><li><a href="https://lilu.org.cn/2020/05/27/javase/base/abstract-sequential-list/"><code>JDK</code>æºç è§£æä¹‹<code>AbstractSequentialList</code></a></li><li><a href="https://lilu.org.cn/2020/06/01/javase/base/arraylist/"><code>JDK</code>æºç è§£æä¹‹<code>ArrayList</code></a></li><li><a href="https://lilu.org.cn/2020/11/17/javase/base/hashmap/">é¢è¯•å¿…é—®<code>HashMap</code></a></li></ul><h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><ul><li><a href="https://lilu.org.cn/2020/04/26/javase/base/depth-shallow-copy/">æ·±å…¥ç†è§£æ·±æµ…æ‹·è´</a></li><li><a href="https://lilu.org.cn/2020/01/09/javase/base/method-overload/">æ–¹æ³•é‡è½½<code>Overload</code></a></li><li><a href="https://lilu.org.cn/2020/01/09/javase/base/why-char-cannot-be-converted-to-byte-or-short/">åŸºæœ¬æ•°æ®ç±»å‹<code>char</code>ä¸ºä»€ä¹ˆä¸ä¼šè¢«éšå¼è½¬æ¢æˆ<code>byte</code>æˆ–<code>short</code>ç±»å‹ï¼Ÿ</a></li><li><a href="https://lilu.org.cn/2020/06/29/javase/base/string/">å…³äº<code>Java</code>ï¼Œä½ ä¸å¾—ä¸å­¦çš„<code>java.lang.String</code>ç±»</a></li></ul><h3 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a><code>JVM</code></h3><ul><li><a href="https://lilu.org.cn/2020/07/20/javase/jvm/what-is-quote/">ä½•ä¸ºå¼•ç”¨</a></li><li><a href="https://lilu.org.cn/2020/07/20/javase/jvm/run-class/"><code>Java</code>è™šæ‹Ÿæœºæ˜¯å¦‚ä½•è¿è¡Œå­—èŠ‚ç çš„</a></li><li><a href="https://lilu.org.cn/2020/07/20/javase/jvm/object-is-alive-or-dead/">å¯¹è±¡æ˜¯â€œç”Ÿâ€æ˜¯â€œæ­»â€</a></li><li><a href="https://lilu.org.cn/2020/07/20/javase/jvm/finalize-before-gc/">å›æ”¶å‰çš„è‡ªæ•‘</a></li><li><a href="https://lilu.org.cn/2020/07/23/javase/jvm/gcer/">åƒåœ¾æ”¶é›†å™¨</a></li><li><a href="https://lilu.org.cn/2020/07/23/javase/jvm/gc-algorithm/">åƒåœ¾æ”¶é›†ç®—æ³•</a></li></ul><h2 id="æ•°æ®ç»“æ„-ç®—æ³•"><a href="#æ•°æ®ç»“æ„-ç®—æ³•" class="headerlink" title="æ•°æ®ç»“æ„-ç®—æ³•"></a>æ•°æ®ç»“æ„-ç®—æ³•</h2><h3 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h3><ul><li><a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/data-structure-linkedlist-base/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-åŸºç¡€çŸ¥è¯†</a></li><li><a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/non-recursive-reverse-link/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-ä½¿ç”¨éé€’å½’æ³•å®ç°å•é“¾è¡¨çš„åè½¬</a></li><li><a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/middle-linknode/">æ•°æ®ç»“æ„ä¹‹é“¾è¡¨-å¥‡æ•°ä¸ªå…ƒç´ çš„é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹</a></li></ul><h3 id="LeetCodeé¢˜è§£"><a href="#LeetCodeé¢˜è§£" class="headerlink" title="LeetCodeé¢˜è§£"></a><code>LeetCode</code>é¢˜è§£</h3><ul><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E7%AE%97%E6%B3%95/LeetCode%E9%A2%98%E8%A7%A3/docs/%EF%BC%88%E7%AE%80%E5%8D%95%EF%BC%89%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C.md">ï¼ˆç®€å•ï¼‰ä¸¤æ•°ä¹‹å’Œ</a></li><li><a href="https://lilu.org.cn/2020/12/04/algorithm/leetcode/easy/7/">ï¼ˆç®€å•ï¼‰æ•´æ•°åè½¬</a></li><li><a href="https://lilu.org.cn/2020/07/14/algorithm/leetcode/easy/242/">ï¼ˆç®€å•ï¼‰æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯</a></li><li><a href="https://lilu.org.cn/2020/07/14/algorithm/leetcode/linkedlist/intersection-of-two-linked-lists-lcci/">é“¾è¡¨æ ‡ç­¾ï¼šé¢è¯•é¢˜ï¼šé“¾è¡¨ç›¸äº¤</a></li></ul><h3 id="LeetCodeé“¾è¡¨æ ‡ç­¾ç®€å•é¢˜"><a href="#LeetCodeé“¾è¡¨æ ‡ç­¾ç®€å•é¢˜" class="headerlink" title="LeetCodeé“¾è¡¨æ ‡ç­¾ç®€å•é¢˜"></a><code>LeetCode</code>é“¾è¡¨æ ‡ç­¾ç®€å•é¢˜</h3><ul><li><input checked="" disabled="" type="checkbox"> <a href="https://lilu.org.cn/2020/12/23/algorithm/leetcode/tag/linkedlist/kth-node-from-end-of-list-lcci/">è¿”å›å€’æ•°ç¬¬<code>k</code>ä¸ªèŠ‚ç‚¹</a></li><li><input checked="" disabled="" type="checkbox"> <a href="https://lilu.org.cn/2020/12/27/algorithm/leetcode/tag/linkedlist/delete-middle-node-lcci/">åˆ é™¤ä¸­é—´èŠ‚ç‚¹</a></li><li><input disabled="" type="checkbox"> åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨</li><li><input disabled="" type="checkbox"> å›æ–‡é“¾è¡¨</li><li><input disabled="" type="checkbox"> åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹</li><li><input disabled="" type="checkbox"> åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹</li><li><input checked="" disabled="" type="checkbox"> <a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/middle-linknode/">é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹</a></li><li><input disabled="" type="checkbox"> ç§»é™¤é“¾è¡¨å…ƒç´ </li><li><input disabled="" type="checkbox"> ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹</li><li><input checked="" disabled="" type="checkbox"> <a href="https://lilu.org.cn/2020/12/12/algorithm/base/datastructure/non-recursive-reverse-link/">åè½¬é“¾è¡¨</a></li><li><input disabled="" type="checkbox"> äºŒè¿›åˆ¶é“¾è¡¨è½¬æ•´æ•°</li><li><input disabled="" type="checkbox"> é“¾è¡¨ç›¸äº¤</li><li><input checked="" disabled="" type="checkbox"> <a href="https://lilu.org.cn/2020/07/14/algorithm/leetcode/tag/linkedlist/intersection-of-two-linked-lists-lcci/">ç›¸äº¤é“¾è¡¨</a></li><li><input disabled="" type="checkbox"> å›æ–‡é“¾è¡¨</li><li><input checked="" disabled="" type="checkbox"> åè½¬é“¾è¡¨</li><li><input disabled="" type="checkbox"> åˆ é™¤é“¾è¡¨Mä¸ªèŠ‚ç‚¹åçš„Nä¸ªèŠ‚ç‚¹</li><li><input disabled="" type="checkbox"> åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ </li><li><input checked="" disabled="" type="checkbox"> <a href="https://lilu.org.cn/2020/12/22/algorithm/base/datastructure/link-has-cycle/">ç¯å½¢é“¾è¡¨</a></li><li><input disabled="" type="checkbox"> ç§»é™¤é‡å¤èŠ‚ç‚¹</li><li><input disabled="" type="checkbox"> ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</li></ul><h3 id="å‹‡é—¯ç®—æ³•"><a href="#å‹‡é—¯ç®—æ³•" class="headerlink" title="å‹‡é—¯ç®—æ³•"></a>å‹‡é—¯ç®—æ³•</h3><ul><li><a href="https://lilu.org.cn/2020/06/04/algorithm/base/recursive-reverse-link/">å‹‡é—¯ç®—æ³•-é€’å½’æ³•æ‹¿ä¸‹åè½¬é“¾è¡¨çš„ä¸‰æ€</a></li><li><a href="https://lilu.org.cn/2020/07/14/algorithm/coding-interview-guide/arraysandmatrices/solution01/">å‹‡é—¯ç®—æ³•-åœ¨è¡Œåˆ—éƒ½æ’å¥½åºçš„çŸ©é˜µä¸­æ‰¾æŒ‡å®šçš„æ•°</a></li></ul><h2 id="JavaEE"><a href="#JavaEE" class="headerlink" title="JavaEE"></a><code>JavaEE</code></h2><ul><li><a href="https://lilu.org.cn/2020/12/11/javaee/maven/maven-must-know-and-know/"><code>Apache Maven</code>å¿…çŸ¥å¿…ä¼š</a></li></ul><h2 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h2><h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a><code>Redis</code></h3><ul><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/String%E5%AD%97%E7%AC%A6%E4%B8%B2.md"><code>String</code>å­—ç¬¦ä¸²</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/List%E5%88%97%E8%A1%A8.md"><code>List</code>åˆ—è¡¨</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Hash%E5%93%88%E5%B8%8C.md"><code>Hash</code>å“ˆå¸Œ</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Set%E9%9B%86%E5%90%88.md"><code>Set</code>é›†åˆ</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/ZSet%E9%9B%86%E5%90%88.md"><code>ZSet</code>é›†åˆ</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE.md"><code>Redis</code>é›†ç¾¤é…ç½®</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E9%80%9A%E7%94%A8Redis%E5%91%BD%E4%BB%A4.md">é€šç”¨<code>Redis</code>å‘½ä»¤</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/Redis%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86.md"><code>Redis</code>æ‰©å±•çŸ¥è¯†</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E5%85%B6%E5%AE%83Redis%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%91%BD%E4%BB%A4.md">å…¶å®ƒ<code>Redis</code>æœåŠ¡å™¨å‘½ä»¤</a></li></ul><h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><ul><li><a href="https://lilu.org.cn/2020/07/12/database/mysql/transaction-characteristics-and-isolation-levels/">äº‹åŠ¡çš„ç‰¹æ€§å’Œéš”ç¦»çº§åˆ«</a></li><li><a href="https://lilu.org.cn/2020/07/12/database/mysql/why-does-mysql-choose-repeatable-read-as-the-default-isolation-level/"><code>MySQL</code>ä¸ºä»€ä¹ˆé€‰æ‹©å¯é‡å¤è¯»ä½œä¸ºé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Ÿ</a></li></ul><h2 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h2><ul><li><code>Apache ShardingSphere</code><ul><li><a href="https://lilu.org.cn/2019/12/12/middleware/sharding-sphere/sharding-jdbc-introduction/">åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶ä¹‹<code>ShardingSphere</code>-å…¥é—¨æ¡ˆä¾‹</a></li></ul></li><li><code>xxl-job</code><ul><li><a href="https://lilu.org.cn/2020/02/13/middleware/xxl-job/build-local-dispatch-platform/">ä¿®ç‚¼<code>xxl-job</code>ä¹‹æ­å»ºæœ¬åœ°è°ƒåº¦å¹³å°</a></li><li><a href="https://lilu.org.cn/2020/02/13/middleware/xxl-job/demo-executor-xxljobconfig-sourcecode-analysis/">ä¿®ç‚¼<code>xxl-job</code>ä¹‹ç¤ºä¾‹æ‰§è¡Œå™¨XxlJobConfigé…ç½®ç±»æºç è§£æ</a></li><li><a href="https://lilu.org.cn/2020/02/26/middleware/xxl-job/dispatch-center-start-process-analysis/">ä¿®ç‚¼<code>xxl-job</code>ä¹‹è°ƒåº¦ä¸­å¿ƒå¯åŠ¨æµç¨‹è§£æ</a></li><li><a href="https://lilu.org.cn/2020/02/27/middleware/xxl-job/initI18n/">ä¿®ç‚¼<code>xxl-job</code>ä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–å›½é™…åŒ–ç»„ä»¶</a></li><li><a href="https://lilu.org.cn/2020/02/29/middleware/xxl-job/registry-center-heartbeat-renewal/">ä¿®ç‚¼<code>xxl-job</code>ä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–æ³¨å†Œä¸­å¿ƒâ€œå¿ƒè·³ç»­çº¦â€æœåŠ¡</a></li><li><a href="https://lilu.org.cn/2020/03/03/middleware/xxl-job/job-fail-monitor/">ä¿®ç‚¼<code>xxl-job</code>ä¹‹è°ƒåº¦ä¸­å¿ƒâ€”åˆå§‹åŒ–å¤±è´¥ä»»åŠ¡ç®¡ç†ä¸­å¿ƒ</a></li></ul></li></ul><h2 id="åˆ†å¸ƒå¼"><a href="#åˆ†å¸ƒå¼" class="headerlink" title="åˆ†å¸ƒå¼"></a>åˆ†å¸ƒå¼</h2><p>å¾…å®Œå–„â€¦</p><h2 id="å¾®æœåŠ¡"><a href="#å¾®æœåŠ¡" class="headerlink" title="å¾®æœåŠ¡"></a>å¾®æœåŠ¡</h2><p>å¾…å®Œå–„â€¦</p><h2 id="é¡¹ç›®ç®¡ç†-æŒç»­é›†æˆ"><a href="#é¡¹ç›®ç®¡ç†-æŒç»­é›†æˆ" class="headerlink" title="é¡¹ç›®ç®¡ç†-æŒç»­é›†æˆ"></a>é¡¹ç›®ç®¡ç†-æŒç»­é›†æˆ</h2><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a><code>Linux</code></h3><ul><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/Linux/Linux%E5%91%BD%E4%BB%A4.md"><code>Linux</code>å‘½ä»¤</a></li></ul><h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a><code>Docker</code></h3><ul><li><a href="https://lilu.org.cn/2020/02/19/docker/docker-common-commands/"><code>Docker</code>å¸¸ç”¨å‘½ä»¤</a></li><li><a href="https://lilu.org.cn/2020/02/19/docker/create-mysql-container/">åˆ›å»º<code>MySQL5.7</code>çš„<code>Docker</code>å®¹å™¨</a></li></ul><h3 id="å¸¸ç”¨è½¯ä»¶å®‰è£…ç³»åˆ—"><a href="#å¸¸ç”¨è½¯ä»¶å®‰è£…ç³»åˆ—" class="headerlink" title="å¸¸ç”¨è½¯ä»¶å®‰è£…ç³»åˆ—"></a>å¸¸ç”¨è½¯ä»¶å®‰è£…ç³»åˆ—</h3><ul><li><a href="https://lilu.org.cn/2020/02/07/installed/install-windows10/">é‡è£…<code>Windows10</code>ç³»ç»Ÿ</a></li><li><a href="https://lilu.org.cn/2020/02/07/installed/install-nodejs/"><code>Windows 10</code>ä¸‹<code>Node.js</code>å®‰è£…ä¸é…ç½®</a></li><li><a href="https://lilu.org.cn/2020/02/07/installed/install-maven/"><code>Windows 10</code>ä¸‹<code>Maven</code>å®‰è£…åŠé…ç½®</a></li><li><a href="https://lilu.org.cn/2020/02/07/installed/install-jdk/"><code>Windows 10</code>ä¸‹<code>JDK</code>å®‰è£…åŠç¯å¢ƒå˜é‡é…ç½®</a></li><li><a href="https://lilu.org.cn/2020/02/07/installed/install-idea/"><code>Windows 10</code>ä¸‹<code>IntelliJ IDEA 2019.3.2</code>å®‰è£…å’Œå¸¸ç”¨é…ç½®</a></li><li><a href="https://lilu.org.cn/2020/02/07/installed/install-git/"><code>Windows 10</code>ä¸‹<code>Git</code>å®‰è£…åŠ<code>SSH</code>å…¬ç§é’¥é…ç½®</a></li></ul><h3 id="Git"><a href="#Git" class="headerlink" title="Git"></a><code>Git</code></h3><p>å¾…å®Œå–„â€¦</p><h3 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a><code>Jenkins</code></h3><p>å¾…å®Œå–„â€¦</p><h2 id="ä¼˜ç§€ä¹¦ç±"><a href="#ä¼˜ç§€ä¹¦ç±" class="headerlink" title="ä¼˜ç§€ä¹¦ç±"></a>ä¼˜ç§€ä¹¦ç±</h2><ul><li><code>Java 8</code>å®æˆ˜<ul><li><a href="https://lilu.org.cn/2019/12/12/reading-notes/Java8-in-action/Part-I-Basics/">ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€çŸ¥è¯†</a></li><li><a href="https://lilu.org.cn/2019/12/12/reading-notes/Java8-in-action/Part-II-Functional-Data-Processing/">ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬äºŒéƒ¨åˆ†ï¼šå‡½æ•°å¼æ•°æ®å¤„ç†</a></li><li><a href="https://lilu.org.cn/2019/12/12/reading-notes/Java8-in-action/Part-III-Efficient-Java8-Programming(1)/">ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆä¸€ï¼‰ï¼šæ¥å£é‡æ„å’Œæ–°ç‰¹æ€§</a></li><li><a href="https://lilu.org.cn/2019/12/12/reading-notes/Java8-in-action/Part-III-Efficient-Java8-Programming(2)/">ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆäºŒï¼‰ï¼šä¼˜é›…çš„è§£å†³NPEé—®é¢˜</a></li><li><a href="https://lilu.org.cn/2019/12/12/reading-notes/Java8-in-action/Part-III-Efficient-Java8-Programming(3)/">ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆä¸‰ï¼‰ï¼šä»ä¸€ä¸ªç”Ÿäº§ç¯å¢ƒçš„äº‹æ•…åˆ°å¼‚æ­¥ç¼–ç¨‹æ€æƒ³</a></li><li><a href="https://lilu.org.cn/2019/12/12/reading-notes/Java8-in-action/Part-III-Efficient-Java8-Programming(4)/">ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆå››ï¼‰ï¼šä½¿ç”¨æ–°çš„æ—¥æœŸæ—¶é—´API</a></li></ul></li></ul><p>å¾…å®Œå–„â€¦</p><ul><li>ã€Šå‰‘æŒ‡<code>Offer</code>ã€‹<ul><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E5%AE%9E%E7%8E%B0%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.md">å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E6%95%B0%E7%BB%84%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%EF%BC%88%E9%A2%98%E7%9B%AE%E4%B8%80%EF%BC%89.md">æ•°ç»„ä¸­é‡å¤çš„æ•°ï¼ˆé¢˜ç›®ä¸€ï¼‰</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E6%95%B0%E7%BB%84%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%EF%BC%88%E9%A2%98%E7%9B%AE%E4%BA%8C%EF%BC%89.md">æ•°ç»„ä¸­é‡å¤çš„æ•°ï¼ˆé¢˜ç›®äºŒï¼‰</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E6%9F%A5%E6%89%BE.md">äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E6%9B%BF%E6%8D%A2%E7%A9%BA%E6%A0%BC.md">æ›¿æ¢ç©ºæ ¼</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E9%9D%A2%E8%AF%95%E9%A2%985%EF%BC%88%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE%EF%BC%89.md">é¢è¯•é¢˜5ï¼ˆç›¸å…³é¢˜ç›®ï¼‰</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E4%BB%8E%E5%B0%BE%E5%88%B0%E5%A4%B4%E6%89%93%E5%8D%B0%E9%93%BE%E8%A1%A8.md">ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E9%87%8D%E5%BB%BA%E4%BA%8C%E5%8F%89%E6%A0%91.md">é‡å»ºäºŒå‰æ ‘</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E4%B8%8B%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9.md">äºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E4%B8%A4%E4%B8%AA%E6%A0%88%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E9%98%9F%E5%88%97.md">ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E4%B8%A4%E4%B8%AA%E9%98%9F%E5%88%97%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%A0%88.md">ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªæ ˆ</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E6%96%90%E6%B3%A2%E9%82%A3%E6%A5%94%E6%95%B0%E5%88%97.md">æ–æ³¢é‚£æ¥”æ•°åˆ—</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E9%9D%92%E8%9B%99%E8%B7%B3%E5%8F%B0%E9%98%B6%E9%97%AE%E9%A2%98.md">é’è›™è·³å°é˜¶é—®é¢˜</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E9%9D%92%E8%9B%99%E8%B7%B3%E5%8F%B0%E9%98%B6%E9%97%AE%E9%A2%98%E6%89%A9%E5%B1%95%EF%BC%88%E5%8F%98%E6%80%81%E8%B7%B3%E5%8F%B0%E9%98%B6%EF%BC%89.md">é’è›™è·³å°é˜¶é—®é¢˜æ‰©å±•ï¼ˆå˜æ€è·³å°é˜¶ï¼‰</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E7%9F%A9%E5%BD%A2%E8%A6%86%E7%9B%96.md">çŸ©å½¢è¦†ç›–</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E5%87%A0%E4%B8%87%E4%B8%AA%E5%91%98%E5%B7%A5%E5%B9%B4%E9%BE%84%E6%8E%92%E5%BA%8F.md">å‡ ä¸‡ä¸ªå‘˜å·¥å¹´é¾„æ’åº</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E6%97%8B%E8%BD%AC%E6%95%B0%E7%BB%84%E7%9A%84%E6%9C%80%E5%B0%8F%E6%95%B0%E5%AD%97.md">æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E7%9F%A9%E9%98%B5%E4%B8%AD%E7%9A%84%E8%B7%AF%E5%BE%84.md">çŸ©é˜µä¸­çš„è·¯å¾„</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%9A%84%E8%BF%90%E5%8A%A8%E8%8C%83%E5%9B%B4.md">æœºå™¨äººçš„è¿åŠ¨èŒƒå›´</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E5%89%AA%E7%BB%B3%E5%AD%90.md">å‰ªç»³å­</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%B8%AD1%E7%9A%84%E4%B8%AA%E6%95%B0.md">äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E6%95%B0%E5%80%BC%E7%9A%84%E6%95%B4%E6%95%B0%E6%AC%A1%E6%96%B9.md">æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E6%89%93%E5%8D%B0%E4%BB%8E1%E5%88%B0%E6%9C%80%E5%A4%A7%E7%9A%84n%E4%BD%8D%E6%95%B0.md">æ‰“å°ä»1åˆ°æœ€å¤§çš„nä½æ•°</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E5%9C%A8O(1)%E6%97%B6%E9%97%B4%E5%86%85%E5%88%A0%E9%99%A4%E9%93%BE%E8%A1%A8%E8%8A%82%E7%82%B9.md">åœ¨O(1)æ—¶é—´å†…åˆ é™¤é“¾è¡¨èŠ‚ç‚¹</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E5%88%A0%E9%99%A4%E9%93%BE%E8%A1%A8%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E8%8A%82%E7%82%B9.md">åˆ é™¤é“¾è¡¨ä¸­é‡å¤çš„èŠ‚ç‚¹</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%B9%E9%85%8D.md">æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E8%A1%A8%E7%A4%BA%E6%95%B0%E5%80%BC%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2.md">è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E9%93%BE%E8%A1%A8%E4%B8%AD%E5%80%92%E6%95%B0%E7%AC%ACk%E4%B8%AA%E8%8A%82%E7%82%B9.md">é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E9%93%BE%E8%A1%A8%E4%B8%AD%E7%8E%AF%E7%9A%84%E5%85%A5%E5%8F%A3%E8%8A%82%E7%82%B9.md">é“¾è¡¨ä¸­ç¯çš„å…¥å£èŠ‚ç‚¹</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E5%8F%8D%E8%BD%AC%E9%93%BE%E8%A1%A8.md">åè½¬é“¾è¡¨</a></li><li><a href="https://github.com/sunchaser-lilu/gold-road-to-Java/blob/master/book-notes/%E5%89%91%E6%8C%87Offer/docs/%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%8E%92%E5%BA%8F%E7%9A%84%E9%93%BE%E8%A1%A8.md">åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨</a></li></ul></li></ul><p>å¾…å®Œå–„â€¦</p><ul><li>ã€Šç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—-ITåä¼ç®—æ³•å’Œæ•°æ®ç»“æ„é¢˜ç›®æœ€ä¼˜è§£ã€‹</li></ul><p>å¾…å®Œå–„â€¦</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µä¸æ„ä¹‰</title>
      <link href="2019/12/12/design-patterns/gof/Design-pattern-overview/"/>
      <url>2019/12/12/design-patterns/gof/Design-pattern-overview/</url>
      
        <content type="html"><![CDATA[<h2 id="è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µä¸æ„ä¹‰"><a href="#è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µä¸æ„ä¹‰" class="headerlink" title="è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µä¸æ„ä¹‰"></a>è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µä¸æ„ä¹‰</h2><h3 id="è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ"><a href="#è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ" class="headerlink" title="è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ"></a>è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ</h3><p>è®¾è®¡æ¨¡å¼ï¼Œæ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚å®ƒæè¿°äº†åœ¨è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­çš„ä¸€äº›ä¸æ–­é‡å¤å‘ç”Ÿçš„é—®é¢˜ï¼Œä»¥åŠè¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯è§£å†³ç‰¹å®šé—®é¢˜çš„ä¸€ç³»åˆ—å¥—è·¯ï¼Œæ˜¯å‰è¾ˆä»¬çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå…·æœ‰ä¸€å®šçš„æ™®éæ€§ï¼Œå¯ä»¥åå¤ä½¿ç”¨ã€‚å…¶ç›®çš„æ˜¯ä¸ºäº†æé«˜ä»£ç çš„å¯é‡ç”¨æ€§ã€ä»£ç çš„å¯è¯»æ€§å’Œä»£ç çš„å¯é æ€§ã€‚åœ¨å¾ˆå¤šå¼€æºæ¡†æ¶ä¸­éƒ½æœ‰è®¾è®¡æ¨¡å¼æ€æƒ³çš„ä½“ç°ï¼Œå°½ç®¡æœ‰äº›è®¾è®¡æ¨¡å¼é€æ¸è¢«ç¼–ç¨‹è¯­è¨€çš„æ–°è¯­æ³•ç‰¹æ€§ç»™é¢ è¦†ï¼Œä½†å…¶è®¾è®¡æ€æƒ³ä¾æ—§æ˜¯å€¼å¾—æˆ‘ä»¬å­¦ä¹ çš„ã€‚</p><h3 id="è®¾è®¡æ¨¡å¼çš„æ„ä¹‰"><a href="#è®¾è®¡æ¨¡å¼çš„æ„ä¹‰" class="headerlink" title="è®¾è®¡æ¨¡å¼çš„æ„ä¹‰"></a>è®¾è®¡æ¨¡å¼çš„æ„ä¹‰</h3><p>è®¾è®¡æ¨¡å¼çš„æœ¬è´¨æ˜¯é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™çš„å®é™…è¿ç”¨ï¼Œæ˜¯å¯¹ç±»çš„å°è£…æ€§ã€ç»§æ‰¿æ€§å’Œå¤šæ€æ€§ä»¥åŠç±»çš„å…³è”å…³ç³»å’Œç»„åˆå…³ç³»çš„å……åˆ†ç†è§£ã€‚</p><p>å­¦ä¹ è®¾è®¡æ¨¡å¼æœ‰ä»¥ä¸‹æ„ä¹‰ï¼š</p><ul><li>å¯ä»¥æé«˜æ€ç»´èƒ½åŠ›ã€ç¼–ç¨‹èƒ½åŠ›å’Œè®¾è®¡èƒ½åŠ›ã€‚</li><li>ä½¿ç¨‹åºè®¾è®¡æ›´åŠ æ ‡å‡†åŒ–ã€ä»£ç ç¼–åˆ¶æ›´åŠ å·¥ç¨‹åŒ–ï¼Œä½¿è½¯ä»¶å¼€å‘æ•ˆç‡å¤§å¤§æé«˜ï¼Œä»è€Œç¼©çŸ­è½¯ä»¶çš„å¼€å‘å‘¨æœŸã€‚</li><li>ä½¿è®¾è®¡çš„ä»£ç å¯é‡ç”¨æ€§é«˜ã€å¯è¯»æ€§å¼ºã€å¯é æ€§é«˜ã€çµæ´»æ€§å¥½ã€å¯ç»´æŠ¤æ€§å¼ºã€‚</li><li>æœ‰åˆ©äºé˜…è¯»ä¸€äº›å¼€æºæ¡†æ¶æºç ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> GOFè®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> GOF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GoFçš„23ç§è®¾è®¡æ¨¡å¼</title>
      <link href="2019/12/12/design-patterns/gof/GoF&#39;s-23-design-patterns/"/>
      <url>2019/12/12/design-patterns/gof/GoF&#39;s-23-design-patterns/</url>
      
        <content type="html"><![CDATA[<h2 id="GoFè®¾è®¡æ¨¡å¼ç®€ä»‹"><a href="#GoFè®¾è®¡æ¨¡å¼ç®€ä»‹" class="headerlink" title="GoFè®¾è®¡æ¨¡å¼ç®€ä»‹"></a>GoFè®¾è®¡æ¨¡å¼ç®€ä»‹</h2><p>GoFæ˜¯è®¾è®¡æ¨¡å¼çš„ç»å…¸åè‘—Design Patterns: Elements of Reusable Object-Oriented Softwareï¼ˆä¸­è¯‘æœ¬åä¸ºã€Šè®¾è®¡æ¨¡å¼â€”â€”å¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ï¼‰çš„å››ä½ä½œè€…ï¼Œä»–ä»¬åˆ†ä¸ºæ˜¯ï¼šElich Gammaã€Richard Helmã€Ralph Johnsonã€ä»¥åŠJohn Vlissidesã€‚è¿™å››ä¸ªäººå¸¸è¢«ç§°ä¸ºGang of Fourï¼Œ å³å››äººç»„ï¼Œç®€ç§°GoFã€‚è¿™æœ¬ä¹¦ä¸­æ€»ç»“çš„23ç§è®¾è®¡æ¨¡å¼ç§°ä¸ºGoFè®¾è®¡æ¨¡å¼ã€‚</p><h2 id="è®¾è®¡æ¨¡å¼åˆ†ç±»"><a href="#è®¾è®¡æ¨¡å¼åˆ†ç±»" class="headerlink" title="è®¾è®¡æ¨¡å¼åˆ†ç±»"></a>è®¾è®¡æ¨¡å¼åˆ†ç±»</h2><p>è®¾è®¡æ¨¡å¼æœ‰ä¸¤ç§åˆ†ç±»æ–¹æ³•ï¼šæ ¹æ®æ¨¡å¼çš„ç›®çš„åˆ’åˆ†å’Œæ ¹æ®æ¨¡å¼çš„ä½œç”¨èŒƒå›´åˆ’åˆ†ã€‚</p><h3 id="æ ¹æ®ç›®çš„åˆ’åˆ†"><a href="#æ ¹æ®ç›®çš„åˆ’åˆ†" class="headerlink" title="æ ¹æ®ç›®çš„åˆ’åˆ†"></a>æ ¹æ®ç›®çš„åˆ’åˆ†</h3><p>æ ¹æ®æ¨¡å¼æ˜¯ç”¨æ¥å®Œæˆä»€ä¹ˆå·¥ä½œæ¥åˆ’åˆ†ï¼Œå¯åˆ†ä¸ºåˆ›å»ºå‹æ¨¡å¼ã€ç»“æ„å‹æ¨¡å¼å’Œè¡Œä¸ºå‹æ¨¡å¼ã€‚</p><ul><li>åˆ›å»ºå‹æ¨¡å¼ï¼šç”¨äºæè¿°â€œå¦‚ä½•åˆ›å»ºå¯¹è±¡â€ï¼Œä¸»è¦ç‰¹ç‚¹æ˜¯â€œå°†å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»â€ã€‚GoFçš„åˆ›å»ºå‹æ¨¡å¼åŒ…æ‹¬å•ä¾‹æ¨¡å¼ã€åŸå‹æ¨¡å¼ã€å·¥å‚æ–¹æ³•æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼å’Œå»ºé€ è€…æ¨¡å¼ã€‚</li><li>ç»“æ„å‹æ¨¡å¼ï¼šç”¨äºæè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡æŒ‰æŸç§å¸ƒå±€ç»„æˆæ›´å¤§çš„ç»“æ„ã€‚GoFçš„ç»“æ„å‹æ¨¡å¼åŒ…æ‹¬ä»£ç†æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€äº«å…ƒæ¨¡å¼å’Œç»„åˆæ¨¡å¼ã€‚</li><li>è¡Œä¸ºå‹æ¨¡å¼ï¼šç”¨äºæè¿°ç±»æˆ–å¯¹è±¡ä¹‹é—´æ€æ ·ç›¸äº’åä½œå…±åŒå®Œæˆå•ä¸ªå¯¹è±¡éƒ½æ— æ³•å•ç‹¬å®Œæˆçš„ä»»åŠ¡ï¼Œä»¥åŠæ€æ ·åˆ†é…èŒè´£ã€‚GoFçš„è¡Œä¸ºå‹æ¨¡å¼åŒ…æ‹¬è´£ä»»é“¾æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼å’Œè®¿é—®è€…æ¨¡å¼ã€‚</li></ul><h3 id="æ ¹æ®ä½œç”¨èŒƒå›´åˆ’åˆ†"><a href="#æ ¹æ®ä½œç”¨èŒƒå›´åˆ’åˆ†" class="headerlink" title="æ ¹æ®ä½œç”¨èŒƒå›´åˆ’åˆ†"></a>æ ¹æ®ä½œç”¨èŒƒå›´åˆ’åˆ†</h3><p>æ ¹æ®æ¨¡å¼æ˜¯ä¸»è¦ä½œç”¨äºç±»ä¸Šè¿˜æ˜¯ä¸»è¦ä½œç”¨äºå¯¹è±¡ä¸Šæ¥åˆ’åˆ†ï¼Œå¯åˆ†ä¸ºç±»æ¨¡å¼å’Œå¯¹è±¡æ¨¡å¼ã€‚</p><ul><li>ç±»æ¨¡å¼ï¼šç”¨äºå¤„ç†ç±»å’Œå­ç±»ä¹‹é—´çš„å…³ç³»ï¼Œè¿™äº›å…³ç³»é€šè¿‡ç»§æ‰¿æ¥å»ºç«‹ï¼Œæ˜¯é™æ€çš„ï¼Œåœ¨ç¼–è¯‘æ—¶æœŸå°±ç¡®å®šäº†ã€‚GoFçš„ç±»æ¨¡å¼åŒ…æ‹¬å·¥å‚æ–¹æ³•æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ï¼ˆç±»ï¼‰ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼å’Œè§£é‡Šå™¨æ¨¡å¼ã€‚</li><li>å¯¹è±¡æ¨¡å¼ï¼šç”¨äºå¤„ç†å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œè¿™äº›å…³ç³»å¯ä»¥é€šè¿‡ç»„åˆå’Œèšåˆæ¥å®ç°ï¼Œåœ¨è¿è¡Œæ—¶æœŸæ˜¯å¯ä»¥åŠ¨æ€æ”¹å˜çš„ã€‚GoFä¸­é™¤äº†ç±»æ¨¡å¼ï¼Œå…¶ä½™éƒ½æ˜¯å¯¹è±¡æ¨¡å¼ã€‚</li></ul><p>ä¸‹è¡¨æè¿°äº†è®¾è®¡æ¨¡å¼çš„åˆ†ç±»ï¼š</p><table><thead><tr><th>èŒƒå›´\ç›®çš„</th><th>åˆ›å»ºå‹</th><th>ç»“æ„å‹</th><th>è¡Œä¸ºå‹</th></tr></thead><tbody><tr><td>ç±»æ¨¡å¼</td><td>å·¥å‚æ–¹æ³•æ¨¡å¼</td><td>é€‚é…å™¨æ¨¡å¼ï¼ˆç±»ï¼‰</td><td>æ¨¡æ¿æ–¹æ³•æ¨¡å¼<br />è§£é‡Šå™¨æ¨¡å¼</td></tr><tr><td>å¯¹è±¡æ¨¡å¼</td><td>å•ä¾‹æ¨¡å¼<br />åŸå‹æ¨¡å¼<br />æŠ½è±¡å·¥å‚æ¨¡å¼<br />å»ºé€ è€…æ¨¡å¼</td><td>ä»£ç†æ¨¡å¼<br />é€‚é…å™¨æ¨¡å¼ï¼ˆå¯¹è±¡ï¼‰<br />æ¡¥æ¥æ¨¡å¼<br />è£…é¥°å™¨æ¨¡å¼<br />å¤–è§‚æ¨¡å¼<br />äº«å…ƒæ¨¡å¼<br />ç»„åˆæ¨¡å¼</td><td>ç­–ç•¥æ¨¡å¼<br />å‘½ä»¤æ¨¡å¼<br />è´£ä»»é“¾æ¨¡å¼<br />çŠ¶æ€æ¨¡å¼<br />è§‚å¯Ÿè€…æ¨¡å¼<br />ä¸­ä»‹è€…æ¨¡å¼<br />è¿­ä»£å™¨æ¨¡å¼<br />è®¿é—®è€…æ¨¡å¼<br />å¤‡å¿˜å½•æ¨¡å¼</td></tr></tbody></table><h2 id="GoFçš„23ç§è®¾è®¡æ¨¡å¼"><a href="#GoFçš„23ç§è®¾è®¡æ¨¡å¼" class="headerlink" title="GoFçš„23ç§è®¾è®¡æ¨¡å¼"></a>GoFçš„23ç§è®¾è®¡æ¨¡å¼</h2><ol><li>å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰ï¼šæŸä¸ªç±»åªèƒ½ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œè¯¥ç±»æä¾›äº†ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ä¾›å¤–éƒ¨è·å–è¯¥å®ä¾‹ï¼Œå…¶æ‹“å±•æ˜¯æœ‰é™å¤šä¾‹æ¨¡å¼ã€‚</li><li>åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰ï¼šå°†ä¸€ä¸ªå¯¹è±¡ä½œä¸ºåŸå‹ï¼Œé€šè¿‡å¯¹å…¶è¿›è¡Œå¤åˆ¶è€Œå…‹éš†å‡ºå¤šä¸ªå’ŒåŸå‹ç±»ä¼¼çš„æ–°å®ä¾‹ã€‚</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory Methodï¼‰ï¼šå®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºäº§å“çš„æ¥å£ï¼Œç”±å­ç±»å†³å®šç”Ÿäº§ä»€ä¹ˆäº§å“ã€‚</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstractFactoryï¼‰ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºäº§å“æ—çš„æ¥å£ï¼Œå…¶æ¯ä¸ªå­ç±»å¯ä»¥ç”Ÿäº§ä¸€ç³»åˆ—ç›¸å…³çš„äº§å“ã€‚</li><li>å»ºé€ è€…æ¨¡å¼ï¼ˆBuilderï¼‰ï¼šå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡åˆ†è§£æˆå¤šä¸ªç›¸å¯¹ç®€å•çš„éƒ¨åˆ†ï¼Œç„¶åæ ¹æ®ä¸åŒéœ€è¦åˆ†åˆ«åˆ›å»ºå®ƒä»¬ï¼Œæœ€åæ„å»ºæˆè¯¥å¤æ‚å¯¹è±¡ã€‚</li><li>ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰ï¼šä¸ºæŸå¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¯¥å¯¹è±¡çš„è®¿é—®ã€‚å³å®¢æˆ·ç«¯é€šè¿‡ä»£ç†é—´æ¥åœ°è®¿é—®è¯¥å¯¹è±¡ï¼Œä»è€Œé™åˆ¶ã€å¢å¼ºæˆ–ä¿®æ”¹è¯¥å¯¹è±¡çš„ä¸€äº›ç‰¹æ€§ã€‚</li><li>é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰ï¼šå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»èƒ½ä¸€èµ·å·¥ä½œã€‚</li><li>æ¡¥æ¥æ¨¡å¼ï¼ˆBridgeï¼‰ï¼šå°†æŠ½è±¡ä¸å®ç°åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚å®ƒæ˜¯ç”¨ç»„åˆå…³ç³»ä»£æ›¿ç»§æ‰¿å…³ç³»æ¥å®ç°ï¼Œä»è€Œé™ä½äº†æŠ½è±¡å’Œå®ç°è¿™ä¸¤ä¸ªå¯å˜ç»´åº¦çš„è€¦åˆåº¦ã€‚</li><li>è£…é¥°æ¨¡å¼ï¼ˆDecoratorï¼‰ï¼šåŠ¨æ€çš„ç»™å¯¹è±¡å¢åŠ ä¸€äº›èŒè´£ï¼Œå³å¢åŠ å…¶é¢å¤–çš„åŠŸèƒ½ã€‚</li><li>å¤–è§‚æ¨¡å¼ï¼ˆFacadeï¼‰ï¼šä¸ºå¤šä¸ªå¤æ‚çš„å­ç³»ç»Ÿæä¾›ä¸€ä¸ªä¸€è‡´çš„æ¥å£ï¼Œä½¿è¿™äº›å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“è¢«è®¿é—®ã€‚</li><li>äº«å…ƒæ¨¡å¼ï¼ˆFlyweightï¼‰ï¼šè¿ç”¨å…±äº«æŠ€æœ¯æ¥æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„å¤ç”¨ã€‚</li><li>ç»„åˆæ¨¡å¼ï¼ˆCompositeï¼‰ï¼šå°†å¯¹è±¡ç»„åˆæˆæ ‘çŠ¶å±‚æ¬¡ç»“æ„ï¼Œä½¿ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡å…·æœ‰ä¸€è‡´çš„è®¿é—®æ€§ã€‚</li><li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplateMethodï¼‰ï¼šå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•éª¨æ¶ï¼Œè€Œå°†ç®—æ³•çš„ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜è¯¥ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</li><li>ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ï¼šå®šä¹‰äº†ä¸€ç³»åˆ—ç®—æ³•ï¼Œå¹¶å°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œä¸”ç®—æ³•çš„æ”¹å˜ä¸ä¼šå½±å“ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚</li><li>å‘½ä»¤æ¨¡å¼ï¼ˆCommandï¼‰ï¼šå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä½¿å‘å‡ºè¯·æ±‚çš„è´£ä»»å’Œæ‰§è¡Œè¯·æ±‚çš„è´£ä»»åˆ†å‰²å¼€ã€‚</li><li>èŒè´£é“¾æ¨¡å¼ï¼ˆChain of Responsibilityï¼‰ï¼šæŠŠè¯·æ±‚ä»é“¾ä¸­çš„ä¸€ä¸ªå¯¹è±¡ä¼ åˆ°ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼Œç›´åˆ°è¯·æ±‚è¢«å“åº”ä¸ºæ­¢ã€‚é€šè¿‡è¿™ç§æ–¹å¼å»é™¤å¯¹è±¡ä¹‹é—´çš„è€¦åˆã€‚</li><li>çŠ¶æ€æ¨¡å¼ï¼ˆStateï¼‰ï¼šå…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å…¶è¡Œä¸ºèƒ½åŠ›ã€‚</li><li>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰ï¼šå¤šä¸ªå¯¹è±¡é—´å­˜åœ¨ä¸€å¯¹å¤šå…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒæŠŠè¿™ç§æ”¹å˜é€šçŸ¥ç»™å…¶ä»–å¤šä¸ªå¯¹è±¡ï¼Œä»è€Œå½±å“å…¶ä»–å¯¹è±¡çš„è¡Œä¸ºã€‚</li><li>ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediatorï¼‰ï¼šå®šä¹‰ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥ç®€åŒ–åŸæœ‰å¯¹è±¡ä¹‹é—´çš„äº¤äº’å…³ç³»ï¼Œé™ä½ç³»ç»Ÿä¸­å¯¹è±¡é—´çš„è€¦åˆåº¦ï¼Œä½¿åŸæœ‰å¯¹è±¡ä¹‹é—´ä¸å¿…ç›¸äº’äº†è§£ã€‚</li><li>è¿­ä»£å™¨æ¨¡å¼ï¼ˆIteratorï¼‰ï¼šæä¾›ä¸€ç§æ–¹æ³•æ¥é¡ºåºè®¿é—®èšåˆå¯¹è±¡ä¸­çš„ä¸€ç³»åˆ—æ•°æ®ï¼Œè€Œä¸æš´éœ²èšåˆå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</li><li>è®¿é—®è€…æ¨¡å¼ï¼ˆVisitorï¼‰ï¼šåœ¨ä¸æ”¹å˜é›†åˆå…ƒç´ çš„å‰æä¸‹ï¼Œä¸ºä¸€ä¸ªé›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ æä¾›å¤šç§è®¿é—®æ–¹å¼ï¼Œå³æ¯ä¸ªå…ƒç´ æœ‰å¤šä¸ªè®¿é—®è€…å¯¹è±¡è®¿é—®ã€‚</li><li>å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMementoï¼‰<br>ï¼šåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œè·å–å¹¶ä¿å­˜ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œä»¥ä¾¿ä»¥åæ¢å¤ã€‚</li><li>è§£é‡Šå™¨ï¼ˆInterpreterï¼‰æ¨¡å¼ï¼šæä¾›å¦‚ä½•å®šä¹‰è¯­è¨€çš„æ–‡æ³•ï¼Œä»¥åŠå¯¹è¯­è¨€å¥å­çš„è§£é‡Šæ–¹æ³•ï¼Œå³è§£é‡Šå™¨ã€‚</li></ol><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™23ç§è®¾è®¡æ¨¡å¼ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œå¾ˆå¤šæ¨¡å¼ä¹‹é—´å­˜åœ¨ä¸€å®šçš„å…³è”å…³ç³»ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> GOFè®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> GOF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€çŸ¥è¯†</title>
      <link href="2019/12/12/reading-notes/java8-in-action/Part-I-Basics/"/>
      <url>2019/12/12/reading-notes/java8-in-action/Part-I-Basics/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€ç« ï¼šä¸ºä»€ä¹ˆè¦å…³å¿ƒJava-8"><a href="#ç¬¬ä¸€ç« ï¼šä¸ºä»€ä¹ˆè¦å…³å¿ƒJava-8" class="headerlink" title="ç¬¬ä¸€ç« ï¼šä¸ºä»€ä¹ˆè¦å…³å¿ƒJava 8"></a>ç¬¬ä¸€ç« ï¼šä¸ºä»€ä¹ˆè¦å…³å¿ƒJava 8</h2><p>ç¬¬ä¸€ç« ä¸»è¦éœ€è¦äº†è§£Javaè¯­è¨€çš„å‘å±•å†å²ã€‚</p><h3 id="Java-8çš„å‰ä¸–ä»Šç”Ÿ"><a href="#Java-8çš„å‰ä¸–ä»Šç”Ÿ" class="headerlink" title="Java 8çš„å‰ä¸–ä»Šç”Ÿ"></a>Java 8çš„å‰ä¸–ä»Šç”Ÿ</h3><p>ä»ç¬¬ä¸€ä¸ªJavaç‰ˆæœ¬è¯ç”Ÿåˆ°ç°åœ¨å·²ç»æœ‰23å¹´çš„æ—¶é—´äº†ã€‚æ²§æµ·æ¡‘ç”°ä¸€ç¬é—´ï¼Œè½¬çœ¼24å¹´è¿‡å»äº†ï¼Œå¦‚ä»ŠJDK 8ä»¥ä¸Šçš„ç‰ˆæœ¬ä¹Ÿå¼€å§‹æ”¶è´¹äº†ï¼ŒJDK 11æˆä¸ºç›®å‰é•¿æœŸæ”¯æŒçš„ç‰ˆæœ¬ã€‚ç‰ˆæœ¬ä¸æ–­å˜æ›´çš„è¿™å‡ å¹´ï¼Œå¾ˆå¤šä¼ä¸šé¡¹ç›®è¿˜æ˜¯åœ¨ç”¨JDK 8æˆ–æ›´ä½çš„ç‰ˆæœ¬è¿›è¡Œç»´æŠ¤ã€‚ä½†æ˜¯å¯¹äºæˆ‘ä»¬å¼€å‘è€…æ¥è¯´ï¼Œå§‹ç»ˆè¦ä¸æ–­åœ°å­¦ä¹ äº†è§£æ–°ç‰¹æ€§å’Œæ–°æŠ€æœ¯ï¼Œå¦åˆ™å¤§æµªæ·˜æ²™ï¼Œç»ˆæœ‰ä¸€æ—¥å°†æˆä¸ºæ²™æ»©ä¸Šçš„ä¸€æ¡å’¸é±¼ã€‚</p><p>æ—¶é—´åœ¨å˜ï¼Œä½†æˆ‘ä»¬å¯¹æŠ€æœ¯çš„é‚£ä»½åˆå¿ƒæ°¸ä¸ä¼šå˜ã€‚ä½œä¸ºä¸€ä¸ªJavaå¼€å‘å·¥ç¨‹å¸ˆï¼Œå¾ˆæœ‰å¿…è¦æ¥äº†è§£ä¸€ä¸‹Javaè¯­è¨€å‘å±•å²ã€‚</p><p><img src="https://i.loli.net/2020/02/15/cWvm6DXU2Yz1kqP.png" alt="1-JavaTimeline.png"></p><p>1995å¹´5æœˆ23æ—¥ï¼Œä»Oakï¼ˆæ©¡æ ‘ï¼‰åˆ°Javaï¼ŒJavaè¯­è¨€ç¬¬ä¸€æ¬¡æå‡ºäº†â€Write Once, Run Anywhereâ€çš„å£å·ã€‚</p><p>1996å¹´1æœˆ23æ—¥ï¼ŒJavaè¯­è¨€çš„ç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬çš„è¿è¡Œç¯å¢ƒJDK 1.0å‘å¸ƒã€‚</p><p>1998å¹´12æœˆ4æ—¥ï¼ŒJDKçš„ç¬¬ä¸€ä¸ªé‡Œç¨‹ç¢‘å¼çš„ç‰ˆæœ¬JDK 1.2å‘å¸ƒï¼Œå·¥ç¨‹ä»£å·ä¸ºPlaygroundï¼ˆç«æŠ€åœºï¼‰ã€‚sunå…¬å¸åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­æŠŠJavaæŠ€æœ¯ä½“ç³»æ‹†åˆ†ä¸ºä¸‰ä¸ªæ–¹å‘ï¼Œåˆ†åˆ«æ˜¯é¢å‘æ¡Œé¢åº”ç”¨å¼€å‘çš„J2SEï¼ˆJava 2 Platformï¼ŒStandard Editionï¼‰ã€é¢å‘ä¼ä¸šçº§å¼€å‘çš„J2EEï¼ˆJava 2 Platformï¼ŒEnterprise Editionï¼‰å’Œé¢å‘æ‰‹æœºç­‰ç§»åŠ¨ç»ˆç«¯å¼€å‘çš„J2MEï¼ˆJava 2 Platformï¼ŒMicro Editionï¼‰ã€‚</p><p>2000å¹´5æœˆ8æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºKestrelï¼ˆç¾æ´²çº¢éš¼ [sÇ”n] ï¼‰çš„JDK 1.3å‘å¸ƒï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªä¿®æ­£ç‰ˆæœ¬JDK 1.3.1ï¼Œå·¥ç¨‹ä»£å·ä¸ºLadybirdï¼ˆç“¢è™«ï¼‰ï¼Œäº2001å¹´5æœˆ17æ—¥å‘å¸ƒã€‚ä»è¿™ä¸ªç‰ˆæœ¬å¼€å§‹ï¼ŒSunå…¬å¸ç»´æŒäº†ä¸€ä¸ªä¹ æƒ¯ï¼šå¤§çº¦æ¯éš”ä¸¤å¹´å‘å¸ƒä¸€ä¸ªJDKçš„ä¸»ç‰ˆæœ¬ï¼Œä»¥åŠ¨ç‰©å‘½åï¼ŒæœŸé—´å‘å¸ƒçš„å„ä¸ªä¿®æ­£ç‰ˆæœ¬åˆ™ä»¥æ˜†è™«ä½œä¸ºå·¥ç¨‹åç§°ã€‚</p><p>2002å¹´2æœˆ13æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºMerlinï¼ˆç°èƒŒéš¼ï¼‰çš„JDK 1.4å‘å¸ƒã€‚åç»­è¿˜æœ‰ä¸¤ä¸ªä¿®æ­£ç‰ˆæœ¬ï¼š2002å¹´9æœˆ16æ—¥å‘å¸ƒçš„å·¥ç¨‹ä»£å·ä¸ºGrasshopperï¼ˆèš±èœ¢ï¼‰çš„JDK 1.4.1å’Œ2003å¹´6æœˆ26æ—¥å‘å¸ƒçš„å·¥ç¨‹ä»£å·ä¸ºMantisï¼ˆè³è‚ï¼‰çš„JDK 1.4.2ã€‚</p><p>2004å¹´9æœˆ30æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºTigerï¼ˆè€è™ï¼‰çš„JDK 1.5å‘å¸ƒã€‚è¿™ä¸ªç‰ˆæœ¬çš„JDKåœ¨æˆ‘çœ‹æ¥æ˜¯Javaè¯­è¨€èƒ½å‘å±•åˆ°ä»Šå¤©çš„åŸºçŸ³ã€‚å®ƒæä¾›äº†è‡ªåŠ¨è£…ç®±ã€æ³›å‹ã€åŠ¨æ€æ³¨è§£ã€æšä¸¾ã€å¯å˜é•¿å‚æ•°ã€foreachå¾ªç¯å’Œjava.util.concurrentå¹¶å‘åŒ…ç­‰æ–°ç‰¹æ€§ï¼Œè¿™äº›æ–°ç‰¹æ€§éƒ½æ˜¯Javaè¯­è¨€çš„ç”Ÿå‘½ä¹‹æ‰€åœ¨ã€‚å®˜æ–¹ä»è¿™ä¸ªç‰ˆæœ¬å¼€å§‹ï¼Œåœ¨æ­£å¼æ–‡æ¡£ä¸å®£ä¼ ä¸Šéƒ½ä¸å†ä½¿ç”¨ç±»ä¼¼JDK 1.5çš„å‘½åï¼Œè€Œæ˜¯ä½¿ç”¨JDK 5ï¼ŒJDK 6ï¼ŒJDK 7â€¦ã€‚åªæœ‰åœ¨ç¨‹åºå‘˜å†…éƒ¨ä½¿ç”¨çš„å¼€å‘ç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚java-versionçš„è¾“å‡ºï¼‰ä¸­æ‰ç»§ç»­æ²¿ç”¨1.5ï¼Œ1.6ï¼Œ1.7çš„ç‰ˆæœ¬å·ã€‚</p><p>2006å¹´12æœˆ11æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºMustangï¼ˆé‡é©¬ï¼‰çš„JDK 6å‘å¸ƒã€‚åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼ŒSunå…¬å¸ç»ˆç»“äº†ä»JDK 1.2å¼€å§‹å·²ç»æœ‰8å¹´å†å²çš„J2EEã€J2SEã€J2MEçš„å‘½åæ–¹å¼ï¼Œå¯ç”¨Java SEã€Java EEã€Java MEçš„å‘½åæ–¹å¼ã€‚åŒå¹´11æœˆ13æ—¥çš„JavaOneå¤§ä¼šä¸Šï¼ŒSunå…¬å¸å®£å¸ƒå°†Javaå¼€æºï¼Œå¹¶å»ºç«‹OpenJDKç»„ç»‡å¯¹å¼€æºä»£ç è¿›è¡Œç®¡ç†ã€‚</p><p>2009å¹´2æœˆ19æ—¥ï¼Œå·¥ç¨‹ä»£å·ä¸ºDolphinï¼ˆæµ·è±šï¼‰çš„JDK 7çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒã€‚JDK 7æœ¬åº”æ˜¯ä¸€ä¸ªåŒ…å«è®¸å¤šé‡è¦æ”¹è¿›çš„ç‰ˆæœ¬ï¼ŒJDK 8ä¸­çš„Lambdaé¡¹ç›®åŸæœ¬è®¡åˆ’å®‰æ’åœ¨JDK 7ä¸­å‘å¸ƒï¼Œä½†ç”±äºå„ç§å•†ä¸šåŸå› ï¼ŒSunå…¬å¸æ— åŠ›è¿›è¡ŒJDK 7çš„ç ”å‘å·¥ä½œã€‚åŒå¹´4æœˆ20æ—¥ï¼ŒOracleå…¬å¸æ”¶è´­Sunå…¬å¸ï¼Œå°†å¾ˆå¤šæœªå®ç°çš„æ”¹è¿›è¿›è¡Œè£å‰ªå»¶æœŸï¼Œä»¥ä¿è¯JDK 7çš„æ­£å¼ç‰ˆèƒ½å¤Ÿåœ¨2011å¹´7æœˆ28æ—¥å‡†æ—¶å‘å¸ƒã€‚</p><p>2011å¹´7æœˆ28æ—¥ï¼ŒOracleå…¬å¸å‘å¸ƒå·¥ç¨‹ä»£å·ä¸ºDolphinï¼ˆæµ·è±šï¼‰çš„JDK 7æ­£å¼ç‰ˆã€‚</p><p>2014å¹´3æœˆ18æ—¥ï¼ŒOracleå…¬å¸å‘å¸ƒå·¥ç¨‹ä»£å·ä¸ºSpiderï¼ˆèœ˜è››ï¼‰çš„JDK 8ã€‚</p><p>2017å¹´9æœˆ21æ—¥ï¼ŒOracleå…¬å¸å‘å¸ƒJDK 9ã€‚</p><h3 id="Java-8çš„æ–°ç‰¹æ€§åˆ—è¡¨"><a href="#Java-8çš„æ–°ç‰¹æ€§åˆ—è¡¨" class="headerlink" title="Java 8çš„æ–°ç‰¹æ€§åˆ—è¡¨"></a>Java 8çš„æ–°ç‰¹æ€§åˆ—è¡¨</h3><ul><li>Lambdaè¡¨è¾¾å¼å’Œæ–¹æ³•å¼•ç”¨</li><li>æµå¤„ç†StreamAPI</li><li>é»˜è®¤æ–¹æ³•</li><li>Optionalç±»</li><li>CompletableFutureæ¥å£</li><li>æ–°çš„æ—¥æœŸæ—¶é—´API</li></ul><h2 id="ç¬¬äºŒç« ï¼šé€šè¿‡è¡Œä¸ºå‚æ•°åŒ–ä¼ é€’ä»£ç "><a href="#ç¬¬äºŒç« ï¼šé€šè¿‡è¡Œä¸ºå‚æ•°åŒ–ä¼ é€’ä»£ç " class="headerlink" title="ç¬¬äºŒç« ï¼šé€šè¿‡è¡Œä¸ºå‚æ•°åŒ–ä¼ é€’ä»£ç "></a>ç¬¬äºŒç« ï¼šé€šè¿‡è¡Œä¸ºå‚æ•°åŒ–ä¼ é€’ä»£ç </h2><ol><li>è¡Œä¸ºå‚æ•°åŒ–ï¼Œå°±æ˜¯ä¸€ä¸ªæ–¹æ³•æ¥å—å¤šä¸ªä¸åŒçš„è¡Œä¸ºä½œä¸ºå‚æ•°ï¼Œå¹¶åœ¨å†…éƒ¨ä½¿ç”¨å®ƒä»¬ï¼Œå®Œæˆä¸åŒè¡Œä¸ºçš„èƒ½åŠ›ã€‚</li><li>è¡Œä¸ºå‚æ•°åŒ–å¯è®©ä»£ç æ›´å¥½åœ°é€‚åº”ä¸æ–­å˜åŒ–çš„è¦æ±‚ï¼Œå‡è½»æœªæ¥çš„å·¥ä½œé‡ã€‚</li><li>ä¼ é€’ä»£ç ï¼Œå°±æ˜¯å°†æ–°è¡Œä¸ºä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•ã€‚ä½†åœ¨Java 8ä¹‹å‰è¿™å®ç°èµ·æ¥å¾ˆå•°å—¦ã€‚ä¸ºæ¥å£å£°æ˜è®¸å¤šåªç”¨ä¸€æ¬¡çš„å®ä½“ç±»è€Œé€ æˆçš„å•°å—¦ä»£ç ï¼Œåœ¨Java 8ä¹‹å‰å¯ä»¥ç”¨åŒ¿åç±»æ¥å‡å°‘ã€‚</li><li>Java APIåŒ…å«å¾ˆå¤šå¯ä»¥ç”¨ä¸åŒè¡Œä¸ºè¿›è¡Œå‚æ•°åŒ–çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬æ’åºã€çº¿ç¨‹å’ŒGUIå¤„ç†ã€‚</li></ol><h2 id="ç¬¬ä¸‰ç« ï¼šLambdaè¡¨è¾¾å¼"><a href="#ç¬¬ä¸‰ç« ï¼šLambdaè¡¨è¾¾å¼" class="headerlink" title="ç¬¬ä¸‰ç« ï¼šLambdaè¡¨è¾¾å¼"></a>ç¬¬ä¸‰ç« ï¼šLambdaè¡¨è¾¾å¼</h2><h3 id="å‡½æ•°å¼æ¥å£"><a href="#å‡½æ•°å¼æ¥å£" class="headerlink" title="å‡½æ•°å¼æ¥å£"></a>å‡½æ•°å¼æ¥å£</h3><p>å‡½æ•°å¼æ¥å£å°±æ˜¯åªå®šä¹‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ã€‚<br>æ¥å£ç°åœ¨è¿˜å¯ä»¥æ‹¥æœ‰é»˜è®¤æ–¹æ³•ï¼ˆå³åœ¨ç±»æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡Œå®ç°æ—¶ï¼Œå…¶ä¸»ä½“ä¸ºæ–¹æ³•æä¾›é»˜è®¤å®ç°çš„æ–¹æ³•ï¼‰ã€‚<br>å“ªæ€•æœ‰å¾ˆå¤šé»˜è®¤æ–¹æ³•ï¼Œåªè¦æ¥å£åªå®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒå°±ä»ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚</p><p>å‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•çš„ç­¾åç§°ä¸ºå‡½æ•°æè¿°ç¬¦ã€‚</p><h3 id="Java8-å†…ç½®å››å¤§æ ¸å¿ƒå‡½æ•°å¼æ¥å£"><a href="#Java8-å†…ç½®å››å¤§æ ¸å¿ƒå‡½æ•°å¼æ¥å£" class="headerlink" title="Java8 å†…ç½®å››å¤§æ ¸å¿ƒå‡½æ•°å¼æ¥å£"></a>Java8 å†…ç½®å››å¤§æ ¸å¿ƒå‡½æ•°å¼æ¥å£</h3><p>java.util.functionåŒ…ä¸‹ï¼š</p><ol><li>æ¶ˆè´¹å‹æ¥å£ï¼š<code>Consumer&lt;T&gt; &#123;void accept(T t);&#125;</code></li><li>ä¾›ç»™å‹æ¥å£ï¼š<code>Supplier&lt;T&gt; &#123;T get();&#125;</code></li><li>å‡½æ•°å‹æ¥å£ï¼š<code>Function&lt;T,R&gt; &#123;R apply(T t);&#125;</code></li><li>æ–­è¨€å‹æ¥å£ï¼š<code>Predicate&lt;T&gt; &#123;boolean test(T t);&#125;</code></li></ol><h3 id="åŸå§‹ç±»å‹ç‰¹åŒ–å‡½æ•°å¼æ¥å£"><a href="#åŸå§‹ç±»å‹ç‰¹åŒ–å‡½æ•°å¼æ¥å£" class="headerlink" title="åŸå§‹ç±»å‹ç‰¹åŒ–å‡½æ•°å¼æ¥å£"></a>åŸå§‹ç±»å‹ç‰¹åŒ–å‡½æ•°å¼æ¥å£</h3><p>ä¸ºäº†é¿å…è£…ç®±æ“ä½œï¼Œå¯¹<code>Predicate&lt;T&gt;</code>å’Œ<code>Function&lt;T, R&gt;</code>ç­‰é€šç”¨å‡½æ•°å¼æ¥å£çš„åŸå§‹ç±»å‹ç‰¹åŒ–ï¼š<code>IntPredicate</code>ã€<code>IntToLongFunction</code>ç­‰ã€‚ </p><h3 id="æ–¹æ³•å¼•ç”¨"><a href="#æ–¹æ³•å¼•ç”¨" class="headerlink" title="æ–¹æ³•å¼•ç”¨"></a>æ–¹æ³•å¼•ç”¨</h3><p>å¦‚æœä¸€ä¸ªLambdaä»£è¡¨çš„åªæ˜¯â€œç›´æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•â€ï¼Œé‚£å¥½è¿˜æ˜¯ç”¨åç§°æ¥è°ƒç”¨å®ƒï¼Œè€Œä¸æ˜¯å»æè¿°å¦‚ä½•è°ƒç”¨å®ƒã€‚</p><h4 id="å¦‚ä½•æ„å»ºæ–¹æ³•å¼•ç”¨"><a href="#å¦‚ä½•æ„å»ºæ–¹æ³•å¼•ç”¨" class="headerlink" title="å¦‚ä½•æ„å»ºæ–¹æ³•å¼•ç”¨"></a>å¦‚ä½•æ„å»ºæ–¹æ³•å¼•ç”¨</h4><p>æ–¹æ³•å¼•ç”¨ä¸»è¦æœ‰ä¸‰ç±»ã€‚ </p><p>(1) æŒ‡å‘é™æ€æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨ï¼ˆä¾‹å¦‚Integerçš„parseIntæ–¹æ³•ï¼Œå†™ä½œ<code>Integer::parseInt</code>ï¼‰ã€‚</p><p>(2) æŒ‡å‘ä»»æ„ç±»å‹å®ä¾‹æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨ï¼ˆä¾‹å¦‚String çš„ length æ–¹æ³•ï¼Œå†™ä½œ<code>String::length</code>ï¼‰ã€‚</p><p>(3) æŒ‡å‘ç°æœ‰å¯¹è±¡çš„å®ä¾‹æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨ï¼ˆå‡è®¾ä½ æœ‰ä¸€ä¸ªå±€éƒ¨å˜é‡<code>expensiveTransaction</code>ç”¨äºå­˜æ”¾<code>Transaction</code>ç±»å‹çš„å¯¹è±¡ï¼Œå®ƒæ”¯æŒå®ä¾‹æ–¹æ³•getValueï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥å†™<code>expensive- Transaction::getValue</code>ï¼‰ã€‚</p><h4 id="å°†Lambdaè¡¨è¾¾å¼é‡æ„ä¸ºç­‰ä»·çš„æ–¹æ³•å¼•ç”¨"><a href="#å°†Lambdaè¡¨è¾¾å¼é‡æ„ä¸ºç­‰ä»·çš„æ–¹æ³•å¼•ç”¨" class="headerlink" title="å°†Lambdaè¡¨è¾¾å¼é‡æ„ä¸ºç­‰ä»·çš„æ–¹æ³•å¼•ç”¨"></a>å°†Lambdaè¡¨è¾¾å¼é‡æ„ä¸ºç­‰ä»·çš„æ–¹æ³•å¼•ç”¨</h4><p>(1) Lambdaï¼š<code>(args) -&gt; ClassName.staticMethod(args)</code></p><p>ç­‰ä»·çš„æ–¹æ³•å¼•ç”¨ä¸ºï¼š<code>ClassName::staticMethod</code>ã€‚</p><p>(2) Lambdaï¼š<code>(arg0,test) -&gt; arg0.instanceMethod(test)</code></p><p>ç­‰ä»·çš„æ–¹æ³•å¼•ç”¨ä¸ºï¼š<code>ClassName::instanceMethod</code>ï¼Œå…¶ä¸­arg0çš„ç±»å‹æ˜¯ClassNameã€‚</p><p>(3) Lambdaï¼š<code>(args) -&gt; expr.instanceMethod(args)</code></p><p>ç­‰ä»·çš„æ–¹æ³•å¼•ç”¨ä¸ºï¼š<code>expr::instanceMethod</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
          <category> Java 8å®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆä¸€ï¼‰ï¼šæ¥å£é‡æ„å’Œæ–°ç‰¹æ€§</title>
      <link href="2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(1)/"/>
      <url>2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(1)/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬å…«ç« ï¼šé‡æ„ã€æµ‹è¯•å’Œè°ƒè¯•"><a href="#ç¬¬å…«ç« ï¼šé‡æ„ã€æµ‹è¯•å’Œè°ƒè¯•" class="headerlink" title="ç¬¬å…«ç« ï¼šé‡æ„ã€æµ‹è¯•å’Œè°ƒè¯•"></a>ç¬¬å…«ç« ï¼šé‡æ„ã€æµ‹è¯•å’Œè°ƒè¯•</h2><h3 id="1-ä¸ºæ”¹å–„å¯è¯»æ€§å’Œçµæ´»æ€§é‡æ„ä»£ç "><a href="#1-ä¸ºæ”¹å–„å¯è¯»æ€§å’Œçµæ´»æ€§é‡æ„ä»£ç " class="headerlink" title="1. ä¸ºæ”¹å–„å¯è¯»æ€§å’Œçµæ´»æ€§é‡æ„ä»£ç "></a>1. ä¸ºæ”¹å–„å¯è¯»æ€§å’Œçµæ´»æ€§é‡æ„ä»£ç </h3><p>å¦‚æœæ–¹å‘é”™äº†ï¼Œåœä¸‹æ¥å°±æ˜¯å‰è¿›ã€‚</p><p>çœ‹å®Œè€å‘˜å·¥ç•™ä¸‹æ¥çš„ä»£ç ï¼Œæ— åŠ›åæ§½ã€‚å¦‚æœä»¥ç³»ç»Ÿç¨³å®šå¯ç”¨ä¸ºåŸåˆ™ï¼Œä¸å»æ”¹å–„ä»£ç å¯ç»´æŠ¤æ€§ï¼Œé‚£ç­‰åˆ°å°†æ¥éœ€æ±‚å˜åŠ¨éœ€è¦ä¿®æ”¹æ—¶ï¼Œå¯¹æˆ‘ä»¬è¿™äº›åº•å±‚ç å†œæ¥è¯´ç®€ç›´æ˜¯ä¸€ç§æŠ˜ç£¨ã€‚æ¬ ä¸‹çš„æŠ€æœ¯å€ºè¿Ÿæ—©æ˜¯è¦è¿˜çš„ã€‚</p><h4 id="1-1-ä»åŒ¿åç±»åˆ°Lambdaè¡¨è¾¾å¼çš„è½¬æ¢"><a href="#1-1-ä»åŒ¿åç±»åˆ°Lambdaè¡¨è¾¾å¼çš„è½¬æ¢" class="headerlink" title="1.1 ä»åŒ¿åç±»åˆ°Lambdaè¡¨è¾¾å¼çš„è½¬æ¢"></a>1.1 ä»åŒ¿åç±»åˆ°Lambdaè¡¨è¾¾å¼çš„è½¬æ¢</h4><p>åŒ¿åç±»å’ŒLambdaè¡¨è¾¾å¼ä¸­çš„<code>this</code>å«ä¹‰æ˜¯ä¸åŒçš„ã€‚åœ¨åŒ¿åç±»ä¸­ï¼ŒthisæŒ‡ä»£çš„æ˜¯åŒ¿åç±»æœ¬èº«ã€‚ä½†æ˜¯åœ¨Lambdaä¸­ï¼Œ<code>this</code>æŒ‡ä»£çš„æ˜¯åŒ…å«Lambdaè¡¨è¾¾å¼çš„ç±»ã€‚</p><p>åŒ¿åç±»å¯ä»¥å±è”½åŒ…å«ç±»çš„å˜é‡ï¼Œè€ŒLambdaè¡¨è¾¾å¼ä¸èƒ½ï¼ˆç¼–è¯‘éƒ½ä¸èƒ½é€šè¿‡ï¼‰ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public void testAnonymityToLambda() &#123;</span><br><span class="line">    int a &#x3D; 10;</span><br><span class="line">    Runnable r1 &#x3D; () -&gt; &#123;</span><br><span class="line">        &#x2F;&#x2F; å†æ¬¡å®šä¹‰aå˜é‡ä¼šæŠ¥é”™</span><br><span class="line">        &#x2F;&#x2F; int a &#x3D; 1;</span><br><span class="line">        System.out.println(a);</span><br><span class="line">    &#125;;</span><br><span class="line">    Runnable r2 &#x3D; new Runnable() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void run() &#123;</span><br><span class="line">            int a &#x3D; 2;</span><br><span class="line">            System.out.println(a);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-2-ä½¿ç”¨Lambdaé‡æ„è®¾è®¡æ¨¡å¼"><a href="#1-2-ä½¿ç”¨Lambdaé‡æ„è®¾è®¡æ¨¡å¼" class="headerlink" title="1.2 ä½¿ç”¨Lambdaé‡æ„è®¾è®¡æ¨¡å¼"></a>1.2 ä½¿ç”¨Lambdaé‡æ„è®¾è®¡æ¨¡å¼</h4><p>Lambdaè¡¨è¾¾å¼ä¸ºè§£å†³ä¼ ç»Ÿè®¾è®¡æ¨¡å¼æ‰€é¢å¯¹çš„é—®é¢˜æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆã€‚ä½¿ç”¨Lambdaè¡¨è¾¾å¼åï¼Œ å¾ˆå¤šç°å­˜çš„ç•¥æ˜¾è‡ƒè‚¿çš„é¢å‘å¯¹è±¡è®¾è®¡æ¨¡å¼èƒ½å¤Ÿç”¨æ›´ç²¾ç®€çš„æ–¹å¼å®ç°äº†ã€‚<br>ä¾‹å¦‚ï¼š</p><ul><li>ç­–ç•¥æ¨¡å¼</li><li>æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼</li><li>è´£ä»»é“¾æ¨¡å¼</li><li>å·¥å‚æ¨¡å¼</li></ul><h3 id="2-æµ‹è¯•Lambdaè¡¨è¾¾å¼"><a href="#2-æµ‹è¯•Lambdaè¡¨è¾¾å¼" class="headerlink" title="2. æµ‹è¯•Lambdaè¡¨è¾¾å¼"></a>2. æµ‹è¯•Lambdaè¡¨è¾¾å¼</h3><p>ä½¿ç”¨Streamæ¥å£æä¾›çš„<code>peek</code>æ–¹æ³•å¯æŸ¥çœ‹æµæ°´çº¿ä¸­æ¯ä¸ªæ“ä½œçš„ä¸­é—´çŠ¶æ€ï¼Œæ–¹ä¾¿è°ƒè¯•æ’é”™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public static void testPeek() &#123;</span><br><span class="line">    List&lt;Integer&gt; nums &#x3D; Arrays.asList(1, 2, 3, 4, 5, 6, 7);</span><br><span class="line">    nums.stream()</span><br><span class="line">            .peek(x -&gt; System.out.println(&quot;before map&quot; + x))</span><br><span class="line">            .map(x -&gt; x + 17)</span><br><span class="line">            .peek(x -&gt; System.out.println(&quot;before filter&quot; + x))</span><br><span class="line">            .filter(x -&gt; x % 2 &#x3D;&#x3D; 0)</span><br><span class="line">            .peek(x -&gt; System.out.println(&quot;before limit&quot; + x))</span><br><span class="line">            .limit(3)</span><br><span class="line">            .peek(x -&gt; System.out.println(&quot;before collect&quot; + x))</span><br><span class="line">            .collect(Collectors.toList())</span><br><span class="line">            .forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¬¬ä¹ç« ï¼šé»˜è®¤æ–¹æ³•"><a href="#ç¬¬ä¹ç« ï¼šé»˜è®¤æ–¹æ³•" class="headerlink" title="ç¬¬ä¹ç« ï¼šé»˜è®¤æ–¹æ³•"></a>ç¬¬ä¹ç« ï¼šé»˜è®¤æ–¹æ³•</h2><p>å…ˆæ¥å›é¡¾ä¸€ä¸‹æ¥å£çš„ç›¸å…³çŸ¥è¯†ã€‚</p><h3 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h3><p>ä½¿ç”¨<code>interface</code>å…³é”®å­—å£°æ˜ï¼Œè®¿é—®ä¿®é¥°ç¬¦å¯ä»¥ä¸º<code>public</code>å’Œé»˜è®¤ï¼ˆä¸å†™ï¼‰ï¼›åŒæ—¶å¯ä»¥ä½¿ç”¨<code>abstract</code>å…³é”®å­—ä¿®é¥°ï¼Œå› ä¸ºæ¥å£å¯ä»¥ç†è§£æˆä¸€ç§å®Œå…¨æŠ½è±¡ã€‚ä½¿ç”¨<code>abstract</code>å…³é”®å­—ç¼–è¯‘å™¨ä¼šè®©ä½ é€šè¿‡ç¼–è¯‘ï¼Œä½†ä¸€èˆ¬æ²¡æœ‰äººè¿™æ ·åšã€‚</p><h4 id="Java-8-å‰"><a href="#Java-8-å‰" class="headerlink" title="Java 8 å‰"></a>Java 8 å‰</h4><ul><li>æ¥å£ä¸­çš„æˆå‘˜å˜é‡çš„ä¿®é¥°ç¬¦å…¨éƒ¨é»˜è®¤ä¸º<code>public static final</code>ï¼Œä¹Ÿå¯ä»¥ä¸æ˜¯é™æ€<code>static</code>çš„ï¼Œä½†ä¸€èˆ¬æ²¡æœ‰äººè¿™æ ·åšã€‚</li><li>æ¥å£ä¸­çš„æ–¹æ³•åªèƒ½æ˜¯æŠ½è±¡æ–¹æ³•ã€‚</li><li>æ¥å£ä¸­æ–¹æ³•çš„ä¿®é¥°ç¬¦å…¨éƒ¨é»˜è®¤ä¸º<code>public abstract</code>ã€‚</li></ul><h4 id="Java-8-å"><a href="#Java-8-å" class="headerlink" title="Java 8 å"></a>Java 8 å</h4><ul><li>æ¥å£ä¸­æ–°å¢é»˜è®¤æ–¹æ³•â€“ä½¿ç”¨<code>default</code>å…³é”®å­—å£°æ˜ã€‚</li><li>æ¥å£ä¸­å¯ä»¥å£°æ˜é™æ€æ–¹æ³•ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆè¦æœ‰é»˜è®¤æ–¹æ³•ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰é»˜è®¤æ–¹æ³•ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æœ‰é»˜è®¤æ–¹æ³•ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦æœ‰é»˜è®¤æ–¹æ³•ï¼Ÿ</h3><p>å¦‚æœåŸæ¥çš„æ¥å£å·²ç»è¢«å¾ˆå¤šäººä½¿ç”¨äº†ï¼Œç°åœ¨è¦åœ¨åŸæ¥çš„æ¥å£ä¸­æ–°å¢ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨Java 8ä¹‹å‰ï¼Œæ‰€æœ‰çš„å®ç°ç±»éƒ½éœ€è¦å»æ˜¾å¼å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œä¼šé€ æˆå¾ˆå¤šä¸å¿…è¦çš„éº»çƒ¦ï¼Œä¹Ÿè®¸æœ‰äº›å®ç°ç±»æ ¹æœ¬å°±ä¸éœ€è¦ç”¨åˆ°æ–°å¢çš„è¿™ä¸ªæ–¹æ³•ï¼Œåè€Œéœ€è¦å¼ºåˆ¶åœ¨ä»£ç ä¸­å†™ä¸€ä¸ªæ˜¾å¼çš„ç©ºå®ç°ã€‚æ­£æ˜¯ç”±äºè¿™ä¸ªåŸå› ï¼ŒJava 8æä¾›äº†é»˜è®¤æ–¹æ³•ï¼Œæ¥å£ä¸­æ–°å¢çš„æ–¹æ³•ä½¿ç”¨<code>default</code>å…³é”®å­—ä¿®é¥°ï¼Œå°±å¯ä»¥åœ¨æ¥å£ä¸­æä¾›ä¸€ä¸ªé»˜è®¤å®ç°ï¼Œå®ç°ç±»ä¸å†éœ€è¦å¼ºåˆ¶æ˜¾å¼å®ç°è¿™ä¸ªæ–°å¢æ–¹æ³•ã€‚è¿™ä¸ªæ–°ç‰¹æ€§ä¸»è¦æ˜¯é¢å‘ç±»åº“å¼€å‘è€…ã€‚</p><h3 id="é»˜è®¤æ–¹æ³•å¼•å‘çš„å¤šå®ç°å†²çªé—®é¢˜"><a href="#é»˜è®¤æ–¹æ³•å¼•å‘çš„å¤šå®ç°å†²çªé—®é¢˜" class="headerlink" title="é»˜è®¤æ–¹æ³•å¼•å‘çš„å¤šå®ç°å†²çªé—®é¢˜"></a>é»˜è®¤æ–¹æ³•å¼•å‘çš„å¤šå®ç°å†²çªé—®é¢˜</h3><p>ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚ç”±äºå‡ºç°äº†é»˜è®¤æ–¹æ³•ï¼Œå½“ä¸€ä¸ªç±»æœ‰å¤šä¸ªå®ç°æ—¶å¯èƒ½ä¼šå‡ºç°æ–¹æ³•ç»§æ‰¿å†²çªçš„é—®é¢˜ã€‚</p><h3 id="è§£å†³é—®é¢˜çš„ä¸‰ä¸ªåŸåˆ™"><a href="#è§£å†³é—®é¢˜çš„ä¸‰ä¸ªåŸåˆ™" class="headerlink" title="è§£å†³é—®é¢˜çš„ä¸‰ä¸ªåŸåˆ™"></a>è§£å†³é—®é¢˜çš„ä¸‰ä¸ªåŸåˆ™</h3><ul><li><p>ç±»ä¸­çš„æ–¹æ³•ä¼˜å…ˆçº§æœ€é«˜ã€‚ç±»æˆ–çˆ¶ç±»ä¸­å£°æ˜çš„æ–¹æ³•çš„ä¼˜å…ˆçº§é«˜äºä»»ä½•å£°æ˜ä¸ºé»˜è®¤æ–¹æ³•çš„ä¼˜å…ˆçº§ã€‚</p></li><li><p>å¦‚æœæ— æ³•ä¾æ®ç¬¬ä¸€æ¡è¿›è¡Œåˆ¤æ–­ï¼Œé‚£ä¹ˆå­æ¥å£çš„ä¼˜å…ˆçº§æ›´é«˜ï¼šå‡½æ•°ç­¾åç›¸åŒæ—¶ï¼Œä¼˜å…ˆé€‰æ‹©æ‹¥æœ‰æœ€å…·ä½“å®ç°çš„é»˜è®¤æ–¹æ³•çš„æ¥å£ï¼Œå³å¦‚æœBç»§æ‰¿äº†Aï¼Œé‚£ä¹ˆBå°±æ¯”Aæ›´åŠ å…·ä½“ã€‚</p></li><li><p>æœ€åï¼Œå¦‚æœè¿˜æ˜¯æ— æ³•åˆ¤æ–­ï¼Œç»§æ‰¿äº†å¤šä¸ªæ¥å£çš„ç±»å¿…é¡»é€šè¿‡æ˜¾å¼è¦†ç›–å’Œè°ƒç”¨æœŸæœ›çš„æ–¹æ³•ï¼Œæ˜¾å¼åœ°é€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªé»˜è®¤æ–¹æ³•çš„å®ç°ã€‚</p></li></ul><h3 id="å†²çªæƒ…å†µåˆ†æ"><a href="#å†²çªæƒ…å†µåˆ†æ" class="headerlink" title="å†²çªæƒ…å†µåˆ†æ"></a>å†²çªæƒ…å†µåˆ†æ</h3><h4 id="æƒ…å½¢ä¸€"><a href="#æƒ…å½¢ä¸€" class="headerlink" title="æƒ…å½¢ä¸€"></a>æƒ…å½¢ä¸€</h4><ul><li>æ¥å£<code>InterfaceA</code>ä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•<code>hello</code>ã€‚</li><li>æ¥å£<code>InterfaceB</code>ç»§æ‰¿äº†æ¥å£<code>InterfaceA</code>ï¼ŒåŒæ—¶æä¾›è‡ªå·±çš„é»˜è®¤<code>hello</code>æ–¹æ³•ã€‚</li><li>å®ç°ç±»<code>ImplClassC</code>å®ç°<code>InterfaceA</code>æ¥å£å’Œ<code>InterfaceB</code>æ¥å£ï¼Œæ²¡æœ‰æ˜¾å¼å®ç°<code>hello</code>æ–¹æ³•ã€‚</li></ul><p><img src="https://i.loli.net/2020/02/15/WIXnvM6jawk92zU.png" alt="9-case1.png"></p><p>æ¥å£<code>InterfaceB</code>ç»§æ‰¿äº†<code>InterfaceA</code>ï¼Œæ¥å£<code>InterfaceB</code>ä¸­çš„<code>hello</code>æ–¹æ³•æ›´å…·ä½“ï¼Œæ‰€ä»¥å®ç°ç±»<code>ImplClassC</code>æ‹¥æœ‰çš„æ˜¯<code>InterfaceB</code>æ¥å£ä¸­çš„<code>hello</code>æ–¹æ³•ã€‚</p><h4 id="æƒ…å½¢äºŒ"><a href="#æƒ…å½¢äºŒ" class="headerlink" title="æƒ…å½¢äºŒ"></a>æƒ…å½¢äºŒ</h4><ul><li>æ¥å£<code>InterfaceA</code>ä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•<code>hello</code>ã€‚</li><li>æ¥å£<code>InterfaceB</code>ç»§æ‰¿äº†æ¥å£<code>InterfaceA</code>ï¼ŒåŒæ—¶æä¾›è‡ªå·±çš„é»˜è®¤<code>hello</code>æ–¹æ³•ã€‚</li><li>å®ç°ç±»<code>ImplClassD</code>å®ç°<code>InterfaceA</code>æ¥å£ï¼Œæœªæ˜¾å¼é‡å†™æ¥å£çš„<code>hello</code>æ–¹æ³•ã€‚</li><li>å®ç°ç±»<code>ImplClassC</code>ç»§æ‰¿<code>ImplClassD</code>ç±»ï¼ŒåŒæ—¶å®ç°<code>InterfaceA</code>å’Œ<code>InterfaceB</code>æ¥å£ï¼Œæ²¡æœ‰æ˜¾å¼å®ç°<code>hello</code>æ–¹æ³•ã€‚</li></ul><p><img src="https://i.loli.net/2020/02/15/e4NTXoVklfH18B3.png" alt="9-case2.png"></p><p><code>ImplClassC</code>å’Œ<code>ImplClassD</code>ç±»ä¸­éƒ½æœªå®ç°<code>hello</code>æ–¹æ³•ï¼Œ<code>InterfaceB</code>ç»§æ‰¿<code>InterfaceA</code>æ¥å£ï¼Œæ‰€ä»¥<code>InterfaceB</code>æ¥å£ä¸­çš„æ–¹æ³•æ›´å…·ä½“ï¼Œæ‰€ä»¥<code>ImplClassC</code>ç±»å…·æœ‰çš„æ˜¯<code>InterfaceB</code>ä¸­çš„<code>hello</code>æ–¹æ³•ã€‚</p><h4 id="æƒ…å½¢ä¸‰"><a href="#æƒ…å½¢ä¸‰" class="headerlink" title="æƒ…å½¢ä¸‰"></a>æƒ…å½¢ä¸‰</h4><ul><li>æ¥å£<code>InterfaceA</code>ä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•<code>hello</code>ã€‚</li><li>æ¥å£<code>InterfaceB</code>ç»§æ‰¿äº†æ¥å£<code>InterfaceA</code>ï¼ŒåŒæ—¶æä¾›è‡ªå·±çš„é»˜è®¤<code>hello</code>æ–¹æ³•ã€‚</li><li>å®ç°ç±»<code>ImplClassD</code>å®ç°äº†<code>InterfaceA</code>æ¥å£ï¼Œå¹¶æ˜¾å¼é‡å†™äº†æ¥å£çš„<code>hello</code>æ–¹æ³•ã€‚</li><li>å®ç°ç±»<code>ImplClassC</code>ç»§æ‰¿äº†<code>ImplClassD</code>å®ç°ç±»ï¼Œå¹¶å®ç°äº†<code>InterfaceA</code>å’Œ<code>InterfaceB</code>æ¥å£ï¼Œæ²¡æœ‰æ˜¾å¼å®ç°<code>hello</code>æ–¹æ³•ã€‚</li></ul><p><img src="https://i.loli.net/2020/02/15/XTn2dPVH6ycYmDJ.png" alt="9-case3.png"></p><p><code>ImplClassC</code>å’Œ<code>ImplClassD</code>ç±»ä¸­éƒ½æœªå®ç°<code>hello</code>æ–¹æ³•ï¼Œ<code>InterfaceB</code>ç»§æ‰¿<code>InterfaceA</code>æ¥å£ï¼Œæ‰€ä»¥<code>InterfaceB</code>æ¥å£ä¸­çš„æ–¹æ³•æ›´å…·ä½“ï¼Œæ‰€ä»¥<code>ImplClassC</code>ç±»å…·æœ‰çš„æ˜¯<code>InterfaceB</code>ä¸­çš„<code>hello</code>æ–¹æ³•ã€‚</p><h4 id="æƒ…å½¢å››"><a href="#æƒ…å½¢å››" class="headerlink" title="æƒ…å½¢å››"></a>æƒ…å½¢å››</h4><ul><li>æ¥å£<code>InterfaceA</code>ä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•<code>hello</code>ã€‚</li><li>æ¥å£<code>InterfaceB</code>ä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•<code>hello</code>ï¼Œæœªç»§æ‰¿ã€‚</li><li>å®ç°ç±»<code>ImplClassC</code>å®ç°<code>InterfaceA</code>å’Œ<code>InterfaceB</code>æ¥å£ã€‚</li></ul><p><img src="https://i.loli.net/2020/02/15/mPzwXtpCIKxqLea.png" alt="9-case4.png"></p><p>å¦‚æœå®ç°ç±»<code>ImplClassC</code>ä¸é‡å†™<code>hello</code>æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šæŠ›å‡ºç¼–è¯‘é”™è¯¯ï¼š<br><code>ImplClassC inherits unrelated defaults for hello() from types InterfaceA and InterfaceB</code>ã€‚</p><p>å¯ä»¥ç›´æ¥åœ¨å®ç°ç±»ä¸­é‡æ–°å†™ä¸€ä¸ª<code>hello</code>æ–¹æ³•çš„å®ç°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>super</code>å…³é”®å­—è°ƒç”¨çˆ¶æ¥å£çš„é»˜è®¤å®ç°ã€‚</p><h4 id="æƒ…å½¢äº”"><a href="#æƒ…å½¢äº”" class="headerlink" title="æƒ…å½¢äº”"></a>æƒ…å½¢äº”</h4><ul><li>æ¥å£<code>InterfaceA</code>ä¸­å®šä¹‰äº†é»˜è®¤æ–¹æ³•<code>hello</code>ã€‚</li><li>æ¥å£<code>InterfaceB</code>ç»§æ‰¿äº†æ¥å£<code>InterfaceA</code>ï¼Œæœªæä¾›ä»»ä½•æ–¹æ³•ã€‚</li><li>æ¥å£<code>InterfaceC</code>ç»§æ‰¿äº†æ¥å£<code>InterfaceA</code>ï¼Œæœªæä¾›ä»»ä½•æ–¹æ³•ã€‚</li><li>å®ç°ç±»<code>ImplClassD</code>å®ç°<code>InterfaceB</code>å’Œ<code>InterfaceC</code>æ¥å£ã€‚</li></ul><p><img src="https://i.loli.net/2020/02/15/DcACmO42doKHy8q.png" alt="9-case5.png"></p><p><code>InterfaceB</code>å’Œ<code>InterfaceC</code>æ¥å£ä¸­éƒ½æ²¡æœ‰<code>hello</code>å®ç°ï¼Œå®ƒä»¬çš„çˆ¶æ¥å£<code>InterfaceA</code>ä¸­æ‰æœ‰<code>hello</code>çš„é»˜è®¤å®ç°ï¼Œæ‰€ä»¥å®ç°ç±»<code>ImplClassD</code>æ‹¥æœ‰æ¥å£<code>InterfaceA</code>ä¸­<code>hello</code>æ–¹æ³•ã€‚</p><h4 id="æƒ…å½¢äº”æ‰©å±•"><a href="#æƒ…å½¢äº”æ‰©å±•" class="headerlink" title="æƒ…å½¢äº”æ‰©å±•"></a>æƒ…å½¢äº”æ‰©å±•</h4><p>å¦‚æœ<code>InterfaceB</code>ä¸­ä¹Ÿæä¾›<code>hello</code>é»˜è®¤å®ç°ï¼Œæ ¹æ®è§„åˆ™ç¬¬äºŒç‚¹ï¼Œç¼–è¯‘å™¨ä¼šé€‰æ‹©<code>InterfaceB</code>ä¸­å£°æ˜çš„é»˜è®¤æ–¹æ³•ã€‚</p><p>å¦‚æœ<code>InterfaceB</code>å’Œ<code>InterfaceC</code>éƒ½æä¾›<code>hello</code>é»˜è®¤å®ç°ï¼Œå°±ä¼šå‡ºç°å†²çªï¼Œ<code>ImplClassD</code>å®ç°ç±»å¿…é¡»å®ç°<code>hello</code>æ–¹æ³•ã€‚</p><p>å¦‚æœ<code>InterfaceC</code>æ¥å£ä¸­æ·»åŠ éé»˜è®¤æŠ½è±¡æ–¹æ³•<code>hello</code>ï¼Œé‚£ä¹ˆå®ƒæ¯”ç»§æ‰¿<code>InterfaceA</code>æ¥å£è€Œæ¥çš„<code>hello</code>ä¼˜å…ˆçº§é«˜ï¼Œæ­¤æ—¶å®ç°ç±»<code>ImplClassD</code>å¿…é¡»æ˜¾å¼å®ç°<code>InterfaceC</code>çš„<code>hello</code>æŠ½è±¡æ–¹æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
          <category> Java 8å®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆäºŒï¼‰ï¼šä¼˜é›…çš„è§£å†³NPEé—®é¢˜</title>
      <link href="2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(2)/"/>
      <url>2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(2)/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬åç« ï¼šç”¨Optionalå–ä»£null"><a href="#ç¬¬åç« ï¼šç”¨Optionalå–ä»£null" class="headerlink" title="ç¬¬åç« ï¼šç”¨Optionalå–ä»£null"></a>ç¬¬åç« ï¼šç”¨Optionalå–ä»£null</h2><p><code>null</code>å¼•ç”¨çš„æƒ³æ³•æœ€åˆç”±ä¸€ä½è‹±å›½è®¡ç®—æœºç§‘å­¦å®¶æå‡ºã€‚ä»–è®¤ä¸ºè¿™æ˜¯ä¸ºâ€ä¸å­˜åœ¨çš„å€¼â€œå»ºæ¨¡æœ€å®¹æ˜“çš„æ–¹å¼ã€‚è®¾è®¡åˆè¡·æ˜¯é€šè¿‡ç¼–è¯‘å™¨çš„è‡ªåŠ¨æ£€æµ‹æœºåˆ¶ï¼Œç¡®ä¿æ‰€æœ‰ä½¿ç”¨å¼•ç”¨çš„åœ°æ–¹éƒ½æ˜¯ç»å¯¹å®‰å…¨çš„ã€‚è¿‘äº›å¹´å‡ºç°çš„ç°ä»£ç¨‹åºè®¾è®¡è¯­è¨€åŒ…æ‹¬Javaåœ¨å†…ï¼Œéƒ½é‡‡ç”¨äº†ç›¸åŒçš„è®¾è®¡æ–¹å¼ã€‚</p><h3 id="null-å¼•ç”¨å¸¦æ¥çš„é—®é¢˜"><a href="#null-å¼•ç”¨å¸¦æ¥çš„é—®é¢˜" class="headerlink" title="null å¼•ç”¨å¸¦æ¥çš„é—®é¢˜"></a>null å¼•ç”¨å¸¦æ¥çš„é—®é¢˜</h3><ul><li>é”™è¯¯ä¹‹æºï¼šç¨‹åºå‘˜å¯¹å¯¹è±¡çš„å­—æ®µè¿›è¡Œæ£€æŸ¥ï¼Œåˆ¤æ–­å­—æ®µçš„å€¼æ˜¯å¦ä¸ºæœŸæœ›çš„æ ¼å¼ï¼Œæœ€ç»ˆå´å‘ç°è®¿é—®çš„å¹¶ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ª<code>null</code>å¼•ç”¨â€“ç©ºæŒ‡é’ˆï¼Œäºæ˜¯æŠ›å‡ºä¸€ä¸ª<code>NullPointerException</code>å¼‚å¸¸ã€‚</li><li>ä»£ç è†¨èƒ€ï¼šä¸ºäº†é˜²æ­¢<code>null</code>ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå†™å‡ºè¿™æ ·ç±»ä¼¼çš„ä»£ç ï¼š<code>if (xxx != null) &#123; // dosomething&#125;</code>ã€‚è¿™æ ·ä½ çš„ä»£ç å°±ä¼šå……æ–¥ç€æ·±åº¦åµŒå¥—çš„<code>null</code>æ£€æŸ¥ï¼Œä»£ç å¯è¯»æ€§æå·®ã€‚</li><li>æ¯«æ— æ„ä¹‰ï¼š<code>null</code>è‡ªèº«æ²¡æœ‰ä»»ä½•çš„è¯­ä¹‰ï¼Œå°¤å…¶æ˜¯ï¼Œå®ƒä»£è¡¨çš„æ˜¯åœ¨é™æ€ç±»å‹è¯­è¨€ä¸­ä»¥ä¸€ç§é”™è¯¯çš„æ–¹å¼å¯¹ç¼ºå¤±å˜é‡å€¼çš„å»ºæ¨¡ã€‚</li><li>ç ´åå“²å­¦ï¼šJavaä¸€ç›´è¯•å›¾é¿å…è®©ç¨‹åºå‘˜æ„è¯†åˆ°æŒ‡é’ˆçš„å­˜åœ¨ï¼Œå”¯ä¸€çš„ä¾‹å¤–æ˜¯ï¼šnullæŒ‡é’ˆã€‚</li></ul><h3 id="ä½¿ç”¨é˜²å¾¡å¼ç¼–ç¨‹æ€æƒ³å‡å°‘NPEé—®é¢˜"><a href="#ä½¿ç”¨é˜²å¾¡å¼ç¼–ç¨‹æ€æƒ³å‡å°‘NPEé—®é¢˜" class="headerlink" title="ä½¿ç”¨é˜²å¾¡å¼ç¼–ç¨‹æ€æƒ³å‡å°‘NPEé—®é¢˜"></a>ä½¿ç”¨é˜²å¾¡å¼ç¼–ç¨‹æ€æƒ³å‡å°‘NPEé—®é¢˜</h3><p><code>NullPointerException</code>ç®€ç§°NPEã€‚</p><p>é‡‡ç”¨é˜²å¾¡å¼ç¼–ç¨‹â€“å¿«é€Ÿå¤±è´¥çš„æ€æƒ³å¯ä»¥æœ‰æ•ˆå‡å°‘NPEé—®é¢˜ã€‚</p><p>å¦‚ä¸‹çš„ä»£ç æ˜¯æ¨èçš„æ–¹å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if (param1 &#x3D;&#x3D; null) &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line">if (param2 &#x3D;&#x3D; null) &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; do service</span><br></pre></td></tr></table></figure><p>ä¸è¦ä½¿ç”¨<code>try-catch</code>çš„æ–¹å¼æ¥å¤„ç†ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    param.function();</span><br><span class="line">&#125; catch (NullPointerException e) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ç§é˜²å¾¡å¼ç¼–ç¨‹çš„æ–¹æ³•èƒ½æœ‰æ•ˆè§£å†³é—®é¢˜ï¼Œä½†ä»ç„¶ææ˜“å‡ºé”™ï¼Œä¸€æ—¦å¿˜è®°æ£€æŸ¥é‚£ä¸ªå¯èƒ½ä¸ºnullçš„å±æ€§å°±ä¼šåŸ‹ä¸‹ä¸€ä¸ªéšè—çš„bugã€‚</p><h3 id="ä¼˜é›…çš„è§£å†³æ–¹å¼"><a href="#ä¼˜é›…çš„è§£å†³æ–¹å¼" class="headerlink" title="ä¼˜é›…çš„è§£å†³æ–¹å¼"></a>ä¼˜é›…çš„è§£å†³æ–¹å¼</h3><p>Java 8ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç±»<code>java.util.Optional&lt;T&gt;</code>æ¥ä¼˜é›…çš„è§£å†³NPEé—®é¢˜ã€‚</p><p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ª<code>Person</code>ç±»ï¼Œæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ï¼šæ±½è½¦<code>Car</code>ç±»ï¼›æ±½è½¦<code>Car</code>ç±»ä¸­åˆæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ï¼šä¿é™©å…¬å¸<code>Insurance</code>ç±»ï¼›ä¿é™©å…¬å¸<code>Insurance</code>ç±»ä¸­æœ‰ä¸€ä¸ªæˆå‘˜å˜é‡ï¼š<code>String</code>ç±»å‹çš„å…¬å¸åã€‚ä½ å¯èƒ½ä¼šæŒ‰ä¸‹é¢çš„æ–¹å¼è®¾è®¡ã€‚<br><code>Person</code>ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Person &#123;</span><br><span class="line">    private Car car;</span><br><span class="line">    public Car getCar() &#123;</span><br><span class="line">        return car;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Car</code>ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Car &#123;</span><br><span class="line">    private Insurance insurance;</span><br><span class="line">    public Insurance getInsurance() &#123;</span><br><span class="line">        return insurance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Insurance</code>ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Insurance &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªäººå¯èƒ½æœ‰è½¦ä¹Ÿå¯èƒ½æ²¡æœ‰è½¦ï¼Œå½“ä¸€ä¸ªäººæ²¡è½¦æ—¶éœ€è¦å°†<code>null</code>å¼•ç”¨èµ‹å€¼ç»™<code>car</code>å˜é‡ï¼Œäºæ˜¯æˆ‘ä»¬åº”è¯¥å°†<code>car</code>å˜é‡å£°æ˜ä¸º<code>Optional&lt;Car&gt;</code>ç±»å‹ï¼›ä¸€è¾†è½¦å¯èƒ½ä¹°äº†ä¿é™©ä¹Ÿå¯èƒ½æ²¡ä¹°ä¿é™©ï¼Œäºæ˜¯<code>Car</code>ç±»ä¸­çš„<code>insurance</code>å­—æ®µä¹Ÿåº”è¯¥å£°æ˜ä¸º<code>Optional&lt;Insurance&gt;</code>ç±»å‹ï¼›ä¿é™©å…¬å¸ä¸€å®šæœ‰ä¸€ä¸ªå…¬å¸åç§°ï¼Œæ‰€ä»¥<code>Insurance</code>ç±»ä¸­çš„<code>name</code>å­—æ®µä¸ç”¨å£°æ˜æˆ<code>Optional</code>ç±»å‹ã€‚æ–°çš„ç±»å®šä¹‰å¦‚ä¸‹ï¼š<br><code>Person</code>ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Optional;</span><br><span class="line"></span><br><span class="line">public class Person &#123;</span><br><span class="line">    private Optional&lt;Car&gt; car;</span><br><span class="line">    public Optional&lt;Car&gt; getCar() &#123;</span><br><span class="line">        return car;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Car</code>ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Optional;</span><br><span class="line"></span><br><span class="line">public class Car &#123;</span><br><span class="line">    private Optional&lt;Insurance&gt; insurance;</span><br><span class="line">    public Optional&lt;Insurance&gt; getInsurance() &#123;</span><br><span class="line">        return insurance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Insurance</code>ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Insurance &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“<code>car</code>å˜é‡å­˜åœ¨æ—¶ï¼Œ<code>Optional</code>ç±»åªæ˜¯å¯¹<code>Car</code>ç±»ç®€å•å°è£…ã€‚å½“å˜é‡ä¸å­˜åœ¨æ—¶ï¼Œç¼ºå¤±çš„å€¼ä¼šè¢«å»ºæ¨¡æˆä¸€ä¸ªâ€œç©ºâ€ çš„<code>Optional</code>å¯¹è±¡ï¼Œç”±æ–¹æ³•<code>Optional.empty()</code>è¿”å›ã€‚<code>Optional.empty()</code>æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€å·¥å‚ æ–¹æ³•ï¼Œå®ƒè¿”å›<code>Optional</code>ç±»çš„ç‰¹å®šå•ä¸€å®ä¾‹ï¼Œä¸<code>null</code>å®Œå…¨ä¸ä¸€æ ·ã€‚</p><h3 id="ä½•æ—¶ä½¿ç”¨Optionalç±»ï¼Ÿ"><a href="#ä½•æ—¶ä½¿ç”¨Optionalç±»ï¼Ÿ" class="headerlink" title="ä½•æ—¶ä½¿ç”¨Optionalç±»ï¼Ÿ"></a>ä½•æ—¶ä½¿ç”¨Optionalç±»ï¼Ÿ</h3><p>åœ¨å®é™…ä¸šåŠ¡ç¼–ç ä¸­ï¼Œæˆ‘ä»¬åªèƒ½é è‡ªå·±å¯¹ä¸šåŠ¡æ¨¡å‹çš„ç†è§£è¿›è¡Œåˆ¤æ–­ï¼Œéœ€è¦åˆ¤æ–­å‡ºä¸€ä¸ª<code>null</code>æ˜¯å¦å±äºæŸä¸ªå˜é‡çš„æœ‰æ•ˆèŒƒå›´ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä¸€ä¸ªç±»åŒ…å«äº†<code>Optional</code>æˆå‘˜å˜é‡ï¼Œåˆ™è¯¥ç±»æ— æ³•è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p><p>åŸå› æ˜¯<code>Optional</code>ç±»æœªå®ç°åºåˆ—åŒ–<code>Serializable</code>æ¥å£ã€‚æ‰€ä»¥å¦‚æœä½ çš„ç±»æ˜¯ç±»ä¼¼<code>Dubbo</code>æœåŠ¡æä¾›è€…è¿”å›çš„æ¨¡å‹å¯¹è±¡ï¼Œåˆ™ä¸èƒ½å°†ç±»æˆå‘˜è®¾è®¡æˆ<code>Optional</code>ç±»å‹ã€‚</p><p>Javaè¯­è¨€çš„æ¶æ„å¸ˆBrian Goetzæ›¾ç»éå¸¸æ˜ç¡®åœ°é™ˆè¿°è¿‡ï¼Œ<code>Optional</code>çš„è®¾è®¡åˆè¡·ä»…ä»…æ˜¯è¦æ”¯æŒèƒ½è¿”å›<code>Optional</code>å¯¹è±¡çš„è¯­æ³•ã€‚ç”±äº<code>Optional</code>ç±»è®¾è®¡æ—¶å°±æ²¡ç‰¹åˆ«è€ƒè™‘å°†å…¶ä½œä¸ºç±»çš„å­—æ®µä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒå¹¶æœªå®ç°<code>Serializable</code>æ¥å£ã€‚</p><h3 id="åº”ç”¨Optionalçš„å‡ ç§æ¨¡å¼"><a href="#åº”ç”¨Optionalçš„å‡ ç§æ¨¡å¼" class="headerlink" title="åº”ç”¨Optionalçš„å‡ ç§æ¨¡å¼"></a>åº”ç”¨Optionalçš„å‡ ç§æ¨¡å¼</h3><h4 id="1-åˆ›å»ºOptionalå¯¹è±¡"><a href="#1-åˆ›å»ºOptionalå¯¹è±¡" class="headerlink" title="1. åˆ›å»ºOptionalå¯¹è±¡"></a>1. åˆ›å»ºOptionalå¯¹è±¡</h4><ul><li>å£°æ˜ä¸€ä¸ªç©ºçš„<code>Optional</code>ï¼šé€šè¿‡é™æ€å·¥å‚æ–¹æ³•<code>Optional.empty</code>ï¼Œåˆ›å»ºä¸€ä¸ªç©ºçš„<code>Optional</code>å¯¹è±¡ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;Car&gt; optCar &#x3D; Optional.empty();</span><br></pre></td></tr></table></figure></li><li>ä¾æ®ä¸€ä¸ªéç©ºå€¼åˆ›å»º<code>Optional</code>ï¼šä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>Optional.of</code>ï¼Œä¾æ®ä¸€ä¸ªéç©ºå€¼åˆ›å»ºä¸€ä¸ª<code>Optional</code>å¯¹è±¡ï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;Car&gt; optCar &#x3D; Optional.of(car);</span><br></pre></td></tr></table></figure><p>å¦‚æœ<code>car</code>å˜é‡æ˜¯ä¸€ä¸ª<code>null</code>å€¼ï¼Œåˆ™è¿™æ®µä»£ç ä¼šç«‹å³æŠ›å‡º<code>NullPointerException</code>ï¼Œè€Œä¸æ˜¯ç­‰åˆ°è¯•å›¾è®¿é—®<code>car</code>çš„å±æ€§æ—¶æ‰è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</p><ul><li>å¯æ¥å—<code>null</code>çš„<code>Optional</code>ï¼šä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>Optional.ofNullalbe</code>ï¼Œåˆ›å»ºä¸€ä¸ªå…è®¸<code>null</code>å€¼çš„<code>Optional</code>å¯¹è±¡ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;Car&gt; optCar &#x3D; Optional.ofNullable(car);</span><br></pre></td></tr></table></figure>å¦‚æœ<code>car</code>å˜é‡æ˜¯ä¸€ä¸ª<code>null</code>å€¼ï¼Œé‚£ä¹ˆå¾—åˆ°çš„<code>Optional</code>å¯¹è±¡å°±æ˜¯ä¸ªç©ºå¯¹è±¡ã€‚</li></ul><h4 id="2-ä½¿ç”¨mapä»Optionalå¯¹è±¡ä¸­æå–å’Œè½¬æ¢å€¼"><a href="#2-ä½¿ç”¨mapä»Optionalå¯¹è±¡ä¸­æå–å’Œè½¬æ¢å€¼" class="headerlink" title="2. ä½¿ç”¨mapä»Optionalå¯¹è±¡ä¸­æå–å’Œè½¬æ¢å€¼"></a>2. ä½¿ç”¨mapä»Optionalå¯¹è±¡ä¸­æå–å’Œè½¬æ¢å€¼</h4><p><code>Optional</code>ç±»çš„<code>map</code>æ–¹æ³•å’Œ<code>Stream</code>ç±»çš„<code>map</code>æ–¹æ³•ç›¸å·®æ— å‡ ã€‚<code>map</code>æ–¹æ³•ä¼šå°†æµä¸­çš„æ¯ä¸ªå…ƒç´ é€šè¿‡æä¾›çš„å‡½æ•°è¿›è¡Œæ˜ å°„ã€‚å¯ä»¥æŠŠ<code>Optional</code>å¯¹è±¡çœ‹æˆä¸€ä¸ªç‰¹æ®Šçš„é›†åˆï¼Œå®ƒæœ€å¤šåŒ…å«ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœ<code>Optional</code>åŒ…å«ä¸€ä¸ªå€¼ï¼Œé‚£mapæ–¹æ³•å°±ä¼šæŠŠè¯¥å€¼é€šè¿‡æä¾›çš„å‡½æ•°æ˜ å°„æˆå…¶å®ƒå€¼ï¼Œå¦åˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚</p><h4 id="3-ä½¿ç”¨flatMapé“¾æ¥Optionalå¯¹è±¡"><a href="#3-ä½¿ç”¨flatMapé“¾æ¥Optionalå¯¹è±¡" class="headerlink" title="3. ä½¿ç”¨flatMapé“¾æ¥Optionalå¯¹è±¡"></a>3. ä½¿ç”¨flatMapé“¾æ¥Optionalå¯¹è±¡</h4><p>åŒæ ·çš„ï¼Œ<code>Optional</code>ç±»çš„<code>flatMap</code>æ–¹æ³•å’Œæµçš„ç”¨æ³•ä¹Ÿç±»ä¼¼ã€‚<code>flatMap</code>æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯å¦ä¸€ä¸ªæµã€‚è¿™ä¸ªå‡½æ•°ä¼šåº”ç”¨åˆ°æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œäºæ˜¯æ¯ä¸ªå…ƒç´ è¢«æ˜ å°„æˆä¸€ä¸ªå°æµï¼Œæ¯ä¸ªå°æµåˆå½¢æˆä¸€ä¸ªå¤§æµä½œä¸º<code>flatMap</code>æ–¹æ³•çš„è¿”å›å€¼ã€‚ä½†æ˜¯<code>flatMap</code>ä¼šå°†è¿™ä¸ªå¤§æµä¸­çš„å°æµæ‰å¹³åŒ–æˆä¸€ä¸ªå•ä¸€çš„æµã€‚å³æµä¸­ä¸åŒ…å«æµï¼ŒåªåŒ…å«å„ä¸ªå…ƒç´ ã€‚</p><h4 id="4-é»˜è®¤è¡Œä¸ºåŠè§£å¼•ç”¨Optionalå¯¹è±¡"><a href="#4-é»˜è®¤è¡Œä¸ºåŠè§£å¼•ç”¨Optionalå¯¹è±¡" class="headerlink" title="4. é»˜è®¤è¡Œä¸ºåŠè§£å¼•ç”¨Optionalå¯¹è±¡"></a>4. é»˜è®¤è¡Œä¸ºåŠè§£å¼•ç”¨Optionalå¯¹è±¡</h4><p><code>Optional</code>ç±»æä¾›äº†å¤šç§æ–¹æ³•è¯»å–<code>Optional</code>å®ä¾‹ä¸­çš„å˜é‡å€¼ã€‚</p><ul><li><code>get()</code>ï¼šå¦‚æœå˜é‡å­˜åœ¨ï¼Œç›´æ¥è¿”å›å°è£…çš„å˜é‡å€¼ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ª<code>NoSuchElementException</code>å¼‚å¸¸ã€‚</li><li><code>orElse(T other)</code>ï¼šå…è®¸åœ¨<code>Optional</code>å¯¹è±¡ä¸åŒ…å«å€¼æ—¶æä¾›ä¸€ä¸ªé»˜è®¤å€¼ã€‚</li><li><code>orElseGet(Supplier&lt;? extends T&gt; other)</code>ï¼šæ˜¯<code>orElse</code>æ–¹æ³•çš„å»¶æ—¶è°ƒç”¨ç‰ˆï¼Œ<code>Supplier</code>æ–¹æ³•åªæœ‰åœ¨<code>Optional</code>å¯¹è±¡ä¸å«å€¼æ—¶æ‰æ‰§è¡Œè°ƒç”¨ã€‚å¦‚æœåˆ›å»ºé»˜è®¤å€¼æ˜¯ä»¶è€—æ—¶æ“ä½œï¼Œè€ƒè™‘ä½¿ç”¨è¯¥æ–¹æ³•ï¼›æˆ–è€…éå¸¸ç¡®å®šæŸä¸ªæ–¹æ³•ä»…åœ¨<code>Optional</code>ä¸ºç©ºæ—¶æ‰æ‰§è¡Œè°ƒç”¨ï¼Œä¹Ÿè€ƒè™‘ä½¿ç”¨è¯¥æ–¹æ³•ã€‚</li><li><code>orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier)</code>ï¼šå’Œ<code>get</code>æ–¹æ³•ç±»ä¼¼ï¼Œå¦‚æœå–å‡ºçš„å€¼ä¸ºç©ºéƒ½ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œä½¿ç”¨<code>orElseThrow</code>å¯ä»¥å®šåˆ¶å¸Œæœ›æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚</li><li><code>ifPresent(Consumer&lt;? extends T&gt;)</code>ï¼šåœ¨å˜é‡å€¼å­˜åœ¨æ—¶æ‰§è¡Œä¸€ä¸ªä¼ å…¥çš„<code>Consumer</code>æ–¹æ³•ï¼Œå¦åˆ™ä¸åšä»»ä½•å¤„ç†ã€‚</li></ul><h4 id="5-ä½¿ç”¨filterå‰”é™¤ç‰¹å®šçš„å€¼"><a href="#5-ä½¿ç”¨filterå‰”é™¤ç‰¹å®šçš„å€¼" class="headerlink" title="5. ä½¿ç”¨filterå‰”é™¤ç‰¹å®šçš„å€¼"></a>5. ä½¿ç”¨filterå‰”é™¤ç‰¹å®šçš„å€¼</h4><p>æˆ‘ä»¬ç»å¸¸éœ€è¦è°ƒç”¨æŸä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼ŒæŸ¥çœ‹å®ƒçš„æŸäº›å±æ€§ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ£€æŸ¥ä¿é™©å…¬å¸çš„åç§°æ˜¯å¦ä¸º<code>CambridgeInsurance</code>ï¼Œä¸ºäº†ä»¥ä¸€ç§å®‰å…¨çš„æ–¹å¼è¿›è¡Œè¿™äº›æ“ä½œï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç¡®å®šå¼•ç”¨æŒ‡å‘çš„<code>Insurance</code>å¯¹è±¡æ˜¯å¦ä¸º<code>null</code>ï¼Œä¹‹åå†è°ƒç”¨å®ƒçš„<code>getName</code>æ–¹æ³•ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Insurance insurance &#x3D; ...;</span><br><span class="line">if (insurance !&#x3D; null &amp;&amp; &quot;CambridgeInsurance&quot;.equals(insurance.getName())) &#123;</span><br><span class="line">    System.out.println(&quot;ok&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨<code>Optional</code>å¯¹è±¡çš„<code>filter</code>æ–¹æ³•ï¼Œè¿™æ®µä»£ç å¯ä»¥é‡æ„å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;Insurance&gt; optInsurance &#x3D; ...;</span><br><span class="line">optInsurance.filter(ins -&gt; &quot;CambridgeInsurance&quot;.equals(ins.getName()))</span><br><span class="line">.ifPresent(x -&gt; System.out.println(&quot;ok&quot;));</span><br></pre></td></tr></table></figure><p>å¦‚æœ<code>Optional</code>å¯¹è±¡åŒ…å«çš„å€¼ä¸ºç©ºï¼Œå®ƒä¸åšä»»ä½•æ“ä½œï¼›åä¹‹ï¼Œå®ƒå¯¹<code>Optional</code>å¯¹è±¡åŒ…å«çš„å€¼æ·»åŠ è°“è¯æ“ä½œï¼Œå¦‚æœè¯¥æ“ä½œçš„ç»“æœä¸º<code>true</code>ï¼Œå®ƒä¸åšä»»ä½•æ”¹å˜ï¼Œç›´æ¥è¿”å›è¯¥<code>Optional</code>å¯¹è±¡ï¼Œå¦åˆ™å°±å°†è¯¥å€¼è¿‡æ»¤æ‰ï¼Œå°†<code>Optional</code>çš„å€¼ç½®ä¸ºç©ºã€‚</p><h3 id="Optionalç±»çš„æ–¹æ³•"><a href="#Optionalç±»çš„æ–¹æ³•" class="headerlink" title="Optionalç±»çš„æ–¹æ³•"></a>Optionalç±»çš„æ–¹æ³•</h3><table><thead><tr><th align="left">æ–¹æ³•å</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">empty</td><td align="left">è¿”å›ä¸€ä¸ªç©ºçš„ Optional å®ä¾‹</td></tr><tr><td align="left">filter</td><td align="left">å¦‚æœå€¼å­˜åœ¨å¹¶ä¸”æ»¡è¶³æä¾›çš„è°“è¯ï¼Œå°±è¿”å›åŒ…å«è¯¥å€¼çš„ Optional å¯¹è±¡ï¼›å¦åˆ™è¿”å›ä¸€ä¸ªç©ºçš„ Optional å¯¹è±¡</td></tr><tr><td align="left">flatMap</td><td align="left">å¦‚æœå€¼å­˜åœ¨ï¼Œå°±å¯¹è¯¥å€¼æ‰§è¡Œæä¾›çš„mappingæ˜ å°„å‡½æ•°è°ƒç”¨ï¼Œè¿”å›ä¸€ä¸ª Optional ç±»å‹çš„å€¼ï¼Œå¦åˆ™å°±è¿”å›ä¸€ä¸ªç©ºçš„ Optional å¯¹è±¡</td></tr><tr><td align="left">get</td><td align="left">å¦‚æœè¯¥å€¼å­˜åœ¨ï¼Œå°†è¯¥å€¼ç”¨ Optional å°è£…è¿”å›ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ª NoSuchElementException å¼‚å¸¸</td></tr><tr><td align="left">ifPresent</td><td align="left">å¦‚æœå€¼å­˜åœ¨ï¼Œå°±æ‰§è¡Œä½¿ç”¨è¯¥å€¼çš„æ–¹æ³•è°ƒç”¨ï¼Œå¦åˆ™ä»€ä¹ˆä¹Ÿä¸åš</td></tr><tr><td align="left">isPresent</td><td align="left">å¦‚æœå€¼å­˜åœ¨å°±è¿”å› trueï¼Œå¦åˆ™è¿”å› false</td></tr><tr><td align="left">map</td><td align="left">å¦‚æœå€¼å­˜åœ¨ï¼Œå°±å¯¹è¯¥å€¼æ‰§è¡Œæä¾›çš„ mappingæ˜ å°„å‡½æ•°è°ƒç”¨</td></tr><tr><td align="left">of</td><td align="left">å°†æŒ‡å®šå€¼ç”¨ Optional å°è£…ä¹‹åè¿”å›ï¼Œå¦‚æœè¯¥å€¼ä¸º nullï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª NullPointerException å¼‚å¸¸</td></tr><tr><td align="left">ofNullable</td><td align="left">å°†æŒ‡å®šå€¼ç”¨ Optional å°è£…ä¹‹åè¿”å›ï¼Œå¦‚æœè¯¥å€¼ä¸º nullï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºçš„ Optional å¯¹è±¡</td></tr><tr><td align="left">orElse</td><td align="left">å¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªé»˜è®¤å€¼</td></tr><tr><td align="left">orElseGet</td><td align="left">å¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªç”±æŒ‡å®šçš„ Supplier æ¥å£ç”Ÿæˆçš„å€¼</td></tr><tr><td align="left">orElseThrow</td><td align="left">å¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ªç”±æŒ‡å®šçš„ Supplier æ¥å£ç”Ÿæˆçš„å¼‚å¸¸</td></tr></tbody></table><h3 id="åŸºç¡€ç±»å‹çš„Optionalå¯¹è±¡ï¼Œä»¥åŠä¸ºä»€ä¹ˆåº”è¯¥é¿å…ä½¿ç”¨å®ƒä»¬"><a href="#åŸºç¡€ç±»å‹çš„Optionalå¯¹è±¡ï¼Œä»¥åŠä¸ºä»€ä¹ˆåº”è¯¥é¿å…ä½¿ç”¨å®ƒä»¬" class="headerlink" title="åŸºç¡€ç±»å‹çš„Optionalå¯¹è±¡ï¼Œä»¥åŠä¸ºä»€ä¹ˆåº”è¯¥é¿å…ä½¿ç”¨å®ƒä»¬"></a>åŸºç¡€ç±»å‹çš„Optionalå¯¹è±¡ï¼Œä»¥åŠä¸ºä»€ä¹ˆåº”è¯¥é¿å…ä½¿ç”¨å®ƒä»¬</h3><p>ä¸<code>Stream</code>å¯¹è±¡ä¸€æ ·ï¼Œ<code>Optional</code>ä¹Ÿæä¾›äº†ç±»ä¼¼çš„åŸºç¡€ç±»å‹ï¼š<code>OptionalInt</code>ã€<code>OptionalLong</code>ä»¥åŠ<code>OptionalDouble</code>ã€‚</p><p>å¦‚æœ<code>Stream</code>å¯¹è±¡åŒ…å«äº†å¤§é‡å…ƒç´ ï¼Œå‡ºäºæ€§èƒ½çš„è€ƒé‡ï¼Œ ä½¿ç”¨åŸºç¡€ç±»å‹æ˜¯ä¸é”™çš„é€‰æ‹©ï¼Œä½†å¯¹äº<code>Optional</code>å¯¹è±¡è€Œè¨€ï¼Œè¿™ä¸ªç†ç”±å°±ä¸æˆç«‹äº†ï¼Œå› ä¸º<code>Optional</code>å¯¹è±¡å¤šåªåŒ…å«ä¸€ä¸ªå€¼ã€‚</p><p>ä¸æ¨èå¤§å®¶ä½¿ç”¨åŸºç¡€ç±»å‹çš„<code>Optional</code>å¯¹è±¡ï¼Œå› ä¸ºåŸºç¡€ç±»å‹çš„<code>Optional</code>ä¸æ”¯æŒ<code>map</code>ã€<code>flatMap</code>å’Œ<code>filter</code>ç­‰æ–¹æ³•ã€‚è€Œè¿™äº›å´æ˜¯<code>Optional</code>ç±»æœ€æœ‰ç”¨çš„æ–¹æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
          <category> Java 8å®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>â€œç…®ç†Ÿçš„é¸­å­ä¹Ÿä¼šé£ï¼Ÿâ€- ä½¿ç”¨ç­–ç•¥æ¨¡å¼è®©ä½ çš„â€œé¸­å­â€é£èµ·æ¥</title>
      <link href="2019/12/12/design-patterns/gof/behavior/strategy/"/>
      <url>2019/12/12/design-patterns/gof/behavior/strategy/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¨¡æ‹Ÿé¸­å­çš„é—®é¢˜"><a href="#æ¨¡æ‹Ÿé¸­å­çš„é—®é¢˜" class="headerlink" title="æ¨¡æ‹Ÿé¸­å­çš„é—®é¢˜"></a>æ¨¡æ‹Ÿé¸­å­çš„é—®é¢˜</h2><p>é—®é¢˜æè¿°ï¼šç”¨ä»£ç æ¨¡æ‹Ÿç°å®ä¸­çš„é¸­å­ï¼Œé¸­å­æœ‰å¾ˆå¤šç§ç±»ï¼Œä¼šå‘å‡ºå„ç§å«å£°ï¼Œæœ‰çš„ä¼šæ¸¸æ³³ã€‚</p><h2 id="ä¼ ç»Ÿè®¾è®¡æ–¹æ¡ˆ"><a href="#ä¼ ç»Ÿè®¾è®¡æ–¹æ¡ˆ" class="headerlink" title="ä¼ ç»Ÿè®¾è®¡æ–¹æ¡ˆ"></a>ä¼ ç»Ÿè®¾è®¡æ–¹æ¡ˆ</h2><p>ä¼ ç»Ÿæ–¹æ¡ˆï¼šä½¿ç”¨æ ‡å‡†çš„é¢å‘å¯¹è±¡è®¾è®¡ã€‚è®¾è®¡ä¸€ä¸ª<code>Duck</code>è¶…ç±»ï¼Œè®©ä¸åŒç§ç±»çš„é¸­å­ç»§æ‰¿è¯¥è¶…ç±»ã€‚</p><p>ä¼ ç»Ÿæ–¹æ¡ˆçš„ç±»å›¾è®¾è®¡å¦‚ä¸‹ï¼š<br><img src="https://i.loli.net/2020/02/15/YgU95kXfjRz7OoM.png" alt="traditionalDuckUML.png"></p><p>ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p><code>Duck</code>è¶…ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.traditional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ä¼ ç»Ÿé¸­å­é—®é¢˜</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 1. å…¶å®ƒé¸­å­éƒ½ç»§æ‰¿äº†Duckç±»ï¼Œæ‰€ä»¥flyæ–¹æ³•è®©æ‰€æœ‰çš„å­ç±»é¸­å­éƒ½ä¼šé£ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰é¸­å­éƒ½ä¼šé£ã€‚</span></span><br><span class="line"><span class="comment"> * 2. å®é™…ä¸Šè¿™æ˜¯ç»§æ‰¿å¸¦æ¥çš„é—®é¢˜ï¼Œå¯¹çˆ¶ç±»çš„å±€éƒ¨æ”¹åŠ¨ï¼Œä¼šå½±å“æ‰€æœ‰å­ç±»ã€‚ç§°ä¸ºæº¢å‡ºæ•ˆåº”ã€‚</span></span><br><span class="line"><span class="comment"> * 3. ä¸ºäº†è§£å†³ç»§æ‰¿å¸¦æ¥çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å­ç±»ä¸­é‡å†™å¯¹åº”çš„æ–¹æ³•æ¥è§£å†³ã€‚</span></span><br><span class="line"><span class="comment"> * 4. ä½†æ˜¯å¦‚æœæœ‰ä¸€ä¸ªç©å…·é¸­ç±»ï¼Œå®ƒéœ€è¦é‡å†™çˆ¶ç±»æ‰€æœ‰çš„æ–¹æ³•ï¼Œè¿™æ ·åšçš„ä»£ä»·æœ‰ç‚¹å¤§ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¾ç¤ºé¸­å­ä¿¡æ¯çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¸­å­å«çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é¸­å­å˜å˜å«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¸­å­æ¸¸æ³³çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é¸­å­ä¼šæ¸¸æ³³&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¸­å­é£ç¿”çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é¸­å­ä¼šé£ç¿”&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡é¸­<code>WildDuck</code>ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.traditional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: é‡é¸­ï¼šå˜å˜å«ã€ä¼šæ¸¸æ³³å’Œé£ç¿”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WildDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿™æ˜¯ä¸€åªé‡é¸­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ—äº¬é¸­<code>PekingDuck</code>ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.traditional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: åŒ—äº¬é¸­ï¼šä¸ä¼šé£ç¿”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PekingDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿™æ˜¯ä¸€åªåŒ—äº¬é¸­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åŒ—äº¬é¸­ä¸ä¼šé£ç¿”&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç©å…·é¸­<code>ToyDuck</code>ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.traditional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ç©å…·é¸­ï¼šä¸ä¼šå˜å˜å«ã€ä¸ä¼šæ¸¸æ³³å’Œé£ç¿”ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToyDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿™æ˜¯ä¸€åªç©å…·é¸­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç©å…·é¸­ä¸èƒ½å«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç©å…·é¸­ä¸ä¼šæ¸¸æ³³&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç©å…·é¸­ä¸ä¼šé£ç¿”&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¶…ç±»<code>Duck</code>ä¸­å®šä¹‰äº†3ä¸ªå®ç°æ–¹æ³•ï¼Œä¸€ä¸ªæŠ½è±¡æ–¹æ³•ã€‚</p><p>å­ç±»é‡é¸­WildDuckç±»ä¼šâ€œå˜å˜å«â€ã€â€œæ¸¸æ³³â€å’Œâ€œé£ç¿”â€ã€‚æ‰€ä»¥é‡é¸­ç±»åªéœ€å®ç°æŠ½è±¡æ–¹æ³•displayå³å¯ã€‚</p><p>å­ç±»åŒ—äº¬é¸­PekingDuckç±»ä¸ä¼šé£ç¿”ï¼Œé™¤äº†å®ç°æŠ½è±¡æ–¹æ³•ä¹‹å¤–è¿˜éœ€é‡å†™çˆ¶ç±»çš„flyæ–¹æ³•ã€‚</p><p>å­ç±»ç©å…·é¸­ToyDuckç±»ä¸ä¼šå«ã€ä¸ä¼šæ¸¸æ³³ä¹Ÿä¸ä¼šé£ç¿”ã€‚æ‰€ä»¥ç©å…·é¸­ç±»é™¤äº†å®ç°æŠ½è±¡æ–¹æ³•ï¼Œè¿˜è¦é‡å†™çˆ¶ç±»çš„ä¸‰ä¸ªæ–¹æ³•ã€‚</p><p>è¿™ç§ç»§æ‰¿çš„è®¾è®¡æ€è·¯ä¼¼ä¹æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ä½†äº‹å®ä¸Šå­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•çš„ä»£ä»·æ˜¯å¾ˆé«˜çš„ï¼Œä¸€æ—¦å‡ºç°ä¸€ä¸ªæ–°å“ç§çš„é¸­å­ï¼Œå°±è¦å»ç»§æ‰¿<code>Duck</code>ç±»ï¼Œå­ç±»é»˜è®¤å°±æœ‰äº†çˆ¶ç±»å®šä¹‰å¥½çš„è¡Œä¸ºï¼Œä¾‹å¦‚â€œå˜å˜å«â€ã€â€œæ¸¸æ³³â€å’Œâ€œé£ç¿”â€ã€‚å¦‚æœå­ç±»ä¸æ»¡è¶³è¿™äº›è¡Œä¸ºå°±è¦å»é‡å†™çˆ¶ç±»ä¸­å¯¹åº”çš„æ–¹æ³•ã€‚åŒæ—¶ï¼Œä¸€æ—¦å¯¹çˆ¶ç±»è¿›è¡ŒæŸäº›å±€éƒ¨æ”¹åŠ¨ï¼Œæ‰€æœ‰å­ç±»éƒ½ä¼šå—åˆ°å½±å“ã€‚</p><p>æˆ‘ä»¬çŸ¥é“Duckç±»å†…çš„fly()å’Œquack()ä¼šéšç€é¸­å­çš„ä¸åŒè€Œæ”¹å˜ã€‚äº‹å®ä¸Šæ¯æ¬¡ç»§æ‰¿éƒ½æ˜¯åœ¨æ”¹åŠ¨è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚</p><p>ä¸å¦¨ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥æ”¹é€ <code>Duck</code>ç±»ã€‚</p><blockquote><p>ç­–ç•¥æ¨¡å¼å®šä¹‰äº†ç®—æ³•æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©å®ƒä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚</p></blockquote><p>ç­–ç•¥æ¨¡å¼ä¸­æœ‰ä»¥ä¸‹ä¸‰æ¡è®¾è®¡åŸåˆ™ï¼š</p><ul><li>æ‰¾å‡ºåº”ç”¨ä¸­å¯èƒ½éœ€è¦å˜åŒ–ä¹‹å¤„ï¼ŒæŠŠå®ƒä»¬ç‹¬ç«‹å‡ºæ¥ï¼Œä¸è¦å’Œé‚£äº›ä¸éœ€è¦å˜åŒ–çš„ä»£ç æ··åœ¨ä¸€èµ·ã€‚</li><li>é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®ç°ç¼–ç¨‹ã€‚</li><li>å¤šç”¨ç»„åˆï¼Œå°‘ç”¨ç»§æ‰¿ã€‚</li></ul><h2 id="åˆ†ç¦»è¡Œä¸º-â€”-è®©â€œç…®ç†Ÿçš„é¸­å­â€é£èµ·æ¥"><a href="#åˆ†ç¦»è¡Œä¸º-â€”-è®©â€œç…®ç†Ÿçš„é¸­å­â€é£èµ·æ¥" class="headerlink" title="åˆ†ç¦»è¡Œä¸º â€” è®©â€œç…®ç†Ÿçš„é¸­å­â€é£èµ·æ¥"></a>åˆ†ç¦»è¡Œä¸º â€” è®©â€œç…®ç†Ÿçš„é¸­å­â€é£èµ·æ¥</h2><p>æ˜¯æ—¶å€™å°†è¡Œä¸ºä»Duckç±»ä¸­åˆ†ç¦»å‡ºæ¥äº†ã€‚å°†é¸­å­çš„è¡Œä¸ºå°è£…åˆ°æ–°çš„ç±»ä¸­ï¼Œè¯¥ç±»ä¸“é—¨æä¾›æŸè¡Œä¸ºçš„å®ç°ã€‚è¿™æ ·ï¼ŒDuckç±»å°±ä¸å†éœ€è¦çŸ¥é“è¡Œä¸ºçš„å…·ä½“å®ç°ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•è®¾è®¡å®ç°â€œé£ç¿”â€å’Œâ€œå˜å˜å«â€çš„è¡Œä¸ºçš„ç±»å‘¢ï¼Ÿæˆ‘ä»¬å¸Œæœ›â€œç…®ç†Ÿçš„é¸­å­é£èµ·æ¥â€ï¼Œé¸­å­éœ€è¦ç»å†ä»ç”Ÿåˆ°ç†Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯åœ¨Duckç±»ä¸­å¢åŠ è®¾å®šè¡Œä¸ºçš„æ–¹æ³•ï¼Œè¿™æ ·å°±èƒ½åœ¨â€œè¿è¡Œæ—¶æœŸâ€åŠ¨æ€æ”¹å˜é¸­å­çš„è¡Œä¸ºã€‚</p><p>ä½¿ç”¨äº†ç­–ç•¥æ¨¡å¼çš„ç±»å›¾è®¾è®¡å¦‚ä¸‹ï¼š<br><img src="https://i.loli.net/2020/02/15/3hz8VipoP5ZYW9s.png" alt="strategyDuckUML.png"></p><p>ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p>â€œé£ç¿”â€è¡Œä¸ºæ¥å£<code>FlyBehavior</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: é£ç¿”è¡Œä¸ºæ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é£ç¿”çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éšé£é£ç¿”çš„è¡Œä¸º<code>FlyWithWings</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.FlyBehavior;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å¯ä»¥é£çš„è¡Œä¸º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyWithWings</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;fly with wings&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸èƒ½é£çš„è¡Œä¸º<code>FlyNoWay</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.FlyBehavior;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ä¸èƒ½é£çš„è¡Œä¸º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyNoWay</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;can&#x27;t fly&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ç«ç®­åŠ¨åŠ›é£ç¿”çš„è¡Œä¸º<code>FlyRocketPowered</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.FlyBehavior;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: åˆ©ç”¨ç«ç®­åŠ¨åŠ›çš„é£ç¿”è¡Œä¸º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyRocketPowered</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;fly with rocket&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€œå«â€çš„è¡Œä¸ºæ¥å£<code>QuackBehavior</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: é¸­å­å«è¡Œä¸ºæ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¸­å­å«çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å˜å˜å«çš„è¡Œä¸º<code>Quack</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.QuackBehavior;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å˜å˜å«çš„è¡Œä¸º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Quack</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Quack å˜å˜å«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å±å±å«çš„è¡Œä¸º<code>Squeak</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.QuackBehavior;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: å±å±å«çš„è¡Œä¸º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Squeak</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Squeak å±å±å«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ä¼šå«çš„è¡Œä¸º<code>MuteQuack</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.QuackBehavior;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ä¸ä¼šå«çš„è¡Œä¸º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MuteQuack</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Silence ä¸ä¼šå«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†ç¦»è¡Œä¸ºåçš„<code>Duck</code>ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„é¸­å­ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é£ç¿”çš„è¡Œä¸º</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    FlyBehavior flyBehavior;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å«çš„è¡Œä¸º</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    QuackBehavior quackBehavior;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®é£è¡Œè¡Œä¸º</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> flyBehavior é£è¡Œè¡Œä¸º</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFlyBehavior</span><span class="params">(FlyBehavior flyBehavior)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.flyBehavior = flyBehavior;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®å«çš„è¡Œä¸º</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> quackBehavior å«è¡Œä¸º</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQuackBehavior</span><span class="params">(QuackBehavior quackBehavior)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.quackBehavior = quackBehavior;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä½¿é¸­å­é£</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">performFly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (flyBehavior != <span class="keyword">null</span>) &#123;</span><br><span class="line">            flyBehavior.fly();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä½¿é¸­å­å«</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">performQuack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (quackBehavior != <span class="keyword">null</span>) &#123;</span><br><span class="line">            quackBehavior.quack();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¸­å­æ¸¸æ³³çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é¸­å­ä¼šæ¸¸æ³³&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¾ç¤ºé¸­å­ä¿¡æ¯çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡é¸­<code>WildDuck</code>ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.impl.FlyWithWings;</span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.impl.Quack;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: é‡é¸­ï¼šå…·æœ‰å¯ä»¥é£çš„è¡Œä¸ºå’Œå˜å˜å«çš„è¡Œä¸ºã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WildDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WildDuck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// éšé£é£ç¿”è¡Œä¸º</span></span><br><span class="line">        flyBehavior = <span class="keyword">new</span> FlyWithWings();</span><br><span class="line">        <span class="comment">// å˜å˜å«è¡Œä¸º</span></span><br><span class="line">        quackBehavior = <span class="keyword">new</span> Quack();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿™æ˜¯ä¸€åªä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„é‡é¸­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ—äº¬é¸­<code>PekingDuck</code>ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.impl.FlyNoWay;</span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.impl.Squeak;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: åŒ—äº¬é¸­ï¼šä¸èƒ½é£ç¿”ï¼Œå±å±å«</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PekingDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PekingDuck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä¸èƒ½é£çš„è¡Œä¸º</span></span><br><span class="line">        flyBehavior = <span class="keyword">new</span> FlyNoWay();</span><br><span class="line">        <span class="comment">// å±å±å«çš„è¡Œä¸º</span></span><br><span class="line">        quackBehavior = <span class="keyword">new</span> Squeak();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿™æ˜¯ä¸€åªä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„åŒ—äº¬é¸­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç©å…·é¸­<code>ToyDuck</code>ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.impl.FlyNoWay;</span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.impl.MuteQuack;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: ç©å…·é¸­ï¼šä¸ä¼šé£ä¹Ÿä¸ä¼šå«</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToyDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ToyDuck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä¸ä¼šé£çš„è¡Œä¸º</span></span><br><span class="line">        flyBehavior = <span class="keyword">new</span> FlyNoWay();</span><br><span class="line">        <span class="comment">// ä¸ä¼šå«çš„è¡Œä¸º</span></span><br><span class="line">        quackBehavior = <span class="keyword">new</span> MuteQuack();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿™æ˜¯ä¸€åªä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„ç©å…·é¸­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€åˆ‡éƒ½å‡†å¤‡å°±ç»ªï¼è®©æˆ‘ä»¬æ¥è§è¯â€œç…®ç†Ÿçš„é¸­å­â€çš„é£ç¿”å§ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.org.lilu.strategy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.org.lilu.strategy.impl.FlyRocketPowered;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: Javaæˆé­”ä¹‹è·¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2019/9/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: for test</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestStrategy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ç”Ÿäº§ä¸€åªåŒ—äº¬é¸­</span></span><br><span class="line">        Duck duck = <span class="keyword">new</span> PekingDuck();</span><br><span class="line">        <span class="comment">// è®©é¸­å­é£</span></span><br><span class="line">        duck.performFly();</span><br><span class="line">        <span class="comment">// è®©é¸­å­å«</span></span><br><span class="line">        duck.performQuack();</span><br><span class="line">        <span class="comment">// ç”Ÿäº§ä¸€åªç©å…·é¸­</span></span><br><span class="line">        Duck toyDuck = <span class="keyword">new</span> ToyDuck();</span><br><span class="line">        <span class="comment">// è®©é¸­å­é£ï¼šå‘ç°ä¸èƒ½é£</span></span><br><span class="line">        toyDuck.performFly();</span><br><span class="line">        <span class="comment">// åŠ¨æ€æ”¹å˜è¡Œä¸ºï¼šè®©â€œç…®ç†Ÿçš„é¸­å­â€é£èµ·æ¥</span></span><br><span class="line">        toyDuck.setFlyBehavior(<span class="keyword">new</span> FlyRocketPowered());</span><br><span class="line">        toyDuck.performFly();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">can&#39;t fly</span><br><span class="line">Squeak å±å±å«</span><br><span class="line">can&#39;t fly</span><br><span class="line">fly with rocket</span><br></pre></td></tr></table></figure><p>ä¸ç®¡æ€æ ·ï¼Œæˆ‘ä»¬çš„ç©å…·é¸­é£èµ·æ¥äº†ï¼Œè¿™é‡Œç©å…·é¸­å’Œâ€œç…®ç†Ÿçš„é¸­å­â€æ€§è´¨ä¸Šæ˜¯ä¸€æ ·çš„ã€‚</p><p>ç°åœ¨æˆ‘ä»¬çš„<code>Duck</code>ç±»ä¸å†æ‹…å¿ƒå‡ºç°æ–°çš„é¸­å­ç§ç±»äº†ã€‚ä¸€æ—¦æœ‰ä¸€ä¸ªä¸åŒè¡Œä¸ºçš„æ–°ç§ç±»é¸­ï¼Œåªéœ€è¦å†™ä¸€ä¸ªæ–°çš„è¡Œä¸ºæ¥å£çš„å®ç°ã€‚è€Œä¸éœ€è¦å¯¹<code>Duck</code>ç±»è¿›è¡Œä¿®æ”¹ã€‚è¿™ä½“ç°äº†â€œå¯¹ä¿®æ”¹å…³é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾â€åŸåˆ™ï¼Œå®¢æˆ·ç«¯å¢åŠ è¡Œä¸ºä¸ç”¨ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œåªè¦æ·»åŠ ä¸€ç§ç­–ç•¥å³å¯ï¼Œé¿å…äº†ä½¿ç”¨å¤šé‡è½¬ç§»è¯­å¥(if-elseâ€¦if-else)ã€‚åŒæ—¶ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹ä¹Ÿç”±æ­¤æš´éœ²ï¼Œæ¯æ·»åŠ ä¸€ä¸ªç­–ç•¥å°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ç±»ï¼Œå½“ç­–ç•¥è¿‡å¤šæ—¶ï¼Œç±»çš„æ•°é‡ä¼šéšä¹‹è¿‡å¤šã€‚ä½†è¿™è‡³å°‘æ¯”ä½¿ç”¨ç»§æ‰¿æ—¶é‡å†™çˆ¶ç±»æ–¹æ³•è¦å¥½çš„å¤šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> GOFè®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> GOF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶ä¹‹ShardingSphere-å…¥é—¨æ¡ˆä¾‹</title>
      <link href="2019/12/12/middleware/sharding-sphere/sharding-jdbc-introduction/"/>
      <url>2019/12/12/middleware/sharding-sphere/sharding-jdbc-introduction/</url>
      
        <content type="html"><![CDATA[<h2 id="ShardingSphereçš„å‰å°˜å¾€äº‹"><a href="#ShardingSphereçš„å‰å°˜å¾€äº‹" class="headerlink" title="ShardingSphereçš„å‰å°˜å¾€äº‹"></a>ShardingSphereçš„å‰å°˜å¾€äº‹</h2><p>ShardingSphereçš„å‰èº«æ˜¯Sharding-JDBCï¼Œèµ·æºäºå½“å½“ç½‘å†…éƒ¨åº”ç”¨æ¡†æ¶ï¼Œäº2016å¹´åˆå¼€æºã€‚</p><p>2017å¹´ï¼ŒSharding-JDBCè¿›å…¥2.xé˜¶æ®µï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯æ•°æ®åº“æ²»ç†ã€‚</p><p>2018å¹´æ˜¥èŠ‚å‰å¤•ï¼ŒSharding-JDBCå›¢é˜Ÿäºäº¬ä¸œæ•°ç§‘é‡æ–°ç»„å»ºï¼Œå¹¶å°†å…¶å®šä½ä¸ºé¢å‘äº‘åŸç”Ÿçš„æ•°æ®åº“ä¸­é—´ä»¶ï¼Œæ­£å¼æ›´åä¸ºShardingSphereã€‚Sharding-JDBCè¿›å…¥äº†3.xæ—¶ä»£ï¼ŒåŠŸèƒ½é‡å¿ƒè½¬å‘äº†Sharding-proxyåŠåˆ†å¸ƒå¼äº‹åŠ¡ä¸Šã€‚</p><p>ç¾å›½æ—¶é—´2018å¹´11æœˆ10æ—¥ï¼Œåˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶ç”Ÿæ€åœˆ ShardingSphereæ­£å¼è¿›å…¥ApacheåŸºé‡‘ä¼šå­µåŒ–å™¨ã€‚</p><p>é¢„ç¥ShardingSphereé¡¹ç›®æ—©æ—¥æˆåŠŸæ¯•ä¸šã€‚</p><h2 id="Apache-ShardingSphereç®€ä»‹"><a href="#Apache-ShardingSphereç®€ä»‹" class="headerlink" title="Apache ShardingSphereç®€ä»‹"></a>Apache ShardingSphereç®€ä»‹</h2><p>Apache ShardingSphere (Incubator) æ˜¯ä¸€å¥—å¼€æºçš„åˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶è§£å†³æ–¹æ¡ˆç»„æˆçš„ç”Ÿæ€åœˆï¼Œå®ƒç”±Sharding-JDBCã€Sharding-Proxyå’ŒSharding-Sidecarï¼ˆè§„åˆ’ä¸­ï¼‰è¿™3æ¬¾ç›¸äº’ç‹¬ç«‹ï¼Œå´åˆèƒ½å¤Ÿæ··åˆéƒ¨ç½²é…åˆä½¿ç”¨çš„äº§å“ç»„æˆã€‚å®ƒä»¬å‡æä¾›æ ‡å‡†åŒ–çš„æ•°æ®åˆ†ç‰‡ã€åˆ†å¸ƒå¼äº‹åŠ¡å’Œæ•°æ®åº“æ²»ç†åŠŸèƒ½ï¼Œå¯é€‚ç”¨äºå¦‚JavaåŒæ„ã€å¼‚æ„è¯­è¨€ã€äº‘åŸç”Ÿç­‰å„ç§å¤šæ ·åŒ–çš„åº”ç”¨åœºæ™¯ã€‚</p><p>Apacheå®˜æ–¹å‘å¸ƒä»4.0.0ç‰ˆæœ¬å¼€å§‹ã€‚</p><p><a href="https://shardingsphere.apache.org/document/current/cn/overview/">Apache ShardingSphereå®˜æ–¹æ–‡æ¡£</a></p><h2 id="Sharding-JDBCç®€ä»‹"><a href="#Sharding-JDBCç®€ä»‹" class="headerlink" title="Sharding-JDBCç®€ä»‹"></a>Sharding-JDBCç®€ä»‹</h2><p>å®šä½ä¸ºè½»é‡çº§Javaæ¡†æ¶ï¼Œåœ¨Javaçš„JDBCå±‚æä¾›çš„é¢å¤–æœåŠ¡ã€‚ å®ƒä½¿ç”¨å®¢æˆ·ç«¯ç›´è¿æ•°æ®åº“ï¼Œä»¥jaråŒ…å½¢å¼æä¾›æœåŠ¡ï¼Œæ— éœ€é¢å¤–éƒ¨ç½²å’Œä¾èµ–ï¼Œå¯ç†è§£ä¸ºå¢å¼ºç‰ˆçš„JDBCé©±åŠ¨ï¼Œå®Œå…¨å…¼å®¹JDBCå’Œå„ç§ORMæ¡†æ¶ã€‚</p><h2 id="Sharding-JDBCå¿«é€Ÿå…¥é—¨"><a href="#Sharding-JDBCå¿«é€Ÿå…¥é—¨" class="headerlink" title="Sharding-JDBCå¿«é€Ÿå…¥é—¨"></a>Sharding-JDBCå¿«é€Ÿå…¥é—¨</h2><p>æˆ‘ä»¬ä»¥ä¸€åº“ä¸¤è¡¨çš„æ¡ˆä¾‹æ¥å¿«é€Ÿå…¥é—¨ã€‚</p><h3 id="å»ºç«‹æ•°æ®è¡¨"><a href="#å»ºç«‹æ•°æ®è¡¨" class="headerlink" title="å»ºç«‹æ•°æ®è¡¨"></a>å»ºç«‹æ•°æ®è¡¨</h3><p>è¿™é‡Œæˆ‘ä»¬ä»¥ç®€å•çš„è®¢å•è¡¨ä¸ºä¾‹ï¼Œä½œä¸ºå…¥é—¨å­¦ä¹ ä½¿ç”¨ã€‚</p><p>é¦–å…ˆå»ºç«‹ä¸€åº“ä¸¤è¡¨çš„æ•°æ®åº“ç»“æ„ã€‚æ•°æ®åº“åä¸ºsharding_jdbc_dbï¼Œå»ºç«‹t_order_1å’Œt_order_2ä¸¤å¼ è¡¨ã€‚</p><p>å»ºè¡¨sqlè¯­å¥å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ†è¡¨ç»“æ„</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> t_order_1;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> t_order_2;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `sharding_jdbc_db`.`t_order_1`  (</span><br><span class="line">  `order_id` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¸»é”®ï¼šè®¢å•id&#x27;</span>,</span><br><span class="line">  `price` <span class="type">decimal</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•é‡‘é¢&#x27;</span>,</span><br><span class="line">  `user_id` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·id&#x27;</span>,</span><br><span class="line">  `status` <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•çŠ¶æ€&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (`order_id`)</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `sharding_jdbc_db`.`t_order_2`  (</span><br><span class="line">  `order_id` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¸»é”®ï¼šè®¢å•id&#x27;</span>,</span><br><span class="line">  `price` <span class="type">decimal</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•é‡‘é¢&#x27;</span>,</span><br><span class="line">  `user_id` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·id&#x27;</span>,</span><br><span class="line">  `status` <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•çŠ¶æ€&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (`order_id`)</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºsharding-jdbc-simpleé¡¹ç›®"><a href="#åˆ›å»ºsharding-jdbc-simpleé¡¹ç›®" class="headerlink" title="åˆ›å»ºsharding-jdbc-simpleé¡¹ç›®"></a>åˆ›å»ºsharding-jdbc-simpleé¡¹ç›®</h3><p>ä½¿ç”¨IDEAåˆ›å»ºä¸€ä¸ªmavençš„ç©ºæ¨¡æ¿é¡¹ç›®ï¼Œé¡¹ç›®åä¸ºsharding-jdbc-simpleã€‚</p><p>åœ¨pom.xmlæ–‡ä»¶ä¸­éœ€æ·»åŠ çš„sharding-jdbc-spring-boot-starterä¾èµ–å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- apache sharding-jdbc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shardingsphere<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sharding-jdbc-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.0-RC1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç”±äºæˆ‘çš„é¡¹ç›®ä½¿ç”¨äº†è‡ªå·±å®šä¹‰çš„ç»Ÿä¸€ä¾èµ–ç®¡ç†ï¼Œæ‰€ä»¥æ²¡æœ‰æŒ‡å®šå„ä¸ªjaråŒ…çš„ç‰ˆæœ¬å·ã€‚</p><p>è¯»è€…å¯ä»¥å‚è€ƒ <a href="https://github.com/sunchaser-lilu/plaid-umbrella/tree/master/sunchaser-boot-dependencies">sunchaser-boot-dependencies</a> è¿›è¡Œå®ç°ï¼Œæˆ–è€…å•ç‹¬æŒ‡å®šå¯¹åº”ç‰ˆæœ¬å·ã€‚</p><p>å®Œæ•´çš„pom.xmlå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ä¸­é—´ä»¶<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sunchaser<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sharding-jdbc-simple<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sunchaser.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sunchaser-boot-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- sharding-jdbcä¾èµ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shardingsphere<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sharding-jdbc-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- testä¾èµ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- webä¾èµ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mybatisä¾èµ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- druidè¿æ¥æ±  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mysqlé©±åŠ¨ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- lombok --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç¼–å†™é…ç½®æ–‡ä»¶"><a href="#ç¼–å†™é…ç½®æ–‡ä»¶" class="headerlink" title="ç¼–å†™é…ç½®æ–‡ä»¶"></a>ç¼–å†™é…ç½®æ–‡ä»¶</h3><p>springbooté¡¹ç›®å¯ä½¿ç”¨propertiesé…ç½®æˆ–yamlé…ç½®ã€‚äºŒé€‰ä¸€å³å¯ã€‚</p><h4 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h4><p>é…ç½®tomcatç«¯å£å·ã€åº”ç”¨åå’Œå…è®¸é‡å¤å®šä¹‰çš„beanè¿›è¡Œè¦†ç›–ã€‚</p><p>propertiesé…ç½®ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">520</span></span><br><span class="line"><span class="meta">spring.application.name</span>=<span class="string">sharding-jdbc-simple-demo</span></span><br><span class="line"><span class="comment"># é‡å¤çš„beanå®šä¹‰è¿›è¡Œè¦†ç›–</span></span><br><span class="line"><span class="meta">spring.main.allow-bean-definition-overriding</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure><p>yamlé…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">520</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">sharding-jdbc-simple-demo</span></span><br><span class="line">  <span class="attr">main:</span></span><br><span class="line">    <span class="comment"># é‡å¤çš„beanä¼šè¿›è¡Œè¦†ç›–</span></span><br><span class="line">    <span class="attr">allow-bean-definition-overriding:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h4 id="é…ç½®mybatis"><a href="#é…ç½®mybatis" class="headerlink" title="é…ç½®mybatis"></a>é…ç½®mybatis</h4><p>ä¸»è¦é…ç½®xmlæ–‡ä»¶æ˜ å°„è·¯å¾„å’Œä¸‹åˆ’çº¿è‡ªåŠ¨è½¬é©¼å³°ã€‚</p><p>propertiesé…ç½®ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########################################################################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     mybatisé…ç½®</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#########################################################################</span></span><br><span class="line"><span class="comment"># xmlæ˜ å°„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:mapper/**/*.xml</span></span><br><span class="line"><span class="comment"># ä¸‹åˆ’çº¿è‡ªåŠ¨è½¬é©¼å³°</span></span><br><span class="line"><span class="meta">mybatis.configuration.map-underscore-to-camel-case</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure><p>yamlé…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="comment"># xmlæ˜ å°„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mapper/**/*.xml</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="comment"># è‡ªåŠ¨è½¬é©¼å³°</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h4 id="é…ç½®æ•°æ®æº"><a href="#é…ç½®æ•°æ®æº" class="headerlink" title="é…ç½®æ•°æ®æº"></a>é…ç½®æ•°æ®æº</h4><p>æ­¤å…¥é—¨æ¡ˆä¾‹æ˜¯ä¸€åº“ä¸¤è¡¨ï¼Œåªæœ‰ä¸€ä¸ªæ•°æ®æºéœ€è¦é…ç½®ã€‚</p><p>propertiesé…ç½®ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########################################################################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     æ•°æ®æºé…ç½®</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#########################################################################</span></span><br><span class="line"><span class="comment"># æ•°æ®æºåç§°ï¼Œå¤šæ•°æ®æºä»¥é€—å·åˆ†éš”</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.names</span>=<span class="string">ds1</span></span><br><span class="line"><span class="comment"># æ•°æ®æºds1è¯¦æƒ…é…ç½®</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.type</span>=<span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/sharding_jdbc_db?useUnicode=true&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.password</span>=<span class="string">ll970722</span></span><br></pre></td></tr></table></figure><p>yamlé…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="comment"># æ•°æ®æºé…ç½®</span></span><br><span class="line">  <span class="attr">shardingsphere:</span></span><br><span class="line">    <span class="attr">datasource:</span></span><br><span class="line">      <span class="comment"># æ•°æ®æºåç§°ï¼Œå¤šæ•°æ®æºä»¥é€—å·åˆ†éš”</span></span><br><span class="line">      <span class="attr">names:</span> <span class="string">ds1</span></span><br><span class="line">      <span class="comment"># æ•°æ®æºds1è¯¦æƒ…é…ç½®</span></span><br><span class="line">      <span class="attr">ds1:</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">        <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">jdbc:mysql://127.0.0.1:3306/sharding_jdbc_db?useUnicode=true&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">        <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">        <span class="attr">password:</span> <span class="string">ll970722</span></span><br></pre></td></tr></table></figure><h4 id="é…ç½®åˆ†ç‰‡è§„åˆ™"><a href="#é…ç½®åˆ†ç‰‡è§„åˆ™" class="headerlink" title="é…ç½®åˆ†ç‰‡è§„åˆ™"></a>é…ç½®åˆ†ç‰‡è§„åˆ™</h4><p>ä½¿ç”¨é»˜è®¤çš„inlineè¡¨è¾¾å¼é…ç½®åˆ†ç‰‡ç­–ç•¥ï¼Œåˆ†ç‰‡ç­–ç•¥åŒ…å«åˆ†ç‰‡é”®å’Œåˆ†ç‰‡ç®—æ³•ï¼Œéœ€ç¬¦åˆgroovyè¯­æ³•ã€‚</p><p>propertiesé…ç½®ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ†ç‰‡è§„åˆ™é…ç½®</span></span><br><span class="line"><span class="comment"># çœŸå®æ•°æ®èŠ‚ç‚¹ï¼Œç”±æ•°æ®æºå + è¡¨åç»„æˆï¼Œä»¥å°æ•°ç‚¹åˆ†éš”</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.t_order.actual-data-nodes</span>=<span class="string">ds1.t_order_$-&gt;&#123;1..2&#125;</span></span><br><span class="line"><span class="comment"># ä¸»é”®åˆ—åç§°ï¼Œç¼ºçœè¡¨ç¤ºä¸ä½¿ç”¨è‡ªå¢ä¸»é”®ç”Ÿæˆå™¨</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.t_order.key-generator.column</span>=<span class="string">order_id</span></span><br><span class="line"><span class="comment"># è‡ªå¢åˆ—å€¼ç”Ÿæˆå™¨ç±»å‹ï¼Œç¼ºçœè¡¨ç¤ºä½¿ç”¨é»˜è®¤è‡ªå¢åˆ—å€¼ç”Ÿæˆå™¨ã€‚</span></span><br><span class="line"><span class="comment"># å¯ä½¿ç”¨è‡ªå®šä¹‰çš„åˆ—å€¼ç”Ÿæˆå™¨æˆ–é€‰æ‹©å†…ç½®ç±»å‹ï¼šSNOWFLAKE/UUID/LEAF_SEGMENT</span></span><br><span class="line"><span class="comment"># è¿™é‡Œä½¿ç”¨SNOWFLAKEé›ªèŠ±ç®—æ³•</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.t_order.key-generator.type</span>=<span class="string">SNOWFLAKE</span></span><br><span class="line"><span class="comment"># åˆ†ç‰‡ç­–ç•¥ï¼ˆåˆ†ç‰‡é”®å’Œåˆ†ç‰‡ç®—æ³•ï¼‰</span></span><br><span class="line"><span class="comment"># åˆ†ç‰‡é”®</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.sharding-column</span>=<span class="string">order_id</span></span><br><span class="line"><span class="comment"># åˆ†ç‰‡ç®—æ³• ç”Ÿæˆçš„IDä¸ºå¥‡æ•°ï¼Œæ’å…¥åˆ°t_order_2ä¸­ï¼Œå¶æ•°åˆ™æ’å…¥åˆ°t_order_1ä¸­</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.algorithm-expression</span>=<span class="string">t_order_$-&gt;&#123;order_id % 2 + 1&#125;</span></span><br></pre></td></tr></table></figure><p>yamlé…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">shardingsphere:</span></span><br><span class="line">    <span class="comment"># sharding-jdbcåˆ†ç‰‡è§„åˆ™é…ç½®</span></span><br><span class="line">    <span class="attr">sharding:</span></span><br><span class="line">      <span class="attr">tables:</span></span><br><span class="line">        <span class="attr">t_order:</span></span><br><span class="line">          <span class="comment"># æ•°æ®èŠ‚ç‚¹</span></span><br><span class="line">          <span class="attr">actual-data-nodes:</span> <span class="string">ds1.t_order_$-&gt;&#123;1..2&#125;</span></span><br><span class="line">          <span class="comment"># ä¸»é”®åˆ—å’Œä¸»é”®ç”Ÿæˆç­–ç•¥ï¼šé›ªèŠ±ç®—æ³•</span></span><br><span class="line">          <span class="attr">key-generator:</span></span><br><span class="line">            <span class="attr">column:</span> <span class="string">order_id</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">SNOWFLAKE</span></span><br><span class="line">          <span class="comment"># åˆ†ç‰‡ç­–ç•¥</span></span><br><span class="line">          <span class="attr">table-strategy:</span></span><br><span class="line">            <span class="attr">inline:</span></span><br><span class="line">              <span class="comment"># åˆ†ç‰‡é”®</span></span><br><span class="line">              <span class="attr">sharding-column:</span> <span class="string">order_id</span></span><br><span class="line">              <span class="comment"># åˆ†ç‰‡ç®—æ³•ï¼šç”Ÿæˆçš„IDä¸ºå¥‡æ•°ï¼Œæ’å…¥åˆ°t_order_2ä¸­ï¼Œå¶æ•°åˆ™æ’å…¥åˆ°t_order_1ä¸­</span></span><br><span class="line">              <span class="attr">algorithm-expression:</span> <span class="string">t_order_$-&gt;&#123;order_id</span> <span class="string">%</span> <span class="number">2</span> <span class="string">+</span> <span class="number">1</span><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="é…ç½®æ—¥å¿—ç›¸å…³"><a href="#é…ç½®æ—¥å¿—ç›¸å…³" class="headerlink" title="é…ç½®æ—¥å¿—ç›¸å…³"></a>é…ç½®æ—¥å¿—ç›¸å…³</h4><p>é…ç½®æ‰“å°æ‰§è¡Œçš„çœŸå®sqlä¸æ—¥å¿—çº§åˆ«ã€‚</p><p>propertiesé…ç½®ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å°sharding-jdbcçš„çœŸå®æ‰§è¡Œsqlæ—¥å¿—</span></span><br><span class="line"><span class="meta">spring.shardingsphere.props.sql.show</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># æ—¥å¿—çº§åˆ«é…ç½®</span></span><br><span class="line"><span class="meta">logging.level.root</span>=<span class="string">info</span></span><br><span class="line"><span class="meta">logging.level.org.springframework.web</span>=<span class="string">info</span></span><br><span class="line"><span class="meta">logging.level.com.sunchaser.shardingjdbc</span>=<span class="string">debug</span></span><br><span class="line"><span class="meta">logging.level.druid.sql</span>=<span class="string">debug</span></span><br></pre></td></tr></table></figure><p>yamlé…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">shardingsphere:</span></span><br><span class="line">    <span class="attr">props:</span></span><br><span class="line">      <span class="attr">sql:</span></span><br><span class="line">        <span class="comment"># æ‰“å°sharding-jdbcçš„çœŸå®æ‰§è¡Œsqlæ—¥å¿—</span></span><br><span class="line">        <span class="attr">show:</span> <span class="literal">true</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># æ—¥å¿—çº§åˆ«</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">root:</span> <span class="string">info</span></span><br><span class="line">    <span class="attr">org:</span></span><br><span class="line">      <span class="attr">springframework:</span></span><br><span class="line">        <span class="attr">web:</span> <span class="string">info</span></span><br><span class="line">    <span class="attr">com:</span></span><br><span class="line">      <span class="attr">sunchaser:</span></span><br><span class="line">        <span class="attr">shardingjdbc:</span> <span class="string">debug</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">      <span class="attr">sql:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œé…ç½®éƒ¨åˆ†å®Œæˆï¼Œå¼€å§‹ç¼–å†™åç«¯ä»£ç ã€‚</p><h3 id="åç«¯æµ‹è¯•ä»£ç ç¼–å†™"><a href="#åç«¯æµ‹è¯•ä»£ç ç¼–å†™" class="headerlink" title="åç«¯æµ‹è¯•ä»£ç ç¼–å†™"></a>åç«¯æµ‹è¯•ä»£ç ç¼–å†™</h3><p>é¡¹ç›®åŒ…ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â””â”€src</span><br><span class="line">    â”œâ”€main</span><br><span class="line">    â”‚  â”œâ”€java</span><br><span class="line">    â”‚  â”‚  â””â”€com</span><br><span class="line">    â”‚  â”‚      â””â”€sunchaser</span><br><span class="line">    â”‚  â”‚          â””â”€shardingjdbc  ------ å­˜æ”¾å¯åŠ¨ç±»</span><br><span class="line">    â”‚  â”‚              â”œâ”€entity  -------- å­˜æ”¾å®ä½“ç±»</span><br><span class="line">    â”‚  â”‚              â””â”€mapper  -------- å­˜æ”¾mapperæ¥å£</span><br><span class="line">    â”‚  â””â”€resources</span><br><span class="line">    â”‚      â”œâ”€db  ----------------------- å­˜æ”¾å»ºè¡¨è¯­å¥</span><br><span class="line">    â”‚      â””â”€mapper  ------------------- å­˜æ”¾xmlæ˜ å°„æ–‡ä»¶</span><br><span class="line">    â””â”€test</span><br><span class="line">        â””â”€java</span><br><span class="line">            â””â”€com</span><br><span class="line">                â””â”€sunchaser</span><br><span class="line">                    â””â”€shardingjdbc</span><br><span class="line">                        â””â”€mapper  ------ å­˜æ”¾å•å…ƒæµ‹è¯•ç±»</span><br></pre></td></tr></table></figure><p>å…¥é—¨æ¡ˆä¾‹ä¸»è¦æ˜¯ä½¿ç”¨Sharding-JDBCè¿›è¡Œæ–°å¢å’ŒæŸ¥è¯¢ï¼Œmybatisçš„mapperæ¥å£å’Œxmlæ˜ å°„æ–‡ä»¶ç¼–å†™æ–¹å¼ä¿æŒä¸å˜ã€‚</p><h4 id="ç¼–å†™å¯åŠ¨ç±»"><a href="#ç¼–å†™å¯åŠ¨ç±»" class="headerlink" title="ç¼–å†™å¯åŠ¨ç±»"></a>ç¼–å†™å¯åŠ¨ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.shardingjdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.WebApplicationType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.builder.SpringApplicationBuilder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019/11/26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShardingJdbcSimpleApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> SpringApplicationBuilder(ShardingJdbcSimpleApplication.class)</span><br><span class="line">                .web(WebApplicationType.SERVLET)</span><br><span class="line">                .run(args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç¼–å†™è®¢å•å®ä½“ç±»"><a href="#ç¼–å†™è®¢å•å®ä½“ç±»" class="headerlink" title="ç¼–å†™è®¢å•å®ä½“ç±»"></a>ç¼–å†™è®¢å•å®ä½“ç±»</h4><p>ä½¿ç”¨lombokå·¥å…·åŒ…çš„@Dataå’Œ@Builderæ³¨è§£ç”Ÿæˆgetterã€setterå’Œå»ºé€ è€…æ¨¡å¼ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.shardingjdbc.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Builder;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019/11/29</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•idï¼šé›ªèŠ±ç®—æ³•ç”Ÿæˆçš„åˆ†å¸ƒå¼å”¯ä¸€ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long orderId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•ä»·æ ¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> BigDecimal price;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•çŠ¶æ€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String status;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç¼–å†™mapperæ¥å£"><a href="#ç¼–å†™mapperæ¥å£" class="headerlink" title="ç¼–å†™mapperæ¥å£"></a>ç¼–å†™mapperæ¥å£</h4><ol><li>æ’å…¥è®¢å•ï¼ˆæ³¨è§£å®ç°ï¼‰</li><li>æ ¹æ®è®¢å•IDçš„é›†åˆæŸ¥è¯¢è®¢å•ä¿¡æ¯é›†åˆï¼ˆæ³¨è§£å®ç°ï¼‰</li><li>æ ¹æ®è®¢å•IDçš„é›†åˆæŸ¥è¯¢è®¢å•ä¿¡æ¯é›†åˆï¼ˆXMLå®ç°ï¼‰</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.shardingjdbc.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sunchaser.shardingjdbc.entity.OrderEntity;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019/11/28</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’å…¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderEntity è®¢å•å®ä½“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è®°å½•è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into t_order(price,user_id,status) values(#&#123;price&#125;,#&#123;userId&#125;,#&#123;status&#125;)&quot;)</span></span><br><span class="line">    <span class="function">Integer <span class="title">insert</span><span class="params">(OrderEntity orderEntity)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³¨è§£å®ç°</span></span><br><span class="line"><span class="comment">     * æ ¹æ®è®¢å•idé›†åˆæŸ¥è¯¢è®¢å•é›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderIds è®¢å•IDé›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è®¢å•é›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot; &lt;script&gt; &quot; +</span></span><br><span class="line"><span class="meta">            &quot; select * from t_order t where t.order_id in &quot; +</span></span><br><span class="line"><span class="meta">            &quot; &lt;foreach collection=&#x27;orderIds&#x27; open=&#x27;(&#x27; separator=&#x27;,&#x27; close=&#x27;)&#x27; item=&#x27;orderId&#x27;&gt; &quot; +</span></span><br><span class="line"><span class="meta">            &quot; #&#123;orderId&#125; &quot; +</span></span><br><span class="line"><span class="meta">            &quot; &lt;/foreach&gt; &quot; +</span></span><br><span class="line"><span class="meta">            &quot; &lt;/script&gt; &quot;)</span></span><br><span class="line">    <span class="function">List&lt;OrderEntity&gt; <span class="title">selectByAnnotation</span><span class="params">(<span class="meta">@Param(&quot;orderIds&quot;)</span> List&lt;Long&gt; orderIds)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * xml å®ç°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderIds</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;OrderEntity&gt; <span class="title">selectByXml</span><span class="params">(<span class="meta">@Param(&quot;orderIds&quot;)</span> List&lt;Long&gt; orderIds)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>OrderMapperçš„selectByXmlæ–¹æ³•å¯¹åº”çš„XMLé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sunchaser.shardingjdbc.mapper.OrderMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectByXml&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">resultType</span>=<span class="string">&quot;com.sunchaser.shardingjdbc.entity.OrderEntity&quot;</span>&gt;</span></span><br><span class="line">        select * from t_order where order_id in</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&#x27;orderIds&#x27;</span> <span class="attr">item</span>=<span class="string">&#x27;orderId&#x27;</span> <span class="attr">open</span>=<span class="string">&#x27;(&#x27;</span> <span class="attr">separator</span>=<span class="string">&#x27;,&#x27;</span> <span class="attr">close</span>=<span class="string">&#x27;)&#x27;</span>&gt;</span></span><br><span class="line">            #&#123;orderId&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="ç¼–å†™å•å…ƒæµ‹è¯•ä»£ç "><a href="#ç¼–å†™å•å…ƒæµ‹è¯•ä»£ç " class="headerlink" title="ç¼–å†™å•å…ƒæµ‹è¯•ä»£ç "></a>ç¼–å†™å•å…ƒæµ‹è¯•ä»£ç </h4><p>é¦–å…ˆå¾ªç¯è°ƒç”¨OrderMapperçš„insertæ–¹æ³•æ’å…¥20æ¡è®¢å•æ•°æ®ï¼Œç„¶ååˆ†åˆ«é€‰æ‹©åŒä¸€ä¸ªè®¢å•è¡¨çš„ä¸¤ä¸ªè®¢å•orderIdå’Œé€‰æ‹©ä¸åŒè®¢å•è¡¨çš„ä¸¤ä¸ªorderIdè¿›è¡Œ<code>in</code>æŸ¥è¯¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sunchaser.shardingjdbc.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.common.collect.Lists;</span><br><span class="line"><span class="keyword">import</span> com.sunchaser.shardingjdbc.entity.OrderEntity;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> sunchaser</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2019/11/28</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderMapperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">            OrderEntity orderEntity = OrderEntity.builder()</span><br><span class="line">                    .price(<span class="keyword">new</span> BigDecimal(<span class="string">&quot;1.11&quot;</span>))</span><br><span class="line">                    .userId(<span class="string">&quot;2019xxxxxxxx&quot;</span>)</span><br><span class="line">                    .status(<span class="string">&quot;SUCCESS&quot;</span>)</span><br><span class="line">                    .build();</span><br><span class="line">            Integer success = orderMapper.insert(orderEntity);</span><br><span class="line">            System.out.println(success);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectByAnnotation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Long&gt; orderIds = Lists.newArrayList(<span class="number">406907714078244865L</span>,<span class="number">407114454203891712L</span>);</span><br><span class="line">        List&lt;OrderEntity&gt; orderEntities = orderMapper.selectByAnnotation(orderIds);</span><br><span class="line">        System.out.println(orderEntities);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectByXml</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Long&gt; orderIds = Lists.newArrayList(<span class="number">406907714078244865L</span>,<span class="number">407114454203891712L</span>);</span><br><span class="line">        List&lt;OrderEntity&gt; orderEntities = orderMapper.selectByXml(orderIds);</span><br><span class="line">        System.out.println(orderEntities);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºå‰é¢é…ç½®äº†sqlæ—¥å¿—æ‰“å°ï¼Œæˆ‘ä»¬å¯åœ¨æ§åˆ¶å°çœ‹åˆ°æ‰§è¡Œçš„é€»è¾‘SQLå’ŒçœŸå®SQLã€‚</p><p>ä»¥æŸ¥è¯¢æ–¹æ³•selectByAnnotationä¸ºä¾‹ï¼Œæ‰§è¡Œæ—¥å¿—å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">2019-12-12 11:05:36.399 DEBUG 17328 --- [           main] c.s.s.m.OrderMapper.selectByAnnotation   : &#x3D;&#x3D;&gt;  Preparing: select * from t_order t where t.order_id in ( ? , ? ) </span><br><span class="line">2019-12-12 11:05:36.459 DEBUG 17328 --- [           main] c.s.s.m.OrderMapper.selectByAnnotation   : &#x3D;&#x3D;&gt; Parameters: 406907714078244865(Long), 407114454203891712(Long)</span><br><span class="line">2019-12-12 11:05:37.778  INFO 17328 --- [           main] ShardingSphere-SQL                       : Rule Type: sharding</span><br><span class="line">2019-12-12 11:05:37.783  INFO 17328 --- [           main] ShardingSphere-SQL                       : Logic SQL: select * from t_order t where t.order_id in   (    ?   ,   ?   )</span><br><span class="line">2019-12-12 11:05:37.784  INFO 17328 --- [           main] ShardingSphere-SQL                       : SQLStatement: SelectStatement(super&#x3D;DQLStatement(super&#x3D;AbstractSQLStatement(type&#x3D;DQL, tables&#x3D;Tables(tables&#x3D;[Table(name&#x3D;t_order, alias&#x3D;Optional.of(t))]), routeConditions&#x3D;Conditions(orCondition&#x3D;OrCondition(andConditions&#x3D;[AndCondition(conditions&#x3D;[Condition(column&#x3D;Column(name&#x3D;order_id, tableName&#x3D;t_order), operator&#x3D;IN, compareOperator&#x3D;null, positionValueMap&#x3D;&#123;&#125;, positionIndexMap&#x3D;&#123;0&#x3D;0, 1&#x3D;1&#125;)])])), encryptConditions&#x3D;Conditions(orCondition&#x3D;OrCondition(andConditions&#x3D;[])), sqlTokens&#x3D;[TableToken(tableName&#x3D;t_order, quoteCharacter&#x3D;NONE, schemaNameLength&#x3D;0)], parametersIndex&#x3D;2, logicSQL&#x3D;select * from t_order t where t.order_id in   (    ?   ,   ?   ))), containStar&#x3D;true, firstSelectItemStartIndex&#x3D;7, selectListStopIndex&#x3D;7, groupByLastIndex&#x3D;0, items&#x3D;[StarSelectItem(owner&#x3D;Optional.absent())], groupByItems&#x3D;[], orderByItems&#x3D;[], limit&#x3D;null, subqueryStatement&#x3D;null, subqueryStatements&#x3D;[], subqueryConditions&#x3D;[])</span><br><span class="line">2019-12-12 11:05:37.786  INFO 17328 --- [           main] ShardingSphere-SQL                       : Actual SQL: ds1 ::: select * from t_order_1 t where t.order_id in   (    ?   ,   ?   ) ::: [406907714078244865, 407114454203891712]</span><br><span class="line">2019-12-12 11:05:37.786  INFO 17328 --- [           main] ShardingSphere-SQL                       : Actual SQL: ds1 ::: select * from t_order_2 t where t.order_id in   (    ?   ,   ?   ) ::: [406907714078244865, 407114454203891712]</span><br><span class="line">2019-12-12 11:05:38.062 DEBUG 17328 --- [           main] c.s.s.m.OrderMapper.selectByAnnotation   : &lt;&#x3D;&#x3D;      Total: 2</span><br><span class="line">[OrderEntity(orderId&#x3D;407114454203891712, price&#x3D;1.11, userId&#x3D;2019xxxxxxxx, status&#x3D;SUCCESS), OrderEntity(orderId&#x3D;406907714078244865, price&#x3D;1.11, userId&#x3D;2019xxxxxxxxxxxxxxx, status&#x3D;SUCCESS)]</span><br></pre></td></tr></table></figure><p>å¯çœ‹åˆ°æ‰§è¡Œçš„Logic SQLä¸ºï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_order t <span class="keyword">where</span> t.order_id <span class="keyword">in</span> ( ? , ? )</span><br></pre></td></tr></table></figure><p>Sharding-JDBCçš„è·¯ç”±å¼•æ“æ ¹æ®è§£æä¸Šä¸‹æ–‡åŒ¹é…æ•°æ®åº“å’Œè¡¨çš„åˆ†ç‰‡ç­–ç•¥ï¼Œè·¯ç”±åˆ°å…·ä½“çš„åº“å’Œè¡¨ã€‚å†ç»è¿‡æ”¹å†™å¼•æ“ï¼Œå°†é€»è¾‘SQLæ”¹å†™ä¸ºçœŸæ­£æ‰§è¡Œçš„SQLã€‚</p><p>ä»æ—¥å¿—ä¸­å¯çœ‹åˆ°æ”¹å†™åçš„Actual SQLä¸ºï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_order_1 t <span class="keyword">where</span> t.order_id <span class="keyword">in</span>   (    ?   ,   ?   ) ::: [<span class="number">406907714078244865</span>, <span class="number">407114454203891712</span>]</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_order_2 t <span class="keyword">where</span> t.order_id <span class="keyword">in</span>   (    ?   ,   ?   ) ::: [<span class="number">406907714078244865</span>, <span class="number">407114454203891712</span>]</span><br></pre></td></tr></table></figure><p>ç»“æœå½’å¹¶ï¼ŒçœŸå®çš„SQLæ‰§è¡Œåä¼šè¿”å›å¤šä¸ªç»“æœé›†ï¼Œå½’å¹¶å¼•æ“ä»å„ä¸ªæ•°æ®èŠ‚ç‚¹æ‹¿åˆ°ç»“æœé›†åç»„åˆæˆä¸€ä¸ªç»“æœé›†å¹¶è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>è‡³æ­¤ï¼Œå…¥é—¨æ¡ˆä¾‹å°±æ¼”ç¤ºç»“æŸã€‚æºç åœ°å€ï¼š<a href="https://github.com/sunchaser-lilu/gold-road-to-Java/tree/master/%E4%B8%AD%E9%97%B4%E4%BB%B6/sharding-jdbc-simple">ä¼ é€é—¨</a></p><p>ä¸‹ä¸€ç¯‡æ–‡ç« å°†å¯¹Sharding-JDBCä¸­çš„ä¸€äº›æ ¸å¿ƒæ¦‚å¿µè¿›è¡Œå…·ä½“çš„è§£é‡Šã€‚</p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯å¯¹Apache ShardingSphere 4.xä¸Spring Boot 2.1.xè¿›è¡Œæ•´åˆï¼Œä½¿ç”¨äº†å†…ç½®çš„SNOWFLAKEé›ªèŠ±ç®—æ³•ç”Ÿæˆåˆ†å¸ƒå¼å…¨å±€å”¯ä¸€IDå’Œä½¿ç”¨é»˜è®¤çš„inlineè¡¨è¾¾å¼é…ç½®åˆ†ç‰‡ç­–ç•¥ï¼Œå®Œæˆäº†æœ€ç®€å•çš„ä¸€åº“ä¸¤è¡¨çš„åˆ†åº“åˆ†è¡¨ï¼Œå¹¶å¯¹æ–°å¢å’ŒæŸ¥è¯¢æ“ä½œè¿›è¡Œäº†æµ‹è¯•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ä¸­é—´ä»¶ </category>
          
          <category> åˆ†åº“åˆ†è¡¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Apache ShardingSphere </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬äºŒéƒ¨åˆ†ï¼šå‡½æ•°å¼æ•°æ®å¤„ç†</title>
      <link href="2019/12/12/reading-notes/java8-in-action/Part-II-Functional-Data-Processing/"/>
      <url>2019/12/12/reading-notes/java8-in-action/Part-II-Functional-Data-Processing/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬å››ç« ï¼šå¼•å…¥æµ"><a href="#ç¬¬å››ç« ï¼šå¼•å…¥æµ" class="headerlink" title="ç¬¬å››ç« ï¼šå¼•å…¥æµ"></a>ç¬¬å››ç« ï¼šå¼•å…¥æµ</h2><h3 id="æµçš„å®šä¹‰"><a href="#æµçš„å®šä¹‰" class="headerlink" title="æµçš„å®šä¹‰"></a>æµçš„å®šä¹‰</h3><p>ä»æ”¯æŒæ•°æ®å¤„ç†æ“ä½œçš„æºç”Ÿæˆçš„å…ƒç´ åºåˆ—ã€‚</p><h3 id="å…ƒç´ åºåˆ—"><a href="#å…ƒç´ åºåˆ—" class="headerlink" title="å…ƒç´ åºåˆ—"></a>å…ƒç´ åºåˆ—</h3><p>å°±åƒé›†åˆä¸€æ ·ï¼Œæµä¹Ÿæä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥è®¿é—®ç‰¹å®šå…ƒç´ ç±»å‹çš„ä¸€ç»„æœ‰åºå€¼ã€‚</p><p>å› ä¸ºé›†åˆæ˜¯æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥å®ƒçš„ä¸»è¦ç›®çš„æ˜¯ä»¥ç‰¹å®šçš„æ—¶é—´/ç©ºé—´å¤æ‚åº¦å­˜å‚¨å’Œè®¿é—®å…ƒç´ ï¼ˆå¦‚ArrayList ä¸ LinkedListï¼‰ã€‚</p><p>ä½†æµçš„ç›®çš„åœ¨äºè¡¨è¾¾è®¡ç®—ï¼Œæ¯”å¦‚å‰é¢è§åˆ°çš„filterã€sortedå’Œmapã€‚</p><p>é›†åˆè®²çš„æ˜¯æ•°æ®ï¼Œæµè®²çš„æ˜¯è®¡ç®—ã€‚</p><h3 id="æº"><a href="#æº" class="headerlink" title="æº"></a>æº</h3><p>æµä¼šä½¿ç”¨ä¸€ä¸ªæä¾›æ•°æ®çš„æºï¼Œå¦‚é›†åˆã€æ•°ç»„æˆ–è¾“å…¥/è¾“å‡ºèµ„æºã€‚</p><p>è¯·æ³¨æ„ï¼Œä»æœ‰åºé›†åˆç”Ÿæˆæµæ—¶ä¼šä¿ç•™åŸæœ‰çš„é¡ºåºã€‚ç”±åˆ—è¡¨ç”Ÿæˆçš„æµï¼Œå…¶å…ƒç´ é¡ºåºä¸åˆ—è¡¨ä¸€è‡´ã€‚</p><h3 id="æ•°æ®å¤„ç†æ“ä½œ"><a href="#æ•°æ®å¤„ç†æ“ä½œ" class="headerlink" title="æ•°æ®å¤„ç†æ“ä½œ"></a>æ•°æ®å¤„ç†æ“ä½œ</h3><p>æµçš„æ•°æ®å¤„ç†åŠŸèƒ½æ”¯æŒç±»ä¼¼äºæ•°æ®åº“çš„æ“ä½œï¼Œä»¥åŠå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­çš„å¸¸ç”¨æ“ä½œï¼Œ</p><p>å¦‚filterã€mapã€reduceã€findã€matchã€sortç­‰ã€‚æµæ“ä½œå¯ä»¥é¡ºåºæ‰§è¡Œï¼Œä¹Ÿå¯å¹¶è¡Œæ‰§è¡Œã€‚ </p><h3 id="æµæ“ä½œçš„ç‰¹ç‚¹"><a href="#æµæ“ä½œçš„ç‰¹ç‚¹" class="headerlink" title="æµæ“ä½œçš„ç‰¹ç‚¹"></a>æµæ“ä½œçš„ç‰¹ç‚¹</h3><h4 id="1-æµæ°´çº¿"><a href="#1-æµæ°´çº¿" class="headerlink" title="1. æµæ°´çº¿"></a>1. æµæ°´çº¿</h4><p>å¾ˆå¤šæµæ“ä½œæœ¬èº«ä¼šè¿”å›ä¸€ä¸ªæµï¼Œè¿™æ ·å¤šä¸ªæ“ä½œå°±å¯ä»¥é“¾æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå¤§çš„æµæ°´çº¿ã€‚</p><p>è¿™è®©ä¹‹åç« èŠ‚ä¸­çš„ä¸€äº›ä¼˜åŒ–æˆä¸ºå¯èƒ½ï¼Œå¦‚å»¶è¿Ÿå’ŒçŸ­è·¯ã€‚</p><p>æµæ°´çº¿çš„æ“ä½œå¯ä»¥çœ‹ä½œå¯¹æ•°æ®æºè¿›è¡Œæ•°æ®åº“å¼ï¼ˆé“¾å¼ï¼‰æŸ¥è¯¢ã€‚</p><h4 id="2-å†…éƒ¨è¿­ä»£"><a href="#2-å†…éƒ¨è¿­ä»£" class="headerlink" title="2. å†…éƒ¨è¿­ä»£"></a>2. å†…éƒ¨è¿­ä»£</h4><p>ä¸ä½¿ç”¨è¿­ä»£å™¨æ˜¾å¼è¿­ä»£çš„é›†åˆä¸åŒï¼Œæµçš„è¿­ä»£æ“ä½œæ˜¯åœ¨èƒŒåè¿›è¡Œçš„ï¼ˆå†…éƒ¨è¿­ä»£ï¼‰ã€‚</p><h4 id="3-æµåªèƒ½è¢«æ¶ˆè´¹ä¸€æ¬¡"><a href="#3-æµåªèƒ½è¢«æ¶ˆè´¹ä¸€æ¬¡" class="headerlink" title="3. æµåªèƒ½è¢«æ¶ˆè´¹ä¸€æ¬¡"></a>3. æµåªèƒ½è¢«æ¶ˆè´¹ä¸€æ¬¡</h4><p>ç»ˆæ­¢æ“ä½œåªèƒ½æœ‰ä¸€æ¬¡ï¼Œé‡å¤æ¶ˆè´¹ä¼šæŠ›å‡ºjava.lang.IllegalStateExceptionå¼‚å¸¸ã€‚</p><h4 id="4-å¯¹æµçš„æ“ä½œåˆ†ä¸ºä¸¤ç±»ï¼šä¸­é—´æ“ä½œå’Œç»ˆæ­¢æ“ä½œ"><a href="#4-å¯¹æµçš„æ“ä½œåˆ†ä¸ºä¸¤ç±»ï¼šä¸­é—´æ“ä½œå’Œç»ˆæ­¢æ“ä½œ" class="headerlink" title="4. å¯¹æµçš„æ“ä½œåˆ†ä¸ºä¸¤ç±»ï¼šä¸­é—´æ“ä½œå’Œç»ˆæ­¢æ“ä½œ"></a>4. å¯¹æµçš„æ“ä½œåˆ†ä¸ºä¸¤ç±»ï¼šä¸­é—´æ“ä½œå’Œç»ˆæ­¢æ“ä½œ</h4><ul><li>ä¸­é—´æ“ä½œæ€»æ˜¯ä¼šæƒ°æ€§æ‰§è¡Œï¼šæ‰§è¡Œä¸€ä¸ªä¸­é—´æ“ä½œä¸ä¼šåœ¨åŸæµä¸Šåšä»»ä½•å¤„ç†ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ ‡è®°äº†è¯¥æ“ä½œçš„æ–°æµè¿”å›ã€‚</li><li>ç»ˆæ­¢æ“ä½œæ‰ä¼šè¿›è¡ŒçœŸå®çš„è®¡ç®—ï¼šè®¡ç®—å‘ç”Ÿæ—¶ä¼šæŠŠæ‰€æœ‰ä¸­é—´æ“ä½œç§¯æ”’çš„æ“ä½œä»¥Pipelineçš„æ–¹å¼æ‰§è¡Œï¼Œè¿™æ ·å¯ä»¥å‡å°‘è¿­ä»£æ¬¡æ•°ï¼Œè®¡ç®—å®Œæˆåæµå³å¤±æ•ˆã€‚</li></ul><h3 id="é›†åˆä¸æµçš„ä¸åŒç‚¹ï¼š"><a href="#é›†åˆä¸æµçš„ä¸åŒç‚¹ï¼š" class="headerlink" title="é›†åˆä¸æµçš„ä¸åŒç‚¹ï¼š"></a>é›†åˆä¸æµçš„ä¸åŒç‚¹ï¼š</h3><ul><li>æ— å­˜å‚¨ï¼šStreamä¸æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒåªæ˜¯æŸç§æ•°æ®æºçš„ä¸€ä¸ªè§†å›¾ã€‚æ•°æ®æºå¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„ã€Javaå®¹å™¨æˆ–I/Oèµ„æºç­‰ã€‚</li><li>ä¸ºå‡½æ•°å¼ç¼–ç¨‹è€Œç”Ÿï¼šå¯¹Streamçš„ä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šä¿®æ”¹èƒŒåçš„æ•°æ®æºï¼Œæ¯”å¦‚å¯¹ä¸€ä¸ªæµæ‰§è¡Œfilterè¿‡æ»¤æ“ä½œå¹¶ä¸ä¼šåˆ é™¤è¢«è¿‡æ»¤çš„å…ƒç´ ï¼Œè€Œæ˜¯ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ä¸åŒ…å«è¢«è¿‡æ»¤å…ƒç´ çš„æ–°æµã€‚</li><li>æƒ°æ€§æ‰§è¡Œï¼šå¯¹æµçš„ä¸­é—´æ“ä½œå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œåªæœ‰ç­‰ä¸€ä¸ªç»ˆæ­¢æ“ä½œæ¥ä¸´æ—¶æ‰ä¼šä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚</li><li>å¯æ¶ˆè´¹æ€§ï¼šä¸€ä¸ªæµåªèƒ½è¢«æ¶ˆè´¹ä¸€æ¬¡ï¼Œä¸€æ—¦äº§ç”Ÿç»ˆæ­¢æ“ä½œï¼Œæµå³è¢«æ¶ˆè´¹ã€‚</li></ul><h2 id="ç¬¬äº”ç« ï¼šä½¿ç”¨æµ"><a href="#ç¬¬äº”ç« ï¼šä½¿ç”¨æµ" class="headerlink" title="ç¬¬äº”ç« ï¼šä½¿ç”¨æµ"></a>ç¬¬äº”ç« ï¼šä½¿ç”¨æµ</h2><h3 id="1-ç­›é€‰å’Œåˆ‡ç‰‡"><a href="#1-ç­›é€‰å’Œåˆ‡ç‰‡" class="headerlink" title="1.  ç­›é€‰å’Œåˆ‡ç‰‡"></a>1.  ç­›é€‰å’Œåˆ‡ç‰‡</h3><p>é€‰æ‹©æµä¸­çš„å…ƒç´ ï¼šç”¨è°“è¯ç­›é€‰ï¼Œç­›é€‰å‡ºå„ä¸ç›¸åŒçš„å…ƒç´ ï¼Œå¿½ç•¥æµ ä¸­çš„å¤´å‡ ä¸ªå…ƒç´ ï¼Œæˆ–å°†æµæˆªçŸ­è‡³æŒ‡å®šé•¿åº¦ã€‚</p><h4 id="1-1-ç”¨è°“è¯ç­›é€‰"><a href="#1-1-ç”¨è°“è¯ç­›é€‰" class="headerlink" title="1.1 ç”¨è°“è¯ç­›é€‰"></a>1.1 ç”¨è°“è¯ç­›é€‰</h4><p>Streamsæ¥å£æ”¯æŒ<code>filter</code>æ–¹æ³•ã€‚è¯¥æ“ä½œä¼šæ¥å—ä¸€ä¸ªè°“è¯ï¼ˆä¸€ä¸ªè¿”å› booleançš„å‡½æ•°ï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…æ‹¬æ‰€æœ‰ç¬¦åˆè°“è¯çš„å…ƒç´ çš„æµã€‚</p><h4 id="1-2-ç­›é€‰å„å¼‚çš„å…ƒç´ "><a href="#1-2-ç­›é€‰å„å¼‚çš„å…ƒç´ " class="headerlink" title="1.2 ç­›é€‰å„å¼‚çš„å…ƒç´ "></a>1.2 ç­›é€‰å„å¼‚çš„å…ƒç´ </h4><p>æµæ”¯æŒä¸€ä¸ªå«ä½œ<code>distinct</code>çš„æ–¹æ³•ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå…ƒç´ å„å¼‚ï¼ˆæ ¹æ®æµæ‰€ç”Ÿæˆå…ƒç´ çš„ hashCodeå’Œequalsæ–¹æ³•å®ç°ï¼‰çš„æµã€‚</p><h4 id="1-3-æˆªçŸ­æµ"><a href="#1-3-æˆªçŸ­æµ" class="headerlink" title="1.3 æˆªçŸ­æµ"></a>1.3 æˆªçŸ­æµ</h4><p>æµæ”¯æŒ<code>limit(n)</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªä¸è¶…è¿‡ç»™å®šé•¿åº¦çš„æµã€‚</p><p>æ‰€éœ€çš„é•¿åº¦ä½œä¸ºå‚æ•°ä¼ é€’ç»™limitã€‚å¦‚æœæµæ˜¯æœ‰åºçš„ï¼Œåˆ™å¤šä¼šè¿”å›å‰nä¸ªå…ƒç´ ã€‚</p><h4 id="1-4-è·³è¿‡å…ƒç´ "><a href="#1-4-è·³è¿‡å…ƒç´ " class="headerlink" title="1.4 è·³è¿‡å…ƒç´ "></a>1.4 è·³è¿‡å…ƒç´ </h4><p>æµè¿˜æ”¯æŒ<code>skip(n)</code>æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ‰”æ‰äº†å‰nä¸ªå…ƒç´ çš„æµã€‚å¦‚æœæµä¸­å…ƒç´ ä¸è¶³nä¸ªï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæµã€‚</p><p>è¯·æ³¨æ„ï¼Œ<code>limit(n)</code>å’Œ<code>skip(n)</code>æ˜¯äº’è¡¥çš„ã€‚</p><h3 id="2-æ˜ å°„"><a href="#2-æ˜ å°„" class="headerlink" title="2. æ˜ å°„"></a>2. æ˜ å°„</h3><p>ä¸€ä¸ªéå¸¸å¸¸è§çš„æ•°æ®å¤„ç†å¥—è·¯å°±æ˜¯ä»æŸäº›å¯¹è±¡ä¸­é€‰æ‹©ä¿¡æ¯ã€‚</p><p>æ¯”å¦‚åœ¨SQLé‡Œï¼Œä½ å¯ä»¥ä»è¡¨ä¸­é€‰æ‹©ä¸€åˆ—ã€‚Stream APIä¹Ÿé€šè¿‡<code>map</code>å’Œ<code>flatMap</code>æ–¹æ³•æä¾›äº†ç±»ä¼¼çš„å·¥å…·ã€‚</p><h4 id="2-1-å¯¹æµä¸­æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°"><a href="#2-1-å¯¹æµä¸­æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°" class="headerlink" title="2.1 å¯¹æµä¸­æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°"></a>2.1 å¯¹æµä¸­æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°</h4><p>æµæ”¯æŒ<code>map</code>æ–¹æ³•ï¼Œå®ƒä¼šæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œ</p><p>å¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ ï¼ˆä½¿ç”¨æ˜ å°„ä¸€è¯ï¼Œæ˜¯å› ä¸ºå®ƒå’Œè½¬æ¢ç±»ä¼¼ï¼Œä½†å…¶ä¸­çš„ç»†å¾®å·®åˆ«åœ¨äºå®ƒæ˜¯â€œåˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬â€è€Œä¸æ˜¯å»â€œä¿®æ”¹â€ï¼‰ã€‚</p><h4 id="2-2-æµçš„æ‰å¹³åŒ–"><a href="#2-2-æµçš„æ‰å¹³åŒ–" class="headerlink" title="2.2 æµçš„æ‰å¹³åŒ–"></a>2.2 æµçš„æ‰å¹³åŒ–</h4><p>æµæ”¯æŒ<code>flatMap</code>æ–¹æ³•ï¼Œå°†å„ä¸ªå•ç‹¬çš„æµåˆå¹¶èµ·æ¥ï¼Œæ‰å¹³åŒ–æˆä¸€ä¸ªæµã€‚</p><p><code>flatMap</code>æ–¹æ³•è®©ä½ æŠŠä¸€ä¸ªæµä¸­çš„æ¯ä¸ªå€¼éƒ½æ¢æˆå¦ä¸€ä¸ªæµï¼Œç„¶åæŠŠæ‰€æœ‰çš„æµè¿æ¥èµ·æ¥æˆä¸ºä¸€ä¸ªæµã€‚</p><h3 id="3-æŸ¥æ‰¾å’ŒåŒ¹é…"><a href="#3-æŸ¥æ‰¾å’ŒåŒ¹é…" class="headerlink" title="3. æŸ¥æ‰¾å’ŒåŒ¹é…"></a>3. æŸ¥æ‰¾å’ŒåŒ¹é…</h3><p>å¦ä¸€ä¸ªå¸¸è§çš„æ•°æ®å¤„ç†å¥—è·¯æ˜¯çœ‹çœ‹æ•°æ®é›†ä¸­çš„æŸäº›å…ƒç´ æ˜¯å¦åŒ¹é…ä¸€ä¸ªç»™å®šçš„å±æ€§ã€‚</p><p>Stream APIé€šè¿‡<code>anyMatch</code>ã€<code>allMatch</code>ã€<code>noneMatch</code>ã€<code>findAny</code>å’Œ<code>findFirst</code>æ–¹æ³•æä¾›äº†è¿™æ ·çš„å·¥å…·ã€‚</p><h4 id="3-1-æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ "><a href="#3-1-æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ " class="headerlink" title="3.1 æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ "></a>3.1 æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ </h4><p><code>anyMatch()</code>ï¼šæµä¸­æ˜¯å¦æœ‰ä¸€ä¸ªå…ƒç´ èƒ½åŒ¹é…ç»™å®šçš„è°“è¯ã€‚</p><p>è¿”å›ä¸€ä¸ªbooleanï¼Œå› æ­¤æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œã€‚</p><h4 id="3-2-æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ "><a href="#3-2-æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ " class="headerlink" title="3.2 æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ "></a>3.2 æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ </h4><p><code>allMatch()</code>ï¼šæµä¸­çš„å…ƒç´ æ˜¯å¦éƒ½èƒ½åŒ¹é…ç»™å®šçš„è°“è¯ã€‚æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œã€‚</p><h4 id="3-3-æ£€æŸ¥è°“è¯æ˜¯å¦ä¸åŒ¹é…æ‰€æœ‰å…ƒç´ "><a href="#3-3-æ£€æŸ¥è°“è¯æ˜¯å¦ä¸åŒ¹é…æ‰€æœ‰å…ƒç´ " class="headerlink" title="3.3 æ£€æŸ¥è°“è¯æ˜¯å¦ä¸åŒ¹é…æ‰€æœ‰å…ƒç´ "></a>3.3 æ£€æŸ¥è°“è¯æ˜¯å¦ä¸åŒ¹é…æ‰€æœ‰å…ƒç´ </h4><p><code>noneMatch()</code>ï¼šæµä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ ä¸ç»™å®šçš„è°“è¯åŒ¹é…ã€‚</p><h4 id="3-4-æŸ¥æ‰¾å…ƒç´ "><a href="#3-4-æŸ¥æ‰¾å…ƒç´ " class="headerlink" title="3.4 æŸ¥æ‰¾å…ƒç´ "></a>3.4 æŸ¥æ‰¾å…ƒç´ </h4><p><code>findAny()</code>ï¼šå°†è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ ã€‚å¦‚æœæµä¸­æ²¡æœ‰å…ƒç´ ï¼Œè¿”å›å€¼å¯èƒ½ä¸ºç©ºï¼Œäºæ˜¯Java 8å¼•å…¥äº†<code>Optional&lt;T&gt;</code>ç±»ã€‚</p><h3 id="Optionalç®€ä»‹"><a href="#Optionalç®€ä»‹" class="headerlink" title="Optionalç®€ä»‹"></a>Optionalç®€ä»‹</h3><p><code>Optional&lt;T&gt;</code>ç±»ï¼ˆ<code>java.util.Optional</code>ï¼‰æ˜¯ä¸€ä¸ªå®¹å™¨ç±»ï¼Œä»£è¡¨ä¸€ä¸ªå€¼å­˜åœ¨æˆ–ä¸å­˜åœ¨ã€‚</p><p>æ–¹æ³•ç®€ä»‹ï¼š</p><p>1ã€<code>isPresent()</code>ï¼šå°†åœ¨OptionalåŒ…å«å€¼çš„æ—¶å€™è¿”å›true, å¦åˆ™è¿”å›falseã€‚</p><p>2ã€<code>ifPresent(Consumer&lt;T&gt; block)</code>ï¼šä¼šåœ¨å€¼å­˜åœ¨çš„æ—¶å€™æ‰§è¡Œç»™å®šçš„ä»£ç å—ã€‚</p><p>3ã€<code>T get()</code>ï¼šä¼šåœ¨å€¼å­˜åœ¨æ—¶è¿”å›å€¼ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ª<code>NoSuchElement</code>å¼‚å¸¸ã€‚</p><p>4ã€<code>T orElse(T other)</code>ï¼šä¼šåœ¨å€¼å­˜åœ¨æ—¶è¿”å›å€¼ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ã€‚ </p><h4 id="3-5-æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ "><a href="#3-5-æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ " class="headerlink" title="3.5 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ "></a>3.5 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ </h4><p><code>findFirst()</code>ï¼šè¿”å›æµä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚åŒæ ·åœ°ï¼Œå¦‚æœæµä¸­æ²¡æœ‰å…ƒç´ ï¼Œè¿”å›å€¼å¯èƒ½ä¸ºç©ºï¼Œè¿”å›ç±»å‹ä¸º<code>Optional&lt;T&gt;</code>ç±»ã€‚</p><p>æœ‰äº›æµæœ‰ä¸€ä¸ªå‡ºç°é¡ºåºï¼ˆencounter orderï¼‰æ¥æŒ‡å®šæµä¸­é¡¹ç›®å‡ºç°çš„é€»è¾‘é¡ºåºï¼ˆæ¯”å¦‚ç”±Listæˆ–æ’åºå¥½çš„æ•°æ®åˆ—ç”Ÿæˆçš„æµï¼‰ã€‚å¯¹äºè¿™ç§æµï¼Œå¯èƒ½æƒ³è¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><h3 id="4-å½’çº¦"><a href="#4-å½’çº¦" class="headerlink" title="4. å½’çº¦"></a>4. å½’çº¦</h3><p><code>reduce()</code>ï¼šå°†æµä¸­æ‰€æœ‰å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚</p><p><code>reduce()</code>æ–¹æ³•æœ‰ä¸¤ä¸ªé‡è½½çš„æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @param identity å½’çº¦çš„åˆå§‹å€¼</span><br><span class="line"> * @param accumulator å½’çº¦æ“ä½œ</span><br><span class="line"> *&#x2F;</span><br><span class="line">T reduce(T identity, BinaryOperator&lt;T&gt; accumulator);</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @param accumulator å½’çº¦æ“ä½œ</span><br><span class="line"> * @return Optional&lt;T&gt;å¯¹è±¡ï¼Œç”±äºæ²¡æœ‰åˆå§‹å€¼ï¼Œæµä¸­å…ƒç´ å¯èƒ½ä¸ºç©ºï¼Œæ•…è¿”å›å€¼ä¼šå­˜åœ¨ç©ºçš„æƒ…å†µã€‚</span><br><span class="line"> *&#x2F;</span><br><span class="line">Optional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator);</span><br></pre></td></tr></table></figure><p>mapå’Œreduceçš„è¿æ¥é€šå¸¸ç§°ä¸ºmap-reduceæ¨¡å¼ï¼Œå› Googleç”¨å®ƒæ¥è¿›è¡Œç½‘ç»œæœç´¢è€Œå‡ºåï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“å¹¶è¡ŒåŒ–ã€‚</p><h3 id="5-æ•°å€¼æµ"><a href="#5-æ•°å€¼æµ" class="headerlink" title="5. æ•°å€¼æµ"></a>5. æ•°å€¼æµ</h3><p>æµä¸­çš„å…ƒç´ æ˜¯æ•°å€¼å‹çš„ï¼Œä¾‹å¦‚intï¼Œlongï¼Œdoubleã€‚å°½ç®¡å¯ä»¥æŠŠè¿™äº›æ•°å€¼å‹å…ƒç´ æ”¾å…¥æµä¸­ï¼Œä½†å®é™…ä¸Šæ˜¯æš—å«äº†è£…ç®±æ“ä½œï¼Œå°†æ•°å€¼å‹å…ƒç´ è½¬æ¢æˆå¯¹åº”çš„åŒ…è£…ç±»å‹ï¼Œä»è€Œå½¢æˆå¯¹è±¡æµã€‚</p><p>Stream APIæä¾›äº†åŸå§‹ç±»å‹æµç‰¹åŒ–ï¼Œä¸“é—¨æ”¯æŒå¤„ç†æ•°å€¼æµçš„æ–¹æ³•ã€‚å‡å»è£…ç®±æ“ä½œçš„æŸè€—ã€‚</p><h4 id="5-1-åŸå§‹ç±»å‹æµç‰¹åŒ–"><a href="#5-1-åŸå§‹ç±»å‹æµç‰¹åŒ–" class="headerlink" title="5.1 åŸå§‹ç±»å‹æµç‰¹åŒ–"></a>5.1 åŸå§‹ç±»å‹æµç‰¹åŒ–</h4><p>Java 8å¼•å…¥äº†ä¸‰ä¸ªåŸå§‹ç±»å‹ç‰¹åŒ–æµæ¥å£ï¼š<code>IntStream</code>ã€<code>DoubleStream</code>å’Œ<code>LongStream</code>ï¼Œåˆ†åˆ«å°†æµä¸­çš„å…ƒç´ ç‰¹åŒ–ä¸ºintã€longå’Œdoubleï¼Œä»è€Œé¿å…äº†æš—å«çš„è£…ç®±æˆæœ¬ã€‚</p><p>æ¯ä¸ªæ¥å£éƒ½å¸¦æ¥äº†è¿›è¡Œå¸¸ç”¨æ•°å€¼å½’çº¦çš„æ–°æ–¹æ³•ï¼Œæ¯”å¦‚å¯¹æ•°å€¼æµæ±‚å’Œçš„sumï¼Œæ‰¾åˆ°å¤§å…ƒç´ çš„maxã€‚æ­¤å¤–è¿˜æœ‰åœ¨å¿…è¦æ—¶å†æŠŠå®ƒä»¬è½¬æ¢å›å¯¹è±¡æµçš„æ–¹æ³•ã€‚</p><h5 id="5-1-1-æ˜ å°„åˆ°æ•°å€¼æµ"><a href="#5-1-1-æ˜ å°„åˆ°æ•°å€¼æµ" class="headerlink" title="5.1.1 æ˜ å°„åˆ°æ•°å€¼æµ"></a>5.1.1 æ˜ å°„åˆ°æ•°å€¼æµ</h5><p>å°†æµè½¬æ¢ä¸ºç‰¹åŒ–ç‰ˆæœ¬çš„å¸¸ç”¨æ–¹æ³•æ˜¯<code>mapToInt</code>ã€<code>mapToDouble</code>å’Œ<code>mapToLong</code>ã€‚è¿™äº›æ–¹æ³•mapæ–¹æ³•çš„å·¥ä½œæ–¹å¼ä¸€æ ·ï¼Œåªæ˜¯å®ƒä»¬è¿”å›çš„æ˜¯ä¸€ä¸ªç‰¹åŒ–æµï¼Œè€Œä¸æ˜¯<code>Stream&lt;T&gt;</code>ã€‚</p><h5 id="5-1-2-è½¬æ¢å›å¯¹è±¡æµ"><a href="#5-1-2-è½¬æ¢å›å¯¹è±¡æµ" class="headerlink" title="5.1.2 è½¬æ¢å›å¯¹è±¡æµ"></a>5.1.2 è½¬æ¢å›å¯¹è±¡æµ</h5><p>ä¸€æ—¦æœ‰äº†æ•°å€¼æµï¼Œå¯èƒ½éœ€è¦å°†å…¶è½¬æ¢å›éç‰¹åŒ–æµã€‚</p><h5 id="5-1-3-é»˜è®¤å€¼OptionalInt"><a href="#5-1-3-é»˜è®¤å€¼OptionalInt" class="headerlink" title="5.1.3 é»˜è®¤å€¼OptionalInt"></a>5.1.3 é»˜è®¤å€¼OptionalInt</h5><p>å¯¹äºåŸå§‹ç±»å‹ç‰¹åŒ–æµæ¥å£ä¸­çš„maxï¼Œminï¼Œaverageç­‰æ–¹æ³•çš„è¿”å›å€¼ã€‚å¦‚æœæµæ˜¯ç©ºçš„ï¼Œè¿™äº›æ–¹æ³•çš„è¿”å›å€¼ä¸ºç©ºï¼Œä½†ä¸èƒ½é»˜è®¤ä¸º0ã€‚å› ä¸ºå¯èƒ½çœŸå®è®¡ç®—çš„ç»“æœæ°å¥½ä¸º0ã€‚</p><p>å¯ä»¥ä½¿ç”¨Optionalç±»æ¥è§£å†³è¿”å›å€¼ä¸ºç©ºçš„æƒ…å†µã€‚ä½†<code>Optional&lt;T&gt;</code>åªèƒ½æ¥æ”¶åŒ…è£…ç±»å‹ã€‚ä¼ é€’åŸå§‹ç±»å‹ä¼šè§¦å‘è‡ªåŠ¨è£…ç®±æ“ä½œï¼Œäº§ç”ŸæŸè€—ã€‚</p><p>Java 8åŒæ ·å¼•å…¥äº†OptionalåŸå§‹ç±»å‹ç‰¹åŒ–ç‰ˆæœ¬ï¼š<code>OptionalInt</code>ã€<code>OptionalDouble</code>å’Œ<code>OptionalLong</code>ï¼Œç”¨è¿™äº›Optionalç±»æ¥è§£å†³ä¼ é€’åŸå§‹ç±»å‹æ—¶è‡ªåŠ¨è£…ç®±çš„é—®é¢˜ã€‚</p><h4 id="5-2-æ•°å€¼èŒƒå›´"><a href="#5-2-æ•°å€¼èŒƒå›´" class="headerlink" title="5.2 æ•°å€¼èŒƒå›´"></a>5.2 æ•°å€¼èŒƒå›´</h4><p>å’Œæ•°å­—æ‰“äº¤é“æ—¶ï¼Œæœ‰ä¸€ä¸ªå¸¸ç”¨çš„ä¸œè¥¿å°±æ˜¯æ•°å€¼èŒƒå›´ã€‚æ¯”å¦‚ç”Ÿæˆ1å’Œ100ä¹‹é—´çš„æ‰€æœ‰æ•°å­—ã€‚</p><p>Java 8å¼•å…¥äº†ä¸¤ä¸ªå¯ä»¥ç”¨äº<code>IntStream</code>å’Œ<code>LongStream</code>çš„é™æ€æ–¹æ³•ï¼Œå¸®åŠ©ç”Ÿæˆè¿™ç§èŒƒå›´ï¼š <code>range</code>å’Œ<code>rangeClosed</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * rangeæ–¹æ³•è¡¨ç¤ºçš„èŒƒå›´ä¸ºï¼š[startInclusive,endExclusive)</span><br><span class="line"> * @param startInclusive æ•°å€¼èŒƒå›´å¼€å§‹</span><br><span class="line"> * @param endExclusive æ•°å€¼èŒƒå›´ç»“æŸï¼ˆä¸åŒ…å«è¯¥å€¼ï¼‰</span><br><span class="line"> *&#x2F;</span><br><span class="line">IntStream range(int startInclusive, int endExclusive);</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * rangeClosedæ–¹æ³•è¡¨ç¤ºçš„èŒƒå›´ä¸ºï¼š[startInclusive,endExclusive]</span><br><span class="line"> * @param startInclusive æ•°å€¼èŒƒå›´å¼€å§‹</span><br><span class="line"> * @param endExclusive æ•°å€¼èŒƒå›´ç»“æŸï¼ˆåŒ…å«è¯¥å€¼ï¼‰</span><br><span class="line"> *&#x2F;</span><br><span class="line">IntStream rangeClosed(int startInclusive, int endInclusive);</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ¥å—èµ·å§‹å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ¥å—ç»“æŸå€¼ã€‚ä½†<code>range</code>æ˜¯ä¸åŒ…å«ç»“æŸå€¼çš„ï¼Œè€Œ<code>rangeClosed</code>åˆ™åŒ…å«ç»“æŸå€¼ã€‚</p><h3 id="6-æ„å»ºæµ"><a href="#6-æ„å»ºæµ" class="headerlink" title="6. æ„å»ºæµ"></a>6. æ„å»ºæµ</h3><p>ä»‹ç»å¦‚ä½•ä»å€¼åºåˆ—ã€æ•°ç»„ã€æ–‡ä»¶æ¥åˆ›å»ºæµï¼Œç”šè‡³ç”±ç”Ÿæˆå‡½æ•°æ¥åˆ›å»ºæ— é™æµã€‚</p><h4 id="6-1-ç”±å€¼åˆ›å»ºæµ"><a href="#6-1-ç”±å€¼åˆ›å»ºæµ" class="headerlink" title="6.1 ç”±å€¼åˆ›å»ºæµ"></a>6.1 ç”±å€¼åˆ›å»ºæµ</h4><p>ä½¿ç”¨é™æ€æ–¹æ³•<code>Stream.of(T...values)</code>ï¼Œé€šè¿‡æ˜¾å¼å€¼åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒå¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚</p><p>ä½¿ç”¨é™æ€æ–¹æ³•<code>Stream.empty()</code>ï¼Œåˆ›å»ºä¸€ä¸ªç©ºæµã€‚</p><h4 id="6-2-ç”±æ•°ç»„åˆ›å»ºæµ"><a href="#6-2-ç”±æ•°ç»„åˆ›å»ºæµ" class="headerlink" title="6.2 ç”±æ•°ç»„åˆ›å»ºæµ"></a>6.2 ç”±æ•°ç»„åˆ›å»ºæµ</h4><p>ä½¿ç”¨é™æ€æ–¹æ³•<code>Arrays.stream</code>ä»æ•°ç»„åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ã€‚</p><h4 id="6-3ã€ç”±æ–‡ä»¶ç”Ÿæˆæµ"><a href="#6-3ã€ç”±æ–‡ä»¶ç”Ÿæˆæµ" class="headerlink" title="6.3ã€ç”±æ–‡ä»¶ç”Ÿæˆæµ"></a>6.3ã€ç”±æ–‡ä»¶ç”Ÿæˆæµ</h4><p>Javaä¸­ç”¨äºå¤„ç†æ–‡ä»¶ç­‰I/Oæ“ä½œçš„NIO APIï¼ˆéé˜»å¡ I/Oï¼‰å·²æ›´æ–°ï¼Œä»¥ä¾¿åˆ©ç”¨Stream APIã€‚</p><p><code>java.nio.file.Files</code>ä¸­çš„å¾ˆå¤šé™æ€æ–¹æ³•éƒ½ä¼šè¿”å›ä¸€ä¸ªæµã€‚</p><p>ä¾‹å¦‚ï¼Œ<code>Files.lines</code>ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªç”±æŒ‡å®šæ–‡ä»¶ä¸­çš„å„è¡Œæ„æˆçš„å­—ç¬¦ä¸²æµã€‚</p><h4 id="6-4-ç”±å‡½æ•°ç”Ÿæˆæµï¼šåˆ›å»ºæ— é™æµ"><a href="#6-4-ç”±å‡½æ•°ç”Ÿæˆæµï¼šåˆ›å»ºæ— é™æµ" class="headerlink" title="6.4 ç”±å‡½æ•°ç”Ÿæˆæµï¼šåˆ›å»ºæ— é™æµ"></a>6.4 ç”±å‡½æ•°ç”Ÿæˆæµï¼šåˆ›å»ºæ— é™æµ</h4><p>Stream APIæä¾›äº†ä¸¤ä¸ªé™æ€æ–¹æ³•æ¥ä»å‡½æ•°ç”Ÿæˆæµï¼š<code>Stream.iterate</code>å’Œ<code>Stream.generate</code>ã€‚</p><p>è¿™ä¸¤ä¸ªæ“ä½œå¯ä»¥åˆ›å»ºæ‰€è°“çš„æ— é™æµï¼šä¸åƒä»å›ºå®šé›†åˆåˆ›å»ºçš„æµé‚£æ ·æœ‰å›ºå®šå¤§å°çš„æµã€‚</p><p>ç”±<code>iterate</code>å’Œ<code>generate</code>äº§ç”Ÿçš„æµä¼šç”¨ç»™å®šçš„å‡½æ•°æŒ‰éœ€åˆ›å»ºå€¼ï¼Œå› æ­¤å¯ä»¥æ— ç©·æ— å°½åœ°è®¡ç®—ä¸‹å»ï¼</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œåº”è¯¥ä½¿ç”¨<code>limit(n)</code>æ¥å¯¹è¿™ç§æµåŠ ä»¥é™åˆ¶ï¼Œä»¥é¿å…æ‰“å°æ— ç©·å¤šä¸ªå€¼ã€‚</p><h2 id="ç¬¬å…­ç« ï¼šç”¨æµæ”¶é›†æ•°æ®"><a href="#ç¬¬å…­ç« ï¼šç”¨æµæ”¶é›†æ•°æ®" class="headerlink" title="ç¬¬å…­ç« ï¼šç”¨æµæ”¶é›†æ•°æ®"></a>ç¬¬å…­ç« ï¼šç”¨æµæ”¶é›†æ•°æ®</h2><h3 id="1-æ±‡æ€»"><a href="#1-æ±‡æ€»" class="headerlink" title="1. æ±‡æ€»"></a>1. æ±‡æ€»</h3><p><code>Collectors</code>ç±»ä¸“é—¨ä¸ºæ±‡æ€»æä¾›äº†ä¸€ä¸ªå·¥å‚æ–¹æ³•ï¼š<code>Collectors.summingInt</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Collector&lt;T, ?, Integer&gt; summingInt(ToIntFunction&lt;? super T&gt; mapper);</span><br></pre></td></tr></table></figure><p>å®ƒå¯æ¥å—ä¸€ä¸ªæŠŠå¯¹è±¡æ˜ å°„ä¸ºæ±‚å’Œæ‰€éœ€intçš„å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ”¶é›†å™¨ï¼Œè¯¥æ”¶é›†å™¨åœ¨ä¼ é€’ç»™æ™®é€šçš„collectæ–¹æ³•åå³æ‰§è¡Œæˆ‘ä»¬éœ€è¦çš„æ±‡æ€»æ“ä½œã€‚</p><p>ç±»ä¼¼çš„è¿˜æœ‰<code>Collectors.summingDouble</code>æ–¹æ³•å’Œ<code>Collectors.summingLong</code>æ–¹æ³•ï¼Œæ±‡æ€»ä¸ºdoubleå’Œlongç±»å‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Collector&lt;T, ?, Long&gt; summingLong(ToLongFunction&lt;? super T&gt; mapper);</span><br><span class="line">Collector&lt;T, ?, Double&gt; summingDouble(ToDoubleFunction&lt;? super T&gt; mapper);</span><br></pre></td></tr></table></figure><p>æ±‡æ€»ä¸ä»…ä»…åªæœ‰æ±‚å’Œã€‚</p><p>å¹³å‡æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Collector&lt;T, ?, Double&gt; averagingInt(ToIntFunction&lt;? super T&gt; mapper);</span><br><span class="line">Collector&lt;T, ?, Double&gt; averagingDouble(ToDoubleFunction&lt;? super T&gt; mapper);</span><br><span class="line">Collector&lt;T, ?, Double&gt; averagingLong(ToLongFunction&lt;? super T&gt; mapper);</span><br></pre></td></tr></table></figure><p>ä¸€æ¬¡æ“ä½œå–å¾—å¤šä¸ªæ±‡æ€»ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Collector&lt;T, ?, IntSummaryStatistics&gt; summarizingInt(ToIntFunction&lt;? super T&gt; mapper);</span><br><span class="line">Collector&lt;T, ?, LongSummaryStatistics&gt; summarizingLong(ToLongFunction&lt;? super T&gt; mapper);</span><br><span class="line">Collector&lt;T, ?, DoubleSummaryStatistics&gt; summarizingDouble(ToDoubleFunction&lt;? super T&gt; mapper);</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡å¯¹ç”¨getteræ–¹æ³•å–å¾—æ±‡æ€»ç»“æœã€‚</p><h3 id="2-è¿æ¥å­—ç¬¦ä¸²"><a href="#2-è¿æ¥å­—ç¬¦ä¸²" class="headerlink" title="2. è¿æ¥å­—ç¬¦ä¸²"></a>2. è¿æ¥å­—ç¬¦ä¸²</h3><p><code>joining</code>å·¥å‚æ–¹æ³•è¿”å›çš„æ”¶é›†å™¨ä¼šæŠŠå¯¹æµä¸­æ¯ä¸€ä¸ªå¯¹è±¡åº”ç”¨toStringæ–¹æ³•å¾—åˆ°çš„æ‰€æœ‰å­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><p><code>joining</code>æ–¹æ³•æœ‰3ä¸ªé‡è½½ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * å†…éƒ¨ä½¿ç”¨StringBuilderæ‹¼æ¥</span><br><span class="line"> *&#x2F;</span><br><span class="line">Collector&lt;CharSequence, ?, String&gt; joining();</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @param delimiter è¡¨ç¤ºæ¯ä¸ªå­—ç¬¦ä¸²è¿æ¥æ—¶çš„åˆ†éš”ç¬¦</span><br><span class="line"> *&#x2F;</span><br><span class="line">Collector&lt;CharSequence, ?, String&gt; joining(CharSequence delimiter);</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @param delimiter åˆ†éš”ç¬¦</span><br><span class="line"> * @param prefix å­—ç¬¦ä¸²å‰ç¼€</span><br><span class="line"> * @param suffix å­—ç¬¦ä¸²åç¼€</span><br><span class="line"> *&#x2F;</span><br><span class="line">Collector&lt;CharSequence, ?, String&gt; joining(CharSequence delimiter,CharSequence prefix,CharSequence suffix);</span><br></pre></td></tr></table></figure><h3 id="3-åˆ†ç»„"><a href="#3-åˆ†ç»„" class="headerlink" title="3. åˆ†ç»„"></a>3. åˆ†ç»„</h3><p><code>groupingBy</code>ï¼šè·Ÿæ•°æ®åº“ä¸­çš„group byåˆ†ç»„æ“ä½œä¸€æ ·ã€‚åŒæ—¶æ”¯æŒå¤šçº§åˆ†ç»„ã€‚</p><p><code>groupingBy</code>æ–¹æ³•æœ‰å¤šä¸ªé‡è½½ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * å†…éƒ¨è°ƒç”¨çš„æ˜¯å¸¦ä¸¤ä¸ªå‚æ•°çš„groupingByæ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ é€’çš„æ˜¯Collectors.toList()ã€‚ </span><br><span class="line"> * @param classifier ä¸€ä¸ªFunctionå‡½æ•°å‹æ¥å£ã€‚</span><br><span class="line"> *&#x2F;</span><br><span class="line">groupingBy(Function&lt;? super T, ? extends K&gt; classifier);</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * å†…éƒ¨è°ƒç”¨çš„æ˜¯ä¸‰ä¸ªå‚æ•°çš„groupingByæ–¹æ³•ã€‚</span><br><span class="line"> * @param classifier ä¸€ä¸ªFunctionå‡½æ•°å‹æ¥å£</span><br><span class="line"> * @param downstream ä¸€ä¸ªæ”¶é›†å™¨å¯¹è±¡</span><br><span class="line"> *&#x2F;</span><br><span class="line">groupingBy(Function&lt;? super T, ? extends K&gt; classifier,Collector&lt;? super T, A, D&gt; downstream);</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * æœ‰ä¸‰ä¸ªå‚æ•°ï¼ŒgroupingByåˆ†ç»„çš„å…·ä½“å®ç°ã€‚</span><br><span class="line"> *&#x2F;</span><br><span class="line">groupingBy(Function&lt;? super T, ? extends K&gt; classifier,Supplier&lt;M&gt; mapFactory,Collector&lt;? super T, A, D&gt; downstream);</span><br></pre></td></tr></table></figure><p>å¯ä»¥æŠŠç¬¬äºŒä¸ª<code>groupingBy</code>æ”¶é›†å™¨ä¼ é€’ç»™å¤–å±‚æ”¶é›†å™¨æ¥å®ç°å¤šçº§åˆ†ç»„ã€‚ ä½†è¿›ä¸€æ­¥è¯´ï¼Œä¼ é€’ç»™ç¬¬ä¸€ä¸ª<code>groupingBy</code>çš„ç¬¬äºŒä¸ªæ”¶é›†å™¨å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œè€Œä¸ä¸€å®šæ˜¯å¦ä¸€ä¸ª<code>groupingBy</code>ã€‚</p><p>æ”¶é›†å™¨è¿”å›çš„ç»“æœå¯èƒ½æ˜¯OptionalåŒ…è£…åçš„å¯¹è±¡ï¼Œå¯¹äºå¤šçº§åˆ†ç»„æ¥è¯´ï¼Œç¬¬äºŒä¸ªæ”¶é›†å™¨å¯¹è±¡å‚æ•°è¿”å›çš„Optionalå¯¹è±¡å¯èƒ½æ²¡ä»€ä¹ˆç”¨ã€‚ç¬¬ä¸€å±‚groupingByå·²ç»æŠŠä¸ºç©ºçš„æƒ…å†µç»™æ’é™¤æ‰äº†ã€‚</p><p>Collectorsæ”¶é›†å™¨æä¾›äº†<code>collectingAndThen</code>æ–¹æ³•å°†æ”¶é›†å™¨è¿›è¡Œè½¬æ¢ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * è¿”å›è½¬æ¢åçš„å¦ä¸€ä¸ªæ”¶é›†å™¨</span><br><span class="line"> * @param downstream éœ€è¦è½¬æ¢çš„æ”¶é›†å™¨</span><br><span class="line"> * @param finisher è½¬æ¢å‡½æ•°</span><br><span class="line"> *&#x2F;</span><br><span class="line">Collector&lt;T,A,RR&gt; Collectors.collectingAndThen(Collector&lt;T,A,R&gt; downstream,Function&lt;R,RR&gt; finisher);</span><br></pre></td></tr></table></figure><p><code>groupingBy</code>å¯ä»¥è”åˆå…¶å®ƒæ”¶é›†å™¨ä½¿ç”¨ï¼Œç»å¸¸ä½¿ç”¨çš„æ˜¯mappingæ–¹æ³•ã€‚å®ƒå¯ä»¥è®©æ¥å—ç‰¹å®šç±»å‹å…ƒç´ çš„æ”¶é›†å™¨é€‚åº”ä¸åŒç±»å‹çš„å¯¹è±¡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @param mapper ä¸€ä¸ªå‡½æ•°å‹æ¥å£,å¯¹æµä¸­çš„å…ƒç´ åšæ˜ å°„</span><br><span class="line"> * @param downstream ä¸€ä¸ªæ”¶é›†å™¨ï¼Œå°†æ˜ å°„åçš„å…ƒç´ æ”¶é›†èµ·æ¥</span><br><span class="line"> *&#x2F;</span><br><span class="line">Collector&lt;T, ?, R&gt; mapping(Function&lt;? super T, ? extends U&gt; mapper,Collector&lt;? super U, A, R&gt; downstream);</span><br></pre></td></tr></table></figure><h3 id="4-åˆ†åŒº"><a href="#4-åˆ†åŒº" class="headerlink" title="4. åˆ†åŒº"></a>4. åˆ†åŒº</h3><p><code>partitioningBy</code>åˆ†åŒºæ˜¯åˆ†ç»„çš„ç‰¹æ®Šæƒ…å†µï¼šç”±ä¸€ä¸ªè°“è¯ï¼ˆè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼çš„å‡½æ•°ï¼‰ä½œä¸ºåˆ†ç±»å‡½æ•°ï¼Œå®ƒç§°åˆ†åŒºå‡½æ•°ã€‚</p><p>åˆ†åŒºå‡½æ•°è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¿™æ„å‘³ç€å¾—åˆ°çš„åˆ†ç»„Mapçš„é”®ç±»å‹æ˜¯Booleanï¼Œäºæ˜¯å®ƒå¤šå¯ä»¥åˆ†ä¸ºä¸¤ç»„â€”â€”trueæ˜¯ä¸€ç»„ï¼Œfalseæ˜¯ä¸€ç»„ã€‚</p><p><code>partitioningBy</code>æ”¶é›†å™¨æœ‰ä¸¤ä¸ªé‡è½½çš„æ–¹æ³•:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * å†…éƒ¨è°ƒç”¨äº†ä¸¤ä¸ªå‚æ•°çš„é‡è½½æ–¹æ³•ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ é€’çš„æ˜¯ä¸€ä¸ªCollectors.toList()æ”¶é›†å™¨ã€‚</span><br><span class="line"> * @param predicate æ–­è¨€å‹æ¥å£</span><br><span class="line"> *&#x2F;</span><br><span class="line">Collector&lt;T, ?, Map&lt;Boolean, List&lt;T&gt;&gt;&gt; partitioningBy(Predicate&lt;? super T&gt; predicate);</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @param predicate æ–­è¨€å‹æ¥å£</span><br><span class="line"> * @param downstream æ”¶é›†å™¨</span><br><span class="line"> *&#x2F;</span><br><span class="line">Collector&lt;T, ?, Map&lt;Boolean, D&gt;&gt; partitioningBy(Predicate&lt;? super T&gt; predicate,Collector&lt;? super T, A, D&gt; downstream);</span><br></pre></td></tr></table></figure><p>åˆ†åŒºä¹Ÿå¯ç”¨ç›¸åŒçš„è°“è¯ä½¿ç”¨<code>filter</code>ç­›é€‰æ¥å®ç°ã€‚</p><h4 id="åˆ†åŒºçš„å¥½å¤„ï¼š"><a href="#åˆ†åŒºçš„å¥½å¤„ï¼š" class="headerlink" title="åˆ†åŒºçš„å¥½å¤„ï¼š"></a>åˆ†åŒºçš„å¥½å¤„ï¼š</h4><ul><li>ä¿ç•™äº†åˆ†åŒºå‡½æ•°è¿”å›trueæˆ–falseçš„ä¸¤å¥—æµå…ƒç´ åˆ—è¡¨ã€‚</li><li>ä½¿ç”¨filterç­›é€‰éœ€è¦æ“ä½œä¸¤æ¬¡ï¼Œä¸€æ¬¡åˆ©ç”¨è°“è¯ï¼Œä¸€æ¬¡åˆ©ç”¨è°“è¯çš„éã€‚</li></ul><h2 id="ç¬¬ä¸ƒç« ï¼šå¹¶è¡Œæ•°æ®å¤„ç†ä¸æ€§èƒ½"><a href="#ç¬¬ä¸ƒç« ï¼šå¹¶è¡Œæ•°æ®å¤„ç†ä¸æ€§èƒ½" class="headerlink" title="ç¬¬ä¸ƒç« ï¼šå¹¶è¡Œæ•°æ®å¤„ç†ä¸æ€§èƒ½"></a>ç¬¬ä¸ƒç« ï¼šå¹¶è¡Œæ•°æ®å¤„ç†ä¸æ€§èƒ½</h2><h3 id="å¹¶è¡Œå¤„ç†æ•°æ®ä¸€å®šæ¯”ä¸²è¡Œå¤„ç†å¿«å—ï¼Ÿ"><a href="#å¹¶è¡Œå¤„ç†æ•°æ®ä¸€å®šæ¯”ä¸²è¡Œå¤„ç†å¿«å—ï¼Ÿ" class="headerlink" title="å¹¶è¡Œå¤„ç†æ•°æ®ä¸€å®šæ¯”ä¸²è¡Œå¤„ç†å¿«å—ï¼Ÿ"></a>å¹¶è¡Œå¤„ç†æ•°æ®ä¸€å®šæ¯”ä¸²è¡Œå¤„ç†å¿«å—ï¼Ÿ</h3><p>ç­”æ¡ˆæ˜¯ä¸ä¸€å®šã€‚</p><p>å‡è®¾ä½ ç°åœ¨è¦è¿›è¡Œæ•°å­—ç´¯åŠ çš„æ“ä½œï¼Œä¾‹å¦‚è®¡ç®—1è‡³100ä¸‡ä¹‹é—´æ‰€æœ‰æ•°å­—çš„å’Œã€‚</p><p>ç°åœ¨æœ‰ä¸‰ç§æ–¹æ¡ˆå¯ä¾›é€‰æ‹©ã€‚</p><p>æ–¹æ¡ˆä¸€ï¼šåŸå§‹è¿­ä»£æ–¹å¼ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public static long iterateSum(long n) &#123;</span><br><span class="line">    long result &#x3D; 0;</span><br><span class="line">    for (int i &#x3D; 0; i &lt;&#x3D; n; i++) &#123;</span><br><span class="line">        result +&#x3D; i;</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨<code>Stream</code>ä¸²è¡Œæµå¤„ç†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public static long streamSum(long n) &#123;</span><br><span class="line">    Long result &#x3D; Stream.iterate(0L, i -&gt; i + 1)</span><br><span class="line">            .limit(n)</span><br><span class="line">            .reduce(0L, Long::sum);</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨<code>ParallelStream</code>å¹¶è¡Œæµå¤„ç†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public static long parallelSum(long n) &#123;</span><br><span class="line">    Long result &#x3D; Stream.iterate(0L, i -&gt; i + 1)</span><br><span class="line">            .limit(n)</span><br><span class="line">            .parallel()</span><br><span class="line">            .reduce(0L, Long::sum);</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸå§‹è¿­ä»£æ–¹æ¡ˆä¸­ä¸éœ€è¦å¯¹åŸå§‹ç±»å‹çš„æ•°å­—è¿›è¡Œè£…ç®±æ“ä½œã€‚</p><p>ä¸²è¡Œæµæ–¹æ¡ˆä¸­åˆ©ç”¨<code>Stream</code>æ¥å£çš„<code>iterate</code>æ–¹æ³•ç”Ÿæˆ0åˆ°nçš„è‡ªç„¶æ•°æµï¼Œé»˜è®¤æ˜¯ä¸²è¡Œæµï¼Œç„¶åå½’çº¦æ±‚å’Œã€‚</p><p>å¹¶è¡Œæµæ–¹æ¡ˆä¸­åˆ©ç”¨<code>Stream</code>æ¥å£çš„<code>iterate</code>æ–¹æ³•ç”Ÿæˆ0åˆ°nçš„è‡ªç„¶æ•°æµï¼Œä½¿ç”¨<code>parallel</code>æ–¹æ³•å°†æµè½¬æ¢æˆå¹¶è¡Œæµï¼Œç„¶åå½’çº¦æ±‚å’Œã€‚</p><p>æµ‹è¯•æ–¹æ³•ï¼šè¿è¡Œ10æ¬¡ï¼Œå–æœ€çŸ­æ—¶é—´ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public static long measureSumPerf(Function&lt;Long,Long&gt; adder,long n) &#123;</span><br><span class="line">    long fastest &#x3D; Integer.MAX_VALUE;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">        long start &#x3D; System.nanoTime();</span><br><span class="line">        long sum &#x3D; adder.apply(n);</span><br><span class="line">        long duration &#x3D; (System.nanoTime() - start) &#x2F; 1_100_100;</span><br><span class="line">        if (duration &lt; fastest) &#123;</span><br><span class="line">            fastest &#x3D; duration;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return fastest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; test</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">    &#x2F;&#x2F; åŸå§‹è¿­ä»£æ–¹å¼æ›´å¿«ï¼Œå®ƒä¸éœ€è¦å¯¹åŸå§‹ç±»å‹è¿›è¡Œè£…ç®±&#x2F;æ‹†ç®±æ“ä½œ</span><br><span class="line">    System.out.println(&quot;iterate sum min time:&quot; + measureSumPerf(</span><br><span class="line">    StreamPerformanceTest::iterateSum, 100000000));</span><br><span class="line">    &#x2F;&#x2F; iterateç”Ÿæˆçš„æ˜¯è£…ç®±çš„å¯¹è±¡ï¼Œå¿…é¡»æ‹†ç®±æˆæ•°å­—æ‰èƒ½æ±‚å’Œã€‚</span><br><span class="line">    System.out.println(&quot;stream sum min time:&quot; + measureSumPerf(</span><br><span class="line">    StreamPerformanceTest::streamSum, 100000000));</span><br><span class="line">    &#x2F;&#x2F; æ•´ä¸ªæ•°å­—åœ¨è¿‡ç¨‹å¼€å§‹æ—¶å¹¶æ²¡æœ‰å‡†å¤‡å¥½ï¼Œæ— æ³•æœ‰æ•ˆçš„æŠŠæµåˆ’åˆ†ä¸ºå°å—æ¥å¹¶è¡Œå¤„ç†ã€‚</span><br><span class="line">    System.out.println(&quot;parallel stream sum min time:&quot; + measureSumPerf(</span><br><span class="line">    StreamPerformanceTest::parallelSum, 100000000));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åŸå§‹è¿­ä»£æ–¹æ¡ˆæœ€å¿«ï¼šiterate sum min time:11</span><br><span class="line">ä¸²è¡Œæµæ–¹æ¡ˆç¬¬äºŒå¿«ï¼šstream sum min time:198</span><br><span class="line">å¹¶è¡Œæµæ–¹æ¡ˆæœ€æ…¢ï¼šparallel stream sum min time:267</span><br></pre></td></tr></table></figure><p>å¯è§å¹¶è¡Œæ‰§è¡Œå¹¶ä¸æ¯”ä¸²è¡Œæ‰§è¡Œå¿«ã€‚ä½†å®é™…ä¸Šè¿™æ¬¡è¯•éªŒçš„å¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´æ¶ˆè€—åœ¨å¯¹åŸå§‹æ•°æ®ç±»å‹è¿›è¡Œè£…ç®±çš„æ“ä½œä¸Šã€‚å› ä¸º<code>Stream</code>æ¥å£çš„<code>iterate</code>æ–¹æ³•ç”Ÿæˆçš„æ˜¯åŒ…è£…å¯¹è±¡ï¼Œæ±‚å’Œæ—¶éœ€è¦æ‹†ç®±æˆæ•°å­—ã€‚åŒæ—¶ä½¿ç”¨<code>iterate</code>æ–¹æ³•åœ¨ç¨‹åºå¼€å§‹æ—¶å¹¶æ²¡æœ‰æŠŠæ•´ä¸ªæ•°å­—åºåˆ—å‡†å¤‡å¥½ï¼Œæ— æ³•æœ‰æ•ˆçš„æŠŠæµåˆ’åˆ†ä¸ºå°å—æ¥å¹¶è¡Œå¤„ç†ã€‚</p><p>æ¥ä¸‹æ¥ä½¿ç”¨åŸå§‹ç±»å‹ç‰¹åŒ–æµæ¥ç”Ÿæˆæ•°å­—æµã€‚</p><p>åŸå§‹ç±»å‹ç‰¹åŒ–æµä¸²è¡Œå¤„ç†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public static long longStreamSum(long n) &#123;</span><br><span class="line">   long result &#x3D; LongStream.rangeClosed(1, n).reduce(0L, Long::sum);</span><br><span class="line">   return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸå§‹ç±»å‹ç‰¹åŒ–æµå¹¶è¡Œå¤„ç†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public static long longParallelSum(long n) &#123;</span><br><span class="line">    long result &#x3D; LongStream.rangeClosed(1, n).parallel().reduce(0L, Long::sum);</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; LongStream.rangeClosedç›´æ¥äº§ç”ŸåŸå§‹ç±»å‹çš„longæ•°å­—ï¼Œæ²¡æœ‰è£…ç®±æ‹†ç®±çš„å¼€é”€ã€‚</span><br><span class="line">System.out.println(&quot;long stream sum min time:&quot; + measureSumPerf(</span><br><span class="line">    StreamPerformanceTest::longStreamSum,100000000));</span><br><span class="line">&#x2F;&#x2F; LongStream.rangeClosedåœ¨è¿‡ç¨‹å¼€å§‹æ—¶å°±ä¼šç”Ÿæˆæ•°å­—èŒƒå›´ï¼Œå¾ˆå®¹æ˜“æ‹†åˆ†ä¸ºç‹¬ç«‹çš„å°å—è¿›è¡Œå¹¶è¡Œå¤„ç†ã€‚</span><br><span class="line">System.out.println(&quot;long parallel stream sum min time:&quot; +   measureSumPerf(StreamPerformanceTest::longParallelSum,100000000));</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åŸå§‹ç±»å‹ç‰¹åŒ–æµä¸²è¡Œå¤„ç†ï¼šlong stream sum min time:7</span><br><span class="line">åŸå§‹ç±»å‹ç‰¹åŒ–æµå¹¶è¡Œå¤„ç†ï¼šlong parallel stream sum min time:1</span><br></pre></td></tr></table></figure><p><code>LongStream.rangeClosed</code>ç›´æ¥äº§ç”ŸåŸå§‹ç±»å‹çš„longæ•°å­—ï¼Œæ²¡æœ‰è£…ç®±æ‹†ç®±çš„å¼€é”€ã€‚</p><p><code>LongStream.rangeClosed</code>åœ¨è¿‡ç¨‹å¼€å§‹æ—¶å°±ä¼šç”Ÿæˆæ•°å­—èŒƒå›´ï¼Œå¾ˆå®¹æ˜“æ‹†åˆ†ä¸ºç‹¬ç«‹çš„å°å—è¿›è¡Œå¹¶è¡Œå¤„ç†ã€‚</p><h3 id="å¹¶è¡Œæµæœ‰æ—¶å€™æ¯”ä¸²è¡Œæµæ…¢çš„åŸå› "><a href="#å¹¶è¡Œæµæœ‰æ—¶å€™æ¯”ä¸²è¡Œæµæ…¢çš„åŸå› " class="headerlink" title="å¹¶è¡Œæµæœ‰æ—¶å€™æ¯”ä¸²è¡Œæµæ…¢çš„åŸå› "></a>å¹¶è¡Œæµæœ‰æ—¶å€™æ¯”ä¸²è¡Œæµæ…¢çš„åŸå› </h3><p>å¹¶è¡Œæµæœ‰æ—¶å€™æ¯”ä¸²è¡Œæµæ…¢çš„åŸå› ï¼š</p><ol><li>æ²¡æœ‰ä½¿ç”¨åˆç†çš„ä½¿ç”¨æ•°æ®ç»“æ„ï¼Œå¯¼è‡´æ—¶é—´æµªè´¹åœ¨å…¶å®ƒéæµå¤„ç†çš„æ“ä½œä¸Šã€‚</li><li>å¹¶è¡Œæµçš„åº•å±‚å®ç°æ˜¯Fork/Joinæ¡†æ¶ã€‚å®ƒæ˜¯åŸºäºå¤šçº¿ç¨‹çš„ï¼Œçº¿ç¨‹ä¹‹é—´è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢éœ€è¦è€—æ—¶ã€‚åŒæ—¶çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œè°ƒåº¦çš„ã€‚çº¿ç¨‹è‡ªå·±æ— æ³•æ§åˆ¶æ—¶é—´ã€‚</li></ol><h3 id="Fork-Joinæ¡†æ¶"><a href="#Fork-Joinæ¡†æ¶" class="headerlink" title="Fork/Joinæ¡†æ¶"></a>Fork/Joinæ¡†æ¶</h3><p>Fork/Joinæ¡†æ¶æ˜¯Java 7æä¾›çš„ä¸€ä¸ªç”¨äºå¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„æ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªæŠŠå¤§ä»»åŠ¡åˆ†å‰²æˆè‹¥å¹²ä¸ªå°ä»»åŠ¡ï¼Œæœ€ç»ˆæ±‡æ€»æ¯ä¸ªå°ä»»åŠ¡ç»“æœåå¾—åˆ°å¤§ä»»åŠ¡ç»“æœçš„æ¡†æ¶ã€‚ä½“ç°äº†åˆ†æ²»æ³•çš„æ€æƒ³ã€‚Forkçš„æ„æ€æ˜¯æ‹†åˆ†ï¼ŒJoinçš„æ„æ€æ˜¯åˆå¹¶ã€‚æ¯”å¦‚è®¡ç®—1+2+â€¦+10000ï¼Œå¯ä»¥åˆ†å‰²æˆ10ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡åˆ†åˆ«å¯¹1000ä¸ªæ•°è¿›è¡Œæ±‚å’Œï¼Œ æœ€ç»ˆæ±‡æ€»è¿™10ä¸ªå­ä»»åŠ¡çš„ç»“æœã€‚Fork/Joinæ¡†æ¶çš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/02/15/4YvPn3qOA8BeKtw.jpg" alt="Fork-Join.png"></p><p>Fork/Joinçš„æ‹†åˆ†é‡ç‚¹åœ¨äºä»»åŠ¡ä»€ä¹ˆæ—¶å€™è¶³å¤Ÿå°æˆ–ä¸å¯åˆ†ï¼Œä¸å¯å†æ‹†åˆ†çš„ä»»åŠ¡é¡ºåºæ‰§è¡Œï¼Œä¸åŒçš„ä»»åŠ¡ä¹‹é—´å¹¶è¡Œæ‰§è¡Œã€‚æ‰€æœ‰ä¸å¯æ‹†åˆ†çš„å­ä»»åŠ¡åˆ†é…åˆ°å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ç­‰å¾…çº¿ç¨‹å»æ‰§è¡Œï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œåˆ’åˆ†å¹¶è¡Œä»»åŠ¡æ—¶ï¼Œåº”è¯¥è®©æ¯ä¸ªä»»åŠ¡éƒ½ç”¨ç›¸åŒçš„æ—¶é—´å®Œæˆï¼Œè®©æ‰€æœ‰çš„CPUéƒ½åŒæ ·ç¹å¿™ï¼Œå……åˆ†çš„åˆ©ç”¨CPUã€‚ä½†å®é™…ä¸­ï¼Œç”±äºçº¿ç¨‹æ˜¯ç”±æ“ä½œç³»ç»Ÿæ ¹æ®æ—¶é—´ç‰‡è¿›è¡Œè°ƒåº¦çš„ï¼Œæ¯ä¸ªå­ä»»åŠ¡æ‰€èŠ±çš„æ—¶é—´å¯èƒ½å¤©å·®åœ°åˆ«ã€‚äºæ˜¯ä¼šå‡ºç°ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œäº†ï¼Œå¦ä¸€ä¸ªé˜Ÿåˆ—ä¸­è¿˜æœ‰å¾ˆå¤šä»»åŠ¡çš„æƒ…å†µã€‚è¿™ä¸ªæ—¶å€™CPUçš„åˆ©ç”¨ç‡æ²¡æœ‰æœ€å¤§åŒ–ã€‚Java 8é‡‡ç”¨å·¥ä½œçªƒå–ç®—æ³•æ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p><h3 id="å·¥ä½œçªƒå–ï¼ˆwork-stealingï¼‰ç®—æ³•"><a href="#å·¥ä½œçªƒå–ï¼ˆwork-stealingï¼‰ç®—æ³•" class="headerlink" title="å·¥ä½œçªƒå–ï¼ˆwork-stealingï¼‰ç®—æ³•"></a>å·¥ä½œçªƒå–ï¼ˆwork-stealingï¼‰ç®—æ³•</h3><p>å·¥ä½œçªƒå–ç®—æ³•æ˜¯æŒ‡æŸä¸ªçº¿ç¨‹ä»å…¶å®ƒé˜Ÿåˆ—ä¸­çªƒå–ä»»åŠ¡æ¥æ‰§è¡Œã€‚æŸä¸ªçº¿ç¨‹ï¼Œè‡ªå·±é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼Œå°±å»åˆ«çš„è¿˜æœ‰ä»»åŠ¡çš„é˜Ÿåˆ—ä¸­çªƒå–ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œã€‚è¿™ä¸ªæ—¶å€™ä¼šå­˜åœ¨çº¿ç¨‹ç«äº‰å…³ç³»ï¼Œçªƒå–çº¿ç¨‹å’Œè¢«çªƒå–çº¿ç¨‹ä¹‹é—´åŒæ—¶è®¿é—®åŒä¸€ä¸ªé˜Ÿåˆ—ã€‚é€šå¸¸ä½¿ç”¨åŒç«¯é˜Ÿåˆ—æ¥è§£å†³ã€‚è¢«çªƒå–ä»»åŠ¡çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å¤´éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œï¼Œè€Œçªƒå–ä»»åŠ¡çš„çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å°¾éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œã€‚</p><h4 id="å·¥ä½œçªƒå–ç®—æ³•çš„ä¼˜ç‚¹ï¼š"><a href="#å·¥ä½œçªƒå–ç®—æ³•çš„ä¼˜ç‚¹ï¼š" class="headerlink" title="å·¥ä½œçªƒå–ç®—æ³•çš„ä¼˜ç‚¹ï¼š"></a>å·¥ä½œçªƒå–ç®—æ³•çš„ä¼˜ç‚¹ï¼š</h4><p>å……åˆ†åˆ©ç”¨çº¿ç¨‹è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œå‡å°‘äº†çº¿ç¨‹é—´çš„ç«äº‰ã€‚</p><h4 id="å·¥ä½œçªƒå–ç®—æ³•çš„ç¼ºç‚¹ï¼š"><a href="#å·¥ä½œçªƒå–ç®—æ³•çš„ç¼ºç‚¹ï¼š" class="headerlink" title="å·¥ä½œçªƒå–ç®—æ³•çš„ç¼ºç‚¹ï¼š"></a>å·¥ä½œçªƒå–ç®—æ³•çš„ç¼ºç‚¹ï¼š</h4><p>åœ¨æŸäº›æƒ…å†µä¸‹è¿˜æ˜¯å­˜åœ¨ç«äº‰ï¼Œæ¯”å¦‚åŒç«¯é˜Ÿåˆ—é‡Œåªæœ‰ä¸€ä¸ªä»»åŠ¡æ—¶ã€‚å¹¶ä¸”è¯¥ç®—æ³•ä¼šæ¶ˆè€—äº†æ›´å¤šçš„ç³»ç»Ÿèµ„æºï¼Œæ¯”å¦‚åˆ›å»ºå¤šä¸ªçº¿ç¨‹å’Œå¤šä¸ªåŒç«¯é˜Ÿåˆ—ã€‚</p><h3 id="Fork-Joinæ¡†æ¶çš„è®¾è®¡æ€è·¯"><a href="#Fork-Joinæ¡†æ¶çš„è®¾è®¡æ€è·¯" class="headerlink" title="Fork/Joinæ¡†æ¶çš„è®¾è®¡æ€è·¯"></a>Fork/Joinæ¡†æ¶çš„è®¾è®¡æ€è·¯</h3><ol><li>é¦–å…ˆéœ€è¦ä¸€ä¸ªForkç±»å»æŠŠå¤§ä»»åŠ¡è¿›è¡Œé€’å½’Forkæ‹†åˆ†ï¼Œç›´è‡³æ‹†åˆ†æˆä¸å¯å†åˆ†çš„å°ä»»åŠ¡ã€‚</li><li>æ‹†åˆ†å‡ºæ¥çš„å­ä»»åŠ¡å‡åŒ€åœ°åˆ†é…åˆ°nä¸ªåŒç«¯é˜Ÿåˆ—ä¸­ï¼Œå¯åŠ¨nä¸ªçº¿ç¨‹åˆ†åˆ«ä»åŒç«¯é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡æ‰§è¡Œã€‚æ¯ä¸ªå­ä»»åŠ¡æ‰§è¡Œå®Œçš„ç»“æœç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªç»“æœé˜Ÿåˆ—ä¸­ï¼Œå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä»ç»“æœé˜Ÿåˆ—ä¸­å–ç»“æœï¼Œç„¶åJoinåˆå¹¶æˆæœ€ç»ˆç»“æœã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
          <category> Java 8å®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆä¸‰ï¼‰ï¼šä»ä¸€ä¸ªç”Ÿäº§ç¯å¢ƒçš„äº‹æ•…åˆ°å¼‚æ­¥ç¼–ç¨‹æ€æƒ³</title>
      <link href="2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(3)/"/>
      <url>2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(3)/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬åä¸€ç« ï¼šCompletableFutureç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹"><a href="#ç¬¬åä¸€ç« ï¼šCompletableFutureç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="ç¬¬åä¸€ç« ï¼šCompletableFutureç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹"></a>ç¬¬åä¸€ç« ï¼šCompletableFutureç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹</h2><p>åœ¨ä»‹ç»è¿™éƒ¨åˆ†å†…å®¹ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹ç”±äºæˆ‘å’Œå¦å¤–ä¸€ä½å¼€å‘äººå‘˜çš„è€ƒè™‘ä¸å‘¨é€ æˆçš„ä¸€æ¬¡çº¿ä¸Šäº‹æ•…åœºæ™¯ï¼ˆè€ƒè™‘ä¼ä¸šéšç§ï¼Œå±è”½äº†ä¸€äº›å…³é”®è¯ï¼‰ã€‚</p><h3 id="éœ€æ±‚èƒŒæ™¯"><a href="#éœ€æ±‚èƒŒæ™¯" class="headerlink" title="éœ€æ±‚èƒŒæ™¯"></a>éœ€æ±‚èƒŒæ™¯</h3><p>å¡åŠµç³»ç»Ÿçš„åå°ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºå¤„ç†ç”¨æˆ·æŠ•è¯‰è¡¥å¿ä»¥åŠå‘é”™åˆ¸è¡¥å¿çš„åœºæ™¯ã€‚</p><h3 id="éœ€æ±‚è¯´æ˜"><a href="#éœ€æ±‚è¯´æ˜" class="headerlink" title="éœ€æ±‚è¯´æ˜"></a>éœ€æ±‚è¯´æ˜</h3><p>ä¸¤ç§æƒ…å†µä¼šä½¿ç”¨åˆ°è¿™æ¬¡æˆ‘ä»¬å¼€å‘çš„åŠŸèƒ½ã€‚</p><ol><li>å¯èƒ½ä¼šå‡ºç°ç”¨æˆ·æŠ•è¯‰æœªé¢†å–åˆ°ä¼˜æƒ åˆ¸çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥ç»™ç”¨æˆ·è¡¥å‘ä¸€å¼ ã€‚é¿å…æµªè´¹äººåŠ›å»æŸ¥çº¿ä¸Šæ—¥å¿—æ‰¾åŸå› ã€‚</li><li>è¿è¥äººå‘˜æ“ä½œå¤±è¯¯å‘é”™åŠµï¼Œéœ€è¦æ‰‹åŠ¨ç»™ç”¨æˆ·è¡¥å‘åŠµã€‚</li></ol><p>ç”±äºåŠŸèƒ½æ€¥éœ€ä¸Šçº¿ï¼Œäº§å“ç»ç†æƒ³å°½é‡ç®€åŒ–å¼€å‘ï¼Œè®¾è®¡çš„è½»é‡åŒ–ä¸€äº›ï¼Œä¸å°†è¡¥å‘è®°å½•å…¥åº“ã€‚æ¯æ¬¡è¡¥å‘å®Œæˆé¡µé¢å°±æ˜¾ç¤ºæˆåŠŸå¤šå°‘ä¸ªï¼Œå¤±è´¥å¤šå°‘ä¸ªï¼Œå¤±è´¥çš„UIDsæ˜¯å“ªäº›ã€‚</p><h3 id="ä¸šåŠ¡æµç¨‹"><a href="#ä¸šåŠ¡æµç¨‹" class="headerlink" title="ä¸šåŠ¡æµç¨‹"></a>ä¸šåŠ¡æµç¨‹</h3><ol><li>ä¸€ä¸ªè¡¥å‘åŠµé¡µé¢ï¼Œè¿è¥äººå‘˜é¦–å…ˆè¾“å…¥åŠµIDæŸ¥è¯¢åŠµä¿¡æ¯ï¼ŒåŒ…å«åŠµåç§°å’Œå¯ç”¨åº“å­˜ã€‚</li><li>ä¸Šä¼ éœ€è¦è¿›è¡Œè¡¥å‘çš„UIDsåˆ°åå°è¿›è¡Œè§£æï¼ˆè§£æçš„è¿‡ç¨‹å°±æ˜¯å»æ•°æ®åº“ä¸­æŸ¥æ˜¯å¦å­˜åœ¨è¯¥UIDå¯¹åº”çš„ç”¨æˆ·ï¼‰ã€‚</li><li>ç»™æœ‰æ•ˆçš„UIDså¯¹åº”çš„ç”¨æˆ·è¿›è¡ŒåŠµè¡¥å‘æ“ä½œï¼Œè°ƒç”¨å‘åŠµæ¥å£ã€‚</li><li>ç­‰å¾…æ‰€æœ‰ç”¨æˆ·å…¨éƒ¨è°ƒç”¨å‘åŠµæ¥å£å®Œæ¯•ï¼Œè®°å½•å¤±è´¥çš„UIDsï¼Œå“åº”ç»™å‰ç«¯ã€‚</li></ol><h3 id="äº‹æ•…åˆ†æ"><a href="#äº‹æ•…åˆ†æ" class="headerlink" title="äº‹æ•…åˆ†æ"></a>äº‹æ•…åˆ†æ</h3><ul><li><p>äº‹æ•…æè¿°ï¼šè¿è¥äººå‘˜ä¸Šä¼ äº†250ä¸ªç”¨æˆ·UIDè¿›è¡Œè¡¥å‘åŠµï¼Œç‚¹å‡»è¡¥å‘æŒ‰é’®ï¼Œç­‰å¾…äº†çº¦2åˆ†é’Ÿé¡µé¢æ˜¾ç¤ºå¤±è´¥äº†215ä¸ªUIDã€‚</p></li><li><p>æ’æŸ¥æƒ…å†µï¼šçº¿ä¸Šç¯å¢ƒå°†åº”ç”¨éƒ¨ç½²åˆ°äº†2å°æœåŠ¡å™¨ã€‚æˆ‘ä»¬åœ¨Aå’ŒBä¸¤å°æœåŠ¡å™¨çš„æ—¥å¿—ä¸Šéƒ½æŸ¥åˆ°äº†è¡¥å‘è¯·æ±‚ç›¸å…³æ—¥å¿—ã€‚æœåŠ¡å™¨Aä¸Šçš„æ—¥å¿—æ˜¾ç¤ºè¡¥å‘å¤±è´¥35æ¡ï¼ŒæœåŠ¡å™¨Bä¸Šçš„æ—¥å¿—æ˜¾ç¤ºè¡¥å‘å¤±è´¥215æ¡ã€‚</p></li><li><p>åŸå› åˆ†æï¼š</p><ul><li>AæœåŠ¡å™¨ä¸Šçš„æ—¥å¿—æ˜¾ç¤ºæ§åˆ¶å™¨å±‚æ¥æ”¶åˆ°è¯·æ±‚çš„æ—¶åˆ»æ˜¯ï¼š<code>2019-09-06 10:51:19.075</code>ï¼Œå“åº”è¯·æ±‚çš„æ—¶åˆ»æ˜¯ï¼š<code>2019-09-06 10:52:40.171</code>ï¼›</li><li>BæœåŠ¡å™¨ä¸Šçš„æ—¥å¿—æ˜¾ç¤ºæ§åˆ¶å™¨å±‚æ¥æ”¶åˆ°è¯·æ±‚çš„æ—¶åˆ»æ˜¯ï¼š<code>2019-09-06 10:52:19.061</code>ï¼Œå“åº”è¯·æ±‚çš„æ—¶åˆ»æ˜¯ï¼š<code>2019-09-06 10:52:40.022</code>ã€‚</li><li>AæœåŠ¡å™¨ä¸Šè®°å½•çš„å¤±è´¥çš„35ä¸ªUIDsåœ¨BæœåŠ¡å™¨ä¸Šå‘åŠµæˆåŠŸï¼›BæœåŠ¡å™¨ä¸Šè®°å½•çš„å¤±è´¥çš„215ä¸ªUIDsåœ¨AæœåŠ¡å™¨ä¸Šå‘åŠµæˆåŠŸã€‚å¦å¤–ä»æ—¥å¿—ä¸­å¯çœ‹å‡ºå‘åŠµæ¥å£åšäº†å¹‚ç­‰æ ¡éªŒã€‚</li></ul></li></ul><p>åˆæ­¥æ’æŸ¥ï¼šç”±äºåç«¯æœåŠ¡å™¨æ¥æ”¶åˆ°äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œåˆ¤æ–­æ˜¯å¦è¿è¥äººå‘˜ç‚¹äº†ä¸¤æ¬¡è¡¥å‘æŒ‰é’®ï¼Ÿç»è¿‡å¯¹å‰ç«¯é¡µé¢çš„æµ‹è¯•ï¼Œç‚¹äº†ä¸€æ¬¡è¡¥å‘æŒ‰é’®åï¼Œé¡µé¢å‡ºç°loadingé®ç½©å±‚ï¼Œä¸èƒ½ç¬¬äºŒæ¬¡ç‚¹å‡»è¡¥å‘æŒ‰é’®ã€‚æ’é™¤è¿è¥äººå‘˜æ“ä½œçš„é—®é¢˜ã€‚</p><p>è¿›ä¸€æ­¥åˆ†æï¼šAå’ŒBä¸¤å°æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚çš„æ—¶é—´é—´éš”æ°å¥½æ˜¯1åˆ†é’Ÿå·¦å³ï¼Œæ˜¯å¦æ˜¯å‰ç«¯Ajaxè¯·æ±‚çš„å“åº”è¶…æ—¶ä¼šè‡ªåŠ¨é‡è¯•ï¼Ÿç”±äºå‰ç«¯é¡µé¢æ˜¯ä½¿ç”¨jQueryå‘é€Ajaxè¯·æ±‚ï¼Œå¹¶ä¸”è¯·æ±‚ç±»å‹æ˜¯POSTï¼Œæµè§ˆå™¨å¹¶ä¸ä¼šè‡ªåŠ¨é‡è¯•ã€‚</p><p>æœ€ç»ˆå¾—å‡ºç»“è®ºï¼šåœ¨å‘æŒ‡å¯¼äººè¯·æ•™åï¼Œæ¨æµ‹æ˜¯çº¿ä¸Šç¯å¢ƒæœ‰Nginxè¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå½“ajaxè¯·æ±‚å¾—åˆ°å“åº”çš„æ—¶é—´è¶…è¿‡Nginxé»˜è®¤çš„60ç§’æ—¶ï¼Œè¯·æ±‚ä¼šè‡ªåŠ¨é‡å‘åˆ°å¦ä¸€å°æœåŠ¡å™¨ã€‚å‘éƒ¨é—¨ç»ç†ç¡®è®¤ç³»ç»Ÿæ¶æ„åï¼Œçº¿ä¸Šç¯å¢ƒç¡®å®å­˜åœ¨è´Ÿè½½å‡è¡¡ï¼Œä½¿ç”¨çš„æ˜¯é˜¿é‡Œçš„SLBã€‚ï¼ˆç”±äºæˆ‘ä»¬åˆšæ¥æ‰‹è¯¥é¡¹ç›®ï¼Œå¯¹çº¿ä¸Šç¯å¢ƒè¿˜ä¸å¤ªç†Ÿæ‚‰ï¼‰é˜¿é‡Œçš„SLBå¼€å¯äº†è¶…æ—¶è‡ªåŠ¨é‡å‘æœºåˆ¶ï¼Œè¶…æ—¶æ—¶é—´æ˜¯60ç§’ã€‚</p><h3 id="äº‹æ•…ç»“è®º"><a href="#äº‹æ•…ç»“è®º" class="headerlink" title="äº‹æ•…ç»“è®º"></a>äº‹æ•…ç»“è®º</h3><p>ä¸€ä¸ªè¡¥å‘åŠµçš„è¯·æ±‚ç»è¿‡SLBè´Ÿè½½å‡è¡¡åˆ°åç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨æ‰§è¡Œä¸šåŠ¡ä»£ç æ—¶é—´è¶…è¿‡äº†ä¸€åˆ†é’Ÿï¼Œè¿‡äº†60ç§’åï¼ŒSLBè®¤ä¸ºè¯¥è¯·æ±‚è¶…æ—¶ï¼Œè§¦å‘é‡è¯•æœºåˆ¶ï¼Œå°†åŒæ ·çš„è¯·æ±‚è´Ÿè½½åˆ°å¦å¤–ä¸€å°åç«¯æœåŠ¡å™¨ä¸Šï¼Œä¸¤å°æœåŠ¡å™¨ä¸Šçš„çº¿ç¨‹å¼€å§‹å¹¶å‘è°ƒç”¨å‘åŠµæ¥å£ï¼Œç”±äºå‘åŠµæ¥å£åšäº†æ¥å£å¹‚ç­‰æ€§æ ¡éªŒï¼Œæ‰€ä»¥å¹¶æœªå‡ºç°å‘åŠµé‡å¤çš„æƒ…å†µã€‚æœ€ç»ˆ250ä¸ªUIDséƒ½æˆåŠŸçš„å®Œæˆäº†è¡¥å‘ã€‚</p><ul><li>è§£å†³æ–¹æ¡ˆï¼š<ul><li>è¿è¥äººå‘˜æ¯æ¬¡ä¸Šä¼ å°‘é‡UIDsï¼Œä¿è¯å“åº”æ—¶é—´å°äº60ç§’ã€‚</li><li>äº§å“ç»ç†æå‡ºè¿­ä»£éœ€æ±‚ï¼Œç‰ˆæœ¬å‡çº§ã€‚</li></ul></li></ul><h3 id="å€¼å¾—æ€è€ƒçš„é—®é¢˜"><a href="#å€¼å¾—æ€è€ƒçš„é—®é¢˜" class="headerlink" title="å€¼å¾—æ€è€ƒçš„é—®é¢˜"></a>å€¼å¾—æ€è€ƒçš„é—®é¢˜</h3><p>äº§å“ç»ç†æå‡ºéœ€æ±‚æ—¶ï¼Œè¯´è¦ç®€åŒ–å¼€å‘ï¼Œè®¾è®¡è½»é‡åŒ–ç­‰ã€‚ä½†æˆ‘ä»¬ä½œä¸ºJavaå¼€å‘å·¥ç¨‹å¸ˆï¼Œæˆ‘ä»¬ä¸èƒ½å’Œäº§å“ç»ç†æƒ³çš„ä¸€æ ·ï¼Œå°†ç³»ç»Ÿæƒ³çš„è¿‡äºç®€åŒ–ã€‚ä»ç„¶è¦ä»ä¸€ä¸ªç¨‹åºçš„è§’åº¦å‡ºå‘æ¥è€ƒè™‘é—®é¢˜ã€‚</p><h3 id="ä»£ç å‡çº§æ–¹æ¡ˆ"><a href="#ä»£ç å‡çº§æ–¹æ¡ˆ" class="headerlink" title="ä»£ç å‡çº§æ–¹æ¡ˆ"></a>ä»£ç å‡çº§æ–¹æ¡ˆ</h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨åŸç”Ÿå®‰å“é¡¹ç›®å¼€å‘ä¸­ï¼Œæ‰€æœ‰çš„ç½‘ç»œè¯·æ±‚éƒ½å¿…é¡»åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</p><p>å®‰å“ä¸ºä»€ä¹ˆè¦è¿™æ ·é™åˆ¶å‘¢ï¼Ÿæˆ‘æƒ³ï¼Œå®‰å“ä¸€å®šæ˜¯è€ƒè™‘åˆ°æ‰€æœ‰çš„ç½‘ç»œè¯·æ±‚éƒ½æ˜¯æœ‰å¯èƒ½å‡ºç°è¶…æ—¶çš„ï¼Œå³ä½¿ç½‘ç»œè¯·æ±‚åªæ˜¯å»ç®€å•çš„è·å–ä¸€ä¸ªèµ„æºï¼Œä½†ä»å¯èƒ½ä¼šå‡ºç°ç½‘ç»œå»¶è¿Ÿçš„æƒ…å†µã€‚å¦‚æœåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä¸€æ—¦å‡ºç°å»¶è¿Ÿæˆ–è€…è¶…æ—¶ï¼Œç»™ç”¨æˆ·çš„æ„Ÿè§‰å°±æ˜¯ç•Œé¢å¡ä½ã€‚äºæ˜¯å®‰å“è¿›è¡Œäº†å¼‚æ­¥åŒ–è®¾è®¡ã€‚é™åˆ¶ç½‘ç»œè¯·æ±‚åªèƒ½åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</p><p>å¯¹äºWebåº”ç”¨ç³»ç»Ÿï¼Œå¦‚æœæœ‰æ‰§è¡Œæ—¶é—´è¾ƒé•¿çš„è¯·æ±‚ï¼Œæˆ‘ä»¬ä¹Ÿè¦å°½é‡å°†å…¶æ”¾åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚é¿å…å› ä¸ºç­‰å¾…è¿œç¨‹æœåŠ¡çš„è¿”å›ï¼Œæˆ–è€…å¯¹æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œè€Œé˜»å¡ä¸»çº¿ç¨‹çš„æ‰§è¡Œï¼Œæµªè´¹å®è´µçš„è®¡ç®—èµ„æºï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚</p><p>è¿™æ¬¡çº¿ä¸Šäº‹æ•…çš„æ ¹æœ¬åŸå› å°±æ˜¯å¼€å‘ç»éªŒä¸è¶³ï¼Œè€ƒè™‘ä¸å‘¨ï¼Œä¸äº†è§£çº¿ä¸Šæƒ…å†µï¼Œæœªè¿›è¡Œå¼‚æ­¥åŒ–è®¾è®¡ã€‚ç”±äºä¸€æ¬¡è¯·æ±‚éœ€è¦è¡¥å‘è¾ƒå¤šçš„ç”¨æˆ·ï¼Œå¯¼è‡´ä¸€æ¬¡HTTPè¯·æ±‚è¿Ÿè¿Ÿæœªå®Œæˆä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ï¼ŒSLBæœåŠ¡å™¨è®¤ä¸ºè¯·æ±‚è¶…æ—¶ï¼Œè§¦å‘äº†é‡è¯•æœºåˆ¶ï¼Œå°†åŒæ ·çš„è¯·æ±‚æ‰“åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨ä¸Šã€‚</p><p>åœ¨Javaè¯­è¨€ä¸­ï¼Œ<code>Future</code>æ¥å£ï¼Œå°¤å…¶æ˜¯å®ƒåœ¨Java 8ä¸­çš„æ–°ç‰ˆå®ç°<code>CompletableFuture</code>ï¼Œæ˜¯è¿›è¡Œå¼‚æ­¥åŒ–è®¾è®¡çš„åˆ©å™¨ã€‚</p><h3 id="Futureæ¥å£"><a href="#Futureæ¥å£" class="headerlink" title="Futureæ¥å£"></a>Futureæ¥å£</h3><p><code>Future</code>æ¥å£åœ¨Java 5ä¸­è¢«å¼•å…¥ï¼Œè®¾è®¡åˆè¡·æ˜¯å¯¹å°†æ¥æŸä¸ªæ—¶åˆ»ä¼šå‘ç”Ÿçš„ç»“æœè¿›è¡Œå»ºæ¨¡ã€‚å®ƒå»ºæ¨¡äº†ä¸€ç§å¼‚æ­¥è®¡ç®—ï¼Œè¿”å›ä¸€ä¸ªæ‰§è¡Œè¿ç®—ç»“æœçš„å¼•ç”¨ï¼Œå½“è¿ç®—ç»“æŸåï¼Œè¿™ä¸ªå¼•ç”¨è¢«è¿”å›ç»™è°ƒç”¨æ–¹ã€‚åœ¨<code>Future</code>ä¸­è§¦å‘é‚£äº›æ½œåœ¨è€—æ—¶çš„æ“ä½œæŠŠè°ƒç”¨çº¿ç¨‹è§£æ”¾å‡ºæ¥ï¼Œè®©å®ƒèƒ½åŠæ—¶å“åº”å®¢æˆ·ç«¯æˆ–è€…ç»§ç»­æ‰§è¡Œå…¶å®ƒæœ‰ä»·å€¼çš„å·¥ä½œï¼Œä¸å†éœ€è¦å‘†å‘†çš„ç­‰åˆ°è€—æ—¶çš„æ“ä½œå®Œæˆã€‚</p><p>ä¸Šè¿°è¡¥å‘åŠµä¸šåŠ¡æœ€åˆçš„åŒæ­¥ä»£ç å¤§è‡´å¦‚ä¸‹ï¼ˆè€ƒè™‘ä¼ä¸šéšç§ï¼Œå±è”½å…³é”®è¯ï¼‰ï¼š</p><p>ä¸šåŠ¡Serviceå±‚ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * åŒæ­¥ åŠµè¡¥å‘æ“ä½œ</span><br><span class="line"> * @param uIds ç”¨æˆ·UIDé›†åˆ</span><br><span class="line"> * @param couponId ä¼˜æƒ åˆ¸ID</span><br><span class="line"> * @return å¤±è´¥çš„ç”¨æˆ·UIDé›†åˆ</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public List&lt;String&gt; syncReSupplyCoupon(List&lt;String&gt; uIds, String couponId) &#123;</span><br><span class="line">    List&lt;String&gt; result &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    List&lt;UserInfoModel&gt; userInfoModelList &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    &#x2F;&#x2F; å¾ªç¯éªŒè¯UIDæœ‰æ•ˆæ€§</span><br><span class="line">    for (String uId : uIds) &#123;</span><br><span class="line">        &#x2F;&#x2F; æŸ¥è¯¢UIDå¯¹åº”ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">        UserInfoModel userInfoModel &#x3D; reSupplyCouponService.queryUserInfo(uId);</span><br><span class="line">        if (userInfoModel !&#x3D; null) &#123;</span><br><span class="line">            &#x2F;&#x2F; UIDå­˜åœ¨ï¼Œæ”¾å…¥å¾…è¿›è¡Œè¡¥å‘ç”¨æˆ·é›†åˆ</span><br><span class="line">            userInfoModelList.add(userInfoModel);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            &#x2F;&#x2F; UIDä¸å­˜åœ¨ï¼Œæ”¾å…¥è¿”å›ç»“æœé›†åˆ</span><br><span class="line">            result.add(uId);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; å¾ªç¯è¿›è¡ŒåŠµè¡¥å‘</span><br><span class="line">    for (UserInfoModel userInfoModel : userInfoModelList) &#123;</span><br><span class="line">        Boolean flag &#x3D; false;</span><br><span class="line">        try &#123;</span><br><span class="line">            flag &#x3D; reSupplyCouponService.reSupplyCoupon(couponId,userInfoModel.getUid());</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            &#x2F;&#x2F; å¼‚å¸¸å¤„ç†</span><br><span class="line">        &#125;</span><br><span class="line">        if (!flag) &#123;</span><br><span class="line">            &#x2F;&#x2F; è¡¥å‘åŠµå¤±è´¥ï¼Œæ”¾å…¥è¿”å›ç»“æœé›†åˆ</span><br><span class="line">            result.add(userInfoModel.getUid());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸºç¡€Serviceå±‚ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span><br><span class="line"> * @param uId ç”¨æˆ·UID</span><br><span class="line"> * @return ç”¨æˆ·ä¿¡æ¯model</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public UserInfoModel queryUserInfo(String uId) &#123;</span><br><span class="line">    return reSupplyCouponIntegration.queryUserInfo(uId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * è¡¥å‘åŠµæ“ä½œ</span><br><span class="line"> * @param couponId ä¼˜æƒ åˆ¸ID</span><br><span class="line"> * @param uId ç”¨æˆ·ID</span><br><span class="line"> * @return è¡¥å‘ç»“æœï¼šæˆåŠŸæˆ–å¤±è´¥</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public Boolean reSupplyCoupon(String couponId, String uId) &#123;</span><br><span class="line">    return reSupplyCouponIntegration.reSupplyCoupon(couponId,uId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Integration</code>é˜²è…å±‚ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">private static List&lt;UserInfoModel&gt; users &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * åˆå§‹åŒ–æ“ä½œï¼Œæ¨¡æ‹Ÿè¿œç¨‹ç”¨æˆ·æ•°æ®</span><br><span class="line"> *&#x2F;</span><br><span class="line">static &#123;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 250; i++) &#123;</span><br><span class="line">        users.add(new UserInfoModel(String.valueOf(i)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * æ¨¡æ‹ŸæŸ¥æ‰¾ç”¨æˆ·æ“ä½œï¼Œä¸å­˜åœ¨åˆ™UIDåˆ™æ–°å¢ä¸€ä¸ªã€‚</span><br><span class="line"> * @param uId ç”¨æˆ·UID</span><br><span class="line"> * @return ç”¨æˆ·ä¿¡æ¯model</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public UserInfoModel queryUserInfo(String uId) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        &#x2F;&#x2F; æ¨¡æ‹Ÿè°ƒç”¨è¿œç¨‹æœåŠ¡è€—æ—¶</span><br><span class="line">        Thread.sleep(100);</span><br><span class="line">    &#125; catch (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    return users.get(Integer.valueOf(uId));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * æ¨¡æ‹Ÿè¡¥å‘åŠµæ“ä½œ</span><br><span class="line"> * @param couponId ä¼˜æƒ åˆ¸ID</span><br><span class="line"> * @param uId ç”¨æˆ·id</span><br><span class="line"> * @return è¡¥å‘åŠµç»“æœï¼šæˆåŠŸæˆ–å¤±è´¥</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public Boolean reSupplyCoupon(String couponId, String uId) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        &#x2F;&#x2F; æ¨¡æ‹Ÿè°ƒç”¨è¿œç¨‹æœåŠ¡è€—æ—¶</span><br><span class="line">        Thread.sleep(200);</span><br><span class="line">    &#125; catch (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; æ¨¡æ‹ŸæˆåŠŸæˆ–å¤±è´¥æ¦‚ç‡</span><br><span class="line">    return new Random().nextInt(100) &lt; 90;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µåŒæ­¥æ‰§è¡Œçš„ä»£ç ä¸­å­˜åœ¨çš„é—®é¢˜ï¼šåŒ…å«2ä¸ªforå¾ªç¯ä¸­é€šè¿‡RPCè°ƒç”¨è¿œç¨‹æœåŠ¡æä¾›æ–¹è¿›è¡Œæ•°æ®åº“æ“ä½œï¼Œå¦‚æœUIDé›†åˆæ•°æ®é‡è¾ƒå¤§ï¼Œè¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œæ—¶é—´æ˜¯éå¸¸é•¿çš„ï¼Œä¾‹å¦‚è¿™æ¬¡äº‹æ•…ä¸­è¿è¥äººå‘˜ä¸Šä¼ äº†250ä¸ªUIDï¼Œæ‰§è¡Œæ—¶é—´å°±èŠ±äº†2åˆ†é’Ÿå·¦å³ã€‚è€—æ—¶è¿‡é•¿ï¼ŒSLBè´Ÿè½½å‡è¡¡æœåŠ¡å™¨è®¤ä¸ºè¯·æ±‚è¶…æ—¶ï¼Œè¿›è¡Œé‡è¯•ã€‚</p><p>ä½¿ç”¨Futureæ¥å£è¿›è¡Œä»£ç å¼‚æ­¥åŒ–æ”¹é€ ï¼šå°†è€—æ—¶çš„æ“ä½œå°è£…åˆ°ä¸€ä¸ª<code>Callable</code>å¯¹è±¡ä¸­ï¼Œå†å°†å®ƒæäº¤ç»™ExecutorServiceçº¿ç¨‹æ± ã€‚</p><p>ä¸šåŠ¡Serviceå±‚ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * åˆå§‹åŒ–çº¿ç¨‹æ± </span><br><span class="line"> *&#x2F;</span><br><span class="line">private static ExecutorService executorService &#x3D; Executors.newCachedThreadPool();</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * å£°æ˜Future</span><br><span class="line"> *&#x2F;</span><br><span class="line">private static Future&lt;List&lt;String&gt;&gt; future;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * ä½¿ç”¨Callableå°è£…è€—æ—¶æ“ä½œ</span><br><span class="line"> *&#x2F;</span><br><span class="line">class AsyncReSupplyCouponCallable implements Callable&lt;List&lt;String&gt;&gt; &#123;</span><br><span class="line">    &#x2F;&#x2F; é€šè¿‡æ„é€ å‡½æ•°é—´æ¥ä¼ é€’å‚æ•°ç»™callæ–¹æ³•</span><br><span class="line">    private List&lt;String&gt; uIds;</span><br><span class="line">    private String couponId;</span><br><span class="line">    public AsyncReSupplyCouponCallable(List&lt;String&gt; uIds, String couponId) &#123;</span><br><span class="line">        this.uIds &#x3D; uIds;</span><br><span class="line">        this.couponId &#x3D; couponId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;String&gt; call() throws Exception &#123;</span><br><span class="line">        &#x2F;&#x2F; è°ƒç”¨åŒæ­¥çš„è¡¥å‘åŠµæ–¹æ³•</span><br><span class="line">        return syncReSupplyCoupon(uIds,couponId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ åŸºäºJDK 5çš„Futureæ¥å£</span><br><span class="line"> * @param uIds ç”¨æˆ·UIDé›†åˆ</span><br><span class="line"> * @param couponId ä¼˜æƒ åˆ¸ID</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public void asyncFutureReSupplyCoupon(List&lt;String&gt; uIds, String couponId) &#123;</span><br><span class="line">    future &#x3D; executorService.submit(new AsyncReSupplyCouponCallable(uIds,couponId));</span><br><span class="line">    executorService.shutdown();</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">&#x2F;**</span><br><span class="line"> * è·å–è¡¥å‘åŠµå¤±è´¥çš„UIDsåœ¨å‰ç«¯æ˜¾ç¤º</span><br><span class="line"> * ç”±å‰ç«¯æ§åˆ¶è°ƒç”¨è¯¥æ–¹æ³•çš„æ—¶æœº</span><br><span class="line"> * æ ¹æ®ä¸Šä¼ çš„UIDsæ•°é‡åšè½®è¯¢ï¼Œæ—¶é—´å¯ä»¥è®¾ç½®ä¹…ä¸€ç‚¹ã€‚</span><br><span class="line"> * @return è¡¥å‘å¤±è´¥çš„UIDé›†åˆ</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public List&lt;String&gt; getFailedUIDs() &#123;</span><br><span class="line">    List&lt;String&gt; result &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    try &#123;</span><br><span class="line">        if (future !&#x3D; null) &#123;</span><br><span class="line">            &#x2F;&#x2F; å¦‚æœè°ƒç”¨getæ–¹æ³•æ—¶ï¼ŒCallableä¸­çš„ä»»åŠ¡è¿˜æœªæ‰§è¡Œå®Œï¼Œåˆ™çº¿ç¨‹é˜»å¡åœ¨è¿™é‡Œã€‚</span><br><span class="line">            &#x2F;&#x2F; ä½¿ç”¨é‡è½½çš„getæ–¹æ³•è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º50ç§’ã€‚å¦‚æœå‘ç”Ÿé˜»å¡ï¼Œåˆ™æœ€å¤šç­‰å¾…50ç§’åé€€å‡ºã€‚</span><br><span class="line">            result &#x3D; future.get(50, TimeUnit.SECONDS);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (InterruptedException e) &#123;</span><br><span class="line">        &#x2F;&#x2F; çº¿ç¨‹ç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­</span><br><span class="line">    &#125; catch (ExecutionException e) &#123;</span><br><span class="line">        &#x2F;&#x2F; è®¡ç®—æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span><br><span class="line">    &#125; catch (TimeoutException e) &#123;</span><br><span class="line">        &#x2F;&#x2F; åœ¨Futureå¯¹è±¡å®Œæˆä¹‹å‰è¶…æ—¶å·²è¿‡æœŸ</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼‚æ­¥åŒ–æ”¹é€ åŸºæœ¬å·²ç»å®Œæˆã€‚ä»¥ä¸Šä»£ç å·²ç»èƒ½å¤Ÿæœ‰æ•ˆé¿å…è¿™æ¬¡çº¿ä¸Šäº‹æ•…å†æ¬¡å‘ç”Ÿäº†ã€‚</p><h3 id="æ¥å£æ€§èƒ½æå‡"><a href="#æ¥å£æ€§èƒ½æå‡" class="headerlink" title="æ¥å£æ€§èƒ½æå‡"></a>æ¥å£æ€§èƒ½æå‡</h3><p>åŸºäº<code>Future</code>æ¥å£çš„å¼‚æ­¥æ”¹é€ å·²ç»èƒ½å¤Ÿé¿å…äº‹æ•…å†æ¬¡å‘ç”Ÿï¼Œä½†æ˜¯è€—æ—¶çš„è¡¥å‘åŠµæ“ä½œåœ¨å­çº¿ç¨‹æ‰§è¡Œä»ç„¶æ˜¯åŒæ­¥çš„ã€‚å­çº¿ç¨‹ä¸­éªŒè¯åŒæ­¥æ‰§è¡ŒéªŒè¯250ä¸ªUIDsæ˜¯å¦åˆæ³•ï¼Œç»™250ä¸ªç”¨æˆ·è¡¥å‘åŠµã€‚è€—æ—¶ä»ç„¶å¾ˆé•¿ã€‚å¦‚ä½•æå‡æ¥å£çš„æ€§èƒ½å‘¢ï¼Ÿå¦‚æœè®©ä¸åŒçš„UIDä¹‹é—´çš„æ“ä½œå¹¶è¡Œï¼Œåˆ™å¯æ˜¾è‘—æå‡æ€§èƒ½ã€‚</p><h3 id="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Java-8çš„å¹¶è¡Œæµ"><a href="#æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Java-8çš„å¹¶è¡Œæµ" class="headerlink" title="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Java 8çš„å¹¶è¡Œæµ"></a>æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Java 8çš„å¹¶è¡Œæµ</h3><p>åˆ©ç”¨Java 8çš„å¹¶è¡Œæµé¿å…æ¯ä¸ªUIDçš„é¡ºåºæ‰§è¡Œã€‚</p><p>ä¸šåŠ¡Serviceå±‚ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * ä½¿ç”¨å¹¶è¡Œæµ è¡¥å‘åŠµ</span><br><span class="line"> * @param uIds ç”¨æˆ·UIDé›†åˆ</span><br><span class="line"> * @param couponId ä¼˜æƒ åˆ¸ID</span><br><span class="line"> * @return è¡¥å‘å¤±è´¥çš„ç”¨æˆ·UIDsé›†åˆ</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public List&lt;String&gt; parallelReSupplyCoupon(List&lt;String&gt; uIds, String couponId) &#123;</span><br><span class="line">    List&lt;String&gt; failUidList &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    &#x2F;&#x2F; ä½¿ç”¨å¹¶è¡ŒæµéªŒè¯UIDæ˜¯å¦åˆæ³•ï¼ŒæŒ‰æ˜¯å¦åˆæ³•è¿›è¡Œåˆ†åŒºï¼šä¸å­˜åœ¨çš„ä¸ºtrueåŒº</span><br><span class="line">    Map&lt;Boolean, List&lt;UserInfoModel&gt;&gt; userInfoModelMap &#x3D; uIds.parallelStream()</span><br><span class="line">            .map(uId -&gt; reSupplyCouponService.queryUserInfo(uId))</span><br><span class="line">            .collect(Collectors.partitioningBy(Objects::isNull));</span><br><span class="line">    &#x2F;&#x2F; å–å‡ºä¸åˆæ³•çš„UIDåŠ å…¥è¡¥å‘å¤±è´¥çš„é›†åˆä¸­</span><br><span class="line">    userInfoModelMap.get(true)</span><br><span class="line">            .parallelStream()</span><br><span class="line">            .map(userInfoModel -&gt; failUidList.add(userInfoModel.getUid()))</span><br><span class="line">            .collect(Collectors.toList()); &#x2F;&#x2F; è§¦å‘ä¸­é—´æ“ä½œ</span><br><span class="line">    &#x2F;&#x2F; å–å‡ºåˆæ³•çš„UIDè¿›è¡Œè¡¥å‘åŠµæ“ä½œ</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; reSupplyCouponResult &#x3D; userInfoModelMap.get(false)</span><br><span class="line">            .parallelStream()</span><br><span class="line">            .map(userInfoModel -&gt; reSupplyCouponService.reSupplyCouponWithUid(couponId, userInfoModel.getUid()))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    &#x2F;&#x2F; ä»è¡¥å‘åŠµç»“æœä¸­å–å‡ºè¡¥å‘å¤±è´¥çš„åŠ å…¥è¡¥å‘å¤±è´¥çš„é›†åˆä¸­</span><br><span class="line">    reSupplyCouponResult.parallelStream()</span><br><span class="line">            .filter(map -&gt; !(Boolean) map.get(&quot;result&quot;))</span><br><span class="line">            .map(map -&gt; failUidList.add(String.valueOf(map.get(&quot;uId&quot;))))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    return failUidList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸºç¡€Serviceå±‚ä¸­æ–°å¢æ¥å£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * è¡¥å‘åŠµæ“ä½œ</span><br><span class="line"> * @param couponId ä¼˜æƒ åˆ¸ID</span><br><span class="line"> * @param uId ç”¨æˆ·ID</span><br><span class="line"> * @return [UID,&quot;æˆåŠŸæˆ–å¤±è´¥&quot;]ï¼Œè¿”å›å¯¹åº”UIDã€‚</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public Map&lt;String, Object&gt; reSupplyCouponWithUid(String couponId, String uId) &#123;</span><br><span class="line">    Map&lt;String,Object&gt; map &#x3D; new HashMap&lt;&gt;();</span><br><span class="line">    map.put(&quot;uId&quot;,uId);</span><br><span class="line">    Boolean result &#x3D; reSupplyCouponIntegration.reSupplyCoupon(couponId,uId);</span><br><span class="line">    map.put(&quot;result&quot;,result);</span><br><span class="line">    return map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Java-8çš„CompletableFutureæ¥å£"><a href="#æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Java-8çš„CompletableFutureæ¥å£" class="headerlink" title="æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Java 8çš„CompletableFutureæ¥å£"></a>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Java 8çš„CompletableFutureæ¥å£</h3><p>åˆ©ç”¨Java 8çš„<code>CompletableFuture</code>æ¥å£å¼‚æ­¥åŒ–ã€‚æ¯ä¸€ä¸ªUIDçš„æ“ä½œä¹‹é—´éƒ½æ˜¯å¼‚æ­¥çš„ã€‚</p><p>éœ€è¦å¯¹æ‰€æœ‰çš„<code>CompletableFuture</code>å¯¹è±¡æ‰§è¡Œ<code>join</code>æ“ä½œï¼Œä¸€ä¸ªä¸€ä¸ªç­‰å¾…å®ƒä»¬æ‰§è¡Œå®Œæ¯•ã€‚<code>CompletableFuture</code>ç±»ä¸­çš„<code>join</code>æ–¹æ³•å’Œ<code>Future</code>æ¥å£ä¸­çš„<code>get</code>æ–¹æ³•æœ‰ç›¸åŒçš„å«ä¹‰ï¼Œå¹¶ä¸”ä¹Ÿå£°æ˜åœ¨<code>Future</code>æ¥å£ä¸­ï¼Œå”¯ä¸€çš„ä¸åŒæ˜¯<code>join</code>æ–¹æ³•ä¸ä¼šæŠ›å‡ºä»»ä½•æ£€æµ‹åˆ°çš„å¼‚å¸¸ã€‚æ‰€ä»¥ä¸ä¼šæ˜¾å¾—Lambdaè¡¨è¾¾å¼è¿‡äºè‡ƒè‚¿ã€‚</p><p>ä¸šåŠ¡Serviceå±‚ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ æ¯ä¸€ä¸ªUIDä¹‹é—´éƒ½æ˜¯å¼‚æ­¥çš„ åŸºäºJDK 8çš„CompletableFutureæ¥å£</span><br><span class="line"> * @param uIds</span><br><span class="line"> * @param couponId</span><br><span class="line"> * @return</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public List&lt;String&gt; asyncCompletableFutureReSupplyCoupon(List&lt;String&gt; uIds, String couponId) &#123; </span><br><span class="line">    List&lt;String&gt; failUidList &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    &#x2F;&#x2F; ä½¿ç”¨CompletableFutureå¼‚æ­¥æ“ä½œï¼šéªŒè¯UIDæ˜¯å¦å­˜åœ¨ç³»ç»Ÿä¸­</span><br><span class="line">    List&lt;CompletableFuture&lt;UserInfoModel&gt;&gt; list &#x3D; uIds.stream()</span><br><span class="line">            .map(uId -&gt; CompletableFuture.supplyAsync(</span><br><span class="line">                    () -&gt; reSupplyCouponService.queryUserInfo(uId))</span><br><span class="line">            ).collect(Collectors.toList());</span><br><span class="line">    &#x2F;&#x2F; ç­‰å¾…æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œç»“æŸï¼Œåˆ†åŒºç­›é€‰å‡ºå­˜åœ¨çš„UIDså’Œä¸å­˜åœ¨çš„UIDs</span><br><span class="line">    Map&lt;Boolean, List&lt;UserInfoModel&gt;&gt; joinMap &#x3D; list.stream()</span><br><span class="line">            .map(CompletableFuture::join)</span><br><span class="line">            .collect(Collectors.partitioningBy(Objects::isNull));</span><br><span class="line">    &#x2F;&#x2F; å°†ä¸å­˜åœ¨çš„UIDsåŠ å…¥è¡¥å‘å¤±è´¥çš„é›†åˆä¸­</span><br><span class="line">    joinMap.get(true)</span><br><span class="line">            .stream()</span><br><span class="line">            .map(userInfoModel -&gt; failUidList.add(userInfoModel.getUid()))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    &#x2F;&#x2F; ä½¿ç”¨CompletableFutureå¼‚æ­¥ç»™å­˜åœ¨çš„UIDsè¡¥å‘åŠµ</span><br><span class="line">    List&lt;CompletableFuture&lt;Map&lt;String, Object&gt;&gt;&gt; reSupplyCouponResult &#x3D; joinMap.get(false)</span><br><span class="line">            .stream()</span><br><span class="line">            .map(userInfoModel -&gt; CompletableFuture.supplyAsync(</span><br><span class="line">                    () -&gt; reSupplyCouponService.reSupplyCouponWithUid(couponId, userInfoModel.getUid()))</span><br><span class="line">            ).collect(Collectors.toList());</span><br><span class="line">    &#x2F;&#x2F; ç­‰å¾…æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œç»“æŸï¼Œç­›é€‰å‡ºè¡¥å‘åŠµå¤±è´¥çš„UIDså­˜å…¥è¿”å›ç»“æœé›†åˆä¸­</span><br><span class="line">    reSupplyCouponResult.stream()</span><br><span class="line">            .map(CompletableFuture::join)</span><br><span class="line">            .filter(r -&gt; !(Boolean) r.get(&quot;result&quot;))</span><br><span class="line">            .map(r -&gt; failUidList.add(String.valueOf(r.get(&quot;uId&quot;))))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    return failUidList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¯”è¾ƒå¹¶è¡Œæµå’Œå¼‚æ­¥æ¥å£çš„å¿«æ…¢"><a href="#æ¯”è¾ƒå¹¶è¡Œæµå’Œå¼‚æ­¥æ¥å£çš„å¿«æ…¢" class="headerlink" title="æ¯”è¾ƒå¹¶è¡Œæµå’Œå¼‚æ­¥æ¥å£çš„å¿«æ…¢"></a>æ¯”è¾ƒå¹¶è¡Œæµå’Œå¼‚æ­¥æ¥å£çš„å¿«æ…¢</h3><p>åˆå§‹åŒ–8ä¸ªUIDè¿›è¡Œæµ‹è¯•ã€‚</p><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">private static List&lt;String&gt; uIds &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * åˆå§‹åŒ–8ä¸ªUIDsï¼Œæ¨¡æ‹Ÿå¾…è¡¥å‘ç”¨æˆ·</span><br><span class="line"> *&#x2F;</span><br><span class="line">static &#123;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 8; i++) &#123;</span><br><span class="line">        uIds.add(String.valueOf(i));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * æµ‹è¯•ä½¿ç”¨Java 8çš„å¹¶è¡Œæµè¿›è¡Œçš„è¡¥å‘åŠµæ“ä½œ</span><br><span class="line"> *</span><br><span class="line"> * 8ä¸ªUID</span><br><span class="line"> * done in 312msecs</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testParallelReSupplyCoupon() &#123;</span><br><span class="line">    long start &#x3D; System.nanoTime();</span><br><span class="line">    List&lt;String&gt; failedUIDs &#x3D; reSupplyCouponBizService.parallelReSupplyCoupon(uIds, &quot;1&quot;);</span><br><span class="line">    long duration &#x3D; (System.nanoTime() - start) &#x2F; 1_000_000;</span><br><span class="line">    System.out.println(&quot;done in &quot; + duration + &quot;msecs&quot;);</span><br><span class="line">    failedUIDs.stream().forEach(System.out::println);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * æµ‹è¯• å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ æ¯ä¸€ä¸ªUIDä¹‹é—´éƒ½æ˜¯å¼‚æ­¥çš„ åŸºäºJDK 8çš„CompletableFutureæ¥å£</span><br><span class="line"> *</span><br><span class="line"> * 8ä¸ªUID</span><br><span class="line"> * done in 610msecs</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testAsyncCompletableFutureReSupplyCoupon() &#123;</span><br><span class="line">    long start &#x3D; System.nanoTime();</span><br><span class="line">    List&lt;String&gt; failedUIDs &#x3D; reSupplyCouponBizService.asyncCompletableFutureReSupplyCoupon(uIds, &quot;1&quot;);</span><br><span class="line">    long duration &#x3D; (System.nanoTime() - start) &#x2F; 1_000_000;</span><br><span class="line">    System.out.println(&quot;done in &quot; + duration + &quot;msecs&quot;);</span><br><span class="line">    failedUIDs.stream().forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœè®©äººç›¸å½“å¤±æœ›ã€‚ä½¿ç”¨<code>CompletableFuture</code>æ–°æ¥å£çš„è€—æ—¶å¤§çº¦æ˜¯ä½¿ç”¨å¹¶è¡Œæµç‰ˆæœ¬çš„ä¸¤å€ã€‚éš¾é“è¿™ç§åœºæ™¯ä¸‹ä½¿ç”¨<code>CompletableFuture</code>çœŸçš„æ˜¯æµªè´¹æ—¶é—´å—ï¼Ÿä¹Ÿè®¸æˆ‘ä»¬æ¼æ‰äº†æŸäº›å¾ˆé‡è¦çš„ä¸œè¥¿ï¼Ÿæˆ‘ä»¬è¿è¡Œæµ‹è¯•ä»£ç çš„ç”µè„‘æ˜¯å¦è¶³ä»¥ä»¥å¹¶è¡Œæ–¹å¼è¿è¡Œ8ä¸ªçº¿ç¨‹ï¼Ÿ</p><p>å¹¶è¡Œæµçš„ç‰ˆæœ¬è¿è¡Œçš„è¶³å¤Ÿå¿«ï¼Œé‚£æ˜¯å› ä¸ºå®ƒèƒ½å¹¶è¡Œçš„æ‰§è¡Œçš„8ä¸ªçº¿ç¨‹ï¼Œå®ƒèƒ½ä¸ºæ¯ä¸ªUIDçš„æ“ä½œåˆ†é…ä¸€ä¸ªçº¿ç¨‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœç°åœ¨æˆ‘ä»¬åˆå§‹åŒ–9ä¸ªUIDè¿›è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å¹¶è¡Œæµç‰ˆæœ¬</span><br><span class="line">9ä¸ªUID</span><br><span class="line">done in 617msecs</span><br><span class="line"></span><br><span class="line">å¼‚æ­¥æ¥å£ç‰ˆæœ¬</span><br><span class="line">9ä¸ªUID</span><br><span class="line">done in 611msecs</span><br></pre></td></tr></table></figure><p>å¹¶è¡Œæµç‰ˆæœ¬9ä¸ªUIDçš„æµ‹è¯•ç»“æœæ¯”ä¹‹å‰å¤§æ¦‚å¤šæ¶ˆè€—äº†3ç§’ï¼Œè¿™ä¸ªæ—¶é—´é—´éš”åˆšå¥½æ˜¯ä¸€æ¬¡æ¨¡æ‹Ÿè°ƒç”¨è¿œç¨‹æœåŠ¡æ¥å£çš„è€—æ—¶ã€‚å› ä¸ºå¯ä»¥å¹¶è¡Œè¿è¡Œçš„8ä¸ªçº¿ç¨‹å¼€å§‹éƒ½å¤„äºå·¥ä½œçŠ¶æ€ï¼Œéƒ½åœ¨å¯¹å‰8ä¸ªUIDè¿›è¡Œè¡¥å‘åŠµç­‰æ“ä½œã€‚ç¬¬9ä¸ªUIDçš„æ“ä½œåªèƒ½ç­‰åˆ°å‰é¢æŸä¸ªæ“ä½œå®Œæˆé‡Šæ”¾å‡ºç©ºé—²çº¿ç¨‹æ‰èƒ½ç»§ç»­ã€‚</p><p>å¼‚æ­¥æ¥å£ç‰ˆæœ¬çš„æµ‹è¯•ç»“æœå’Œå¹¶è¡Œæµç‰ˆæœ¬ç›¸å·®æ— å‡ ã€‚ç©¶å…¶åŸå› éƒ½ä¸€æ ·ï¼šå®ƒä»¬å†…éƒ¨é‡‡ç”¨çš„æ˜¯åŒæ ·çš„é€šç”¨çº¿ç¨‹æ± ï¼Œé»˜è®¤éƒ½ä½¿ç”¨å›ºå®šæ•°é‡çš„çº¿ç¨‹ï¼Œå…·ä½“çº¿ç¨‹æ•°å–å†³äº<code>Runtime.getRuntime().availableProcessors()</code>çš„è¿”å›å€¼ã€‚ç„¶è€Œï¼Œ<code>CompletableFuture</code>å…·æœ‰ä¸€å®šä¼˜åŠ¿ï¼Œå®ƒå¯ä»¥å®šåˆ¶æ‰§è¡Œå™¨ï¼Œè‡ªå®šä¹‰çº¿ç¨‹æ± çš„å¤§å°ã€‚è¿™æ˜¯å¹¶è¡ŒæµAPIæ— æ³•å®ç°çš„ã€‚</p><h3 id="å®šåˆ¶å¼‚æ­¥æ¥å£çš„æ‰§è¡Œå™¨"><a href="#å®šåˆ¶å¼‚æ­¥æ¥å£çš„æ‰§è¡Œå™¨" class="headerlink" title="å®šåˆ¶å¼‚æ­¥æ¥å£çš„æ‰§è¡Œå™¨"></a>å®šåˆ¶å¼‚æ­¥æ¥å£çš„æ‰§è¡Œå™¨</h3><p>åˆ›å»ºä¸€ä¸ªé…æœ‰çº¿ç¨‹æ± çš„æ‰§è¡Œå™¨å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯æˆ‘ä»¬è¯¥å¦‚ä½•é€‰æ‹©åˆé€‚çš„çº¿ç¨‹æ•°ç›®å‘¢ï¼Ÿ</p><blockquote><p>ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ä¹¦ä¸­ä»‹ç»åˆ°ï¼ŒBrian Goetzå’Œåˆè‘—è€…ä»¬ä¸ºçº¿ç¨‹æ± å¤§å°çš„ä¼˜åŒ–æä¾›äº†ä¸å°‘ä¸­è‚¯çš„å»ºè®®ã€‚è¿™éå¸¸é‡è¦ï¼Œå¦‚æœçº¿ç¨‹æ± ä¸­çº¿ç¨‹çš„æ•°é‡è¿‡å¤šï¼Œæœ€ç»ˆå®ƒä»¬ä¼šç«äº‰ç¨€ç¼ºçš„å¤„ç†å™¨å’Œå†…å­˜èµ„æºï¼Œæµªè´¹å¤§é‡çš„æ—¶é—´åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢ä¸Šã€‚åä¹‹ï¼Œå¦‚æœçº¿ç¨‹çš„æ•°ç›®è¿‡å°‘ï¼Œæ­£å¦‚ä½ çš„åº”ç”¨æ‰€é¢ä¸´çš„æƒ…å†µï¼Œå¤„ç†å™¨çš„ä¸€äº›æ ¸å¯èƒ½å°±æ— æ³•å……åˆ†åˆ©ç”¨ã€‚Brian Goetzå»ºè®®ï¼Œçº¿ç¨‹æ± å¤§å°ä¸å¤„ç†å™¨çš„åˆ©ç”¨ç‡ä¹‹æ¯”å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å…¬å¼è¿›è¡Œä¼°ç®—ï¼š<br><strong>N</strong><sub>threads</sub> = <strong>N</strong><sub>CPU</sub> * <strong>U</strong><sub>CPU</sub> * (1 + <strong>W</strong>/<strong>C</strong>)<br>å…¶ä¸­ï¼š</p><ul><li><strong>N</strong><sub>threads</sub>æ˜¯å¤„ç†å™¨çš„æ ¸çš„æ•°ç›®ï¼Œå¯ä»¥é€šè¿‡<code>Runtime.getRuntime().availableProcessors()</code>å¾—åˆ°ï¼›</li><li><strong>U</strong><sub>CPU</sub>æ˜¯æœŸæœ›çš„CPUåˆ©ç”¨ç‡ï¼ˆè¯¥å€¼åº”è¯¥ä»‹äº0å’Œ1ä¹‹é—´ï¼‰</li><li><strong>W</strong>/<strong>C</strong>æ˜¯ç­‰å¾…æ—¶é—´ä¸è®¡ç®—æ—¶é—´çš„æ¯”ç‡</li></ul></blockquote><p>è¡¥å‘åŠµæ¥å£99%çš„æ—¶é—´éƒ½åœ¨ç­‰å¾…è¿œç¨‹æœåŠ¡çš„å“åº”ï¼Œæ‰€ä»¥ä¼°ç®—å‡ºçš„W/Cçš„æ¯”ç‡ä¸º100ã€‚å¦‚æœæœŸæœ›çš„CPUåˆ©ç”¨ç‡ä¸º100%ï¼Œåˆ™éœ€è¦åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰800ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚ä½†å®é™…ä¸Šï¼Œçº¿ç¨‹æ± ä¸­çš„æœ‰äº›çº¿ç¨‹æ ¹æœ¬æ²¡æœºä¼šè¢«ä½¿ç”¨ï¼Œåè€Œæ˜¯ä¸€ç§æµªè´¹ã€‚æ‰€ä»¥å»ºè®®å°†æ‰§è¡Œå™¨ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼Œä¸å®é™…éœ€è¦çš„çº¿ç¨‹æ•°ï¼ˆUIDsçš„æ•°é‡ï¼‰è®¾å®šä¸ºåŒæ ·çš„å€¼ã€‚è¿™æ ·æ¯ä¸ªUIDéƒ½å¯¹åº”ä¸€ä¸ªæœåŠ¡çº¿ç¨‹ã€‚ä½†æ˜¯ï¼Œå½“UIDsæ•°é‡è¿‡å¤§æ—¶ï¼Œè¿è¡Œä»£ç çš„æœºå™¨å¿…ç„¶ä¼šå› è¶…è´Ÿè·è€Œå´©æºƒï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯æœ‰ä¸€ä¸ªä¸Šé™ã€‚</p><p>ä¸šåŠ¡Serviceå±‚ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * å®šåˆ¶æ‰§è¡Œå™¨-çº¿ç¨‹æ± å¤§å°ä¸ºUIDsçš„æ•°é‡ï¼šè®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå½“ç¨‹åºé€€å‡ºæ—¶ï¼Œçº¿ç¨‹ä¹Ÿä¼šè¢«å›æ”¶ã€‚</span><br><span class="line"> *&#x2F;</span><br><span class="line">private final Executor executor &#x3D; Executors.newFixedThreadPool(125, r -&gt; &#123;</span><br><span class="line">    Thread t &#x3D; new Thread(r);</span><br><span class="line">    t.setDaemon(true);</span><br><span class="line">    return t;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ å®šåˆ¶CompletableFutureæ¥å£çš„æ‰§è¡Œå™¨</span><br><span class="line"> * @param uIds ç”¨æˆ·UIDé›†åˆ</span><br><span class="line"> * @param couponId ä¼˜æƒ åˆ¸ID</span><br><span class="line"> * @return è¡¥å‘å¤±è´¥çš„ç”¨æˆ·UIDé›†åˆ</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Override</span><br><span class="line">public List&lt;String&gt; asyncCompletableFutureCustomExecutorReSupplyCoupon(List&lt;String&gt; uIds, String couponId) &#123;</span><br><span class="line">    List&lt;String&gt; failUidList &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    &#x2F;&#x2F; ä½¿ç”¨å®šåˆ¶æ‰§è¡Œå™¨çš„CompletableFutureå¼‚æ­¥æ“ä½œï¼šéªŒè¯UIDæ˜¯å¦å­˜åœ¨ç³»ç»Ÿä¸­</span><br><span class="line">    List&lt;CompletableFuture&lt;UserInfoModel&gt;&gt; list &#x3D; uIds.stream()</span><br><span class="line">            .map(uId -&gt; CompletableFuture.supplyAsync(</span><br><span class="line">                    () -&gt; reSupplyCouponService.queryUserInfo(uId),executor)</span><br><span class="line">            ).collect(Collectors.toList());</span><br><span class="line">    &#x2F;&#x2F; ç­‰å¾…æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œç»“æŸï¼Œåˆ†åŒºç­›é€‰å‡ºå­˜åœ¨çš„UIDså’Œä¸å­˜åœ¨çš„UIDs</span><br><span class="line">    Map&lt;Boolean, List&lt;UserInfoModel&gt;&gt; joinMap &#x3D; list.stream()</span><br><span class="line">            .map(CompletableFuture::join)</span><br><span class="line">            .collect(Collectors.partitioningBy(Objects::isNull));</span><br><span class="line">    &#x2F;&#x2F; å°†ä¸å­˜åœ¨çš„UIDsåŠ å…¥è¡¥å‘å¤±è´¥çš„é›†åˆä¸­</span><br><span class="line">    joinMap.get(true)</span><br><span class="line">            .stream()</span><br><span class="line">            .map(userInfoModel -&gt; failUidList.add(userInfoModel.getUid()))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    &#x2F;&#x2F; ä½¿ç”¨å®šåˆ¶æ‰§è¡Œå™¨çš„CompletableFutureå¼‚æ­¥ç»™å­˜åœ¨çš„UIDsè¡¥å‘åŠµ</span><br><span class="line">    List&lt;CompletableFuture&lt;Map&lt;String, Object&gt;&gt;&gt; reSupplyCouponResult &#x3D; joinMap.get(false)</span><br><span class="line">            .stream()</span><br><span class="line">            .map(userInfoModel -&gt; CompletableFuture.supplyAsync(</span><br><span class="line">                    () -&gt; reSupplyCouponService.reSupplyCouponWithUid(couponId, userInfoModel.getUid()),executor)</span><br><span class="line">            ).collect(Collectors.toList());</span><br><span class="line">    &#x2F;&#x2F; ç­‰å¾…æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œç»“æŸï¼Œç­›é€‰å‡ºè¡¥å‘åŠµå¤±è´¥çš„UIDså­˜å…¥è¿”å›ç»“æœé›†åˆä¸­</span><br><span class="line">    reSupplyCouponResult.stream()</span><br><span class="line">            .map(CompletableFuture::join)</span><br><span class="line">            .filter(r -&gt; !(Boolean) r.get(&quot;result&quot;))</span><br><span class="line">            .map(r -&gt; failUidList.add(String.valueOf(r.get(&quot;uId&quot;))))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">    return failUidList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨125ä¸ªUIDè¿›è¡Œæµ‹è¯•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">private static List&lt;String&gt; uIds &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * åˆå§‹åŒ–æ“ä½œï¼Œæ¨¡æ‹Ÿå¾…è¡¥å‘ç”¨æˆ·</span><br><span class="line"> *&#x2F;</span><br><span class="line">static &#123;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 125; i++) &#123;</span><br><span class="line">        uIds.add(String.valueOf(i));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * æµ‹è¯• å¼‚æ­¥ åŠµè¡¥å‘æ“ä½œ å®šåˆ¶CompletableFutureæ¥å£çš„æ‰§è¡Œå™¨</span><br><span class="line"> *</span><br><span class="line"> * 125ä¸ªUID</span><br><span class="line"> * done in 369msecs</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testAsyncCompletableFutureCustomExecutorReSupplyCoupon() &#123;</span><br><span class="line">    long start &#x3D; System.nanoTime();</span><br><span class="line">    List&lt;String&gt; failedUIDs &#x3D; reSupplyCouponBizService.asyncCompletableFutureCustomExecutorReSupplyCoupon(uIds, &quot;1&quot;);</span><br><span class="line">    long duration &#x3D; (System.nanoTime() - start) &#x2F; 1_000_000;</span><br><span class="line">    System.out.println(&quot;done in &quot; + duration + &quot;msecs&quot;);</span><br><span class="line">    failedUIDs.stream().forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœï¼š<code>done in 369msecs</code>ï¼Œæ˜¾è€Œæ˜“è§ï¼Œè€—æ—¶å’Œ8ä¸ªUIDçš„å¹¶è¡Œæµç‰ˆæœ¬å¾ˆæ¥è¿‘ã€‚æ€§èƒ½æ˜¾è‘—æå‡ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œéšç€UIDæ•°é‡ç»§ç»­å¢å¤šï¼Œè€—æ—¶ä¸ä¼šç›¸å·®å¤ªå¤šï¼Œç›´åˆ°è¾¾åˆ°ä¹‹å‰è®¡ç®—çš„é˜ˆå€¼800ï¼ˆCPUåˆ©ç”¨ç‡è¾¾åˆ°100%ï¼‰ã€‚</p><h3 id="åœ¨å¹¶è¡Œæµå’ŒCompletableFutureä¹‹é—´è¿›è¡Œé€‰æ‹©"><a href="#åœ¨å¹¶è¡Œæµå’ŒCompletableFutureä¹‹é—´è¿›è¡Œé€‰æ‹©" class="headerlink" title="åœ¨å¹¶è¡Œæµå’ŒCompletableFutureä¹‹é—´è¿›è¡Œé€‰æ‹©"></a>åœ¨å¹¶è¡Œæµå’ŒCompletableFutureä¹‹é—´è¿›è¡Œé€‰æ‹©</h3><p>å¹¶è¡Œæµåº•å±‚çš„Fork/Joinæ¡†æ¶ä½¿ç”¨é€šç”¨çš„çº¿ç¨‹æ± ï¼Œæ— æ³•ä¸ªæ€§åŒ–å®šåˆ¶ã€‚æ–°çš„<code>CompletableFuture</code>æ¥å£å¯ä»¥å®šåˆ¶æ‰§è¡Œå™¨ï¼Œè°ƒæ•´çº¿ç¨‹æ± å¤§å°ï¼Œèƒ½å¤Ÿæ›´åŠ å……åˆ†çš„åˆ©ç”¨CPUèµ„æºã€‚</p><p>å»ºè®®å¦‚ä¸‹ï¼š</p><blockquote><ul><li>å¦‚æœä½ è¿›è¡Œçš„æ˜¯è®¡ç®—å¯†é›†å‹çš„æ“ä½œï¼Œå¹¶ä¸”æ²¡æœ‰I/Oï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨Streamæ¥å£ï¼Œå› ä¸ºå®<br>ç°ç®€å•ï¼ŒåŒæ—¶æ•ˆç‡ä¹Ÿå¯èƒ½æ˜¯æœ€é«˜çš„ï¼ˆå¦‚æœæ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯è®¡ç®—å¯†é›†å‹çš„ï¼Œé‚£å°±æ²¡æœ‰å¿…è¦<br>åˆ›å»ºæ¯”å¤„ç†å™¨æ ¸æ•°æ›´å¤šçš„çº¿ç¨‹ï¼‰ã€‚</li><li>åä¹‹ï¼Œå¦‚æœä½ å¹¶è¡Œçš„å·¥ä½œå•å…ƒè¿˜æ¶‰åŠç­‰å¾…I/Oçš„æ“ä½œï¼ˆåŒ…æ‹¬ç½‘ç»œè¿æ¥ç­‰å¾…ï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨<br>CompletableFutureçµæ´»æ€§æ›´å¥½ï¼Œä½ å¯ä»¥åƒå‰æ–‡è®¨è®ºçš„é‚£æ ·ï¼Œä¾æ®ç­‰å¾…/è®¡ç®—ï¼Œæˆ–è€…<br>W/Cçš„æ¯”ç‡è®¾å®šéœ€è¦ä½¿ç”¨çš„çº¿ç¨‹æ•°ã€‚è¿™ç§æƒ…å†µä¸ä½¿ç”¨å¹¶è¡Œæµçš„å¦ä¸€ä¸ªåŸå› æ˜¯ï¼Œå¤„ç†æµçš„<br>æµæ°´çº¿ä¸­å¦‚æœå‘ç”ŸI/Oç­‰å¾…ï¼Œæµçš„å»¶è¿Ÿç‰¹æ€§ä¼šè®©æˆ‘ä»¬å¾ˆéš¾åˆ¤æ–­åˆ°åº•ä»€ä¹ˆæ—¶å€™è§¦å‘äº†ç­‰å¾…ã€‚</li></ul></blockquote><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ‰§è¡Œæ¯”è¾ƒè€—æ—¶çš„æ“ä½œæ—¶ï¼Œå°¤å…¶æ˜¯é‚£äº›ä¾èµ–ä¸€ä¸ªæˆ–å¤šä¸ªè¿œç¨‹æœåŠ¡çš„æ“ä½œï¼Œå»ºè®®è¿›è¡Œå¼‚æ­¥åŒ–è®¾è®¡ï¼Œä½¿ç”¨<code>CompletableFuture</code>ç±»æä¾›çš„ç‰¹æ€§å¯è½»æ¾å®ç°å¼‚æ­¥APIã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
          <category> Java 8å®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠJava 8å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°ç³»åˆ—â€”â€”ç¬¬ä¸‰éƒ¨åˆ†ï¼šé«˜æ•ˆJava 8ç¼–ç¨‹ï¼ˆå››ï¼‰ï¼šä½¿ç”¨æ–°çš„æ—¥æœŸæ—¶é—´API</title>
      <link href="2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(4)/"/>
      <url>2019/12/12/reading-notes/java8-in-action/Part-III-Efficient-Java8-Programming(4)/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬åäºŒç« ï¼šæ–°çš„æ—¥æœŸæ—¶é—´API"><a href="#ç¬¬åäºŒç« ï¼šæ–°çš„æ—¥æœŸæ—¶é—´API" class="headerlink" title="ç¬¬åäºŒç« ï¼šæ–°çš„æ—¥æœŸæ—¶é—´API"></a>ç¬¬åäºŒç« ï¼šæ–°çš„æ—¥æœŸæ—¶é—´API</h2><p>åœ¨Java 8ä¹‹å‰ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ—¥æœŸæ—¶é—´APIæ˜¯<code>java.util.Date</code>å’Œ<code>java.util.Calendar</code>è¿™ä¸¤ä¸ªç±»ã€‚</p><p>å¦‚æœæˆ‘ä»¬è¦æ„å»ºä¸€ä¸ªæŒ‡å®šå¹´æœˆæ—¥çš„æ—¥æœŸæ—¶é—´å¯¹è±¡ï¼Œæ¯”å¦‚<code>2019-9-2</code>ï¼Œä½¿ç”¨<code>java.util.Date</code>ç±»çš„æ„é€ æ–¹æ³•<code>Date(int year, int month, int date)</code>ï¼Œä¼ å…¥çš„å¹´ä»½yearå‚æ•°å¿…é¡»æ˜¯å¹´ä»½2019å‡å»1900ï¼Œå³ä¼ å…¥119ã€‚æ¯æ¬¡åˆ›å»ºå¯¹è±¡å‰è¿˜éœ€è¦å…ˆè¿›è¡Œè®¡ç®—ï¼Œå¾ˆä¸æ–¹ä¾¿ã€‚</p><p>JDK 1.1æä¾›çš„<code>java.util.Calendar</code>ç±»åœ¨ä½¿ç”¨æ—¶ä¹Ÿæœ‰å¾ˆå¤šä¸æ–¹ä¾¿çš„åœ°æ–¹ï¼Œæ¯”å¦‚å¯¹ä¸€ä¸ªæ—¥æœŸåŠ ä¸¤å¤©ï¼Œä½¿ç”¨<code>add</code>æ–¹æ³•ï¼Œä¼ å…¥2ï¼›å¯¹ä¸€ä¸ªæ—¥æœŸå‡ä¸¤å¤©ï¼Œä¹Ÿä½¿ç”¨<code>add</code>æ–¹æ³•ï¼Œä¼ å…¥-2ã€‚è¿˜æœ‰ä¸€ç‚¹æ˜¯è¿™ä¸ªç±»é»˜è®¤æ¯å‘¨ç¬¬ä¸€å¤©æ˜¯å‘¨æ—¥ã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿæœ‰ç‚¹ä¸æ–¹ä¾¿ã€‚</p><p>å½’æ ¹åˆ°åº•ï¼ŒJDK1.8ä¹‹å‰çš„æ—¥æœŸæ—¶é—´APIéƒ½æ˜¯å¯å˜çš„ï¼Œæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚</p><p>å¦å¤–ï¼Œå¯¹æ—¶é—´æ—¥æœŸè¿›è¡Œæ ¼å¼åŒ–çš„ç±»<code>SimpleDateFormat</code>åœ¨<code>java.text</code>åŒ…ä¸‹ï¼Œè¯¥ç±»çš„å®šä¹‰ä½ç½®ä¸è§„èŒƒã€‚å®ƒä¹Ÿæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚</p><p>è€Œåœ¨Java 8ä¸­ï¼Œæ—¶é—´æ ¼å¼è½¬åŒ–å™¨æ˜¯<code>java.time.format.DateTimeFormatter</code>ç±»ï¼Œå®ƒè¢«å£°æ˜ä¸º<code>final</code>ï¼Œæ˜¯ä¸å¯å˜çš„ç±»ï¼Œçº¿ç¨‹å®‰å…¨ã€‚</p><p>å¦å¤–ï¼ŒJava 8ä¸­æä¾›çš„æ–°æ—¥æœŸæ—¶é—´APIåŒ…å«ä¸¤ç±»ï¼šä¸€ä¸ªæ˜¯ä¸ºäº†ä¾¿äºäººé˜…è¯»ä½¿ç”¨ï¼ŒåŒ…å«<code>LocalDate</code>ã€<code>LocalTime</code>ã€<code>LocalDateTime</code>è¿™ä¸‰ä¸ªç±»ï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨<code>final</code>ä¿®é¥°çš„ç±»ï¼Œæ˜¯ä¸å¯å˜çš„å¯¹è±¡ï¼Œåˆ†åˆ«è¡¨ç¤º<code>ISO-8601</code>æ—¥å†ç³»ç»Ÿä¸­çš„æ—¥æœŸã€æ—¶é—´ã€æ—¥æœŸå’Œæ—¶é—´ã€‚å¦å¤–ä¸€ä¸ªæ˜¯ä¾¿äºæœºå™¨å¤„ç†çš„ç±»ï¼Œ<code>Instant</code>ï¼šç”¨æ¥è¡¨ç¤ºæœºå™¨çš„æ—¥æœŸå’Œæ—¶é—´æ ¼å¼ï¼šæ—¶é—´æˆ³ã€‚</p><blockquote><p>ISO-8601æ—¥å†ç³»ç»Ÿï¼šæ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡åˆ¶å®šçš„ç°ä»£å…¬æ°‘çš„æ—¥æœŸå’Œæ—¶é—´çš„è¡¨ç¤ºæ³•ã€‚<br>æ—¶é—´æˆ³ï¼šä»UNIXå…ƒå¹´ï¼š1970å¹´1æœˆ1æ—¥ 00:00:00åˆ°æŸä¸ªæ—¶é—´ä¹‹é—´çš„æ¯«ç§’å€¼ã€‚</p></blockquote><h3 id="ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨SimpleDateFormatçº¿ç¨‹å®‰å…¨é—®é¢˜æ¼”ç¤º"><a href="#ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨SimpleDateFormatçº¿ç¨‹å®‰å…¨é—®é¢˜æ¼”ç¤º" class="headerlink" title="ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨SimpleDateFormatçº¿ç¨‹å®‰å…¨é—®é¢˜æ¼”ç¤º"></a>ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨SimpleDateFormatçº¿ç¨‹å®‰å…¨é—®é¢˜æ¼”ç¤º</h3><p>å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œåŒä¸€ä¸ª<code>SimpleDateFormat</code>å¯¹è±¡æ—¶ï¼Œå°±ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p><p>æ¼”ç¤ºä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">    SimpleDateFormat sdf &#x3D; new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span><br><span class="line">    &#x2F;&#x2F; ä½¿ç”¨çº¿ç¨‹æ± æ¨¡æ‹Ÿå¤šçº¿ç¨‹</span><br><span class="line">    ExecutorService threadPool &#x3D; Executors.newFixedThreadPool(10);</span><br><span class="line">    &#x2F;&#x2F; å®šä¹‰è§£ææ—¥æœŸå­—ç¬¦ä¸²ä»»åŠ¡ï¼šä½¿ç”¨SimpleDateFormatå¯¹è±¡è§£æ</span><br><span class="line">    Callable&lt;Date&gt; task &#x3D; () -&gt; sdf.parse(&quot;2019-8-29&quot;);</span><br><span class="line">    &#x2F;&#x2F; å­˜å‚¨ç»“æœå®¹å™¨</span><br><span class="line">    List&lt;Future&lt;Date&gt;&gt; result &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">        &#x2F;&#x2F; æ‰§è¡Œå¾—åˆ°è§£æç»“æœ</span><br><span class="line">        result.add(threadPool.submit(task));</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; éå†è¾“å‡º</span><br><span class="line">    for (Future&lt;Date&gt; r : result) &#123;</span><br><span class="line">        System.out.println(r.get());</span><br><span class="line">    &#125;</span><br><span class="line">    threadPool.shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.util.concurrent.ExecutionException: java.lang.NumberFormatException: multiple points</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•ï¼š<br>1ã€å°†<code>SimpleDateFormat</code>å®šä¹‰ä¸ºæ–¹æ³•å†…çš„å±€éƒ¨å˜é‡ï¼Œä¸”æ–¹æ³•ä¸­æ²¡æœ‰å¤šçº¿ç¨‹çš„æ“ä½œã€‚<br>2ã€ä½¿ç”¨<code>ThreadLocal</code>è¿›è¡Œçº¿ç¨‹å°é—­ã€‚ä¸ºæ¯ä¸ªçº¿ç¨‹ä¿å­˜ä¸€ä¸ª<code>SimpleDateFormat</code>å¯¹è±¡ã€‚</p><h3 id="ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ThreadLocalè¿›è¡Œçº¿ç¨‹å°é—­"><a href="#ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ThreadLocalè¿›è¡Œçº¿ç¨‹å°é—­" class="headerlink" title="ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ThreadLocalè¿›è¡Œçº¿ç¨‹å°é—­"></a>ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ThreadLocalè¿›è¡Œçº¿ç¨‹å°é—­</h3><p>çº¿ç¨‹å°é—­ç±»ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package cn.org.lilu.chapter12;</span><br><span class="line"></span><br><span class="line">import java.text.DateFormat;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @Auther: lilu</span><br><span class="line"> * @Date: 2019&#x2F;8&#x2F;29</span><br><span class="line"> * @Description: ä¼ ç»Ÿæ—¶é—´æ ¼å¼è½¬æ¢å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ThreadLocalè¿›è¡Œçº¿ç¨‹å°é—­</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class TraditionalSimpleDateFormatThreadLocal &#123;</span><br><span class="line">    private static final ThreadLocal&lt;DateFormat&gt; threadLocal &#x3D; new ThreadLocal&lt;DateFormat&gt;() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        protected DateFormat initialValue() &#123;</span><br><span class="line">            return new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    public static Date convert(String source) throws Exception &#123;</span><br><span class="line">        return threadLocal.get().parse(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¼”ç¤ºä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    &#x2F;&#x2F; ä½¿ç”¨çº¿ç¨‹æ± æ¨¡æ‹Ÿå¤šçº¿ç¨‹</span><br><span class="line">    ExecutorService threadPool &#x3D; Executors.newFixedThreadPool(10);</span><br><span class="line">    &#x2F;&#x2F; å®šä¹‰è§£ææ—¥æœŸå­—ç¬¦ä¸²ä»»åŠ¡ï¼šæ¯ä¸ªä»»åŠ¡éƒ½æœ‰ä¸€ä»½SimpleDateFormatå¯¹è±¡çš„å‰¯æœ¬</span><br><span class="line">    Callable&lt;Date&gt; task &#x3D; () -&gt; TraditionalSimpleDateFormatThreadLocal.convert(&quot;2019-8-29&quot;);</span><br><span class="line">    &#x2F;&#x2F; è§£æç»“æœå®¹å™¨</span><br><span class="line">    List&lt;Future&lt;Date&gt;&gt; result &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">        &#x2F;&#x2F; æ‰§è¡Œå¾—åˆ°è§£æç»“æœ</span><br><span class="line">        result.add(threadPool.submit(task));</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; éå†è¾“å‡º</span><br><span class="line">    for (Future&lt;Date&gt; r : result) &#123;</span><br><span class="line">        System.out.println(r.get());</span><br><span class="line">    &#125;</span><br><span class="line">    threadPool.shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœæ­£å¸¸ã€‚</p><h3 id="Java-8æ–°çš„æ—¶é—´æ ¼å¼è½¬åŒ–å™¨DateTimeFormatter"><a href="#Java-8æ–°çš„æ—¶é—´æ ¼å¼è½¬åŒ–å™¨DateTimeFormatter" class="headerlink" title="Java 8æ–°çš„æ—¶é—´æ ¼å¼è½¬åŒ–å™¨DateTimeFormatter"></a>Java 8æ–°çš„æ—¶é—´æ ¼å¼è½¬åŒ–å™¨DateTimeFormatter</h3><p><code>DateTimeFormatter</code>ç±»å®šä¹‰åœ¨<code>java.time.format</code>åŒ…ä¸‹ï¼Œä¸”å£°æ˜ä¸º<code>final</code>ç±»ï¼Œä¸å¯å˜ï¼Œçº¿ç¨‹å®‰å…¨ã€‚</p><p>ä»£ç æ¼”ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    &#x2F;&#x2F; æŒ‰ç…§å“ªç§æ ¼å¼è¿›è¡Œæ ¼å¼è½¬æ¢</span><br><span class="line">    &#x2F;&#x2F; DateTimeFormatter dtf &#x3D; DateTimeFormatter.ISO_LOCAL_DATE;</span><br><span class="line">    DateTimeFormatter dtf &#x3D; DateTimeFormatter.ofPattern(&quot;yyyyMMdd&quot;);</span><br><span class="line">    &#x2F;&#x2F; LocalDate.parse(&quot;20190829&quot;,dtf)ï¼šå°†ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°æŒ‰ç…§ç¬¬äºŒä¸ªå‚æ•°å®šä¹‰çš„æ ¼å¼å™¨è§£æï¼Œè¿”å›ä¸€ä¸ªLocalDateå¯¹è±¡</span><br><span class="line">    Callable&lt;LocalDate&gt; task &#x3D; () -&gt; LocalDate.parse(&quot;20190829&quot;,dtf);</span><br><span class="line">    ExecutorService threadPool &#x3D; Executors.newFixedThreadPool(10);</span><br><span class="line">    List&lt;Future&lt;LocalDate&gt;&gt; result &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">        result.add(threadPool.submit(task));</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; éå†è¾“å‡º</span><br><span class="line">    for (Future&lt;LocalDate&gt; r : result) &#123;</span><br><span class="line">        System.out.println(r.get());</span><br><span class="line">    &#125;</span><br><span class="line">    threadPool.shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Java-8æ—¥æœŸæ—¶é—´APIï¼šLocalDateã€LocalTimeã€LocalDateTime"><a href="#Java-8æ—¥æœŸæ—¶é—´APIï¼šLocalDateã€LocalTimeã€LocalDateTime" class="headerlink" title="Java 8æ—¥æœŸæ—¶é—´APIï¼šLocalDateã€LocalTimeã€LocalDateTime"></a>Java 8æ—¥æœŸæ—¶é—´APIï¼šLocalDateã€LocalTimeã€LocalDateTime</h3><p>è¿™ä¸‰ä¸ªç±»çš„ç”¨æ³•å‡ ä¹ä¸€æ ·ï¼Œ<code>LocalDate</code>è¡¨ç¤ºæ—¥æœŸï¼Œ<code>LocalTime</code>è¡¨ç¤ºæ—¶é—´ï¼Œ<code>LocalDateTime</code>åŒ…å«å‰ä¸¤è€…ï¼Œè¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´ã€‚</p><p>å¯ç”±å‰ä¸¤ä¸ªç±»ç»„åˆå‡ºç¬¬ä¸‰ä¸ªç±»ï¼Œä¹Ÿå¯ç”±ç¬¬ä¸‰ä¸ªç±»æå–å‡ºå‰ä¸¤ä¸ªç±»ã€‚</p><h4 id="å¹´æœˆæ—¥å¯¹è±¡ï¼šLocalDate"><a href="#å¹´æœˆæ—¥å¯¹è±¡ï¼šLocalDate" class="headerlink" title="å¹´æœˆæ—¥å¯¹è±¡ï¼šLocalDate"></a>å¹´æœˆæ—¥å¯¹è±¡ï¼šLocalDate</h4><p>å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>now</code>è·å–å½“å‰æ—¥æœŸï¼›</p><p>å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>of</code>åˆ›å»ºä¸€ä¸ª<code>LocalDate</code>æ—¥æœŸå¯¹è±¡ï¼Œå¯ä»ä¸€ä¸ª<code>LocalDate</code>æ—¥æœŸå¯¹è±¡ä¸­è·å–è¯¥æ—¥æœŸçš„å¹´ä»½ã€æœˆä»½ã€è¿™ä¸ªæœˆçš„ç¬¬å‡ å¤©ã€è¿™å‘¨çš„æ˜ŸæœŸå‡ ã€ä»Šå¹´çš„ç¬¬å‡ å¤©ã€è¿™ä¸ªæœˆçš„é•¿åº¦ï¼ˆæœ‰å‡ å¤©ï¼‰å’Œæ˜¯å¦ä¸ºé—°å¹´ç­‰ä¿¡æ¯ã€‚</p><p>ä»£ç æ¼”ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * LocalDateï¼šå¹´æœˆæ—¥</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testLocalDate() &#123;</span><br><span class="line">    &#x2F;&#x2F; é™æ€å·¥å‚æ–¹æ³•nowè·å–å½“å‰æ—¥æœŸ</span><br><span class="line">    LocalDate now &#x3D; LocalDate.now();</span><br><span class="line">    &#x2F;&#x2F; é™æ€å·¥å‚æ–¹æ³•ofåˆ›å»ºä¸€ä¸ªLocalDateå®ä¾‹</span><br><span class="line">    LocalDate date &#x3D; LocalDate.of(2019,8,26);</span><br><span class="line">    &#x2F;&#x2F; å¹´ä»½</span><br><span class="line">    int year &#x3D; date.getYear();</span><br><span class="line">    &#x2F;&#x2F; æœˆä»½</span><br><span class="line">    Month month &#x3D; date.getMonth();</span><br><span class="line">    &#x2F;&#x2F; è¿™ä¸ªæœˆç¬¬å‡ å¤©</span><br><span class="line">    int dayOfMonth &#x3D; date.getDayOfMonth();</span><br><span class="line">    &#x2F;&#x2F; è¿™å‘¨æ˜ŸæœŸå‡ </span><br><span class="line">    DayOfWeek dayOfWeek &#x3D; date.getDayOfWeek();</span><br><span class="line">    &#x2F;&#x2F; ä»Šå¹´ç¬¬å‡ å¤©</span><br><span class="line">    int dayOfYear &#x3D; date.getDayOfYear();</span><br><span class="line">    &#x2F;&#x2F; è¿™ä¸ªæœˆçš„é•¿åº¦ï¼ˆæœ‰å‡ å¤©ï¼‰</span><br><span class="line">    int lengthOfMonth &#x3D; date.lengthOfMonth();</span><br><span class="line">    &#x2F;&#x2F; æ˜¯å¦é—°å¹´</span><br><span class="line">    boolean leapYear &#x3D; date.isLeapYear();</span><br><span class="line">    System.out.println(now); &#x2F;&#x2F; 2019-09-02</span><br><span class="line">    System.out.println(year); &#x2F;&#x2F; 2019</span><br><span class="line">    System.out.println(month); &#x2F;&#x2F; AUGUST</span><br><span class="line">    System.out.println(dayOfMonth); &#x2F;&#x2F; 26</span><br><span class="line">    System.out.println(dayOfWeek); &#x2F;&#x2F; MONDAY</span><br><span class="line">    System.out.println(dayOfYear); &#x2F;&#x2F; 238</span><br><span class="line">    System.out.println(lengthOfMonth); &#x2F;&#x2F; 31</span><br><span class="line">    System.out.println(leapYear); &#x2F;&#x2F; false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalTime"><a href="#æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalTime" class="headerlink" title="æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalTime"></a>æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalTime</h4><p>å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>now</code>è·å–å½“å‰æ—¶é—´çš„æ—¶åˆ†ç§’ï¼ˆåŒ…å«çº³ç§’ï¼‰ã€‚</p><p>å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>of</code>åˆ›å»ºä¸€ä¸ª<code>LocalTime</code>æ—¶é—´å¯¹è±¡ï¼Œå¯ä»ä¸€ä¸ª<code>LocalTime</code>æ—¶é—´å¯¹è±¡ä¸­è·å–è¯¥æ—¶é—´çš„æ—¶ã€åˆ†ã€ç§’å’Œçº³ç§’ç­‰ä¿¡æ¯ã€‚</p><p><code>of</code>æ–¹æ³•åŒ…å«ä¸‰ä¸ªé‡è½½ï¼Œæ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * @param hour  the hour-of-day to represent, from 0 to 23</span><br><span class="line"> * @param minute  the minute-of-hour to represent, from 0 to 59</span><br><span class="line"> *&#x2F;</span><br><span class="line">public static LocalTime of(int hour, int minute);</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @param hour  the hour-of-day to represent, from 0 to 23</span><br><span class="line"> * @param minute  the minute-of-hour to represent, from 0 to 59</span><br><span class="line"> * @param second  the second-of-minute to represent, from 0 to 59</span><br><span class="line"> *&#x2F;</span><br><span class="line">public static LocalTime of(int hour, int minute, int second);</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @param hour  the hour-of-day to represent, from 0 to 23</span><br><span class="line"> * @param minute  the minute-of-hour to represent, from 0 to 59</span><br><span class="line"> * @param second  the second-of-minute to represent, from 0 to 59</span><br><span class="line"> * @param nanoOfSecond  the nano-of-second to represent, from 0 to 999,999,999</span><br><span class="line"> *&#x2F;</span><br><span class="line">public static LocalTime of(int hour, int minute, int second, int nanoOfSecond);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * LocalTimeï¼šæ—¶åˆ†ç§’</span><br><span class="line"> * ä¸€å¤©ä¸­çš„æ—¶é—´ï¼Œæ¯”å¦‚ï¼š13:45:20ï¼Œå¯ä»¥ä½¿ç”¨LocalTimeç±»è¡¨ç¤º</span><br><span class="line"> * å¯ä»¥ä½¿ç”¨ofé‡è½½çš„ä¸‰ä¸ªé™æ€å·¥å‚æ–¹æ³•åˆ›å»ºLocalTimeå®ä¾‹</span><br><span class="line"> * ç¬¬ä¸€ä¸ªé‡è½½æ–¹æ³•æ¥æ”¶å°æ—¶å’Œåˆ†é’Ÿ</span><br><span class="line"> * ç¬¬äºŒä¸ªé‡è½½æ–¹æ³•åŒæ—¶è¿˜æ¥æ”¶ç§’</span><br><span class="line"> * ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•åŒæ—¶è¿˜æ¥æ”¶çº³ç§’</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testLocalTime() &#123;</span><br><span class="line">    LocalTime now &#x3D; LocalTime.now();</span><br><span class="line">    LocalTime localTime &#x3D; LocalTime.of(13, 45, 20,1);</span><br><span class="line">    int hour &#x3D; localTime.getHour();</span><br><span class="line">    int minute &#x3D; localTime.getMinute();</span><br><span class="line">    int second &#x3D; localTime.getSecond();</span><br><span class="line">    int nano &#x3D; localTime.getNano();</span><br><span class="line">    System.out.println(now); &#x2F;&#x2F; 19:47:51.212</span><br><span class="line">    System.out.println(hour); &#x2F;&#x2F; 13</span><br><span class="line">    System.out.println(minute); &#x2F;&#x2F; 45</span><br><span class="line">    System.out.println(second); &#x2F;&#x2F; 20</span><br><span class="line">    System.out.println(nano); &#x2F;&#x2F; 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ—¥æœŸæ—¶é—´å­—ç¬¦ä¸²è§£æ"><a href="#æ—¥æœŸæ—¶é—´å­—ç¬¦ä¸²è§£æ" class="headerlink" title="æ—¥æœŸæ—¶é—´å­—ç¬¦ä¸²è§£æ"></a>æ—¥æœŸæ—¶é—´å­—ç¬¦ä¸²è§£æ</h4><p>LocalDateå’ŒLocalTimeéƒ½å¯ä»¥é€šè¿‡è§£æä»£è¡¨å®ƒä»¬çš„å­—ç¬¦ä¸²åˆ›å»ºã€‚ä½¿ç”¨é™æ€æ–¹æ³•parseã€‚ä¸€æ—¦ä¼ é€’çš„å­—ç¬¦ä¸²å‚æ•°æ— æ³•è¢«è§£æä¸ºåˆæ³•çš„LocalDateæˆ–LocalTimeå¯¹è±¡ï¼Œè¿™ä¸¤ä¸ªparseæ–¹æ³•éƒ½ä¼šæŠ›å‡ºä¸€ä¸ªç»§æ‰¿è‡ªRuntimeExceptionçš„DateTimeParseExceptionå¼‚å¸¸ã€‚</p><p>ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * LocalDateå’ŒLocalTimeéƒ½å¯ä»¥é€šè¿‡è§£æä»£è¡¨å®ƒä»¬çš„å­—ç¬¦ä¸²åˆ›å»ºã€‚ä½¿ç”¨é™æ€æ–¹æ³•parseã€‚</span><br><span class="line"> * ä¸€æ—¦ä¼ é€’çš„å­—ç¬¦ä¸²å‚æ•°æ— æ³•è¢«è§£æä¸ºåˆæ³•çš„LocalDateæˆ–LocalTimeå¯¹è±¡ï¼Œ</span><br><span class="line"> * è¿™ä¸¤ä¸ªparseæ–¹æ³•éƒ½ä¼šæŠ›å‡ºä¸€ä¸ªç»§æ‰¿è‡ªRuntimeExceptionçš„DateTimeParseExceptionå¼‚å¸¸ã€‚</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testParse() &#123;</span><br><span class="line">    &#x2F;&#x2F; å°äº10çš„å¿…é¡»åœ¨å‰é¢è¡¥0ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸</span><br><span class="line">    LocalDate localDate &#x3D; LocalDate.parse(&quot;2019-08-26&quot;);</span><br><span class="line">    LocalTime localTime &#x3D; LocalTime.parse(&quot;13:45:20&quot;);</span><br><span class="line">    System.out.println(localDate);</span><br><span class="line">    System.out.println(localTime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¹´æœˆæ—¥æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalDateTime"><a href="#å¹´æœˆæ—¥æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalDateTime" class="headerlink" title="å¹´æœˆæ—¥æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalDateTime"></a>å¹´æœˆæ—¥æ—¶åˆ†ç§’å¯¹è±¡ï¼šLocalDateTime</h4><p>å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>now</code>è·å–å½“å‰æ—¶é—´çš„å¹´æœˆæ—¥æ—¶åˆ†ç§’çº³ç§’ï¼›</p><p>å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>of</code>åˆ›å»ºä¸€ä¸ª<code>LocalDateTime</code>æ—¥æœŸæ—¶é—´å¯¹è±¡ï¼›</p><p>å¯ç”±<code>LocalDate</code>å’Œ<code>LocalTime</code>ç»„åˆå‡º<code>LocalDateTime</code>å¯¹è±¡ï¼›</p><p>å¯ä»<code>LocalDateTime</code>å¯¹è±¡ä¸­æå–å‡º<code>LocalDate</code>å’Œ<code>LocalTime</code>ã€‚</p><p>ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * LocalDateTimeï¼šå¹´æœˆæ—¥æ—¶åˆ†ç§’</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testLocalDateTime() &#123;</span><br><span class="line">    LocalDateTime localDateTime &#x3D; LocalDateTime.now();</span><br><span class="line">    LocalDateTime localDateTime1 &#x3D; LocalDateTime.of(2019, Month.AUGUST, 26, 10, 47, 20);</span><br><span class="line">    LocalDate localDate &#x3D; LocalDate.now();</span><br><span class="line">    LocalTime localTime &#x3D; LocalTime.now();</span><br><span class="line">    &#x2F;&#x2F; ç”±LocalDateå’ŒLocalTimeç»„åˆå‡ºLocalDateTime</span><br><span class="line">    LocalDateTime localDateTime2 &#x3D; LocalDateTime.of(localDate,localTime);</span><br><span class="line">    LocalDateTime localDateTime3 &#x3D; localDate.atTime(10,51,32);</span><br><span class="line">    LocalDateTime localDateTime4 &#x3D; localDate.atTime(localTime);</span><br><span class="line">    LocalDateTime localDateTime5 &#x3D; localTime.atDate(localDate);</span><br><span class="line">    &#x2F;&#x2F; ç”±LocalDateTimeæå–å‡ºLocalDateå’ŒLocalTime</span><br><span class="line">    LocalDate localDateFromLocalDateTime &#x3D; localDateTime2.toLocalDate();</span><br><span class="line">    LocalTime localTimeFromLocalDateTime &#x3D; localDateTime2.toLocalTime();</span><br><span class="line"></span><br><span class="line">    System.out.println(localDateTime); &#x2F;&#x2F; 2019-09-02T19:57:16.516</span><br><span class="line">    System.out.println(localDateTime1); &#x2F;&#x2F; 2019-08-26T10:47:20</span><br><span class="line">    System.out.println(localDateTime2); &#x2F;&#x2F; 2019-09-02T19:57:16.517</span><br><span class="line">    System.out.println(localDateTime3); &#x2F;&#x2F; 2019-09-02T10:51:32</span><br><span class="line">    System.out.println(localDateTime4); &#x2F;&#x2F; 2019-09-02T19:57:16.517</span><br><span class="line">    System.out.println(localDateTime5); &#x2F;&#x2F; 2019-09-02T19:57:16.517</span><br><span class="line">    System.out.println(localDateFromLocalDateTime); &#x2F;&#x2F; 2019-09-02</span><br><span class="line">    System.out.println(localTimeFromLocalDateTime); &#x2F;&#x2F; 19:57:16.517</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ—¶é—´æˆ³å¯¹è±¡ï¼šInstant"><a href="#æ—¶é—´æˆ³å¯¹è±¡ï¼šInstant" class="headerlink" title="æ—¶é—´æˆ³å¯¹è±¡ï¼šInstant"></a>æ—¶é—´æˆ³å¯¹è±¡ï¼šInstant</h4><p>æœºå™¨çš„æ—¥æœŸå’Œæ—¶é—´æ ¼å¼ï¼šä»UNIXå…ƒå¹´æ—¶é—´å¼€å§‹åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•°å¯¹æ—¶é—´è¿›è¡Œå»ºæ¨¡ã€‚åŒ…å«çš„æ˜¯ç”±ç§’åŠçº³ç§’ç»„æˆçš„æ•°å­—ã€‚</p><p>ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>now</code>è·å–å½“å‰æ—¶åˆ»çš„æ—¶é—´æˆ³ï¼Œé»˜è®¤è·å–çš„æ˜¯UTCæ—¶åŒºï¼ˆä¸–ç•Œåè°ƒæ—¶é—´ï¼‰æ‰€åœ¨çš„æ—¶åˆ»ï¼Œå¯åšæ—¶åŒºåç§»è¿ç®—è·å–å¸¦åç§»é‡çš„æ—¥æœŸæ—¶é—´å¯¹è±¡<code>OffsetDateTime</code>ã€‚å¯ä½¿ç”¨<code>toEpochMilli</code>æ–¹æ³•è·å–è¡¨ç¤ºçš„æ—¶é—´æˆ³ç§’æ•°ã€‚</p><p>å¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•<code>ofEpochSecond</code>ç­‰å¯¹æ—¶é—´æˆ³è¿›è¡Œè¿ç®—ã€‚</p><p><code>Instant</code>çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†ä¾¿äºæœºå™¨ä½¿ç”¨ã€‚å®ƒåŒ…å«çš„æ˜¯ç”±ç§’åŠçº³ç§’æ‰€æ„æˆçš„æ•°å­—ã€‚æ‰€ä»¥ï¼Œå®ƒæ— æ³•å¤„ç†é‚£äº›æˆ‘ä»¬éå¸¸å®¹æ˜“ç†è§£çš„æ—¶é—´å•ä½ã€‚æ¯”å¦‚ä¸‹é¢è¿™è¡Œä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int day &#x3D; Instant.now().get(ChronoField.DAY_OF_MONTH);</span><br></pre></td></tr></table></figure><p>å®ƒä¼šæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.time.temporal.UnsupportedTemporalTypeException: Unsupported field: DayOfMonth</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * Instantï¼šä»UNIXå…ƒå¹´æ—¶é—´å¼€å§‹åˆ°ç°åœ¨æ‰€ç»è¿‡çš„ç§’æ•°å¯¹æ—¶é—´è¿›è¡Œå»ºæ¨¡ã€‚åŒ…å«çš„æ˜¯ç”±ç§’åŠçº³ç§’ç»„æˆçš„æ•°å­—ã€‚</span><br><span class="line"> *</span><br><span class="line"> * é™æ€å·¥å‚æ–¹æ³•ï¼šofEpochSecondåŒ…å«ä¸¤ä¸ªé‡è½½ç‰ˆæœ¬</span><br><span class="line"> * &#x2F;&#x2F; ä¼ å…¥ä¸€ä¸ªä»£è¡¨ç§’æ•°çš„å€¼åˆ›å»ºä¸€ä¸ªInstantå®ä¾‹</span><br><span class="line"> * Instant ofEpochSecond(long epochSecond)</span><br><span class="line"> * &#x2F;&#x2F; ç¬¬ä¸€ä¸ªå‚æ•°ï¼šä»£è¡¨ç§’æ•°çš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼šçº³ç§’æ•°ï¼Œå¯¹ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„ç§’æ•°è¿›è¡Œè°ƒæ•´ï¼Œç¡®ä¿ä¿å­˜çš„çº³ç§’åˆ†ç‰‡åœ¨0åˆ°999 999 999ä¹‹é—´ã€‚</span><br><span class="line"> * Instant ofEpochSecond(long epochSecond, long nanoAdjustment)</span><br><span class="line"> *</span><br><span class="line"> * é™æ€å·¥å‚æ–¹æ³•ï¼šnow</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testInstant() &#123;</span><br><span class="line">    Instant instant1 &#x3D; Instant.ofEpochSecond(3);</span><br><span class="line">    Instant instant2 &#x3D; Instant.ofEpochSecond(3, 0);</span><br><span class="line">    Instant instant3 &#x3D; Instant.ofEpochSecond(2, 1_000_000_000);</span><br><span class="line">    Instant instant4 &#x3D; Instant.ofEpochSecond(4, -1_000_000_000);</span><br><span class="line">    System.out.println(instant1);</span><br><span class="line">    System.out.println(instant2);</span><br><span class="line">    System.out.println(instant3);</span><br><span class="line">    System.out.println(instant4);</span><br><span class="line"></span><br><span class="line">    Instant now &#x3D; Instant.now(); &#x2F;&#x2F; é»˜è®¤è·å–UTCæ—¶åŒºçš„æ—¶é—´</span><br><span class="line">    System.out.println(now);</span><br><span class="line">    &#x2F;&#x2F; æ—¶åŒºåç§»è¿ç®—ï¼šè·å–åç§»8å°æ—¶çš„æ—¶åŒºçš„æ—¶é—´ã€‚OffsetDateTimeï¼šå¸¦åç§»é‡çš„æ—¥æœŸæ—¶é—´å¯¹è±¡</span><br><span class="line">    OffsetDateTime offsetDateTime &#x3D; now.atOffset(ZoneOffset.ofHours(8));</span><br><span class="line">    System.out.println(offsetDateTime);</span><br><span class="line">    &#x2F;&#x2F; è½¬åŒ–æˆæ—¶é—´æˆ³</span><br><span class="line">    System.out.println(now.toEpochMilli());</span><br><span class="line">    &#x2F;&#x2F; java.time.temporal.UnsupportedTemporalTypeException: Unsupported field: DayOfMonth</span><br><span class="line">    int day &#x3D; now.get(ChronoField.DAY_OF_MONTH);</span><br><span class="line">    System.out.println(day);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è®¡ç®—ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„é—´éš”ï¼šDuration-å’Œè®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”ï¼šPeriod"><a href="#è®¡ç®—ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„é—´éš”ï¼šDuration-å’Œè®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”ï¼šPeriod" class="headerlink" title="è®¡ç®—ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„é—´éš”ï¼šDuration å’Œè®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”ï¼šPeriod"></a>è®¡ç®—ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„é—´éš”ï¼šDuration å’Œè®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”ï¼šPeriod</h4><p>å¯ä»¥ä½¿ç”¨<code>Duration</code>ç±»çš„é™æ€æ–¹æ³•<code>between</code>è®¡ç®—ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹é—´çš„é—´éš”ï¼Œ<code>between</code>æ–¹æ³•æ¥æ”¶çš„å‚æ•°æ˜¯ä¸¤ä¸ª<code>Temporal</code>å¯¹è±¡ï¼Œè™½ç„¶<code>LocalDateTime</code>å’Œ<code>Instant</code>éƒ½æ˜¯<code>Temporal</code>æ¥å£çš„å®ç°ç±»ï¼Œä½†æ˜¯å®ƒä»¬æ˜¯ä¸ºä¸åŒçš„ç›®çš„è€Œè®¾è®¡çš„ï¼Œä¸€ä¸ªæ˜¯ä¸ºäº†ä¾¿äºäººé˜…è¯»ä½¿ç”¨ï¼Œ å¦ä¸€ä¸ªæ˜¯ä¸ºäº†ä¾¿äºæœºå™¨å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å°†å®ƒä»¬æ··ç”¨ï¼Œå³ä¸èƒ½è®¡ç®—<code>LocalDateTime</code>å’Œ<code>Instant</code>å¯¹è±¡ä¹‹é—´çš„é—´éš”ã€‚</p><p>å¯ä»¥ä½¿ç”¨<code>Period</code>ç±»çš„é™æ€æ–¹æ³•<code>between</code>è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”ã€‚</p><p>ä¹Ÿå¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•ç›´æ¥åˆ›å»º<code>Duration</code>å’Œ<code>Period</code>ç±»çš„å¯¹è±¡ã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * è®¡ç®—ä¸¤ä¸ªæ—¶é—´ä¹‹é—´çš„é—´éš”ï¼šDuration</span><br><span class="line"> * è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”ï¼šPeriod</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testDuration() throws Exception &#123;</span><br><span class="line">    LocalTime localTime1 &#x3D; LocalTime.parse(&quot;13:45:20&quot;);</span><br><span class="line">    LocalTime localTime2 &#x3D; LocalTime.parse(&quot;13:45:30&quot;);</span><br><span class="line">    LocalDateTime localDateTime1 &#x3D; LocalDateTime.now();</span><br><span class="line">    Thread.sleep(100);</span><br><span class="line">    LocalDateTime localDateTime2 &#x3D; LocalDateTime.now();</span><br><span class="line">    Instant instant1 &#x3D; Instant.ofEpochSecond(3);</span><br><span class="line">    Instant instant2 &#x3D; Instant.ofEpochSecond(6);</span><br><span class="line">    System.out.println(Duration.between(localTime1,localTime2)); &#x2F;&#x2F; PT10S</span><br><span class="line">    System.out.println(Duration.between(localDateTime1,localDateTime2)); &#x2F;&#x2F; PT0.1S</span><br><span class="line">    System.out.println(Duration.between(instant1,instant2)); &#x2F;&#x2F; PT3S</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; è®¡ç®—ä¸¤ä¸ªLocalDateä¹‹é—´çš„æ—¶é•¿</span><br><span class="line">    Period periodBetween &#x3D; Period.between(LocalDate.of(2019, 8, 26), LocalDate.of(2019, 8, 28));</span><br><span class="line">    System.out.println(periodBetween); &#x2F;&#x2F; P1D</span><br><span class="line">    System.out.println(periodBetween.getDays()); &#x2F;&#x2F; 2</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Durationå’ŒPeriodçš„é™æ€å·¥å‚æ–¹æ³•ç›´æ¥åˆ›å»ºå®ä¾‹</span><br><span class="line">    Duration durationOfMinutes &#x3D; Duration.ofMinutes(3);</span><br><span class="line">    Duration durationOf &#x3D; Duration.of(3, ChronoUnit.MINUTES);</span><br><span class="line">    Period periodOfDays &#x3D; Period.ofDays(10);</span><br><span class="line">    Period periodOfWeeks &#x3D; Period.ofWeeks(3);</span><br><span class="line">    Period periodOf &#x3D; Period.of(2, 6, 1);</span><br><span class="line">    System.out.println(durationOfMinutes); &#x2F;&#x2F; PT3M</span><br><span class="line">    System.out.println(durationOf); &#x2F;&#x2F; PT3M</span><br><span class="line">    System.out.println(periodOfDays); &#x2F;&#x2F; P10D</span><br><span class="line">    System.out.println(periodOfWeeks); &#x2F;&#x2F; P21D</span><br><span class="line">    System.out.println(periodOf); &#x2F;&#x2F; P2Y6M1D</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ“ä½œã€è§£æå’Œæ ¼å¼åŒ–æ—¥æœŸ"><a href="#æ“ä½œã€è§£æå’Œæ ¼å¼åŒ–æ—¥æœŸ" class="headerlink" title="æ“ä½œã€è§£æå’Œæ ¼å¼åŒ–æ—¥æœŸ"></a>æ“ä½œã€è§£æå’Œæ ¼å¼åŒ–æ—¥æœŸ</h4><p><code>LocalDate</code>ã€<code>LocalTime</code>ã€<code>LocalDateTime</code>ä»¥åŠ<code>Instant</code>è¿™æ ·è¡¨ç¤ºæ—¶é—´ç‚¹çš„æ—¥æœŸ-æ—¶é—´ç±»æä¾›äº†å¾ˆå¤šé€šç”¨çš„æ–¹æ³•ç”¨æ¥æ“ä½œæ—¥æœŸ-æ—¶é—´ã€‚æ‰€æœ‰çš„æ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªä¿®æ”¹äº†å±æ€§çš„å¯¹è±¡ã€‚å®ƒä»¬éƒ½ä¸ä¼šä¿®æ”¹åŸæ¥çš„å¯¹è±¡ã€‚</p><p>æœ€ç›´æ¥ä¹Ÿæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨â€<code>withAttribute</code>â€œæ–¹æ³•ã€‚â€<code>withAttribute</code>â€œæ–¹æ³•ä¼šåˆ›å»ºå¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œå¹¶æŒ‰ç…§éœ€è¦ä¿®æ”¹å®ƒçš„å±æ€§ã€‚</p><p>ä¹Ÿå¯ä½¿ç”¨é€šç”¨çš„<code>with</code>æ–¹æ³•ï¼Œå®ƒæ¥å—çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª<code>TemporalField</code>å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯éœ€è¦ä¿®æ”¹çš„å€¼ã€‚</p><p><code>with</code>æ–¹æ³•è¿˜æœ‰ä¸€ä¸ªé‡è½½çš„æ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ—¥æœŸè°ƒæ•´å™¨<code>TemporalAdjuster</code>å¯¹è±¡ï¼Œæ›´åŠ çµæ´»åœ°å¤„ç†æ—¥æœŸã€‚</p><p>ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * æ“çºµã€è§£æå’Œæ ¼å¼åŒ–æ—¥æœŸ</span><br><span class="line"> *</span><br><span class="line"> * LocalDateã€LocalTimeå’ŒLocalDateTimeç±»éƒ½ä¸ºfinalç±»ï¼Œä¸å¯å˜ï¼Œæ¯æ¬¡æ“ä½œåéƒ½è¿”å›ä¸€ä¸ªæ–°çš„å¯¹åº”å¯¹è±¡</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testUpdateTime() &#123;</span><br><span class="line">    LocalDate date1 &#x3D; LocalDate.of(2019, 8, 26);</span><br><span class="line">    LocalDate date2 &#x3D; date1.withYear(2020);</span><br><span class="line">    LocalDate date3 &#x3D; date2.withDayOfMonth(25);</span><br><span class="line">    LocalDate date4 &#x3D; date3.with(ChronoField.MONTH_OF_YEAR, 9);</span><br><span class="line">    System.out.println(date1); &#x2F;&#x2F; 2019-08-26</span><br><span class="line">    System.out.println(date2); &#x2F;&#x2F; 2020-08-26</span><br><span class="line">    System.out.println(date3); &#x2F;&#x2F; 2020-08-25</span><br><span class="line">    System.out.println(date4); &#x2F;&#x2F; 2020-09-25</span><br><span class="line"></span><br><span class="line">    LocalDate date5 &#x3D; LocalDate.of(2019,8,26);</span><br><span class="line">    LocalDate date6 &#x3D; date5.plusWeeks(1); &#x2F;&#x2F; åŠ ä¸€å‘¨</span><br><span class="line">    LocalDate date7 &#x3D; date6.minusYears(3); &#x2F;&#x2F; å‡ä¸‰å¹´</span><br><span class="line">    LocalDate date8 &#x3D; date7.plus(6, ChronoUnit.MONTHS); &#x2F;&#x2F; åŠ å…­æœˆ</span><br><span class="line">    System.out.println(date5); &#x2F;&#x2F; 2019-08-26</span><br><span class="line">    System.out.println(date6); &#x2F;&#x2F; 2019-09-02</span><br><span class="line">    System.out.println(date7); &#x2F;&#x2F; 2016-09-02</span><br><span class="line">    System.out.println(date8); &#x2F;&#x2F; 2017-03-02</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ—¥æœŸè°ƒæ•´å™¨ï¼šTemporalAdjuster"><a href="#æ—¥æœŸè°ƒæ•´å™¨ï¼šTemporalAdjuster" class="headerlink" title="æ—¥æœŸè°ƒæ•´å™¨ï¼šTemporalAdjuster"></a>æ—¥æœŸè°ƒæ•´å™¨ï¼šTemporalAdjuster</h4><p><code>TemporalAdjuster</code>æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œæ¥å£æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Temporal adjustInto(Temporal temporal);</span><br></pre></td></tr></table></figure><p>æ¥æ”¶ä¸€ä¸ª<code>Temporal</code>å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ª<code>Temporal</code>å¯¹è±¡ã€‚ç”±äºæ‰€æœ‰çš„æ—¥æœŸæ—¶é—´APIéƒ½å®ç°äº†<code>Temporal</code>æ¥å£ï¼Œæ•…å®ƒå¯ä»¥ç”¨æ¥è‡ªå®šä¹‰æ›´åŠ å¤æ‚çš„æ—¥æœŸæ—¶é—´æ“ä½œã€‚</p><p>Java 8æä¾›äº†<code>TemporalAdjusters</code>ç±»ï¼Œè¯¥ç±»é€šè¿‡é™æ€æ–¹æ³•æä¾›äº†å¤§é‡çš„å¸¸ç”¨<code>TemporalAdjuster</code>çš„å®ç°ã€‚</p><p>åŒæ—¶è¿˜æ”¯æŒå®šåˆ¶<code>TemporalAdjuster</code>ï¼Œå®šåˆ¶çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><p>ä¸€ï¼šå®ç°<code>TemporalAdjuster</code>æ¥å£ï¼›</p><p>äºŒï¼šä½¿ç”¨Lambdaè¡¨è¾¾å¼å®šåˆ¶<code>TemporalAdjuster</code>å¯¹è±¡ï¼Œæ¨èä½¿ç”¨<code>TemporalAdjusters</code>ç±»çš„é™æ€å·¥å‚æ–¹æ³•<code>ofDateAdjuster</code>ï¼Œè¯¥æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static TemporalAdjuster ofDateAdjuster(UnaryOperator&lt;LocalDate&gt; dateBasedAdjuster)</span><br></pre></td></tr></table></figure><p>æ¥æ”¶ä¸€ä¸ª<code>UnaryOperator</code>å‡½æ•°å¼æ¥å£ï¼Œè¿”å›ä¸€ä¸ª<code>TemporalAdjuster</code>å¯¹è±¡ã€‚</p><p><code>UnaryOperator</code>å‡½æ•°å¼æ¥å£ä¸­æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼Œå®ƒæ€»æ˜¯è¿”å›å®ƒçš„è¾“å…¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">static &lt;T&gt; UnaryOperator&lt;T&gt; identity() &#123;</span><br><span class="line">    return t -&gt; t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›¸å…³ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * æ—¥æœŸè°ƒæ•´å™¨</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testTemporalAdjuster() &#123;</span><br><span class="line">    LocalDate date1 &#x3D; LocalDate.of(2019,8,26);</span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster dayOfWeekInMonth(int ordinal, DayOfWeek dayOfWeek)</span><br><span class="line">    &#x2F;&#x2F; dayOfWeekè¡¨ç¤ºæ˜ŸæœŸå‡ </span><br><span class="line">    &#x2F;&#x2F; å¦‚æœordinalä¸º0ï¼Œåˆ™è¡¨ç¤ºæœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆçš„ä¸Šä¸€ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸå‡ </span><br><span class="line">    &#x2F;&#x2F; å¦‚æœordinalä¸ºæ­£æ•°ï¼Œåˆ™ä»¥æœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆä»å‰å‘åæ•°ï¼Œç¬¬ordinalä¸ªæ˜ŸæœŸå‡ </span><br><span class="line">    &#x2F;&#x2F; å¦‚æœordinalä¸ºè´Ÿæ•°ï¼Œåˆ™ä»¥æœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆä»åå¾€å‰æ•°ï¼Œç¬¬-ordinalä¸ªæ˜ŸæœŸå‡ </span><br><span class="line">    LocalDate date2 &#x3D; date1.with(TemporalAdjusters.dayOfWeekInMonth(1, DayOfWeek.FRIDAY));</span><br><span class="line">    System.out.println(&quot;date2&#x3D;&quot; + date2);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster firstDayOfMonth()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºå½“æœˆçš„ç¬¬ä¸€å¤©</span><br><span class="line">    LocalDate date3 &#x3D; date1.with(TemporalAdjusters.firstDayOfMonth());</span><br><span class="line">    System.out.println(&quot;date3&#x3D;&quot; + date3);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster firstDayOfNextMonth()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä¸‹æœˆçš„ç¬¬ä¸€å¤©</span><br><span class="line">    LocalDate date4 &#x3D; date1.with(TemporalAdjusters.firstDayOfNextMonth());</span><br><span class="line">    System.out.println(&quot;date4&#x3D;&quot; + date4);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster firstDayOfNextYear()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºæ˜å¹´çš„ç¬¬ä¸€å¤©</span><br><span class="line">    LocalDate date5 &#x3D; date1.with(TemporalAdjusters.firstDayOfNextYear());</span><br><span class="line">    System.out.println(&quot;date5&#x3D;&quot; + date5);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster firstDayOfYear()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä»Šå¹´çš„ç¬¬ä¸€å¤©</span><br><span class="line">    LocalDate date6 &#x3D; date1.with(TemporalAdjusters.firstDayOfYear());</span><br><span class="line">    System.out.println(&quot;date6&#x3D;&quot; + date6);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster firstInMonth(DayOfWeek dayOfWeek)ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºåŒä¸€ä¸ªæœˆä¸­ï¼Œç¬¬ä¸€ä¸ªç¬¦åˆæ˜ŸæœŸå‡ è¦æ±‚çš„æ—¥æœŸï¼ˆè¿™ä¸ªæœˆçš„ç¬¬ä¸€ä¸ªæ˜ŸæœŸå‡ ï¼‰</span><br><span class="line">    LocalDate date7 &#x3D; date1.with(TemporalAdjusters.firstInMonth(DayOfWeek.FRIDAY));</span><br><span class="line">    System.out.println(&quot;date7&#x3D;&quot; + date7);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster lastDayOfMonth()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºè¿™ä¸ªæœˆçš„æœ€åä¸€å¤©</span><br><span class="line">    LocalDate date8 &#x3D; date1.with(TemporalAdjusters.lastDayOfMonth());</span><br><span class="line">    System.out.println(&quot;date8&#x3D;&quot; + date8);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster lastDayOfYear()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä»Šå¹´çš„æœ€åä¸€å¤©</span><br><span class="line">    LocalDate date9 &#x3D; date1.with(TemporalAdjusters.lastDayOfYear());</span><br><span class="line">    System.out.println(&quot;date9&#x3D;&quot; + date9);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster lastInMonth(DayOfWeek dayOfWeek)ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºåŒä¸€ä¸ªæœˆä¸­ï¼Œæœ€åä¸€ä¸ªç¬¦åˆæ˜ŸæœŸå‡ è¦æ±‚çš„æ—¥æœŸ</span><br><span class="line">    LocalDate date10 &#x3D; date1.with(TemporalAdjusters.lastInMonth(DayOfWeek.FRIDAY));</span><br><span class="line">    System.out.println(&quot;date10&#x3D;&quot; + date10);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster next(DayOfWeek dayOfWeek)ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹åç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸ</span><br><span class="line">    LocalDate date11 &#x3D; date1.with(TemporalAdjusters.next(DayOfWeek.MONDAY));</span><br><span class="line">    System.out.println(&quot;date11&#x3D;&quot; + date11);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster nextOrSame(DayOfWeek dayOfWeek)ï¼š</span><br><span class="line">    &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹åç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸï¼›</span><br><span class="line">    &#x2F;&#x2F; å¦‚æœæŒ‡å®šæ—¥æœŸå·²ç¬¦åˆè¦æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥æ—¥æœŸ</span><br><span class="line">    LocalDate date12 &#x3D; date1.with(TemporalAdjusters.nextOrSame(DayOfWeek.MONDAY));</span><br><span class="line">    System.out.println(&quot;date12&#x3D;&quot; + date12);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster previous(DayOfWeek dayOfWeek)ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹å‰ç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸ</span><br><span class="line">    LocalDate date13&#x3D; date1.with(TemporalAdjusters.previous(DayOfWeek.MONDAY));</span><br><span class="line">    System.out.println(&quot;date13&#x3D;&quot; + date13);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster previousOrSame(DayOfWeek dayOfWeek)ï¼š</span><br><span class="line">    &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹å‰ç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸï¼›</span><br><span class="line">    &#x2F;&#x2F; å¦‚æœæŒ‡å®šæ—¥æœŸå·²ç¬¦åˆè¦æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥æ—¥æœŸ</span><br><span class="line">    LocalDate date14 &#x3D; date1.with(TemporalAdjusters.previousOrSame(DayOfWeek.MONDAY));</span><br><span class="line">    System.out.println(&quot;date14&#x3D;&quot; + date14);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; ä½¿ç”¨Lambdaè¡¨è¾¾å¼å®šåˆ¶TemporalAdjusterå¯¹è±¡ï¼Œæ¨èä½¿ç”¨TemporalAdjustersç±»çš„é™æ€å·¥å‚æ–¹æ³•ofDateAdjuster</span><br><span class="line">    &#x2F;&#x2F; TemporalAdjuster ofDateAdjuster(UnaryOperator&lt;LocalDate&gt; dateBasedAdjuster)</span><br><span class="line">    TemporalAdjuster nextWorkingDay &#x3D; TemporalAdjusters.ofDateAdjuster(temporal -&gt; &#123;</span><br><span class="line">        DayOfWeek dayOfWeek &#x3D; DayOfWeek.of(temporal.get(ChronoField.DAY_OF_WEEK));</span><br><span class="line">        int dayToAdd &#x3D; 1;</span><br><span class="line">        if (dayOfWeek &#x3D;&#x3D; DayOfWeek.FRIDAY) dayToAdd &#x3D; 3;</span><br><span class="line">        else if (dayOfWeek &#x3D;&#x3D; DayOfWeek.SATURDAY) dayToAdd &#x3D; 2;</span><br><span class="line">        return temporal.plus(dayToAdd,ChronoUnit.DAYS);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * å®šåˆ¶TemporalAdjuster</span><br><span class="line"> *</span><br><span class="line"> * è®¡ç®—ä¸‹ä¸€ä¸ªå·¥ä½œæ—¥</span><br><span class="line"> *&#x2F;</span><br><span class="line">class NextWorkingDay implements TemporalAdjuster &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * å‘¨ä¸€åˆ°å‘¨äº”ä¸ºå·¥ä½œæ—¥</span><br><span class="line">     * å¦‚æœæ˜¯å‘¨æ—¥åˆ°å‘¨å››ï¼Œåˆ™è¿”å›ä¸‹ä¸€å¤©</span><br><span class="line">     * å¦‚æœæ˜¯å‘¨äº”ã€å‘¨å…­ã€è¿”å›ä¸‹å‘¨å‘¨ä¸€</span><br><span class="line">     * @param temporal</span><br><span class="line">     * @return</span><br><span class="line">     *&#x2F;</span><br><span class="line">    @Override</span><br><span class="line">    public Temporal adjustInto(Temporal temporal) &#123;</span><br><span class="line">        &#x2F;&#x2F; å¾—åˆ°ä»Šå¤©æ˜ŸæœŸå‡ </span><br><span class="line">        DayOfWeek dayOfWeek &#x3D; DayOfWeek.of(temporal.get(ChronoField.DAY_OF_WEEK));</span><br><span class="line">        int dayToAdd &#x3D; 1;</span><br><span class="line">        if (dayOfWeek &#x3D;&#x3D; DayOfWeek.FRIDAY) dayToAdd &#x3D; 3;</span><br><span class="line">        else if (dayOfWeek &#x3D;&#x3D; DayOfWeek.SATURDAY) dayToAdd &#x3D; 2;</span><br><span class="line">        return temporal.plus(dayToAdd,ChronoUnit.DAYS);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>TemporalAdjusters</code>ç±»ä¸­åŒ…å«çš„å·¥å‚æ–¹æ³•åˆ—è¡¨ï¼š</p><table><thead><tr><th align="left">æ–¹æ³•ç­¾å</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>TemporalAdjuster dayOfWeekInMonth(int ordinal, DayOfWeek dayOfWeek)</code></td><td align="left">dayOfWeekè¡¨ç¤ºæ˜ŸæœŸå‡ <br />å¦‚æœordinalä¸º0ï¼Œåˆ™è¡¨ç¤ºæœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆçš„ä¸Šä¸€ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸå‡ <br />å¦‚æœordinalä¸ºæ­£æ•°ï¼Œåˆ™ä»¥æœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆä»å‰å‘åæ•°ï¼Œç¬¬ordinalä¸ªæ˜ŸæœŸå‡ <br /> å¦‚æœordinalä¸ºè´Ÿæ•°ï¼Œåˆ™ä»¥æœ¬æ—¥æœŸæ‰€åœ¨çš„æœˆä»åå¾€å‰æ•°ï¼Œç¬¬-ordinalä¸ªæ˜ŸæœŸå‡ </td></tr><tr><td align="left"><code>TemporalAdjuster firstDayOfMonth()</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºå½“æœˆçš„ç¬¬ä¸€å¤©</td></tr><tr><td align="left"><code>TemporalAdjuster firstDayOfNextMonth()</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä¸‹æœˆçš„ç¬¬ä¸€å¤©</td></tr><tr><td align="left"><code>TemporalAdjuster firstDayOfNextYear()</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºæ˜å¹´çš„ç¬¬ä¸€å¤©</td></tr><tr><td align="left"><code>TemporalAdjuster firstDayOfYear()</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä»Šå¹´çš„ç¬¬ä¸€å¤©</td></tr><tr><td align="left"><code>TemporalAdjuster firstInMonth(DayOfWeek dayOfWeek)</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºåŒä¸€ä¸ªæœˆä¸­ï¼Œç¬¬ä¸€ä¸ªç¬¦åˆæ˜ŸæœŸå‡ è¦æ±‚çš„æ—¥æœŸï¼ˆè¿™ä¸ªæœˆçš„ç¬¬ä¸€ä¸ªæ˜ŸæœŸå‡ ï¼‰</td></tr><tr><td align="left"><code>TemporalAdjuster lastDayOfMonth()</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºè¿™ä¸ªæœˆçš„æœ€åä¸€å¤©</td></tr><tr><td align="left"><code>TemporalAdjuster lastDayOfYear()</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºä»Šå¹´çš„æœ€åä¸€å¤©</td></tr><tr><td align="left"><code>TemporalAdjuster lastInMonth(DayOfWeek dayOfWeek)</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå®ƒçš„å€¼ä¸ºåŒä¸€ä¸ªæœˆä¸­ï¼Œæœ€åä¸€ä¸ªç¬¦åˆæ˜ŸæœŸå‡ è¦æ±‚çš„æ—¥æœŸ</td></tr><tr><td align="left"><code>TemporalAdjuster next(DayOfWeek dayOfWeek)</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹åç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸ</td></tr><tr><td align="left"><code>TemporalAdjuster nextOrSame(DayOfWeek dayOfWeek)</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹åç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸï¼›å¦‚æœæŒ‡å®šæ—¥æœŸå·²ç¬¦åˆè¦æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥æ—¥æœŸ</td></tr><tr><td align="left"><code>TemporalAdjuster previous(DayOfWeek dayOfWeek)</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹å‰ç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸ</td></tr><tr><td align="left"><code>TemporalAdjuster previousOrSame(DayOfWeek dayOfWeek)</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸï¼Œå¹¶å°†å…¶å€¼è®¾å®šä¸ºæŒ‡å®šæ—¥æœŸä¹‹å‰ç¬¬ä¸€ä¸ªç¬¦åˆæŒ‡å®šæ˜ŸæœŸå‡ çš„æ—¥æœŸï¼›å¦‚æœæŒ‡å®šæ—¥æœŸå·²ç¬¦åˆè¦æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥æ—¥æœŸ</td></tr></tbody></table><h4 id="æ—¶åŒº"><a href="#æ—¶åŒº" class="headerlink" title="æ—¶åŒº"></a>æ—¶åŒº</h4><p>æ—¶åŒºçš„å¤„ç†æ˜¯æ–°ç‰ˆæ—¥æœŸå’Œæ—¶é—´APIæ–°å¢åŠ çš„é‡è¦åŠŸèƒ½ï¼Œä½¿ç”¨æ–°ç‰ˆæ—¥æœŸå’Œæ—¶é—´APIæ—¶åŒºçš„å¤„ç†è¢«æå¤§åœ°ç®€åŒ–äº†ã€‚æ–°çš„<code>java.time.ZoneId</code>ç±»æ˜¯è€ç‰ˆ<code>java.util.TimeZone</code>çš„æ›¿ä»£å“ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡å°±æ˜¯è¦è®©ä½ æ— éœ€ä¸ºæ—¶åŒºå¤„ç†çš„å¤æ‚å’Œç¹çè€Œæ“å¿ƒï¼Œè·Ÿå…¶ä»–æ—¥æœŸå’Œæ—¶é—´ç±»ä¸€ æ ·ï¼Œ<code>ZoneId</code>ç±»ä¹Ÿæ˜¯è¢«<code>final</code>ä¿®é¥°è€Œæ— æ³•ä¿®æ”¹çš„ã€‚</p><p>ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * å¸¦æ—¶åŒºçš„æ—¥æœŸæ—¶é—´API</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Test</span><br><span class="line">public void testZoneLocalDateTime() &#123;</span><br><span class="line">    &#x2F;&#x2F; æŸ¥çœ‹æ‰€æœ‰æ”¯æŒçš„æ—¶åŒº</span><br><span class="line">    Set&lt;String&gt; availableZoneIds &#x3D; ZoneId.getAvailableZoneIds();</span><br><span class="line">    for (String s: availableZoneIds) &#123;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; é€šè¿‡æ—¶åŒºæ„å»ºLocalDateTimeå¯¹è±¡</span><br><span class="line">    LocalDateTime localDateTimeNow &#x3D; LocalDateTime.now(ZoneId.of(&quot;Asia&#x2F;Shanghai&quot;));</span><br><span class="line">    &#x2F;&#x2F; æŒ‡å®šæ—¶åŒºæ„å»ºå¸¦æ—¶åŒºçš„æ—¥æœŸæ—¶é—´å¯¹è±¡</span><br><span class="line">    ZonedDateTime zonedDateTime &#x3D; localDateTimeNow.atZone(ZoneId.of(&quot;Asia&#x2F;Shanghai&quot;));</span><br><span class="line">    System.out.println(localDateTimeNow); &#x2F;&#x2F; 2019-09-03T10:35:25.677</span><br><span class="line">    &#x2F;&#x2F; 2019-09-03T10:35:25.677+08:00[Asia&#x2F;Shanghai] ä¸UTCæ—¶é—´ç›¸å·®8å°æ—¶</span><br><span class="line">    System.out.println(zonedDateTime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ—¥æœŸæ—¶é—´APIçš„éƒ¨åˆ†UMLå›¾"><a href="#æ—¥æœŸæ—¶é—´APIçš„éƒ¨åˆ†UMLå›¾" class="headerlink" title="æ—¥æœŸæ—¶é—´APIçš„éƒ¨åˆ†UMLå›¾"></a>æ—¥æœŸæ—¶é—´APIçš„éƒ¨åˆ†UMLå›¾</h4><p>ä»¥ä¸Šä»‹ç»çš„æ–°çš„æ—¥æœŸæ—¶é—´APIç›¸å…³ç±»çš„UMLå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/02/15/G5oUqew63xHfkup.png" alt="12-newDateTimeUML.png"></p><p>ä¸‹é¢è¿™å¼ å›¾èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£LocaleDateã€ LocalTimeã€LocalDateTimeä»¥åŠZoneIdä¹‹é—´çš„å·®å¼‚ã€‚</p><p><img src="https://i.loli.net/2020/02/15/FbwNkXIJVrfBy2z.png" alt="12-ZonedDateTimeç»„æˆ.png"></p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
          <category> Java 8å®æˆ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java8 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
